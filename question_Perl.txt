下記のような『!url!』の『!～!』っていうのは、どのような意味なんでしょうか。 Perl Html ともに初心者です。 -------------------------------------------------------------------------------------- Perl-------------------- $tmpl =~ s/!url!/$cook[2]/; HTML------------------ <th>参照先</th> <td><input type="text" name="url" value="!url!" class="reg-url" /></td>
perlのsystem関数を使って、外部サーバーのフォルダ（999）をバックアップしたいと思っています。 公開鍵を設定して、コマンド入力では動きます。 $ rsync -av user1@xxx.xxx.xxx.xxx:/home/user1/public_html/hp/999 /home/user2/public_html/hp/ これをperlのsystem関数に入れると動きません。 $retcodeは-1になります。 apacheのエラーログには何も出ていません。 何が原因で動かないのでしょうか？ よろしくお願いします。 #!/usr/bin/perl $retcode=system ("rsync -av user1@xxx.xxx.xxx.xxx:/home/user1/public_html/hp/999 /home/user2/public_html/hp/"); print "Content-type: text/html\n\n"; print"code: $retcode"; exit;
aaaフォルダ配下のファイルfruits.csv(タブ区切り２列)の１列目の内容が@dbline[1]の内容と等しいものについて、２列目の内容を$Hinmeiに取り出すプログラムを以下のように作成しましたが、他の変数の領域を壊しているようです。何が問題なのかご教示下さい。 因みにif文を何個も使用して条件に合うものの品名を取り出すことはできますが、if文が増えてしまい、見栄えが良くありません。 open (FILE,"../aaa/fruits.csv”); while (<FILE>){ chomp $_; @data=split(/\t/,$_); if(@dbline[1] eq @data[0]) { $Hinmei=$data[1]; last; } } close(FILE);
Perl初心者です。 以下のサンプルコード中の「->」「=>」「%$」「@$」はそれぞれ何というものでしょうか。 #!/usr/bin/perl use Net::POP3; #POPサーバに接続 my $pop = Net::POP3->new('サーバのホスト名', Timeout=> 120) || die "Cound\'t Connect to POP server\n"; $pop->login('ユーザ名', 'パスワード') || die "Authentication failed\n"; #メールのリストを取得（メッセージ番号 => サイズ からなるハッシュリファレンス） my $list_href = $pop->list; #メールを一通づつ取得 foreach my $msg_id (keys %$list_href){ my $message = $pop->get($msg_id); #メールを取得 print @$message; $pop->delete($msg_id); #メールを削除 } $pop->quit; よろしくお願いいたします。
たびたびお世話になります。 perl CGIを作っています。作っているCGIとは別のディレクトリにあるファイルをrequireしたいのですが、リモートログインできないレンタルサーバのため@INCのいじり方がわかりません。 こういった場合のrequire方法（あるいはプログラム再利用方法）をお教えください
はじめまして。 要点だけになってしまいますが 教えていただきたいことがあってトピしました。 この構文では動きませんが僕がやりたいことは こういうイメージです。 111.txt 444 444 1.txt 111 222 333 444 a=`cat 111` echo $a 結果 444 444 1.txt | sed 's/222/$a/g' 　　　　　　　　 ↑ ↑ 　　　　置換対象　変数 word　を　$a　に収まっている文字列で置換します。 結果 111 444 444 333 444 どなたかわかるかた教えてください。 よろしくお願いします。
Perlにて、 emlの本文(htmlとplain)の取得をしたいです。 ライブラリとして、 Email::MIME を使用しております、現在以下の様な感じです。 my $parsed = Email::MIME->new($text); for my $part ($parsed->parts) { if($part->{ct}{discrete} !~ /^text/){ }elsif($part->content_type =~ m|text/html|){ #html }else{ #plain } この状態で$part->body_strや$part->bodyで取得が可能かと考えておりましたが、 emlにて入れ子構造が上手く取得出来ず、困っております。 やり方等、如何様でも構いませんので、ご指摘頂ければ幸いで御座います。 sampleのEML※サンプルなのでhtmlはhtml形式になっておりません。 \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ Return-Path: <test@test.jp> X-Original-To: test@test.jp Delivered-To: test@test.jp X-Env-Sender: test@test.jp Date: Wed, 7 Dec 2011 02:48:11 -0600 (CST) From: <test@test.jp> To: test@test.jp Subject: =?UTF-8?B?dGVzdA==?= =?UTF-8?B?dGVzdA?= =?UTF-8?B?dGVzdA?= =?UTF-8?B?dGVzdA==?= Mime-Version: 1.0 Content-Type: multipart/mixed; boundary="----=_Part_33646_1423332566.1323247678520" ------=_Part_33646_1423332566.1323247678520 Content-Type: multipart/alternative; boundary="----=_Part_33649_2021685376.1323247678532" ------=_Part_33649_2021685376.1323247678532 Content-Type: text/plain; charset=UTF-8 Content-Transfer-Encoding: base64 dGVzdA == ------=_Part_33649_2021685376.1323247678532 Content-Type: text/html;charset=UTF-8 Content-Transfer-Encoding: base64 dGVzdA== ------=_Part_33649_2021685376.1323247678532-- ------=_Part_33646_1423332566.1323247678520-- \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
perlにて、 htmlを解析して、コメントアウトのみ除去したいと思っております。 正規表現で可能な気がするのすが、上手く抽出出来ず、 ヒントでも構いませんので、ご指摘頂ければ幸いで御座います。 例)下記から<div>a</div><div>aa</div> --------------------------------- <div>a</div> <!-- <div>a</div> --> <div>aa</div> ---------------------------------
http://yowyow.sakura.ne.jp/test/http.cgi httpのレスポンスを確認するための動作をテストしていたところ 上記で送信ボタンを押すと処理が行われた後に、要素が一つ認識されなくなります 文字コードの問題かと思ってutf-8に変換しても同様の結果でした 以下にソースを圧縮したものを置いてあります http://yowyow.sakura.ne.jp/test/test.zip 何が悪いのか教えていただけますでしょうか・
http://yowyow.sakura.ne.jp/milbon/board.cgi IEだけIEだけInternal Server Errorとか出るんですけどなぜでしょうか？ 他のブラウザだと別のエラーメッセージが出ますがそれは期待通りの動作です
perlで%ENVを使って環境変数を使いPerlスクリプトを作りwebページで表示したいと考えています。 このようなことをしたい場合はどのような手順でスクリプトを書けばよいのでしょうか？ かなりアバウトな質問ですがよろしくお願いします。
perlの連想配列である%ENVがよくわかりません。 具体的にはいつ使うのか、また使い道は何なのか。 %ENVとはどのようなものなのかがわかりません。 どなたか教えていただけると幸いです。
perlの連想配列を使い "AP" => "Apple" "BN" => "Banana" "OG" => "Orange" という値を格納します。 そしてこの格納した値をキーボードからの入力で取り出します。 このように表示したいです↓↓ "好きな果物を入力してください[AP/BN/OG]" そして入力を受けるとその果物の値を返し果物の名前を表示します↓↓ "あなたの好きな果物はAppleですね" ここまではできたのですが、この格納した果物以外を入力するとwhileで格納した果物が入力されるまで"３種類から選んでください”というようにループしたいです。 この場合どのように書けばよいのでしょうか。 whileの場合andで書きたい場合はどのように書けばよいのでしょうか。 また入力には<STDIN>を使い引数はchmopで処理すると良いとアドバイスを貰いましたがchompの使い道がよくわかりません。 そちらも説明していただけると幸いです。 わかりにくい質問ですがよろしくお願いします。
PerlでWEBサイトを作る為には 必ずApacheやIISのインストールが必要ですか？
恐れ入ります。 LWPで、特定サイトにアクセスした時に発行されるCookieを任意のディレクトリに保存したいのですが、どのようにしたらよいかわかりません。 use HTTP::Cookies; use LWP::UserAgent; $ua = LWP::UserAgent->new(); $cookie_file = './cookie/xxx.txt'; $cookie_jar = HTTP::Cookies->new(file => $cookie_file, autosave => 1); $url = "http://～～"; $response = $ua->get($url); print $response->content; で、コンテンツは表示されますが、xxx.txtにcookieが保存されません。 #LWP-Cookies-1.0 のみが記載された白紙のxxx.txtが精製されます。 よろしくお願いします。
substr_count() のPerl版はありますか？ substr_count() のような関数をPerlで使いたいんです。 基本的に該当文字列の出現回数さえカウントできればいいんです。 誰か教えてください。
ブログのシステムを変更して、 記事中にある内部リンクの書き換えが必要となりました。 現在、記事中に post-001.html post-005.html 　・ 　・ 　・ post-853.html という文字列があります。 数字は飛び飛びでそれぞれ異なり500個ほどあります。 WordPressのプラグインの「Search Regex」を使って置換をしたいのですが、 正規表現で置換して、 ハイフンをアンダーバーに置換し、お尻の「.html」は削除して post_001 post_005 　・ 　・ 　・ post_853 としたいのですが、正規表現で置換する場合、 どのようにすればいいのでしょうか。 「post-」を　( )　でくくればいいのでしょうか。 「.html」削除するにはどうすればいいのでしょうか。 Search Regex に Search pattern（置換前の文字列）と Replace pattern （置換後も文字列）を入力する欄があります。 上のような文字列を置換したい場合は、 それぞれどのような記号を入力すればよいのでしょうか。 アドバイスをよろしくお願いいたします。
perlでBIG or SMALL 的なプログラムを作っているんですけど何故か挙動がおかしいです。 $trueには1から10までの乱数が入ります。 $randsには1から10までの乱数が入ります。 $bigには事前にプレーヤーから聞いた$randsより大きい？小さい？が大きい = 1 小さい =0 で入ってます。 評価の仕方がおかしいのでしょうか…？ ご教授下さい。 --- # 本当よりランダムが大きい if ($true < $rands) { # 正解 if ($big == 0) { $com "正解！"; } # 不正解 else { $com = "不正解…"; } } # 本当よりランダムが小さい if ($true > $rands) { # 正解 if ($big == 1) { $com = "正解！"; } # 不正解 else { $com = "不正解…"; } }
やりたいことは、"ファイルAを読み取り、その内容に処理を施したものをファイルBに書き込むという処理"です。 その上で、"ファイルBに書き込んだ内容を書き込みと同時に読み取り、 その上である条件にマッチした文を書き換える"といったことを実現したいです。 もともとのファイルの容量が非常に大きいので、何度もループを使うといったことはなるべく避けたいため、 ファイルBの書き込み・読み込み・書き換えを同時に行いたいのですが、 そもそもそういったことは可能なのでしょうか。 ※また、もともとのファイルの容量が非常に大きいので配列を使わず行う、 ということが前提条件としてあります。 現在のスクリプトの簡略化したものが以下となります。 open LOGFILE,"< /○○/ファイルA" || die("die"); open NEWLOG,"+< /△△/ファイルB" || die("die"); $new = <NEWLOG>; while($yomitori = <LOGFILE>){ if(ある条件1){ print NEWLOG "$kakikomi\n"; } if(ある条件2){ ファイルBの書き換えの処理 $new =~s/\n/ $kakikae\n/; print NEWLOG "$new"; } } close(NEWLOG); close(LOGFILE); 上記スクリプトで、ファイルAからファイルBへの書き込み、ファイルBの読み取りまではできておりますが、 ファイルBの書き換えは実現しておりません。 以上、お詳しい方がいらっしゃいましたら宜しくお願い致します。
perl 未経験なのですが、修正を行うことになり困っています。 以下のようにURLから頭（先頭から決まった部分まで）と ケツ（パラメータ部分）を切り取ってトリミングしたいのですが、 どのように記述すればよいのでしょうか。 http://okwave.jp/question/new/index.html?abcdefg ↓ /question/new/index.html どなたか教えていただけますでしょうか。 よろしくお願いいたします。
perl初心者です。 Windows上で特定のフォルダ内にあるファイルに書かれている 文字列をperlで一括置換したいのですが、方法がわかりません。 アドバイスをお願いいたします。 やりたいこと。 ・Windows上で実行。 ・特定のフォルダ内にある複数ファイルが対象。 ・置換したい条件は複数で、1ファイル内で複数ヒットするる可能性あり。 ・言語はperl 例） 条件1 ・置換前：tokyoto ・置換後：kanagawaken 条件2 ・置換前：saitamaken ・置換後：tibaken ・ファイル 　c:\test1\a\a1.xml 　c:\test1\a\a2.xml 　c:\test1\b\b1.xml ・a1.xmlの内容 　tokyotokawasakishi tokyotoyokohamashi saitamakenitikawashi ・a2.xmlの内容 　kanagawakensagamiharashi saitamakentibashi ・b1.xmlの内容 tokyotohiratukashi ↓置換後 ・a1.xmlの内容 　kanagawakenkawasakishi kanagawakenyokohamashi　 tibakenitikawashi ・a2.xmlの内容 　kanagawakensagamiharashi tibakentibashi ・b1.xmlの内容 kanagawakenhiratukashi
While文のループのなかにfor文でループをまわしているスクリプトなのですが、 forの中でカウンタ変数をつくり、ループ回数を計測しております。 またforの中である条件を満たした際に、lastでforを抜け、引き続きWhileのループを継続するという処理をしております。 $i=0; While(○○){ 処理1 　　　for(××){ 処理2 $i++; 　　　　 if($i >=100){ 　処理3 　　　　　　last; } } } ここで、一度for文のif文で一度forループを抜け、Whileでループをし、またforループに突入した際に、前回forループでカウントした$iの値を保持したまま、そのつづきから$iのカウンタを動作させたいのですが、$iの値はforループを抜けるとリセットしてしまいます。 このような場合、どうすれば$iの値を保持できますでしょうか。 お詳しい方、宜しくお願い致します。 ※ネストがうまく表現できず、みずらくてスミマセン。
こんにちは。 いままでez-htmlを使っていましたがperl専用エディタを使いたいと思っています。 欲しい機能に適してるエディタはありますか。 ・フリーソフト ・色分け ・予測入力(なくても可) ・phpも編集できたらなお可
cgiのifは if (hogehoge eq hogehoge) { hogehoge(); } でもOKですか？
CPANでinstall Time::Localを実行して、「/usr/bin/make install -- OK」と最終的に表示されるのですが、「perl -MTime::Local -e 'print $Time::Local::VERSION'」を実行して、バージョンを確認すると、Time-Local-1.2300.tar.gzを解凍して、実行しているのにもかかわらず、1.1とバージョンが表示されてしまいます。この原因と、バージョンを1.23にする方法を教えてください。
久しぶりにPerlを操作してファイルのデータの一部を削除したいのですが、削除出来ずに困っております。 3年以上触っていないため、過去のファイル等々を見ながらやってましたが、結果は出来ずじまいで停滞して困っております。 ご指導いただけないかと思い、書き込みしました。 ファイル名　$tmpfile データ構成　 no,名称 1<>フレーム 2<>レンズ 3<>カメラ 4<>ファインダー 5<>めがね 6<>ズーム これで「めがね」を削除したいのです。 データnoで削除したいと思っておりますが、うまく動作しません。 以下ソース open(DB,"$tmpfile") || &error("Open Error : $tmpfile"); flock(DB, 1); @lines = <DB>; @new=(); foreach $line (@lines) { $flag=0; ($no,$meisyo) = split("<>", $line); foreach $x (@DEL) { if ("$x" eq $tmpnum) { $flag=1; last; } } if ($flag == 0) { push(@new,$line); } } open(OUT,">$tmpfile") || &error("Write Error : $tmpfile"); print OUT @new; close(OUT); ここまで 上のソースですと、エラーこそならずに(そうみえているだけかもしれません)終わりますが、データ削除が正しく出来ませんでした。 説明不足があるかもしれませんので、指摘いただけますと幸いです。 よろしくお願いいたします。
再帰でフォルダーからテキストファイルなど 読み出せるファイル群を全検索して目的の 文字列を表示させています 子供側がclosedirするので 親にファイルハンドルが無いよと 怒られます、何か良いアイデアありませんか __________________________________________ sub dirs_1($){ my( $an ) = @_; my( $cd,$file ); opendir K,"$an" or print "$an => $!\n\n"; for $file( readdir(K) ){ $cd = "$an/$file"; next if fu_1( $cd ) or re_1( $cd ); ( -d $cd ) ? dirs_1( $cd ) : op_1( $cd ); } closedir K; } __________________________________________ #fu_1()re_1()で画像やバイナリなどを弾く #dirs_1()で再帰、op_1()で文字列検索 よろしくお願いします
http://AAA/BBB/???/CCC AAAとCCCは固定文字です。 BBBは変化します。 ///の数・順番も固定です。 この状態で、「???」を抜き出してZZZ変数に値を代入するにはどうすれば良いでしょうか？ ZZZ=
こんにちは。 ファイルの中身を 記号（。、＜＞「」など） A-Z a-z あ-ん（「は」のように濁音と半濁音のある音は、はばぱの順） ア-ン（↑と同様） 漢字（あ-ん同様） に並べ替えたいのですが、このように条件がつけられるエディタ（無料）は無いでしょうか？ またはプログラム（CまたはPerl）で実装できないでしょうか？ 教えていただけると助かります。 よろしくお願いします。
以下内容のファイルabc.csv を読み込み、１列目の文字列を指定したとき、２列目の文字列の内容を取得したいと思います。MEを指定したらMELONを取得したい。 その場合のコードを教えて下さい。 AP,APPLE OR,ORANGE ME,MELON PE,PEACH GR,GRAPE 以上、よろしくお願いします。
perlでプログラムを作成中です。 作成したモノはうまく動かないので掲載できませんが、 どなたかお知恵を貸してください。 　入力文字列に対して １をＡ、２をＢ、３をＣ に置換するプログラムを作成中です。 ただし、全ての組み合わせを出力したいのです。 つまり、”２１３”と入力すると回答は、 Ｂ１３ ＢＡ３ ＢＡＣ ２Ａ３ ２１Ｃ ２ＡＣ Ｂ１Ｃ と出力したいのです。 　プログラムとしては、入力文字列を１つずつを配列に入れて、それぞれの変換 をかけ、１つずつ組み合わせて出力しているのですが、どうもうまくいきません。 手法は特に固執してませんので、どの様な形でも結構です。 よろしくお願いします。
今Net::SMTPを使ってメール配信するプログラムを作っています。 簡単なメルマガ配信のようなものです。 プログラムではループを使って一件、一件配信するのではなく、bccで一斉に送ろうと思っています。 その時に、bccで送ることのできるMAX件数はいくらぐらいなのでしょうか？ 実際に送る件数は300件を超えることはありません。 ご教示よろしくお願いいたします。
出力が”HASH(0x197fa1c)”のような場合、どう解析してけばいいでしょうか？ --------------------------------------------------------------------- #!C:\Perl\bin\perl.exe -w use strict; use Win32::OLE::OPC; #変数↓ my $items_stringP1 = "PLC0"; #OPCServer のデバイス名 my $items_stringP2 = "D"; #MELSECのデバイス名称 my $items_stringP3 = 0; #先頭アドレス my $maxcount = 1; #点数(5) #変数↑ my $opcintf = Win32::OLE::OPC->new('OPC.Automation', 'Takebishi.Dxp'); my $group = $opcintf->OPCGroups->Add('grp'); my $items = $group->OPCItems; my $items_stringP3_Min = $items_stringP3; my $count = 0; while ($count < $maxcount){ my $items_string=$items_stringP1.".".$items_stringP2.$items_stringP3; $items_stringP3 ++; $count ++; $items->AddItem($items_string, $opcintf); } print "********************"."\n"; print $items ."\n"; print "********************"."\n"; my $key; foreach ( keys %$items) { print "キー値 : $key\n"; } --------------------------------------------------------------------- 出力結果：↓ ******************** Win32::OLE::OPC::Items=HASH(0x197fa1c) ******************** Use of uninitialized value $key in concatenation (.) or string at C:\testPerl\OPC\OPC08.pl line 38. キー値 : Use of uninitialized value $key in concatenation (.) or string at C:\testPerl\OPC\OPC08.pl line 38. キー値 : Use of uninitialized value $key in concatenation (.) or string at C:\testPerl\OPC\OPC08.pl line 38. キー値 :
ActivePerl（Windows）でダウンロードしたモジュールを使えるようにする方法を教えてください。 Win32::OLE::OPC1.01を下のサイトからダウンロードして使用したいのですが どうインストールするのかよくわかりません。 https://metacpan.org/release/Win32-OLE-OPC
http://okwave.jp/qa/q8823112.html こちらで質問させていただいたように、/public_html/file.zipではなく、/file.zipの ファイルをダウンロードさせるために以下の方法を取りました。 print "Content-type: application/x-tar\n\n"; open( FH, "$filename" ); binmode FH; binmode STDOUT; print <FH>; close( FH ); この方法では、ブラウザで表示させてダウンロードできるようになったのですが、 これをperlで、wgetか、何かを使って取得したいと考えています。 ところが、wgetで試したところ、zipファイルではなく、cgiページ自体のソースの取得になってしまいました。 zipファイルを取得するにはどのようにしたらよいのでしょうか。 perlの知識があまりないので、どうしても解決できません。 宜しければ具体的に書き方を教えていただけると大変助かります。どうぞよろしくお願いいたします。
/publick_html/に、ホームページファイルがあります。 /publick_html/a.zip をCGIで読み出す時は、 print "Location: "./a.zip"\n\n"; でいいのですが、 /a.zip　を読み出す時の方法がわかりません。可能でしょうか？ お手数をおかけいたしますが、よろしくお願いいたします。
お世話になります。 すいません教えてください。 $bannerには、GIFバナーにリンクが付いている内容です。 内容としては、 <a href="http://www.homepage.com/"><img src="mihon.gif"></a> とします。 これを、 print "$banner\n"; と書くと、バナーが表示されてしまいます。 これを、ウェブ上でHTMLで<a href="http://www.homepage.com/"><img src="mihon.gif"></a>と表示させるにはどうしたらいいのでしょうか？ よろしくお願い致します。
日付をファイル名とし、データ量で「-」と「数字」を付加した ２ページ目以降が作成され、日によって１～１０ページ程度の htmlファイルが以下のように出来上がります。 ./hoge/20141106.html ./hoge/20141106-2.html ./hoge/20141106-3.html 以下の処理で「./hoge/20141106.html」は削除できましたが、 「-2」や「-3」以降も削除する記述をご教示お願いします。 unlink("hoge/$temp.html"); どうぞ宜しくお願いします。
WEB開発業者に委託したWEBアプリの開発言語が「perl」で 作成されたものでした。 知り合いの業者さんに聞くと、「滅び行くコード」を使っているとの事です。 まだローンチしていないサービスですが、「perl」で作られたサービスを 今後、数年間運用してゆけるのか不安に想い今回質問させて頂きました。 もし、最短３年ほどの運用に耐えられないものでしたら、ある程度のコストを かけてでも、別会社へ再委託したいと思います。 忌憚のない意見をお聞かせ下さい。
例えば、与えられた配列が (1, 3, 5, 7, 9, 2, 4, 6, 8, 10) だった場合に、 入力配列が (1, 2, 3, 4, 5) だったら、(1, 3, 5, 2, 4) のように並び替えた いと考えています。 下記のような方法を考えましたが、いずれもできそうにありません。 grep { @ref } @input map { grep { $_ } @ref } @input forループ等を使えば容易にできるのでしょうが、なるべく自前のコードは書き たくなく、map, grep, sort等を組み合わせてできればよりベターだと考えてい ます。 なんとか、スマートな方法でこれを実現することはできないでしょうか。
素人質問で恐縮です。 perlからphpに変数の値を渡す事は可能でしょうか。 同一サーバー内に、/hoge/aaaa.pmと/sample/bbbb.phpがあります。 置き場所はそれぞれで特に関連性はありません。 aaaa.pm内で定義した my $data = "あいうえお"; のような変数を、 bbbb.php内で受け取って使いたいです。 jQuery.ajaxでphpとjs間で変数の受け渡しが可能なのですが、 そんなイメージでやり取りできたらいいなと思っています。 難しい話であれば諦めます。 perlもphpも素人ですが、簡単なやり取りで済みそうなら取り入れたいです。 不明点などありましたら、ご質問ください。 よろしくお願いいたします。
perlプログラムにて、住所から　緯度経度を一括取得したいと考えております。 入力ファイル（住所データ　リスト）1万レコード程度 　千代田区○○1-1-1 　港区XX2-2-2 　・・・ 出力ファイル（住所<ＴＡＢ>緯度<ＴＡＢ>経度） 　千代田区○○1-1-1<TAB>3Ｘ．ＸＸＸ<ＴＡＢ>13Ｘ．ＸＸＸ 　港区XX2-2-2<TAB>3Ｘ．ＸＸＸ<ＴＡＢ>13Ｘ．ＸＸＸ 　・・・ ＧｏｏｇｌｅＡＰＩを使えばよいのかと思いますが、全くperlからの呼び出し方法がわかりません。 教えてください。（ｗｉｄｏｗｓにperｌをインストールして　使っています。）
Perlで、変数に既に格納されているエスケープされた特殊文字を、もとの文字に展開するには どのようにしたらよいでしょうか。 つまり、\t という値で格納されているのをタブ文字にしたり、\\ という値であれば\の一文字に するという事です。 ダブルクォートで定義すれば展開されると思いましたが、展開は変数の代入時に行われるだけで、 既に変数中にエスケープされて入っているものはダブルクォートを使い変数を囲んだりしても展開されません。 下記は簡単な例でやろうとしてる事を示したものです。 add変数に\tというタブを意味するエスケープされた特殊文字を含んでいるとして、その\tを タブとして展開し、abc defのようにさせたいのですが、abc\tdefと入ってしまいます。 $ cat unescape.pl #!/bin/perl $add = '\tdef'; #シングルクォートで代入すると、もちろんエスケープされたまま代入される #$add = "\tdef"; #ダブルクォートで代入すると代入時にタブへ展開される #$add = $ARGV[0]; #本当はAGRVからエスケープ特殊文字を含んだ文字列を取りたい。ARGVから代入すると、シングルクォートの時のようにそのまま代入される $tgt = 'abc'; print "add: " . $add , "\n"; print "before: " . $tgt . "\n"; $tgt .= "$add"; #既にエスケープされた形で代入されているものを、ダブルクォートで囲んで使っても展開されない print "after: " . $tgt . "\n"; $ perl unescape.pl add: \tdef before: abc after: abc\tdef
条件に一致した塩基配列を含むデータの抽出方法を教えて下さい。(perl) 下記のように、塩基配列（ACTTC…）と、その上に配列名（>id_000)が 数百万配列ならんだデータがあります。 （fasta形式） >id_001 CGCTGCCGGGGAACGGTCTGGTCAGGGATCTATCATGAGG CGTGGGAATTTCGCCCCGGACAGTGAGGATTTGGGTGCTT CCTTTGCTGTGATTTTAAGTTACCTCACCAAA >id_002 GCAGTCCTTCGCCTGAAGTGCAGGACGGGTAGTAACGTAG AGAGATCTTGCTTAGTTACTACTGC >id_003 　・ 　・ この中から、指定した塩基配列（例：TGAAGTGCA）を含むデータを、 下記のように別名のファイルに、配列名と塩基配列を一緒に出力したいのですが、 どのようにすればよいかが、分からず困っています。 >id_002 GCAGTCCTTCGCCTGAAGTGCAGGACGGGTAGTAACGTAG AGAGATCTTGCTTAGTTACTACTGC >id_015 ATGTGAAGTGCAGTGTGTTAGT 　・ 　・ 「BioPerl」のSeqIOオブジェクト?を使用することで、 何とか同じ結果を出せるようにはなったのですが、 実際に、どのような処理がされているのかは、理解できていません。 今後、色々なパターンに活用できるよう、perlだけの記述では どのような記述をすればよいのか、理解したいのです。 perl初心者なので、より基本的な記述だと助かります。 よろしくお願い致します。
Windowsのバッチファイルで、Perlを使って特定の文字列を含む行を抽出する処理を行っているのですが、うまくいかないケースがあります。 例えば、以下の線内のようなテキストがあって、 ---------------------- 〔a 〔A ゜a ゜A ---------------------- 大文字/小文字を問わず、「〔a」を含む行を抽出し、 以下の線内のような結果を得たいとします。 ---------------------- 〔a 〔A ---------------------- 検索対象ファイルの文字コードが「Shift-JIS」で、 「print if ( /〔a/i );」という構文で行を抽出すると、 以下の結果になってしまいます。 ---------------------- 〔a 〔A ゜a ゜A ---------------------- 「print if ( /〔a/ );」なら以下の結果になってしまいます。 ---------------------- 〔a ---------------------- 検索対象ファイルの文字コードを「UTF-8」にし、 「print if ( /〔a/ );」という構文で、 「〔a」を含む行を抽出しようとすると、何も行が抽出されません。 他のコマンドでの大文字/小文字問わない「〔a」を含む行の抽出は、 findstrでは得たい結果が得られ、 grep、AWKでは、Perl同様、「゜a」を含む行が抽出されてしまいます。 しかし、私が行いたい処理は、数百～数千程度の単語が書かれた単語のリストがあり、そのリストをスクリプト形式に置換して行を検索するので、スクリプトファイルに対応していないfindstrコマンドでは不便なのです。 上記の問題の原因が分かる方がおられましたら、お教え頂けないでしょうか。
aaa.txt 06011800, 5.3 06012100, 5 06020000, 4.5 06020300, 6.2 … bbb.txt 06011800, 5.1 06012100, 7.5 06020000, 5.1 06020300, 9.3 … という二つのファイルがあります。 以下のプログラムを用いて、 06011800, 5.3, 5.1 06012100, 5, 7.5 06020000, 4.5, 5.1 06020300, 6.2, 9.3 … といった感じでデータを作る事に成功したのですが、どうしてもループに無駄が多く、時間がかかってしまいます。 連想配列などを使えば時間が短縮出来そうなのですが、よくわかりません。 ご教示いただけないでしょうか。 以下、作成したプログラム。 $csvfile1 = $ARGV[0]; $csvfile2 = $ARGV[1]; open(DAT1, $csvfile1) || die $!; while($line=<DAT1>) { chomp($line); @dat = split(/,/,$line); open(DAT2, $csvfile2) || die $!; while($line2=<DAT2>) { chomp($line2); @dat2 = split(/,/,$line2); if($dat[0] == $dat2[0]){ print "$dat[0],$dat[1],$dat2[1]\n"; } } } close(DAT);
プログラミングが得意な方お願いします。 下図のリンクのページランクをPerlで実装したいのですが、 まずPDLモジュールをダウンロードし、リンク隣接行列を下記のように定義しました。 use PDL::Lite; my $mat1 = pdl [ [0, 1, 1/2, 0, 1/4, 1/2, 0], [1/5, 0, 1/2, 1/3, 0, 0, 0], [1/5, 0, 0, 1/3, 1/4, 0, 0], [1/5, 0, 0, 0, 1/4, 0, 0], [1/5, 0, 0, 1/3, 0, 1/2, 1], [0, 0, 0, 0, 1/4, 0, 0], [1/5, 0, 0, 0, 0, 0, 0] ]; そして下記の列ベクトルと上記の行列をかけてその答えと上記の行列をかけてさらにその答えと上記の行列をかけて・・・を繰り返し、掛けても答えが変わらなくなったところでその列ベクトルの値を取り出し正規化して出力するという方法を考えました。 my $mat2 = pdl [ [1], [1], [1], [1], [1], [1], [1] ]; ここで質問ですが、上記の処理をwhile文で実行したいのですが掛けても答えが変わらなくなったところでwhileからループを抜ける処理はどのように書いたら良いのでしょうか？ Perlは初心者で、行列同士の比較はwhileの条件文ではできないでしょうし、列ベクトルの要素を一つ一つ比較する方法も分かりません。 以上写真のページランクをperlで取得する方法、宜しくお願い致します。
Perlの正規表現で、「)」（カッコ閉じ）は、「(」（カッコ開け）同様メタ文字で、もし/)/のようなマッチ演算子を書いて、「)」という文字列を検索しようとすると、Unmatched ) in regexというエラーになります。 しかし、「]」（角カッコ閉じ）や、「}」（中かっこ閉じ）は、メタ文字ではなく、/]/、/}/のようなマッチ演算子は正当で、それぞれ]、}をきちんと検索するのです。 「[」（角カッコ開け、文字クラスを作る）や、「{」（中かっこ開け）はメタ文字なのに、です。 開けがこないのに閉じが来た場合、]と}はエラーにならないのに、)だけはエラーになります。 これは、なぜでしょうか。
perlを勉強していて、似たような配列やハッシュの場合でしたらなんとか解決出来たのですが、以下の場合が思うような結果が得られず困っているので、どなたか教えていただきたく質問しました。 例） my $hoge1=10; my $hoge2=9; my $hoge3=8; my $hoge4=7; my $hoge5=6; my $hogehoge; for(1..5){ $hogehoge+=$hoge$_; } 上記の書き方の場合、「$hoge$_」でエラーが出ます。 このような場合は、どのように書けばいいのでしょうか。 よろしくお願いします。
初歩的な質問で恐縮ですが、以下のPerlのワンライナーを、スクリプトファイルに記述するには、どのように書けば良いのでしょうか。 perl -ne "print if ( /aaa/ ); print if ( /bbb/ ); print if ( /ccc/ );" "in.txt" > "out.txt" 下記のようにしてみたのですが、ダメでした。 perl "script.pl" "in.txt" > "out.txt" ----- script.plの内容 ----- print if ( /aaa/ ); print if ( /bbb/ ); print if ( /ccc/ ); --------------------------- 環境はWindowsのコマンドプロンプトです。バッチファイルでの使用を想定しています。 自分はPerlに関する知識が無いので、Perlに関するサイトも見てみたのですが、情報が膨大で、ピンポイントでこの問題を解決する情報を探し出す事が出来ませんでした。 やり方が分かる方がおられましたら、お教え頂けないでしょうか。
perlにてCSVファイルの中で特定の条件の時に 文字を削除する分を書きたいのですがうまくいかず困っております。 1111,11110000,4 2222,11110000,4 3333,11111100,2 4444,11000000,6 このようなデータで 3番目のフィールドを元に2番目のフィールドの文字を削除したいと思っております。 4の場合はお尻から4つの0を削除　→　1111,1111,4 2の場合はお尻から2つの0を削除　→　2222,111111,2 上記のデータですと最終的には以下のような形にしたいと思っております。 1111,1111,4 2222,1111,4 3333,111111,2 4444,11,6 お手数おかけしますがお力添えただけたら幸いです。
アクセス元の端末（たとえばスマホなのかＰＣなのか）で表示する画像を変えたいため、アクセス端末の解像度を取得したいのですがどうすればよいでしょうか？ いろいろ探してみたのですが、javascriptばかりヒットし、use Term::ReadKeyというものも出てきたのですが、その参考ページをそっくり入れてみても動作しません。 sub agent{ %agent_type = ( qr/MSIE/i => 'p', qr/iPhone/ => 's', qr/iPad/ => 't', qr/Android/ => 's', 一部省略 ); } sub browser{ &agent; my $ua = $ENV{'HTTP_USER_AGENT'}; foreach my $key(keys %agent_type){ if ($ua =~ $key){ $ua_type = $agent_type{$key}; last; } } } 上記のような環境変数で振り分けることも考えたのですが、Androidだとスマホとタブレットと解像度が大きく違うものでも同じものをはき出してしまうかと思い、正確な振り分けができず困っています。 どうかperlだけで解決できる方法がありましたらぜひ教えてください。 よろしくお願いします。
フォームメール送信の文字化けについてお教え下さい。 よろしくお願い致します。 まずは環境より申し上げます。 環境 xampp-win32-1.7.7-VC9 同封 apache2.2.21 php5.3.8 perl 同封されているもの ----------------------------- 　xmailサーバーも動いています。 内部、外部、外部から外部、ともに正常に送受信できています。 以前はANHTTPDとperlとsendまね～るで問題なく動いていましたが このたびPHPが必要になりましたので以前のperlをアンインストールしてXAMPPをインストールしました。 以前からの自作のメールフォームを設置してメールを送信すると 受付確認メールと問い合わせ報告メールのすべてが文字化けしています。 一応　文字コードはUTF-8で　mail.html、 perlプログラム、ともに統一しています。 apacheのhttpd.confの中にはAddDefaultCharset・・・の設定項目がなぜかありませんので apacheについては文字コードの設定などはおこなっておりません。 症状ですが メールフォームに入力して確認ボタンを押すと現れる確認画面は 文字化けしておりません、高崎、申す、表示という文字も化けていません。 このあと送信ボタンを押すと　メールは宛先へ正常に届きますが タイトルからすべてが文字化けで読む事はできません。 原因探しが三日くらい続き、気になって寝られません。 ひろいあつめて書いたコードですが、 よろしくお願いいたします。 # MIMEエンコード $mail_to = mimeencode($MAILTO); $mail_from = mimeencode($FORM{'name'}); $mail_subject = mimeencode($FORM{'subject'}); # 文字コードの変換 $body = jcode::jis($user_owner); # メールヘッダーの生成 $header = <<END; To: $mail_to From: $mail_from<$FORM{'email'}> Subject: $mail_subject Mime-Version: 1.0 Content-Type: text/plain; charset=ISO-2022-JP # サーバー出力 print <<END; Content-type: text/html; charset=utf-8 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"> # メールの送信 open(MAIL, "| $SENDMAIL -i -t -f $FORM{'email'}") or die("エラー：sendmailへのパイプが開けません"); print MAIL $header, $body; close MAIL; 部分的で分かりにくいかもしれませんが どなたか　どうぞよろしくお願いいたします。
perlでメールフォームを作成しています。 メールの送信にはsendmail をopen関数で使用していたのですが openはセキュリティ上の問題があることを知り、対策を調べているうちに sysopenを使用することが有効だという情報にたどり着きました。 しかし、単純にopenをsysopenに書き換え、オープンモードも設定したのですが sysopenに失敗してしまいます。 sendmail以外のテキストファイルのオープンには成功しているので sysopenの使用方法が間違っている sysopenを使用したsendmailの実行方法を教えていただけませんでしょうか？ [ソース] use Fcntl; … $sendmail = '/usr/xxx/sendmail -t -io'; … sysopen(MAIL,"$sendmail ", O_WRONLY ) or die "error!!" my $mailstr = &MAILHEADER($to,$subject); my $mailbody = &MAILBODY($fileId); $mailstr .= $mailbody; print MAIL $mailstr; close MAIL; &MAILHEADER() 　　→To,From,Subjectの設定 &MAILBODY() 　　→メール本文の設定 ・sysopen部分は今まで以下の記述で、メールの送信をしていました。 　　open(MAIL,"| $sendmail") or die "error!!" 　・念のため、-fで「/usr/xxx/sendmail」の存在チェックをおこない、 　　存在していることを確認しました。 　・sysopenの使用方法が間違っているのかと思い、以下のサンプルを作成してみましたが 　　問題なく動きました。 my $file = 'test1.txt'; sysopen(MSG,$file, O_WRONLY|O_CREAT|O_APPEND ) or die "sysopen error!!" print MSG "sysopen OK"; close MSG; サンプルが動いたことで、ますますsendmailをオープンできないことに 行き詰ってしまいました。 どうぞよろしくお願いいたします。 質問内容でわかららない部分があればご指摘ください。 可能な限りソースも載せます。
ファイル内の「1 2 3 4 5」などの数字の箇所を、「1回 2回 3回 4回 5回」のように、「回」をつけた形に変えることを考えています。 以下のようなスクリプトを書きましたが、うまくいきません。 # 「$search_replace」の参照先のテキストファイルの内容 (\d) タブ記号 $1回 ・ ・ EOF # 問題のスクリプト（一部） chomp($search_replace); (my $search, my $replace) = split(/\t/, $search_replace); $string[$i+1] =~ s/$search/$replace/g;　#ここが問題と思われる箇所 ほしい結果は右のとおり。「1回 2回 3回 4回 5回」 現実の結果は右のとおり。「$1回 $1回 $1回 $1回 $1回」 置換文字列の$1の部分がうまく展開（？）できないようです。 どうすればよいか、ご教示ください。
perlのfork機能を使いたい者ですが、その挙動について質問しています。 ここ数日fork機能について勉強しましたが、 その挙動がどうでしても理解できないので、質問をさせていただいています。 質問内容を具体的にするため、以下に簡単なコードを書いておきます。 #!/usr/bin/perl use strict; my $i=0; while ($i<3) { if(fork()) { print("parent hello -> $i\n"); last; } else { print("child hello -> $i\n"); sleep 3; print("child exit -> $i\n"); $i++; } } print("parent finish\n"); このコードをlinux上で起動させますと、下記の結果が得られました。 parent hello -> 0 parent finish child hello -> 0 child exit -> 0 parent hello -> 1 parent finish child hello -> 1 child exit -> 1 parent hello -> 2 parent finish child hello -> 2 child exit -> 2 parent finish ここから質問です。 上記の結果の中で自分が理解できないのは、 なぜ、「parent finish」が４回も出てくるのかということです。 自分の理解している部分では、「parent finish」はwhile loopの外にあるので、 「parent finish」をプリントするには、一度while loopを出る必要があると思います。 しかし、それが２、３回と続いてプリントされていることがなぜなのか理解できません。 理想としては、 parent hello -> 0 child hello -> 0 child exit -> 0 parent hello -> 1 child hello -> 1 child exit -> 1 parent hello -> 2 child hello -> 2 child exit -> 2 parent finish という具合に、「parent finish」を一回だけ表示させたいのですが、それは可能でしょうか？ ご教授をお願いします。よろしくお願いします。
今まで長い間、何か勘違いしていたのか、条件が2つ以上になると、 長い間このように書いていたのですが、 if( ($a%2==1 && $b==1) && ($c eq 10 && $d == 5) ) { print "ok"; } 下記スクリプトでも正常に動作しますか？ if( $a%2==1 && $b==1 && $c eq 10 && $d == 5){ print "ok"; }
IEのバージョンを10に上げたらTIFF画像へのリンクでメッセージが表示されるようになりました。 HTMLのソースは、以下のように書いています。 <a href="test.tif" target="_blank">tiff</a> ローカルのWindowsには、.tifに対してフリーウェアの画像閲覧ソフト(IfranView)に関連付けしています。 以前のバージョンのIEでは、上記のリンククリックで直接メッセージを表示することなくIfranViewでTIFF画像が開いていました。 IE10で、メッセージを表示させずにリンククリックでtiff画像が開くようにすることはできますでしょうか？ サーバー側の設定変更でも、ローカル側の設定変更でもかまいません。 Perlでtiff画像を表示するプログラムを作っています。 画像へのリンクが多く、大量の画像を確認しながら作業を進めるプログラムです。 クリックのたびにメッセージから「ファイルを開く」をクリックするのが面倒です。 ■環境 サーバー ・Perl5 ・Apache（自分に直接の権限はありませんが、業者に設定変更お願いすることできます) ローカル ・Windows7 ・IE10 ・IfranView(画像表示ソフト)←tiffが表示されるのでしたら別アプリでもかまいません。
WEBで自作mp3を公開しています。再生時にカウンタを入れています。 （各所に出ているHTMLカウンターです） カウンター自体の機能はちゃんと動くのですが、 何１０曲ものカウントが一斉に瞬時に行われているのです。再生時の時刻もIPアドレスも同じなのです。 普通に1曲1曲聞いていれば数分おきに、カウント数もバラバラになるはずですが。 何かプロバイダの検索収集かなと思うのですが、こんなのはカウントしたくないのです。 何かいい方法はありませんかね？ そういうIPアドレスを１つ１つ除外するというロジックを入れるしかないかと思っているのですが。
HTMLでメールフォームを作りCGI（Perl）で次のプログラムを作りました。 #!/usr/local/bin/perl print "Content-type: text/html\n\n"; print "$mail\n"; print "$namae\n"; print "$naiyou\n"; 動作確認のためプログラムは少しにしました。何も表示されません。
#/usr/local/bin/perl print "Hello!"; と入力して実行したらエラー500が出ました。 Windows7で Active　Perl　5.16.3（x86） Apache httpd-2.0.65-win32-x86-no.ssl.msi(x86) のインストール済みです。 原因がわかりません。
%array = ( 'A' => { 　 'a' => 7, 　 'b' => 3, 　 'c' => 9, 　 'd' => 1, }, 'B' => { 　 'a' => 3, 　 'b' => 8, 　 'c' => 3, },); のようなハッシュがあったとして、値の降順、1つ目のキー昇順、2つ目のキー昇順でソートし、下のような形で出力したいのですが、どのようにすればよいのでしょうか。 A　 c　 9 B　 b　 8 A　 a　 7 A　 b　 3 B　 a　 3 B　 c　 3 A　 d　 1
Windows7(64bit)にPerlをインストールしようと思います。(CPANも利用したい) Cygwin, Active Perl, Padre など、いろいろな方法があると思いますが、おすすめは何ですか？ 将来的にMacやLinuxに機種替えをすることを射程に入れた場合を考えて、使い勝手をWindows特有の環境ではなく、なるべく汎用的なものにしたいと思うのですが、違いがわかりません。ターミナルの選択も合わせておすすめを教えていただければと思います。
CGI(Perl)でメールアドレス、名前、内容のメールフォームを作ったのですがうまくいきません。 http://homepage.biglobe.ne.jp/errorpage/500.html CGIプログラムのエラーが発生しました。 原因 CGIプログラムの実行に問題があります。 まれに、予期しないサーバのエラーが原因でこのメッセージが出る場合があります。 と表示されます。 CGIのプログラムを作る前はHTMLだけで作っていました。 <form action="mailto:メールアドレス"～ メールアドレスを非公開で送信するには。
GD::SecurityImage::AC Image::Magick 上記のモジュールをactive_perlのppmでインストールしたいのですが、リポジトリがなかなか見つかりません。リポジトリ の場所をご存じでしたら教えていただけませんでしょうか。よろしくお願いいたします。 動作環境と登録済のリポジトリは以下です。 ちなみにppmはGUIを使っています。 os : windows8.1 perl : active_perl 5.16.3 登録済のリポジトリ　 : http://www.bribes.org/perl/ppm http://www.bribes.org/perl/ppm/package.xml http://log4perl.sourceforge.net/ppm http://trouchelle.com/ppm10/ http://cpan.uwinnipeg.ca/PPMPackages/10xx/ http://www.wxperl.co.uk/repository/ansi http://www.wxperl.co.uk/repository http://ftp.nara.wide.ad.jp/pub/CPAN/authors/id/H/HM/HMBRAND/ です。 宜しくお願い致します。
jcode.plの jcode::tr() のかわりを探しています。 jcode.plの jcode::tr(\$val,'０-９Ａ-Ｚａ-ｚ　（）＿＠－','0-9A-Za-z ()_@-'); をPerl5.18.2で使用するとエラーが出てしまいます。これを回避したい。 プログラムがUTF-8であれば $val =~ tr/０-９Ａ-Ｚａ-ｚ　（）＿＠－/0-9A-Za-z ()_@-/; のようにすれば実現可能みたいですが、プログラムはEUCで書かれています。 影響範囲からプログラムの文字コードをかえることはできれば避けたい。 一文字ずつ変換することも考えましたが、この方法ではパフォーマンスに懸念があります。 jacode.plなるものもありますが、これに置き換えるだけでは文字化けしてしまいました。 jcode::tr()のかわりになるような手段はあるのでしょうか？
サンプルプログラムで Perl を勉強しているのですが、以下の「stringify」の意味がいまいちわかりません。 画像検索APIから画像URLを引いてきて、その画像をダウンロードするサンプルです。 ---- $ua->get($image_url, ':content_file' => $filepath->stringify); ---- ※http://yusukebe.com/archives/20120229/072808.html LWP::UserAgent のリファレンスを見ても、:content_file => $value と書いてあるだけで、stringfy についてはわかりません。ほか検索もしてみたのですが、でてくる結果が JSON.stringify ばかりで、それのことなのかも判断できません。 この「stringify」はどういう意味なのでしょうか。
ActivePerlの初心者ですが基本的なことが分からないので教えてください。 まだ覚えたばっかりで1行入力でいろいろ書式を入力して確認しながら覚えているのですが 例えば、ネット上に 各行の最初の10文字を捨てる perl -lne 'print substr($_, 10) = ""' file というようなサンプルが記述されているのですが 実際に入力してみると 「Can't find string terminator "'" anywhere before EOF at -e line 1.」 というようなエラーが出ます。 どうも　'　が使えないようなのですが なぜエラーになるのかがよく分かりません。 この原因が分からないので試行錯誤で ' を " で行ったりして エラーを回避しながら確認しているのですが 上記のように ' と ' の中にさらに " と " がある場合には どのように回避したらよいのかがよく分かりません。 上記のような例の場合にはどのように入力すれば エラーが出なくなるのでしょうか。
WindowsXPにActivePerl(5.16.3.1603)をインストールして、 コマンドラインに「perl script.scr」と入力して スクリプトファイルは実行できるのですが、 スクリプトファイルの1行目に「#!/usr/bin/perl」を記述して、 コマンドラインに「script.scr」と入力して実行しようとすると、 「C:\・・・\script.scrは有効なWin32アプリケーションではありません。」 というメッセージが表示されて正しく実行できません。 perl.exeのあるフォルダをC:\usr\binフォルダにして、 1行目を #!/usr/bin/perl #!C:/usr/bin/perl #!C:\usr\bin\perl などいろいろ試してみましたが、どれも 前述のメッセージが表示されて実行できませんでした。 コマンドラインに「script.scr」と入力するだけで 実行することができるようにするには どのようにすればいいのでしょうか。 script.scrの拡張子scrをplなどに変更して この拡張子のファイルに対してperl.exeに関連付けることにより script.plだけでも実行できるようにはなりますが 拡張子.scrではこの関連付けができませんので #!/usr/bin/perl等を使用する方法で解決したいです。 ジャンクションとかApacheなどが全く分かりませんので これらを使わずに簡単にできる方法がありましたら教えてください。 (なお使っても分かりやすい手順があれば可です) よろしくお願いします。
Perlでcgiのページを作っています。文字コードはEUCです。 最近、IEのバージョンを８から１０にアップグレードしたのですが、 自分の作ったページが、たまに文字化けするようになりました。 IE10のエンコード設定は「自動選択」にしていますが、 自動で「西ヨーロッパ言語(ISO)」に判断されてしまいまうことがあります。 Perlのcgiの文字コードはEUCで、ソースには以下のようにEUC-JPを指定しています。 <meta http-equiv="Content-Type" content="text/html;charset=EUC-JP"> 手でIE10の文字コードをEUCに設定すれば文字化けは直るのですが、 数日経つとまた同じように文字化けで「西ヨーロッパ言語(ISO)」に自動判断されてしまいます。 metaでEUC-JPをしていればブラウザ側で自動判断してくれると思っていたのですが、違うのでしょうか？ HTMLでmeta以外に文字コードを指定するところがあるのでしょうか？
菊池と申します。 perlスクリプトで下記のような文字列を検索し、検索されたら指定したフィールドの値を変数に入れたいのですが、grepやawkを使うと、ファイル中のすべてが検索対象になってしまい困っております。 文字列検索の表現方法をご教授頂けると大変助かります。 下記へperlスクリプトの一部を記載させて頂きました、データはcsv形式です。 変数に入れる事が出来なかったので、抽出した値をファイルへ出力させています。 検索文字列＝2013/11/19,09:00:00,13:00:00 データの中味 <94>N/<8c><8e>/<93>ú,<89>ð<90>Í<8a>J<8e>n<8e><9e><8d><8f>,<89>ð<90>Í<8f>I<97>¹<8e><9e><8d><8f>,<8c>ö<8b>¤<8d>À<95>WX(m),<8c>ö<8b>¤<8d>À<95>WY(m),<95>W<8d><82>H(m),<88>Ú<93>®<95>½<8b>Ï<92>lX(m),<88>Ú<93>®<95>½<8b>Ï<92>lY(m),<88>Ú<93>®<95>½<8b>Ï<92>lH(m),<8f><89><8a>ú<92>l<82>©<82>ç<82>Ì<95>Ï<93>®<97>ÊX(m),<8f><89><8a>ú<92>l<82>©<82>ç<82>Ì<95>Ï<93>®<97>ÊY(m),<8f><89><8a>ú<92>l<82>©<82>ç<82>Ì<95>Ï<93>®<97>ÊH(m),2D<8b><97><97>￡(m),3D<8b><97><97>￡(m),<88>Ú<93>®<95>½<8b>Ï2D<8b><97><97>￡(m),<88>Ú<93>®<95>½<8b>Ï3D<8b><97><97>￡(m),<91>ª<88>Ê<83>t<83><89><83>O,<91>ª<88>Ê<90>¸<93>x,<88>Ù<8f>í<92>l<83>t<83><89><83>O<81>i<8f><89><8a>ú<92>l<81>j,<88>Ù<8f>í<92>l<81>i<8c>x<89>ú<83><89><83><93><83>N<81>j,<94>ò<82>Ñ<92>l<83>t<83><89><83>O, 2013/11/18,01:00:00,05:00:00,-68213.2327,17746.2653,2093.7982,-9999.0000,-9999.0000,-9999.0000,5.0099,-0.5989,-4.8100,16215.1100,16255.8006,-9999.0000,-9999.0000,4,0.0019,0,0,0, 2013/11/18,05:00:00,09:00:00,-68213.2273,17746.2666,2093.7872,-9999.0000,-9999.0000,-9999.0000,5.0153,-0.5976,-4.8210,16215.1061,16255.7959,-9999.0000,-9999.0000,4,0.0014,0,0,0, 2013/11/18,09:00:00,13:00:00,-68213.2256,17746.2692,2093.7792,-9999.0000,-9999.0000,-9999.0000,5.0170,-0.5950,-4.8290,16215.1030,16255.7923,-9999.0000,-9999.0000,4,0.0016,0,0,0, 2013/11/18,13:00:00,17:00:00,-68213.2236,17746.2737,2093.7682,-9999.0000,-9999.0000,-9999.0000,5.0190,-0.5905,-4.8400,16215.0981,16255.7866,-9999.0000,-9999.0000,4,0.0014,0,0,0, 2013/11/18,17:00:00,21:00:00,-68213.2306,17746.2741,2093.7672,-9999.0000,-9999.0000,-9999.0000,5.0120,-0.5901,-4.8410,16215.1015,16255.7899,-9999.0000,-9999.0000,4,0.0016,0,0,0, 2013/11/18,21:00:00,01:00:00,-68213.2308,17746.2739,2093.7882,-9999.0000,-9999.0000,-9999.0000,5.0118,-0.5903,-4.8200,16215.1017,16255.7916,-9999.0000,-9999.0000,4,0.0016,0,0,0, 2013/11/19,01:00:00,05:00:00,-68213.2221,17746.2743,2093.8062,-9999.0000,-9999.0000,-9999.0000,5.0205,-0.5899,-4.8020,16215.0968,16255.7880,-9999.0000,-9999.0000,4,0.0017,0,0,0, 2013/11/19,05:00:00,09:00:00,-68213.2140,17746.2808,2093.7982,-9999.0000,-9999.0000,-9999.0000,5.0286,-0.5834,-4.8100,16215.0870,16255.7777,-9999.0000,-9999.0000,4,0.0013,0,0,0, 2013/11/19,09:00:00,13:00:00,-68218.2472,17746.8587,2098.6543,-9999.0000,-9999.0000,-9999.0000,-0.0046,-0.0055,0.0461,16217.2238,16258.2532,-9999.0000,-9999.0000,4,0.0017,0,0,1, 2013/11/19,13:00:00,17:00:00,-68218.2538,17746.8600,2098.6633,-9999.0000,-9999.0000,-9999.0000,-0.0112,-0.0042,0.0551,16217.2263,16258.2563,-9999.0000,-9999.0000,4,0.0014,0,0,1, 2013/11/19,17:00:00,21:00:00,-68218.2603,17746.8538,2098.6473,-9999.0000,-9999.0000,-9999.0000,-0.0177,-0.0104,0.0391,16217.2349,16258.2638,-9999.0000,-9999.0000,4,0.0016,0,0,1, 　 ＜＜スクリプトの一部＞＞ #`grep "'2013/11/19,09:00:00,13:00:00'" $SS | awk -F"," '{print \$13}' $SS > $SS-2D`; #`grep "'2013/11/19,09:00:00,13:00:00'" $SS | awk -F"," '{print \$14}' $SS > $SS-3D`; `awk -F"," '\$1 ~ \/2013\/11\/19\/ && \$2 == \/09\:00\:00\/ {print \$13}' $SS > $SS-2D`; `awk -F"," '\$1 ~ \/2013\/11\/19\/ && \$2 == \/09\:00\:00\/ {print \$14}' $SS > $SS-3D`; 以上　よろしくお願いいたします。
下記のような文字列からhttp://.......jpや....pngなどの部分だけ抜き出したいのですがどうすればいいかわかりません。 どうすればいいでしょうか？？ <img src="http://i.yimg.jp/images/bloom/v201212/anonymous_24.png" width="24" height="24"> <img src="http://i.yimg.jp/images/clear.gif" alt="??????????????" width="1" height="1"> <img src="http://amd.c.yimg.jp/im_siggUafHxX5zBqYXXUl0MFuDGQ---x172-y200-q90/amd/20140212-00000043-dal-000-11-view.jpg" width="172" height="200" alt="???????????????????????????????????????????????????????" onContextMenu="javascript:return false;"> <img src="http://i.yimg.jp/images/news/cobranding/dal.gif" alt="????????????" width="170" height="40"> <img src="http://iwiz-talent.c.yimg.jp/im_siggAkAHOLx3UJ96IWzMLAa3aw---x80-y80-pril/o/talent/images/talent/201402/10/m07/m07-1255-140210.jpg" alt="???????????" border="0" width="80" height="80"> <img src="http://i.yimg.jp/images/news/v2/loading_32_b_2x.gif" width="32" height="32"> <img src="http://amd.c.yimg.jp/im_siggdUHHiAjMx0Vtxw6UiBjXGA---x49-y60-q90/amd/20140211-00000068-dal-000-8-view.jpg" alt="?????????????????????????????????Ф????????????"> <img src=" http://i.yimg.jp/images/evt/sochi/images/banner300x90.jpg" alt="????????????????????????" width="300" height="90"> <img src="http://lpt.c.yimg.jp/im_siggOxcR1sffKraZiSLM4Tvlwg---x60-y53-q90/amd/20140212-00000046-spnannex-000-thumb.jpg" alt="????????????μ???????????裲?????????Τ???"> <img src="http://lpt.c.yimg.jp/im_siggd24L.DRjsSsOFQzvcUudxA---x60-y40-q90/amd/20140212-00000104-scn-000-thumb.jpg" alt="???Ρ???????Ф???????????????????????"> <img src="http://lpt.c.yimg.jp/im_sigg5ySCgAEx9Mr.pAnTk_BLeA---x45-y60-q90/amd/20140211-00000010-tospoweb-000-view.jpg" alt="?????????????????????Ρ?????????"> <img src="http://lpt.c.yimg.jp/im_siggbLLaxB6uLw4PgQNbIotTPw---x57-y60-q90/amd/20140212-00000039-dal-000-view.jpg" alt="???????????????Τ????????????????????????????????????????"> <img src="http://amd.c.yimg.jp/im_sigg9vWalgQCOQonMxnTWgrpUg---x40-y60-q90/amd/20140211-00010000-jisin-000-2-view.jpg" alt="??????????????????????????????????????????"> <img src="http://i.yimg.jp/images/clear.gif" width="1" height="1" alt="?????????????"> <img src="http://i.yimg.jp/images/clear.gif" alt="???Υ???????????" width="1" height="1"> [Finished in 0.9s]
perlで特定のhtmlタグの情報を抜き出そうとしてHTML::TreeBuilderを使おうとしているのですが、インストールして実行してもlook_downメソッドがないといわれます。 しっかりとインストールはしているのであるはずなのですが・・・ どうすればよいか皆目見当もつかないのでどうぞよろしくお願いします。 ちなみにコードは以下の通りです↓ use strict; use warnings; use LWP::UserAgent; use HTML::TreeBuilder; use HTML::Element; use Encode; # urlを指定する my $url = 'http://www.nikkansports.com/'; # IE8のフリをする my $user_agent = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0)"; # LWPを使ってサイトにアクセスし、HTMLの内容を取得する my $ua = LWP::UserAgent->new; my $res = $ua->get($url); my $content = $res->content; # HTML::TreeBuilderで解析する my $tree = HTML::TreeBuilder->new; $tree->parse($content); $tree = decode("UTF-8",$tree); $tree = encode("Shift_JIS",$tree); # DOM操作してトピックの部分だけ抜き出す。 # <div id='topicsfb'><ul><li>....の部分を抽出する my @items = $tree->look_down('id', 'sideRanking')->find('li'); print $_->as_text."\n" for @items;
hello.pl というファイルに print “hello”; と、書きました。 ターミナルに perl -cw hello.pl と、入力しました。 Unrecognized character \xE2; marked by <-- HERE after print <-- HERE near column 7 at hello.pl line 1. と、メッセージが出ました。 解決方法を教えて頂きたいです。 よろしくお願いします。
初歩的な質問ですが、perlでプログラムを作っているのですが困っています。 現象はinput動作のとき、TYPT=textや、input=radioで入力を待っている画面で、マウスカーソルを枠の中に入れた時点から、マウスカーソルの形が「手」の形になり、その領域で（枠の中で）マウスをクリックすると初期画面(トップのHTMLページ)に戻ってしまいます。 一方、マウスカーソルをinputの入力範囲、あるいはradioのボタンの中に移動するとマウスカーソルは「手」の形から「矢印」の形になりinput入力やボタン選択が正常に出来ます。 この状態では、マウスを正確にinput入力範囲やradioボタンをクリックしないと初期画面に戻るため、マウス操作に大変神経を使うため困っています。 ほかの人の画面を見ていると、マウスカーソルはinput領域やボタンの中に入ったときだけ有効となり、ほかのどの領域でマウスをクリックしても初期画面に戻ったりせずに、何のアクションもしません。 私はそのようなマウス制御をしたいと望んでいます。 下記は色んな部分を端折ったプログラムですが原因を教えていただきたく。よろしく、お願い致します。 ==== <HTML> <BODY bgcolor="white"> <FORM ACTION="index.cgi" METHOD=get> <DIV style="top:148px; left:50px; position:absolute; z-index:3; id="Layer1"> <DIV><TABLE border="3" width="884" height="350"><TBODY><TR> <TD bgcolor="#ffffff" height="350" valign="top"><B><FONT size="+1"><BR></FONT></B> <FONT color="#ff0000">パスワードを５桁で入力してください</FONT> 　　⇒⇒　　<INPUT TYPE=text NAME=mypasswd size=6 value=></FONT></B> </TD></TR></TBODY></TABLE></DIV></DIV> </FORM> </BODY></HTML> ===
PerlのIF文の判断式につきまして、式全体を変数にしたいのですが、うまくできません。 初歩的な質問で大変恐縮ですが、他の言語を使っている人に聞いてもできるということなので、Perlでもできるような気がするのですが、うまく動かないので教えていただけませんでしょうか。 $ifbun="index(文字列, 検索したい単語) >=0"; if($ifbun){ 　処理 } とっても簡単な式なのですが、このままですと条件式を加味しない処理結果になっています。 $ifbunの中身をそのままIFの条件式に入れると問題なく条件式どおりの結果が得られるので、プログラムは間違っていないと思うのですが、変数に入れると、条件を加味していない結果が出てきます。 どなたかお分かりの方がいらっしゃいましたら教えてください。 どうぞよろしくお願いいたします。
Perlでデータベースサイトを作成しています。 通常、Perlでcgiを作成すると、動的なURLになると思いますが、それを静的なURLへ変換しています。 問題なのが、検索エンジンがクロールする時に、静的なURLと動的なURLの両方をクロールしており タイトルタグの重複が発生しています。 link rel="canonical"　で重複を解消できることは知っていますが、 諸事情によりこの機能が有効ではない状態です。 もし動的なURLになった場合に、自動的にHTMLのTITLEタグ内の最後に「★」を表示させて、 静的なＵＲＬと動的なＵＲＬとで発生しているタイトルタグの重複を解消したいと思っています。 どのようなコードを記載すれば、希望通りにできますでしょうか？ どうぞよろしくお願い致します。
Perlで、変数Aに代入された文字を変換し、変数Bに代入するプログラムを作りたいと思っています。 具体的には、「北海道」が変数Aに代入されると、「hokkaido」を変数Bに代入するというものです。 これを47都道府県全体でやりたいと思っています。 プログラムの都合上、 北海道 → 変数A → hokkaido → 変数B という流れで変換する必要があります。 具体的なソースを何卒ご教示いただければ幸いです。 お手数をお掛けいたしますが、アドバイスのほど、よろしくお願い致します。
http://xxx.jp/xxx/xxxxxxx/xxxxxx.cgi?cmd=s&xxxx&xxx&Tfile=Data&TrColor=%xxx&Sort=xxx_xxxx&page=1 上記のようなURLがブラウザに表示されていて、末尾に「page=1」という文字がある時だけ HTMLのMETAタグのDESCRIPTIONに　page=1　を挿入したいです。 ちなみに、そのページには、以下のように DESCRIPTIONが記載されており、下記の★の部分に 「page=1」というURLの一部の文字を挿入したいと考えています。 <META name="description" content="説明文 ★"> Perl でどのように記述すれば宜しいでしょうか？ どうかアドバイスをお願い致します。 ｍ（_　_）ｍ
shellスクリプトに複数の引数を渡したいと考えています。 下記のようなperlスクリプトを兼ねる事でやりたいことは達成できました。 これをシェルスクリプトだけでやろうとしていて、ハマってしまい、やり方がわからなかったので、質問しています。 ・echo.shの中身 $ cat echo.sh echo $1 $2 ・imglist.plの中身 $ cat imglist.pl my@imglist= `ls -1 *{.gif,.bmp,.jpg,.jpeg,.png} 2>1&`; foreach(@imglist){ my@name=split /\./,$_; system("bash ./echo.sh $name[0] $name[1]"); } ・実行すると、無事echo.shに引数が２つ渡る。 $ perl imglist.pl abc1 jpg abc10 png abc11 png abc2 jpg abc3 jpg これをシェルのみでやろうとして、はまってしまいました。 以下は、パイプ処理等を使ったりしてやってみたのですが出来ませんでした。 ・awkでファイル名と拡張子に分解し、パイプで渡そうとしても何故か渡らない・・ $ ls -1 *{.gif,.bmp,.jpg,.jpeg,.png} | awk -F . '{print $1,$2}'| bash ./echo.sh ・ファイルに一旦保存し、catコマンドでパイプで渡しても駄目 $ ls -1 *{.gif,.bmp,.jpg,.jpeg,.png} | awk -F . '{print $1,$2}' > imglist.txt $ cat imglist.txt | bash ./echo.sh ・echoコマンドを使ってパイプで渡しても駄目 $ echo `cat imglist.txt` |bash ./echo.sh ・for.shというファイルを作成し、for構文でimglist.txtの中身を渡すと引数が一つずつしか渡らない $ cat for.sh for id in $(cat imglist.txt); do echo $id done $ bash for.sh tile1 jpg tile10 jpg どうやれば、コマンドライン上やシェルスクリプトだけで、今回はファイル名と拡張子という形で複数行からなる２つの引数を渡すことができますでしょうか
#通常休診設定 $hdayfl = "./datas/hday7.txt";open (DT,"<$hdayfl");$hday = <DT>;close (DT); #重要休診日 #$regular = "./datas/regular.txt";open (DT,"<$regular");$hday = <DT>;close (DT); @HOLIDAY = split(/\,/,$hday);$SHOWHOLIDAY = "";@TPHOL = (); foreach $p (@HOLIDAY){if(index($p,"-") > 0){push(@TPHOL,"\"$p\"");}} $SHOWHOLIDAY = join(",",@TPHOL); というプログラムで現在重要休診日をコメントアウトしてるのですが、それは通常休診日と、重要休診日の二つのファイルを同時に読み込ませたいのですが、このままコメントアウトを外すと、/datas/regular.txt"　のファイルしか読み込まれなくなり、通常休診日ファイルが読み込まれなくなります 同時に、二つのファイル(通常・重要ともに）をオープンさせて読み込ませるには、何が足りないのでしょうか？ ご教示くださいませ。
perl やり始めたばかりです。宜しくお願いします。 入力ファイル data.txt があるとします。 data.txt は、 123 456 789 333 555 777 以上のようなテキストファイルといたします。このファイルを 以下の様に100分の1にして出力したい。 1.23 4.56 7.89 3.33 5.55 7.77 と言うことで、この場で教えていただきました。それが、以下です。 #!/usr/bin/perl open(IN, "data.txt") or die ; @x = <IN>; close (IN); foreach $line (@x){ chomp($line); @elms = split(' ',$line); foreach $data (@elms){ print $data/100," "; } print "\n"; } おかげ様でこれはこれで上手く動きました。そこで、出力値をファイルに 書き込みたいのです。　もちろん、以下の様な方法でファイルに 書き込めるのは判っております。 計算プログラム.pl > outfile.txt しかし、上のプログラムをベースにファイルに書き込めないかと色々と 試してはみましたが、どうも上手く行きません。 どなたか教えて頂けないでしょうか？ 宜しくお願い申し上げます。
掲題の通りです。 よろしくお願いします。
shift-jisにてcsv形式で保存しているテキストファイルの配列（カンマ区切りの３番目）から取り出したものをＵＴＦ－８にエンコードする方法をご教示賜りたくご質問させて頂きました。 $Pscrtfl = "./datas/pdtscrt.txt"; open (DT,"<$Pscrtfl"); @Pscrt = <DT>; close (DT); foreach $i (@Pscrt){ @iW = split(/\,/,$i); $Pscrtfl = "./datas/pdtscrt.txt　のｔｘｔに入ってる３番目のデータを取り出して、それをＵＴＦ－８文字コードに 変換して出力させたいと思っております。 現在のところ私のやってみたこと foreach(@Pscrt){ use Encode; Encode::from_to( $_, 'utf8', 'shiftjis' ); $Pscrtfl .= $_; } とエンコードかけてみるんですが。。。。やはりｃｓｖファイルの文字がＵＴＦ－８に変更していないのか、 <!doctype html> <html><head><meta charset="UTF-8">でｐｒｉｎｔしようとすると、やはり文字化けしてしまいます。 これを文字化けしない方法がお分かりの方おられましたら、ぜひご教示下さいませ。
現在、さくらのレンタルサーバにてperlスクリプトを稼動しています。 今回、さくらのレンタルサーバのメール認証がPOP before SMTPからSMTP認証(SMTP-AUTH)に変更になりましたので、perlスクリプト内で自動メール送信させるのにNet::SMTP::TLSモジュールを利用することにしました。そこで (1)SMTPサーバー名、ポート番号、ユーザー名、パスワードを設定する (2)宛先などの必要な設定をする (3)メール内容を設定する (4)メールヘッダを設定する (5)メールを送信する という流れで現在perlスクリプトを以下のように記述しました。 #!/usr/bin/perl use CGI::Carp qw(fatalsToBrowser); use Net::SMTP::TLS; use Authen::SASL; my $smtp = Net::SMTP::TLS->new($mailhost, Port => $mailport, User => $mail_username, Password => $mail_password ); $smtp->mail($from_mail); $smtp->to($tomail); $smtp->data(); $smtp->datasend($header); $smtp->datasend($message); $smtp->dataend(); $smtp->quit; 変数の値は割愛していますが、 上記のスクリプトは、POP before SMTPの時は問題なくメール送信できたのですが、サーバのメール認証がSMTP認証(SMTP-AUTH)に変更になってからは以下のようなエラーが出ます。 invalid SSL_version specified at /usr/local/perl/5.8/lib/perl5/site_perl/5.8/IO/Socket/SSL.pm line 418 何か間違いであるとか、他に必要な設定がありますでしょうか? 宜しくご教授お願いいたします。
下記のプログラムをベースにして置換を行いたいです。 use File::Basename; use File::Copy; use File::Find; use File::Path; my @filelist = (); $inputfile='C:\Users\test.txt'; $outputfile='C:\Users\test_new.txt'; open (IN, $inputfile) or die "$!"; open (OUT, ">$outputfile") or die "$!"; while(<IN>) { $str = $_; if ($str =~ / ・・・・・ ・・・・・ } print OUT $str; } close (IN); close(OUT); sub wanted{ push(@filelist, $File::Find::dir."/$_") unless ($_ =~ /^\.$/); } Perlプログラムで下記の２つのソースを一括置換しようとしてます。 (1)　paramIdとparamNameの文字列が同一の場合 <html:link styleClass="push" action="/numa.do" paramId="Id" paramName="Id" onclick="URL">ソース</html:link> (2)　paramIdとparamNameの文字列が同一でない場合 <html:link styleClass="push" action="/numa.do" paramId="Id" paramName="Name" onclick="URL">ソース</html:link> やりたいことは ・　html:linkをs:aに変換 ・　styleClassをcssClassに変換（これはわかるのですが位置の修正がわかりません。。） ・　action="/numa.do"を/numaに変換 ・　paramIdとparamNameを文字列が同一か同一でないかで分岐処理したい。 目標は以下のように置換したいです。 (1)　paramIdとparamNameの文字列が同一の場合 <s:a href="/numa?Id="%{ Id }" cssClass="push" onclick="URL">ソース</s:a> (2)　paramIdとparamNameの文字列が同一でない場合 <s:a href="numa" paramId="Id" paramName="Name" cssClass="push" onclick="URL">ソース</s:a> どうしてもこの置換ができません、、誰かぜひ教えてください。 お願い致します。
お世話になります。 以前、Windows Server 2003 にてWebサーバーを構築し、そこでPerlで掲示板を公開しておりました(社内イントラ)。 先月サーバーをリプレースしOSがWindows Server 2012となり、この掲示板を移行しようとしましたがうまくいきませんでした（OSが64bitだから？） ※元々掲示板は別の人が作成した為、私自身あまりよく分かっておりません(Perlも含め)。 なので、現状は掲示板を公開できずにおります。 新サーバーの方で新たに掲示板を作成すればよいのですが、以前使用していた掲示板に登録された内容も参照できるようにしたいところです。 <質問> 旧サーバーのC:\Inetpub\cgi-bin\log　フォルダをみたところ、cgiファイルがたくさんあり中身を見てみると掲示板に登録されていた内容でした(1件1ファイル)。 しかし、<>0 <br> <>1などが文字列の中に混在しておりました。拡張子cgiをhtmlに書き換えて開くと、改行はされるようになりますが、<>や<>0はやはり文字列に混在した状態で表示されます。 掲示板に登録されたときのように、普通に表示するにはどうやればよいのでしょうか。 ※リプレース後、旧サーバーは色々いじってしまい掲示板も開けない状態になってます。 最終的にはその表示された内容を、何らかの方法でExcel等にコピーしそのファイルをとりあえず公開できたらと考えております。 以上、ご教授の程よろしくお願い致します。
質問です。文字列の置換を行いたいのですが、まずはソースから・・・ use File::Basename; use File::Copy; use File::Find; use File::Path; my @filelist = (); $inputfile='C:\Users\test.txt'; $outputfile='C:\Users\test_new.txt'; open (IN, $inputfile) or die "$!"; open (OUT, ">$outputfile") or die "$!"; while(<IN>) { $str = $_; if ($str =~ /html:text/) { $str =~ s/html:text/s:textfield/g; $str =~ s/property/name/; $str =~ s/styleClass/cssClass/; elsif($str =~ /html:textarea/) { $str =~ s/html:textarea/s:textarea/g; $str =~ s/property/name/; $str =~ s/style/cssStyle/; $str =~ s/styleClass/cssClass/; } print OUT $str; } close (IN); close(OUT); sub wanted{ push(@filelist, $File::Find::dir."/$_") unless ($_ =~ /^\.$/); } Perlプログラムで下記のソースを一括置換します。 <html:text property="xxx" styleClass="yyy"> <html:textarea property="abc" styleClass="def" style="ghi"> 目標は以下のように置換したいです <s:textfield name="xxx" cssClass="yyy"> <s:textarea name="abc" cssClass="def" cssStyle="ghi"> しかし、上記のプログラムを実行すると <s:textfield name="xxx" cssClass="yyy"> <s:textfieldarea name="abc" cssClass="def" style="ghi"> となってしまいます。 どこをどう直せばよいのかわからないので誰か教えてください。 お願い致します！！
Perlでgrep -Aのようなことがしたいです。 ---------------grep.pl------------------------------- use strict; use warnings; #コマンドライン引数の確認 if(@ARGV != 3){ die "USAGE: \0 [num] [regex] [file]"; } #数字の読み込み my $num = $ARGV[0]; #正規表現の読み込み my $regex = qr/$ARGV[1]/; #ファイル名の読み込み my $file = $ARGV[2]; #該当行を保存する配列 my @lines = (); open my $fh, '<', "$file" or die "$!"; my @file = <$fh>; close $fh; for(my $i=0; $i<@file; $i++){ if($file[$i] =~ /$regex/){ push @lines, $file[$i]; for(my $j=1; $j<=$num; $j++){ if($i+$j < @file){ if($file[$i+$j] !~ /$regex/){ push @lines, $file[$i+$j]; }else{ last; } }else{ last; } } } } foreach my $item (@lines){ print $item; } ------------------------------------------------- ところが、正規表現がうまく読み込めません。 perl grep.pl 2 \d{4}\/\d{2}\d{2} test.txt などとしても、\d{4}\/\d{2}\d{2}の部分が機能しません。 コマンドライン引数から正規表現を指定するにはどうしたらよいでしょうか。
Perlで文字列置換の業務をすることになりした。 Struts1からStruts2のJSPのタグの変換です。 (1)html:textarea property="aaa" styleClass="bbb" (2)s:textarea name="aaa" cssClass="bbb" (1)から(2)に変換したいです。 「html:textarea」が「s:textarea」に対応しており、その属性の「property="aaa"」が「name="aaa"」に対応、 「styleClass="bbb"」が「cssClass="bbb"」に対応するといった内容です。 aaaとbbbは任意の文字列 if ($str =~ /html:textarea/ ) { $str =~ s/html:textarea/s:textarea/; $str =~ s/property=\"(.+)\"/name="$1"/; $str =~ s/styleClass=\(.+)"\"/cssClass/; というように参考書を元に作成してみたのですが、変換は行われるものの、属性のpropertyとstyleClassの順番が逆だったり、ここに記載していない他の属性を間に入れたりすると変換ができません。 どなたか教えて下さい。
Perlを利用し、ファイル内の置換操作を行いたいと思います。Perlに関して全く無知なので誰か教えてください。 変換したい内容を下に記載します。 (1)html:button value="aaa" name="bbb"　c:button property="${aaa.bbb}" 　　　　　　　　　　　　　　　　　　　　　↓↓　 (2)html:button value="aaa" name="bbb"　c:button property="${aaa.bbb}" 上記の変換ではvalueとnameがpropertyになる (3)html:button value="xxx" var="yyy" 　　　　　　　↓↓ (4)c:button prop="xxx"　id="yyy" (3)に関してはvalueとvarの間に何か他の処理が入ってもvalueとvarだけを特定し、変換できるScript文にしたいです。 言葉足らずだったらすみません。誰か教えて下さい。
合致する番号のデータを抽出する方法をおしえてください perlの勉強を始めたばかりの初心者です。 下の画像のようにタブで区切られたデータです。一行で一人分のデータです。 先頭の4桁の数値がユニークで、この数値をつかって抜き出します。 0125 0251 2650 : : : 上記のように与えられた別ファイルの数値と合致する行だけを抜き出し別ファイルにはきだす方法を教えていただきたいです。 シンプルでわかりやすいもの、メモリに負担のすくないものなど複数の方法を教えていただきたいです。 説明もいただけるとありがたいです。よろしくお願いします。
perlを使い、複数行に渡る情報をdatファイルから読み込み、<form>～</form>を含むhtmlより 表示する順番を<select>～</select>にて指定し、またdatファイルに書き出しを行っています。 例として以下の様になります。 1(ID)<>1(並び順番)<>… 2<>5<>… 3<>4<>… 4<>2<>… 5<>3<>… この際に並び順番の指定の数字が被ってしまったまま送信を行ってしまうと、 そのdatファイルを使用する他スクリプト上で問題が発生するため、 並び順番の数字が （1・1・2・3・4・4・5の様に）被ってしまっても 再度降順に1・2・3・4・5～と数字を書き直す様にしたいと考えておりますが 非常に難しく、難儀しております。 並び順番の数字が被ってしまった場合にエラーメッセージを表示させ、 再度入力させる方が簡単なのかとも考えますが、 こちらもどの様にすれば良いのか、困っております。 どうぞ知恵をお貸しください。
サンプルスクリプトのなかに use CGI qw(:cgi :form); use CGI::Carp qw(fatalsToBrowser); use Image::Magick; と書かれていたのですがuse CGI::Carp qw(fatalsToBrowser);は意味わかったのでコメントアウトしましたがuse CGI qw(:cgi :form);は何を読み込んでいるのですか?コメントアウトしても大丈夫でしょうか? イメージマジックは使うのでそのままにしてあります よろしくお願いします
お世話になります。 win7 ActivePerl 5.16.3 Apache HTTP Server 2.0 perlからエクセルファイルを読み込むプログラムを作成しています。 ---- use Win32::OLE; use Win32::OLE::Const 'Microsoft Excel'; Win32::OLE->Option(Warn => 3); eval{ Win32::OLE->GetActiveObject('Excel.Application'); }; if($@){ die "Excelが使用できません。$@"; } unless (defined $Excel){ $Excel = Win32::OLE->new('Excel.Application', sub {$_[0]->Quit;}) or die "Excelが起動できません。"; } my $Book = $Excel->Workbooks->Open("Excelファイルのフルパス") or die Win32::OLE->LastError(); $Book->Close; $Excel->Quit(); ---- 現在は単純に、開いて、閉じるだけの状態です。 ワークシートが1つのエクセルファイルは問題ないのですが、 2つ以上ワークシートがあるエクセルファイルを開くと、$Book->Closeのところで戻ってこなくなります。(ブラウザで待機中の状態) 該当のエクセルファイルは、開いた状態です(直接エクセルで開いてみると編集のためロックされていますと出る)ので、Openは出来ているような気がします。 $Book->Closeを書かなければ下に流れていきますが、 プロセスが残ってしまいます。 ワークシートが1つのときと、複数のときで違いがあるのでしょうか？
javascriptからcgiを呼び出して表示した場合、何個も同じファイルを呼び出すと以下の場合3回オーバーヘッドが発生して負荷がかかりますか？それとも同じファイルだから何回よびだしても1回の負荷ですみますか？ <script type="text/javascript" src="hoge.cgi?new=1"></script> <script type="text/javascript" src="hoge.cgi?new=2"></script> <script type="text/javascript" src="hoge.cgi?new=3"></script> 質問2 phpで同じようにすると、1回のオーバーヘッドで済むのですか？
perl 初心者です。 perl を使ってデータ整理を試みていますが、方法がわからなくて困っています。 やりたい操作は、 １、ディレクトリ内にある特定の拡張子をもつすべてのデータファイルを読み込む ２、データソート ３、データファイル名を変更せずに、ソートしたデータを出力する 例 ディレクトリに以下のデータファイルがあるとします aaa.data bbb.data ccc.data : zzz.data これらのデータファイルをすべて読み込み、中身を整理した後に aaa.txt bbb.txt ccc.txt : zzz.txt となるように、それぞれのデータの名前を変更せずに出力したいと思っています。 スクリプトのサンプルなんかがあればありがたいです。
perlでdb（mysql）に接続し、取得したデータを 表示させるというようなことをしたいのですが、うまく いきません。 ファイル名test.cgi mysqlのバージョンは 5.0.45で 記述は以下です。 #!/usr/bin/perl use DBI; my $dbh = DBI->connect("DBI:mysql:database, "userid", "password"); my $sth = $dbh->prepare('SELECT * FROM tablename'); $sth->execute; print "Content-Type: text/plain\n\n"; print "\n"; while(my @row = $sth->fetchrow_array) { print "$row[0]:$row[1]\n"; } $sth->finish(); $dbh->disconnect(); exit; ブラウザで確認すると何も表示されず、ログとして 以下のエラーが確認できます。 DBD::mysql::st execute failed: Table 'database.tablename' doesn't exist at test.cgi line 8. DBD::mysql::st fetchrow_array failed: fetch() without execute() at test.cgi line 11. my $sth = $dbh->prepare('SELECT * FROM tablename'); で指定したテーブルは存在しておりますし、SQL文の記述も 問題ないと思われます。 また、ファイルのパーミッションは705（755でも同様の結果）です。 perl初心者のため、どこが問題なのか検討がつきません。 ご助言いただきたく存じます。 よろしくお願いいたします！
●perl $seireki = "2013";　　　　　# 変数 #------------- $123 = "$seireki";　　　　　# 代入 $nengou = "$abc"."$123";　# 結合 #------------- $abc2013 = <<"EOF"; あいうえお EOF $abc2014 = <<"EOF"; かきくけこ EOF #------------- ●html <strong>$nengou</strong> ーーーーーーーーーーーーーーーーーーー 上記、htmlの$nengouに　あいうえお　と表示したいのですが、 2013　と表示されてしまいます。 解決法として、 $は特殊文字なので、エスケープシーケンス（¥$）をして、 $nengou = "¥$abc"."123"; にしたら、 htmlの中の$nengouは、$abc2013　と表示されてしまいます。 どのようにしたら、 特殊文字入りの文字結合を、変数として扱うようにするのでしょうか？ いろいろ試してみてもどうしても出来ません。 どなたか解決していただけますと、ありがたいです。
PerlをDBIでMySQLに接続しています。 MySQLの“country”テーブルに“name_en”カラムがあり、これをハッシュのキーにして、 下記構文で“name_jp”カラムに文字列を挿入しようとしたのですが、 ----------------------------------------- $sth = $dbh -> prepare ("update country set name_jp = \'$name{name_en}\' where id between 1379 and 1396"); ----------------------------------------- 結果は何も入りませんでした。 カラム名をハッシュのキーにするには、どう書けばいいのでしょうか？ 宜しくお願いします。
レンタルサーバ上でPerlのプログラムを作成しているの ですが、動作でよくわからないことがあるので、教えてください。 Perlのプログラムがあるサーバで動作していて、それを 他のサーバに移したのですが、正しく動作しなくなりました。 調べてみると、関数を呼んでいるところで配列の値がうまく 引き継がれていませんでした。 呼び出しの処理は次の通りです。 ●呼び出し元 ret= &SubModule(*DATA1); ●呼び出し先 sub SubModule { local(*DATA1) = @_ if @_; while(($key, $value) = each(%DATA1)) { #配列に対する処理 } #以下省略 このような処理の時に呼び出し元では配列DATA1に 値が入っているのに呼び出し先のSubModuleでは 空になりwhile文を素通りして「#配列に対する処理」 を実行しません。 いろいろ試しているうちに、呼び出し先に１つ余計な whileを入れると配列DATA1に値が入ってきました。 つまり次のように変更すると、うまくいきました。 呼び出し先 sub SubModule { local(*DATA1) = @_ if @_; while(($key, $value) = each(%DATA1)) { } while(($key, $value) = each(%DATA1)) { #配列に対する処理 } #以下省略 こうすると 「#配列に対する処理」が実行されました。 教えていただきたいのは以下の２点です。 (1)元のサーバでは問題なく動作していたのですが、 　別のサーバでは、配列の引数がうまく引き継がれ 　なくなりました。どういう原因が考えられるでしょうか。 　処理上何かまずいところがあるのでしょうか。 (2)呼び出し先でwhile文を一つ入れることで、配列の 　値が参照できるようになったのですが、これは 　なぜでしょうか。 よろしくお願いします。
CGIに関してです。 下記にて入手可能なフリーのCGIが動かなくて困ってます。 詳しい友人曰くソースが古すぎるのではないか？ ということでした。 当方所有のサーバーはロリポップレンタルサーバーで もちろんCGI設置可能です。 過去にも何点かフリーのCGIを動かしたことはあります。 本当にCGI本体の問題なのか検証できる方はいらっしゃいませんでしょうか？ CGI本体： http://www.minicgi.net/cgi2/list.html 紹介サイト（サンプル2） http://www.minicgi.net/cgi2/
http://www.tagindex.com/tool/url.htmlにあるようなURLエンコードの処理を行いたいのですが、ソースはどのようになりますでしょうか？ 下記のようなものできるのかと思いましたが、「テスト」の文字列ですと、「%83e%83X%83g」と表示されてほしいのが、「?e?X?g」となってしまいます。 お分かりの方がおられるようでしたら、ぜひ教えてください。 $str='テスト'; use Encode 'encode'; $str = encode('sjis', $str); print "$str";
シフトJIS使用時の日本語のマッチングにおいて 正確なマッチングができないことは分かっているのですが いわゆるダメ文字が含まれていないにもかかわらず マッチングがおかしいことがあります。 ちょう、きゅうなど最後「～う」で終わる言葉のマッチングさせると マッチングするはずがしないのです。 この理由は何が考えられますか？ UTF-8に変換してマッチングさせればいいのは分かっているのですが どうしてなのかという理由が知りたいので投稿させていただきました。
ファイルを読み書きする場合に使用するflockですが、closeする前に別ファイルのflockは使用できるのでしょうか？ テストしてみたところ、うまくいってるような気もするのですが、確証が持てないので質問させていただきました。 例) $file1="file1.txt"; $file2="file2.txt"; open(OUT,"+<$file") flock(OUT,2); $count1=<OUT>; open(DAT,"<$file2") flock(DAT,1); $count2=<DAT>; close DAT; $count=$count1+$count2; truncate(OUT,0); seek(OUT,0,0); print OUT "$count "; close OUT; ちょっとあえて複雑な書き方としてみましたが、上記のようにflockを使ってる最中に別ファイルのflockを使用することは出来ますでしょうか？ 参考URLでも結構ですので、どなたかよろしくお願いいたします。
例えば、下記のようなスクリプトの場合、一度画像が保存された後、ファイルサイズをを抜き出すようになります。 ダウンロード前に、ファイルサイズをあらかじめ知りたいのですがどのようにしたら良いでしょうか？ use strict; my $url = "http://img.www.goo.ne.jp/img/gh_logo.png"; use LWP::UserAgent; use HTTP::Cookies; use HTTP::Request; use HTTP::Headers; my $req = HTTP::Request->new(GET => $url); my $ua = LWP::UserAgent->new; $ua->agent( 'Mozilla/5.0 (Windows NT 6.0; rv:12.0)' ); $ua->timeout('10'); $ua->max_redirect(); $ua->cookie_jar( HTTP::Cookies->new( file => '', autosave => 1, )); my $res = $ua->request($req, "save.png"); my $file_size = $res->header("content-length"); print $file_size;
$messageの中に○○○○<br>△△△△<br>□□□□の文字列が入っています。 最初の<br>以降を削除して○○○○だけを取り出すにはどうしたらよいですか? $message2 = "$messageの改行以降を消す" の方法を教えてください!
（モジュールは別として）pure perl で文書検索のアルゴリズムを考えています。 このアルゴリズムが頭良いか、悪いかのツッコミをお願いします。 １．前提 　mecabを使用 ２．文書を書き込むとき 　mecabで全文書を解析して、単語ごとにデータベースに入力する。 　キー：単語　中身：そのページ名がたくさんはいったもの ３．文書を削除するとき 　mecabで全文書を解析して、単語ごとにデータベースに入力されたものを削除する ４．文書が変更になったとき 　３→２を行なう ５．検索するとき 　検索キーワードをmecabで解析する 　分割されたワードごとに、結果を表示する。 たとえば・・・ 1.txt が 愛　植尾　かきくけこ　会社 であれば 愛　植尾　カキクケコ　会社 に、1.txtが登録される 2.txt が 哀　植　尾　かきくけこ　会社 であれば 哀　植　尾　カキクケコ　会社 に、2.txtが登録される キーワードで、愛なら 1.txt キーワードで、植尾なら 1.txt キーワードで、植 尾(AND)なら 2.txt キーワードで、かきくけこ　なら 1.txt、2.txt という感じで検索できる感じです。 ※検索のインデックスは、文書の単語量に依存しますが、無制限と考えます。 ※実装は、YukiWikiDBというファイルベースのデータベースから利用可能なものとします。 ※あまり深く考えないでこのサブルーチンを組むことも考えています。
tr を使って文字列を置換する時に 検索文字列や置換後の文字列のリストとして変数を使いたいのですがうまくできません。 ｔｒ はコンパイル時に変数を展開するので eval を使わないといけないという記述を見つけたのですが そこから先のやり方がわかりません。 eval "tr/$ab/$cd/"; のように書くというような記述までは見つかるのですけれど これを使ってどうすれば変換ができるのかわからないのです。 どなたか教えてください。 （初心者でごめんなさい。eval とか全然使い方がわかりません…）
お世話になります。 下のサンプルコードは、CGI.pmのperldocに載っていたサンプルを改造したものです。 #! /usr/bin/perl # # simple.cgi -- CGIフォームの実験 use CGI qw/:standard/; use CGI::Carp qw/fatalsToBrowser warningsToBrowser/; print header( -expires=>'-1d', -pragma => 'no-cache', 'Cache-Control' => 'no-cache'), start_html('Simple Script'), h1('Simple Script'), start_form, "What's your name? ",textfield(-name=>'name', -default=>""),p, submit, end_form, hr,"\n"; if (param) { print "Your name is ",em(param('name')),p, } print end_html; 改造点はheader関数にexpires、pragma、Cache-Controlを入れてみたこと、 textfieldに-default=>""を入れてみたこと、 UIと表示項目を１つに減らしたことです。 やりたいのは、上のテキストボックスに名前を入れて、submitを押した瞬間に、上のtextboxをクリアすることです。 ぼくの理解では、最初に上記のCGIがあるURLにアクセスしたときにはプログラムは全部走ってしまう、paramがゼロだからそのときは入力表示を出すだけ、 実行を押した後もう一度このプログラムは最初から走る、paramに値があるから出力が表示される、というものです。 となれば、２度目に（入力を得て）実行されるときは、headerのcache関係の項目や、textfieldのdefaultが効いて空白になりそうな気がしますが、現実には最初に入った値がそのまま動き続けます。 これをPerl側で空白になるように制御できるでしょうか。 サーバーはFreeBSD（レンタル）、Ｐｅｒｌは5.12、WebサーバーはApacheです。 クライアントはWindows7でIE9、Firefox22、Chrome28を使っています。 よろしくお願いします。
perlでファイルAから読み出した値を別ファイルBに出力させたいです。 イメージとしては -------------------------------- open(FILE,ファイルA); while(<FILE>){ my $line = "$_"; system("ls -l $line"); #←ここの結果を1行ずつファイルBに出力したい } close(FILE) --------------------------------- 上記の場合どのように記述すれば良いのでしょうか？ bashでは簡単にかけるのですが、 業務上perlを使用する必要がある為こまっております…。
for $each(@man){ 処理； } これを下記のように指定回数回したいのですが、どうすればよいでしょうか？ for ($j = 0; $j < 7; $j++){ 処理； }
---あああああああああああああ---------------- いいいいいいいいいい ううううううううううううう [2013/07/10 00:00:00] ええええ [2013/07/10 00:00:01] おおおお 上記のようなデータが複数格納されたファイルを読み込み、出力が ---あああああああああああああ---------------- 2013/07/10 00:00:00,ええええ 2013/07/10 00:00:01,おおおお となるようなプログラムをperlで実現させたいと考えていますがうまくいきません。 文字列のマッチング等試してみましたが期待する結果が得られませんでした。 ご教授よろしくお願いします。
お世話になります。 Perlの書き方について教えてください。 Perlのファイルハンドルで、昔はINやOUTやFILEのようにベアワード（裸のワード）を使っていたと思います。 ★（プログラム１） #! /bin/perl # # fh_bareword.pl use strict; use warnings; open IN, '<', 'in.txt'; open OUT, '>', 'out.txt'; while (<IN>) { print OUT; } close IN; close OUT; ★（実行例） C:\Perl\perl>type in.txt This is a pen. That is a book. C:\Perl\perl>fh_bareword.pl C:\Perl\perl>type out.txt This is a pen. That is a book. ★★★ ところが、これだとIN、OUTがグローバル名になってしまい、他のモジュールと衝突することがあるということで、myつきのスカラー変数にした方が良いと言われました。 それで、以下のように書いてみましたが、想定のように動作しません。 ★（プログラム２） #! /bin/perl # # fh_scalar.pl use strict; use warnings; open my $in, '<', 'in.txt'; open my $out, '>', 'out.txt'; while (<$in>) { print $out; } close $in; close $out; ★（実行例） C:\Perl\perl>fh_scalar.pl GLOB(0x146ea34)GLOB(0x146ea34) C:\Perl\perl>dir out.txt ドライブ C のボリューム ラベルは eMachines です ボリューム シリアル番号は 89C9-F870 です C:\Perl\perl のディレクトリ 2013/07/09 23:05 0 out.txt 1 個のファイル 0 バイト 0 個のディレクトリ 23,226,032,128 バイトの空き領域 ★★★ たぶん print $out; の部分で、私はファイルハンドル$outに$_を表示してくださいと意図していたのですが、「ファイルハンドルSTDOUTに$outを表示してください」という意図に受け取られたらしく、上記のようにGLOBのリファレンス？が表示されてしまいました。 print $out $_; と書くと、確かに正しく表示されますが、これが正しい書き方なのでしょうか。 printの後ろに来るのは出力する文字列ではなくファイルハンドルだと、正しく判断してもらえるもっと美しい書き方はあるのでしょうか。 よろしくお願いします。
お世話になります。 Unicodeの文字プロパティの使い方を学ぶために、以下のようなスクリプトをUTF-8で保存しました。 ＝＝＝＝＝＝＝＝＝＝＝＝ #! /bin/perl # # utf8_unireg.pl use 5.010; use strict; use warnings; use utf8; binmode STDOUT, ":encoding(shift_jis)"; my $str = "a:b:c:"; say join "|", ($str =~ /\p{ASCII}/g); say join "|", ($str =~ /\p{AsciiAlpha}/g); sub AsciiAlpha { return <<END; 0041005A# A-Z 0061007A# a-z END } ＝＝＝＝＝＝＝＝＝＝＝＝ 実行するとこうなります。 ＝＝＝＝＝＝＝＝＝＝＝＝ C:\Perl\perl>utf8_unireg2.pl a|:|b|:|c|: Can't find Unicode property definition "AsciiAlpha" at C:\Perl\perl\utf8_unireg2.pl line 14. ＝＝＝＝＝＝＝＝＝＝＝＝ \p{AsciiAlpha}というプロパティの作成に失敗しているようです。。 なぜか分かりますでしょうか? よろしくお願いします。
こんにちは。 掲示板をperlで作るという課題に取り組んでいるのですが、下記の部分の 動きだけがどうしても期待する動作がえられず、困っています。 なにか試した方が良い事がありましたら、ご指摘いただけないでしょうか。 プログラムの説明： POST されたコメントを data.dat に追記していくプログラムです。 ファイルハンドラから一行づつ読み込んで、行数を $count でカウントし、 『X行目&&コメント』のようにコメントの先頭に行数を表示します。 #!/usr/bin/perl $myfile = 'data.dat'; (省略) sub piyo{ open(HOGE, ">> $myfile"); flock(HOGE, 2); my $count = 1; while(<HOGE>){ $count++; }; print HOGE "$count行目&&in{'comment'}\n"; close(HOGE); }; data.dat の期待する結果は下記です。 1行目&&コメント 2行目&&コメント 3行目&&コメント ..... 実際に data.dat に書き込まれた結果は下記でした。 1行目&&コメント 1行目&&コメント 1行目&&コメント ..... 試した事１： open(HOGE, ">> $myfile"); を open(HOGE, "+>> $myfile"); した。 試した事２： while(<HOGE>){ $count = $count + 1; }; とした。 どちらでも結果に違いがありませんでした。 よろしくお願いします。
perlの文字マッチについて「？」が含まれる場合のマッチさせる方法について教えていただきたいです。 例） $hoge="papa?no=1,mama?no=2,cat=?no=3"; $hogehoge="cat=?no=3"; $hoge =~ m/$hogehoge/i; 上記の場合、文字内に「?」がある為にマッチしません。メタ文字として判断されているのでしょうか…。 この場合、マッチさせるにはどのような方法がありますでしょうか。 一度、「?」を違う文字に変換すれば出来るのではないかと思いますが、そのままの形でのマッチを求めています。 どうかよろしくお願いいたします。
フォートランで作られたデータを、perlで作り直そうと始めました。 なんとか、perlの中で値の計算までは出来たのですが、 下記データの２フィールド目に対して積算の仕方が解りません。 awkでは、awk '{SUM += $2;printf("%s %10.4e\n", $1, SUM)}'でできましたが、 perlで中ではどのようにするのか？ 1998-04-20T16:16:00 　　6.533078e+05 1998-05-01T01:59:00　　 1.501809e+06 1998-05-05T07:20:00 　　7.202719e+05 1998-05-05T07:24:00　　 9.799618e+05 ついでに、御存じでしたら、御教授ください。 awkとperlの計算結果は全く同じにでましたが、フォートランの結果は 下記のように微妙に違ってしまう処がございます。 それは、どうしてでしょうか？ 　　 　awk,perl の結果　　　　フォートランの結果　　　フォートランの７ケタの結果 　7.202719e+05　 　　　 7.202718e+05　　　　　　7.202718１e+05　　　　　　　　 　9.799618e+05 　　　 9.799616e+05 9.7996169e+05 以上　よろしくお願い致します。
こんにちは。 私は普段はCでゴルフを楽しんでいるのですが、そろそろPerlも学ぼうと思っています。 基礎的な文法等はググれば幾らでも出てくるので、マニアックな書籍を求めています。 何かおすすめの本などありますか？
awkで計算をさせた結果、下記のような値になりますが、 echo "" | awk '{ OFMT = "%5e"} {print 2*0.5*3.1415*60*8*2600*3500*20000*20000*(0.5*64.6*0.00000001)*(0.5*64.6*0.00000001) }'　＝　 5.726440e+05 この5.726440e+05-->　0.5726440e+06　と出したいのですが方法が解りません。 awkでも、perlでも良いので、このような表示にする方法を教えてください。
Perl でメールを１００通送るプログラムを作りました。ただし、これは実験用なので　「自分から自分へメールを１００通おくる」　というプログラムです。 for ( my $i = 0; $i < 100; $i++ ) { $body_text{subject} = $i . ":test"; &sub::mail_push( $cf{server}, $cf{account}, $cf{password}, $cf{port}, $cf{form_mail}, $mail_add , $body_text{subject}, $body_text{body_text} ); } &sub::mail_pushというサブルーチンはメールを送信するために自分が作ったものです。 うまく１００通おくれたので良かったのですが、ここでメールサーバーに溜まっているメールをみて疑問が２点浮かびました。 １）このプログラムでメールタイトルは　0 ～ 99 までの連番が頭につき、その順にメールが送られ（るハズ？）ます。しかしメールサーバー上では連番どおりにメールは届いておらずバラバラになって並んでいます。これはなぜでしょうか？ ２）単純になにかのミスだと思うのですが、これは本日（6/17）動かしているのですが、メールの日付は（6/18）になっています。なにかサーバー上のミスでしょうか？ちなみにサーバーはXREAを利用しています。
main_01.plというプログラムがあります。 これは１０分毎にバッチファイルから起動の命令が下ります。ただしプログラムの処理によっては１０分以上かかることがあります。 この時、main_01.pl がすでに起動していた場合、main_01.pl はすぐに exit; になるように組みたいのです。僕が考えた方法は、あるテキストファイルにロックをかけ、そのファイルがロック中であるならばプログラムは処理を行わずすぐに終了する、といった感じです。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ # タイムアウト処理 my $timeout = 5; # 排他処理 my $lockfile="lock.txt"; # 多重起動停止 （ここに　$lockfile　が書き込めなかったらmain_01.plは別に起動していることになるので起動しない。） # 排他処理開始 open(LOCK,"$lockfile"); flock(LOCK,2); # 処理開始 eval { # タイムアウト local $SIG{ALRM} = sub { die "alarm\n" }; alarm( $timeout ); # プログラムスタート print "\n◆スタート\n\n"; sleep(4); # プログラム終了 print "\n◆終わりました。\n\n"; }; # タイムアウト処理 if ( $@ ) { # タイムアウト print "\nタイムアウトしました。TIMEOUT= $timeout \n"; } else { # タイムアウトせずに正常終了 print "\n正常終了しました。\n"; } # 排他処理終了 close(LOCK); exit;
ユーザー名とパスワードを入力してもらい、パスワードが一致していればOK、違っていればNGがでてくるプログラムを作りました。 if ( $password eq &sub_db( "SELECT password FROM login WHERE user LIKE '" . $user . "'") ) { print "OK!"; } else { print "NG!"; } ちなみに　&sub_db　というのはSQL文を実行するだけのサブルーチンです。 想定通りに動きましたが、SQL文の "SELECT password FROM login WHERE user LIKE '" . $user . "'" の '" . $user . "'" なんですが、最初はこうしてました "SELECT password FROM login WHERE user LIKE $user" これだと動きませんでした。多分シングルコーテーションで囲まなければいけない決まりがあるんだと思います。変数を文字列比較するときはこうしなければいけないのでしょうか？
Perlのソケット接続、connectで接続に失敗した時にdieではなく、別の接続先に接続するよう、次のように書きました。 connect(ファイルハンドル, 接続先1) || connect(ファイルハンドル, 接続先2) || die; 上記のコードではundefが帰って来た時にしか次の接続先に接続せず、例えばサーバーが応答せず、パケットをドロップしているような場合だと接続先1への接続でプログラムがハングアップしたような状態になります。 それぞれのconnectにタイムアウト時間を設けたいのですが、どのようにしたらよろしいのでしょうか。 また、ソケット接続にタイムアウトを設定できるモジュールがありましたらそちらを利用したいと思います。 Perl初心者で大変恐縮ですが、何卒宜しくお願い致します。
【 windows7 64bit + MySQL5.5 + ActivePerl 5.16.3 】 コマンドプロンプトで直接、 c:\>ppm install DBI No missing packages to install というメッセージがでます、これは「もうインストールされてるよー」という意味だと思いますが、プログラムを実行しても、 Software error: DBD::MySQL initialisation failed: Can't locate object method "driver" via package "DBD::MySQL" at C:/usr/local/lib/DBI.pm line 808. Perhaps the capitalisation of DBD 'MySQL' isn't right. at C:/Apache2.2/htdocs/00001/shinki_data_sakusei.pl line 33. というエラーがでます。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ # 初期設定部分 use strict; use warnings; # エラーをブラウザに表示 use CGI::Carp qw(fatalsToBrowser); use utf8; binmode STDIN, ':encoding(UTF-8)'; binmode STDOUT, ':encoding(UTF-8)'; binmode STDERR, ':encoding(UTF-8)'; use Encode; use DBI; # プログラム開始 # ユーザ名とパスワード my $dbname = 'login_data'; my $dbhost = 'localhost'; my $user = 'root'; my $pass = 'root'; #データベースへ接続 my $db = DBI->connect( "DBI:MySQL:dbname = $dbname;host = $dbhost", $user, $pass ); if ( ! $db ){ print "エラー： $db->err $db->errstr\n"; } # 命令 my $sth = $db->prepare( "SELECT * FROM login" ); # 実行 $sth->execute; # 出力 while( my @row = $sth->fetchrow_array ){ print "@row\n"; } #データベースから切断 $db->disconnect; __END__
以下のようなCSVファイルがあります。 xxx,yyy,"z,zz",XXX,"YY,Y",ZZZ,111,222 これを、 xxx,yyy,zzz,XXX,YYY,ZZZ,111,222 の様にperlで ""内のコンマを取りたいのですが、どうしたらよいでしょうか？ xxx,yyy,z zz,XXX,YY Y,ZZZ,111,222 の様に""内コンマを別の文字に置き換えても可です。 よろしくお願いします。
「windows7 64bit に ActivePerl をいれています」 以下のプログラムを書いて実行したところ、エラーメッセージがでてきました。 Software error: DBD::MySQL initialisation failed: Can't locate object method "driver" via package "DBD::MySQL" at C:/usr/local/lib/DBI.pm line 808. Perhaps the capitalisation of DBD 'MySQL' isn't right. at C:/Apache2.2/htdocs/00001/shinki_data_sakusei.pl line 33. これはつまり、DBD：：MySQL　がないよ！という意味であると思うのですが、ppmを起動してDBDにあたるモジュールをインストールして再実行してもまだ同じエラーがでます。どうしてもwindows7上で作らなければならないので、困っています。どこか参考になるサイトはないでしょうか？ ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ use strict; use warnings; # エラーをブラウザに表示 use CGI::Carp qw(fatalsToBrowser); use utf8; binmode STDIN, ':encoding(UTF-8)'; binmode STDOUT, ':encoding(UTF-8)'; binmode STDERR, ':encoding(UTF-8)'; use Encode; use DBI; # プログラム開始 # ユーザ名とパスワード my $user = 'root'; my $pass = 'root'; #データベースへ接続 my $db = DBI->connect('DBI:MySQL:localhost', $user, $pass,); if ( ! $db ){ print "エラー： $db->err $db->errstr\n"; } # 命令 my $sth = $db->prepare( "SELECT * FROM login" ); # 実行 $sth->execute; # 出力 while( my @row = $sth->fetchrow_array ){ print "@row\n"; } #データベースから切断 $db->disconnect; __END__
すいません、初心者です。 ActivePerl を使用して MySQL にアクセスしたいです。 windows7 64bit にActivePerlとMySQLを入れ込みました。 MySQLにアクセスするためのユーザー名やパスワードは　root です。 login_data　というテーブルを適当作成しました。 実際にアクセスしてみるには、どのようなコードを書けばいいでしょうか？ ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ use strict; use warnings; # エラーをブラウザに表示 use CGI::Carp qw(fatalsToBrowser); use utf8; binmode STDIN, ':encoding(UTF-8)'; binmode STDOUT, ':encoding(UTF-8)'; binmode STDERR, ':encoding(UTF-8)'; use Encode; use DBI; # プログラム開始 # ユーザ名とパスワード my $user = 'root'; my $pass = 'root'; #データベースへ接続 my $db = DBI->connect('DBI:MySQL:localhost:login_data', $user, $pass,); if ( ! $db ){ print "エラー： $db->err $db->errstr\n"; } # 命令 my $sth = $db->prepare( "select * from test" ); # 実行 $sth->execute; # 出力 while( my @row = $sth->fetchrow_array ){ print "@row\n"; } #データベースから切断 $db->disconnect; __END__
お世話になっております、ぷりんと申します。 当方、現在Perl言語にてCGIを作成->HTMLにて出力をしてサイト運営を行なっています。 その中で、携帯電話の利用者の一部が、「FORMタグでの投稿が反映されない」との連絡がきました。 その方はSH-01B（ガラケー）を使用しており、携帯電話のブラウザキャッシュの問題かな？と思い「携帯電話の電源を入れなおし、クッキーを有効にしてからお試し下さい」と伝えました。 しかし、現状できないようです。 そこで、キャッシュ対策にHTMLのヘッダに print "<meta http-equiv='pragma' content='no-cache' /> <meta http-equiv='cache-control' content='no-cache' /> <meta http-equiv='expires' content='0' />"; を入力したのですが、残念ながら問題の解決にはなりませんでした。 これはキャッシュが悪さをしているのでしょうか？それとも他になにか原因があるのでしょうか？ 言葉足らずかと思いますが、ご教授の程お願い申し上げます。 補足 アクセスログをとっていますが、「投稿が反映されなくなった」と連絡がきた時、その方がアクセスした形跡が見られません。
パターンマッチの勉強をしていたところ 偶然「ちょう」という言葉を以下のように書くとひっかからないことに気づきました。 なぜ「ちょう」という日本語だとひっかからないのでしょうか？ また「ちょう」がパターンマッチにひっかかるようにするのにはどうすべきなのでしょうか？ if($word =~ /ちょう/){ { &error("エラー","「ちょう」という言葉は使用できません"); }
ハッシュ変数の並べ替えをやりたいです。ただ、値の長さでソートをしたいのです。 my %tan_syouhin = ( '佐賀' => 'あいうえお', '滋賀' => 'かき', '無我' => 'さしすせそそそ', '千賀' => 'うりるら', '日我' => 'ぜるだんぽ' ); というハッシュ変数があって「値の長さ」でソートするにはどうしたら良いでしょうか？
いつもお世話になります。 ActiveState.comのActivePerl 5.14.4をwindows 8にインストールしました。 それから去年ActiveState.comから購入した（少し古い） 　Perl Dev Kit 9.2.1とそのライセンスをインストールしました。 PDKのツールたとえばPerlAPPを起動しようとすると Win32:BuildNumber not consistent with perl -v というエラーがでます。 ActivePerl は5.16.3もダウンロードできますが、やはり同じエラーです。 もう一度PDKを買いなおさないとだめでしょうか。。。 ご指導のほどお願いいたします。
Perlでの二重起動？についての疑問があるので質問いたします。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ （状況） １）Aというプログラムが存在し、そのAというプログラムはタスクスケジューラーによって１０分毎に起動しています。 ２）Aプログラムは全体の処理が終わるまでに通常５分の時間がかかります。処理が終わればexitで終わります。 （ちなみにAプログラムはファイル書き込みなどの排他処理が必要なフローはありません） ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ というのをふまえ、疑問点が出てきたので質問します。 例えば、あるイレギュラーな出来事が起こり、Aプログラムの処理時間が１５分に伸びてしまいました。 しかし、タスクスケジューラーは１０分間隔でAプログラムを起動させます。 このとき、オーバーした５分間だけAプログラムは二重に起動することになります。 　　　　　　　　　　０　　　５　　　　10 15 20 最初のＡプログラム　＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ 　次のＡプログラム　　　　　　　　　　　＝＝＝＝＝＝＝＝＝＝ この場合、windows7上のActivePerlは、どんな動きをするのでしょうか？ 予約みたいな形になり、最初のAプログラムが終わってから次のAプログラムが動くのでしょうか？ それとも二重起動するのでしょうか？
perlでフォロワー一覧を取りたいのですがよくわからず困っています。 こちら、 http://pplace.jp/2012/10/1058/ 参考にしてやろうとしているのですが、 使えなくなったとされる１が使えて、１．１のほうがむしろエラーになります。 http://api.twitter.com/1/statuses/followers/TwitterのID.xml →　これはOK http://api.twitter.com/1.1/friends/ids.json?screen_name=TwitterのID →　エラーになる {"errors":[{"message":"Bad Authentication data","code":215}]} どうやらOauthの失敗とのことですが、、、 簡単なサンプルは動きました。 ---- こちらは確認　つぶやきサンプルです ------------- use strict; use Net::Twitter; my $consumer_key = '' my $consumer_secret = ''; my $token = ''; my $token_secret = ''; my $nt = Net::Twitter->new( traits => [qw/OAuth API::REST/], consumer_key => $consumer_key, consumer_secret => $consumer_secret, access_token => $token, access_token_secret => $token_secret, ); my $result = $nt->update('Hello World'); ----------------------------------------------------- しかし、 そもそも上のようなURL（GETメソッド？）をどうやってOAuthで呼び出すのかがわかりません・・・ perldoc Net::Twitter も見たのですが、それっぽい記述はありませんでした・・・ perlでTwitter1.1のAPIのGetメソッド（？）はどうやって呼び出すのでしょうか・・・
投票cgiを設置したいのですがうまくいきません、集計を1日一回だったのを少し改造して即時集計にしました 一応動くのですが、連続投票できてしまいます。 連続投票を一定時間制限できるようにしたいのですがうまくいきません 60秒くらい間をおいてから投票できるようにできますか？ ip制限もあるみたいなのですがこれも機能してないです・・・ 改善できるなら元のソースがかなり変わってもかまいません 連続投票制限だけでも機能できればと思っています。よろしくお願いします local $times = time(); sub vote{ if($FORM{id}){ my $fl=0; if(!$CK_ref){$fl=1;} else{ if(index($ENV{'HTTP_REFERER'},index.html>=0){$fl=1;} } if($fl){ $FORM{id}=~s/\n//g; my $vote = $FORM{vt2}?1:0; open(OUT,">>vote_temp.cgi"); #時間用のログファイルに書き込み print OUT "$FORM{id}<>$ENV{'REMOTE_ADDR'}<>$FORM{vt}<>$vote<>".$times."<>\n"; close(OUT); &reset_vote if $VT_RESET < $times; my(@log_lines,%pt,%pt2,%cnt,$name,$value,%CKIP); open(IN,"vote_temp.cgi"); my @log = <IN>; close(IN); if(@log){ my $cktime = $times - 60; #60秒制限 open(IN,"vote_ck_IP.cgi"); #投票した人のIPを記録したログ while(<IN>){ my @ck = split('<>'); next if $_[1] < $cktime; $CKIP{$_[0]} = $_[1]; } close(IN); foreach(@log){ chop; my @rank = split('<>'); #ID<>IP<>評価<>おすすめ<>時間\n next if $CKIP{"$rank[0]_$rank[1]"}; $pt{$rank[0].'_'.$rank[2]}++; $pt2{$rank[0]}++ if $rank[3]; $cnt{$rank[0]}++; $CKIP{"$rank[0]_$rank[1]"} = $rank[4]; } open(OUT,">vote_temp.cgi"); close(OUT); open(OUT,">vote_ck_IP.cgi"); while(($name, $value) = each(%CKIP)){ print OUT "$name<>$value<>\n"; } close(OUT); open(IN,"log.cgi"); my @data = <IN>; close(IN); foreach(@data){ #集計処理長かったので省略 } open(OUT,">vote_bf.cgi"); open(IN,"vote_log.cgi"); while(<IN>){ print OUT $_; } close(IN); close(OUT); open(OUT,">vote_log.cgi"); print OUT @log_lines; print OUT "\n1;\n"; close(OUT); } &make_vote_ck('set'); } } sub reset_vote{ my @log; foreach my $i(1..$LAST_ID){ next if !@{$VT[$i]}; $VT[$i][18] = $VT[$i][7]; $VT[$i][19] = $VT[$i][8]; $VT[$i][20] = $VT[$i][0]; foreach my $j(0..8){ $VT[$i][$j] = 0; } push(@log,'$VT['.$i.'] = ['.(join(',',@{$VT[$i]}))."];\n"); } open(OUT,">vote_log.cgi"); print OUT @log; print OUT "\n1;\n"; close(OUT); &make_vote_ck('reset'); } sub make_vote_ck{ if($_[0] eq 'set'){ my @t =localtime($times + 86400); $VT_TIME = timelocal(0,0,5,$t[3],$t[4],$t[5]); $VT_RANK = $VT_RUI = $VT_RECO = $VT_RCRUI = $VT_COUNT = $VT_CTRUI = $VRK_CK = 1; } if($_[0] eq 'reset'){ my @m =localtime($times); $m[4] += 1; if($m[4] > 12){ $m[4] = 1; $m[5] += 1; } $VT_RESET = timelocal(0,0,2,1,$m[4],$m[5]); $VT_RANK = $VT_RECO = $VRK_RS = $VRK_CK = 1; } if($_[0] eq 'restore'){ $VT_RANK = $VT_RUI = $VT_RCRUI = $VT_RECO = $VT_COUNT = $VT_CTRUI = $VRK_CK = 1; } open(OUT,">vote_ck.cgi"); print OUT "\$VT_TIME = '".$VT_TIME. "';\n"; print OUT "\$VT_RESET = '".$VT_RESET. "';\n"; print OUT "\$VT_RANK = '".$VT_RANK. "';\n"; print OUT "\$VT_RUI = '".$VT_RUI. "';\n"; print OUT "\$VT_RECO = '".$VT_RECO. "';\n"; print OUT "\$VT_RCRUI = '".$VT_RCRUI. "';\n"; print OUT "\$VT_COUNT = '".$VT_COUNT. "';\n"; print OUT "\$VT_CTRUI = '".$VT_CTRUI. "';\n"; print OUT "\$VRK_CK = '".$VRK_CK. "';\n"; print OUT "\$VRK_RS = '".$VRK_RS. "';\n"; print OUT "\$LAST_ID = '".$LAST_ID. "';\n"; print OUT "\n1;\n"; close(OUT); }
perl5.8.8を使っています。 日本語にマッチする正規表現を書きたいのですが、どうしてもマッチしません。 例えば、以下のファイルtest.txtから「さしすせそ」だけを抽出し、表示させたいです。 ---------test.txt-------------------------------- あいうえお かきくけこ さしすせそ たちつてと -------------------------------------------------- ----------test.pl-------------------------------- use strict; use warnings; open(FILE, 'test.txt') or die "$!"; my @file = <FILE>; close(FILE); foreach my $line (@file){ if($line =~ /^さ/){ print "$line\n"; } } ------------------------------------------------ このtest.plを実行しても「さしすせそ」を抽出することが できません。 どうしたらよいのでしょうか? 自宅の新しいバージョンのperlだとできるのですが 会社のperlは5.8.8で顧客環境でもあるのでバージョンアップも できません。 すみませんが、よろしくお願いいたします。
ファイル内のデータの並び替え処理したく、質問します。 データは、１列目に通し番号、２、３、４列目にデータが入っています（下に例を書きます）。 ５行ごとに５つの行のデータをまとめたいのです。 具体的に言うと、「１、６、１１、１６、２１行目」のデータをまとめて１行（タブ切り）に。新しい行には、真ん中の数字「１１」を先頭列に入れたいです。 それをずらしてゆき、「２、７、１２、１７、２１行目」のデータを１行に、、というようにしたいのです。 扱うファイルの行数は、様々です。 これを統計処理を行う予定です。perl初心者ですので、トライした思案策を載せても参考にならないかと思い、０から教えて頂く形になりますが、よろしくお願いします。 1101010 2202020 3303030 4404040 5505050 6101010 7202020 8303030 9404040 10505050 11101010 12202020 13303030 14404040 15505050 16101010 17202020 18303030 19404040 20505050 21101010 22202020 23303030 24404040 25505050 出来上がりは、 11 10 10 10 10 10 10 10 10 10 12 20 20 20 20 20 20 20 20 20 というようになります。
PerlのImage::Magickで、画像の加工を行っています。 バージョンは下記です。 ＝＝＝＝＝＝＝＝＝ Perl 5.6.1 Image::Magick 5.42 ＝＝＝＝＝＝＝＝＝ iPhone画像の向きがおかしくなってしまうので、正しい画像の向きに変更したいのですが、 $img->AutoOrient(); を使えばいい事はわかりましたが、バージョンの違いによって、使用できませんでした。 都合上、上記のImage::Magickのバージョンは変更できません。 AutoOrient以外で記載したバージョンでも画像を正しい向きに変更する方法はありますでしょうか。
恐れ入ります。 Perlで、フォームから送信して、変数に代入したいのですがうまくいきません。 print qq!<form action="./xxx.cgi" method="get">!; opendir(DIRHANDLE, "./xxx"); foreach(readdir(DIRHANDLE)){ next if /^\.{1,2}$/; print qq! <input type="checkbox" name="$_" value="$_"> <input type="submit" value="送信"></form> とし、ディレクトリ内のフォルダ名をnameに格納してxxx.cgiへ送信します。 xxx.cgi側では、 #!/usr/bin/perl use cgi; $form = CGI->new; として、送信されたデータを次々と代入したいのですが、どのようにしたらよいでしょうか。
あるWebシステムで、エラーログに「Malformed UTF-8 character」が大量に出力されています。 意味はわかるのですが、どんな文字列がエラーになっているか分からないので、デバッグできず困っています。 # 全てのアクセスで必ず通るロジックなので、入力文字列を無条件にダンプするわけにも行きません。 もし、「Malformed UTF-8 character」になる見込みの文字列だけダンプするなど、効率的なデバッグ手段があれば、教えていただけますでしょうか。 よろしくお願いいたします。
【できていること】 Cookieの発行 Cookieへのデータの書き込みと参照 【ここから質問】 ログイン認証があるWebアプリケーションにおいて、セッション情報（ID）とユーザ情報はどのように紐付けているのでしょうか？ （ログイン成功時に生成するセッションIDとユーザ情報の紐付け情報をどこにどのように保持するのかがわかりません） Cookie（クライアント側）はセッションIDのみを保持しておいて、サーバ側で紐付け情報を保持するのだと思うのですが、CGI::Sessionではセッション生成時に作成されるcgise_XXXXファイルに書き込むのでしょうか？（そのメソッドか、具体例があれば教えてください） それとも紐付け専用のテーブルを用意しておくのでしょうか、もしくは、ユーザ情報のテーブルにあらかじめセッション情報を格納するカラムでも用意しておくのでしょうか。 よろしくお願いします。
perlの初心者です。 cshスクリプト内に、perlの１ライナースクリプトを入れて、文字の置き換えをしたいのですが、 記述の仕方が解りません教えてください。 【詳細】 テキストファイル内は、下記のようなデータが入っており、perlの1ライナーで文字列が ５フィールドのみMIYAKE_ILFをMIYAKE_ILFU　 MIYAKE_HFをMIYAKE_HFU　MIYAKE_LFをMIYAKE_LFUへ置き換えて、それ以外はそのまま出力したいのです。 130325.142626.281 #p 130325.142627 MIYAKE_ILF tanaka 130331.012203.576 #p 130331.012210 MIYAKE_HF tanaka 130428.132805.796 #p 130428.132809 MIYAKE_LF tanaka 130419.163411.369 #p 130419.163411 MIYAKE_HF tanaka　 #f 13 04 19 16 34 10.565 34.08739 139.52408 1.377 0.2 0.018 0.020 0.042
perl勉強中です HTMLフォーム(cgiのテンプレ)からtest.cgiに送信してmysqlにテキストを登録や取得はできました 1つのtexteraが長いため表示を1ページにtextera一つにしています カラム10まで同じテンプレで登録するのにフォームの切り替えをすることはできますか？ test.html（HTMLのフォームのテンプレ）を10個も作るのは効率が悪いきがします 繰り返し処理でやりたいのですが素人なのでピンときません、部分的でもいいのでお願いします mysqlのカラムは作ってあるものとします 例えば、htmlページの<input type=submit value="カラム2">をクリックするとtest.cgiに送信されて、もう一度、同じフォームのページを表示、しかし、カラム2への登録フォームになっているみたいな感じです
【PerlでHTTPヘッダの最後の\nを１つでも外すとエラーになります】 初歩的なことですみません。 HTTPヘッダーの最後の\n\nなんですが、ヘッダーの文字列の後に改行が２つ？？　と思って この\nを外して、 print "content-type:text/html;charset=utf-8";　とすると、「500 Internal Server Error」 print "content-type:text/html;charset=utf-8\n";　と\nが1つでも　「500 Internal Server Error」 となります。 「\n\n」と２つあればエラーにはならないんですが、なぜ必ず２つ必要なのでしょうか？これは改行が２つって意味ですかね？ print "<html>\n"などの\nはソース上やコンソール出力結果上での改行なのはわかります。 この\nは改行したくなければ書かなくてもエラーになりませんよね。（当たり前ですが・・ #!/usr/bin/perl print "content-type:text/html;charset=utf-8\n\n";　←HTTPヘッダーの\n\n print "<html>\n"; print "<body>\n"; print "<p>テキスト</p>\n"; print "</body>\n"; print "</html>\n";
while( <$_old> ){ if( $_ =~ /^$var\:(?!\*RK\*)/ ){ print "A\n"; }else{ print "B\n"; } } 上記の上から2行目の if( $_ =~ /^$var\:(?!\*RK\*)/ ){ において、 ()の中の先頭に ?!　とあるのですが、 これはどういう解釈なのでしょうか？ ご助言ご鞭撻の程宜しくお願い致します。
EXCELのVBAでマクロをくみ、perlのプログラムを起動することは可能でしょうか？ またperｌのプログラム内容が起動パスのところにあるファイル名を取得するプログラムなのですが、 これでEXCELのマクロを実行したパスにあるファイル名を取得することはできるのでしょうか？
test.txtのファイルの中に以下のコメントがはいっています。 --- test.txt（置換前） 各URLは以下の通りです。 (1)hoge.com (2)hoge123.com (3)hoge222.com --- ファイルの中のhoge.comはそのままで、以下のようにその他の文字は他の文字に置換を行いたいと思ってます。 --- test.txt(置換後) 各URLは以下の通りです。 (1)hoge.com (2)abc.com (3)abc.com --- 指定した文字(hoge.com)を置換する方法は簡単に行えるのですが、指定した文字以外の文字を置換する場合、どのように書けばいいでしょうか？ どなたかよろしくお願いします。
timelog.txtのファイルの中に、[時:分:秒,不特定数値]が入っている状態で、 [00時]台が検出された場合にその前にある23時台で始まる行だけをtimelog_yesterday.txtで出力したいのですが どのようにしたらいいでしょうか？ 例） timelog.txt ------------------------------ 23:58:00,-2 23:59:00,-1 00:00:00,0 00:01:00,1 00:02:00,2 00:03:00,3 00:04:00,4 ------------------------------ ↓ timelog_yesterday.txt ------------------------------ 23:58:00,-2 23:59:00,-1 ------------------------------ timelog.txt ------------------------------ 00:00:00,0 00:01:00,1 00:02:00,2 00:03:00,3 00:04:00,4 ------------------------------ また、この時[00:]で始まるものがない場合はそのままにしたいです。 例） timelog.txt ------------------------------ 00:00:00,0 00:01:00,1 00:02:00,2 00:03:00,3 00:04:00,4 ------------------------------ ↓ timelog.txt ------------------------------ 00:00:00,0 00:01:00,1 00:02:00,2 00:03:00,3 00:04:00,4 ------------------------------ お手数をお掛けしますが、ご教授いただけると幸いです。 よろしくお願い致します。
PerlでMySQLのデータベース内のテーブル一覧を取得することはできますか？ 自分で以下の様なサブルーチンを作りましたが、返り値に何も入っていませんでした。 コマンドラインでもshow tables;で確認したのでテーブルは確実に存在します。 接続も showでfetchrow_arrayなどは使えないのでしょうか？ またselect文でテーブル一覧を取得する方法がありましょうか？ Error: failed to connect to DB.とは出てこないので、接続も成功しています。 sub mysql_tablesGet{ my @data=@_; my $db_id = $data[0]; my $db_password = $data[1]; my $dbh = DBI->connect("dbi:mysql:dbname=".$ftp_id.";host=$mysql_host", $db_id,$db_password) or die "$!\n Error: failed to connect to DB.\n"; my $sth = $dbh->prepare("show tables;"); $sth->execute; my @response; my $i=0; while(my @var = $sth->fetchrow_array){ my ($table_name) = $var[0]; $response[$i] = $table_name; $i++; } $dbh->disconnect; return @response; } MySQLのログはこんなのが出ています。 130406 17:11:44 70 Connect test2@192.168.11.22 on test2 70 Query set autocommit=1 特にエラーは出ていないので、show tables;は成功していると思います。
一般的なソケットの接続は次のような書き方になっていると思いますが、connectでundefが帰って来た時にdieではなく、別の接続先に接続するような書き方を探っています。 connect(ファイルハンドル, 接続先) || die; 上記のコードを次のように書き換えてみましたが、接続先1で失敗した場合、接続先2に接続されるかと思いきや、そのままdieしてしまいます。 connect(ファイルハンドル, 接続先1) || connect(ファイルハンドル, 接続先2) || die; この書き方はどこがまずかったのでしょうか。 また、想定通りに動作させるにはどのように書いたら良いのでしょうか。 Perl初心者で大変恐縮ですが、何卒宜しくお願い致します。
perl5.8でFormから送られてきたデータを取得し、整理しています。 FormはPOSTでperlに送り、データを整理したのですが、checkboxで複数のデータを送ったとき、うまく処理されていません。 Formのあるページも同じperlでcgiページを作り、エラーがあった場合、エラーメッセージ付きで再度そのcgiページを表示するようにしています。 次の内容で、@noにcheckboxで選択した番号が入るようにしています。 valueには　-　が余分にありますが、これは試しにcheckboxで複数選択してデータをsubmitしてみたところ、受け取り先の$in{no}で番号が連続して1つのスカラーで連なるので、番号を後に分割するために-を入れ、受け取り後、@no = split(/-/, $in{no});でばらして@noに番号を格納してあります $r_noは別のデータから受け取った比較先の番号です Formのcheckboxの部分は（実際はこれを複数回ループして$r_noが変化します） my $checkbox; foreach my $l (@no){ my $i = 0; if($l == $r_no){ $i = 1; } if($l == $r_no){ $checkbox = "<input type=\"checkbox\" name=\"no\" value=\"$r_no-\" checked>"; last; }else{ $checkbox = "<input type=\"checkbox\" name=\"no\" value=\"$r_no-\">"; } } print "$checkbox"; ２つ以上checkboxを選択して、わざとエラーが出るように他の部分を間違った選択をするようにして試してみたところ、@noには選択した分だけの番号が格納されているにもかかわらず、 if($l == $r_no){ の部分が真になるのは1つ目の@noとの真偽だけで、2つ目以降は本来真になるべき比較でも偽になってしまいます。 改行コードなどが入っているのかと思い、chompで後ろを削ったり、$l =~ s/\r?\n/K/g; $l =~ s/\r/K/g;で改行コードを可視化して確認してみましたが、それらしきものも入っていませんでした @noには選択した番号全てが収納されていますし、後ろに改行コードなど不要なものも入ってないのに真偽の分岐がうまくいかない原因は何にあるのでしょうか？ 思い当たるものは一通り試したのですが、どうしてもわかりません。 「これが原因かも？」みたいな可能性だけでも結構ですので教えてください。 よろしくお願いします。
perlでのセッション管理を学びたいです。 わかりやすく解説されたサイトなどがありましたら教えてください。 よろしくお願いします。
たとえば、 $out[0] = "いぬ"; $out[1] = "もりくぼしょうたろう"; $out[2] = "うさぎさん"; $out[3] = "からす"; $out[4] = "ねこ"; という @out を用意して以下のようにすると、 my @sorted = sort { length($b) <=> length($a) } @out; 長さでソートが行われます。おそらく長い順に並び替えが行われるので $sorted[0] = "もりくぼしょうたろう"; $sorted[1] = "うさぎさん"; $sorted[2] = "からす"; $sorted[3] = "いぬ"; $sorted[4] = "ねこ"; となると思います。 ここからが質問なのですが、 @out の他にもうひとつ @out と同じ数の変数を用意して、 $out_hitokoto[0] = "わんわん"; $out_hitokoto[1] = "いくぜ！相棒！"; $out_hitokoto[2] = "ぴょんぴょん"; $out_hitokoto[3] = "カァーカァー"; $out_hitokoto[4] = "にゃにゃーん"; @out_hitokoto は @out と対応しています。しかし、@outをソートすれば、 対応している@out_hitokotoも並べ替えを行わなければなりません。 ハッシュ変数はある事情から使えません。 なにかよい方法はないでしょうか？ できれば、 my @sorted = sort { length($b) <=> length($a) } @out; の次の文章で@out_hitokotoに変化を起こさせたいのですが。 みなさんは、どうしますか？
Perl5.8でCSVをダウンロードできる仕組みをつくっています。 utf-8でコードを記述しているため当然ながらダウンロードしたCSVデータもutf-8です。 しかしながらエクセルでダブルクリックで開く場合どうしてもutf-8だと支障があるため、 shift-jis(もしくはcp932)で開きたいのです。 ダウンロード時に文字とファイルをshift_jisに変換する方法はございませんでしょうか？ 以下作成済みのコード ------------------------------------------------------- if(!open(OUT,"$CSV_FILE")){&error('CSVデーターファイルがありません'); } else{ @csvdata=<OUT>; close(OUT); } foreach(@csvdata){ $downloaddata .= $_; } print "Content-Disposition: attachment; filename=$CSV_FILE_NAME\n\n"; print $downloaddata; exit; ------------------------------------------------------- 何卒よろしくお願いいたします。
下記、PERLスクリプトを Windows 7＋ActivePerl　+　UTF-8記述状態 で使いたいのですが、どうやら、「爱」が正常に変換されず、?という文字が発生しファイルの作成ができないようです。 普通に、Windows 7上で、$titleの爱愛aiをコピーしてファイルの作成はできるので、Perl上でもこの動作を何とか実現させたいのですが、どのようにすればいいでしょうか？ ---test.pl(utf8記述)--- use strict; my $title = "爱愛ai"; # 念のためURLエンコードした物も書いておきます＞%E7%88%B1%E6%84%9Bai use Encode; Encode::from_to($title, "utf8", "cp932"); open(F,">$title"); print F $title; close(F); open(F,">title_test.txt"); print F $title; close(F); -------------------------------
インターネット上の情報を参考に作成したCGIでPerlのソケットを用いて通信を行っておりますが、CGIが呼び出されるたびに以下のような動作を行っております。 ソケット生成 -> ソケット接続 -> HTTP通信 -> ソケット切断 このうち、ソケットの接続におおよそ200ミリ秒ほどかかり、このレイテンシを減らすため、ソケットはCGIが呼び出されるたびに生成、接続するのではなく、最初からセッションを張った状態で、CGIが呼び出されるとHTTP通信部分のみを行うようにすることはできますでしょうか。 現在試したこととして、1回目の呼び出しでソケットをクローズせずに処理を終了し、2回目でソケットの生成、接続をせずに直接HTTP通信をしようとしてもうまくいきませんでした。 Perl、ネットワークプログラミング初心者なもので恐縮ですが、何卒よろしくお願いいたします。
ここのページを参考にuse Socketでホームページを読み込むスクリプトを作りました。 http://ash.jp/perl/socket_http.htm httpは問題なく読み込めるのですが、httpsのページが読み込めません。 以下のように'http'を'https'に変更してみたのですが、エラーになります。 $port = getservbyname('https', 'tcp'); ■エラー Your browser sent a request that this server could not understand. Reason: You're speaking plain HTTP to an SSL-enabled server port. Instead use the HTTPS scheme to access this URL, please. ---- use Socketではsslのページを読めないのでしょうか？ Perlでsslのページを読む方法はありますでしょうか？
@data=( '1<><>あああああ', '2<><>いいいいい', '3<>1<>ううううう', '4<>3<>えええええ', '5<>2<>おおおおお', ); このような <>で区切ったデータがあるとします。 一番左の数字は、そのデータのIDで、その次の数字は、 その親データのIDです。 このデータを、 1<><>あああああ 　3<>1<>ううううう 　　4<>3<>えええええ 2<><>いいいいい 　5<>2<>おおおおお のようなツリー形式に並べたいのです。 []を1つのノードと考えた $nodes=['1<><>あああああ',['3<>1<>ううううう',['4<>3<>えええええ']],'2<><>いいいいい',['5<>2<>おおおおお']]; のような配列を作れれば、 $nodes=['1<><>あああああ',['3<>1<>ううううう',['4<>3<>えええええ']],'2<><>いいいいい',['5<>2<>おおおおお']]; sub tree{ my($i); my $depth = shift; my $ref = shift; foreach(@{$ref}) { if (ref($_) eq "ARRAY") { &tree($depth+1, $_); } else { for($i=0;$i<$depth;$i++){ print " "; } print $_."\n"; } } } &tree(0,$nodes); というコードでツリーにできるところまではできました。 ですが、 @dataから$nodesを作る方法がわからず困っています。 $nodesは多少違うものでも構いませんので、 何かいい方法があれば教えてください。 よろしくお願いします。
Perl初心者です。 １～８のうちの数字のランダムな並び変えと、その中から以下の条件で数字を６つ選びたいのですが、方法が分からず、ご教示いただければ幸いです。 やりたいのは、 １）１～８から６つの数字を選びたい。 ２）数字のうち、６，７，８は１つしか選ばれないようにして、かつ３番目か４番目に入るようにしたい です。 たとえば、 2,3,6,1,4,5（6が選ばれて3番目に） 4,5,3,8,1,2（8が選ばれて4番目に） 1,3,7,2,5,4（7が選ばれて3番目に） 等の結果が得られることを期待しています。 ちなみに、単純に８つの数字のランダムを作るときは以下のように記述していました。 可能であれば、これにどう追記したら上記のことが実現できるかご教示いただけると嬉しいです。 どうぞ宜しくお願いいたします。 my @buf = ("","","","","","","","",""); my @buf2 = ("","","","","","","","",""); my $set_flag = 1; my $idx = 0; while(){ if ($set_flag > 8){ last; } $idx = int(rand(8)) + 1; if ($buf[$idx] ne ""){ }else{ $buf[$idx] = $set_flag; $buf2[$set_flag] = $idx; $set_flag++; } } my $q_list = ""; for(my $loop=1;$loop<=8;$loop++){ if ($q_list ne ""){ $q_list .= ","; } $q_list .= "" .$buf2[$loop]; }
恐れ入ります。 perlにて、＆検索を実行する為に、以下のようにしています。 しかしうまく動作しません。 use CGI $word = $form->param('word'); open (IN<, "xxx.txt"); $rec=<IN>; $where="$rec ne '' "; if($word ne ''){ $word =~ s/　/ /g; @word_array = split(/ / , $word); foreach (@word_array){ $where .= "and $rec=~/$_/ "; } } if($where){ @rec=split(/,/, $rec); //省略 xxx.txtを$recに格納して、フォームより送信されてきたスペース区切りの語句を、分割し、各々をマッチさせて検索したいのですが、 どのようにしたらよいでしょうか。よろしくお願いします。
Cygwin TerminalをWin7x64にインストールしました。 インストール完了後、Perlプログラムでuse Text::CSV_XSを実行すると Can't locate Text/CSV_XS.pm in @INC エラーが出てしまいます。 ・エラー Can't locate Text/CSV_XS.pm in @INC (@INC contains: /usr/lib/perl5/site_perl/5.14/i686-cygwin-threads-64int /usr/lib/perl5/site_perl/5.14 /usr/lib/perl5/vendor_perl/5.14/i686-cygwin-threads-64int /usr/lib/perl5/vendor_perl/5.14 /usr/lib/perl5/5.14/i686-cygwin-threads-64int /usr/lib/perl5/5.14 /usr/lib/perl5/site_perl/5.10 /usr/lib/perl5/vendor_perl/5.10 /usr/lib/perl5/site_perl/5.8 .) at mysql.pl line 11. ・やってみたこと perl -MCPAN -e shell install Text::CSV_XS を実行してみたのですがダメでした。 どのように対応すれば解決できますでしょうか？ ご教授お願いします。
BEGIN { open ( STDERR, '>>', '.err.txt' ); } # エラーログ出力する とやると、エラーログをerr.txt に出力する事ができますが、このエラーメッセージの先頭に自動的に日時をつける方法はないでしょうか？
以下のよーに指定すればエラーログの場所を指定する事ができますが、 # エラーログ BEGIN{ open ( STDERR, ">>./log/err_log/err.txt" ); } たとえば変数にファイル名を入れて指定する場合は、 $err_log = "./log/err_log/err.txt"; BEGIN{ open ( STDERR, ">>$err_log" ); } とするとエラーが出てしまいます。変数に入っているものを指定するにはどうすればいいでしょうか？
お世話になっております、ぷりんと申します。 下記の投稿をしましたが、解答が得られませんでした・・・。 しかしいろいろ調べているうちに、PHPでは「 mysql_set_charset　」を実行すると文字化けが治るとお聞きしました。 この mysql_set_charset　をPerlで実行するには、どうしたらよろしいのでしょうか？ 以下前回投稿 3日間文字化けと格闘した結果、ついに力尽きてしまったのでまたこちらにお世話になります(TдT) 使用しているコードはUTF-8です。 さて、データベースへ 　　$db=DBI->connect("略"); 　　$sth = $do->prepare("select name from xxx"); にて接続、nameカラムのデータを抽出し、配列変数に入れて表示させました。 データベースに直接日本語入力（例えば”ああああ”）をし、抽出すると、HTML出力の際に「????」となってしまいます。 INT型は正常に処理されます。（文字ではありませんが念のため記述） データベースに直接記入しない方法（CGIにてInsertを使用して）「ああああ」を送信しますと、データベースをブラウザで確認した際に「ã‚ã‚ã‚ã‚」になりますが CGIにてSelectを使用し、リクエストすると　きちんと「ああああ」と表示されます。 また、InsertでNプレフィックスをつけた際はデータベースをブラウザで確認するときちんと「ああああ」となっておりますが、CGIにてSelectを使用してリクエストすると「????」とデータベースに直接日本語入力した時と同じ結果になります。 最終的に「読み込みも問題なく、データベースをブラウザで確認しても（または直接編集しても）正常に処理される環境にしたいのです！ 文字化け関係はしんどいかと思いますが、どなたかお詳しい方、ご教授お願い致します。 -環境- ●ロリポップレンタルサーバー 　　Perl(ver.5.8.8) 　　MySQL(バージョン5.1.34)利用可。『PHP My Admin』でのみ利用可。 ●本文中の「データベースをブラウザで確認」とは、PHP　My Adminにはいって確認しているという意。 ●cgi保存形式は全てUTF8（BOM無し。有だとエラー） ●HTML出力は 　　print "Content-type: text/html; charset=utf-8\n\n"; ●show variables like 'char%';　を実行した結果 character_set_client　　　　　utf8 character_set_connection　　utf8 character_set_database　　　utf8 character_set_filesystem　　binary character_set_results　　　　utf8 character_set_server　　　　utf8 character_set_system　　　　utf8 character_sets_dir/usr/share/mysql/charsets/ ●照合順序 カラム：utf8_unicode_ci テーブル：utf8_unicode_ci DB：utf8_unicode_ci MySQL接続：utf8_unicode_ci -試したこと- Encode::encodeやEncode::decode関数を使用しても変化無し。
Perlでモジュールをインストールしない方法をしりたいです。 普通はコマンドを使ったりして必要なモジュールを予めインストールしますが、インストールせずにCPANサイトからモジュールをダウンロードしてきて使用する方法はありますか？ 自分の感覚だと、プログラムの最初に何かを宣言すればいいのかな、と思うのですが。
毎度ご迷惑をおかけしております http://idsc.nih.go.jp/idwr/CDROM/Kako/H18/Syuukei/Syu_08_1.xls というExcelファイルの全sheetを.csvに吐き出そうと思い、OKwaveでコードを教えてもらいました しかし Wide character in printという警告が出て文字化けしました。 そこでまたOKwaveで聞いたところ、 http://www.rwds.net/kuroita/program/Perl_unicode.html#widechar というＵＲＬを教えてもらいました。 これに従って（？）、理屈はわからないながら utf8フラグが立っていたら落とすというような コードにしてみましたが、やはり文字化けします。 全く原理ができておらず、誠にお恥ずかしい限りですが、 どのようなコードを書けばよいか、ご指導よろしくお願い申し上げます。 以下、だめだったコードです（改悪は私です）。 ######################################################################### use Spreadsheet::ParseExcel; #use Encode qw/ encode decode/; use Encode; my $sFN = "Syu_08_1.xls"; my $filename = $sFN; print "filename: $filename\n"; my $parser = Spreadsheet::ParseExcel->new(); my $workbook = $parser->parse( $filename ); if ( !defined $workbook ) { die "Parsing error: ", $parser->error(), ".\n"; } my $sRT = ''; ## シートの数だけ繰り返し for my $worksheet ( $workbook->worksheets() ) { print OUT "*"; my ( $row_min, $row_max ) = $worksheet->row_range(); my ( $col_min, $col_max ) = $worksheet->col_range(); foreach my $nLineY ( $row_min .. $row_max ) { my $rec = ""; foreach my $nLineX ( $col_min .. $col_max ) { my $cDT = $worksheet->get_cell($nLineY,$nLineX); ## セルにデータが在ったときの処理 if ( $cDT ) { $sTMP = $cDT->value(); $sTMP =~ s/,//g; if ( utf8::is_utf8($sTMP) ){ # utf8フラグがたっていたら print "utf flag on: $sTMP\n"; utf8::encode($sTMP);　　# utf8フラグを落とす } $rec .= "$sTMP,"; } } print "$rec\n"; } }
PerlでメールにZIPファイルを添付して送信したいです。 http://homepage3.nifty.com/hippo2000/perltips/perlmail.htm#1.2 http://perltips.twinkle.cc/perl/mail_mime_attached_file.php 上記のサイトを参考に以下のプログラムを組んでみました。 するとエラーメッセージが画像のような感じででてきました。 おそらく、なんか文字コードがおかしいのかもしれないのですが、どこから手をつけていいのかわかりません。 どなたかお助け下さいm(__)m 前回も別の問題で助けていただいたのですが、文字コードの問題でした。他の部分は全くひっかからないのに、この部分で４０時間ほど悩んでおります・゜・(ノД`;)・゜・ ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ sub mail_push { # サーバー、アカウント、パスワード、ポート、送信元アドレス、送信先アドレス、題名、本文、送るべきファイル１（空の場合は無視）、送るべきファイル２（空の場合は無視） my ( $mailhost, $mail_username, $mail_password, $mailport, $from_mail, $to_mail, $subject, $message, $file1, $file2 ) = @_; # 正しいメールの形なのか調べる if ( $to_mail eq '' ) { print "送り先のメールアドレスが空のようです\n"; # ERR } elsif ( $to_mail =~ /^([a-zA-Z0-9\.\-\/_]{1,})@([a-zA-Z0-9\.\-\/_]{1,})\.([a-zA-Z0-9\.\-\/_]{1,})$/ ) { # 実際に送る my $smtp = Net::SMTP->new($mailhost, Port => $mailport); $smtp->auth($mail_username, $mail_password); $smtp->mail($from_mail); $smtp->to($to_mail); $smtp->data(); my $mime = MIME::Entity->build( Type => 'multipart/related', From => $from_mail, To => $to_mail, Subject => $subject, Type => 'text/plain;charset="iso-2022-jp"', Data=> $message, Encoding => "7bit"); # エラーがでてくる箇所 $mime->attach( Path　　 => 'c:/buromaga1.jpg', Type　　 => 'Application/octet-stream', Encoding => 'Base64',); $smtp->datasend($mime->stringify);# ERR $smtp->dataend();# ERR # SMTP終了 $smtp->quit; } else { print "送り先が正しいメールの形式ではありません\n"; # ERR } }
初めて質問します。 今、PerlのDBIを使ってMySQLのトランザクション処理にチャレンジしています。 ところが、rollback処理がうまくできません。 具体的には、 table2 がある状態で下のプログラムを動かすと、 エラーの表示が出るのに、 table1 は作成されました。 何らかのエラーがあれば、どちらも作成されないようにしたいです。 ======================================================= my %sql; $sql{db_name} = "database"; $sql{host} = "localhost"; $sql{user_name} = "user_name"; $sql{password} = "password"; use DBI; my $dbh = DBI->connect('DBI:mysql:'.$sql{db_name}.':'.$sql{host}, $sql{user_name}, $sql{password} ,{RaiseError => 1, PrintError => 0, AutoCommit => 0 }) || &Err(); my $sth; my $re; eval { my $sql_string1 = "create table table1(`id` int);"; my $sql_string2 = "create table table2(`id` int);"; $sth = $dbh->prepare($sql_string1); $re = $sth->execute; $sth = $dbh->prepare($sql_string2); $re = $sth->execute; }; if ($@) { $tag="Err:".$@."\n"; $sth = $dbh->rollback; }else{ $sth = $dbh->commit; } $sth->finish; $dbh->disconnect; ======================================================= 検索して、いろいろいじっても解決しませんでした。 どうかよろしくお願いします。
Perl LWPでのIPv6接続がエラーでつながらず、原因がわかりません。 記載しているソースで、Localhostに接続すると、LWP::UserAgentはエラーとなりますが HTTP::Tiny、wgetコマンドは、問題ありません。（IPv4の場合は、LWPも問題ありません）。 どなたか、よい解決へのお知恵をよろしくお願いします。 perl 5.16.1 CentOS 5.9 ------ソース----- #!/usr/bin/perl use strict; use Net::INET6Glue; my $uri = 'http://[::1]'; use LWP::UserAgent; my $ua = LWP::UserAgent->new; my $res = $ua->get($uri); print $res->content,"\n"; print "********************************\n"; use HTTP::Tiny; my $http = HTTP::Tiny->new; my $response = $http->get($uri); print $response->{content}, "\n"; -----結果----- Can't connect to ::1:80 (接続を拒否されました) LWP::Protocol::http::Socket: connect: 接続を拒否されました at /usr/local/perl-5.16.2/lib/site_perl/5.16.2/LWP/Protocol/http.pm line 51. ******************************** <html><body><h1>It works!</h1></body></html> ---環境--- This is perl 5, version 16, subversion 2 (v5.16.2) built for x86_64-linux cpan[1]> i /INET6/ Reading '/root/.cpan/Metadata' Database was generated on Fri, 01 Mar 2013 03:17:03 GMT Distribution SHLOMIF/IO-Socket-INET6-2.69.tar.gz Distribution SULLR/Net-INET6Glue-0.5.tar.gz Module = IO::Socket::INET6 (SHLOMIF/IO-Socket-INET6-2.69.tar.gz) Module = Net::INET6Glue (SULLR/Net-INET6Glue-0.5.tar.gz) Module = Net::INET6Glue::FTP (SULLR/Net-INET6Glue-0.5.tar.gz) Module = Net::INET6Glue::INET_is_INET6 (SULLR/Net-INET6Glue-0.5.tar.gz) Module < Net::Patricia::AF_INET6 (PHILIPP/Net-Patricia-1.19.tar.gz) Module < Net::Whois::Object::Inet6Num (AASSAD/Net-Whois-RIPE-2.002.tar.gz) 8 items found
perlを勉強中です 掲示板に挑戦してみました 引用の文字色を変えたいと思っています。下記のように>>をいれるとその行の文字色を改行まで変えたいです >>引用文 しかし、やってみると、他の置換えがあってうまくいきません。 どうすればうまくいくのでしょうか？ よろしくお願いします sub form_decode{ if ($ENV{'REQUEST_METHOD'} eq "POST") { read(STDIN, $form, $ENV{'CONTENT_LENGTH'}); } else { $form = $ENV{'QUERY_STRING'}; $NG = 1; } @pairs = split(/&/,$form); foreach $pair (@pairs) { ($name, $value) = split(/=/, $pair); $value =~ tr/+/ /; $value =~ s/%([0-9A-Fa-f][0-9A-Fa-f])/pack('H2', $1)/eg; $name =~ s/%([0-9A-Fa-f][0-9A-Fa-f])/pack('H2', $1)/eg; $value =~ s/>(&gt;[^<]*|>[^<]*)/&gt;&gt;<font color=\"red\">$1<\/font>/g; $value =~ s/>/&gt;/g; $value =~ s/</&lt;/g; $value =~ s/\r//g; $value =~ s/\n//g; &jcode'convert(*value,'sjis'); &jcode'convert(*name,'sjis'); $FORM{$name} = $value; } }
いつも大変お世話になっております。 エクセルブック(.xls)に週報データが保存されています。 １週が１sheetになっているため１ファイルに53sheet入っています。 10年分のため、10ファイルあります。 各sheetは同じフォーマットで入っています。 これらをPERLで一括して読み込みたいと思っています。 従来は、1sheetずつ　.csvに変換して、読み込んでいました。 しかし　これらだと530回　.csvに吐き出す処理が必要で、根気が続きません。 バッチ処理で一気に.csvに吐き出すか、あるいは.csvに吐き出さずに .xlsのまま、読み込みたいと思っています。 PERLは　active perl 5.14.2をWindows 7のコマンドプロンプト上から起動しています。 ご指導のほど宜しくお願い申し上げます。
只今、Perl言語を使ってクイズを作っています。 問題を表示して、<INPUT TYPE=radio・・・>と言うとても簡単なものですが、1問毎に正解を表示させて、20問終了後に正解率を表示させています。 1問毎にPerlプログラムで正誤をカウントして正解率を計算しているのですが、「戻る」をクリックされると正解を再度選択できますので正確な採点にはなりません。 私には、サーバー側に存在するPerlでのプログラムで正誤の計算をしたものを「戻る」で、その計算が無かったことに出来る、言い換えれば「時間を戻す」ことが出来ること自体がとても不思議でたまりません！！ 何故、そんなことが出来るのかも知りたいのですが、今回の質問は、Perl言語を使ったプログラムで「戻る」をクリックされたか否かを知る方法を教えて下さい。クイズの入口はｈｔｍｌで記述しているのですが、問題の表示、解答等はPerlで記述していますので、Perlプログラムの制御下の時のみ「戻る」を無効に出来ればその方法も教えて頂ければ大変助かります。 よろしく、お願い致します。
おそれいります。 abc.txtに保存されたデータを、xyz.cgiから特定ワードに合った最初の行だけを抽出したいのですが、 うまくいきません。 open(OUT, "< ./abc.txt"); while($data = <OUT>){ chomp($data); @ip = split(/,/,$data); if($ip[0] =~ /word/){ 処理 } とすると、マッチする行が全て表示され、 Whileを外すとデータの1行目だけを判定するみたいで、 wordという文字列が含まれるレコードが見つかったらそのマッチした最初のデータだけを表示したいのです。 よろしくお願いします。
以下のような簡単なプログラムを書いて実行させたところ、小数点表示の挙動がおかしくなりました。 ###プログラム ここから #!/usr/bin/perl use strict; use warnings; for(my $i=0.01;$i<=1;$i+=0.001) { print $i,"\n"; } ###ここまで ##結果 ここから . . . 0.685 0.686 0.687 0.688000000000001 0.689000000000001 0.690000000000001 ##ここまで 以上のように、0.001づつ増加する $i に途中から000000000001が加わってしまいます。この000000000001が足される現象をやめさせたいです。原因、解決策等おわかりであれば教えていただけないでしょうか。よろしくお願いします。
はじめまして、初めて質問させて頂きます、ぷりんと申します。 早速ですが、質問です。 私はPerlにてメールフォームの作成に勤しんでいるのですが、どうしても500エラーが出てしまいます。 サーバーはレンタルサーバーのロリポップを使用しております。 私が不思議に思うのは、メール自体は送信されますが、ページには500エラーと表示されてしまうことです。 以下は実際のコードです。（全文）（一部変更有（メール宛先部分）） #!/usr/bin/perl require "../mimew.pl"; require "../jcode.pl"; $sendmail = '/usr/lib/sendmail'; $to = "hogemoge\@gmail.com"; $from = "test\@test.tet"; $subject = "題"; $body = "メール本文"; # 本文をJISコードへ変換 &jcode'convert(*body,'jis'); # 標題をJISコードへ変換してMIME エンコード &jcode'convert(*subject,'jis'); $subject = mimeencode($subject); open(MAIL,"| $sendmail -t"); print MAIL "To: $to\n"; print MAIL "From: $from\n"; print MAIL "Subject: $subject\n"; print MAIL "\n"; print MAIL "$body\n"; close(MAIL); exit(0); と記述し、こちらのcgiファイルはパーミッション700（ロリポップさんが700で動くので）、アスキーコードでアップロード。 mimew.plとjcode.plどちらも一つ上のフォルダにあります。（パーミッションは644） 以上です。 当方初心者ですので、いろいろ試したのですが、どちらが悪いのか見当つきません・・。 簡単な検索をしましたが、Syntax　Errorは見つかりませんでした。 また、いろいろなサイトを参考にしたり、検索したりしましたが、問題解決には至りませんでした。 おそらく初歩的なミスだとは思います・・。 こちらの問題に関してお詳しい方、どうかお手を差し伸べていただけないでしょうか。 何卒、よろしくお願い申し上げます。
フォームに入力された文字が電話番号かどうかを判断したいと考えています。 ハイフンは使いません。 if ($$in{tel} =‾ /¥-/) { &error("電話番号はハイフン（ - ）なしの10桁または11桁でご記入ください"); } if ($$in{tel} =‾ /^＼d{10,}+$/) { &error("電話番号はハイフン（ - ）なしの市外局番からご記入ください"); } このようにしてみたのですが、うまく動きません。 どうすればいいんでしょうか... よければ教えてください。
文字列から、明細と金額にわけてそこから検索できるプログラムを作っています。 テスト用に下記サンプルを作ったのですが、検索明細（$moneyvalue）をコーヒーに した場合のみ、値が戻ってきませんでした。 そこで、中のsplit部分を表示するようにしたところ ★収入=-10000. ★電車=+1000. ★コ=. ★[ヒ=. ★[=+2000. ★雑誌=+240. ★=. ★その他=+500. 0 このように　コーヒーの部分だけ上手くsplitが動いていないことが分かりました。 しかしココから手詰まりでどのように直せばいいのか分かりません。 想定される結果 ★収入=-10000. ★電車=+1000. ★コーヒー=+2000. ★雑誌=+240. ★その他=+500. 2000 このようにするにはどうしたらいいのか、分かる方おりましたら教えて下さい。 なお、当方はperl初心者です（涙) ----以下サンプルコードです---- #! /usr/local/bin/perl use Encode qw(encode_utf8); use CGI; my $moneyvalue = "コーヒー"; my $moneyline = "収入-10000,電車+1000,コーヒー+2000,雑誌+240、その他+500"; print &chkmoneyValue($moneyline,$moneyvalue); exit; #==============================================================================　 subchkmoneyValue { my ($moneyline , $moneyvalue)=@_; my $lp=0; my $flg=0; my @data= split(/[、,]/, $moneyline); my $datavalue = 0; foreach my $wdata (@data) { $wdata =~ s/\+/\,\+/; $wdata =~ s/\-/\,\-/; my @data2 = split(/[,]/, $wdata); print "★$data2[0]=$data2[1].\n"; if($data2[0] eq $moneyvalue){ $datavalue=$data2[1]; last; } } return $datavalue; }
ここで一週間も止まっています、どなたか助けてください。 あるサーバーにたまっているメールを受信して Net::POP3; MIME::Parser; などを利用して本文を取り出したりしています。 件名などはきちんと解析できて日本語にできるのですが、どうしても本文だけはどうなっているのかわかりません。エンコード、デコードなどの説明が書いてあるサイトをたくさんみて２００回くらいいろんな方法やパターンを試してみて本文を復元しようと試みましたが　「$B$^$7$m?'%7%s%U%)%K!<$N%Q%s$K$c(B」の文字は何も変わることなく、さすがに気が狂いそうになりましたのでここで質問しようとおもいます。 emlで保存したファイルから本文を取り出すことはできますが、読める状態になりません。 どなたか教えていただけないでしょうか？ いったい、どうしたらメールの本文をきちんと読める状態にできるのしょう？ ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Subject: =?ISO-2022-JP?B?GyRCJF4kNyRtPyclNyVzJVUlKSVLITwbKEI=?= To: test@test.com Status: RO X-UIDL: 1358842469.4950.s323,S=1722 Content-Type: text/plain; charset=ISO-2022-JP Content-Transfer-Encoding: 7bit $B$^$7$m?'%7%s%U%)%K!<$N%Q%s$K$c(B
恐れ入ります。 Perlを使って、時間と時間の差を求めたいのですが、 なかなかうまくいきません。 一度、txtファイルに書き込み日時を保存したあと、 それをperlにて読み込み、現在時刻との差を出して投稿制限を掛けたいのですが、 どのようにしたらよろしいでしょうか。 現在書き込み日時はtxtファイルに保存し、cgiファイル上に、出力済みで、localtimeも出力済みです。 単純に引いて関数に代入しても、正しい時間を得られません。 よろしくお願いします。
お世話になります。 ホストからIPに変換する方法としてgethostbynameを使って変換したところ、違うIPが表示されてしまいます。 うまく取得出来るホストもありますが、一部のホストが何度やっても違うIPとなってしまいます。 正確に取得出来ない原因として、何かありますでしょうか？ よろしくお願いいたします。
sessionIDがページを更新するたびに変わってしまいます。 その結果、前回セッションに保存した値を読み込めません。 my $cgi = new CGI; CGI::Session->name("SESSION_ID"); my $session = new CGI::Session("driver:File", $cgi, {Directory=>'./session'}); print $session->header(-charset=>'UTF-8'); print $session->id(); print $session->param("name"); #表示されず。 というようにしてセッションIDを表示すると、毎回変化します。 どうしたらIDを変わらないように出来るでしょうか？ ちなみに、セッションに書き込むのは、 my $cgi = new CGI; CGI::Session->name("SESSION_ID"); my $session = new CGI::Session("driver:File", $cgi, {Directory=>'./session'}); $session->header(-charset=>'UTF-8'); $session->param("name", "abc"); $session->flush(); undef($session); こんな処理をしてます。
あるテキストファイルが以下の内容で記述されているとします。 a　　　file1 a　　　file1 a　　　file1 b　　　file1 b　　　file1 b　　　file1 c　　　file2 c　　　file2 d　　　file2 d　　　file2 e　　　file2 e　　　file2 f　　　file3 f　　　file3 f　　　file3 上記のように列が二つあるテキストファイルについて、 2列目のfile名が1列目のどの値とひもづいて いるかを処理するperlプログラムを作ることを考えます。 出来上がったperlによって上記テキストファイルを処理した結果は、 file1は　aとb file2は　cとdとe file3は　f とひもづいていることが分かる　ということにしたいです。 これをperlプログラムで書くとき、条件として 一行一行を読みとるとき if ( $_ =~ /(\S+)\s+(\S+)/ ){ を使っています。 そのため$1と$2に現在行の1列目,2列目が与えられた後、 ハッシュと配列を組み合わせて考えた場合どのようにすれば いいのでしょうか。 ご助言ご鞭撻宜しくお願い致します。
a.perlというのを実行したりしていると、a.pl~、#a.pl#みたいなのがいつの間にか作られているのですがこれは何でしょうか？
前回の投稿で完全に書き間違えた部分がありそのままではよくわからないものになってしまっていたのですが、投稿し直しなどができなかったので再度投稿させてもらいます。 プログラムは use Web::Scraper; use WWW::Mechanize::Firefox; use Parallel::ForkManager; use URI; binmode STDOUT,":utf8"; sub func ; ($sec, $min, $hour, $mday, $mon, $year, $wday, $yday, $isdst) = localtime(); $year += 1900 ; $mon += 1 ; $File = "yuma-$year:$mon:$mday:$hour.txt" ; open (file,"> $File") or die 'fail to open file\n'; print "HOW MUCH PAGE\n" ; my $page = <STDIN> ; print "WITEING...\n" ; my $MAX_PROCESSES = 5; my $pm = new Parallel::ForkManager($MAX_PROCESSES); for ($i = 1;$i <= $page;$i++) { $pm->start and next; my $uri = URI -> new ("www.目的とするＵＲＬ$i.html"); my $mech = WWW::Mechanize::Firefox->new(); $mech->get($uri) ; print file $s->scrape($mech->content) ; print file "\n" ; print file $r->scrape($mech->content) ; print file "\n" ; $pm->finish; } print "WITEID\n" ; my $s = scraper { process 'font',sen => 'TEXT'; result 'sen'; }; my $r = scraper { process 'div#content',ren => 'TEXT'; result 'ren'; }; close (file) ; です。 $i　の順序でファイルへ書き込みをしていきたいのですが、前の処理が終わっていなかった場合に待つ方法がわからないので初心者レベルで教えてください。
こんにちは。 ubuntu12.10上でParallel::ForkManagerを利用しようとしていますが、子プロセスのファイルへの書き込みの順序で困っています。 いくつかの実験の結果$iを子プロセスごとに1づつ増やして表示させても 1,2,4,5,3,6,8,9,7・・・となり子プロセスを作った順序で終了しません。 ｆｉｌｅへの書き込みを順序良く行わせる方法はありませんか？
cgiを直接呼び出して、メールを送信されてしまうエラーについて質問させてください。 以下のように、sendmailを利用するサブルーチンを呼び出しています。 if ($query->param('confirm')) {　#←初期値は""で一番下のelseに飛ぶ # input data check my @err_lst = ();　#←入力チェックしてエラーメッセージを蓄積 if (&InputCheck($query, \@err_lst)) {#←入力内容をチェック # ok &NextPage($query);　#←確認画面を表示 } else { # error &SamePage($query); #入力内容にエラーがある場合、入力画面に戻す } } elsif ($query->param('send') eq "送信") { # send mail & make log &SendMail($query);　#メール送信用サブルーチン } else { # make init form &InitPage($query); #CGI起動直後はこのサブルーチンから入力フォームを表示 } この書き方ですと、 <input type="hidden" name="confirm" value=""> <input type="hidden" name="send" value="送信"> で、直接「&SendMail($query);」が起動してメール送信されてしまいます。 メール本文やアドレスの文字エスケープ処理は動いているのですが、 sendmailを呼び出す前には、必ず入力内容をチェックするサブルーチンを通る事を 強制する方法はないでしょうか。 当方、この修正の為にこの2週間突貫でPERLを独学している素人の為、 上記事例について読んでおくべき参考書などがあれば、お教えいただけますと とてもとても助かります。 どうぞよろしくお願いいたします。
とあるソースを解析しているのですが、 Perlを初めてまだ日が浅いので 下記の計算式の最後の(1./60.)の意味がよくわかりません。 なぜ数字の後にドットが入っているのでしょうか？ どなたかご教示お願いいたします。 $d = ($t - $dly - $t0) - ($c - $c0)*(1./60.);
コマンドラインからだと作成されるpngファイルがブラウザからだと作成されません。 ブラウザにデバッグ用のprint文は、表示されます。 http://localhost/~.../sample.pl を実行しても、 ブラウザに　hello-helloが表示されるだけで、 file.pngが作成されません。 file.pngをブラウザから作成するには、どうしたら良いのでしょうか？ よろしくお願いいたします。 コマンドラインからだと、gnuplotで作成されたfile.pngが作成されます。 bash-3.2$ perl sample.pl Content-type:text/html hello-hello 使用したプログラムは、以下のとおりです。 < sample.pl > #! /usr/bin/perl print "Content-type:text/html\n\n"; #use strict; #use warnings; use CGI; use Chart::Gnuplot; my $chart = Chart::Gnuplot->new( output => "file.png" ); my $dataSet = Chart::Gnuplot::DataSet->new( datafile => "test.data" ); print "hello-hello\n"; $chart->plot2d($dataSet);
ロシア文字の排除をしたいと思い、 以下のように記述してみたのですが カタカナの「ヤツ」「ヤッ」に以下でマッチングしてしまいます。 文字コードはShift-jisを使用しているのですが 誤判定を回避する策はないでしょうか？ roshia_moji=qw(А Б В Г Д Е Ё Ж З И Й К Л М Н О П Р С Т У Ф Х Ц Ч Ш Щ Ъ Ы Ь Э Ю Я а б в г д е ё ж з и й к л м н о п р с т у ф х ц ч ш щ ъ ы ь э ю я); foreach (@roshia_moji) { if (index($a,$_) >= 0){ push(@error, 'ロシア文字は使用できません。');last; } }
フォームから入力された文字列をデータファイルの中から検索し、重複していなければ追加登録したい。 ・問題点 重複していても登録できてしまう。 昨日からperlを触り始めたばかりなので、基本的な部分が分かっておらず、 おかしい部分が多々あるかもしれませんが、ご指導よろしくお願い致します。 データは全て"["から始まるので、登録できませんの部分は、簡単な入力チェックです。 -------------------------------------------- test.html <html> <head> <meta http-equiv="Content-type" content="text/html; charset=UTF-8"> </head> <body> <form action="test2.cgi" method="post"> <input type="text" name="shirolist" size="50" /> <input type="submit" name="submit" value="送信" /> </form> </body> </html> -------------------------------------------- test2.cgi #!/usr/local/bin/perl use utf8; use CGI; $q = new CGI; $flag = 0; $data = $q -> param('shirolist'); $data =~ s/\s+//g; open(IN , "<:uft8" , "data.dat"); while($line=<IN>){ if ( $line eq $data ) { $flag = 1; } } close(IN); if($flag == 0){ if ($data =~ /^\[/) { open(OUT,">>data.dat"); print OUT "$data\n"; close(OUT); $pr="を登録しました"; } else { $pr="は登録できません"; } } else { $pr="は登録済みです"; } print "Content-Type: text/html; charset=UTF-8\n"; print "$data $pr<br>\n"; ※Yahoo知恵袋で同様の質問をしましたが、 回答者への個別のコメントや追加質問が出来ず、 非常に使いづらく感じたのでこちらに投稿させて頂きました。
@tangoa = ('A','B','C','D','E','F'); @tangob = ('K','L','M','N','O','P'); の２つの配列の各要素を結合させて AK AL AM AN AO AP BK BL BM BN BO BP CK CL CM CN CO CP DK DL DM DN DO DP EK EL EM EN EO EP FK FL FM FN FO FPという配列(@tangoc)を作りたいのですが、 ２つの配列の各要素を結合させるにはmapを用いてどのように書くべきか具体的に教えてください。
Perlを用いてテキスト中の文字列 /^\d+$|^\d+\.[05]{1}$/ を、以下の文字列に置換したい場合、 うまくやる方法はないでしょうか？ /^[0]+$|^[0]+\.[0]+$/ 正規表現を使いたいですが、 １つ１つエスケープしていくのはさすがに・・・ よろしくお願いいたします。
Jcodeについて教えてください。 Shift-jisで処理している文字列でJcodeを使用すると 半角カタカナ→全角カタカナ 半角小文字英字→半角大文字英字 への変換は文字コードをecuにしなくてもうまくいくのですが 全角英数字→半角英数字 に変換するとうまくいきません。 これはどうしてなのでしょうか？
PC上のデータに含まれる機種依存文字（(1)(2)IIIなど）をEBCDICコードを使用しているホスト機にファイル転送をする時、表示可能な文字に変換を掛けようと思っています。 Perlで変換を行うところまではなんとか辿り着きました。 ところが、(1)を1.に変換すると、PC上では文字数は変わりませんが、ホストにアップロードした時に、シフトコードが入るために、最悪前後に全角文字が入っている場合は、２バイトのプラスになり、ホスト上のデータベースにインポートする時にエラーを引き起こしてしまいます。 これを防ぐため、Perｌ上で、文字コード変換を行う時にシフトイン＆シフトアウトの発生した場合の文字列長のチェックを行いたいのですが、全角文字と半角文字の識別と長さのカウントを行う方法、なにか参考になるサイトがありましたら、教えて頂けると助かります。 よろしくお願いします。
<?xml aaa=111 bbb=222 ccc=333> <A>$var</A> <B>$var</B> <C>$var</C> | | | <Z>$var</Z> <END></END> 上記のようなテキストファイルをperlプログラムで 作成したいときについて。 上記記述をプログラム内であらかじめ雛形として記述しておき $varの変数の中身をかえることで違うテキストファイルが 出来上がることを達成するにはperlでどのような記述を すればいいのでしょうか。 自分が調べた範囲では、"ヒアドキュメント"を 使えばいいのかなと考えていますが、もっと良い方法や 文法があれば御教授願います。 宜しくお願い致します。
質問させていただきます。 by ***.***.hoge.jp を正規表現で表すならば、 by\s+(ここに何が入るからわからない).hoge.jp この（）の部分は何が入るのでしょうか？ 初めの”by”　と　最後の”hoge.jp”　は確定で入るのですが、途中の部分は何の文字が来てもいいように正規表現を組みたいです。 何の文字が来てもいい、というような表現方法はありますでしょうか？
質問させていただきます。 IPアドレスは普通、114.114.96.20という風に四つに分かれていますが、これを一つの数字にまとめる、ということはPerl言語でできるでしょうか？ 各数字ごとに進数変換して、ピリオドを取ってまとめる、という形を考えたのですが… 例えば２進数変換すれば 01110010011100100110000000010100 という感じになります。 これ以外に何か方法はありますでしょうか？
質問させていただきます。 メールヘッダに対して以下のプログラムを実行します。 ～略 $file_data_str = join("", @file_data); @received_datas = split(/Received:/, $file_data_str); @received_datas = reverse(@received_datas); foreach $sorted(@received_datas){ if(($sorted =~ /by\s\w+.abc.jp/) and ($sorted =~ /(\[\d+\.\d+\.\d+\.\d+\])/)){ $& =~ /(\d+\.\d+\.\d+\.\d+)/; $ipadd = $1; print $ipadd; print "\n"; } } } exit; すると、by\s\w+.abc.jpを含むReceived行のIPアドレスが全て抽出され、複数出力されます。（以下実行結果） 114.114.96.20 158.217.208.15 私はこの初めの"114.114.96.20"のみを出力したいのですが、どうしたらいいでしょうか？ 助言のほどをお願いいたします。
質問させていただきます。 メールヘッダに対して以下のプログラムを実行します。 ソースコード ～略 my $file_data_str = join("", @file_data); my @received_datas = split(/Received:/, $file_data_str); my @received_datas = reverse(@received_datas); foreach my $sorted(@received_datas){ if($sorted =~ /by\s\w+.abc.jp/){ $sorted =~ /(\[\d+\.\d+\.\d+\.\d+\])/; print $sorted; print "\n"; } } } exit; を実行すると以下のようにに実行結果が出てきます。 from 158.217.207.30 (114.114.96.20 [114.114.96.20]) by ************abc.jp from ****************.jp (***************.jp [158.217.208.15]) by ***********abc.jp 私は [114.114.96.20]だけを取りだしのですがどうしたらいいでしょうか？ foreach my $sorted(@received_datas){ if($sorted =~ /by\s\w.abc.jp/){ $sorted =~ /(\[\d+\.\d+\.\d+\.\d+\])/; ここをどうにかすればいけると思うのですが詰まってしまって… 申し訳ないですが助言をお願いします。
初歩的な質問で恐れ入ります。 Perlで、@array('りんご','キャベツ','バナナ','みかん'); の中身を、順次10回ずつ繰り返し実行したいのですが、どのようにしたら良いでしょうか りんごりんごりんごりんご・・・（10回）キャベツキャベツキャベツキャベツ・・・（10回）という感じで、 ひとつめのリストの処理が10回終了したら次のリストを10回という感じです。 よろしくお願いします。
CGI(perl)勉強中です。 2012年12月18日22時15分 のように文字列で記録されている時間があります。 (事情によりこの時刻は上記のような文字列型式でしか記録できません) この時間が、現在時刻と比較し、何日経過しているかを表示させたいと思っています。 time 関数を使えば現在時刻の取得が可能ということは分かりました。 この現在時刻から上記の日時をマイナスすれば経過秒数が分かり、 これを日数に計算しなおせばできると思うのですが、 2012年12月18日22時15分をtime関数で取得した現在時刻と同じ型式に 変換させる方法が分かりません。 また、他によい計算方法があればよろしくお願いします。
perlのsystem関数内で変数展開について困っています。変数展開はできるのですが、その変数の後に':'(コロン)をつける必要があるのですが、それがモディファイアとして認識されてしまうようです。コロンをそのままperlに評価させずにsystem(shell)に渡す方法はないでしょうか？ $host = "xxxx.com"; system("program ${host}:22"); ちなみに、$host:22ではうまく変数展開されないそうで、{}を使うまでは良かったのですが、その後のコロンでつまっています。programの都合でhost、コロン、ポート番号を渡す仕様のため変更できません。よろしくお願いします。
下記のような文字数の多いマッチング演算子について。 if($test =~ /^\s+\S+\s+(\S+)\s+(\S+)\s+\S+\s+(\S+)\s+(\S+)\s+\S+\s+\S+\s+\S+\s+\S+ \s+\S+\s+(\S+)\s+\S+\s+\S+/){ 上記は一行に続けて記述しています。 (見た目は2行に見えますが1行記述です。コンパイルすると正常に動作します) これを if($test =~ /^\s+\S+\s+(\S+)\s+(\S+)\s+\S+\s+(\S+) \s+(\S+)\s+\S+\s+\S+\s+\S+\s+\S+ \s+\S+\s+(\S+)\s+\S+\s+\S+/){ のように改行して、コンパイルしてみると うまく動きません。ドット演算子を使用して下記のように記述し直しても うまく動作しません。 if($test =~ /^\s+\S+\s+(\S+)\s+(\S+)\s+\S+\s+(\S+) .\s+(\S+)\s+\S+\s+\S+\s+\S+\s+\S+ .\s+\S+\s+(\S+)\s+\S+\s+\S+/){ 改行して記述するにはどうすればよいのでしょうか？
Hoge*なtfield型の *head構造体を生成してPerl側で参照し、 再度同じ関数に通して*headと同じ構造体*pを作りたい。 下記のソースを 実行すると二度目にDataListを通すと tfield *pはバラバラな構造体が生成される。 *headと同じ構造体が 生成されるにはどうしたら良いか。 ご教授お願いします。m(_ _)m ちなみに使用環境はWindow7です。 ----------------------------------------- MyTpe.xs側 struct tfield { struct tfield *left[30]; int num; char str[30]; struct tfield *right[30]; }; struct tfield *talloc(void) { return ((struct tfield *)malloc(sizeof(struct tfield ))); } MODULE = MyTypePACKAGE = MyType SV* DataList(data,num) SV* data int num PREINIT: struct tfield *p,*head[30]; INIT: int i,j; CODE: if(num!=0){ p=INT2PTR(struct tfield *,SvSTASH(SvRV(data))); f(SvTYPE(SvRV(data))==SVt_PVMG) printf("MG Success\n"); or(i=0;i<6;i++){ printf("\np->left[%d]=%p\n",i,p->left[i]); } } for(i=0;i<6;i++){ /*無意味な構造体*/ head[i]->left[0]=head[i]->right[0]=head[i]=talloc(); printf("head[0]->left[%d]=%p\n",i,&head[0]->left[i]); } ref=newRV_noinc(newHV()); sv_setref_pv(ref,"main::Tie",(void*)head); RETVAL=ref; OUTPUT: RETVAL ----------------------------------------- Perl側 #!usr/bin/perl use MyType; use Devel::Peek qw/Dump/; $value1=MyType::DataList(NULL,0); print Dump $value1; $DB::single=1; $value1=MyType::DataList($value1,1); ----------------------------------------- Devel::Peekの実行結果 SV = IV(0x1209078) at 0x120907c REFCNT = 1 FLAGS = (ROK) RV = 0x5bbbcc SV = PVMG(0x18cf78c) at 0x5bbbcc REFCNT = 1 FLAGS = (OBJECT,IOK,pIOK) IV = 1243644 NV = 0 PV = 0 STASH = 0x12089bc "main::Tie"
以下のように英数字を小文字から大文字に変換し、 その後、パターンマッチさせるように記述し、 $nameをテニスコートてみてもマッチしませんでした。 たぶん\Qテニスコート\Eの\Q～\Eが問題なのだとは思うのですが \Q～\Eがないとエラーとなってしまうため、外せません。 このような場合、どうしたらいいのでしょうか？ $name = uc $name; if($name =~ /\Qテニスコート\E|TENNIS/){ push(@error, 'テニス関係は入力できません'); }
初質問させていただきます。 まず環境は、Perlversion5.16.1でActivePerlを用いております。 GD::Graphモジュールを使って棒グラフ、点グラフを作りたいと思っています。 しかし、（数字は変えてあります） .... (1)my @labels = qw(0 5 10 15 20 25 30); #X軸の目盛り (2)my @dataest = qw(3 6 9 12 15 18 21 24); #グラフにするデータ (3)my @data = (\@labels,\@dataset); ..... と、入力して出力しても、ラベルはちゃんと(1)の目盛りが置かれるのですが、肝心なグラフ化したいデータの(2)が反映せず、何故か(1)の値が再度取られ、グラフが一定になってしまいます。 http://www.gadgety.net/shin/tips/unix/perl-gd.html 上記のURLの参考プログラムのままだったらちゃんと実行されるのですが、(2)のdatasetの値をいれかえると何故かこのような現象に… どなたかご教授願えませんでしょうか？他に必要な情報があれば補足・返信いたします。
はじめまして。 以下の動物をを指定した割合でランダムに表示しようと思いますが、どのような方法がありますでしょうか。 ゴリラ(割合4) パンダ(割合2) ラッコ(割合3) スズメ(割合1) ウサギ(割合2) rand関数を使って出来そうだったのでやってみたのですが、うまく割合で分ける事が出来ませんでした。 どなたか、何かアドバイスいただけないでしょうか。 よろしくお願いいたします。
こんにちは。 PHPとPerlのリダイレクトの処理ついて質問です。 PHPのリダイレクトには、exit;を付けないとその後の処理も行ってしまいます。 header("Location:index.php"); exit; Perlのリダイレクトにも、このexit;は必要でしょうか？ print "Location:index.cgi\n\n"; exit;　←　？ 以上です。 どうぞよろしくお願いします。
Perlにおいて複数行コメントを記述するには =for comment コメントを記述 =cut と書けるとのことですが =for commentと=cutの間に 以下のように1行のコメントが記述されていても問題ありませんか？ =for comment #名前をチェック if ($FORM{'name'} eq "") { $error .= "「名前」が入力されていません。$br"; } #タイトルをチェック if ($FORM{'title'} eq "") { $error .= "「タイトル」が入力されていません。$br"; } #コメントをチェック if ($FORM{'comment'} eq "") { $error .= "「コメント」が入力されていません。$br"; } =cut
Perl初心者です。 下記のようなXMLファイル(test.xml)を、CSVに変換したいと考えています。 <MODESMESSAGE> <DATETIME>20121129045500</DATETIME> <MODES>8515C4</MODES> <CALLSIGN>JAL1406</CALLSIGN> <ALTITUDE>03075</ALTITUDE> <GROUNDSPEED>177</GROUNDSPEED> <TRACK>330</TRACK> <VRATE>-832</VRATE> <AIRSPEED>000</AIRSPEED> <LATITUDE>35.4003</LATITUDE> <LONGITUDE>139.8822</LONGITUDE> <SQUAWK>3341</SQUAWK> </MODESMESSAGE> <MODESMESSAGE> <DATETIME>20121129045500</DATETIME> <MODES>86CF11</MODES> <ALTITUDE>20100</ALTITUDE> <VRATE>0</VRATE> <AIRSPEED>000</AIRSPEED> <LATITUDE>0</LATITUDE> <LONGITUDE>0</LONGITUDE> </MODESMESSAGE> データによって、要素が欠けている場合もありますが、最大で11個の要素が並んでいます。 これをCSVに変換するため、書籍を参考にしながら以下のスクリプトxml2csv.plを作りました。 使用している環境はLinuxです。 use encoding "utf8", STDOUT=>"Shift_JIS"; use XML::Parser; $parser = new XML::Parser( Handlers => {Start=>\&element_start, Char => \&cdata, End => \&element_end}); $element_name = ''; %records = {}; eval ( "\$parser->parsefile( \@ARGV[0] );"); if ($@) { chomp($@); $@ =~ s/^\n//; $@ =~ s/ at (?:[A-Z]:)?\/.*//; print @ARGV[0] . " :Error $@ \n"; } sub element_start { my ($expat, $name, %attributes) = @_; $element_name = $name; $records = {} if ( $name eq 'MODESMESSAGE' ); } sub element_end { my ($expat, $name) = @_; if ( $name eq 'MODESMESSAGE' ) { print $records{'DATETIME'} . "," . $records{'MODES'} . "," . $records{'CALLSIGN'} . "," . $records{'ALTITUDE'} . "," . $records{'GROUNDSPEED'} . "," . $records{'TRACK'} . "," . $records{'VRATE'} . "," . $records{'AIRSPEED'} . "," . $records{'LATITUDE'} . "," . $records{'LONGITUDE'} . "," . $records{'SQUAWK'} . "\n"; } $element_name = ''; } sub cdata { my ($expat, $context) = @_; $records{$element_name} = $context if ($element_name); } 実行すると、 > perl xml2csv.pl test.xml 20121129045500,8515C4,JAL1406,03075,177,330,-832,000,35.4003,139.8822,3341 test.xml :Error junk after document element at line 14, column 0, byte 345 > 上記の通り1つ目のデータについてはCSVに変換できているようなのですが、２つ目以降が変換されずエラーとなってしまいます。 お気づきの点がありましたら教えていただけないでしょうか。 よろしくお願いします。
KentWebさんのClipmail ver3.0を使用してwebformを作りたいと思っています。 http://www.kent-web.com/mail/clipmail.html ≪質問≫ 確認画面を出さずにフォーム 内容を送信することは可能でしょうか？デフォルトでは確認画面が必ず出ます。 ≪理由≫ form各項目の送信value値を数字にしてcsvファイルで出力したいのですが、質問項目数が増えると確認画面で数字で埋め尽くされてしまうのでこれを防ぎたいのです（数字を見せたくない）。 例： 質問1(name=Q1) = 満足(value=3) ⇒ Q1 = 3 http://q.hatena.ne.jp/1328250297 上記のリンクに似た質問があったので試してみましたが上記clipmailよりもversionが新しいためか、 上記リンクのcgi部分と送信ボタンのnameを変えて、送信ボタンを押すと「不正なアクセス」とエラーが表示されます。 フォーム記入後の送信ボタン(1)（<form action="clipmail.cgi method="post"">）と確認ページで表示される送信ボタン(2)(<form action="!mail_cgi!" method="post">)に違いがあるので送信ボタン(1)で(2)のアクションを呼び込めば良いのだと思いますが、どこを触ればいいのかが思考錯誤してもまだわかりません。 確認画面は入力ミス等を防ぐ重要なステップと認識していますが、form記入値を確認画面なしでダイレクトに送れないものか（もしくは確認画面で表示されるvalue値とcsv出力されるvalue値を変えることはできないのかどうか）と思い質問させていただいております。 私のcgi等に対する知識はど素人レベルです（webpageの知識としてはhtml/cssだけが少しわかる程度です。）どなたかわかる方がいらしたら、どこを変更すれば良いのかを教えて頂けると助かります。よろしくお願い致します。 Ｐ．Ｓ． Kentwebさんのサポートページで質問をしようとしたのですが問題のあるページのアドレスhttp://を入力しないと質問できませんでした。動作や不具合に関する質問ではなかったのでこちらで質問させてもらっています。
perlにてテキスト書き出しをしをしたとき 書き出したテキストファイルの先頭にどうしてもスペースが入ってしまうので そのテキストを別のcgiにて読み込み表示するときに 先頭のスペースを削除しようとしていますがうまく行きません 多分スペースをパターンマッチさせるのだろうと思うのですが いまいち私の理解が足らないようでぜひどなたか教えてください。 （1つ目のcgi）------------------------------- フォームから入力$title $subtitle $contentsとしそれを下記のような形で読み込み（途中省略） use CGI; $query = new CGI; $title = $query->param('title'); $subtitle = $query->param('subtitle'); $content = $query->param('content'); #タブ区切りにし@memoryに代入 @memory="$meday\t$title\t$subtitle\t$content\t$number\t$namberc\n"; open(FILE,">>../data/memory.txt")||&error("$datafile 外部ファイルが開きませんでしたエラー"); print FILE"@memory"; close(FILE); ----------------------------- それを違うcgiのソースで読み込み------------------------------------ （2つ目のcgi) open(IN, "< sys/data/memory.txt"); eval{flock(IN,1)}; @inbun=<IN>; for($i=0;$i<@inbun;$i++){ @retudata=split(/\t/,$inbun[$i]); $inbun[$i] =~ s/^\s+//g; $retu =~ s/^\s+//g; @retudata[$i]='$retu[0]\t$retu[1]\t$retu[2]\t$retu[3]\t$retu[4]\t$retu[5]\n'; ; }@data=@inbun; open(FILE,">sys/data/memory.txt")||&error("../data/memory.txt 外部ファイルが開きませんでしたエラー"); print FILE"@data"; close(FILE); close (IN); --------------------------------------------------- 追加するとなぜか先頭にスペースが入りどうしてもとれないんですが どうしたら良いでしょうか？ ちなみに結果は下記のとおりです。 20121122test1test1test1あいうえおABCDEFG1112223157 20121122test2-rtest2-rtest2-rあいうえおABCDEFG21122231647 20121122test3test3test3あいうえおABCDEFG3112223254 乱筆乱文ご容赦ください。 宜しくお願いします。
人の作ったものですが、月曜午前０時で処理を切り替えるようになっています。 これを水曜午前０時に変更するにはどうすればいいでしょうか？ 長いですがよろしくお願いします。 sub GetNextWDayTime { my $time = time; my ($sec, $min, $hour, $wday) = (localtime($time))[0,1,2,6]; my $now = ($wday * 60 * 60 * 24) + ($hour * 60 * 60) + ($min * 60) + $sec; my $next = ($_[0] * 60 * 60 * 24) + ($_[1] * 60 * 60) + ($_[2] * 60) + $_[3]; #if $next is small, $next is next week. if($next < $now){ $time = $time + (60 * 60 * 24 * 7); } $time = $time + (($_[0] - $wday) * 60 * 60 * 24); $time = $time + ($_[3] - $sec); $time = $time + (($_[2] - $min) * 60); $time = $time + (($_[1] - $hour) * 60 * 60); return $time; } sub GetLastWDayTime { my $time = time; my ($sec, $min, $hour, $wday) = (localtime($time))[0,1,2,6]; my $now = ($wday * 60 * 60 * 24) + ($hour * 60 * 60) + ($min * 60) + $sec; my $last = ($_[0] * 60 * 60 * 24) + ($_[1] * 60 * 60) + ($_[2] * 60) + $_[3]; #if $last is large, $last is next week. if($last > $now){ $time = $time - (60 * 60 * 24 * 7); } $time = $time + (($_[0] - $wday) * 60 * 60 * 24); $time = $time + ($_[3] - $sec); $time = $time + (($_[2] - $min) * 60); $time = $time + (($_[1] - $hour) * 60 * 60); return $time; }
インターネットでpingサーバーに更新pingを送信する方法を調べておりましたところ、 以下のような方法が見つかりましたので、試してみました。 すると、たまに動作するのですが、たいていの場合は以下のエラーになります。 The script did not produce proper HTTP headers. 使用しておりますサーバーはコアサーバーです。 #!/usr/bin/perl use XMLRPC::Lite; my $name = "サイト名"; my $url = "http://www.hogehoge.net/"; #PING送信先######################################## my @ps = ( 'http://pinghoge.jp/ping/', 'http://pinghogehoge.jp/ping/', ); ################################################### foreach (@ps) { my $result = eval { XMLRPC::Lite ->proxy($_) ->call('weblogUpdates.ping', $name, $url) ->result; } } エラーの解決方法など、おわかりになる方がおられましたら、ご教示を頂けますと幸いです。 どうぞ宜しくお願い申し上げます。
タブ区切りのテキストファイルの中から、タブで区切られた3列目～5列目だけを抜き出す、というような作業を実施したいのですが、どのように書けばよいでしょうか? いろいろグーグルで検索してみましたが、解にたどり着けず、ご存知の方がいらっしゃればご教授いただければ幸いです。 よろしくお願いします。
WindowsでActivePerlを使っています。一部の処理を高速化するためにInline Cを導入したのですが、出来れば、このCの部分でOpenMPが使えればベストです。単純にプロンプトから > perl ***.pl /openmp としても動かないようですし、Inline CにおいてOpenMPによる並列化は実装可能なのでしょうか。
現在、Webサイトを作成しており、もうそろそろで完成します。 しかし、問い合わせフォームの作り方がわかりません。 PerlによるCGIを使った方法があることは知っているのですが、具体的にどのような手順で始めたら良いのかわかりません。 どこからがHTMLで、どこからがCGIなのか、サーバー側で何をしたらいいのか、わかりません。 例えば、都道府県や生年月日をプルダウンで選択する項目などがありますが、プルダウンのリストに入っている都道府県や数字はHTMLだけで表示できるのでしょうか？CGIやサーバー側で、何かする必要があるのでしょうか？ 何かアドバイスを頂ければ幸いで御座います。 宜しくお願い致します。
Perlで繰り返し計算をする部分を高速化しようとInline Cを使ってC言語のサブルーチンを作りました。 C言語単体なら、巨大な配列はポインタを使って引き渡すのですが。 Inline Cを使って、PerlからCへの巨大配列の引渡し方法が分かりません（＞＜； 以下のように、リファレンスで渡してポインタで受け取る事もできないし。。。助けてください use Inline C; my@data; for(my $t=0;$t<=10000000;$t++){ $data[$t]=$t; } # C言語による処理 my $x = my_function_1(\@data); print"0から10の合計は$x\n"; __END__ __C__ // サブルーチン_1 long my_function_1(long *data){ long t; long t1=0; for(t=0;t<=10000000;t++){ t1=t1+data[t]; } return t1; }
たびたびお世話になっております。 PERL 5.14.2 (Windows 7)を　コマンドプロンプト上から動かしています。 use strict; use warnings; @multi_dimension_arrays; # $multi_dimension_array[$x][$y][$z] というような配列の中身を最初に０初期化したいのですが $x, $y, $zがどれだけ増えるかわかりません。 （0初期化していないので、大小比較などでエラーとなることがあります） 0初期化の方法をお教えください。
たびたびお世話になっております。 PERL version 5.14.2 をWindows 7 のコマンドプロンプトから起動して使っています。 use strict; と一行目に書くと　宣言されていない変数があれば拒絶されるとのことで #!/usr/bin/perl use strict; use warnings; $a = 10; print "$a\n"; というスクリプトを書きました。が、すんなり動いてしまいます。 use strict; は　どうすればうまく効くのでしょうか。 ご指導お願いします。
カレントディレクトリにディレクトリaaa, bbb, cccが在り、さらにそれぞれのディレクトリに11_2とか9_20などのような1から20までの数字を_で2個つなげたディレクトリが在ります。そのディレクトリの中のファイル名を出力する以下のスクリプトgetname.plを作成したのですが、 Unrecognized escape \d passed through at ./getname.pl line 9. Unrecognized escape \d passed through at ./getname.pl line 9. というエラーが出ます。全く原因がわからないでいます。もしよろしければ解決法をご教示いただけないでしょうか。どうぞよろしくお願いします。 #!/usr/bin/perl use strict; use warnings; my @directory=qw/aaa bbb ccc/; foreach my $dname (@directory) { opendir(DIR,"./$dname/\d+_\d+"); my @dir=readdir(DIR); close(DIR); print join("\n",@dir); } print "\n";
"a.csv"と"b.csv"を比較して、一致しない場合は"a.csv"を"b.csv"に置き換えたいと思っています。 しかし、"a.csv"と"b.csv"の先頭9行は必ず一致しないデータが入っているので、 1行目～9行目まではチェックせずに、以降の行からチェックするようにしたいです。 このようにプログラムするにはどのようにしたらいいのでしょうか。 お手数をおかけしますが、ご教授いただけると幸いです。 また、見本のソース等をいただけると嬉しいです。
perlでパターンマッチを使ったifの条件が必ずTRUEになってしまいます。 以下は条件です。二つのファイルがあって、片方のファイルのある列の文字列と別のファイルのある列の文字列が一致したら一致した行の1列目を出力するというプログラムです。 perl v5.12.3 『oct_gene.csv』は以下のような2列のファイルで、2列目であるalphabetの群は空白で区切られています。文字コードはASCIIです。 1zinc finger protein of the cerebellum 3 0stathmin-like 2 . . . . 『RNA.csv』は以下のような3列のファイルで、3列目のalphabet群は同じく空白で区切られています。文字コードはUTF-8です。 1NM_324891 sin3 associated polypeptide 2 NM_53344 Nanog homeobox . . . open (WRITE, ">RNAseq_Oct.csv"); open(FILE, "RNA.csv"); while($line = <FILE>){ chomp $line; @fact = split /\t/, $line; open(OCT, "oct_gene.csv"); while($octline = <OCT>){ chomp $octline; @oct = split /\t/, $octline; if($fact[2] =~ /$oct[1]/){ print WRITE $fact[2] . "\t" . $oct[1] ."\n"; last; } } close (OCT); } close (FILE); close (WRITE); この中のif文がうまく働かず、whileで繰り返すまでもなく必ず if($fact[2] =~ /$oct[1]/)　が成り立ってしまいます。 どなたか詳しい方、どうかご教示願います。 それではよろしくお願いします。
【データ】 (A) A　A2　"one"　7 A　3C　three　9 B　DD　"two"　11 C CDE　four　25 C　4D　five　33 D　YY　six　27 ・ ・ (B) A　okinawa kagoshima miyazaki B　kumamoto oita D fukuoka E　saga nagasaki ・ (A)と(B)のデータを比較し、先頭の単語が一致した時のみ、先頭の単語を除いた(B)の行を (A)の末尾に加えるという処理をしたいです。 【目標】 A　A2　"one"　7　okinawa kagoshima miyazaki A　3C　three　9　okinawa kagoshima miyazaki B　DD　"two"　11　kumamoto oita C CDE　four　25 C　4D　five　33 D　YY　six　27　fukuoka ・ ・ 以前、回答して頂いた方法を踏まえ、以下の処理を行いましたが上記のような結果がでません。 宜しくお願いします。 #!/usr/bin/perl open(FILE1, "<aaa.txt") || die "File1 Open Error! \n"; open(FILE2, "<bbb.txt") || die "File2 Open Error! \n"; open(OUT, ">zzz.txt") || die "OUT Open Error! \n"; my @data1 = <FILE1>; my @data2 = <FILE2>; chomp @data1; chomp @data2; foreach my $line1 (@data1) { my @array1 = split(/\t/, $line1); push @{$hash1{$array1[0]}}, @array1[1, -1]; for my $key1 (sort keys %hash1){ foreach my $line2 (@data2) { my @array2 = split(/\t/, $line2); push @{$hash2{$array2[0]}}, @array2[1, -1]; for my $key2 (sort keys %hash2){ if($key1 eq $key2){ print OUT join("\t", ($key2, @{$hash2{$key2}}, @{$hash1{$key1}})), "\n"; } } } } }
perlのハッシュでキーから値を得ることは出来ますが、その逆に値からキーを得るような関数ってありますか？探してもみつかりませんでした。識者の方々教えてください。
以下の環境にてURLエンコード（shiftjis)された文字を、UTF8として ブラウザに表示させたいのですが、上手く表示されません。 環境： サーバ：linux apache レンタルサーバ ※Encode.pm、Jcode.pm無し。追加モジュールインストール不可。 Perl version: 5.006001 ソースエンコード：utf-8 実行ソース： ------------------------------------ use utf8; require 'jacode.pl'; #　$mojiに予めURLエンコードされた文字が格納されています。 #　例として「マウス」デコード前（%83%7D%83E%83X）とします。 #URLデコード $moji =~ s/%(..)/pack("c",hex($1))/ge;　 #デコードされたsjis文字をUTF8へコンバート jcode::convert(\$moji, "utf8","sjis"); print ($moji); ----------------------------------- 例のように「マウス」と言う文字が$mojiに格納されている場合、 以下のような文字化けとなってしまいます。 ï¾ãç¿ï½¾ï¾ã¹ 正常にマウスと表示させるにはどうすればよろしいのでしょうか。 アドバイスを宜しくお願いします。
現在、Perlにて外部のcsvファイルを読み込み、"重複行"と"空白行"を削除するプログラムを作成しています。 重複行を削除する部分は ------ open(IN, "csvtime.csv"); @data = <IN>; close(IN); @data = grep {!$count{$_}++} @data; open(OUT, "> csvtime.csv"); print(OUT @data); close(OUT); ------ でできたのですが、空白行を削除する部分がわかりません。 申し訳ないのですが、お教えいただけないでしょうか。 また、空白行で最初の空白行は残すようにしたいです。 よろしくお願いいたします。 例） 読み出しデータ ----- (ヘッダ1行目) (ヘッダ2行目) (ヘッダ3行目) (必要な空白) (ヘッダ4行目) 00:00:00,302 00:01:00,274 00:02:00,272 00:03:00,248 00:04:00,237 00:05:00,239 00:05:00,239 00:06:00,256 00:07:00,260 00:08:00,250 00:09:00,253 00:10:00,241 ----- 加工後データ ----- (ヘッダ1行目) (ヘッダ2行目) (ヘッダ3行目) (必要な空白) (ヘッダ4行目) 00:00:00,302 00:01:00,274 00:02:00,272 00:03:00,248 00:04:00,237 00:05:00,239 00:06:00,256 00:07:00,260 00:08:00,250 00:09:00,253 00:10:00,241 -----
同じ行で重複した単語を削除したいです。 テキストファイル sapporo　aomori　akita　iwate　akita　yamagata sendai　miyagi　hukushima　miyagi akita mito ・ ・ 上記のようなファイルの同じ行で重複した単語を削除し下の形にしたいです。 sapporo　aomori　akita　iwate　yamagata sendai　miyagi　hukushima　akita mito ・ ・ open(FILE1, "<xxx.txt") || die "File1 Open Error! \n"; open(OUT, ">zzz.txt") || die "OUT Open Error! \n"; $string1 = <FILE1>; my @array = split(/\t/,"$string1"); my %count; @array = grep {!$count{$_}++}@array; foreach my $element (@array) { print OUT "$element\t"; } close(FILE1); close(OUT); このプログラムを実行すれば初めの一行は重複した単語を削除できるのですがそこで終了してしまいます。2行目、3行目・・といったように複数行に対して重複した単語を削除するためにはどのようにすればいいのですか。宜しくお願いします。
繰り返し処理の使い方について質問です。以下の.plファイルを作成しました。 for($line =0;$_ =<stdin>;$line++){ if($line < 400){ @line = split/,/,; $data1 +=$line[1]; } } for($line =0;$_ =<stdin>;$line++){ if($line < 800){ @line = split/,/,; $data2 +=$line[1]; } } $data_1 = $data1; $data_2= $data2; print"$data_1 \n"; print"$data_2 \n"; この.plファイルで合計計算の実行を試みたのですが、data_2の値が0でした。(data_1は合計計算が出来ています。) 繰り返し処理の2つ目はなぜ0なのでしょうか、またdata_2の合計計算を実行するにはどうすれば良いのでしょうか。 お願いします。
$a1がマイナスの数値であるとして、これをプラスに変えたいのですが、下の式では間違いでしょうか？ 　正しい書き方を、教えていただきたいです。 　よろしくおねがいします。 $a1=int($a1 * 10) / 10;
正規表現の質問となります。 現在 perl にて開発中です。 やりたいこととしては、任意の文字列の中から "-" "0-9"以外を削除したいです。 例） my $str = "iPhone4s\x{306f}\x{753b}\x{8cea}\x{306f}\x{3010}\x{3010}\x{3044}\x{3044}\x{3011}1.00\x{3011}\x{3051}\x{3069}\x{3001}\x{5f62}\x{304c}\x{3010}\x{3010}\x{53ef}\x{611b}\x{304f}\x{3011}-1.50\x{3011}\x{306a}\x{3044}\x{ff01}iphone3Gs\x{306f}\x{4e38}\x{3044}\x{5f62}\x{304c}\x{3010}\x{3010}\x{7d20}\x{6575}\x{3067}\x{3057}\x{3087}\x{3011}3.00\x{3011}\x{3002}\x{3042}\x{ff5e}\x{3042}\x{3001}\x{3042}\x{3068}\x{306f}\x{96fb}\x{6ce2}\x{304c}\x{6539}\x{5584}\x{3055}\x{308c}\x{305f}\x{3089}\x{3010}\x{3010}\x{3044}\x{3044}\x{3011}0.00\x{3011}\x{306e}\x{306b}\x{306a}\x{3041}"; # $strの値はランダムとします $str =~ s/\D//g; print "$str\n"; 出力結果 -> 41001503300000 成功すれば -> 4100-1503300000 どなた様か教えて頂ければと思いますmm
perlで.txtファイルを読み込むのはどうすればいいのでしょうか？ コマンドライン引数ではなくC言語でいうscanfのようにプログラム実行した後にtxtファイルを指定して読み込ませたいです。 わかる人がいたら教えてください、お願いしますm(_ _;m)
perlでデータを並び替えて整理したいです。 【元データ】 A　a　b A　c　d A　e　f A　g h B　i　j B　k　l B　m　n C　o　p C　q　r C　s　t C　u　v ・ ・ ・ 上記のデータを下記のように並び替えしたいのですが上手くできずに困っています。 どのような記述をすれば良いのでしょうか。間の空白はタブ区切りです。 【目標】 A　a　b　c　d　e　f　g　h B　i　j　k　l　m　n C　o　p　q　r　s　t　u　v D ・ 現在、元データから A B C D ・ ・ というデータを作り、元データと比較していますが上手くいきません。 for($i=0; $i<@key; $i++){ print OUT "$key[$i]"; for($j=0; $j<@data; $j++){ if($key[$i] =~ /$data[$j]/){ 　　　#部分一致 print OUT "$'"; } } print OUT "\n"; } 部分一致の行を正規表現を用いて上手く処理したいのですがやり方がわからず躓いています。 宜しくお願いします。
Windows7でCygwinコマンドを使用しています。 コマンドに次の2通りを入力しました。 1. $ head -2 data.csv 1000,-60 2000,-30 　　　・ 　　　・ 2. $ perl test.pl <data.csv 1000,-60 2000,-30 　　　・ 　　　・ test.plは次のように書きました。 for($line =0;$_ =<stdin>;$line++){ if($line < 5){ print"$_\n"; } } １つ目、2つ目ともにdata.csvのデータをコマンド上に出力していますが、どうして行間があったりなかったりしているのですか。 また、行間設定とかできるのですか。
フリーのＣＧＩプログラムを探しています。 利用者に最初にメールアドレスを入力してもらい、 そのメールに記載されたＵＲＬをクリックするとメールフォームのページが開くというＣＧＩです。 これならメールアドレスの間違いが防止できると思いますので、どなたかご存じでしたら教えてください。 よろしくお願い致します。
外部ファイル(ここではCSVファイル)内の列ごとの数値を合計し、結果をコマンドに表示したいです。 数値を合計するためsum関数を用いることは分かったのですが、各列ごとの出力・数値の合計はどのようにすればいいのですか。 合計計算のイメージはこんな感じです。 CSVファイル内 1 , 25 2 , 50 3 , 75 　・ 　・ 　・ プログラムで外部ファイルを読み込み、各列ごとの和を計算し、 Σx=1+2+3+・・・ Σy=25+50+75+・・・ コマンド(Cygwinを使用しています)上で、 x = (数値) , y = (数値) と表示することです。
こんにちは。Perlについて教えていただきたいことがあります。 こう書くと$temp_pathに値が入ります。 ----------------------------------- my $e = CGI->new(); my $q = CGI->new(); my $fh = $e->upload('file'); my $temp_path = $e->tmpFileName($fh); ----------------------------------- こう書くと$temp_pathに値が入りません。 ----------------------------------- my $q = CGI->new(); my $e = CGI->new(); my $fh = $e->upload('file'); my $temp_path = $e->tmpFileName($fh); ----------------------------------- tmpFileNameは最初に作成されたオブジェクトでないとならないような 仕様があるのでしょうか？ それとも、他に原因があるのでしょうか？ どうかよろしくお願いします。
PerlでCSVファイルの処理をしようとしています。 CSVファイル（ここではdata1.csvとします）の中身は、A列とB列に数値が1000行程表記されています。 -5,1 -4,2 -3,3 　・ 　・ 　・ 作成したPerlのファイル（ここではtest1.plとします）下のようにし、 while ($_=<stdin>){ print"$_\n"; } Cygwinコマンド上で、 $ perl test1.pl <data1.csv と入力すると、CSVファイル(data1.csv)の数値がCygwinコマンド上に全て表記されます。 前置きが長かったのですが、CSVファイル(data1.csv)の3行目までの数値だけをCygwinコマンド上に表記したい場合、どのようにプログラムすればよいのですか。 お願いします。
フリーのＣＧＩをパーミッションを変える程度で設置できる程度のPerl超初心者です。 下のプログラムは、フォームを使って利用者のメールアドレスに送信してメールアドレスの確認のためのに書かれた部分らしいと思いますが、 通常のパソコンでは、届いたメールは文字化けしていません。 しかしながら、私が持っているauのiPhoneでは着信したメールが見事に文字化けしています。 ここより上も下も関係ない感じがするので、この辺りを切り取ってみました。 auのiPhoneで文字化けしないようにするにはどうすればいいのでしょうか？ それともこの辺りの記述じゃないのでしょうか？ お手数をお掛けしますが、教えてください。 お助けください。 よろしくお願い致します。 if ( $mail =~ /^[a-zA-Z0-9_\.\-]+?@[A-Za-z0-9_\.\-]+$/ && $mail !~ /[\[\]\,\;\:\\\s\r\n\t]/) { $print .= "<CENTER><BR><BR>$mail宛てにメールを送信致しました。<BR><BR>しばらくたってもメールが届かない場合はメールアドレスが間違っている可能\性があります。<BR><BR>メールが届かない場合は再度お願い致します。<BR><BR>\n"; open(OUT,"| $sendmail -t"); &jcode'convert(*mailcheckkenmei,'jis'); print OUT<<"EOM"; To: $mail From: $mastermail Subject: $mailcheckkenmei EOM print OUT "お客様のメールアドレスを確認しました。\n下記URLにアクセスしてください。\nこのメールに心あたりがない場合はお手数ですが返信してお知らせください。\n\n\n"; print OUT "$basedir/formmail.cgi?query=$encmail"; close(OUT); &print($print); exit; }else{ if ($mail){ $print .= "<p><Font color=\"red\">メールアドレスを確認してください</FONT></p>\n"; } }
以下のCGIでは$MAILTO に送信されますが、追加的に、申込者に自動返信（文章つき）をするにはどのように修正するのですか。 #! c:/perl/bin/perl require "jcode.pl"; require "mimew.pl"; $SENDMAIL = 'c:\sendmail\sendmail'; # sendmailのパス $MAILTO = 'のがわ <nogawa@example.net>'; # メールの宛先 # フォームデータの取得 if($ENV{'REQUEST_METHOD'} eq 'POST') { read(STDIN, $query, $ENV{'CONTENT_LENGTH'}); } else { $query = $ENV{'QUERY_STRING'}; } # フォームデータの復元 foreach $pair (split(/&/, $query)) { ($key, $value) = split(/=/, $pair); # 文字のデコード $value =~ tr/+/ /; $value =~ s/%([0-9a-fA-F][0-9a-fA-F])/chr(hex($1))/eg; $FORM{$key} = $value; } # MIMEエンコード $mail_to = mimeencode($MAILTO); $mail_from = mimeencode($FORM{'name'}); $mail_subject = mimeencode($FORM{'subject'}); # 文字コードの変換 $body = jcode::jis($FORM{'msg'}); # メールヘッダーの生成 $header = <<END; To: $mail_to From: $mail_from<$FORM{'email'}> Subject: $mail_subject Mime-Version: 1.0 Content-Type: text/plain; charset=ISO-2022-JP END # メールの送信 open(MAIL, "| $SENDMAIL -i -t -f $FORM{'email'}") or die("エラー：sendmailへのパイプが開けません"); print MAIL $header, $body; close MAIL; # サーバー出力 print <<END; Content-type: text/html; charset=Shift_JIS <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"> <html> <head><title>めーるふぉーむ</title></head> <body> <p>メールを送信しました。</p> </body> </html> END
SJIS、EUC、UTF8、のどれがくるかわかりませんが、 かつ、その中で、どの言語がくるかわかりませんが、 その中で、日本語だけを、可能な限り容易に判別する方法は ありますでしょうか？ また、既存のモジュールを可能な限り使用しない方法でもあります。 ＃pureperlで書かれていれば、移植はできますが ひらがな、カタカナを抽出すればいいのもありますが、 仮対処にしかならず、漢字だけの場合の抽出が できなくなってしまいます。 以下、参考までに・・ 内部コードがSJIS？ ＃内部コードも、SJIS、EUC、UTF8のどれになるかわかりません。 UTF8の日本語がきたら、SJISになる UTF8の中国語がきたら、化ける（捨てる対象 EUCの日本語が来たら、SJISになる EUCの韓国語がきたら、化ける（捨てる対象） SJISの日本語が来たら、そのまま ・・のような感じになってしまいますので。。 よろしくお願いします。
'2012/04/03-20:14:00' => 'WIND' => '5.7' '2012/04/03-20:14:01' => 'WIND' => '5.9' … という風に時間と風速が書かれたテキストデータがあるのですが、この風速が'20'以上の場合の行のみを抽出して表示したいのですが、どのようなプログラムを書けばよろしいでしょうか。
現在アンケート収集のため、アンケートフォームの作成を行っています。 試行錯誤しているのですがどうしてもinternal server errorとなってしまうためご質問させてください。 下記がhtml、plの記述です。 ---------------------------------------------------------------------------------------- [HTML] <form action="check.pl" method="post"> <table> <tr> <td>■実施日</td> </tr> <td><input type="text" name="date" value="" /></td> </tr> <tr> <td><input type="submit" value="送信確認" /></td> </tr> </table> </form> ---------------------------------------------------------------------------------------- [Perl] #!/usr/bin/perl/ use CGI; $cgi = new CGI(); $date = $cgi->param('date'); $cgi->charset('Shift-JIS'); $date = $cgi->escapeHTML('$date'); use Date::Simple; if($date eq Date::Simple::data($date)) { $date_check ='ok'; } else { $date_check = ''error; } print $cgi->header(-type=>'text/html',-charset=>'Shift-JIS'); print $cgi->start_html(-title=>'送信確認',-lang=>'ja'); print '実施日'; print $date; if($date_check eq 'error') { print '(入力形式を確認してください。)'; } print '<br />'; print $cgi->end_html(); ---------------------------------------------------------------------------------------- Date:Simpleなどのエラーチェック機能を削除するとperlのエラーは検出されなかったのですが、動作しません。 パーミッションは755です。 念のため拡張子を.cgiに変更して試しましたが変化はありませんでした。 (※テスト用のcgiは動作しました。) 原因がお分かりの方がいらっしゃいましたら、ご回答お願い致します。
単方向じゃなくて双方向でなおかつ切り替え可能なリファレンスがほしいです。 AAA = bbb とするとき、 AAAからbbbを返し、bbbからAAAを返す物がほしい。 さらに、AAA = ccc と書き換えた場合、 bbbとの関係は解除される。 具体的には、座標 x y に物体 a とb があるとき、 xyからaとbが得られます。 a b 自体はそれぞれリファレンスであり、物体の詳細データが書き込まれてます。 同様、xyもリファレンスであり、位置についての情報が書き込まれています。 ここまでは単純な相互参照で解決できるのですが、 困ったことに物体は移動をおこないます。車が走って隣町に行くように。 その時、座標から物体にアクセスする場合と、 物体から座標にアクセスする場合がおかしくならないように一発で解決する手段を教えてください。 なお、現在は全く無関係な単方向なリファレンス(ようは普通のリファレンス)を二つもちいています。 位置を書き換えるときは、物体から座標にアクセスし、 その座標から自分自身へのリンクを検索し、 そして削除し、 自分自身の座標へのリンクを削除し、 自分自身の新しい座標へのリンクを埋め込み、 そしてその座標にアクセスし、 自分自身へのリンクを埋め込むという、かなりカオスなことになっています。 普通、位置と物体って同時に平等に存在するものじゃなかったっけ？うーむ。 記述がカオスにならない良い方法を教えてください。 あと、何万回もループするプログラムなので出来れば速いやつがいいです。
プログラミングを始めたばかりです。 Cygwin上でPerlを行っています。 下に示すように、計算プログラムの中にデータを記入し、そのデータを処理することは出来たのですが、外部のファイルを読みそのデータを処理する方法が分かりません。 # y = ax + bを求める @x=(1,2,3); @y=(1,4,9); for($i=0;$i<$n;$i++){ $A = $A + ($y[$i] * $y[$i]); $B = $B + ($x[$i] * $x[$i]); 　　・ 　　・ 　　・ $a=・・・ $b=・・・ print("a=$a,b=$b"); パールファイル（.pl）内に @x=(1,2,3); @y=(1,4,9); のように記載すると、データが変わるたびにファイル内の数値を入れ替えないといけないと思うのですが、cygwinのウィンドウに、 $ ./lesson.pl 10 <data1.csv のように入力しEnterすると、ファイル内の数値を入れ替えないで指定したファイル（ここではdata1.csv）のデータが処理されると思うのですが、その場合パールファイルをどのように記述すればよいのでしょうか。また、cygwinのウィンドウにどのように入力すればよいのでしょうか。 よろしくお願いします。
プログラミングを始めたばかりです。 Cygwin環境でPerlを行っています。計算プログラムをPerlで書いています。 下に示すように、計算プログラムの中にデータを記入し、そのデータを処理することは出来たのですが、外部のファイルを読みそのデータを処理する方法が分かりません。 # y = ax + bを求める @x=(1,2,3); @y=(1,4,9); for(<stdin>){ for($i=0;$i<$n;$i++){ $A = $A + ($y[$i] * $y[$i]); $B = $B + ($x[$i] * $x[$i]); 　　・ 　　・ 　　・ $a=・・・ $b=・・・ print("a=$a,b=$b"); open (IN, $file) or die "$!"でｃｓｖファイルに記載されてある数値をCygwin上で実行することは出来ました。 作成したプログラムとcsvファイルをCygwinで入力して、入力したｃｓｖファイルのデータを処理（直線近似して傾きを求めたりなど）したいのですが、どうすればよいのでしょうか。 よろしくお願いします。
Perlで書かれたソースを以下のように書き換えたいと考えています。 【変換前】 my $message = Convert( From => 'Shift_JIS', To => 'utf-8', Text => "（UTF-8の文字列）", ); 【変換後】 my $message = Convert( "（UTF-8の文字列）" ); ソース・ファイルは非常にたくさんあるのでスクリプトを組んで一括で行いたいと考えています。 容易く書き換えを完了できる方法はないでしょうか？ ■前提条件 - 別の場所に出力するようにする場合はディレクトリ階層も維持する。 - インデントされている場合はインデントを保持する。 perl -pi -e 's///'で置換することが最も簡単そうですが、今回は複数行に渡るため、 s///の部分が非常に複雑になりそうです。なので、s///の部分をスクリプト・ファイルかなにかに 置き換えて、下記のように実行できればと考えているのですが、（何かしらのオプション）の部分が よくわかりません。。 perl -i （何かしらのオプション） （ファイル名） （ソースファイル名）... もちろんもっと良い方法があれば、その方法が良いです。 よろしくお願いいたします。
私はレス機能付きの掲示板を作成しました。 そこで質問なんですが、親記事に対してレスが付けられた場合、その親記事をトップへソートしたいんですが、どうすればよろしいでしょうか？ ソースコードはこれです。 http://daisykatsura.dip.jp/bbs.txt
Windows2003上でActivePerl(V5.14)を使用しています。 SMTP送信に使用するため、ppmでEMail-MIME関係のモジュールをインストールしました。 その状態で実行したところ、Email-Simpleというモジュールの2.102が必要であるというエラーが出ました。現在のモジュールは2.101が入っています。 PPM上ではEmail-Simpleの最新は2.101ということで最新と見なされているようですが、リフレッシュをしても2.102が適用可能という状態になりません。 提供元がcpanとなっているので、以下のレポジトリを追加してみましたが、表示されません。 http://cpan.uwinnipeg.ca/PPMPackages/10xx/package.xml cpanのサイトを見ると、2.102が最新でPerl5.14にも適用と書いてあります。 コマンドラインで手動アップグレードすることも可能なのでしょうか？ また手動でアップグレードした場合、GUI画面にも反映されるものなのでしょうか？ ご存じの方がおられましたら、よろしくご指導お願いします。
ある、１から５までのスロット（またはセル）に１から２００までの数字がランダムに出てくる（登録される）とします。その出てきた、数字が同一のものであれば数を数えたいのですが、どなたか教えていただけないでしょうか？ たとえば １　に 123 ２ に　45 ３　に　3 ４ に　62 ５　に　45　とあったとします。　 そうすれば、２と５のスロット（またはセル）に45が　２個あるので　表示を45が2 123が1、3が1、62が１のように表示させたいのです。　 123, 1 45, 2 3, 1 62, 1 どうもいいサイトもなくうまくできません。　どうすればできますでしょうか？　よろしくお願いします。
Mecab　http://mecab.googlecode.com/svn/trunk/mecab/doc/index.html ---perl script[UTF-8]-------- # my $cmd = `"C:/Program Files (x86)/MeCab/bin/mecab.exe" "C:/Program Files (x86)/MeCab/bin/test.txt"`; my $cmd = `"C:/Program Files (x86)/MeCab/bin/mecab.exe" "今日は晴れだ。"`; open(F,">test_out.txt"); print F $cmd; close F; ------------------- 1行目の方法で行うと成功しますが、2行目の方法で行うとファイルの読み込みを行っているようで失敗します。 直接文字を入れることで動作させたいのですが方法はありますでしょうか？ また、様々なプログラムの知識をネットで拾い読みする感じで付けてきて、あまり体系的に勉強していません。こういった、事の分かる書籍などあれば教えて頂ければ幸いです。 宜しくお願い致します。
お世話になります。 真になる演算子が１を、偽になる演算子がundefを返すことを研究しています。 print "3 == 3：【", 3 == 3, "】\n"; であれば、3 = 3が1を返すので 3 = 3:【1】 となります。 print "3 > 4：【", 3 > 4, "】\n"; であれば、3 > 4がundefになるので 3 > 3:【】 になります。 さて、and 演算子を使ったところも見たいと重い、 print "3 == 3 and 3 > 4：【", 3 = 3 and 3 > 4, "】\n"; と書いて実行すると Useless use of a constant in void context at C:\Perl\perl\showAndTF.pl line 8. という警告と共に 3 == 3 and 3 > 4：【1 と出力されてしまいます。 これはなぜでしょうか。 よろしくお願いします。
http://hole.sugutsukaeru.jp/archives/10 こちらのサイトでPerlでのファイルのアップロードを行なおう思い、 作成しているのですが、 エラーになり表示されません。 コードを貼り付けると、 #!/usr/bin/perl -w #使用するモジュールをロード use File::Basename; use CGI; #変数宣言 my ($form, $dir, $filename, $parsename, @filename, $error, $ok, $type, $newfile, $i, $buffer, @ext_ok); #ファイルを保存するディレクトリを設定 #（CGIの実行ユーザで書き込み権限が必要） $dir = './files'; #受付可能な拡張子（正規表現） @ext_ok = qw ( txt zip pdf doc cgi ); #CGIオブジェクトを作成 $form = new CGI; #転送できるファイルの最大サイズを設定 #（実際は、post送信されるコンテンツ合計の最大サイズ） #この値は、CGIオブジェクトを作成する時には既に #設定されていなければならない $CGI::POST_MAX = 1024 * 1000; #max = 1MB #CGIオブジェクトを作成 $form = new CGI; #クライアントにヘッダを送信 #これは、結果メッセージ表示のため binmode STDOUT; print "Content-Type: text/plain;charset=euc-jp\r\n\r\n"; #ファイルの転送のチェック if (!defined($filename) and $error = $form->cgi_error){ #ファイルが転送されていなかったら、$filename は 未定義値となっている。 #フォーム上でファイルを選択しないままフォームがサブミットされた場合は、 #通常はこの変数 $filename は空文字列として定義されている（＝未定義ではない）。 #このため、以前のバージョンでは $filename が定義されている #かどうかをエラーの判別の基準としていたが、 #2007年3月 Mac OS X 上の Netscape 7.1 で試したところ、 #ファイル選択されていない場合に未定義値になることが判明。 #このため、エラーの場合に設定される（筈の）値 $form->cgi_error も判別の #基準に追加した。 print "ファイルが転送できませんでした：$error\n"; exit; } if ($filename) { #ファイルが転送されていれば、値は真 #ファイルパス内の「\」を「/」に変換 # $parsename には、送信元クライアントマシン内での #ファイルパスが格納されている。 #注：Shift_JISで実装する場合、このあたりには工夫が必要。 $parsename =~ s#\\#/#g; #ファイル名を（ベース名, ディレクトリ名, 拡張子）に分解 @filename = fileparse($parsename, "\.[^\.]+"); #ベース名のチェック（アスキー文字列であること） $filename[0] =~ /^[\.\w~-]+$/ and $filename[2] =~ /^[\.\w-]+$/ and $ok = 1; unless ($ok) { $error = 'ファイル名は、半角英数字にして下さい。'; print "ファイル転送ができませんでした。: $error\n"; exit; } $ok = 0; #フラグのリセット #拡張子のチェック foreach (@ext_ok){ $filename[2] =~ /^\.$_$/ and $ok = 1 and last; } unless ($ok){ $error = "許可されていない拡張子($filename[2])です。"; print "ファイル転送ができませんでした。: $error\n"; exit; #サーバ側ファイル名の決定 #まず、セッションごとに一意のディレクトリ名を作成 while (-d "$dir") { $dir = $dir.'/upload_'.&gen_unique_key(15); } #ファイルを格納するディレクトリを作成 unless (mkdir($dir, oct(777))){ print "保存ファイル用ディレクトリの作成に失敗しました。: $!\n"; exit; #サーバ側のファイルパスを設定 $newfile = $dir."/".$filename[0].$filename[2]; #既に同名のファイルが存在した場合 #（複数の同名ファイルを同時にアップロードした場合など）は、 #ベース名にアンダースコアと番号を付けて別名にする $i = 0; while (-f "$newfile"){ $i++; $newfile = $dir."/".$filename[0]."_".$i.$filename[2]; } #ファイルの保存 unless (open (OUTFILE,">$newfile")){ print "サーバ側の保存ファイルの作成に失敗しました。: $!\n"; exit; } #保存用ファイルを無事 open できた場合 #改行コードの自動変換を停止 binmode (OUTFILE); binmode ($filename); # $filename から内容を読み出して #保存用ファイルに書き出す #この場合、変数 $filename はファイルハンドルとして #機能する while (read($filename,$buffer,1024)) { print OUTFILE $buffer; #ファイルを close して終了メッセージを表示 #この場合、$filename は、送信元クライアント #マシン内でのファイルパス（ブラウザが送信してきた値）を返す close (OUTFILE) and print "送信されたファイル ($filename) を右のファイル名で保存しました： $newfile\n" or print "サーバ側の保存ファイルのクローズに失敗しました。: $!\n"; } else { # ファイルが転送されていない場合 # $filename は 偽 print "ファイルはアップロードされていません。\n"; } #一意の文字列を作成するための関数 sub gen_unique_key($){ #生成する文字列の長さを引数で指定 my $length = shift; my ($i, $tempval, $key, $chars, @chars); #引数で指定された文字列長さが、 # 5以上 30以下の数値でない場合、15に設定 #（範囲は、長からず短からず...。） ($length =~ m/^\d+$/ and $length >= 5 and $length <= 30 ) or $length = 15; #使用する文字を指定（ディレクトリ名として使用できる文字を指定する） $chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890~-_'; @chars = split(//, $chars); #乱数のタネを作る srand(time|$$); for ($i=0; $i<$length; $i++){ # @chars 配列の最大の添字までの乱数を生成する $tempval = int(rand(scalar(@chars))); $key .= $chars[$tempval]; } return $key; } となりますが、どこが間違えているのでしょうか。 上記コードは、サイトからのコピペになります。 よろしくお願いします。
$today = "2012"; my @file = qw( result_001_${today}.txt result_002_${today}.txt result_003_${today}.txt ); for(@file){ print ; } 例えば、こういったスクリプトがある場合、$todayが代入されることなく出力されます。 なぜか分かりますでしょうか？
試しに次のようにしてみましたがエラーになりました。 #!/usr/local/bin/perl use strict; use warnings; my $mystr = "abcde"; my @{$mystr} = (1,2,3); $mystrの内容はいろい変わっていきます。 ご存知の方いらっしゃいましたらすみませんが教えてください。 よろしくお願いいたします。
一定時間が経過したファイル削除のsauceを使って、サーバーのディレクトリを削除しようとしましたが指定した時間内のディレクトリが削除できません。間違っている個所をご指摘くださいますようお願い致します。 #古いディレクトリの削除 $dir='./z'; opendir(DIR, "$dir"); my @dirlist = grep /^*/, readdir DIR; closedir(DIR); my $expire_t = 15552000; #180日以上経過したファイル指定　　(1日は86400) my $expire_d = 31536000; #365日以内に生成されたファイル指定 my $now = time; foreach my $deldir (@dirlist){ my $mtime = (stat("$dir/$deldir"))[9]; if ($now > $mtime + $expire_t && $now < $mtime + $expire_d){ rmdir("$dir/$deldir"); } } どうぞ宜しくお願いします。
Cookieの有効期限を半年間にしようと思い、 プログラムを覗いてみたところ、以下のような記述がありました。 どこをいじれば半年間に伸ばすことができるのか教えていただけますか？ どうかよろしくお願いいたします。 sub set_cookie { ($secg,$ming,$hourg,$mdayg,$mong,$yearg,$wdayg,$ydayg,$isdstg) = gmtime(time + 30*24*60*60); $yearg += 1900; if ($secg < 10) { $secg = "0$secg"; } if ($ming < 10) { $ming = "0$ming"; } if ($hourg < 10) { $hourg = "0$hourg"; } if ($mdayg < 10) { $mdayg = "0$mdayg"; } $month = ('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')[$mong]; $youbi = ('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday')[$wdayg]; $date_gmt = "$youbi, $mdayg\-$month\-$yearg $hourg:$ming:$secg GMT"; $cook="name\:$FORM{'cntr'}\,email\:$FORM{'email'},pswd\:$FORM{'pswd'}"; print "Set-Cookie: TORBBS=$cook; expires=$date_gmt\n"; }
Perlのintについてですが、以下の3の計算結果が異なる理由を教えてください。 1：print 1080/1.08; 　→「1000」と表示される 2：print int 1080/1.08; 　→「1000」と表示される 3：print int(1080/1.08); 　→「999」と表示される Perlのバージョン：ActivePerl v5.14.2 OS：Windows XP
恐れ入ります。 一定時間後にプログラムを実行したいのですが、sleepですと、すべてのプログラムが停止してしまいます。 プログラムの一部を、一定時間後に実行するにはどうしたらよいのか苦戦しています。 $SIG{ALRM} = \&timeout; eval { alarm 5; print qq! 再生中!; alarm 0; }; alarm 0; sub timeout{ print qq!5秒経ちました!; } としてみましたが、うまくいきません。再生中を表示しながら、5秒後に5秒経ちましたと、 再生中を表示しながら表示したいのですが、どのようにしたら良いでしょうか。 よろしくお願いします。
例えば以下のように記載するとエラーとなります。 if($::FORM{'body'} =~ /パターン/){ push(@error, '投稿できません'); } しかし、以下のように記載するときちんとパターンマッチします。 このふたつともエラーが出ておかしくないと思うのですが なぜ以下ならＯＫなのか教えてください！！ @word=qw(パターン); foreach (@word) { if (index($::FORM{'body'},$_) >= 0) { push(@error, '投稿できません。'); } }
CGI::Sessionなどを使ったことがない初心者です。 どの端末から掲示板に投稿されたか識別するだけのために （セッションの画面遷移は不要） PerlのCGI::Sessionを使ってセッションＩＤを発行し、 CGI内のセッション記録用ファイルにいつどの端末から投稿されたか記録したいと思っています。 そこでCGI::Sessionについて調べてみたのですが my $session = new CGI::Session("driver:MySQL", $cgi, {Directory=>'./session'}); データーベースはMySQLでなければいけないのでしょうか？ My SQLではなく例えばディレクトリ内のdate/session-date.textなどに記録し、 扱いことはできないのでしょうか？ またそのような場合にはどのように記述するのか教えてください！
お世話になります。 Perl正規表現プログラムで、 s置換演算子の末尾に、 カンマと丸カッコでスカラ変数を囲んで、 存在している箇所 たとえば、 s/あいうえお/($hensu = $&) =~ tr{ＡＢＣ}{abc}, ($hensu) =~ s{１２３}{123}, ($hensu) /eg; のような正規表現であれば、 上記のtr置換演算子や、s置換演算子それぞれの末尾に、 「 , ($hensu) 」 として、カンマと丸カッコでスカラ変数を囲んで、 存在している箇所は、 どのような意味があるのでしょうか？ 以上になります。 ＰＳ： ネット上や正規表現の本などを読んでも、 上記したような、 カンマと丸カッコでスカラ変数を囲んでいる パターンの解説を、 見つけられなかった為、 ご質問させていただきました。 ご存じの方がいらっしゃいましたら、 教えてください。 よろしくお願いします。
Perl初心者です。 LWPでどうしてもproxyが通りません・・・。 何が悪いのかわかりません。教えてください。 モジュールは全て導入を確認しました。 よろしくお願いします。 稚拙なミスだったらごめんなさい。 use LWP::Simple; use LWP::UserAgent; use HTTP::Request::Common; my $ua = LWP::UserAgent->new( timeout=>"5" ); #cybersyndromeさんからLWP::Simpleでproxyを取得 $_ = get('http://www.cybersyndrome.net/pla5.html'); #proxyをリストに代入 (@proxy_list)=/\"\>(.*?)\<\/a\>\<\/li\>\<li\>/g; #適当なサイトをリクエストのターゲットに $r = new HTTP::Request GET,('http://taruo.net/e/'); #前述のターゲットへリクエストしてひとつづつproxyが通るか確かめたいのに何故かすべてすぐにERRORに for($i = 0;$i <= 10;$i++){ $proxy = 'http://'.$proxy_list[$i]; $ua->proxy ([qw(http https)] , $proxy); $req = $ua->request($r); if ($req->is_success) { print "Success!\n"; }else{ print "Error\n"; } }
ソート機能がうまく動作しなくなりました。 CSVが以下のようなものとなったときにソートがうまく動作しなくなってしまいました。 CSVデータの区切りが「","」と「,」の混在で区切られてます。 (ここから)　データa "山田","埼玉県","男性" "田中","埼玉県","男性" "井上","栃木県","女性" "志村","千葉県","男性" (ここまで) だったり (ここから) データb 1,山田,埼玉県,男性,50,"予算2,000円",0 2,田中,埼玉県,男性,36,予算なし,0 3,井上,栃木県,女性,30,予算100円,0 4,志村,千葉県,男性,27,"予算300,000円",0 (ここまで) このようなテータの時もあります。 以前のアドバイスをもとに以下のように作成いたしました。 (ここから) while (my $line = <$ifh>) { if ($socnt == 0 ){$socnt++;next;} my $key = (split /\",\"/, $line)[$ccsv]; push @{$sorted{$key}}, $line; if (@{$sorted{$key}} == 1000) { open OUT, ">>./$key.tmp" or die "Can't open: $!"; print OUT @{$sorted{$key}}; close OUT; @{$sorted{$key}} = (); } } (ここまで) この場合だと my $key = (split /\",\"/, $line)[$ccsv]; データaはうまくいくのですが、データbがうまくソートが動作いたしません。 my $key = (split /,/, $line)[$ccsv]; ではデータbはうまくいくのですが、データaうまくソートが動作いたしません。 条件式で混在認識方法があるかと思っている(ないかもしれませんが、わたしには分かりません)ので質問いたしました。 ご教授いただけますと幸いです。 よろしくお願いします。
Pealを始めようと思いApache2.2をダウンロードしようと思いました。 こちらのサイトです。 http://httpd.apache.org/download.cgi ところがダウンロードしようとしたら８つもソフトがあるようなのです。 httpd-2.2.22.tar.gz httpd-2.2.22.tar.bz2 httpd-2.2.22-win32-src.zip httpd-2.2.22-win32-x86-no_ssl.msi httpd-2.2.22-win32-x86-openssl-0.9.8t.msi httpd_2.2.22-netware.zip Security and official patches Other files そのためどれをダウンロード指定医か分からないためできませんでした。 ですのでどれを使っていいのかがわからないのでどのようなものが私向きなのか教えていただけますか？ 用途は掲示板やチャットを製作予定です。
今までPerlをWindows環境で書いていました。 エディターはずっとVimです。 最近になって、Macを手に入れたのでMacで開発したいのですが Macでは円記号ではなくバックスラッシュでないと変数が認識されないことに気づきました。 バックスラッシュでも書けないことはないのですが、optionキーを押さないといけないことと Windows環境に慣れていたため、バックスラッシュだと変数が見づらいということもあり、macのVimでも円記号をそのまま使えないかと思っていますが、Vimの設定がいまいちよくわかりません。 もしお分かりになる方がいたら教えて頂けないでしょうか？
Perl初心者です。 簡易なタイマーのプログラムです。 (1)$s=shift||60; この部分の shift と || はどういった意味合いを持っているのでしょうか。 (2)for(1..$s) このfor構文の括弧内はどういった意味合いを持っているのでしょうか。 $s=shift||60; $|=1; for(1..$s){ sleep 1; print"$_\r" } print"\n"
Perl初学者です。Perlでのインターネット通信に興味があります。 webサイトのテキストボックスにテキストを入力し、それを送信・結果を取得するためのプログラムを教えてください！ (例) 単語を英訳するプログラムが作りたかったので、”http://ejje.weblio.jp/”の検索ボックスに単語を入れて送信し、帰ってきたＵＲＬのhtmlを取得する、といった感じ？ 少し勉強したLWPモジュールを使って頂けると嬉しいです。 もちろん、こっちの方が効率がいいよ、といった方法があれば是非教えてください！ よろしくお願いします。
csvファイルが存在するかどうか確認するためif節でheadを使っています $data_hokkaido = "http://denkiyoho.hepco.co.jp/data/juyo_hokkaidou.csv"; if (head "$data_hokkaido" ){ use LWP::Simple; $content = get($data_hokkaido); } こうするとエラーになるのでperlチェックをしてみたところ String found where operator expected at test.cgi line 393, near "head "$data_hokkaido"" (Do you need to predeclare head?) と警告が出ました if節を外して $data_hokkaido = "http://denkiyoho.hepco.co.jp/data/juyo_hokkaidou.csv"; use LWP::Simple; $content = get($data_hokkaido); とするとエラーは出ず、問題なくデータ取得できるので、headに原因があるのだと思いますが、具体的に何が悪いのでしょうか？ ちなみに何のデータを取得しているかと言いますと、電力各社の電気予報のデータで、 エラーが出るのは北海道電力ので、同じようにファイルがダウンロードされる形式になっている関西電力部分 $data_kansai = "http://www.kepco.co.jp/yamasou/juyo1_kansai.csv"; if (head "$data_kansai" ){ use LWP::Simple; $content = get($data_kansai); } ではエラーは出ません 理由がお分かりの方ぜひ教えてください。 よろしくお願いします。
初質問です。 訪問者が登録できるリンク掲示板スクリプトを探しています。 条件付というのは、例えば投稿されようとしているurlに"http://www.youtube.com/"が入っていなければ投稿を弾く様にしたいのです。 cgi、php問いません。 よろしくお願いします。
Perl の XML::LibXML モジュールを使用して XML を処理しています。 例えば、 <?xml version="1.0" encoding="UTF-16" standalone="no"?> <!DOCTYPE aaa PUBLIC "-//bbb//CCCC//EN" "ddd.dtd" []> <doc> ....... </doc> のようなXMLに対してPerlで処理をして、 最後に documentElement を toString して書き出しています。 しかし、この場合、DTD宣言部分を書き出すことができません。 XML::LibXMLでこの部分を取得して書き出すことはできますでしょうか。 どうぞ、よろしくお願いします。
perlプログラムで for文で　ループ分の配列定義するには　どうしたらよいですか？ 下記のようなことができないかと　考えております。 for(my $i = 0; $i < $file_no; $i++){ my @{"segments$i"} =();　#配列定義 my ${"line$i"}="";　　　　　#変数定義 my %{"hash$i"}= ();　　　　#ハッシュ定義 open(ARG1,$ARGV[$i]); while(<ARG1>){ ${'line'.$i} = $_; chomp ${'line'.$i}; @{'segments'.$i} = split(/\t/,${'line'.$i}); 　　　　　　　${'hash'.$i}{${'segments'.$i}[0]}=${'segments'.$i}[1]; 　　　　｝ close(ARG1); } #下記で、その後　各ハッシュに設定したデータをもとに　いろいろ計算したい foreach my $a (keys %{'hash'.$i}){ ・・・ ｝ 今は、Can't declare array dereference in "my" at test.pl line XX, near "} ="　と　配列定義でエラーとなり処理できません。
※　箇条書きで現状を書きます。 ●現在、ローカルにapacheを入れてwordpress（サイト制作）の勉強をしています。 　　　　↓ ●Perlを使えるようにしたいと思い、perlを使っている友人に相談。 　すると、httpdをインストールするように言われインストールする。 　　　　↓ ●しかし、ポート番号が塞がっているらしくhttpdを起動できない。 　　　　↓ ●ググった調べてみると、appacheの設定をイジることで、apacheでperlを動かせられるということを 　 知る。 　　　　↓ ●現在、解決方法に対する自分の認識は、[１]httpdで使うポート番号を他のものに変える 　 [２]apacheの設定をイジってperlを使えるようにする。 【質問】 wordpressを使いながら、perlも使えるようにする最もおススメの方法を教えて下さい。 (※wordpress上でperlを書くという意味ではありません。wordpressで作ったサイトを開く時もあれば、perlで書かれたサイトを開く時もあるという意味です) よろしくお願いします。
以下のソースなのですが、ブラウザより直にアクセスした場合には正常に動作するのですが、Forwardさせたメールをトリガーにして動作させると、なぜかrequireしている二つのファイルへのパスが通らなくなりエラーを出力してしまいます。 Command output: Can't locate ../../../../testconfig.txt in @INC ~(後略)~ どうしてなのでしょうか？ /home/～testconfig.txtとフルパスかいてやれば、メールをトリガーにした場合でも正常動作しますが、フルパス指定は避けたいのです。 #!/usr/bin/perl use CGI; use DBI; use HTML::Template; use Jcode; use MIME::Parser; use FindBin; use lib "$FindBin::Bin/my_lib"; use MIME::Lite; require '../../../../testconfig.txt'; #error require './my_lib/sub_function.pl'; #error my $msg = MIME::Lite->new( From => 'webmaster@***.com', To => 'user@***.org', Subject =>'Error message', Type => 'text/plain; charset="iso-2022-jp"', Data => 'This is message text', Encoding => '7bit', ); $msg->send; exit;
こんにちは。 Perlの引数について質問です。 サブルーチンに引数を渡し、サブルーチンの中で他のサブルーチンをよんでいます。 すると引数を渡していないサブルーチンにまで引数が与えられてしまっているようです。 @_で受け取ると引数が渡されてしまい、$_[0]だと渡されずにすみます。 これはなぜなのでしょうか？Perlには引数を引き継ぐルールでもあるのでしょうか？ 以下、サンプルです。 -------------------------------- &test('引数です'); sub test { &test2; } sub test2 { (my $hoge) = @_; } -------------------------------- $hogeに「引数です」が入ります。 &test2;を&test2();とすると大丈夫です。
文字コードがShift-JISのCSVファイルを読み込み、UTF-8のテキストファイルに出力するのに プログラムの中で変更しようとしているのですが、うまくいきません。出力ファイルの文字コードを 確認するとShift-JISのままです。 どなたか教えていただけないでしょうか？ ActivePerl v5.16.0を使用し、Encodeモジュールのfrom_toを使用しています。 #!/usr/bin/perl use strict; use warnings; use utf8; use Encode; my $input_file="input.csv"; my $output_file="output.txt"; open (IN, $input_file) or die "$!"; open (OUT, ">$output_file") or die "$!"; while (<IN>){ chomp ($_); my @data=split(/,/,$_); for(my $i=0;$i<@data;$i++){ $data[$i]=Encode::from_to($data[$i],'shiftjis','utf8'); #Shift-JISからUTF-8に変換 $data[$i]=~s/\s+//g; print OUT $_; } print OUT "\n"; } close (IN); close (OUT);
phpとperlでメールフォーム＋DB登録機能を作っていますが、 だいぶ煮詰まってしまいました。 ●設計概要 https://dl.dropbox.com/u/85274673/form.jpg ●参考にしたが解決しなかったURLの一部掲載 http://oshiete.goo.ne.jp/qa/3086758.html http://ml.php.gr.jp/pipermail/php-users/2003-October/019138.html ●使用しているsend.cgi(配布フリー) http://www.synck.com/contents/download/cgi-perl/mailformpro.html ●状況 cgi(perl)もしくはphpだけでdb登録＋メール送信両方行うプログラムが 必要となりました。 php単体でdb登録+mb_send_mailをスクラッチで書いてうまくいったと思ったのですが、 ユーザー側に送るメール内容(本文)と管理者側に送るメール内容(本文)を 分けることができず、現状使っているsend.cgiでメール送信し、phpでDBに登録 はできないかと思い、調べながらやってみました。 (cgi(perl)はphp以上に完全素人なので、dbへの登録を行うプログラムが書けませんでした。) form.html→db.php→thanks.html from.html→send.cgi→thanks.html は問題なく動作しました。 設計の通り 1. form.html→db.php→send.cgi→thanks.html もしくは 2. from.html→send.cgi→db.php→→thanks.html を実現したいと思っています。 $_POSTの値さえ渡せれば 1.は実現できそうなのですが、話はそう単純ではないのでしょうか。 ヒントでも貰えれば幸いです。宜しくお願いいたします。
OS(CentOS 6.2 / 64bit)にデフォルトでインストールされているPerl(version 5.10.1)を使って勉強しているのですが、参考書に記載されているメジャーなモジュールがインストールされてなく、困っています。 自分でインストールする必要があるのかと思い、モジュールのインストール方法を調べたところ、CPANというモジュールを使えば簡単にモジュールがインストールできると知ったのですが、このCPANモジュールも入っていない模様。 ではまずはCPANモジュールから手動でインストールしようかと思ったところ、CPANモジュールインストール時のMakefile.PLを実行すると、ExtUtilsというモジュールが無いと怒られてしまい実行できませんでした。 このような場合、通常よく使われるようなモジュールをまとめてインストールするような方法は無いのでしょうか。 ※ちなみに、@INCでは以下のディレクトリが登録されていました。 ・/usr/local/lib64/perl5 ・/usr/local/share/perl5 ・/usr/lib64/perl5/vender_perl ・/usr/share/perl5/vender_perl ・/usr/lib64/perl5 ・/usr/share/perl5
レキシカル変数の書き方について質問なのですが、色々なスクリプトを見ると書き方が色々あり、違いが分かりません。 例） my $test=0; my($test)=0; my @test=(0,1,2,3,4,5); my(@test)=(0,1,2,3,4,5); 上記の場合、それぞれカッコがある場合とない場合の違いはあるのでしょうか？ 参考になるサイトでも構いませんので、どなたかご存知の方教えていただけませんか。
お世話になります。 $filename = "abc-123"; $filename_check = "./data/$filename.html"; if(-e $filename_check) { $ok=1; } 上記ですと、abc-123.htmlと言うファイルが存在していた場合に$ok=1になりますが、 これを、 scv-abc-123.html ert-abc-123.html 上記のようなファイル名でも$ok=1になるようにしたいのですが、 ($filenameで指定したものが含まれるファイル） どのようにすれば良いのでしょうか。 お手数をおかけしますがご教授いただけましたら幸いです。
質問が二つあります。 ($;@) と書けば、一つ以上の引数を受け付けます。 (\@;\@) と書けば、一つもしくは、二つの配列を引数として受け付けます。 では、一つ以上の配列を引数として受け付けたい場合はどうしたらいいんでしょうか。 (\@;\@\@\@\@\@\@\@\@\@\@……) みたいな感じです。 これが一つ目の質問です。 二つ目の質問は、 ([@])これなんでしたっけ？ (\@)とは何か明確な違いがあると思いましたが、思い出せないし、どこに書いてあったのかも覚えてません。
perlのプログラミングについて詳しい解説をお願いいたします。 sub list_reverce{ my $old=shift; my&new=undef; while (my $cur=$old){ $old=$old‐>[NEXT]; $cur‐>[NEXT]=$new; } return $new } 全くの初心者です。連結リストに対してのreverseなのですが、わかりません。 ご回答お願いいたします。
perl初心者です。いつもありがとうございます。 perlでcsvファイル(1行のカラム数は200)、総行数は約３万行のファイルを37番目のカラム(-25以上25未満の数値データ)で降順ソートしその値によって行数がだいたい均等になるよう3分割し、2番目のカラムに文字でも数字でもよいのですがその４つのグループごとにフラグ(例えば1,2,3)を入れたいと思ってます。グループ化については境目の37番カラムの値は重複している場合が多いと思うのですがその場合は下(別に上でもかまいません)に入れるものとします。 ソートロジックは過去の質問を参照して理解しましたがグループ化しフラグを入れるルーチンがうまく作れません。下記のように作ったのですがこの先同じことを何度もやらなくてはならないので先に進めません。どなたかお助けください。最終的にやりたいことはカラム37でグループ化→カラム2にフラグを立てる、次にカラム2とカラム38(-25から0までの数値)でソートし同様に同じ行数になるようにグループ化→カラム3にフラグを立てる、さらにカラム2とカラム3とカラム39(-25以上25未満の数値データ)でソートし・・・同様に繰り返し最終的に1グループが100件(行)～150件(行)になるようにしたいのです。つまり約３万件のデータを3*4*2*4*2=192分割(5列の値で分類)したい、そしてどのような範囲で分割したかという情報も得たいのです。 use strict; use warnings; use utf8; use Encode; binmode STDOUT, ':encoding(utf-8)'; my $dir = './data'; # 処理するディレクトリ my $motoFile = 'customer.txt'; # もとファイル open my $fh, '<:encoding(cp932)', "$dir/$motoFile" or die 'ファイルが開けません。',"$!"; my %sorted; while (my $line = <$fh>) { my $key = (split /,/, $line)[37]; push @{$sorted{$key}}, $line; if (@{$sorted{$key}} == 1000) { open OUT, '>>:encoding(cp932)', "$dir/$key.tmp" or die "Can't open: $!"; print OUT @{$sorted{$key}}; close OUT; @{$sorted{$key}} = (); } } open OUT, '>:encoding(cp932)', "$dir/out.txt" or die "Can't open: $!"; foreach my $key (sort { $b <=> $a } keys %sorted) { if (-e "$key.tmp") { open IN, '<:encoding(cp932)', "$dir/$key.tmp" or die "Can't open: $!"; print OUT while <IN>; close IN; } print OUT @{$sorted{$key}} if @{$sorted{$key}}; } close OUT; #↓↓↓↓ここからフラグを作成するルーチン # 行数を調べ3つに分けるルーチン my @colum37; open IN, '<:encoding(cp932)', "$dir/out.txt" or die 'ファイルが開けません。',"$!"; my @in = <IN>; close IN; my $gyousuu = scalar(@in); my $amari = $gyousuu % 3; if ($amari == 0) { my $groupGyousuu = ($gyousuu-$amari)/3; print "総行数は$gyousuu","で、1グループの行数は$groupGyousuu","ほど、余りは$amari\n"; # あまりが0の時、group1は@inの0行 ～$groupGyousuu-1行まで # 　　　　　　　 group2は@inの$groupGyousuu行 ～$groupGyousuu*2-1行まで # 　　　　　　　 group3は@inの$groupGyousuu*2行～$groupGyousuu*3-1行まで foreach my $num (1..2) { push @colum37, (split /,/, $in[$groupGyousuu*$num])[37]; # これは境目の先頭の37番目 } print "@colum37\n"; #これでここまでは完成、分けるべき値がこの配列に入っている。 open OUT, '>:encoding(cp932)', "$dir/out.txt" or die "Can't open: $!"; foreach my $line (@in) { my @line = split /,/,$line; if ($line[37]>=$colum37[0]) { $line[1] = 1; }elsif ($line[37]>=$colum37[1] and $line[37]<$colum37[0]) { $line[1] = 2; }elsif ($line[37]<$colum37[1]) { $line[1] = 3; } $line = join (',',@line); print OUT $line; } close OUT; } elsif ($amari == 1) { この後未作成
Perlにおいて、「元号を判定させる」ようにしたく、if-elsif文章を書いてみたのですが、上手くいきません。 （そもそも起動してくれないです・・・文章も合っているかわからないのですが。。） 年号を入力させて、 (meizi) X nenと表示させたいのです。 あと、明治以前の数字を入れたら、エラーと出すようにする。 被っている年号、例えば1912年と入れたら、meizi45nen/taisyou1nen ともしたいのですが、これらはどう入れたらいいのか分からなかったです。 どこを直せばいいのか、一部でもいいので、教えていただけると嬉しいです。 chomp($year = <stdin>); if($year<=1912 and $year>=1868){ $A=$year-1867 print("meizi $A nen \n"); } elsif($year<=1926 and $year>=1912){ $B=$year-1911 print("taisyou $B nen \n"); } elsif($year<=1989 and $year>=1926){ $C=$year-1925 print("syouwa $C nen \n"); } elsif($year>=1989){ $D=$year-1988 print("heisei $D nen \n"); }
WWW::Mechanizeついて 質問させて頂きます。 他でも質問しておりますが、回答が無かったためマルチですがご了承ください。 WWW::Mechanizeを使ってログインしようとしてるのですが、うまく行きません。 <form action="login.cgi" name="form1" method="post"> <input id=id name='id' type='text' /> <input id=pass name='pass' type='text' /> <input type="submit" name="submit" value="LOGIN" /> 上記のフォームでは正常に取得できます。 しかし、ログインチェックをJavascriptからPHPに渡ってるページでの ログインがうまく行きません。 ソース //入力チェック /*login_checkたとえです*/ function LOGIN(){ $( "userid" ).className = ""; $( "userpassword" ).className = ""; if( login_check( "id" ) ){ if( login_check( "pass" ) ){ document.form1.action = "login.php"; document.form1.Btn_Type.value = "login"; document.form1.submit(); }else{ $( "pass" ).className = "error"; } }else{ $( "id" ).className = "error"; } } <form action="login.php" name="form1" method="post"> <input id=id name='id' type='text' /> <input id=pass name='pass' type='text' /> <input type="button" name="loginbtn" value="LOGIN" onclick='JavaScript:LOGIN();'/> 上記のフォームにログインしようと下記のようにしました。 my $loginUrl = 'http://hoge.jp/login.php'; my $mech = WWW::Mechanize->new(cookie_jar => $cookie_jar); $mech->agent_alias('Windows IE 6'); $mech->get($loginUrl); $mech->form_name('form1'); $mech->field( id => "test" ); $mech->field( pass => "test" ); $mech->click_button( value => 'Login' ); print $mech->content(); これで実行するとエラーがでます。 Can't call method "header" on an undefined value at /usr/lib/perl5/site_perl/5.8.8/WWW/Mechanize.pm line 2471. $mech->click_button( value => 'Login' ); 上記のclick_buttonでvalueを指定するとエラーになります。 WWW::MechanizeはJavascriptは実行できないのでしょうか？ お知恵をお貸しいただけませんでしょうか。 説明不足かもしれませんがお願い致します。
お世話になります。 Windows7上のActivePerlで、 use XML::SAX; use XML::LibXSLT; モジュールを利用中に、 start_elementイベント時のタイミングで、 取得したタグ文字を、 そのタイミングで、XSL変換することは可能なのでしょうか？ 今回の目的は、 XSL変換した後の各値を、 配列などにセットできればOKという状況ですので、 もしSAXで無理でしたら、 たとえばDOMやXPathなどで、 use XML::LibXML; use XML::LibXSLT; モジュールを利用中に、 随時取得したタグ文字を対象として、 そのタイミングで、XSL変換して配列にセットできれば、 それでもOKという状況です。 ＰＳ： （ちなみに、 　XSLファイル内で、 　<xsl：output method="xml"> 　を指定してから、 　XSL変換を実施すると、 　まとめてXSL変換自体は、 　一通り正常に行われているのですが、 　なぜか、出力されたファイルは、 　XML形式ではなくて、 　text形式でファイルが出力されてしまう為、 　（タグ文字が全て空白文字に置換されています） 　XMLパーサが一切利用出来なくなってしまい、困っています） 以上になります。 もしご存じの方がいらっしゃいましたら、 よろしくお願いします。
【環境】 WinXP / Perl 5.14.2 関数に値を受け渡す際にハッシュを利用しようと思っているのですが キーの typo が気になります。 検索すると Hash::Util::lock_keys() などがヒットしたのですが、 結局これはそのロジックが実行された際にエラーになる仕組みです。（よね？） できれば "プロトタイプを指定した関数に対して正しくない引数を指定した時" のように そのロジックが実行されていなくても Internal Server Error になるような方法があれば欲しいのですが… そういった方法はありますでしょうか。 ---------- 最終的にしたいことは、関数に対して 36 個の引数を渡す際に できるだけミスがないように、もしあった場合すぐわかるようにしたいです。 （しっかりテストすれば良いというのはなしで… 勿論テストはしっかりしますが） なのでハッシュでなくても何か良い方法があればそちらでも良いのですが、 引数を順番に指定する方法よりはハッシュで渡したほうが良いですよね？ 他になにか渡し方あるでしょうか。 ---------- ご存知の方がいらっしゃいましたら教えてください。 よろしくお願いします。
cookieを書込んだ直後、書込めたか（cookieをオフにしていたり、cookieを書込めない携帯端末からのアクセスかもしれないので）確認をしようと、cookieを読込もうとしたのですが、cookieが書込まれているにもかかわらず情報を取得することができません 実験環境として、htmlファイルにボタンを作って、cgiへ飛び、そのcgi内でcookieを書込み、cookieが書込めたかどうかで分岐して、表示するようにしています （cgiを一度実行したあと一旦ブラウザで前のhtmlファイルに戻って）cookieが既に書込まれた状態で、改めてhtmlファイルのボタンを押せばcookieは読込めますが、最初にcookieを書込んだ時に同じcgi内で即読込みを行ったら読込めません 書込が完結する前に読込みに行っているから読込めないのかとも思い、読込み前にタイムラグを作っても見ましたがやはり読込めません どうすれば書込み直後に読み込めるのでしょうか？ 色々ネットで調べても見ましたが、いっこうに解決策が見つかりません ご存じの方ぜひご教授下さい よろしくお願いします なお、下にperlのコードを書いておきます #クッキーを書込 $test{sid} = "12345"; &set_cookie($test{sid}); #タイムラグ use Time::HiRes; Time::HiRes::sleep(0.8); #クッキーを読込 ($cookie{test}) = &get_cookie; if(!$cookie{test}){ print "読み込めてない"; } else{ print "読み込めた"; } ######→読み込めません##### #クッキー書込sub sub set_cookie { local(@cook) = @_; local($gmt, $cook, @t, @m, @w); @t = gmtime(time + 2*60*60); @m = ('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'); @w = ('Sun','Mon','Tue','Wed','Thu','Fri','Sat'); $gmt = sprintf("%s, %02d-%s-%04d %02d:%02d:%02d GMT", $w[$t[6]], $t[3], $m[$t[4]], $t[5]+1900, $t[2], $t[1], $t[0]); foreach (@cook) { s/(\W)/sprintf("%%%02X", unpack("C", $1))/eg; $cook .= "$_<>"; } print "Set-Cookie: SID=$cook; expires=$gmt; path=/;\n"; } #クッキー読込sub sub get_cookie { local($key, $val, *cook); $cook = $ENV{'HTTP_COOKIE'}; foreach ( split(/;/, $cook) ) { ($key, $val) = split(/=/); $key =~ s/\s//g; $cook{$key} = $val; } foreach ( split(/<>/, $cook{'SID'}) ) { s/%([0-9A-Fa-f][0-9A-Fa-f])/pack("C", hex($1))/eg; push(@cook,$_); } return (@cook); }
以下は、OTRSというパッケージのソースコードに含まれる正規表現（置換）ですが、 どのような解釈がなされるのでしょうか？ s{_<!--_[]_dtl:place_block:_$SubLayer_[_]_-->_}{$SubLayerString}xms; （アンダー・スコアは、実際にはスペースです） [ ]を文字集合だとすると、括弧の中にはスペースしか含まれていないので、 わざわざ括弧で括る必要がないように思えます。
変数の値と別のハッシュのキーに一致するものがあれば、ハッシュの値を別のスカラー変数に代入したいのですが、その場合のプログラム例を教えてください！
入力ファイルには AAA␣aaa␣AaAa というように文字列がスペースおきに３つ記載されている文が１行ある場合、 文の２つ目のaaaのみを変数に格納したい場合のプログラムを教えてください。 ␣は空文字です
入力ファイルには AAA␣aaa␣AaAa 改行 BBB␣bAb␣BbBb 改行 CCC␣Abc␣CcCc 改行 DDD␣.... というように文字列がスペースおきに３つ記載されていて最後は改行されている文が複数行ある場合、 文の２つ目のaaa、bAb、Abc…のみを配列に格納したい場合のプログラムを教えてください。
solaris10(x86)のOSでユーザーパスワードを自動変更するためのスクリプトを作成しています。 ※使用言語はperlでExpectモジュールを使っています。 仕様としては以下のパスワード制限を満たす文字列を自動生成し、 リストファイル(list.lst)を元にExpectモジュールを使って、 ユーザーパスワードを自動変更後に結果をファイル(result.log)へ出力します。 パスワード制限 ・アルファベット大文字小文字(1文字以上)含む ・数字を(1文字以上)含む ・記号を(1文字以上)含む ですが、実際に変更しようとすると、 稀に記号を含まないパスワードが出来てしまいます。 以下の場合は「test1」ユーザーがそれに当たります。 # cat result.log User: test1 password: 14P2YiZy User: test2 password: @u1iXr%q User: test3 password: EQ2t6H(6 rand関数の使い方が良くないのか、 正常に記号部分の配列にpushされていないのか、 正直お手上げです。 以下にスクリプトの内容を記載しますので、 記号含むパスワードを自動生成するにはどうしたらよいか、 どなたかアドバイス頂けませんでしょうか。 宜しくお願い致します。 #-------------------------------- #!/usr/bin/perl -w use strict; use File::Copy; use Expect; ##### password configuration ##### my $lng = 8; #Length my $num = 1; #Number (0=disabled, 1=enabled) my $cap = 1; #Upper (0=disabled, 1=enabled) my $sml = 1; #Lower (0=disabled, 1=enabled) my $mark = 1; #Symbol (0=disabled, 1=enabled) my ($sec, $min, $hour, $mday, $mon, $year, $wday, $yday, $isdst) = localtime(time); $mon += 1; $year += 1900; ##### Variable initialization ##### my $ps; my @words; ##### log files ##### my $LGFILE = 'result.log'; my $LGFILE_OLD = "result.log.${year}${mon}${mday}"; ##### file list PATH ##### my $file='list.lst'; my $SADW = '/etc/shadow'; if ($num == 1) { push @words, (0..9); } if ($cap == 1) { push @words, ('A'..'Z'); } if ($sml == 1) { push @words, ('a'..'z'); } if ($mark == 1) { push @words, ('#', '$', '%', '(', ')', '-', '=', '^', '~', '|', '@', '`', '[', ';', ':', '+', '*', '/', '?', '_'); } if (-e "$LGFILE_OLD"){ exit(1); } copy "$SADW", "$SADW.${year}${mon}${mday}" or die "Copy failure $!"; chmod(0400, "$SADW.${year}${mon}${mday}"); if (-e "$LGFILE"){ move("$LGFILE", "$LGFILE_OLD"); chmod(0400, "$LGFILE_OLD"); } open(F, "<$file") or die "Cannot open $file: $!"; while( my $line = readline F ){ chomp($line); open(IN, ">>$LGFILE"); for (my $var = 0; $var < $lng; $var++) { my $words_num = @words; $ps = $ps . "@words[rand($words_num)]"; } my $command = Expect->spawn("passwd ${line}") or die "Can't start program... $!\n"; $command->log_stdout(0); $command->expect(1, "New password:"); print $command "$ps\n"; $command->expect(1, "Re-enter new password:"); print $command "$ps\n"; print IN "User:\t${line}\n"; print IN "password:\t${ps}\n"; $command->soft_close(); undef $ps; chmod(0400, "$LGFILE"); close(IN); } close(F); exit(0); #--------------------------------
エクスプローラからPerlを起動する際のカレントディレクトリが、Windows 7 (x64) と Windows XPで違ってしまいます。 Windows XPの場合は起動した.plファイルの場所がカレントディレクトリとなり、特に問題はないのですが、Windows7の場合 C:\Windows\System32 がカレントディレクトリになってしまうようです。 以下の前提条件で、Windows 7 でも XPと同様の動作を実現する方法はないでしょうか。 [起動方法] .plファイルを右クリック ⇒「プログラムから開く」⇒ Perl Command Line Interpriter （既定のプログラムはメモ帳に設定） [環境] Windows (7 x64 or XP) + ActivePerl 5.14.2
入力ファイルには英文で例えば、 Mr. Obama concluded in his first year that the Bush-era dream of remaking Afghanistan was a fantasy, and that the far greater threat to the United States was an unstable, nuclear-armed Pakistan. So he narrowed the goals in Afghanistan, and narrowed them again, until he could make the case that America had achieved limited objectives in a war that was, in any traditional sense, unwinnable. “Just think how big a reversal of approach this was in just two years,” one official involved in the administration debates on Afghanistan said. “We started with what everyone thought was a pragmatic vision but, at its core, was a plan for changing the way Afghanistan is wired. We ended up thinking about how to do as little wiring as possible.” The lessons Mr. Obama has learned in Afghanistan have been crucial to shaping his presidency. Fatigue and frustration with the war have defined the strategies his administration has adopted to guide how America intervenes in the world’s messiest conflicts. Out of the experience emerged Mr. Obama’s “light footprint” strategy, in which the United States strikes from a distance but does not engage in years-long, enervating occupations. That doctrine shaped the president’s thinking about how to deal with the challenges that followed — Libya, Syria and a nuclear Iran. というように長文があるとして、前半の10％と最後から10％の文だけをファイルに出力するプログラムを教えてください！
WindowsXP、IE8の環境でIIS(Ver5.1)を使っています。 PerlでXML::FeedPPを使って半角英数字のみのRSSアドレスならば 取得して出力することはできていますが、漢字・全角のアドレスの場合は どうしてもエラーになります。 (Loading failed: http://サンプル.com/?feed=rss at C:\Inetpub\wwwroot\main_rss\cgi-bin\test.cgi line 16) ※上記の「サンプル」は例です。 漢字のあるURLの取得できるライブラリはあるのでしょうか? (use XML::RSSが有効なのでしょうか?) よろしくお願いします。
ファイル１には 英文 I will go by car to the airport. I bought prior to boarding a plane to and snacks. //改行 Upon arrival at Los Angeles International Airport, was not able to go to the local tourist hit by heavy rain. ... のように英文が数十行記載されています。 ファイル２には Car car level1 Airplane airplane level1　　 Snacks 　snacks level2 ... EOS Upon upon level3 ... というように、第一引数に単語、第二引数に小文字の単語、最後にレベル（あまり意味をなさない・・・）が記載されているとします。EOSは改行です。 ファイル３には car : 3 airplane : 1 snacks : 1 というように予めファイル１の中での各単語の出現回数をカウントしたテキストとなります。 この三つのファイルをもとに、 まずファイル２を読み込んでファイル２内の第二引数とファイル３の単語で同じものがあれば、カウント変数に出現回数（ファイル３内の数値）を加算することを繰り返し、それをＥＯＳの行になるまで繰り返し、ファイル１での該当の行と、ＥＯＳまでの出現回数を出力し、その都度、出現回数の多い順に文をソートするプログラムを教えてください。 結果例 1　：　　１２３　　:　I will go by car to the airport. I bought prior to boarding a plane to and snacks. 順位：出現回数：文
コマンドライン引数で　入力ファイルからデータ受け取って結果を出力ファイルに書き込みたいのですが、プログラムは #!/usr/bin/perl while ( <> ) { @words = split(" "); $wc{@words[0]} += 1; } foreach $key (keys %wc) { print "$wc{$key} $key\n"; } で今のコードでは、コンソールに出力されるだけとなってしまいます。 ファイル入出力を行うにはどうすればいいですか？
Windows7上にインストール済のActivePerlへ 「XML::LibXSLT」モジュールを 追加でインストールする方法を教えてください。 （ちなみに、以前に、XML::LibXML;はインストール済であり、 　今も正常に動いているのですが、 　以前と同じ方法 　　↓ コマンドライン上から、 ppm-shell upgrad -i install XML::LibXSLT を実行すると、 ”ppm install failed: Can't find any package that provides XML::LibXSLT” エラーメッセージが出て、 インストール出来ない状況です。 なお、Windows7内に対して、 libxslt（xsltprocツール）をインストールして、 xsltproc --version を実行すると正常にバージョン内容が表示されている状況です。 しかし、 Eclipse3.6の、Perlソース内、 「use XML::LibXSLT;」 行のみ、 ×印の赤丸印が消えない（XML::LibXSLTがインストールされていない為） 状況です。 以上になります。 よろしくお願いします。
Perlのintをつかって整数化をしているのですが、すこし挙動がおかしいというか 正確な数値が出ませんので質問させていただきました。 $aaa = 21000*0.7; $aaa = int($aaa); print $aaa; 結果：14699 となります。 21000×0.7は14700のはずかと思いますが、なぜか14699になってしまいます。 どう考えてもわからなくなってきました。 どなたかご教授いただけませんでしょうか？
Perlで、XMLのDTD内の、 たとえば以下のような 　　↓ <!ENTITY rt4 "ルーチン4"> （キー”rt4”と、値”ルーチン4”）を、 読み込むには、どうすればよいのでしょうか？ 単純にXML(DTD)をテキストファイルとしてオープンして、 正規表現などで読み込むのではなく、 この<!ENTITY～ タグを利用して、 簡単に読み込める方法があるのでは？ と思い、ネット上を探しておりましたが、 具体的な方法が見つけられなかった為、 ご質問させていただきました。 よろしくお願いします。
ウィンドウズ環境でactive perlを利用しています。 あるディレクトリーの中に2000位のファイルが入っており、このファイルを読み込んで置換処理を行うため下記のようなperlを作っています。 1ファイルはおおよそ3000行くらいです。 foreach(<*.html>) { open(IN_FILE, $_) || die; open(OUT, ">$_.tmp") || die; @record=<IN_FILE>; foreach $record (@record){ $record =~s/aaa/bbb/isg; } print OUT @record; close( IN_FILE); close( OUT); rename("$_.tmp", $_) ; } 当たり前かもわかりませんが、メモリー不足になり処理が中断します。 ディレクトリーの中のファイル数を600程度に少なくすると処理が完了します。 そこで質問なのですが、ディレクトリーの中のファィルを一度に全部読み込まず、1ファイルずつ順次読み込んでいくことはできないでしょうか。 最初の1行目のforeachをwhileに変えたりしたのですがうまくいきません。 対応策あればご教示ください。
outlook2010で作成される受信メールのデータ.pstをtext形式にして保存したいと 言われ、ツール等を探したのですが見つけることができませんでした。 もしなければ、プログラムで組みたいのですが、そのようなことは可能でしょうか？ 言語はperlを使っています。
perl cgiでまだまだわからないことだらけなので、まだ質問します・・・ print $q->start_html(-title=>"画面", -BGCOLOR=>'#ffffff'), $q->header(-charset=>"Shift_JIS"),# Content-type: text/htmlを書き出します $q->p('<body bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#ff00ff">'), $q->p('<FONT COLOR="red">aaa</FONT>'), $q->hr, $q->p('<form method="post" action="ppp.cgi">'), $q->p('<FONT color="blue">【a】</FONT>'), $q->p('<INPUT TYPE="text" NAME="mmm" VALUE="" SIZE="25" MAXLENGTH="25">'), $q->p('<FONT color="blue">【b】</FONT>'), $q->p('<INPUT TYPE="text" NAME="nnn" VALUE="" SIZE="25" MAXLENGTH="25">' $q->p('<FONT color="blue">【c】</FONT>'), $q->p('<INPUT TYPE="text" NAME="ttt" VALUE="" SIZE="25" MAXLENGTH="25">' $q->p('<FONT color="blue">【d】</FONT>' $q->p('<select name="question" size="1" multiple="multiple">' $q->p('<option selected="selected" value="aaa">aaa？</option>'), $q->p('<option selected="selected" value="bbb">bbb</option>'), $q->p('<option selected="selected" value="ccc">ccc</option>'), $q->p('</select>'), $q->p('<FONT color="blue">【e】</FONT>'), $q->p('<INPUT TYPE="text" NAME="ans" VALUE="" SIZE="25" MAXLENGTH="25">'), $q->p('<FONT color="blue">【f】</FONT>'), $q->p('<textarea name="freeans" rows="5" cols="30" value="$initText" wrap="hard">$initText</textarea>'), #$q->p('<textarea name="freeans" rows="5" cols="30" value=$initText wrap="hard">あいうえお </textarea>'), $q->p('<input type=submit value="送信">'), $q->p('</form>'),# 送信データここまで $q->end_html; としているのですが、表示のほうが 【a】 テキストボックス入力欄 【b】 テキストボックス入力欄 【c】 テキストボックス入力欄 ・・・ と、テキストボックス入力欄の上下に改行が入っていしまいます。 消す方法はございますか？pタグがダメなんでしょうか？ それとContent-Type: text/html; charset=Shift_JIS が最上部に表示されてしまいます。 　　　 　　　$q->header(-charset=>"Shift_JIS"),# Content-type: text/htmlを書き出します の行が原因だということはわかるのですが・・・・変更方法がわからないです。 教えて頂きたいです。よろしくお願いします。
perl cgiにて作成したtextarea内に初期文字列を入力しておくプログラムを組んだのですが、 その初期文字列内で改行を行いたいと思い、何種類か改行を入れてみたのですが、 うまくいきません。 $testbr = "\r\n"; print $q->start_html(-title=>"１２３", -BGCOLOR=>'#ffffff'), (中略) q->p('<textarea name="freeans" rows="5" cols="30" value=$initText wrap="hard">あいうえお"$testbr"かきくけこ </textarea>'), (中略) $q->end_html; textarea内に あいうえお(改行) かきくけこ という表示をしたいのですが・・・
CGIにセキュリティをかけたいのですが、どのように掛けたらよいのでしょうか？ SQLインジェクション対策等、調べたのですがよくわかりませんでした。 わかりやすい参考サイトや書籍がございましたら、教えてほしいです。 使用言語はperlです。
ウェブページ(charset=utf-8)からメールを送信するプログラム（Perl）について質問があります。 本文中に ---------- (1) ↓ \x{2460} ---------- と変換されてメールが届いてしまいます。 メインのCGIでは、 use utf8; を宣言しています。 utf-8のページから、CGIではパラメータを以下のように受けています。 my $query = new CGI; for my $p ($query->param) { my @v = map {Encode::decode_utf8($_)} $query->param($p); $query->param($p, @v); } my $mailtext = $query->param("mailtext"); その後、 「～（波ダッシュ）」と「－（全角マイナス）」は以下のようにを強制的に置換しました。 （これは検索して見つけることができましが、丸数字については探しきれませんでした。） $mailtext =~ tr/\x{ff5e}\x{ff0d}/\x{301c}\x{2212}/; # UTF8フラグをON $mailtext = Encode::decode_utf8($mailtext ); # UTF8からJISに変換 Encode::from_to($mailtext , "utf8", "jis", Encode::XMLCREF); としてメールを送信しています。 パラメータの受け取り方に問題があるのでしょうか？ それとも丸数字などを個別に置換する方法があるのでしょうか。 色々調べて試したりしたのですがダメでした。 すみませんが、よろしくお願いいたします。
お世話になります。Googleやｂｉｎｇなどで調べて見ましたが検討もつかず困っております。 PerlでDBIを使用し、データベースのテーブルＡに対してSelectした場合に、fetchrow_hashrefを使用しSelect結果を取得した場合に、テーブルの列名が文字ではなく文字コードが格納されてしまいます。 テーブルＡの列名はUTF-8の日本語文字になります。 以下、列名 ID｜登録者｜登録日 fetchrow_hashrefを使用した場合、以下のように返ってきます。 $VAR1 = { "\x{767b}\x{9332}\x{8005}" => '106.190.xxx.xxx', "\x{767b}\x{9332}\x{65e5}" => '2012-05-06 00:52:40.39496', 'id' => 38 }; 問題は目的のデータに対して列名（'登録日'など）で参照する事が出来ない事ですが、今のままテーブルの列名は日本語のままで回避する方法をご教授いただけないでしょうか？ hashrefを使いたい理由はテーブルの列順番が変わった場合でもプログラム上の変更を減らすために、列名にて参照したいためです。ですのでarray系の取得メソッドはなるべく使わないようにしたいです。 出来ればなぜこのようなことが起こるのか原因も含めてご教授いただけると大変助かります。。 ちなみに、データベースはPostgreSQLの8.2で日本語文字に対応していることは、自分でselectなどのコマンドを叩き確認済みです。 ヒントでもかまいませんので、どうかよろしくお願いいたします。
PORT監視がしたいのですが、下記のように書くと ”NG”にならずに常に”OK”となってしまいます。 使用していないPORTを指定しても常に”OK”となります。 LAN内ではうまく動かないのですが、何か良い方法がありましたら アドバイスをお願い致します。 #!/usr/bin/perl use Net::Ping; $target = '192.168.xxx.xxx'; $ping = Net::Ping->new("tcp", 2); $ping->{port_num} = 3306; if ($ping->ping($target)) { print "OK\n"; } else { print "NG\n"; } $ping->close(); exit;
GETのbodyにbase64でエンコードされた文字列 typeにMIMEタイプ それをエンコードして出力するものです よろしくお願いします。 以下はソースコードです。 #!/usr/local/bin/perl @querystring = split (/&/,$ENV{'QUERY_STRING'}); foreach $tmp (@querystring) { ($vname,$value) = split (/=/,$tmp); $args{$vname} = &url_decode($value); } sub url_decode($) { my $url_decode_str = shift; $url_decode_str =~ tr/+/ /; $url_decode_str =~ s/%([0-9A-Fa-f][0-9A-Fa-f])/pack('H2', $1)/eg; return $url_decode_str; } print "Content-type:".$args{'type'}."\n\n"; binmode (STDOUT); $out = MIME::Base64::decode_base64($args{'body'}); print $out;
Calendar::SimpleとHTML::Templateを利用しtableタグを使ったカレンダー表示を行いたいのですが、１週間ごとに＜tr＞タグで区切るループの記載の仕方がわかりません。 見本にした他所様のbaseサブルーチンでは１週間ごとに＜tr＞タグで区切られたきれいなカレンダー表示がされますが、myplanサブルーチンでは現状＜tr＞タグで区切る部分が作られていないため、日にちの数字が１週間ごとに区切られずにずらっと横並びとなってしまっている状態です。 Calendar::Simple http://perldoc.jp/docs/modules/Calendar-Simple-1.07/Simple.pod HTML::Template http://perldoc.jp/docs/modules/HTML-Template-2.6/HTML/Template.pod baseでの表示 日月火水木金土 　　　　12345 6789101112 13141516171819 20212223242526 2728293031 現状のmyplanでの表示 日月火水木金土 12345678910111213141516171819202122232425262728293031 use HTML::Template; use Calendar::Simple; local $cal = calendar; local @caps = qw( 日 月 火 水 木 金 土 ); local @wdays = qw( sunday monday tuesday wednesday thursday friday saturday ); #&base; &myplan; exit; sub base{ print "Content-type: text/html; charset=\"utf8\"\n\n"; print qq|<table>\n|; print qq|<tr>\n|; for (my $i = 0; $i < 7; $i++) { my $cap = $caps[$i]; my $wday = $wdays[$i]; print qq|<th class="$wday">$cap</th>\n|; } print qq|</tr>\n|; foreach my $week ( @$cal ) { print qq|<tr>\n|; for (my $i = 0; $i < 7; $i++) { my $mday = $week->[$i]; my $wday = $wdays[$i]; print qq|<td class="$wday">$mday</td>\n|; } print qq|</tr>\n|; } print qq|</table>\n|; }#end base sub myplan{ for (my $i = 0; $i < 7; $i++) { my %row_data; $row_data{cap} = $caps[$i]; $row_data{wday} = $wdays[$i]; push(@loop_data, \%row_data); } foreach my $week ( @$cal ) { for (my $i = 0; $i < 7; $i++) { my %row_data; $row_data{mday} = $week->[$i]; $row_data{wday} = $wdays[$i]; push(@loop_data_3, \%row_data); } } my $template = HTML::Template->new( filename => "html_template/calender.tmpl", ); $template->param( THIS_LOOP => \@loop_data, THIS_LOOP3 => \@loop_data_3 ); print "Content-type: text/html; charset=\"utf8\"\n\n"; print $template->output; }#end myplan ##calender.tmpl <html> <body> <table> <tr> <TMPL_LOOP NAME=THIS_LOOP> <th class="<TMPL_VAR NAME=wday>"><TMPL_VAR NAME=cap></th> </TMPL_LOOP> </tr> <tr> <TMPL_LOOP NAME=THIS_LOOP3> <td class="<TMPL_VAR NAME=wday>"><TMPL_VAR NAME=mday></td> </TMPL_LOOP> </tr> </table> </body> </html>
Calendar::Japanese::Holiday を利用して以下の様な祝日判定のルーチンをテストしているのですが、なぜか#(1)あるいは#(2)のようにサブルーチン内部で値を明示してやらないと正常動作（祝日判定）しません。 そこでCalendar::Japanese::HolidayのisHolidayルーチンの方に値が正常に渡っていないのかと考え、#(3)のようなチェック用のソースを組み入れてみたりもしたのですが、$year, $mon, $dayそれぞれ正常に値は渡っていました。 どのようにすれば正常動作するようになるのでしょうか？ my %spdate = (#すでに$y、$m、$dにはそれぞれ2012、05、05と値が入っています。 'year' =>$y, 'month' =>$m, 'day' =>$d, ); $spdate = \%spdate; &check_date($spdate); sub &check_date{ my($spdate) = @_; #($spdate->{year},$spdate->{month},$spdate->{day})=(2012,05,05); #(1) #my $jpholiday = isHoliday(2012,05,05); #(2) my $jpholiday = isHoliday($spdate->{year},$spdate->{month},$spdate->{day}); if($jpholiday){ push(@error, 'It is a holidays today'); } }#end #Calendar::Japanese::Holiday #http://search.cpan.org/~kztomita/Calendar-Japanese-Holiday-0.03/ sub isHoliday { my ($year, $mon, $day, $furikae) = @_; #test #(3) print "Content-type: text/html; charset=utf8\n\n"; print "$year"; print "$mon"; print "$day"; my $holidays; if ($year == $Cache_holidays_Year && $mon == $Cache_holidays_Month) { $holidays = $Cache_holidays;# From Cache } else { $holidays = getHolidays($year, $mon, 1); return if not defined $holidays; # Cache $Cache_holidays = $holidays; $Cache_holidays_Year = $year; $Cache_holidays_Month = $mon; } return if !exists $holidays->{$day}; return if (!$furikae && $holidays->{$day} eq $FurikaeStr); return $holidays->{$day}; }#end
Perlでファイル入出力のプログラムをコーディングしたいのですが、いまいちハッシュが理解しずらく困っています。わかる方よろしくお願いします。 moto.pl の中にあらかじめ AAA aaa AaAa AAaa BBB bbb BbBb BBbb CCC ccc CcCc CCcc AAA aaa AaAa AAaa .... というように一行ずつ文字列があり、この場合では最初の大文字AAAが二つあるので、その結果を例えばsaki.plに AAA 2 ... というように出力するプログラムを教えて頂けませんか？
よろしくお願いいたします。 Perlのprint文で、&(半角の&)文字を含む 文字列を、テキストファイルに出力しようとすると、 ”undeclared entity[Ln: 37, Col: 22]” という、その&文字の箇所で、 エラーが出て、強制終了されてしまい、 そこまで（途中まで）しか、テキストファイルに出力されません。 どうすれば、Perlで、 &(半角の&)文字を含む文字列を、 テキストファイルに出力出来るようになるのかを 教えてください。 どうぞよろしくお願いいたします。
初めまして、説明がうまく伝わらないかもしれませんがよろしくお願いいたします。 同じ値がN回続いた場合、その値をすべて出力するPerlのプログラムを作成中なのですが とても長くなってしまい、スッキリとしたプログラムにしたいのです。 どうかお知恵を貸していただけないでしょうか。 現在、&&を使用してこのようになっています。 例：Aの値が5回連続して同じ値だった場合 for($i=1; $i<=1000; $i++){ 　if(@A[$i]==@A[$i+1] && @A[$i+1]==@A[$i+2] && @A[$i+2]==@A[$i+3] && @A[$i+3]==@A[$i+4]){ 　　for($j=0; $j<=9; $j++){ 　　　printf "@A[$i+$j], @B[$i+$j], @C[$i+$j]"; 　　} 　} } データはすべて数値で、スペース区切りのテキストデータです。 # ヘッダー 0.00　2.0　11.5 0.01　6.3　17.2 0.01　2.1　14.2 0.01　1.2　14.3 0.01　2.1　14.3 0.01　3.7　14.3 0.01　3.7　14.3 0.01　4.1　14.3 0.06　4.1　14.3 0.01　4.1　14.9 0.01　4.1　14.9 0.03　4.1　14.8 ・・・ 連続した値が50回、100回だった場合になるとif文の条件式が長くなってしまい その都度変更がとても大変になってしまい困っています。 どうか、よろしくお願いいたします。
お世話になります。 Perlでの正規表現について質問させていただきます。 とあるフォームに入力した値が、特定の条件を満たさない場合に エラーメッセージを表示させたいのですが、うまくいきません。 以下に条件を記載いたします。 条件 1.　小文字、半角英数字、（一部の）記号で2～32文字以内。 2.　使用できる記号は、ハイフン(-）・アンダーバー(_)・ドット(.)のみ。 3.　上記記号が使用できるのは文中のみで、先頭及び末尾には使用できない。 当方、Perl初心者でして、 解説サイト等から、見よう見まねで試してみたところ、 条件１と２は、何とか成功したのですが、 ３の記述の仕方がどうしてもわかりません。 どなたか、おわかりの方がいらっしゃれば ご教授いただけませんでしょうか。 if($FORM{"account"} ここの記述の仕方がわかりません{ $msg = '文頭・文末に記号を使用する事はできません'; &error; }
初歩的な質問なのですが、 if($test =~ /&amp;n=$in{n}&amp;/){} という正規表現は正しいのでしょうか？ $in{n}が変数になるのですが、何か"などで囲まないといけないとかありますでしょうか？ それとも別の箇所(例えば&や;）をエスケープしてやる必要があるのでしょうか？ エラーは返ってきませんが、思った行動をおこしてくれず(必ずヒットするものがあるはずなのにif節内に行ってくれない)、また、何度もトライアンドエラーできる環境下のものではなく、さらにネットで正規表現について検索しても、持っている本に羅列されている内容ばかりで、今望んでいることについて触れているページが見つからないため、みなさまのお力お借りしたく思います。 どうぞよろしくお願いします。
LWP::UserAgentでperlスクリプトから別のスクリプトを呼び出して my $val print $res->as_string; で目的の値を取得したんですが値の前半部分にhttpヘッダーが入っており これを撮り省きたいです。 データの内容はバイナリなので$valの中の改行コードを区切り文字として 配列に格納し末尾の配列の値だけ取りだそうと思っています。 それで指定した区切り文字で配列に格納する方法を調べたのですが よくわからず教えていただけないでしょうか？ phpでいうところのexplode関数みたいなことがやりたいです。
下記は、メールフォームCGIに書き込まれた日時などの情報をlog.cgiというファイルに書き出すスクリプトです。 2012/01/04 21:05:45　のような感じで、日付が刻まれるのですが、このうち月の部分がどの月に処理を行ってもいつも01になってしまうのですが、当方直し方がわかりません。 下記が実際の記載箇所です。4行目がおかしいのだと思いますが、どなたかお分かりの方、教えていただけないでしょうか。 my $path = "log.cgi"; my $ip = $ENV{'REMOTE_ADDR'}; ($sec, $min, $hour, $mday, $month, $year, $wday, $stime) = localtime(time()); my $time = sprintf("%04d\/%02d\/%02d %02d\:%02d:%02d", $year + 1900, $mon + 1, $mday, $hour, $min, $sec); my $message = $in{'メッセージ'}; $message =~ s/\r\n/ /g; $message =~ s/\n/ /g; if (open(FOUT, ">> $path")) { print FOUT "$time\t$ip\t" . $in{'お名前'} . "\t" . $in{'E-mail'} . "\t" . $message . "\r\n"; close(FOUT); } よろしくおねがいいたします。
フリーソフトのＣＧＩを利用してメールフォームを設定しましたが、うまくいきません。困っていますのでどなたか助けてください。 送信した際にこのような表示があり、確かに受信できますが、一部しか表示しません。 さくらレンタルサーバー利用です。 *は自分のアドレス Content-Type: text/plain; charset="iso-2022-jp" Content-Transfer-Encoding: 7bit MIME-Version: 1.0 To: ****@***.ocn.ne.jp From: ****@***.ocn.ne.jp Subject: HPからのお問い合わせ message = name name以外にも入力箇所がいくつもあるのに、message=とnameしか送られてきません。 ｈｔｍｌは次の通りです。 <form action="mail/mail.cgi" style="font-weight : normal;color : rgb(102, 102, 102);" method="post" enctype="text/plain"> <h3>お問い合わせフォーム</h3> <p>*は入力の必須項目です。</p> <table> <tbody> <tr> <th>お問い合わせ内容*</th> <td><textarea name="message" class="l" cols="40" rows="12"></textarea></td> </tr> <tr> <th>お名前（漢字）*</th> <td><input type="text" name="name" class="m"></td> </tr> <tr> <th>お名前（フリガナ）*</th> <td><input type="text" name="kana" class="m"></td> </tr> <tr> <th>E-Mail*</th> <td><input type="text" name="email" class="l"></td> </tr> <tr> <th>電話番号（半角）*</th> <td><input type="text" name="tel" class="l"></td> </tr> <tr> <th>FAX番号（半角）</th> <td><input type="text" name="fax" class="l"></td> </tr> </tbody> </table> <input type="submit" value="　　送信　　" class="button"> <input type="reset"><input type="hidden" name="to" value="******"></form> <hr> ＣＧＩは #!/usr/local/bin/perl # ★ perlのパス名 # ★ 送信先メールアドレス $mailto = '******'; # ★ サブジェクト(件名) $subject = 'HPからのお問い合わせ'; # ★ メール送信コマンド $mailcmd = '/usr/sbin/sendmail'; # ★ -fオプションの有無 $usefoption = 1; # ★ 送信結果メッセージ(ヘッダ) # <<END_OF_DATA ～ END_OF_DATA の間を好みにあわせて変更してください。 $header = <<END_OF_DATA; <html> <head> <meta http-equiv="Content-type" content="text/html; charset=Shift_JIS"> <title>メール送信結果</title> </head> <body> <h1 style=\"color:#36f;font-size:14px;\">メール送信結果</h1> <hr> <p>下記内容でメールを送信しました。ありがとうございました。</p> <hr> END_OF_DATA # ★ 送信結果メッセージ(フッタ) # <<END_OF_DATA ～ END_OF_DATA の間を好みにあわせて変更してください。 $footer = <<END_OF_DATA; <hr> <a href="../index.html">[戻る]</a> </body> </html> END_OF_DATA #==================================================================== # 自己診断機能。 #==================================================================== # メール送信がうまく動作しない時に、 # http://～/～/wwwmail.cgi?test の形式で呼び出してください。 if ($ENV{'REQUEST_METHOD'} eq "GET") { print "Content-type: text/html; charset=Shift_JIS\n"; print "\n"; print "<html>\n"; print "<head>\n"; print "<title>WwwMail自己診断</title>\n"; print "</head>\n"; print "<body>\n"; print "<p>CGIは正常に動作しています。</p>\n"; unless (-f $mailcmd) { print "<p>$mailcmd がありません。</p>\n"; } unless (-x $mailcmd) { print "<p>$mailcmd が実行可能ではありません。</p>\n"; } unl
perlは何個かプログラムを作ったことがあるのですが、 本当に単純なものしか作ったことがない初心者です。 CSVを読み込んで、そのCSVを元に、あるURLにアクセスし、 そこで取得した特定のデータを書き出すということを行いたいのですが、 どのようにしたら実現できるのでしょうか。 お手数ですがご教授ください。 ---------------- 【持っているCSVデータ】 　　A　　| 　　B　　｜　　C　　　　｜ 　　１　　| テキスト｜テキストｘｘｘ｜ 　　２　　| テキスト｜テキストｙｙｙ｜ 　　３　　| テキスト｜テキストｚｚｚ｜ 【１行づつ以下のようなURLにアクセス】 http://www.abcd/テキストｘｘｘ 【表示されると以下のようなXMLが返ってくる】 <result> <version>1</version> <text>タイトル</text> <coordinate> <main_id>14231245234</main_id> <div>テキストテキストテキスト</div> </coordinate> <needs_to_verify>yes</needs_to_verify> </result> ↑ １行づつCSVを読み込んで、 ここのmain_idを一行づつテキストデータに書き出したい。 ---------------- perl でファイルを読み込んだり書き出したりすることは出来るのですが、 URLにアクセスして、 特定のタグに含まれるもののみを書き出すというやり方がわかりません。。 お手数ですがどうぞよろしくお願いいたします。
0 1 2 3 4　　　　　 9 8 7 6 5 6 5 4 3 2 7 8 6 9 2 8 0 9 8 1 　　↓ 0 1 2 6 4 9 8 7 3 5 6 5 4 9 2 7 8 6 8 2 8 0 9 最初の行のひとつの数字(左から４つ目：3)を抜いて、行をずらしたいのですが、つまづいています。 open (IN,"< $ARGV[0].csv") or die; open (OUT,"> $ARGV[0]_out.csv") or die; ####################################################### while($line =<IN>){ ($a, $b, $c, $d, $e) = split(/\s+/,$line); if($d == "3"){ $d == "" } print OUT (////////\n); } 分割してから、３を抜いてずらしたいのですがうまくいきません。 お助けいただきたく、どうぞよろしくお願い致します。
Perlで書いているCGIで、 HTTP リクエストヘッダのIf-Modified-Sinceを取得したいのですが、 %ENVには入ってこないようです。 取得する方法があれば、教えて下さい。 ・.htaccess にSetEnvなどで記述することでできそうですが、方法が分かりません。 ・HTTP Request Header 全体を取得する方法でも結構です。 よろしくお願い致します。 環境は、さくらインターネットのレンタルサーバーのApacheです。
お世話になります。 サーバー会社のトラブルで移転しなければならなくなったのですが、 移転後、cgiの挙動がおかしくなってしまいました。 バージョンperl5.8.8 サーバーOS CentOS なぜかperlのパスに-wをつけないと500のエラーになってしまう状態 #!/usr/local/bin/perl -w print "Content-type: text/html\n\n"; print "test"; これだけのスクリプトでも -wをつけないと500エラーになってしまいます。 -wをつけると動作します。 以前、稼働していたcgiもすべて-wをつけないと稼働しなくなってしまいました。 考えられる原因はどのような事がございますでしょうか。 （root権限のある専用サーバーとなります） 四苦八苦しているのですが、どうしても解決できない為、何卒宜しくお願い致します。 他に必要な情報などございましたらご指摘いただけますと幸いです。
perl で XML::LibXML モジュールを使用して下記のようなXMLのテキスト部分の置換をしようとしています。 <item id="1"> <name>hoge</name> <description> テスト<b>テスト</b>テスト </description> </item> <item id="2"> <name>hoge2</name> <description> テスト2<i>テスト2</i>テスト2 </description> </item> これに対して、 for $node ($dom->findnodes('//item/description/text()')){ $text = $node->toString; $text =~ s/.../.../; $node->setData($text); } のように置換する処理を考えたのですが、description の中に <b> や <i> のようなインライン要素があると正しく置換、書き戻しがされません（置換対象は、これらインライン要素の中にも外にもあります）。 これをなんとか正常に動作させる方法はあるでしょうか。 どうぞ、よろしくお願いいたします。
アクセスされた際の端末の画面サイズ取得方法について教えてください。 私の調べた限り、携帯以外では直接サイズを取得できる環境変数もないようなので、その他の方法としてJavascriptを使用して画面のサイズを取得するのが一番かなと思いました。 そこで色々検索したところ、perlで使用された変数をJavascriptで使用するといった内容のページはいくつか見つかったのですが、逆に、Javascriptで取得した変数をperlで使用する方法がなかなか見つかりませんでした。実際そのような事が出来るのかも分かりません。。。 locationで変数を送ればとも思いましたが、今回の場合訳があってlocationが使えないので、その他の方法で何かないかと…。 どなたかそのような方法について分かる方は教えていただけないでしょうか。 出来れば詳しく書き方なども教えていただけるとありがたいです。 よろしくお願いします。
Perlをいじって２日の者です。 WindowsVistaを使っております。 現在renameを使ってファイル名を変更しようとしています。 現在のファイル名がIDだけで、 Web上にあるそのIDに対応する情報をファイル名に追加しようとしています。 Web上の情報を取得するまではできたのですが、 変数に入れたその情報を、ファイル名に入れようとすると文字化けします。 ただ、その情報をコマンドプロントで扱う時も、テキストへ出力してみても文字化けしません。 文字化けは、文字コードなるものが原因らしいということで、 とりあえずよく見かける「UTF-8」というものにエンコードしてみたところ、 テキストへの出力が、ファイル名へのそれと同様に文字化けしました。 エンコードした上でファイル名に入れようとすると 情報のそのものがないものとして扱われるようになりました。 これはどう解釈すればいいのでしょうか？ どうすれば文字化けを解決できるでしょうか？
Pealでメルマガシステムを作って運用してました エラーメール処理をしたいのですが ユーザーがいない場合などに自動的に削除したいと思います どういう風に作ればよいのか分かりません あればぜひ教えてください
Perl初心者です。 perlで簡単なソフトを作り、時々変化する情報をテキストファイルから読み込むようにしています。 昔は、Shift-jisでしたが、文字化け対策が嫌になり、UTF-8に統一しました。 皆様は、何を使われていますでしょうか？ また、読み込みや出力には、そのファイルの文字コード指定していますか？ 質問させていただいた動機について（無駄に長いです） 最近パソコン初心者の友達へ、プログラムを作ってあげたのですが、どうもうまく動かない。 設定ファイルに書いてある内容が何か合わないようです。 色々試行錯誤して、3日ほど悩んだ結果、相手のパソコンで編集（Vista）すると、BOMというものが付くことが分かり、とりあえず、それを削除することで無事動作致しました。 UTF-8であれば、文字コードなど気にせず万能だと思っていたのですが、これだけ悩まされると、UTF-8以外の方にもっと良い方法があるのではないかと思い質問させていただきました。
perl　初心者です。 Perlでリモートログイン後grep結果を取得する方法で分からないことがあり質問しました。 rootユーザで実行するPPP.plスクリプト内で、他のサーバにsshでログイン後grepの結果を取得しようと考えていますが、rootユーザでPPP.plを実行しスクリプト内でsshを実行するとパスワードを聞かれてしまいます。 そこで、他のユーザAAAでPPP.plを実行し、sshを実行するとパスワードは聞かれない設定になっているそうです。（詳細は分かりませんが） そこで、実現方法について下記のように考えていますが、他の方法、sshのオプション等他の考えが、あれば教えてください。確認する環境がなくて実行していませんのであっているかも分かりません。 PPP.pl実行サーバ：server1 ssh先のサーバ：server2 PPP.plの実行ユーザ：ROOT パスワードが聞かれないserver1のユーザ：AAA server2のログインユーザ：AAA ※PPP.plの実行ユーザはrootから変更はできません --------------------------------------- #ユーザAAAに変更 system("su - AAA"); #server2のgrep結果取得 my @rtn_grep = `ssh -l AAA server2 grep test /var/log/msg.log`; if($? != 0){ exit; } ## grep結果を参照 XXXX #rootユーザに戻る system("exit"); -------------------------------- 以上です。宜しくお願い致します。
こんにちは！　Perlの漢字コード(UTF8)の扱いについて詳しい方，おしえていただけないでしょうか？ 数年前に自作した，ファイル加工用のシェルスクリプトを久しぶりに取り出してみたら，訳が分からなくなってしまいました。 シェルスクリプトは，大きなファイル(文字コードはUTF-8)の中から特定の表現を削って小さくする物で，例えば次のような行が並んでいます。 perl -pe 's/\343\200\220\.*?\343\200\201//g' | \ 困っているのは，文字コードをどうやって決めたか思い出せない点にあります。 新しい記述を足したいのですが，文字コードの指定の方法をすっかり忘れているのに気付いて，呆然としているところです。 以前はネット上にある，どこかのエンコーダーを使ったように記憶していますが。 うまく見つけらずにいます。 ご存じの方，ご教示いただけると大変ありがたいです。。 （試行錯誤して，UTF-8の16進6桁の漢字コードから，2桁ずつとって10進に直す，のは違うらしいことが分かりました。(;^_^A)
お世話になります。 perl5でLWPを使用しているのですが、一部のサイトでデータを取得できず困っております。 具体的には my $ua = LWP::UserAgent->new; $ua->agent('Mozilla/5.0'); my $req = HTTP::Request->new(GET => "http://misshiki.blog7.fc2.com/?xml"); my $res = $ua->request($req); my $buf = $res->content; といった感じでＲＳＳを取得したいのですが、$bufが空になってしまいます。 しかし、 $res->as_string とすると、レスポンスヘッダも含めてＲＳＳが取得できていることが確認できます。 また、上記以外のＵＲＬでは正常に$res->contentでデータを取得することができています。 どうもＦＣ２ブログのＲＳＳのみの事象のようではあるのですが、対処方法がわからず困っております。 対策をご教授いただければ幸いです。 以上、よろしくお願いいたします。
formで送られてきたデータは全てハッシュinで整理しています 様々なデータの中に、$in{way_1}, $in{way_2}.....というかたちでformから送っているものがあるのですが、それぞれにvalueがあるのか分からないので、ループをかけて検証したいと思っています if($in{way_1}){ push(@ok, "1"); } if($in{way_2}){ push(@ok, "2"); } ..... とやれば話は早いですが、way_がいくつまであるかが状況によって違うため、最大値までループで確認したいと思っています そこで次のようにやってみましたが、うまくいきません my $i = 1; while($i <= $max){ if($in{way_$i}){ push(@ok, $i); } $i++; } Internal Server Errorが出たのですが、おそらくハッシュのキーの中の一部に変数を入れたがためだと思われますが、これに変わる検証方法はないでしょうか？ ちなみにあたりまえですが、次のようにやってみても、単なる文字列として認識されてしまうので、うまくいきませんでした my $i = 1; while($i <= $max){ $temp = '$in{way_'.$i."}"; if($temp){ push(@ok, $i); } $i++; }
現在以下のURLで正常に表示しています。 http://hoge.jp/i.cgi?id=a これを http://hoge.jp/i.cgi?a で表示させたいと思うのですが、ウエブで調べましたら「METHOD=GETで渡す」方法が現在のやり方 で「コマンドライン引数で渡す」方法に変えたいのですが、perlの記述がいまいちわからず迷ってます。 プログラムはファイルを読み込んで if ("$idno" eq "$id") のこの$idの条件式でヒットさせているものになります。 変数記述等アドバイスいただけますと助かります。 うまく説明できずすみません。 よろしくお願いいたします。
アクセス端末によって見え方を変えさせるため、条件節ifで =~ を使って分岐させているのですが、ユーザーエージェントがあまりにも多く、コードが長くなりすぎ制作に支障が出てきています 100%完璧に分岐させるところまでは求めていないため（アクセスの95%程度うまく分けられればいいかと思ってます）、たとえばスマホの場合はiPhoneとかAndroid、PCの場合はMSIEなど極力共通の部分を見つけてまとめてはいますが、それでも携帯、スマホ、ＰＣと分けると非常に多くなり、 if(($ENV{'HTTP_USER_AGENT'} =~ /MSIE/) || ($ENV{'HTTP_USER_AGENT'} =~ /Firefox/)){} など比較の片方は同じなのに同じことを何度も書く必要があり、非効率かつ強烈に長くなってしまい何とかまとめられないかと格闘しています たとえば別で $os_pc = "MSIE,Firefox"; $os_mb = "DoCoMo,KDDI"; など別でまとめて、 if($ENV{'HTTP_USER_AGENT'} =~ /$os_pcの,で分解したそれぞれの文字列と比較/){ ＰＣと判定 }elsif($ENV{'HTTP_USER_AGENT'} =~ /$os_mbの,で分解したそれぞれの文字列と比較/){ 携帯と判定 } といったように、スマートに条件分岐させられないかと模索中ですが、=~ で別で用意したデータを,で分解してそれぞれと比べるとかできないでしょうか。 =~での比較ではなく、他の方法でもかまいませんので、ぜひお知恵をお貸しください。 よろしくお願いします。
Perl 初心者です。初めて質問します。 test_sub.pl で宣言した変数を test_main.pl から参照したくて悩んでいます。 環境 ： WindowsXP / ActivePerl 5.14.2 -------------------- * test_sub.pl -------------------- #!/usr/bin/perl use strict; our $hoge = 'HOGE'; 1; -------------------- * test_main.pl -------------------- #!/usr/bin/perl use strict; require 'test_sub.pl'; print "Content-type: text/html\n\n"; print $hoge; -------------------- これを実行すると、 Global symbol "$hoge" requires explicit package name at C:/public_html/cgi-bin/test_main.pl line 7.\r というエラーが出ます。 require する前に、test_main.pl のほうで our($hoge); と宣言したり 参照する際に print $main::hoge; とパッケージを指定したりすればいけるのですが、 これらをしないとできないものなのでしょうか。 use strict; を書かなければ最初のソースでも動くのですが use strict は書きたい… 継承のようなことをしたいのです。 ちなみに以下試してみたソースです。 -------------------- * test_main.pl -------------------- #!/usr/bin/perl ######################################## # NG use strict; require 'test_sub.pl'; print "Content-type: text/html\n\n"; print $hoge; ######################################## # OK our変数を宣言しておくといける =pod use strict; our ($hoge); require 'test_sub.pl'; print "Content-type: text/html\n\n"; print $hoge; =cut ######################################## # OK 参照する際にパッケージ名を指定すればいける =pod use strict; require 'test_sub.pl'; print "Content-type: text/html\n\n"; print $main::hoge; =cut ######################################## ######################################## # NG =pod use strict; use base qw(test_sub); print "Content-type: text/html\n\n"; print $hoge; =cut ######################################## -------------------- * test_sub.pm -------------------- #!/usr/bin/perl package test_sub; use strict; our $hoge = 'HOGE'; 1; -------------------- NG パタンはどちらも Global symbol "$hoge" requires explicit package name のエラーとなります。 もしご存じの方がいらっしゃいましたら教えてください。 よろしくお願いします。
投稿すると自動的にその投稿に対して記事番号なるものが割り当てられ、 その記事番号と自分で投稿時に決めた削除パスワードで 自分の投稿を削除する形式の掲示板なのですが パスワードや記事番号が入力されていない場合には 〇〇〇が入力されていませんと表示されるにもかかわらず 存在しない記事番号が入力して削除しようとすると 「正常に削除いたしました」と表示されてしまいます。 （実際には存在しない記事番号なので何も削除されていないのですが） そこで下記のようにの＃～＃の部分を追加で記述し、 記事番号が存在しない場合にエラーとなるようにしてみたのですが これで本当にいいのか正直不安なのです。 正しいかチェックしていただけませんか？ @new=(); open (IN,"$file") || error("システムエラー","ファイル「$file」を開くことができません。"); while($data = <IN>) { $flag=0; ($no,$res,$date,$cntr,$email,$tall,$weight,$age,$sub,$com,$live,$select,$photo,$pw) = split(/<>/,$data); if ($FORM{'pass'} eq "$ad_pass") { foreach $del (@DEL) { if ($no eq "$del") { $flag=1; last; } } } else { if ($FORM{'del'} eq "$no") { if (!($pw)) { &error("入力エラー","指定された記事には削除キーが設定されていません。"); } if (crypt($FORM{'pass'},$pw) ne "$pw") { &error("入力エラー","パスワードが間違っています。"); } $flag=1; } #記事番号が存在しない時、エラーを表示追加 if ($FORM{'del'} ne "$no") { if (crypt($FORM{'pass'},$pw) ne "$pw") { &error("入力エラー","記事番号が存在しません。記事番号を確認して入力し直してください。"); } } #ここまで } if ($flag == 0) { push(@new,$data); } } close (IN);
素人で大変申し訳ございません。 他の人が作ったPerlを改良しようと思っております。 仕様は、csvのカンマからカンマの間に入っている 文字を取得するというのですが、 英数字の場合は、正常に取得できるのですが、 半角ひらがなが入ると文字の取得ができません。 下記の$outputで、私が必要な情報を得ようと思っているのですが、 下記の右辺をどのように変えれば、半角ひらがなも取得できるでしょうか？ $output =~ s|/\*\s(([A-Z0-9_])+)\s\*/|$D->{$1}|g; ※エンコードが必要でしたら、utf-8を使いたいと思っています。 一部分の大変失礼な質問と思いますが、何卒よろしくお願い致します。
投稿を削除した際に 管理者パスワードで削除されたのか それとも投稿者が設定したパスワードで削除されたのか 追加で削除ログに記録したいと思ってます。（削除ログはすでにあります） 削除パスワード入力フォームを$FORM{'pass'}とし、 管理者パスを$owner_pass 投稿者が設定した削除パスワードを$pw とした場合、どっちのパスが使われたのか分かるようにするには どのように記述したらいいのでしょうか？ 管理者パスが使われたら管理者、 投稿者パスなら投稿者と削除ログに記録したいのですが、 いろいろやってみたのですがなかなかうまくいきません・・・。
QRコードを生成してファイルに保存するプログラムを作っています。 ファイルハンドルをオープン時にエラーがでます。 open OUTFILE, '>', 'C:\inetpub\wwwroot\test.jpg' or die "$!"; # ここでエラーがでます。 binmode OUTFILE; print OUTFILE $qrimg->plot->jpeg; close OUTFILE; エラーメッセージは 「指定された CGI アプリケーションは、正しく動作しませんでした。HTTP ヘッダーの完全なセットが返されませんでした。返されたヘッダーは "Permission denied at C:\inetpub\wwwroot\cgi-bin\qr.cgi line 24. " です。」 です。 環境は Windows 7 / IIS 7.5 / ActivePerl 5.14.2 です。
さくらのレンタルサーバーのcpanmで、 JSONだったりUnicode::RecursiveDowngradeといったモジュールは入るのですが、 Email::Senderなどのモジュールがうまくインストールできないです。 --forceオプションも試してみたのですが、やはりうまくいきません。 どうか解決策をご教授ください。よろしくお願いします。
■1.下記の1.cgiからURLに引数として 1.cgi?hoge=●● で2.cgiにhogeの値を送ります。 2.cgiでhogeの値を受け取り、 テンプレートファイルを表示の際に下記のように、 ファイルのパスに取得したhogeを指定しようと思いますがうまく動作しません。 具体的な指示の仕方をご教示いただけないでしょうか？ 宜しくお願いいたします。 my $hoge1 = '../../htdocs/●/●/●/'; my $hoge_2 = $hoge; my $hoge_ok = '$hoge1/$hoge2'; $template = $hoge_ok;
WEBサイト製作初心者のものです。 Perlで作られたフリーの掲示板をダウンロード、 借りたレンタルサーバーにcPanelをつかってCgi-bin にアップロード。 このようにすれば、レンタルサーバーにアクセス、 Index of のcgi-binを選択すれば、掲示板が表示されるはずですが ４０３　アクセス権のエラーと表示されてしまいます （cPanel付属のCRMソフトはインストール後Index ofから選択すれば正常に表示されます） 3つの条件 Perlのバージョン、アップロード先ディレクトリ、 フォルダごとのパーミッション設定は、推奨設定どおりになってます。 どうしてこのエラーが出るのでしょうか？
文字列 $a に、文字列 $b が含まれているかどう確認したいと思っています。 $a = "abcdefg"; $b = "cde" なら「真」としたいです。 （要するに、シェルの case や fgrep に似たことをしたい） ただし、文字列には記号が含まれている可能性もあるため、 正規表現も使いづらい（？）です。 具体的にやりたいことは、$a にはコンマ区切りのメールアドレスのリストが入っていて、 $b のメールアドレスが $a のリストに含まれていない場合のみ、$b を $a似追加すると いうことがやりたいです。 何か良い方法はないでしょうか？ よろしくお願いいたします。
BBSを改変したエントリーフォームで、 アンケート付のイベント参加集計をしています。 設置者が居なくなってしまったため引き継いでいるのですが、 力不足で行き詰まっています。お力をお貸し下さい。 1.現状 入力項目は50個ほどあり、データファイルには、 1行目にデータ項目、2行目以降に入力データが追加されていきます。 例）データ形式 申込日時,イベント名,,,,受理番号,,その他(改行） 20120117,ハイキング,,,,20120505001,,特になし(改行) 2.やりたいこと 管理の都合上、受理番号を発行させたいのですが、 既参加者に発行した受理番号の最大値の取得方法が分かりません。 受理番号はイベント毎に初期値を設定し、連番にしていきます。 例）1人目…20120505001　(初期値) 　　2人目…20120505002　（上8桁の20120505をイベントコードとし、下3桁が連番） 受理番号項目が入力項目50個の45番目にあったとして、 1人目はあらかじめ設定してあった初期値を入力、 2人目以降は受理番号の最大値をはじき出し、最大値+1を入力 という処理をしたいのです。 ※受理番号の入力位置は45番目がベストですが、 処理が複雑になるようなら、先頭でも末尾でもかまいません。 よろしくお願いします。
表示したい数字が１桁もしくは２桁でHTML表示を等幅指定で合わせたいので 数字を１桁なら半角、２桁以上は全角にしたいと思っています。 下のように記述して、思い通りの動きはしているのですが もう少しスマートに記述できればと思い質問させていただきます。 みなさんなら、どう記述するか、ご教示ください。 $no = 1; # １桁の場合、半角から全角にする if ($no == 0) { $no2 = "０"; } if ($no == 1) { $no2 = "１"; } if ($no == 2) { $no2 = "２"; } if ($no == 3) { $no2 = "３"; } if ($no == 4) { $no2 = "４"; } if ($no == 5) { $no2 = "５"; } if ($no == 6) { $no2 = "６"; } if ($no == 7) { $no2 = "７"; } if ($no == 8) { $no2 = "８"; } if ($no == 9) { $no2 = "９"; } if ($no >= 10) { $no2 = "$no"; } print "$no2";
現在サイトを開設しているのですがそこのTOPページで下記のRSSリーダーを利用し外部サイトのRSSを読み込んで表示させたいのですが、なかなか上手くいきません。詳しい方なら何か分かるのではと思ってのでこちらで質問します。 http://www.candy-cgi.com/perl/RSS_reader_Type1.html 一度PHPのスクリプトは設置した事あるのですが、Perlは初めてです。 サーバーはロリポップでコロリポプランです。 私がやった事は (1)上記のサイトからスクリプトをダウンロードしてきて解凍し、index.cgiを開いて設定箇所を変更しました。 パスはサーバ指定のパスと同じだったのでいじっていません。 表示させたいファイルと同じディレクトリに上記サイトからダウンロードしてきた『RSS』というフォルダがありその下にindex.cgiやlog.cgi、style.cssのファイルがあります。 (2)表示させたいファイル(index.shtml)に下記のソースを記述。 <iframe src="./rss/index.cgi" title="rss" scrolling="yes" width="500" height="100"> <a href="http://www.candy-cgi.com/">CANDY CGI</a> </iframe> (3)サーバーにアップロード。 パーミッションを設定。 これで確認してみると500エラーになっています。 このスクリプトはJcode.pm、FeedPP.pmを使用するらしいのですが、これがサーバで用意されてるのかはどこで確認すればいいのでしょうか？ロリポップの掲示板で初めから用意されてるような回答があったので準備はしていないのですが。 表示させたいページがSSIを使用しているから？とか、.htaccessファイルに記述しているのが引っかかっているのか？とかフォルダにもパーミッションを設定しないといけないのか？など素人なりに考えたのですが皆目見当もつきません。 ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
スミマセン。基本だと思いますが、教えてください。 Joyful系の掲示板のファイルなのですが、 各記事の親記事にある特定のデータを、 取り出す方法を教えて下さい。 5<>IP<>1234567890<> 3<><>2012/01/12(Thu) 08:42<>ウサギ<>Yahoo<> 5<>3<>2012/01/12(Thu) 09:04<>ネコ<><> 1<><>2012/01/12(Thu) 08:41<>イヌ<>Google<> 2<>1<>2012/01/12(Thu) 08:41<>ウサギ<><> 4<>1<>2012/01/12(Thu) 09:03<>タヌキ<><> こんな感じで、データが記入されるdatファイルがあります。 「１のレスが２・４」「３のレスが５」です。 それで、親記事に「Yahoo」や「Google」というデータが入っているので、 親記事１にレスしてる２・４でも、 親記事に入ってる「Google」といった文字を反映したいのです。 うまく伝えられ無いので、画像にしてみましたので見てやって下さい。 私が見てるプログラムでは、 レスはレスで、「Google」等の文字を探してしまっているので、望む形にならないのです； どうぞ、よろしくお願いします！ ↓ざっくり。この辺りの最初の方に、親だけ読み込んで、＄search1　とかに、セットできないかと考えています。 ★━━━━━━━━━━━━━━━━━━━━★ local($ipt,$wh,$i,$flag); # 記事を展開 open(IN,"$logfile") || &error("Open Error : $logfile"); $top = <IN>; $i=0; $x=1; $flag=0; # ソート無し：必要最小限だけ読み込み if(!$sort && !$threadsuu){ while(<IN>){ if((split(/<>/))[1] eq "") { $i++; } if ($i < $page + 1) { next; } if ($i > $page + $p_log) { next; } push(@DATA,$_); } } # ソート無し、スレッド表示有り elsif(!$sort && $threadsuu){ @DATA = <IN>; } # ソート有り：全データを読み込んでソート実行 else{ @DATA = <IN>; if($sort == 1){ &ressort; } if($sort == 2){ &nosort; } } close(IN); # 新着スレッドを表示 if($threadsuu || $up_down){ &thread; } # レスの表示制限をする場合には、配列を改造 if($max_res){ &omit; } foreach(@DATA){ ($no,$reno,$date,$name,$mail,$search) = split(/<>/); # ページ処理 if($sort || $threadsuu){ if ($reno eq "") { $i++; } if ($i < $page + 1) { next; } if ($i > $page + $p_log) { next; } } if (!$reno && $flag) { print "</td></tr></table><br><br>\n\n"; $flag=1; } if (!$reno) { print "<table class=\"table1\" align=\"center\" cellspacing=0 cellpadding=2>\n<tr><td>"; $flag=1; } if ($reno && $line_color) { print "<hr noshade size=1 width='85%' color=\"$line_color\">\n"; } print "<table width=100% border=0 cellpadding=2 cellspacing=0>\n<tr>"; if ($reno) { print "<td rowspan=2 width=40><br></td>"; } if($line_color){ print"<td>"; } elsif($reno){ print"<td class=\"b2\">"; } else{ print"<td class=\"b1\">"; } if (!$reno) { print "<span class=\"sub\"> <font color=\"$t_color\"><b>$sub </b></font></span>";} else { print "Re:<font color=\"$t_color\"><b>$sub </b></font></span>";} if($search == "yahoo"){ print "投稿者：<span class=\"name\">$name</span>　yahooで検索";} elsif($search == "google"){ print "投稿者：<span class=\"name\">$name</span>　Googleで検索";} else{ print "投稿者：<span class=\"name\">$name</span>　その他で検索";}
データの文字数を一定の数字で省こうと思い下記の内容を参考にしようと思っているのですが 下記はUTF-8用なので、SJISに対応させるにはバイト列の定義を変更すれば良いのですが どのように変更すれば良いのは分かりません。 my #str = "あいうえおかきくけこさしすせそ"; # 元の文字列 my $view = 10; # 10文字まで表示し後は省略 print &main::round_utf8($str,$view); sub round_utf8 { my ($str,$view) = @_; my $one = "[\x00-\x7F]"; # 1バイト文字 my $two = "[\xC2-\xDF][\x80-\xBF]"; # 2バイト文字 my $three = "[\xE0-\xEF][\x80-\xBF]{2}"; # 3バイト文字 my $bigger = "[\xF0-\xF7][\x80-\xBF]{3,}"; # 4バイト以上 $str =~ s/^(($one|$two|$three|$bigger){$view}).+/$1.../g; return $str; } 私が考えているのは$****に入っている文字列を10文字以降は..で省略させることです。 アドバイスのほどをどうか宜しくお願いします。
現在perlを勉強中の身です。 1行に1英単語があり、それが100～200行に渡ってあるファイルがあります。 このファイルの単語に重複しているものはありません。Xとします。 また別のファイルにも同様に1行に1英単語があり、それが100～200行に渡ってあるファイルがあります。 このファイルの単語は重複しているものがあります。Yとします。 当然、最初のファイルにある単語もない単語もあります。 ファイルXから単語を読み取りYでその単語が何回出現したかチェックして単語と出現回数を出力するようなプログラムを組みたいと考えています。 参考書やインターネットで調べたところ、単語を数えるプログラム等はあるのですが、ファイルを読み込みさらにファイルを読み込んで比較する、といった流れのプログラムを見つけることができませんでした。 遠回りな考え方だと 例えば ファイルX a b c d（本当は単語間は改行があり１行１単語なのですが、見やすさのためにこのように表記しました。） ファイルY c c d e f とあった場合まず二つのファイルを結合し ファイルZ a b c d c c d e f として二回以上出現した単語のみを抜き出し ファイルZ' c 2 d 1　(この時出現回数を-1回する) としてファイルXと結合して出現回数を足して-1すると ファイルX' a 0 b 0 c 2 d 1 のようにできるのではないかと考えてはいます。しかし遠回り過ぎてスマートではないように感じます。 どのような考え方、そしてどのようなプログラムを組めばよいのでしょうか。ご教授お願い致します。
前回の質問で補足すればよかったのですが,ミスしてしまったので＾＾； 同じような質問ですがもう一度・・・ （プログラム初心者です） 「もし,aaaという文字列が2個以上存在する時は,最初のaaaを使う」 を, perl で書きたいと思っております.書いてみたものは以下です. ----------- if (aaa >=2) { 最初のaaaを使う } ----------- いろいろと間違えてそうですが... 「最初のaaaを使う」 という表現がわかりません＞＜ 間違い・こうしたほうがいいよ　などありましたら御願いします！
perl初心者です。 ファイルからデータを読み込んで3列目の要素を取り出すプログラムを作ろうと思っています。 その途中の勉強段階で参考書に $,=','; $\="\n"; @ARRAY=(); while(<>){ chop; split; @ARRAY=(@ARRAY, [@_] ); } print @ARRAY; foreach (@ARRAY){ print @$_; } print $ARRAY[1][2]; というプログラムがありました。このプログラムの大まかな意味は理解できます。 しかし、読み込ませるファイルを 1 2 3 4 5 6 7 8 9 のようにして コマンドプロンプトで実行してみると ARRAY(0x198b9c),ARRAY(0x198998),ARRAY(0x19a830) となり、参考書で紹介される結果の ARRAY(0x198b9c),ARRAY(0x198998),ARRAY(0x19a830) 1,2,3 4,5,6 7,8,9 6; となりませんでした。色々調べたんですが、どうやら　print @_;　に反応(?)してくれてないみたいです。 私の使用しているPCはwindows7です。原因がわからず先に進めない状況です。指導お願い致します。
お世話になります。 PerlのBBSを改造中です。 きちんと勉強してはいませんが、なんとなく弄ることは出来るレベルです。 今、ifで、表示の変更をしているのですが、上手く行かなくて困っています。 お分かりになる方、 何らかの原因に心当たりのある方、 どうぞよろしくお願いします。 ★━━━━━━━━━━━━━━━━━━━━★ データを入れているdatファイル内、 $astrologyというのに、「*Leo*」というのが格納されています。 …で、 if(!$astrology){print "入ってない\n";} else{print "入ってる\n";} …と入れると、「*Leo*」というデータが入っているわけなので、 「入ってる」と、表示されます。 ですが、 if($astrology == "*Aries*"){print "おひつじ座 <br />$astrology \n";} elsif($astrology == "*Leo*"){print "しし座　<br />$astrology\n";} else{print "その他<br />$astrology\n";} ・・・と、書いてみると 「おひつじ座 *Leo*」 と表示されます。 「*Leo*」と表示されているので、呼び込めていない訳ではないと思うのですが…。 ★━━━━━━━━━━━━━━━━━━━━★ 何が原因かわからないので、ちょっとしたアドバイスでも構いません。 ご返答よろしくお願いします。
以下のような形式のCSVデータを入力とします。 ファイル1 赤玉,青玉,緑玉 ファイル2 プレイヤー1,赤玉青玉赤玉 プレイヤー2緑玉赤玉赤玉赤玉 プレイヤー3緑玉緑玉青玉緑玉玉青玉 … これを プレイヤー,赤玉,青球,緑玉 プレイヤー1,2,1,0 プレイヤー2,3,0,1 プレイヤー3,0,2,3 という感じでテーブルを生成して、玉の個数をカウントした結果を対応したところにいれ、なければ0を入れるという感じにしたいです。 ご教授願います。
携帯にも対応した無料スペース用のCGIやPHPを配布しているサイトがありましたら教えて下さい。
テキストファイルを読み込んで、以下のルールに従った文字列だけを.txtで出力するプログラムを書いています。 具体的にはテキストファイル中の "text":"★★★","to_user" で囲まれている★★★の部分のみを抽出したいです。 そこで正規表現に触りだしたのですが、表現がうまくいっていないようで1週間ほどはまっています。。うまく出力できるように直しをいただけないでしょうか。 打ち明けてしまうと、★★★の部分はtwitterの呟き（日本語）になります。 以下がそのソースになります。よろしくお願いします。 print "Input file name: "; $ifname = <STDIN>; open(IN, $ifname); open(OUT, "> out.txt"); #出力ファイル while(<IN>){ if($ifname =" m/"test":(.*?),"to_user"/; next if($_ eq ""); print OUT "$_\n"; #書き出し } close(OUT); close(IN);
Perlでの配列のソートについての質問です。 実行例） 数学,山田,60,佐藤,80,蓑田,55,岸本,90,小笠原,75 英語,山田,70,佐藤,50,蓑田,81,岸本,99,小笠原,80 上のようなcsvファイルを入力として、以下のように各行の中で点数順にソートしてから出力する 数学,岸本,90,佐藤,80,小笠原,75,山田,60,蓑田,55 英語,岸本,99,,蓑田,81,小笠原,80山田,70,佐藤,50 どのようにすればいいでしょうか？ご教授願います。
お世話になります。 フリー配布のCGI(Perl)をちょっと改造しているのですが カンマを禁止したり別の文字に置き換えたりって 方法ありますか？ コンマで区切っているタイプのCGIなので、 訪問者さんが本文中にコンマを入力して データがズレまくってしまいます； 禁止ワードにすればいいのかと思って if($in{"name"} ~ /,/ ){ &error('コンマの使用は禁止されています'); } と、入れてみたらエラーになってしまいました； 何か方法ありませんか？ よろしくお願いします。
Perl初心者です。お願いいたします。 下記のような動きを実現したいのですが、どのような方法があるでしょうか。 できる限りすっきり書きたいのですが、自分で書きますと全パターンを記述していく・・等しか思いつきませんでした。お分かりになる方お教えいただけますと助かります。 $a1、$a2、$a3、$a4、$a5、$a6の6種類のデータがあり、いずれも「１」または「２」が代入されます。 その時に「１」が代入されたもののうち、aの後ろの数字が大きいほうの変数を抽出したいです。 たとえば、$a1、$a2、$a3、$a4、$a5、$a6　のデータが、1、2、2、1、1、2　であれば、「１」のうち数字が大きいのは$a5　なので　$TOP = $a5； 、としたいです。 宜しくお願いします。
IIS + クラシック asp + ActivePerl 環境下で QR コードを取得するプログラムを作っています。 呼び出し元の asp 内に、 <img src = "./cgi-bin/qr_test.cgi?q=hogehoge"> と書きました。 この q=hogehoge を呼び出し先で取得する方法を教えてください。 ===== 呼び出し元 (qr_test.asp) <html> <head></head> <body> <img src = "./cgi-bin/qr_test.cgi?q=hogehoge"> </body> </html> ===== 呼び出し先 (qr_test.cgi) use strict; use warnings; use GD::Barcode; my $url = $in{'q'}; # ここでエラーが出ます。コメントアウトすると正常に動きます。 my $qrimg = GD::Barcode->new('QRcode',$url,{'Ecc'=>'M',Version=>'7','ModuleSize'=>'4'}); binmode(STDOUT); print "Content-Type: image/jpeg\n\n"; print $qrimg->plot->jpeg; exit(0); ===== バージョンは IIS 7.5 Perl 5.14.2 (64bit) です。 どなたかご教授お願いします。
動画編集のソフトを使用中トラブルが起こり、 解決策を探しておりましたら、以下のページを発見しました。 http://yusukebe.com/archives/20090128/082002.html 動画編集ソフトのプロジェクトデータがXML形式 壊れたプロジェクト(＝壊れたXML)を　XML::Liberal　を使ってなおす ということなのでしょうか XMLなど、この手のものは扱かったことがないため どうすればよいのかわかりません 上記のページでどこがわからないかというと、 《早速、以下のような捨てスクリプトを書いたら、パースできてかつ「well formed」なXMLも出力してくれた。 そして、しっかりとPremiere で読めた！》 この部分です、 なにか他に必要なソフトがあるのか、 PCだけでできるのか、 どこを操作すればよいのか、 おわかりになる方、教えていただけると大変助かります。 見当違い名部分もあるかもしれませんが どうぞ、よろしくお願いします。
perl の正規表現を用いて、文字列の抽出を行いたいのですがどのように 書けばいいのかわかりません。 実現したいことは 「Y:/フォルダ名/フォルダ名/ファイル名.拡張子」 というテキストに対して 「拡張子」のみを抽出することと 「ファイル名」のみを抽出することです。 パターンマッチや変換はなんとなくわかるのですが 抽出の仕方がよくわかりません。 よろしくお願いいたします。
下記のようなファイルがあります。 1234：　4（グループ名：　要素数） AB（要素１） CD（要素2） EFG（要素3） HIJ（要素4） 2345：　1（グループ名：　要素数） XYZ（要素１） ○○：　XX ・・・ ：の行が区切られる単位とし、：の後の数字がそのグループに入る要素数である。 その要素数毎にファイル分割（要素のみ記述されたファイル）したいです。 perlプログラムで　どのように書けば　よいのか教えてください。
HTMLで入力フォームを作った時にチェックボックスにチェックを入れ送信した後に、またそのＨＴＭＬのアンケートフォームを開いた時に初期値として前回送信したチェックが入っているようなプログラムを書きたいのですが、どうすればいいのかわかりません。Ｐerlやhtmlで書きたいと思っているのですが書けますか？？　どなたか教えてください！！
初めて質問させて頂きます。 iCalendarのデータを吐き出すプログラムを作成中です。 長い項目に関して、75オクテットごとに改行(CRLF)と半角スペースを入れないといけないのですが、方法がわかりません。なお、文字コードはUTF-8で、全角・半角文字がまじっています。 なお、データ中に\nを含む場合は、それがぶった切られないようにする方法はないでしょうか？ 具体例） DESCRIPTION:あいうえおかきくけこさしすせそたちつてとなにぬね\nのはひふへほ ↓ DESCRIPTION:あいうえおかきくけこさしすせそたちつてとなにぬね [半角スペース]\nのはひふへほ ※上記のように75オクテット目の\とnが途中で改行されないこと。
perlで次のようなプログラムがあります。 sub { 中略 $USERS{$xy}　　　　　　　＃$xyは変数 　中略 ｝ <form name="user" action="$ENV{'SCRIPT_NAME" method="POST"> ユーザー名：<input type="text" name="username"><br> パスワード：<input type="password" name="pass" value=""><br> <input type="submit" value="ログイン"> ------------- このとき$USERS{$xy}　の要素を別ファイルに渡すことができますか。可能ならばどのようにすればよいでしょうか
お世話になります。 次のような文字列から「81.59」を数字として取り出したいのですが Perlを始めたばかりで途方に暮れています。 <td bgcolor="#c7c7c7">81.59円</td> 上記から81.59を数字として取り出す方法を教えて頂けませんでしょうか。
perlでの、ファイル読み込みについてお尋ねしたいことがあります。 a b c d e f g h i というような内容のテキストファイルがあったとき、この成分を「○行×列」の個別に読み込みたいのですが、 （C言語でいう、「A[0][0]=a A[0」[1]=b A[0][2]=c A[1][0]=d ・・・のように） どのようにしたらよいのでしょうか？ perlに関しては全くの初心者なのですが、どうしてもperlを使わないといけない事情があり、 稚拙な質問かとは思いますが、どうぞよろしくお願いします。
毎度お世話になっております。 今夜も躓いてしまってどうにもならないので、お力をお貸しいただけませんでしょうか。 以下のようなリストファイルがあります。 ------------------ 項目1 項目2 ・・・ ------------------ このリストにマッチした行を、リストの項目ごとにランダムに３行選んで出力したいです。 マッチした行を取り出すところまでは、以下のような形でできたのですが、 ここから先をどのように書けばいいのかわかりません。 ------------------ my $list = 'リストファイル'; open (IN, "$list"); my %l; while(<IN>) { chomp; $l{$_}++; } close IN; while(<DATA>) { my ($xx,$yy) = split(/\t/,$_); if (exists($l{$xx})) { # print; # ここから先がわかりません } } __END__ 項目1 N1 項目1 N2 項目2 N3 項目2 N4 項目2 N5 項目1 N6 項目2 N7 項目2 N8 項目2 N9 項目1 N10 ------------------ 以下のような出力結果にしたいです。 ------------------ 項目1 N2 項目1 N6 項目1 N10 項目2 N3 項目2 N5 項目2 N9 ------------------ どうぞよろしくお願いいたします。
Perlのデータ処理に関する質問です。 afcb7dc0,"福岡県","天神","福岡県","博多・福岡空港" 09f115fc,"東京都","東急沿線","東京都","東急沿線","東京都","代官山、恵比寿-五反田","東京都","東急沿線","東京都","三田、浜松町-品川","東京都","東急沿線" 3933245b,"東京都","新宿・代々木" ・・・ という形式のCSVファイルがあるときに、これを afcb7dc0,"福岡県",2,"天神",1,"博多・福岡空港",2 09f115fc,"東京都",6,"東急沿線",4,"代官山、恵比寿-五反田",1,"三田、浜松町-品川",1 3933245b,"東京都",1,"新宿・代々木",1 の形式に変換するにはどうすればいいでしょうか？ ご教授願います。
Perlを用いて、数百あるhtmlファイルの一括検索＆置換作業がしたいです。 作業としては、 1.webに上がっているhtmlファイルを取得してローカルに保存　（完了） 2.meta系テキストの記述 例：<meta property="og:title" content="" /> 3.さきほど保存したファイルの中から、titleタグの中身を取得して変数に格納 例<title>今日の日記</title>の「今日の日記」部分 4.og:titleのcontent要素に格納したデータを記述する 例：<meta property="og:title" content="今日の日記" /> 以上です。 現在1は出来ていて、2も一括置換で可能です。3.4のローカルに保存したhtmlファイルの操作で躓いています。 お分かりの方どうぞよろしくお願いします。
perlのsystem関数を使って、コマンドを実行したいのですが、 実行ファイルの引数にフォルダを指定すると、うまく動作しません。 以下のように書いています system "実行ファイル フォルダ"; 実行ファイルは　.BATファイルで、 指定しているフォルダには複数のテキストファイルが入っています。 perlで書いたcgiファイルは実行ファイルと同じディレクトリにあります。 コマンドからではなく、手動でドラッグ＆ドロップすると正常に動作します。 windous7でperlはActivePerlを使用しています。 引数にはフォルダを指定できないのでしょうか？ またフォルダを指定できない場合、解決策などはあるのでしょうか？ よろしくおねがいいたします。
# 正規表現　\s が、\n に、ヒットする。 # # Windows XP(sp3) ActivePerl # # This is perl 5, version 12, subversion 3 (v5.12.3) built for MSWin32-x86-multi-thread # (with 9 registered patches, see perl -V for more detail) # # Copyright 1987-2010, Larry Wall # # Binary build 1204 [294330] provided by ActiveState http://www.ActiveState.com # Built Feb 9 2011 14:38:22 # use strict; use warnings; use utf8; my $a = "\n\n"; $a =~ s/\s/aaaaa\n/ig; print $a; __END__ [出力結果] aaaaa aaaaa
DBI.pmのメソッドで、 selectall_arrayref()は配列の配列形式、 selectall_hashref()はハッシュのハッシュ形式でレコードセットを返しますが、 配列のハッシュ形式で返すメソッドは存在するのでしょうか。 ハッシュのキーは列名として、 ハッシュの値はORDER BY句で指定したとおりに整列された配列へのリファレンスとなるような、ハッシュを生成しようとしています
perl初心者です。 下記のような同時刻の2つのデータを1つのデータに統合させたいのですが うまく出来ず困っています。 どうかお知恵を貸していただけないでしょうか。 データは時刻(時:分:秒), 値1, 値2になっています。 test1.txtの同時刻の後ろにtest2.txtの値1と値2を入れ、 欠測値には-999を入れるプログラムを作っています。 厄介なのは、 開始時刻がtest1.txtよりtest2.txtが早い場合や 終了時刻がtest2.txtよりtest1.txtが遅い場合がある事です。 test1.txt 10:13:14, 3.1, 0.1 10:13:15, 6.1, 0.3 10:13:16, 8.7, 0.2 10:13:17, 12.8, 0.3 10:13:18, 13.4, 0.5 10:13:19, 15.2, 0.4 test2.txt 10:13:16, 32.5, 0.01 10:13:17, 33.1, 0.03 10:13:18, 36.2, 0.02 10:13:19, 34.3, 0.01 10:13:20, 33.8, 0.04 10:13:21, 32.6, 0.09 10:13:22, 32.1, 0.08 希望結果 test.txt 10:13:14, 3.1, 0.1, -999.0, -999.00 10:13:15, 6.1, 0.3, -999.0, -999.00 10:13:16, 8.7, 0.2, 32.5, 0.01 10:13:17, 12.8, 0.3, 33.1, 0.03 10:13:18, 13.4, 0.5, 36.2, 0.02 10:13:19, 15.2, 0.4, 34.3, 0.01 10:13:20, -999.0, -999.0, 33.8, 0.04 10:13:21, -999.0, -999.0, 32.6, 0.09 10:13:22, -999.0, -999.0, 32.1, 0.08 以下が自分が作成したプログラムです。 open IN_1, "test1.txt"; open IN_2, "test2.txt"; open OUT, ">test.txt"; while ($input1 = <IN_1>) { # test1.txtの処理 chomp $input1;# 改行削除 @input1 = split(/,/, $input1); # カンマ区切り $n = $n + 1; $time1[$n] = @input1[0]; @time1 = split(/:/, $time1[$n]); # 時刻をコロン区切り @hours1[$n] = @time_l[0]; @min1[$n] = @time_l[1]; @sec1[$n] = @time_l[2]; @a[$n] = @input1[1]; # 値1 @b[$n] = @input1[2]; # 値2 } while ($input2 = <IN_2>) { # test2.txtの処理 chomp $input2; @input2 = split(/,/, $input2); $m = $m + 1; $time2[$m] = @input2[0]; @time2 = split(/:/, $time2[$m]); @hours2[$m] = @time2[0]; @min2[$m] = @time2[1]; @sec2[$m] = @time2[2]; @c[$m] = @input2[1]; # 値1 @d[$m] = @input2[2]; # 値2 } # 開始と終了時刻の計算 # test1.txtの時刻 $hours1_S = @hours1[1]; # 開始時 $hours1_E = @hours1[$n]; # 終了時 $min1_S = @min1[1]; # 開始分 $min1_E = @min1[$n]; # 終了分 $sec1_S = @sec1[1]; # 開始秒 $sec1_E = @sec1[$n]; # 終了秒 $time1_S = $hours1_S*3600 + $min1_S*60 + $sec1_S; # 開始時刻を秒に計算 $time1_E = $hours1_E*3600 + $min1_E*60 + $sec1_E; # 終了時刻を秒に計算 # test2.txtの時刻 $hours2_S = @hours2[1]; $hours2_E = @hours2[$m]; $min2_S = @min2[1]; $min2_E = @min2[$m]; $sec2_S = @sec2[1]; $sec2_E = @sec2[$m]; $time2_S = $hours2_S*3600 + $min2_S*60 + $sec2_S; $time2_E = $hours2_E*3600 + $min2_E*60 + $sec2_E; if($time1_S <= $time2_S){ # 開始時刻の比較 $starttime = $time1_S; }else{ $starttime = $time2_S; } if($time1_E <= $time2_E){ # 終了時刻の比較 $endtime = $time2_E; }else{ $endtime = $time1_E; } $j = $endtime - $starttime;# 全体のデータ個数 # test.txtへ出力 for($i=1; $i<=$j; $i++){ if(@hours1[$i] != @hours2[$i] && @min1[$i] != @min2[$i] && @sec1[$i] != @sec2[$i]){ printf OUT "%2d:%2d:%2d %5.1f% 5.1f %5.1f %7.2f\n", @hours1[$i], @min1[$i], @sec1[$i], @a[$i], @b[$i], -999, -999; }elsif(@hours1[$i] == @hours2[$i] && @min1[$i] == @min2[$i] && @sec1[$i] == @sec2[$i]){ printf OUT "%2d:%2d:%2d %5.1f% 5.1f %5.1f %7.2f\n", @hours1[$i], @min1[$i], @sec1[$i], @a[$i], @b[$i], @c[$i], @d[$i]; }else{ printf OUT "%2d:%2d:%2d %5.1f% 5.1f %5.1f %7.2f\n", @hours2[$i], @min2[$i], @sec2[$i], -999@, -999, @c[$i], @d[$i]; } } close IN_1; close IN_1; close OUT; とても汚いプログラムになってしまいました… このプログラム以外でも構いませんのでどうかよろしくお願い致します。
こんばんは。 自分の力では解決できないので、お力をお貸しいただけないでしょうか。 以下のようなフォーマットのデータがあります。 「--」で一区切りです。 a b c d -- e f g h -- i j k l -- これを、以下のようなフォーマットで、 「--」で区切られたまとまりの行を全て結合して、 各行の後ろに付け加えたいのですが、 a -> abcd b -> abcd c -> abcd d -> abcd -- e -> efgh f -> efgh g -> efgh h -> efgh -- i -> ijkl j -> ijkl k -> ijkl l -> ijkl -- 自分で色々やってみましたが、うまくできません。 どうかよろしくお願いいたします。
perl、HTML::TreeBuilderモジュールを使ってHTMLからほしい情報を抽出しています。 探したタグがない場合に、次の処理にいけるように判定したいのですが、うまくいきません。 以下抽出部分のソースです。 my $tree = HTML::TreeBuilder->new; $tree->parse($html); my $items = $tree->look_down('class', 'referencelink')->find('li'); $items = $items->as_text; 　 HTML内に<li class="referencelink">というタグがない場合 $items　にどんな値が入るのでしょうか。 if (!defined($items))　や　if ($items=="")で判定しても、 my $items = $tree->look_down('class', 'referencelink')->find('li'); で処理が止まってしまいます。 どうしたらよいでしょうか？ よろしくお願いいたします。
モノの本によるとファイルを開く際にファイル入出力記号を +> にすると、追加書き込みは出来ないものの、読み取り、書き込み、新規作成、上書きが出来るとのこと。 ファイルからデータを読み込んで、読み込んだ内容を加工して、すぐにファイルに保存する用途に最適だなと思いましたが、実際に使ってみると読み出しをしてくれません。 何がいけないのでしょうか。 my @s; my @t=('a','b'); open IO,'+>test.txt'; @s=<IO>; print "\$@の要素数は ".@s."個\n"; for(@t) { print IO $_."\n"; } close IO;
作業に時間がかかるプログラムを組んでいます。 プログラムの実行をどうしても中断したい場合、ctrl＋Ｃで強制終了することが出来ます。しかしそれでは、その時点の作業状況を保存できません。 何かの操作をしたら、その時点の作業内容を保存してから終了する。次回、その保存内容を元に、そこから続きを始められるという仕組みを考えたいのですが、どのようにすれば良いか、まるで分かりません。 具体的に教えてくださらなくても、これを勉強しなさいで構いません。アドバイスをいただけないでしょうか。
ーーーーーーーーーーーー SRR_1 X1 Y1 SRR_1 X2 Y2 ～ SRR_1 Xn Yn SRR_2 X1 Y1 SRR_2 X2 Y2 ～ SRR_3 X1 Y1 ～ SRR_xxx X1 Y1 ーーーーーーーーーーー このようなタブ区切りのファイルを、一列目のSRR以降の数字が変わるごとに以下のようにファイルを分割したいと思っています。 SRR_1.txt ーーーーーーー X1 Y1 X2 Y2 ～ Xn Yn ーーーーーーー SRR_2.txt ーーーーーーー X1 Y1 ～ Xn Yn ーーーーーーー perl初心者ですが、どうかよろしくお願いします。
お世話になっております。 下記要件を満たす記述をご教授頂けますでしょうか。 ＜概要＞ アンケートデータを結合してアウトプットします。 ・アンケートデータ １～10までの項目を当てはまるものだけ回答してます。 例）Aさん：1/5/6/8　 Bさん：3/4/7/8/9/10 ・アウトプット形式 1～10のカラムがあり、回答された所を1とし、回答されてないものを0とする。 例）Aさん：1/0/0/0/1/1/0/1/0/0（1,5,6,8を1とし、それ以外を0とする） Bさん：0/0/1/1/0/0/1/1/1/1（3,4,7,8,9,10を1とし、それ以外を0とする） よろしくお願い致します。
もろ初心者な質問ですみません。 正規表現の質問です。 ある変数 $s='congratulations!' の中からアルファベットを取り出す場合、 $s=~/[a-z]*/g; $s=$1 とすれば congratulations がとりだせます。 しかしこの作業をいちいち２行にわけて書かないといけないものなのでしょうか。手元にある何冊かの教本に目を通す限り、そのようなのですが。。。 $s=$s=~/[a-z]*/g ? $1 : '' とやれば一行にまとめられますけど、これなら元の２行の構文の方がすっきりするような。。。
htmlのフォームタグ内で、inputtyp=file で受け取ったwordファイルやPDFファイルを perlで書いたCGIプログラムのほうで、MYSQLのデータベースへ保存したいのですが どのように書けばいいのかわかりません。 保存する型はBLOB型でよいといくつかのサイトで書いてあるのですが、 SQL文の書き方や、フォームから受け取ったデータの処理の仕方などの詳細が わかりません。 フォームで受け取ったファイルをデータベース（mysql）へ保存する 簡単なサンプルコードなどが知りたいです。 よろしくお願いいたします。
正規表現の質問です。 言語はPerlで組んでいます。 いくつかのhtmlファイルを順に開き、以下のようなコードを実行します。 $http{BODY}=~ /(?<=\[ No\.)([0-9]{$digit})(?= \/ $num)/o; ここで $http{BODY} 読み込んだhtmlファイル $digit 変数。整数値。 $num 変数。整数値。 この正規表現で、 ・・・・[ No.2 / 3 ]・・・・ といった感じの文字列から、この場合は「2」をマッチさせようとしました。 ところが最初に読み込んだファイルではうまくマッチしたのですが、２番目のファイルではマッチしません。 o オプションを外すとうまくいきました。o オプションは変数展開を１回行うとのことです。元のファイルはやたらとでかいので、o オプションを付けたら少しは早くなるかなと思いつけていたのですが。。。 ネットで調べると、 while( $s = <FH> ){ # 一度だけ展開する if ( $s =~ /$arg/o; ){ .... } このような用例で、$argは変数というよりも、セットされた文字列として評価されるとあります。でも前述の正規表現の２つの変数、$digitと$numは普通に値を書き換えられていましたけど。。。 それとも o オプションを付けた正規表現では、その正規表現を処理するためのメモリ領域に一度変数の値を取り込むと、二度と読み込むことをしないということでしょうか。だから変数の値が変わっても、正規表現が用いるメモリ領域の値は変化しない。。。 でも $http{BODY}=~ /(?<=\[ No\.)([0-9]{$digit})/o; だったらちゃんと$digitの値が変わったことに対応しているんです。他にもいっぱい o オプションを付けた正規表現を用いていますけど、全部正常に作動しています（バグに気づいていないだけかもしれませんけど）。 前述の正規表現とこれら正常に作動する正規表現の違いは、後者が変数１個であるのに対して、前者は２個であるということです。「変数展開を１回行う」の意味は、変数１個にしか対応しないという意味なのでしょうか。でも前者も最初のファイルだけなら２個の変数に対応しているのです。 どういうことなのでしょう。
掲示板でログファイルへの書き出しの際に文字コードをshift-jisに変更したいのですが， #投稿された値を受け取る if ($ENV{'REQUEST_METHOD'} eq 'POST') { read(STDIN, $alldata, $ENV{'CONTENT_LENGTH'}); } else { $alldata = $ENV{'QUERY_STRING'}; } foreach $data (split(/&/, $alldata)) { ($key, $value) = split(/=/, $data); $value =~ s/\+/ /g; $value =~ s/%([a-fA-F0-9][a-fA-F0-9])/pack('C', hex($1))/eg; $value =~ s/\t//g; $in{"$key"} = $value; } #ヘッダの表示 print "<html>\n"; print "<head><title>掲示板</title></head>\n"; print "<body>\n"; #受け取ったデータをファイルに書き込む if ($in{'handle'} ne '' && $in{'message'} ne '') { if (open(FH, "bbs.txt")) { @file = <FH>; close(FH); use CGI; $cgi=new CGI; $name1=$cgi->param('handle'); $name2=$cgi->param('number'); use Encode; use Encode::Guess qw(euc-jp shiftjis 7bit-jis); encode("shiftjis",decode('Guess',$name1)); encode("shiftjis",decode('Guess',$name2)); unshift(@file, "$name1\t$name2\n"); ＃＃この部分で if (open(FH, ">bbs.txt")) { print FH @file; close(FH); } else { print "<p>ファイルに書き込めません。</p>"; } } else { print "<p>ファイルを読み込めません。</p>"; } } #投稿フォームの表示 print "<form method=\"post\" action=\"bbs.cgi\">\n"; print "<p>\n"; print "ハンドルネーム<br>\n"; print "<input type=\"text\" name=\"handle\" size=\"20\" value=\"\"><br>\n"; print "メッセージ<br>\n"; print "<input type=\"text\" name=\"message\" size=\"20\" value=\"\">\n"; print "</p>\n"; print "<p><input type=\"submit\" value=\"送信する\"></p>\n"; print "</form>\n"; #記事の一覧表示 if (open(FH, "bbs.txt")) { while ($data = <FH>) { ($handle, $message) = split(/\t/, $data); print "<p>\n"; print "投稿者：$handle<br>\n"; print "メッセージ：$message\n"; print "</p>\n"; } } else { print "<p>ファイルを読み込めません。</p>"; } #フッタの表示 print "</body>\n"; print "</html>\n"; exit; このような感じでかいたのですが文字コードを変更し，unshift(@file, "$name1\t$name2\n");と記述すると何も書かれずに空白になってしまいます．．なぜでしょうか？困っています．教えて下さい． ちなみにunshift(@file, "$in{'handle'}\t$in{'message'}\n"); と文字コードの変更を意識しなかった場合にはちゃんとファイルに書かれています． jcode.plなどは使わずにencodeで行いたいです．
perlでファイルへの書き込みができません！ 教えてください． webプログラミング初心者なのですが， フォームから送信されたデータをshift-jisに変換させてからbbs1.txtへの内容の書き出しを行いたいのですが， #!/Applications/XAMPP/xamppfiles/bin/perl print "Content-type: text/html; charset=utf-8\n\n"; # フォーム部分を表示する print <<EOL; <html> <body> <h2>一行掲示板</h2> <form method="post" action="bbs1.cgi"> メッセージ：<input type="text" name="message" size="60"> <input type="submit" value="送信"> </form> <hr> EOL &ReadParse(*form); # フォームの値を取得 $message = $form{"message"}; use Encode; use Encode::Guess qw(euc-jp shiftjis 7bit-jis); encode("shiftjis",decode('Guess',$message)); # ログファイル読み込み open(IN, "bbs1.txt"); @log = <IN>; close(IN); # メッセージが入力されているときは書き込み処理を行なう if ($message ne "") { # ログ先頭にメッセージを格納 unshift @log, "$message\n"; # ログファイルに書き込み open(OUT, "> bbs1.txt"); print OUT @log; close(OUT); } # ログ表示 foreach $data (@log) { chop $data; print "$data<br>\n"; } print "</body>\n</html>\n"; このような感じにし実行して後でtxtファイルを見ると何も書かれていません＞＜ なぜでしょうか．．．？ 教えて下さい＞＜ 今気づいたのですがそれに関連してなのかログも表示されていませんでした．．．＞＜ txtファイルのアクセス権は読み書き可になっています encodeはあえてつかっています．
Webプログラミング初心者です． ファイルへの保存について質問です＞＜ フォームから受け取ったデータを文字コード変更させてファイルに保存する場合 $name1=$cgi->param('name'); $name2=$cgi->param('number); このように一度変数にいれ． 次に文字コードの変換をし変換した内容を再び$name1,$name2に格納した場合， ファイルの書き出し•保存のソースコードは， if (open(FH, "form.txt")) { @file = <FH>; close(FH); unshift(@file, "$in{'name1'}\t$in{'name2'}\n"); ／／ココの部分です． if (open(FH, ">form.txt")) { print FH @file; close(FH); } else { print "<p>ファイルに書き込めません。</p>"; } } else { print "<p>ファイルを読み込めません。</p>"; } このような感じで良いのでしょうか？ unshift(@file, "$in{'name1'}\t$in{'name2'}\n"); の変数名の部分では例題はフォームから受け取ったものを そのまま書いてある例が多くどのように記述したら良いかわかりません． 一度やってみてできなかったので他の部分にミスがあったのかと探し中ではありますが．．． 教えてください．お願いします＞＜
my @shop = [ {'start_hour'=> '1100','shift'=> [1,2] }, {'start_hour'=> '1130','shift'=> [1,3] } ] という配列があってそれをループで回したいのですが、 ▼以下だとNG foreach my $data (@shop){print $data->{start_hour};} ▼以下だと最初の1つだけOK foreach my $data (@shop){print $data->[0]->{start_hour};} という状況です。なぜ$data->{start_hour};で取得できないのでしょうか？ 助けて頂けるとうれしいです★
自作のCGIを実行したところ Can't locate BASE64 in @INC (@INC contains: C:/Perl/site/lib C:/Perl/lib .) at g etHTTP line 71. のようなエラーが出ます。 BASE64がインストールされているかどうか確認するために、次のサイトのcheck.cgiを実行してみました。 http://perl.shtml.jp/check/check.html インストールされているということなので、検索を掛けてBase64.pmのパスを調べました。 C:\Perl\lib\MIME そこで以下のコードを追加して実行しなおしました。 unshift @INC, "C:/Perl/lib/MIME"; 残念ながらうまく動きませんでした。 Can't locate BASE64 in @INC (@INC contains: C:/Perl/lib/MIME C:/Perl/site/lib C: /Perl/lib .) at getHTTP line 71. どうすれば良いでしょう。 お手数をお掛けします。
要素のない配列を消したいです。 do\n be\n usual\n become\n get\n look\n watch\n このような複数行の文があり"a"が入っている行だけ配列に突っ込みたいと思っています。 自分が試した方法として。 @line = split(/\n/,$content); とりあえず改行で区切り配列にぶち込んでいき。 foreach $line (@line){ 　　　　　　unless ($line =~/a/){ 　　　　　 $line = undef; } } その次に"a"が入っている以外の配列にundefを入れるようにしていました。 しかしこれだとundefが入っている配列がたくさん出来てしまい納得がいきません。 要素のない配列を消したいです。 どなたかご教授お願いします。
perl初心者です。 辞書ファイルを編集するのに必要外な文字が多く、手作業では限界がありperlを使おうと思います。 ちまちまと自分で打ったのですが、いざ実行するとうまくいきません。 右も左もわからず途方にくれてます。 下が編集したい文です。 行の最初の”を削り、読んだものに上書きしたいのです。 "さ来週 [さらいしゅう]","(n-adv,n-t) week after next","",0,0,0,"" "さ迷う [さまよう]","(v5u) to loiter/to putter/to prowl/to wander about/to roam about/to knock around","",0,0,0,"" "ざあざあ","(adv) sound of rushing water/sound of pouring rain/white noise sound/(P)","",0,0,0,"" そして下の文が打ったperlの内容です。 $inputfile="DicA.csv"; open(DIC,"$inputfile") or die "$!";　　　-----------画面に表示される while ($line1 = <DIC>){ $string =~ s/"//g; open(OUT,"> DicA.csv");　　　　----------上書きされ空のファイルができる $out1 = join(",",@array); print OUT; } close(DIC) お手数をおかけしてすみません。 困っています。 どうかよろしくお願いします。
# 正規表現　最長マッチが、機能しない。 # # Windows XP(sp3) ActivePerl # # This is perl 5, version 12, subversion 3 (v5.12.3) built for MSWin32-x86-multi-thread # (with 9 registered patches, see perl -V for more detail) # # Copyright 1987-2010, Larry Wall # # Binary build 1204 [294330] provided by ActiveState http://www.ActiveState.com # Built Feb 9 2011 14:38:22 # use strict; use utf8; use Encode; my $doc = "(L)12×(H)34×(W)56\n"; $doc =~ s%(\([LHW]\)(\d+))([^×cm])%$1cm$3%ig; # ←この部分 print encode("cp932", $doc); {出力結果} (L)1cm2×(H)3cm4×(W)56cm
お世話になります。 下記のCGIで掲示板を作成したいと思っているのですが、エラーが出てしまい設置できずにおります。 http://plus-code.net/cgi-flash-bbs/perlbbs/ サポートも終了してしまっていてお手上げ状態です・・・。 エラー内容は以下の通りです。 DBD::mysql::st execute failed: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'type=InnoDB' at line 1 at C:/www/users/○○○/cgi-bin/config.cgi line 87. 87行目近辺のソースはこのような感じでした。 *********************************** my $dbh = DBI->connect("DBI:mysql:$in{d_databasename}:$in{d_hostname}", $in{d_username}, $in{d_password},{RaiseError => 1, PrintError => 0, AutoCommit => 0 }) || &error_html($ref_ini->{action_error}{db_er1});　　　　　　//line 70 my $user="forum"; my $pass=&Cf::Random::d_crypt($user); my $random_url=&Cf::Random::az09($ref_ini->{setup}{adjust30}); my @que=( "insert into public values(1,'','','','','','','http://','',0,1,0,3000,10,10,10,30,7,0,1,3000,1,1,'','$random_url','default','default','','','');", "insert into member values('u$tm','$user','$ip','$pass','','webmaster',0,0,'',0)", "insert into section values('s$tm',0,'section_title','section_explain','webmaster','$user')", "insert into forum values('f$tm','s$tm',0,'forum_title','forum_explain','webmaster','$user')", "insert into contact values('c$tm','$user','webmaster','to_forum','webmaster','message title','message comment','','')", "insert into clap values('s$tm','f$tm','t$tm','p$tm','w$tm','$user','$ip','testclap',10)", "insert into post values('s$tm','f$tm','t$tm','p$tm','$user','webmaster','$ip','test title','test message','','',1,'')", "insert into report values('r$tm','p$tm','$user','report title','report message')" ); eval{my ($sth); for (my $j=0;$j<scalar(@{$$ref_sql{create_table}});$j++) {　　　　　　//line 87 $sth = $dbh->prepare($ref_sql->{create_table}[$j]);$sth->execute; }#for end for my $j(@que){$sth = $dbh->prepare($j);$sth->execute; $sth->finish;}$dbh->commit;$dbh->disconnect;}; if($@){$dbh->rollback;$dbh->disconnect;&error_html($@);}　　　　　　//line 95 *********************************** 何卒宜しくお願い致します！
こんばんわ。 Perlで一点伺いたいことがございます。 SMTP認証して、メールを送信したいのですが ネット上でサンプルをさがしてきて実際に試したのですが うまくいきません。 どうしたらいでしょうか？以下が実施に動かしているコードです。 #!/perl/perl/bin/perl use strict; use warnings; use CGI::Carp qw(fatalsToBrowser); print"content-type: text/html\r\n\r\n"; print "Hello World!\n"; use Net::SMTP; #SMTPサーバの指定 my $mailhost = 'smtp.gmail.com'; my $mailport = 587; my $mail_username = 'XXX@gmail.com'; my $mail_password = 'パスワード'; my $to_mail = '宛先'; my $from_mail = '送信先'; my $smtp = Net::SMTP->new($mailhost,Port => $mailport); $smtp->auth($mail_username, $mail_password); #メールの送信先 $smtp->mail($from_mail); $smtp->to($to_mail); #メールの内容 $smtp->data(); $smtp->datasend("From: $from_mail\n"); $smtp->datasend("To: $to_mail\n"); $smtp->datasend("Subject: test\n"); $smtp->datasend("\n"); $smtp->datasend("test\n"); #メール内容終わり $smtp->dataend(); #接続を切る。 $smtp->quit; print $smtp; ほぼコピーアンドペーストなのですが、うまくいきません。 とりあえず、newしたオブジェクト $smtpを出力してみると アドレス的なものが表示されます。 Net::SMTP=GLOB(0x7d15ec) ただ、これは認証情報が適当でも出力されるようです。 何度やってもメールは届いていないようなので認証の時点でまちがっているのでしょうか？ ただ、認証情報は実際にメールソフトで使っているものなので、間違いないと思うのですが、識者の方よろしくご教授お願いします。
恐れ入ります。　PerlでVlookupみたいに、マッチしたものの閲覧をしたいのですが、 どのようにしたら良いでしょうか。 lookup.cgi code.csv data.csv というファイルを用意して、 code.csvには、7桁のコードの一覧が並び、 data.csvの中でマッチした7桁のコードの別列のデータの一覧を取得したいのですが、 つまり、code.csvに書かれている７桁のコードにマッチする全てのデータを、 data.csvの中の指定した列から抜き出して羅列する感じです。 よろしくお願いします。
perlスクリプトを使いactive directoryにユーザを登録したいと思っております。 perlもactive directoryも初めてで理解していませんが 仕事でどうしてもやらなくてはならないためどなたかわかる方教えて頂けますと助かります。 環境： windows server 2008R2 active directory 2008 centos 6 やりたいことは、perlを使いactive directoryにユーザ登録をしたいのですが どうやっても登録することができません。 必要なperlモジュールはインストールしてるつもりです。 以下がスクリプトとなります。 =================ここから================== #!/usr/bin/perl use strict; use Net::LDAP; my $ldap_host = 'xxx.xxx.xxx.xxx'; my $bind_dn = 'cn=admin,o=example,c=com'; my $bind_pw = 'password'; my $ldap = Net::LDAP->new( $ldap_host ) or die "$@ $!"; $ldap->bind( $bind_dn, password => $bind_pw ) or die "$@ $!"; $uid = "localuser"; $suffix = ",ou=People,dc=example,dc=com"; $dn = "uid=" . $uid . $suffix; $addResult = $ldap->add( $dn, attr => [ 'cn' => $uid, 'sn' => $uid, 'mail' => $uid . '@example.com', 'uid' => $uid, 'objectClass' => [ 'top', 'person', 'organizationalPerson' ], ] ); if ( $addResult->code == 0 ) { print "added $dn\n"; } else { $ldap->unbind; warn "failed to add entry: ", $addResult->error, "\n"; exit( $addResult->code ); } =================ここまで=================== 上記を実行すると以下のエラーコードが返ってきます。 comment:AcceptSecurityContext error, このエラーについてとあるサイトをみると 「ユーザーは次回ログオン時にパスワード変更が必要」にチェックをいれていると 出力されてしまうとかかれていたのでチェックを外しているのですが結果は同じです。 上記のスクリプトは以下のサイトを参考にして作ったのですが わからない部分があります。 http://d.hatena.ne.jp/askadna/20080326 http://www.knowd.co.jp/yamazaki/index.php?q=node/134 $ldap->addのメソッド？に$dnとattr～～というパラメータを与えているのですが 配列の階層が異なっていますがaddメソッドはこれを認識することはできるのでしょうか。 例えば、 $ldap->addを部分を消して $addResult = ( $dn, attr => [ 'cn' => $uid, 　～以下省略～ 以下のようにprintで表示すると配列の階層はバラバラです。 これでaddは正常に階層をみて動作するのでしょうかということです。 print $addResult[0]・・・・uid=localuser,ou=People,dc=example,dc=com print $addResult[1]・・・・attr print $addResult[1]->[0]・・・・cn print $addResult[1]->[1]・・・・localuser print $addResult[1]->[2]・・・・sn ～～省略～～～ ちなみに、searchメソッドでldapの情報の取得はできています。 少し気になるのはActive directoryに必須項目があり それをattrに格納させていないことが原因だったりするのでしょうか。 Active Directoryの必須項目というのがわかりませんが基本的に例えばSIDなどは システム自動で入れてくれるとおもっていますが・・・ 上記のスクリプトでADにバインドできていることがAD側のログで確認できております。 addでこけているみたいなのですが、どうかよろしくお願い致します。
Perlの正規表現について質問です． ■質問 aaa bbb aaa bbb ccc "ddd" aaa bbb ccc "ddd eee" aaa bbb ccc ddd eee "fff ggg hhh iii" というような，文字列が書かれているファイルがあるとします． ※ダブルクォーテーションが無い行もあります． ※ダブルクォーテーション内のスペースの数は，行によってそれぞれ異なります． これを，ダブルクォーテーションの中にあるスペースだけ アンダーバーに置換する場合の正規表現を教えて下さい． つまり，下記の出力にしたいです． aaa bbb aaa bbb ccc "ddd" aaa bbb ccc "ddd_eee" aaa bbb ccc ddd eee "fff_ggg_hhh_iii" ■条件 ※ちょっと古いPerlでも動くよう，ゼロ幅肯定/否定後読((?<),(!<))は使わないでください． ※単に実現するだけなら， # cat inputfile | print -pe 'sub f(){}(shift;s/ /_/;return $_;); s/(\".*\")/&f($1)/e;' みたいな感じで置換できそうですが，「正規表現だけで簡単に書けるかどうか」が知りたいのです(正規表現だけで実現出来る場合，そのアルゴリズムを知りたいです)．そのため，関数と/eオプションは使わないでください．
ActivePerlでは改行は　\n ですがstrawberryＰｅｒｌでは /n(/は向きが逆)になります。 \nに変える方法はないでしょうか。 また他にも記号とか文法など違った所はあるのでしょうか。 教えていただけると助かります。
＆#27005;＆#12375;　（＆は半角です。） というような文字コード？で文字が記入されています。これはなんという文字コード名なのでしょうか？ これを通常の文字として読めるように変換したいと考えていますが、可能でしょうか？よろしくお願いいたします。
cgiで変数の中身を表示させたい perlのcgiで変数の中身を表示させたいのですが、うまくいきません ▽環境 　 レンタルサーバ ▽やりたいこと 　 通常のブラウザ画面に、変数の中身を表示させたい ▽現状 　 use Data::Dumper; 　 print Dumper($hoge));もしくは、warn Dumper $hoge; 　 とすると、下記エラーとなります Script Error The script did not produce proper HTTP headers. Please see the error log to see the detail of the errors. Depending on the server configuration, you can also run thisscript under CGIWrap debugging. Usually, either rename or linkthe script temporarily to a file which ends with .cgidextension, or add a AddHandler cgi-script-debug .cgiline to your .htaccess file. 指示に従い、.htaccessへ、AddHandler cgi-script-debug .cgiを追記すると、ズラズラ出てきたと何か出てきた中の一行に、変数の中身が表示されます ■質問事項 　 ▼変数の中身を確認する際、いちいち.htaccessへ追記するのが面倒なのですが、どうやって回避するのでしょうか？ 　 ▼なぜ、変数の中身を確認しようとしただけで、Script Errorとなるのでしょうか？ 　　・書き方を間違えている？ 　　・書く場所を間違えている？ 　　・レンタルサーバの仕様？ 　　・perlのcgiだから？ イメージしてるのは、PHPのvar_dumpなのですが…
perlでｃのプログラム処理を行いたいのですが可能でしょうか。 内容としては、 複数のファイルをｃのプログラムによって別のファイルにアウトプットする形にしたいと思っております。 よろしくお願いします。
お世話になります。 サーバーの変更後に、 それまで使っていたCGIでゾンビプロセスが発生するようになってしまいました。 以前のサーバーはFreeBSDでそのような事がなかったのですが、 新しいサーバーCentOS5になってから発生するようになってしまったのですが どのような原因が考えらますでしょうか。 perlやSSIを使った時にだけ発生してしまいます。 色々しらべてはみたのですが、 mod_cgid.so SSIではこれを無効にすればよいと言うのを見かけまして apache2のhttpd.confを見てみたのですが LoadModule cgi_module modules/mod_cgi.so　のみで 存在していませんでした。 同じプログラムでサーバー変更前はゾンビプロセスは全く発生しなかったのですが、 変更後に今まで大丈夫だったすべてのＣＧＩ（perl）プログラムで ゾンビプロセスが発生するようになってしまいました。 ゾンビプロセス自体は、発生後に消える状態ではあります。 これだけの情報では予測もつかないと思いますが、 もし何かこれが原因では・・・と言うのがございましたらご教授いただけますと幸いです。 お手数をおかけしますが、何卒よろしくお願い致します。
こんにちは。 どうやって書いたらいいのかわからなくて質問しました。 皆様のお知恵を拝借できませんでしょうか。 以下のようなデータがあります。 1行目:100円 りんご 2行目:100円 みかん 3行目:100円 バナナ これを以下のようにマージして一行で出力したいのです。 100円 りんご,みかん,ばなな どうかよろしくお願いします！
2バイト文字、1バイト文字どちらもありうる(構成が不明である)文字列をバイト単位で桁揃えして出力したいのですが、 use encoding 'cp932'; printf "|%2s\n|","あ"; printf "|%2s\n|","aa"; とすると、出力結果は当然 | あ| |aa| となって、桁が揃わないですよね。「バイト単位で2バイト分の巾」という指定を実現するにはどうしたらいいのでしょうか。日本語処理ではよくある問題だと思うのですが。
もう既に散々論じられていると思うのですが、PHPとPerlの利用法などでの違いを教えてください 自分はPHPとJavaScriptしか出来ませんが、Perlに興味があります。 Web系を作成するのにはPHPで特に問題はありません。 しかし、MySQLなどのサードパーティ製ソフトなどをインストール時にPerl（モジュールやMakefile等）を使用しているのが多いですが、PHPを利用しているというものはありません。 PHPはWebに特化し、コマンドラインから操作できないこともないですが、全く見たことがありません。 そういう点で両者は違う点があると思うのですが、それ以上は自分には分かりませでした。 自分はデータを取ってきて、それを加工して利用したいと考えているのですが、PHPでは自分のやりたい事に限界が出来てしまいます。 で、シェルを含めてLinux上で色々と自動化をしたいと考えているのですが、この場合Perlスクリプトで出来るのかなと思いまして。 PHPで出来ることはPerlで出来る、Perlで出来ることもPHPで出来ると見たことがありますが、PHPに出来ない、PHPよりも優れている点、そして特に自分が知りたいのはLinuxで利用するスクリプト（シェル）としての利用法なのですが、その場合の限界などを教えていただけませんでしょうか？ Web上で調べたのですが、いまいち要点を得られませんでした。
ある条件を満たすときだけuse(あるいはrequire)をするということはどうしたらできますか。例えば、次のように、perlの版を判別してuseする/しないを分岐したいのですが、ifではできません。目的は、jperl環境で作成したプログラムを最新のperl環境に移行することです。 if ($]=~/^5\.12/){ use encoding 'cp932'; use Encode; use subs qw(length); sub length { CORE::length(encode('cp932',shift)); } 　　　#以下色々な関数を定義する }
#!/usr/bin/perl require './jcode.pl'; $file = "houkoku.txt"; if ($ENV{'REQUEST_METHOD'} eq "POST") { read(STDIN, $buffer, $ENV{'CONTENT_LENGTH'}); } else { $buffer = $ENV{'QUERY_STRING'}; } @pairs = split(/&/, $buffer); foreach $pair (@pairs) { ($name, $value) = split(/=/, $pair); $value =~ tr/+/ /; $value =~ s/%([a-fA-F0-9][a-fA-F0-9])/pack("C", hex($1))/eg; &jcode'convert(*value,'sjis'); $value =~ s/</&lt;/g; $value =~ s/>/&gt;/g; $value =~ s/\t//g; $value =~ s/\r\n/\n/g; $value =~ s/\r/\n/g; $value =~ s/^\s+//; $value =~ s/\s+$//; $FORM{$name} .= (defined $FORM{$name}) ? "," . $value : $value; } open( WRITE, "+< $file" ); print WRITE $FORM{'name'},",",$FORM{'color'}."\n"; close(WRITE); foreach ( keys %FORM ) { if( $FORM{$_} eq '' ) { $FORM{$_} = '入力がありません'; } } #if ( $FORM{'name'} eq '' ) { $FORM{'name'} = '入力がありません'; } if ( $FORM{'color'} eq '' ) { $FORM{'color'} = '入力がありません'; } print "Content-Type: text/html\n\n"; print <<END_HTML; <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS"> </head> <body> <center> <table border="1"> <td> $FORM{'name'}</td> <td> $FORM{'color'}</td></tr> </table> </center> </body> </html> END_HTML exit; として、カンマ仕切りでデータを保存できるようになりました。 これを、指定行への書き込みを行いたいのですが、どのようにしたら良いでしょうか。 たとえば、5行目にこのデータを書き込んで、常に5行目を上書き更新するような感じです。 よろしくお願いします。
htmlファイルから、 <form action="./ppp.cgi" method="POST"> <table border="1"> <tr> <td> 好きな色(複数選択可)：</td> <td> <input type="checkbox" name="color" value="white">白 <input type="checkbox" name="color" value="red">赤 <input type="checkbox" name="color" value="green">緑 <input type="checkbox" name="color" value="pink">桃色 <input type="checkbox" name="color" value="yellow">黄色 <input type="checkbox" name="color" value="purple">紫 <input type="checkbox" name="color" value="orange">橙色 <input type="checkbox" name="color" value="blue">青 <input type="checkbox" name="color" value="black">黒</td></tr> </table><br> <input type="submit" value=" 送信 "> <input type="reset" value=" クリア "> でデータを送信して、 ------------------------------------- #!/usr/bin/perl require './jcode.pl'; $file = "houkoku.txt"; if ($ENV{'REQUEST_METHOD'} eq "POST") { read(STDIN, $buffer, $ENV{'CONTENT_LENGTH'}); } else { $buffer = $ENV{'QUERY_STRING'}; } open( WRITE, "+< $file" ); @pairs = split(/&/, $buffer); foreach $pair (@pairs) { ($name, $value) = split(/=/, $pair); $value =~ tr/+/ /; $value =~ s/%([a-fA-F0-9][a-fA-F0-9])/pack("C", hex($1))/eg; &jcode'convert(*value,'sjis'); # タグ処理 $value =~ s/</&lt;/g; $value =~ s/>/&gt;/g; $value =~ s/\t//g; $value =~ s/\r\n/\n/g; $value =~ s/\r/\n/g; $value =~ s/^\s+//; $value =~ s/\s+$//; $FORM{$name} .= (defined $FORM{$name}) ? "," . $value : $value; @value = $value; print WRITE"@value\n"; } foreach ( keys %FORM ) { if( $FORM{$_} eq '' ) { $FORM{$_} = '入力がありません'; } } if ( $FORM{'color'} eq '' ) { $FORM{'color'} = '入力がありません'; } print "Content-Type: text/html\n\n"; print <<END_HTML; <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS"> </head> <body> <center> <table border="1"> <td> あなたの好きな色</td> <td> $FORM{'color'}</td></tr> </table> </center> </body> </html> END_HTML exit; ---------------------------------- でデータを受け取って、houkoku.txtに書き込みをしたいのですが、 一応書き込みはされていますが、縦にデータが並んでいます。 横にカンマ仕切りで、white,yellow,redと保存するにはどうしたらよいでしょうか。 よろしくお願いします。
条件指定して、一致したものを合計するプログラムを作っています。 しかし、条件にまったく一致する行が無い場合、空欄になってしまい、 次の行が表示されません。 open (IFILE, $file) or die "$!"; while ($line = <IFILE>) { chomp($line); @column = split(",",$line); if ((@column[7] eq $kensouken) && (@column[4] eq $tantou1) && (@column[32] >0 ) && ( @column[33] <=0 )) {for($loop = 1;$loop <= 5;$loop++) { $total3[$loop] += @column[32]; }} elsif ((@column[7] eq $kensouken) && (@column[4] eq $tantou1) && (@column[32] <= 0) && (@column[33] > 0)) {for($loop = 1;$loop <= 5;$loop++) { $total4[$loop] += @column[33]; }}} print "$total3[1]"; print "$total4[1]"; としています。上記２つの条件にマッチしない場合、$total3、$total4が無効になっているのでしょうか。 次に書いている行が表示されなくなってしまいます。 条件に一致しない場合、0を表示したいのですが、どうしたら良いでしょうか。よろしくお願いします。
こんにちは。 毎日、その日の日付のフォルダ名を作成して作業をしているのですが、 毎回、その作業に手間がかかるので、Perlを用いてフォルダを作成したいと思っています。 普段、Perlを用いて処理をすることが多いので、 今回もPerlでプログラムを作りたいと思っているのですが、 Windows環境（windows7）でPerlを用いてフォルダを作成することは出来るのでしょうか。 やりたいことは、プログラムを実行するだけで、その日の日付をフォルダ名とするフォルダの作成です。 例えば、2011年09月23日ならば、 フォルダ名が、『20110923』となるようなプログラムを書きたいと思っております。 出来るかどうかをご存じの方は、ヒントもしくはサンプルプログラムをご教授ください＞＜ よろしくお願いします・・！
&あああ("ファイル名１", "AGT"); &あああ("ファイル名２", "ACA"); &あああ("ファイル名３", "TAT"); &あああ("ファイル名４", "TGA"); sub あああ{ open(FILE, "処理させるファイル") or die "$!"; my ($file, $tag) = @_; open(NEWFILE, "> $file") or die "$!"; my $x = 0; my @ti; while(<FILE>){ if($_ =~ "^>"){ $x ++; $ti[$x] = $_; } elsif($_ =~ "^$tag"){ print NEWFILE $ti[$x].$_; } } print "$x\n"; close NEWFILE; } このプログラムをサブルーチンではなく forかなんかで実行させ 自由にファイル数と$tagを設定し 実行できるようにしたいのですが できますでしょうか＞＜ forをまわす回数を指定しSTDINなんかで指定し そのforの中でファイル処理に必要な条件や 吐き出すファイルの名前をSTDINで指定するようなものを書きたいです ちなみにperl初心者です 質問が意味不明かもしれないです＞＜ よろしくおねがいします
いつもお世話になっております。 今回も質問させていただきます。 PerlでhttpリクエストをしてXMLで返ってくるapiを使っているのですが、 英語で返答が来る時にはバックスラッシュが入っておらず成功するのですが、 日本語で返答が来ると、バックスラッシュがxml内部に記述されて Cannot decode string with wide characters と怒られます。 my $http2 = get($trans_url); my $result2=XML::Simple->new()->XMLin($http2); use CGI::Carp qw(fatalsToBrowser); die Dumper $result2; とダンプすると 成功するとき <string xmlns="http://schemas.microsoft.com/2003/10/Serialization/">testtest</string> 失敗するとき <string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/\">\x{79c1}\x{306f}\x{65e5}\x{672c}\x{4eba}\x{3067}\x{3059}\x{3002}</string> と、明らかに「￥」が入っているときにデコードに失敗しているのですが、 このXMLの中の”の前の￥マークを取り除くことが出来ませんか？ お知恵を拝借できればと思います。 どうぞよろしくお願いいたします。
#!/usr/bin/perl require "cgi-lib.pl"; print "Content-type: text/html\n\n"; ############ 書き込み ############# $file = "sample.txt"; print qq! <font size="1">コード入力<form method=POST action="./houkoku.cgi"> <input type="text" name="rank"> <br><br> <input type="submit" value="送信"> </form>!; use CGI; $query = CGI->new; $rank = $query->param('rank'); open( WRITE, ">> $file" ); print WRITE"$rank\n"; close ( WRITE ); ############ 読み込み ############# print "<table border=1>"; open( READ, "<$file" ); $adam = <READ>; while( $adam = <READ> ) { chomp ( $adam ); @column = split(",",$adam); print "<tr><td>@column[0]</td></tr>"; } close(READ); __END__ のようにして、送信されたものを表示していくようにしたいのですが、 新しい書き込みが下段に追加されてい行きます。 新しいものを上段へ表示したいのですが、 どのようにしたら良いでしょうか？ sample.txtにも、新しいものが下に記入されています。 上段への書き込みのやりかたをご教授いただけたらと思います。、 よろしくお願いします。
ローカルにperlプログラムを置いています。 このプログラムでサイトのHPに定期的なアクセスしています。 必要な情報はページの中間程度に入っています。 現在は、LWPを使っているのですが、全て情報を取得してから必要な情報を解析するため速度アップの為の改良余地があるように感じています。 HPを全部読む必要はなく、少しでも速いプログラムを作りたいのですがどの様にすればよいでしょうか？
１行につき４０文字前後で（固定長ではない）、１ファイルにつき約１億行書かれたファイル（１ファイルにつき3-5GB程度のテキストファイル）が３０ファイルあります。ファイルは、すべてアルファベットで構成されていていますが、スペースは含まれておらず、各行の末端は改行(\n)で区切られています。これらのファイルからある特定の文字に完全にマッチする部分が含まれる行が各ファイルごとに何行あるのかを調べたいと思っています。検索する文字列の長さは10-20文字のものをいろいろと調べたいと思っています。 この作業をperlで行う場合、index関数を使って検索をするのと、正規表現を使って検索をするのでは、どちらが早いのでしょうか？もしくは、他に良い方法やmoduleがあるようでしたら教えてください。 よろしくお願いします。
以下のようなデータがあります。そこでカラム１が等しい値をもつものを一グループとし、カラム2の平均値を求めたいのですが、なかなかうまくいきません。どなたかご教授をお願いいたします。よろしくお願いします。 カラム１　　　カラム２ 1 　　　　　　　 123.93 1 　　　　　　　 322.32 1 　　　　　　　 232.21 1 　　　　　　　 124.32 1 　　　　　　　 234.12 2 　　　　　　　 123.43 2 　　　　　　 12.34 2 　　　　　　　　 . 2 　　　　　　　　 . 2 　　　　　　　　 . 3　 3 3 4 4 4 4
現在最新版（開発停止）のJcode.pm は Encode.pmのwrapperとして動作していますが、 「～」という文字という文字を、他コードからUTF-8に変換する 時に、日本語のコードセットの中では 本来「\xef\xbd\x9e」に変換されなければいけないのが、 「\xe3\x80\x9c」に変換されてしまいます。 このような例で他にある文字があれば、教えて頂ければと 思います。
一つ前で質問しました。 そして参考文献を教えて貰い、読んでみました。 以下のサンプルが説明されていましたが分かりません。 1 while s/^([-+]?\d+)(\d\d\d)/$1,$2/; 説明は何となく分かるのですが、実際のコーディングを具体的に教えてください。 目的の数値は　$wkに入っています。 宜しくお願いします。
$wk =~ s/(.*\d)(\d\d\d)/$1,$2/;とやって、 単純に　$1,$2をプリントしています。 桁数が４桁以上なら問題ないのですが、 桁数が４桁未満だとおかしな出方になります。 ４桁未満の時の考え方を教えてください。 宜しくお願いします。
コマンドライン引数から10進数の値を入力して 2進数に変換して出力しようとしています。 ※入力される10進数の値はかなり大きなものを想定しています。 現在は下記のようなコードで変換しようとしていますが失敗しています。 動作環境は『WindowsXP、Activeperl-5.12.4.1205』です。 拙い説明ですが、よろしくお願いいたします。 # コマンドライン引数は「9223372036854775808」 $n = unpack("B8", pack("C", $ARGV[0])); print n; # 実行結果は「11111111」 # 期待している出力結果は「1000・・・000」（←0が64個） 9223372036854775808
初めて質問させていただきます。 perlに関しては素人でうまくいかず悩んでおります。 皆様のお知恵を拝借できればと思います。 linuxで下記のようにamezo.cgiからファイルを作りたいのですが、 ファイルを生成したい場所だけ作成することが出来ません。 amezo.cgiと同じフォルダや上位フォルダ（htmlフォルダ）にはhtmlファイルを作成できるのですが、 testbbsフォルダを指定したら生成できなくなってしまいます。 なんらかの環境変数なり指定する必要があるのでしょうか？ ご教授よろしくお願いいたします。 html-------testbbs------ファイルを生成したい場所 　　　　| 　　　　| 　　　　-----cgi-bin-----amezo.cgi | .....
ActivePerl-5.14を使っているのですが、文字コードの変換はどのようにすればいいのでしょうか。 ローカル環境で動かしているのですが、Shift-JISのテキストを読み込んで、EUC-JPに変換したいと思っているのですが、 今まで5.8を使っていたので、Jcodeを使って、&Jcode::convert(\$txt,'euc'); としていたのですが、5.14ですと use Jcode;　 の時点でエラーになってしまいます。 use Encode; を使って、 from_to($txt, 'shiftjis', 'euc'); としてみましたが、 from_to($txt, 'shiftjis', 'euc'); のところでエラーになってしまいます。 ActivePerl-5.14ですと、どのように文字コードの変換をすればいいのでしょうか。 どなたか教えてください。 よろしくお願いいたします。
この前、フォルダ内のファイル一覧を取る関数を教わりました。 @files = glob "$folder*"; そこで質問ですが、 上記の$folderに他のサイトを指定することは出来ないでしょうか。 やりたいことは、ａのサイトに上記のcgiを書いて、 サイトｂのフォルダの一覧を取りたいのです。 （この質問のとおりのcgiが出来れば、$folderを指定することで汎用的に ファイル一覧が可能となるので質問しています。） 宜しくお願いします。
以下のことをやりたいのですが、 教えてください。 在るフォルダ（例えば；abc）にファイルをアップロードします。 そのファイルをユーザーにダウンロードさせるのですが、 条件として、当該ファイルの名称を変更できません。 ファイル名を固定（アップロード時に変更）できれば、 どうにでもなりますが、それが出来ないために、 アップロードされたファイルを見に行って名称を把握、リストする、 ということがやりたいのです。 一言でいうと、 フォルダにあるファイルをリストする方法が知りたいのです。 ユーザーに提供するのは、「ダウンロード.html」という格好を考えています。 このhtmlを作るcgiを考えたいのです。 宜しくお願いします。
windowsサーバーのcgi（※）にて「$ENV{'HTTP_COOKIE'}」でcookieの値が正常に取得できてましたが、 linuxサーバーにそのソースをそのまま移行し、動作確認したところ「$ENV{'HTTP_COOKIE'}」でcookieの値が取得できなくなってしましました。 （※）・・・ショッピングカートの処理 ちなみにSSLを使用しているページです。 (1)画面Ａ（ｈｔｔｐ）から「カート入れる」ボタンをクリックし、画面Ｂ（ｈｔｔｐｓ）に遷移 (2)画面Ｂに遷移した際にcookieに取得、保存 要するにｈｔｔｐｓでセットしたものをｈｔｔｐｓゲットしようとしています。 サーバーの環境は以下となります ■windowsサーバー ・OS　：　Windows 2003 R2 SP2 ・Perl ver　：　5.8.7 ■linuxサーバー ・OS　：　Red Hat Enterprise Linux 4 ・Perl ver　：　5.8.8 ・パーミッション　：　757 ロジックは変更していないのでおそらくサーバーのどこかの設定を変更しなければならないのではないかと思われますが、どこに手を付けてよいのかがわかりませんので ご教授していただきたいです。 宜しくお願い致します。
Active Perlの最新版(x86)を使っています。 C言語側で、 //配列の先頭要素へのポインタと配列の要素数を渡すと、要素の平均を整数で返す関数 int avr(int *array,int kazu) { int value=0; for(int i=0;i<kazu;i++) { value+=*(array+i); } return value/kazu; } などと書いて、avr.dllとしてビルドしたものを(モジュール定義はdefファイルにて指定)、 use Win32::API; my $function = Win32::API->new("avr", "avr", "PN", "N"); @array=(1,2,3,4,5); $avr=$function->Call(\@array,5); print "Content-type: text/html\n\n"; print $avr; と使ってみたのですが、出力値が期待の「3」ではなく、-123343252とか435893497などの無茶苦茶な数値になってしまいます。 配列のポインタの渡し方が違うのかとは思いますが、どう書いたら良いのか分からない状況です。 一応、他のプログラムからこのdllを使うと、正常動作するようです。
windowsサーバーのcgi（※）にて「$ENV{'HTTP_COOKIE'}」でcookieの値が正常に取得できてましたが、 linuxサーバーにそのソースをそのまま移行し、動作確認したところ「$ENV{'HTTP_COOKIE'}」でcookieの値が取得できなくなってしましました。 （※）・・・ショッピングカートの処理 ちなみにSSLを使用しているページです。 サーバーの環境は以下となります ■windowsサーバー ・OS　：　Windows 2003 R2 SP2 ・Perl ver　：　5.8.7 ■linuxサーバー ・OS　：　Red Hat Enterprise Linux 4 ・Perl ver　：　5.8.8 ・パーミッション　：　757 ロジックは変更していないのでおそらくサーバーのどこかの設定を変更しなければならないのではないかと思われますが、どこに手を付けてよいのかがわかりませんので ご教授していただきたいです。 宜しくお願い致します。
パールのファイルサイズ取得について こんにちは。 パールのソースで困っているので、どなたか教えてください。 １つめのファイルサイズと、２つ目のファイルサイズを取得して 比較するソースを書いたのですが、ファイルが0byteであった場合、 変数に入れるところで失敗するのでしょうか？ また、変数に入れるところではうまくいったとしても、比較で 失敗するのでしょうか？ $size_a = -s $filea; $size_b = -s $fileb; if($size_a == $size_b){ ### メッセージを出力 }
現在、windowsサーバーからlinuxサーバーへの移行準備をしております。 自社の方でショッピングサイトを経営しておりまして カートの部分はcgi（perl）で以下のような現象が起きています。 ■windowsでの正常な動き (1)購入ページから商品をカートに入れる（カートのページに遷移） (2)カートに入ったことを確認して買い物を続ける（購入ページへ戻る） (3)商品をカートに入れる（カートのページに遷移） (4)カートには２商品が入っている ■linuxでの動き (1)windowsと同様 (2)windowsと同様 (3)windowsと同様 (4)カートに１商品が入っている（前の商品の情報が消えている） windowsサーバーからlinuxサーバー移行時にで変更したのは以下の３点だけとなります。 (1)プログラムパス (2)ＤＢ接続情報 (3)パーミッションを755 動きだけをみるとセッション関連のところで何かやらなければいけない感じがしますが、 どこに手を付けてよいのかがわかりません。。。 プログラム修正が必要か？ 必要なモジュールが足りないのか？（具体的なモジュール） その他、目を付けるところはあるのか？ 大変申し訳ありませんが、 ご教授の方、宜しくお願い致します。
以下のような、perlの構文で$infoをmyスコープで宣言しつつ、$datという変数が真なら$infoに$datが入ることを期待しているのですが、まちがっているのでしょうか？ my $info = $dat if ($dat); よろしくお願いします。
以下のような構成のページから、前半２つの twitter ,facebook のみを 　　process '#share_item ul li', 't_url' => '@href'; のような形で抜き出したいのですが、 これだとtwitterからmixi までの情報を一気に取得してしまいます。 process '#share_item ul li', 'twi_url' => '@href'; process '#share_item ul li', 'fb_url' => '@href'; のように、それぞれ分けて取得するよい方法はありますでしょうか？ ----------(ここから)--------- <div id="share_item"> <ul> <li> <a href="http://twitter.com/share?text=（略）&via=test_mk" target="_blank" onclick="s_omni.trackSNS('twitter')"> <img src="http://aaa.com/btn1.gif" alt="twitterでつぶやく" /> </a> </li> <li> <a href="http://www.facebook.com/share.php?u=http://aaa.com/" target="_blank" onclick="s_omni.trackSNS('facebook')"><img src="http://www.aaa.com/common/btn2.gif" alt="facebookでシェア" /></a> </li> <li> <a href="mailto:?subject= 　　　　　　　　　　　　　　　　～（略）～alt=" 　　　　　　　　　　　　　　メールで知らせる" /> 　　　　　　　　　　　　　　</a> </li> <li> <a href="http://mixi.jp/recent_voice.pl?from=home_profile" target="_blank" onclick="s_omni.trackSNS('mixi')"> <img src="http://aaa.com/btn4.gif" alt="mixiで知らせる" /></a> </li> <li> <link rel="mixi-check-image" type="image/jpeg" href="http://aaa.com//img/site/3.jpg" /> <a href="javascript:void(0);" onclick="window.open('http://mixi.jp/share.pl?u=http://aaa.com/&k=cf6870bacc04932deb167c0ee0483894cf74249b','share',['width=632','height=456','location=yes','resizable=yes','toolbar=no','menubar=no','scrollbars=no','status=no'].join(','));"><img src="http://aaa.com/btn5.gif" alt="mixiチェック"></a> </li> </ul> </div> ----------(ここまで)--------- （２）これは補足的な質問なのですが、 「#share_item ul li」 のように # がつく記述と付かないパターンがあるのですが、 この違い（#が必要な時）が不明です。 ご存知の方、教えて頂ければ幸いです。
コマンドにサクラエディタで書いたファイルで実行すると、サクラエディタがでてきます。 どのようにすればいいでしょうか？ メモ帳ではうまくいきます。
以前もここで質問したものです。皆様の解答をヒントに一歩進みました。 Ｃ言語のソースコードを扱っています。 デバッグのため（関数がどういう順番で呼び出されているかを知るため）、関数の先頭にprint文をつけようと思っています。 例えば、 int hoge(引数の並び) ｛ 関数の中身 ｝ なら int hoge(引数の並び) ｛ printf("hoge"); 関数の中身 ｝ といった具合です。 関数が膨大なので、手作業で一つずつprintfを書くのは現実的ではありません。 ここで、 open(IN,"$ARGV[0]"); @array = <IN>; for($i=0;$i<@array;$i++){ if($array[$i] =~ / _*.+\(.*\)/){ $tmp = $&; if($array[$i+1] =~ "^{\n"){ print $array[$i]; print $array[$i+1]; print "printf(\"FileName:$ARGV[0] FunctionName:"; print $tmp; print "\");"; print "\n"; $i++;} else{ print $array[$i]; } }else{ print $array[$i]; } } というコードを書きました。しかしこれでもうまくいかないケースが多々ありました。 int main(void) { intro(); new_game(); /* @@@ exit(0); */ /* causes a warning in C++ */ return(0); } のように返り値が横ではなく上についていたり、 void __ast_string_field_index_build(struct ast_string_field_mgr *mgr, ast_string_field *fields, int num_fields, int index, const char *format, ...) { のように引数が複数行にわたる場合です。 どのようにしたらよいのでしょうか。 どなたか教えてもらえませんか？
パラメータqの部分にマッチさせる正規表現が分かりません。 # $urlの例 http://foo.bar/?q=hoge?&x=0&y=0 http://foo.bar/?q=perl http://foo.bar/?q=perl+%e6%ad%a3%e8%a6%8f%e8%a1%a8%e7%8f%be hoge, perl, perl+%e6%ad%a3%e8%a6%8f%e8%a1%a8%e7%8f%beだけを切り出したいのですが、現状は # hogeしかマッチしない 　$url =~ /\?q\=(.+?)&+?$/$1/; # 不要なパラメータにもマッチ 　$url =~ /\?q\=(.+?)&*?$/$1/;　# => hoge?&x=0&y=0 となっています。 よろしくお願いします。
Ｃ言語のソースコードを扱っています。 デバッグのため（関数がどういう順番で呼び出されているかを知るため）、関数の先頭にprint文をつけようと思っています。 例えば、 int hoge(引数の並び) ｛ 関数の中身 ｝ なら int hoge(引数の並び) ｛ printf("hoge"); 関数の中身 ｝ といった具合です。 関数が膨大なので、手作業で一つずつprintfを書くのは現実的ではありません。 関数の最初の１行のパターンマッチは、/int\s\w*(.*)/ でうまくいくのですが、次の行の｛まで含んだ正規表現に対応させるやり方がわかりません。 また、printf文を読み込んだソースコードに挿入するにはどうしたらよいのでしょうか。 どなたか分かる方がいらしたらご教授よろしくお願いいたします。
たびたびお世話になります。 データには、「データNO」「登録NO」「名前」「カテゴリー」「金額」が登録されています。 もともとあったデータをフォームで編集、送信してデータＮＯ（$d_no)と一致した行だけを書替え（上書き）したいんですが、どうしても方法がわかりません。 open(IN,"../save_data/sdeta.txt"); @data = <IN>; close(IN); foreach(@data){ chop($sdata); ($d_no,$s_no,$s_name,$d_class,$s_price) = split (/=/, $sdata); if( $value eq $d_no){ $sdata="$in{'d_no'}=$in{'s_no'}=$in{'s_name'}=$in{'d_class'}=$in{'s_price'}\n"; }else{ $sdata="$d_no=$s_no=$s_name=$d_class=$s_price\n" } } open(OUT,">../save_data/sdeta.txt") || &error("オープンエラー"); print OUT @data; close(OUT); 上のプログラムを書いても、書替えできませんでした。 どのように直せば一行のみの書替えが出来るんでしょうか。 よろしくお願い致します。
PHPを毎日書いている者ですが、たまたまPerlのメールフォームをカスタマイズ しなければならなくなりました。 use strict宣言がある場合、変数はmyまたはlocalで宣言しなければいけないようですが、 サブルーチン内に sub form { ・・・ my ($form_value,$error_list) = @_; ・・・ print $error_list{'inquiry_type1'} としたところ、 Global symbol "%error_list" requires explicit package name at ・・・ と、宣言が無い場合に出るというエラーが出ました。 $error_listには、inquiry_type1は入っているはずなのですが、どのような 宣言をすればよいのでしょうか？ よろしくお願いします。
こんにちは。 sedコマンドは、texに付属していた日本語対応のものを使用しており、 perlはWindows用のActive Perl v.5.12.2を使用しています。 カレントディレクトリにあるファイルやフォルダにおいて、 名前を一括して変換したいと思い、以下のようなNameConv.batというバッチスクリプトを作成しました。 ____________________________________________________________ @echo off for /f "delims=" %%a in ('dir /b !opt!') do ( for /f "usebackq delims=" %%b in (`echo %%a^| sed -e "s/%~1/%~2/g"`) do ( move /y "%%a" "%%b" 1>nul 2>nul if not "%%a"=="%%b" echo 「%%a」→「%%b」 ) ) ____________________________________________________________ このバッチスクリプトを NameConv.bat " " "_" の様にして呼び出すと上手く行きました。 (この場合は、カレントディレクトリの全てのディレクトリとフォルダの名前において、 スペースがアンダーバーに変換されました。) ところが、 NameConv.bat "スペース" " " のように、第一引数に変換文字列に2バイト文字を使用すると、 以下のようなエラーメッセージが出て上手く行きませんでした。 sed: -e expression #1, char 14: Unterminated `s' command どうやら、 echo %%a| sed -e "s/スペース/ /g" といったコードは、上手く行かなかったようです。 そこで、この問題を解決しようと、以下のようなNameRep.plというPerlスクリプトを作成しました。 ____________________________________________________________ #日本語を扱うために必要な設定 use encoding "cp932"; use open ":encoding(cp932)"; use open ":std"; map{ binmode($_,":crlf"); } qw/STDIN STDOUT STDERR/; #置換操作 $name="$ARGV[0]"; $name =~ s/$ARGV[1]/$ARGV[2]/g; print "$name"; ____________________________________________________________ そしてこのスクリプトを for /f "delims=" %a in ('dir /b') do ( @perl NameRep.pl "%a" "スペース" "_" ) の様にしてコマンドラインから呼び出すことで、「スペース」という文字列が、 きちんと処理できるかを試したところ、以下のようなエラーメッセージが出ました。 Unmatched [ in regex; marked by <-- HERE in m/\x{00d8}\x{00f9}\x{005b} <-- HERE \x{00d8}/ at C:\Users\kei\NameRep.pl line 11. どうやら $name =~ s/$ARGV[1]/$ARGV[2]/g; の部分で、$nameや$ARGV[1]に2バイト文字が含まれていると、上手く行かないようです。 #日本語を扱うために必要な設定 以下のコードブロックで、シフトJISに対応できるはず(少なくとも今までは問題なく扱えました) なのですが、何故か上手く行きません。 そこで、sedコマンドやperl、特にperlにおいて、シフトJISコードでの2バイト文字の扱い方を御存じの方に、何かアドバイスを頂きたいと考えています。 長くなりましたが、どうぞよろしくお願い致します。
問題を突き止めるため、コードをここまで小さくしましたが、まだエラーが出ます・・・ use strict; $_ = [0, 1]; grep($_ == $$_[0], 0, 1) このコードはgrepの中で$_をデリファレンスしているだけです。 これを実行すると、 Can't use string ("0") as an ARRAY ref while "strict refs" in use というエラーになってしまいます。 ううむ、どこかでシンボリックリファレンスを使っているのでしょうか
海外製のプログラムを日本語対応に修正しているのですが「～」が文字化け（?）になります。 下記がコードの一部を抜粋したものです。 $message=jcode($message)->sjis; my $msg = MIME::Lite->new( Type =>'multipart/mixed', From =>$fromaddr, To =>"$to", Subject =>"$subject", Type => "text/plain; charset=\"iso-2022-jp\"", Data =>"$message" ); 「～」だけが文字化けします。 下記のように文字コードを UTF-8 にすると文字化けしませんが、 メールで UTF-8 を使うのは良くないのでしょうか。 $message=jcode($message)->utf8; my $msg = MIME::Lite->new( Type =>'multipart/mixed', From =>$fromaddr, To =>"$to", Subject =>"$subject", Type => "text/plain; charset=\"utf-8\"", Data =>"$message" ); これだと文字化けしません。 UFT-8 でメールを送信しても問題ないのか、 また、問題の有無に関係なく iso-2022-jp で文字化けしない方法を ご教授いただけないでしょうか。 よろしくお願い致します。
プログラム初心者です。 Perlで下記のような文字列処理のプログラムの書き方がわからず、質問させて頂きました。 【内容】 FILE_A.txtが「!」マークで区切られていて、「!」マークの下行の文字列をIPアドレスの右横に移動したものをFILE_B.txtに出力するという処理です。 「!」マークの下行の文字列の「name」は共通です。 -------------------------------------------- 【FILE_A.txt】 ! name abcdeLV 123.123.123.123 123.123.123.124 123.123.123.125 ! name fghijLV 10.10.10.11 10.10.10.12 10.10.10.13 10.10.10.15 10.10.10.16 ! -------------------------------------------- ↓ -------------------------------------------- 【FILE_B.txt】 123.123.123.123 abcdeLV 123.123.123.124 abcdeLV 123.123.123.125 abcdeLV 10.10.10.11 fghijLV 10.10.10.12 fghijLV 10.10.10.13 10.10.10.15 fghijLV 10.10.10.16 fghijLV -------------------------------------------- 上記のようなPerlでの処理を具体的に教えて頂ければうれしいです。 本サイトのようなものを利用するのが初めてですので、不手際があるかもしれませんが なにとぞよろしくお願いいたします。
お世話になります。 早速ですが、 cgiで日記を作って、毎日入力しています。 現在の機能として最新分のみは修正が可能です。 （最後のレコードを表示し、修正して、置き換え） このほど、任意の日付分を修正できるようにしたいなと思い検討を開始しました。 そこで質問ですが、 どのような考え方をすればよいのでしょうか。 私のレベルで思いつくのは、 １件ずつ該当の日付が来るまでコピーしながら読んで行き、 該当日付が出てきたら表示、修正させ、置き換える、 そして残り分をコピーする、です。 こんな方法しかないでしょうか。 ズバリ、該当の日付分を抽出できるような考え方は無理でしょうか。 日記のフォーマットは単純なテキストで、１日単位で１レコード（長さ可変）になっています。 宜しくお願いします。
初めて質問します。 Perlを使って下記のようにテキストを変換したいんですけど、やり方を教えてください>< 【変換前】 A 1234 A 2345 B 3456 B 4567 【変換後】 >Af >1234 >As >2345 >Bf >3456 >Bs >4567 というふうに並び変えたいんですけど、なにぶんプログラミング初心者なもので、 よろしくお願いいたします。
テキストファイルをperlを使用して下記のように 変換したいと思っています。 --------------------------- 【変換前】 aaa 8000 52 ---1行目 abc 200 48 ---2行目 cbd 250 31　　　---3行目 efg 98 45　　　---4行目 abc 390 68　　　---5行目 ddd 89 90　　　---6行目 aaa 65 40　　　---7行目 fed 900 66 　　---8行目 efgh 99 49 ---9行目 abc 40 40 ---10行目 【変換後】 aaa 8000 52 　　---1行目 cbd 250 31　　　---3行目 efg 98 45　　　---4行目 abc 390 68　　　---5行目 ddd 89 90　　　---6行目 fed 900 66 　　---8行目 efgh 99 49 ---9行目 ---------------------------- やりたいことはまず行の先頭文字列(aaaやabc)が完全に一致する行が 複数あれば(2,5,10行目のabcや1,7行目のaaa)、2番目の文字列(スカラー値)の値が 小さい方の行は出力しないようにしたいと思っています。 例えば上記の場合ですと、2,5,10行目の最初の文字列はaaaで完全に一致しており、 2番目の列の値は5行目が390に対し、2行目は200、10行目は40と小さくなっているため 2行目,10行目は出力されない、というのが望んでいる動作です。 sortを使用してどうにかならないかとも、考えたのですが そこから先がどうしていいか思いつきませんでした。 何かよい方法を思い浮かぶ方がいましたら、どのようにPerlで記述すればよいのか 教えて頂けないでしょうか？ 宜しくお願いいたします。
皆さんCPANをインストールする際 perl -MCPAN -e shell とコマンドラインで入力されていると思いますが、 perl 以降の引数の中で 「shell」 について正確な意味を教えていただけませんでしょうか。 現在下記のものは理解しております。 ■「-MCPAN」について http://homepage3.nifty.com/hippo2000/perltips/CPAN.htm ※こちらの質問でも言及あり http://oshiete.goo.ne.jp/qa/2460025.html ■「-e」について http://www.rfs.jp/sb/perl/02/12.html -eオプション以降にshellと入力するとどんな意味があるのでしょうか。 ご教授お願いいたします。
現在、Perlを用いてtxtファイルから必要なデータだけを取り出し、それをcsv ファイルに出力したいと考えております。 Perlはほとんど触ったことがなく、色々と勉強しながら行っているのですが、期 日が迫っているという事情もあり質問させていただきます。 txtファイルには以下のような文が1000行ほどあります。 *○ △ /△/△/△/△/○.txt, ○|○): ○ ○,△:任意の数字、または文字列です。 この内、"○"のものだけを一つ一つ分けてcsvに出力したいのです。 つまり○は4つありますが、出力する際は1つ目の"○"を1行目に、2つ目の"○"を2行 目にといった形にしたいです。 そして、それが1000列分あるということになります。 上手く△のものだけを除外し、○だけを抽出する方法はあるでしょうか？ どなたかよい方法をご存知のかたいらっしゃいましたら、教えていただけると幸 いです。 エクセルで行うということも考えましたが、htmlファイルが入力ファイルとなる可能性もあるためPerlで行うことにしました。
ユーザーエイジェントを検索して UP.Browserという文字列があった場合、 ユーザーエイジェントをauという置き換え表示したいと思っています。 具体的には KDDI-KC3R UP.Browser/6.2_7.2.7.1.K.4.310 (GUI) MMP/2.0 ↓ au と表示したいのですが、 Perlで記述する場合以下のように書いて間違えありませんか？ 間違いなどありましたご指摘ください。 if($ENV{'HTTP_USER_AGENT'} =~ /UP.Browser/) { $agent=~s/$ENV{'HTTP_USER_AGENT'} /au/g; }
perl超初心者で、初歩的な質問です。 辞書データから不必要な文字を取ろうと思っています。 ところが最初のファイルの入出力から行き詰っています。 処理が終わると空ファイルができます。 下が使いたい辞書データです。 ------------------- word,trans,exp,level,memory,modify,pron,filelink "さらさら","(adj-na,adv,n,vs) (1) rustling/murmuring/(2) fluently/(3) silky (hair)/(P)","",0,0,0,"" "さらば","(conj,int) farewell","",0,0,0,"" "さん","(suf) Mr or Mrs/(P)","",0,0,0,"" "さーたーあんだぎー","(n) type of Okinawan doughnut (donut)","",0,0,0,"" "さ来週 [さらいしゅう]","(n-adv,n-t) week after next","",0,0,0,"" "さ迷う [さまよう]","(v5u) to loiter/to putter/to prowl/to wander about/to roam about/to knock around","",0,0,0,"" "ざあざあ","(adv) sound of rushing water/sound of pouring rain/white noise sound/(P)","",0,0,0,"" ------------------- そして下が組んだものです。 use encoding "cp932"; $/ = "\r\n"; open(DIC, "< dicdata.csv") or die "$!"; while(<DIC>){ } close (DIC); if($a =~ /&quop/){ $a =~ s/&quop//g; } open(DIC, "> dicdata.csv") or die "$!"; close (DIC); -------------- なにとぞお願いします。
最近Perlを勉強し始めたのですが、正規表現の扱いに困っています、よろしくお願いします。 rog.txt <usr1> ～～ (usr2) ～～ usr3 > ～～ <usr1> ～～ usr3 > ～～ というようなテキストの、ユーザー表示部分（ユーザー名の囲い方はcgi側からは指定できない）を、利用者がhtml上のフォームから 「<usr1> 」は「○○」に 「(usr2) 」は「××」に... というように指定して一気に変換するcgiを作っています。 ユーザー名部分だけを配列に溜めて、フォームを表示して、変換指定を受け取るところまではできたのですが 最後の変換の部分で上手くいかなくて困っています。 @oldRog には上記のテキストを読み込んで1行ごとに代入 @tmpOldName にはフォームから受け取った古い名前を代入 @tmpNewName にはフォームから受け取った新しい名前を代入してあります $i = 0; foreach(@oldRog){ 　 　 $j = 0; 　 　 $tmp = $_; 　 　 foreach(@tmpOldName){ 　 　 　 　 $tmp =~ s/^$tmpOldName[$j]/$tmpNewName[$j] /; 　 　 　 　 $j = $j + 1; 　 　 } 　 　 $rog[$i] = $tmp; 　 　 $i = $i + 1; } 実行してみるとユーザー名を囲う印に"("などが使用されているとその名前が全て変換されません おそらく正規表現上で意味のある"("と解釈されているのだろうと考え エスケープさせるために"\"を使おうと思ったのですが、 $tmp =~ s/^\$tmpOldName[$j]/$tmpNewName[$j] /; としてみてもうまくいきませんでした。 先にテキストファイルのほうで半角（から全角（に変換する等して回避はできたのですが できれば変換の部分だけで処理したく思っています よろしくお願いします *タブが消えてしまっていたので上げ直しました、ここの使い方にまだ慣れておらず申し訳ありません
2種類のファイルがあり、これを下記のルールによりくっつけたいと考えています。 データ数の多さから　ファイル１のデータを1行ずつみていき、ファイル２に条件に等しいものがないか確認して書き出しをするというやり方では、 時間がかかってしまい、効率よい書き方を教えていただきたいのです。 ファイル１：100万行 カラム１<タブ>カラム2<タブ>カラム3<タブ>カラム4　　各カラムは可変長の値（各カラム、行重複値あり） 例　AAA<タブ>BB<タブ>CC<タブ>DDDD 　　AAA<タブ>BBB<タブ>CC<タブ>DD 　　XX<タブ>BB<タブ>YYY<タブ>Z 　　・・・ ファイル2：10万行 カラム5<タブ>カラム6<タブ>カラム7　各カラムは可変長の値（各カラム重複値あり、カラム5とカラム7のセットで一意データ） 例　BB<タブ>EEE<タブ>RRR 　　BB<タブ>EEE<タブ>SS 　　BB<タブ>FF<タブ>TTTT 　　W<タブ>EEE<タブ>TTTT 　　・・・ 条件： カラム2=カラム5のとき、 結果： カラム１<タブ>カラム2<タブ>カラム3<タブ>カラム4<タブ>カラム6<タブ>カラム7　というものを出力させる 例　カラム2（BB）=カラム5（BB) AAA<タブ>BB<タブ>CC<タブ>DDDD<タブ>EEE<タブ>RRR AAA<タブ>BB<タブ>CC<タブ>DDDD<タブ>EEE<タブ>SS AAA<タブ>BB<タブ>CC<タブ>DDDD<タブ>FF<タブ>TTTT ・・・ ※カラム2（BB）=カラム5（BB）のとき、ファイル2のカラム5にBB存在する行分　ファイル1の内容がカラム6、7を追加し増えていくようにしたいのです。 よいプログラムを教えてください。
my @a = qw(a b c); my @b = ( qw(e f g) ); これの違いは何なのでしょうか？ perlにおいて()で囲むのはリストとして扱うということなのでしょうが、いまいちよく分かりません。 教えてください
perl初心者です。 以下のxmlデータの「http://www.google.co.jp」をxml解析して値を取得したいのですが、 どのようなプログラムを記述すればよろしいのでしょうか？ <?xml version="1.0" encoding="x-sjis-cp932" ?> <Res_result> <result result="1" /> <result redirect="http://www.google.co.jp" /> </Res_result> いろいろ試してみましたが、どうもうまくいきません。 ちなみにサーバーにインストールされているxml関連のモジュールが XML::Simple XML::Parser となります。 ご教授の方、宜しくお願い致します。
perlについて学習中で、現在フリーのスクリプトを見て勉強しております。 中括弧の使い方を教えて欲しいです。 sub test { print"OK"; } if ($test>1) { print"OK"; }else{ print"NG";} 上記のようにサブルーチンやif文での使い方は分かるのですが、フリーのスクリプトの中に単に中括弧を使用している部分がありました。 例） { ←この括弧 　　　my(@new); 　　　for(0..3){if($tmp[$_]=~/jpg/){push(@new,$tmp[$_]);}} } 矢印の部分の部分の括弧ですが、これはどのような意味があるのでしょうか？ よろしくお願いします。
Perlのコードを動かしながら勉強していて、ふと納得いかない点があったので教えてください。 次のコードを実行すると'0'と表示されます。 Cls->new; package Cls; sub new {bless([])} sub AUTOLOAD {print(0)} つまりAUTOLOADサブルーチンが実行されているようです。 しかし私のコードの中ではAUTOLOADサブルーチンの定義はしているものの、どこからも呼び出していません。 このコードは何も行わずに終了するはずなのですが、そうではありませんでした。 AUTOLOADサブルーチンは、いつ、どこで、何者によって呼び出されるのでしょうか。
プログラム自体初心者です。というかほぼ知識ゼロです。 次の会社では perl (sledge) で開発をすることになっていて、入社までの間勉強したいと思います。 一番いい覚え方としては、どっかのアプリのコードを読むことだと思っているので、 そういったオープンソース的なの紹介しているサイトってありますか？ moongift以外で・・・。 ちなみに、linux サーバエンジニアとして、3年の経験があります。
Perlで質問です。 「<div class="testclass"> <a href="test.php?filename=1600176008&s2=1307521989&s3=&p=1"><img src="test.jpg"></a>」 上記のデータのリンクのURL「test.php?～～」の部分を抽出したいです。 split("href=\"",$data); みたいな感じで前と後ろをsplit関数で消せば取り出せると思ったのですが、他に良い方法はありますか？
以下の環境で開発をしています。 OS: windows XP ActivePerl 5.8.8 apache 2.0.64 レンタルサーバで利用しやすいようにperlスクリプトの第1行目に #!/usr/bin/perl を記述していますが、ActivePerl のありどころが　C:\dev\perl\bin\なので第1行目を #!/dev/perl/bin/perl　 にしなければなりません。 #!/usr/bin/perlの記述をそのまま使う為に巷でよく言われているようなwindowsのジャンクション機能を利用しています。 Cドライブ直下に「usr」ホルダを作り、ここにC:\dev\perl\bin\のジャンクションを設定しました。 するとC:\usr\を覗くとbin\が存在します。つまりC:\dev\perl\bin\はC:\usr\bin\でアクセスできるようになります。 しかしこの状態で#!/usr/bin/perlの記述をそのまま使うと500エラーが出ます。 これ以外に何か良い方法はございませんでしょうか? また同じような開発環境の皆様はperlスクリプトの第1行目をどのように対策されていますでしょうか? 宜しく御教授お願いいたします。
perl初心者です。 説明不足の箇所もあるかと思いますが、よろしくお願いします。 テキストデータから指定した１行を抜き出して表示するのにはどうしたらいいんでしょうか。 data.txtの中に＝で区切られた文字が入っているとします。 1=にんじん=150 2=じゃがいも=200 3=たまねぎ=100 左から$s_no,$s_name,$s_priceという変数になっています。 これを print <<"EOF"; <TABLE class="list_index"> EOF open(IN,"../indata/sdeta.txt"); @data = <IN>; close(IN); foreach $sdata (@data){ chop($sdata); ($s_no,$s_name,$s_price) = split (/=/, $sdata); print <<"EOF"; <TR> <TD class="list2">$s_no</TD> <TD class="list3">$s_name</TD> <TD class="list4">$s_price円</TD> <TR> EOF } print <<"EOF"; </TABLE> EOF という感じでテーブルにデータを全て一覧表示させました。 ここから、$s_noで表示されている「1」「2」「3」をクリックすると、 別ページにとんで、クリックした番号の１行を編集用のフォームに表示させたいです。 フォームに表示させる方法はわかっているんですが、 クリックで指定した1行だけを表示する方法がわからずに困っています。 よろしくお願い致します。
my $packetcount : shared = 0; にある :shared は何でしょうか。 our $packetcount = 0; とおなじでしょうか。 また :shared 以外にもこういった使い方をするものはあるのでしょうか。
下記のprintコマンドで表示される内容を配列へ格納したいと考えております。 print join(".", &ipunpack($n+$i))."\n"; ※"&ipunpack($n+$i)"はサブルーチンで戻ってくる値です。 どこらへんに@・・・・・をつければよろしいでしょうか。
perlでの比較について Perlで以下のことをしたいと考えております。 ”文字列全一覧”の中に文字列が数千個ほど並んでいます。 文字列が数百個かいてあるテキストファイルが数百個ほどあります。 その文字列のテキストファイルに書かれている文字列全てが”文字列全一覧”の中にある文字列と 完全一致しているか、完全不一致している、部分一致しているか仕分けたいです。 【文字列全一覧】 ABC XYZ AAA ccc DADA ABCDEFG 【文字列ファイル1】 AAA bbbb xyz SSSSSS 【文字列ファイル2】 AAA ccc DADA 【文字列ファイル3】 ABCDGHJ XYZ AAA ABC 【文字列ファイル4】 ZZZZZZ ｌｌｌｌｌｌ ５６７８９０１ KIKIKIKI 【文字列ファイル・・・】 ・・・・・ ・・・・・ このような感じでファイルがあります。(ちなみに上記の場合、”文字列ファイル2”が完全一致で”文字列ファイル4”が完全不一致、”文字列ファイル1”と”文字列ファイル3”が部分一致になります。) どなたか教えていただけないでしょうか(涙)
先日、 joinした際、同じidのものは　纏まってくれたらハッピーだと考えました。 あれそれ動かしてきたのですが、出力結果でゴニョゴニョ行うのではなく、 一発で　目的の出力結果にならないものでしょうか。 よろしくお願いします。 テーブル１ a___b___c_ 1___BB__CC 2___BB__CC 3___BB__CC テーブル２ d___e___f D___E___1 D___E___2 D___E___2 結合テーブル a___b___c___d___e___f 1___BB__CC__DD__EE__1 2___BB__CC__DD__EE__2 2___BB__CC__DD__EE__2 3___BB__CC__ 出力結果 $VAR1_=_[ __________{ ____________'a'_=>_1, ____________'b'_=>_BB, ____________'c'_=>_CC, ____________'d'_=>_DD, ____________'e'_=>_EE, ____________'f'_=>_1, __________}, ____________[ ______________{ ________________'a'_=>_2, ________________'b'_=>_BB, ________________'c'_=>_CC, ________________'d'_=>_DD, ________________'e'_=>_EE, ________________'f'_=>_2, ______________}, ______________{ ________________'a'_=>_2, ________________'b'_=>_BB, ________________'c'_=>_CC, ________________'d'_=>_DD, ________________'e'_=>_EE, ________________'f'_=>_2, ______________}, ____________] __________,{ ____________'a'_=>_1, ____________'b'_=>_BB, ____________'c'_=>_CC, ____________'d'_=>_, ____________'e'_=>_, ____________'f'_=>_, ___________}, よろしくお願いします。
みなさま初めまして。 現在、perlでcgi作成の練習を行っているのですが、主題の件で躓いてしまいました。 似た質問を参照したのですが、上手くいかない為質問させて頂きました。 以下が実現したい内容です。 1.a.cgiにおける変数$numの値を、b.cgi表示したい。 2.cgi-lib.plを用いて開発したい。 開発環境は以下の通りです。 OS : Ubuntu 10.10 CPU : corei5 Perl : v5.10.1 Editor : gedit 色々試行錯誤したのですが、実現できなかったのでサンプルプログラムを 書いていただければ非常に有難いです。。。 どなたかご存知でしたら、申し訳ございませんが御教授お願い致します。
グローバルな特殊ファイルハンドル_（下線）について、プログラミングPerlでは、 最後に実行したstat、lstat、ファイルテスト演算子の情報をキャッシュするのに用いる特殊ファイルハンドル と説明してあります。 これを試すために、 -f('file'); print(<_>) このコードを実行すると、 readline() on unopened filehandle _ となってしまいます。 特殊ファイルハンドル_（下線）はどうやって使うのでしょうか
構文は以下の通りです。IF文のところがおかしいようですが、どこに間違いがあるのか教えていただけないでしょうか。 sub ippack { my ($a, $b, $c, $d) = @_; return ($a << 24) | ($b << 16) | ($c << 8) | $d; } sub ipunpack() { my ($n) = @_; return (($n>>24)&0xFF,($n>>16)&0xFF,($n>>8)&0xFF,$n&0xFF); } open (IN,"<useIP.txt") while(my $input = <IN>) { if ($input =~ /([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+) ([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/){; my $n = &ippack($1,$2,$3,$4); my $m = &ippack($5,$6,$7,$8); $n = $n & $m; $m = ~$m & 0xFFFFFFFF; for(my $i = 0; $i <= $m; $i++) { print join(".", &ipunpack($n+$i))."\n "; } } if-else($input =~ /([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/);{ print "$input\n"; } print "\n"; }
>AA A AAA aaaaaaaaaaaaaaa aaaaaaaaaaaa >BBB BB B bbbbbbbbbbbbbbb bbbbbbbbbbbbbbb bbbbbbbbbbbbbb ・ ・ こういった形式でテキストが入った大きいサイズのひとつのファイルを ・ファイル名 AA A AAA ・テキスト内 >AA A AAA aaaaaaaaaaaaaaa aaaaaaaaaaaa ・ファイル名 BBB BB B ・テキスト内 >BBB BB B bbbbbbbbbbbbbbb bbbbbbbbbbbbbbb bbbbbbbbbbbbbb となるように個別に出力させたいのですがどのようにすればよいでしょうか？ #!/usr/bin/perl -w use strict; my $first; my $file; $first = 1; open(IN,"分割前ファイル"); foreach(<IN>) { if ( /^>(.*)/ ) { if ($first == 0 ) { close(OUT); } else {$first = 0; } $file = $1; $file =~ s/[\r\n]//; open(OUT,">$file"); } else { print OUT $1; print OUT $_; } } close(IN); このようなプログラムを組んだのですが、出力結果はファイル名についてはいいのですが、テキスト内が思ったようにいきません。 ・ファイル名 AA A AAA ・テキスト内 AA A AAAaaaaaaaaaaaaaaa AA A AAAaaaaaaaaaaaa このような結果になってしまいます。 どなたか対処方をわかるかたがいましたらお願いします。
perlで、URLからサイトが表示されるかを確認するプログラムを作成しました。 ただ現在の方法だと、チェックするデータ件数が多くなるとエラーとなってしまいます。 現在のソース (ここから) open(DB,"$memfile") || &error("Open Error : $memfile"); flock DB, 2; @lines = <DB>; close(DB); @new=(); foreach $line (@lines) { $flag=0; ($num,$url,$title) = split("<>", $line); &url_ckeck("$url"); $data = "$num<>$url<>$title\n"; $data =~ s/\n<>/<>/g; $data =~ s/\r\n<>/<>/g; $data =~ s/\r<>/<>/g; push(@new,$data); } open OUT, "> $memfile"; print OUT @new; close OUT; (ここまで) この方法だと300件を超えると「ページが表示出来ない」エラーがでてしまうので、 チェックの方法を小分けしてエラー回避できないかを考えているのですが、とのようにすれば良いのかがわからず先に進められなくなってしまいました。 プログラムも見よう見真似で作成しているのでおかしな箇所が多々あるかと思いますが、助けていただけないかと思い書き込みました。 「$line (@lines)」を「$start .. $end」として件数を小分けにしてボタンを表示させてクリックして進められるようにしてみたらとも思いましたが データがうまく更新出来ずにいます。 不明点はご指摘ください。 よろしくお願いいたします。
何万行も書いてあるテキストファイルがあります。抽出したい文字列の一覧がテキストファイルにまとめられています(文字列は約1000個)。抽出したい文字列は一行にひとつづつ書かれています。何万行も書いてあるテキストファイルから抽出したい文字列と二つ合致したらその行を抽出したいです。ここで、注意していただきたいのが、抽出したい文字列一覧から二つの文字列にヒットした行を抽出したいです。宜しくお願い致します。 何万行も書いてあるテキストファイル aaaaa abc edi bb aert kkkkkkkkkk lllllll ddddd aaaaa anhi kkk　　　 ・・・・・・・・ ・・・・・・・・ 抽出したい文字列一覧のテキストファイル aaaaa bbbbb ddddd iiiiiiiii eeeee ・・・・・ ・・・・・
sjisで保存されたファイルを読み込んで、別ファイルに書込みを行ったところ、能等の文字が文字化けを起こしました。 open(IN,"$file"); my $data = <IN>; close(IN); $data=~s/\\//g; open(OUT,">$file2"); print OUT $data; close(OUT); 莫大なソース量だったので、原因を探すのに時間がかかりましたが、一つ一つ消去しながら探したところ、 $data=~s/\\//g; これを消すことで解消しました。 文字化けさせずに\を消すにはどのように書けばいいのでしょうか？
何万行もあるACLがあり、使用されていないIPが半分近く混ざっています。、使用中のIPアドレス帯(約1000個)が分かっています。その使用中のIPアドレス帯がソースとデストの両方に入っている行のみ抽出したいです。 抽出するためのツール(perl)を作成していますが、なかなか思いつきません。perlかマクロなどで良い方法がありましたら、ご教授いただけると幸いです。何卒宜しくお願い致します。
read.cgi #------------------------------------------------- # BBCode（特定の文字列をHTMLタグに変換） #------------------------------------------------- sub bbcodecnv { my $str = shift; $str =~ s/\[b\](.*?)\[\/b\]/<b>$1<\/b>/ig; $str =~ s/\[i\](.*?)\[\/i\]/<i>$1<\/i>/ig; $str =~ s/\[u\](.*?)\[\/u\]/<span style=\"text-decoration:underline\">$1<\/span>/ig; $str =~ s/\[s\](.*?)\[\/s\]/<span style=\"text-decoration:line-through\">$1<\/span>/ig; $str =~ s/\[code\](.*?)\[\/code\]/<code>$1<\/code>/ig; $str =~ s/\[url=((?:htt|ft)ps?\:[\w\.\~\-\/\?\&\+\=\:\@\%\;\#\%\,]+)\](.*?)\[\/url\]/<a href=\"$1\" target=\"$target\" rel=\"nofollow\">$2<\/a>/ig; $str =~ s/\[color=(\#[0-9A-F]{6}|[A-Z]+)\](.*?)\[\/color\]/<span style=\"color:$1\">$2<\/span>/ig; $str =~ s/\[list=1\](.*?)\[\/list\]/<ol style="list-style-type: decimal">$1<\/ol>/g; $str =~ s/\[list=A\](.*?)\[\/list\]/<ol style="list-style-type: upper-alpha">$1<\/ol>/g; $str =~ s/\[list=a\](.*?)\[\/list\]/<ol style="list-style-type: lower-alpha">$1<\/ol>/g; $str =~ s/\[list=I\](.*?)\[\/list\]/<ol style="list-style-type: upper-roman">$1<\/ol>/g; $str =~ s/\[list=i\](.*?)\[\/list\]/<ol style="list-style-type: lower-roman">$1<\/ol>/g; $str =~ s/\[list\](.*?)\[\/list\]/<ul style="list-style-type: disc">$1<\/ul>/ig; $str =~ s/\[\*\]/<li>/ig; return $str; } #------------------------------------------------- # BBCode削除 #------------------------------------------------- sub bbcodedel { my $str = shift; $str =~ s/\[b\](.*?)\[\/b\]/$1/ig; $str =~ s/\[i\](.*?)\[\/i\]/$1/ig; $str =~ s/\[u\](.*?)\[\/u\]/$1/ig; $str =~ s/\[s\](.*?)\[\/s\]/$1/ig; $str =~ s/\[code\](.*?)\[\/code\]/$1/ig; $str =~ s/\[url=((?:htt|ft)ps?\:[\w\.\~\-\/\?\&\+\=\:\@\%\;\#\%\,]+)\](.*?)\[\/url\]/$1/ig; $str =~ s/\[color=(\#[0-9A-F]{6}|[A-Z]+)\](.*?)\[\/color\]/$2/ig; $str =~ s/\[list=1\](.*?)\[\/list\]/$1/g; $str =~ s/\[list=A\](.*?)\[\/list\]/$1/g; $str =~ s/\[list=a\](.*?)\[\/list\]/$1/g; $str =~ s/\[list=I\](.*?)\[\/list\]/$1/g; $str =~ s/\[list=i\](.*?)\[\/list\]/$1/g; $str =~ s/\[list\](.*?)\[\/list\]/$1/ig; $str =~ s/\[\*\]/ig; return $str; } patio.cgi # 改行をサニタイジング・BBCode削除 $com =~ s/<br>/&lt;br \/&gt;/g; $com =~ s/\[b\](.*?)\[\/b\]/$1/ig; $com =~ s/\[i\](.*?)\[\/i\]/$1/ig; $com =~ s/\[u\](.*?)\[\/u\]/$1/ig; $com =~ s/\[s\](.*?)\[\/s\]/$1/ig; $com =~ s/\[code\](.*?)\[\/code\]/$1/ig; $com =~ s/\[url=((?:htt|ft)ps?\:[\w\.\~\-\/\?\&\+\=\:\@\%\;\#\%\,]+)\](.*?)\[\/url\]/$1/ig; $com =~ s/\[color=(\#[0-9A-F]{6}|[A-Z]+)\](.*?)\[\/color\]/$2/ig; $com =~ s/\[list=1\](.*?)\[\/list\]/$1/g; $com =~ s/\[list=A\](.*?)\[\/list\]/$1/g; $com =~ s/\[list=a\](.*?)\[\/list\]/$1/g; $com =~ s/\[list=I\](.*?)\[\/list\]/$1/g; $com =~ s/\[list=i\](.*?)\[\/list\]/$1/g; $com =~ s/\[list\](.*?)\[\/list\]/$1/ig; $com =~ s/\[\*\]/ig; エラーが出てしまいます。 どこがどう間違っていますか？？ ※BBCode削除と 改行をサニタイジング・BBCode削除がたぶん ミスっていると思います。
#------------------------------------------------- # BBCode（特定の文字列をHTMLタグに変換） #------------------------------------------------- の中の、文字列なんですけれども $str =~ s/\[url=((?:htt|ft)ps?\:[\w\.\~\-\/\?\&\+\=\:\@\%\;\#\%\,]+)\](.*?)\[\/url\]/<a href=\"$jumpcgi?$1\" target=\"$target\" rel=\"nofollow\">$2<\/a>/ig; urlのものが、変になります。 http://www28.atpages.jp/wrsend1/patio/read.cgi?no=4 ↑みたいになってしまいます。 http://www.gemani.org/titi4/read.cgi?no=1391 ↑のように文字でリンクさせるにはどうしたらいいでしょうか。
#------------------------------------------------- # BBCode（特定の文字列をHTMLタグに変換） #------------------------------------------------- sub bbcodecnv { my $str = shift; $str =~ s/\[b\](.*?)\[\/b\]/<b>$1<\/b>/ig; $str =~ s/\[i\](.*?)\[\/i\]/<i>$1<\/i>/ig; $str =~ s/\[u\](.*?)\[\/u\]/<span style=\"text-decoration:underline\">$1<\/span>/ig; $str =~ s/\[s\](.*?)\[\/s\]/<span style=\"text-decoration:line-through\">$1<\/span>/ig; $str =~ s/\[code\](.*?)\[\/code\]/<code>$1<\/code>/ig; $str =~ s/\[url=((?:htt|ft)ps?\:[\w\.\~\-\/\?\&\+\=\:\@\%\;\#\%\,]+)\](.*?)\[\/url\]/<a href=\"$jumpcgi?$1\" target=\"$target\" rel=\"nofollow\">$2<\/a>/ig; $str =~ s/\[color=(\#[0-9A-F]{6}|[A-Z]+)\](.*?)\[\/color\]/<span style=\"color:$1\">$2<\/span>/ig; return $str; } #------------------------------------------------- # BBCode削除 #------------------------------------------------- sub bbcodedel { my $str = shift; $str =~ s/\[b\](.*?)\[\/b\]/$1/ig; $str =~ s/\[i\](.*?)\[\/i\]/$1/ig; $str =~ s/\[u\](.*?)\[\/u\]/$1/ig; $str =~ s/\[s\](.*?)\[\/s\]/$1/ig; $str =~ s/\[code\](.*?)\[\/code\]/$1/ig; $str =~ s/\[url=((?:htt|ft)ps?\:[\w\.\~\-\/\?\&\+\=\:\@\%\;\#\%\,]+)\](.*?)\[\/url\]/$1/ig; $str =~ s/\[color=(\#[0-9A-F]{6}|[A-Z]+)\](.*?)\[\/color\]/$2/ig; return $str; } と初期設定でありますが、 リスト形式のものは、どういう風に書いたら 良いのでしょうか？？ いろいろ調べて（試して）みたんですが、 できませんでした。 よろしくお願いします！ ちなみに、 $str =からやっぱり始まるんでしょうか？
http://www28.atpages.jp/wrsend1/patio/read.cgi?no=2 ↑リンクのことなんですが、 クッションを踏まない場合の設定はどうすればいいでしょうか？？
きりしま式 Web Patio LibertyVerを今作成しているんですが スレッドやレスを編集した時の、日時に自動変更されるっていうのは できるでしょうか？？ 例えば、今日、 2011/06/12 09:41のスレッドを変更するとき、 2011/06/14　何時何分　 としたいわけです。 編集したときの日時にしたいのですが、 どうすればいいでしょうか。
http://www28.atpages.jp/wrsend1/patio/read.cgi?no=2 ↑リンクが他サイトと共有できないとかいって ジャンプできないのですが、つなげるようにするには どうすればよいでしょうか？？
http://oshiete.goo.ne.jp/qa/6803872.html ↑の質問で、新たにプログラムを書き足すことまでは わかったのですが、どこをどう書き足せば、 リスト形式が使えるようになるのでしょうか？ いろいろしてみたんですが、わからなくて、困っています。
お世話になります。 ラクダ本こと「プログラミング言語Perl」には「2.5 名前」という項目に「厳密な話をすれば、ファニー文字の後ろに続く名前は、識別子でなくても構わない。数字で始まり、数字のみで構成される名前－たとえば$123－を使うこともできる」と書かれています。 しかし、実際に、 $123 = sqrt(5); print "5の平方根は", $123, "です\n"; というプログラムを実行すると、 Modification of a read-only value attempted at foo.pl at line 1 というエラーメッセージが出て終了します。 これは、$123というのが、正規表現でカッコによるサブパターンを取得した、123番目のサブパターンにマッチするからだと思います。 ちなみにこれを、 $012 = sqrt(5); print "5の平方根は", $012, "です\n"; と変えるとちゃんと動作します。 ということで、数字の変数名を付ける場合は、 ・$0で始まる2桁以上 ・すべて数字 という規則である、と考えていいのでしょうか。 （$0はプログラム名という特殊変数になるので。。。） つまり、本の間違いでしょうか？
を、したいのですがperlではどの様に書くのが スマートでしょうか？
perl は初心者です。よろしくお願いします。 ★無名ハッシュを作り、リファレンスをハッシュに格納する方法を採用して、試行錯誤しています。 ファイル内容は、論理行の一行毎に行頭が ”AA” のように””で囲まれています。(例文後述) しかし、行の中には「誤改行」されて正常な行が分割されていて、改行され行頭が””で囲まれていない行が存在します。（正常な行が２分割され、前半部分と後半部分が別な行文となっている） この「誤改行」を、直前にある「元の正常な分割された前半の行文」と連結して、新たな正常な行としてファイルを修正し新規テキストファイルに書きこみたい。この際、分割されていた２個の「行文」は不要になったので、新規テキストファイルには書き込まない。 この修文作業が、途中まで出来ましたが最後の不要な行の削除が出来ないので、困っています。 ------------------------------------------------------------ 対象とするテキスト内容　(下記の行番号と文字列は例示です) 1. "ABCD",あいうえおかきくけこ１２３４５６７８９　XXXXXXXXXXXX 2. "EFGH", 3. さしすせそたちつてと９８７６５４３　XXXXXXXXXXXX # ←「誤改行」の行です。 4. "IGKL",なにぬねのはひふへほ１２３４５６７８９　XXXXXXXXXXX 5. "MNOP",まみむめもやいゆえよ９８７６５４３２１　XXXXXXXXXXX 6. "QRST", 7. らりるれろわいうえを１２３４５６７８９　XXXXXXXXX # ←「誤改行」の行です。 8. 9. ------------------------------------------------------------------ 期待する修文の出力結果 (行内容は、元の行番号の順番と違っても結構です) 1. "ABCD",あいうえおかきくけこ１２３４５６７８９　XXXXXXXXXXXX 2. "EFGH",さしすせそたちつてと９８７６５４３　XXXXXXXXXXXX 3. "IGKL",なにぬねのはひふへほ１２３４５６７８９　XXXXXXXXXXX 4. "MNOP",まみむめもやいゆえよ９８７６５４３２１　XXXXXXXXXXX 5. "QRST",らりるれろわいうえを１２３４５６７８９　XXXXXXXXX 6. 7. ----------------------------------------- 私作成したスクリプトの要約は、 # 対象ファイルを一行づつ読み込む． # 末尾の改行を削除 # 誤改行の場合を正規表現で探す。$ng_gyou に格納 # その他正常行は$ok_gyou, に格納する。 # $falag に誤改行の場合は０、正常な改行の場合は１を格納 # 誤改行の場合の行番号を$count_ng に、正常な改行の場合の行番号を$count_ok に、全部の行番号は$flag_1に格納する。 # 無名ハッシュを作り，リファレンスを $ref に格納する $ref = {'nomber' => $flag_1, 'ng' => $ng_gyou, 'ok' => $ok_gyou, 'ngcount' => $count_ng, 'okcount' => $count_ok, 'flag' => $flag_ok }; $WORD{$flag_1} = $ref; # nomber:$flag_1をキーにして，リファレンスをハッシュ:%WORDに格納 # このハッシュ「%WORDを」 読み込んで、処理しました。 foreach $flag_1 ( sort { $a <=> $b } keys %WORD) { 　　 if($one->{ok} == 0) { ・・・・・・・・・・・・・・・・・ # 細部は、長くなるので省略します。（ 誤改行の連結までは成功しましたが、・・・・・・？？） 以上、質問内容が冗長になりましたが、どうか御教示下さい。
「***************** Version 2 *****************」 ↑という文字列を評価して「2」を取りたい為に「/^\*+\s*Version\s+(\d+)\s*\*+\s*$/」という正規表現を使用しています。 「***************** バージョン 2 *****************」 同様に↑という文字列を評価して「2」を取りたいので「/^\*+\s*[バージョン]\s+(\d+)\s*\*+\s*$/」としましたがうまく動きません。 日本語文字列が正しく動作していないようです。 何らかの形でエンコードして当てはめればよいと思うのですが、どのような値を設定すればよいでしょうか？ 「バージョン」以外にも「ユーザ」、「日付」などの日本語を同様にマッチさせる必要があるため、変換方法を教えて頂けると助かります。 perlはほぼ使えないため、WebやWindows上でのアプリケーションで指定文字列を渡すと変換できる物をお願い致します。 （perlは入っているためコマンドを叩けばOKというのであればそれでも構いません） 与えられる「バージョン」という文字の文字コードはSJISになります。
下記のような配列内定義サブルーチン呼び出しを作成し動作を確認しました。 次にソース２行目の「no strict;」を「use script;」に変更すると Bareword "sub1" not allowed while "strict subs" in use at refsub_OK.pl line 4. Bareword "sub2" not allowed while "strict subs" in use at refsub_OK.pl line 4. Bareword "sub3" not allowed while "strict subs" in use at refsub_OK.pl line 4. Execution of refsub_OK.pl aborted due to compilation errors. とエラーになります。 プログラムはやはり「use script;」を記述したいのですが、「use script;」を記述 したままでエラーにならない方法がありましたらおしえてください。 perlのバージョンは5.12.3、OSはWindowsXP SP3です。 よろしくお願いします。 ---ソースここから--- #!perl no strict; use warnings; my @ary = ( ("input1.txt", "save1.txt", sub1), ("input2.txt", "save2.txt", sub2), ("input3.txt", "save3.txt", sub3), ); while (@ary) { my $p1 = shift(@ary); my $p2 = shift(@ary); my $sub = shift(@ary); print "p1=[$p1] p2=[$p2] sub=[$sub]\n"; &$sub("$p1", "$p2"); } sub sub1 { my ($p1, $p2) = @_; print "sub1: [$p1] [$p2]\n"; } sub sub2 { my ($p1, $p2) = @_; print "sub2: [$p1] [$p2]\n"; } sub sub3 { my ($p1, $p2) = @_; print "sub3: [$p1] [$p2]\n"; } ---ソースここまで---
お世話になります。 Perlを使って、計算機には誤差があるという話をしようと思って、 　print "1/3*3=", 1/3*3, "\n"; というプログラムを実行させました。 自分としては、1/3の時点で0.333333333333的な数になるので、それを3倍すると、0.9999999999的な数字になると思いましたが、結果としては1になります。 これはどういう原理でしょうか。 よろしくお願いします。
perlで細かいことを理解できないままに呪文のように頭に require 'cgi-lib.pl'; require 'jcode.pl'; を使っていました。 そのうち文字化けなどの問題も出て、いろいろ調べたり質問したりして、jcode.plは古いからJcode.pmを使いなさいと指摘を受けたので、 require 'cgi-lib.pl'; require 'Jcode.pm'; と呪文変更を行いましたが、これについての使い方を理解せぬうちに、use Encode qw(from_to encode);としなさいと指摘を受け、 require 'cgi-lib.pl'; use Encode qw(from_to encode); と変えて使っていました。 ところが、このパターンを使っていたところ、GETでのデータの受渡がうまくできない(internal server error)となることに気づきました。 ２つ目のパターンでも同じでした local($key,$val); undef(%in); &ReadParse; my($method) = $ENV{'REQUEST_METHOD'}; if ($method eq "GET"){ $QUERY_DATA = $ENV{'QUERY_STRING'}; }elsif ($method eq 'POST'){ read(STDIN, $QUERY_DATA, $ENV{'CONTENT_LENGTH'}); }else{ &error; } データの受信はこのようにはじめています。 そもそもJcode.pmやuse Encode qw(from_to encode);というのはjcode.plに変わる日本語変換のパッケージなのでしょうか？ また、 require 'cgi-lib.pl'; require 'jcode.pl'; use Encode qw(from_to encode); とするとGETでの受渡も問題なかったのですが、２つを混在させても問題ないのでしょうか？ というのも、メール送信で文字変換させるときに sub jis{ my $msg = $_[0]; Encode::from_to($msg, "shiftjis", "iso-2022-jp"); return $msg; } としているので、use Encode qw(from_to encode);がないとEncode::from_to()が使えないのかなと想像し２つをセットで使用しています。（冒頭でuse Encode qw(from_to encode)を宣言し、変換部分でEncode::from_to()を使用） jcode.pl、Jcode.pm、use Encode qw(from_to encode)、Encode::from_to()の関係について教えてください。 もちろん自分でもネットで調べてみましたが、思うように解説してあるところが見つからず困っています。
csvファイルをperlで取扱っています。 ,（カンマ）が含まれるデータは""で括ってやれば行がずれることなく入るのは分かっているのですが、今度は取り出すときどのようにしていいのか分かりません。 各行毎に一連のデータが羅列されていますが、それの分割方法を教えてください。 たとえば、 $bに,（カンマ）入りの文字列が入っていた場合、 ($a, $b, $c) = split(/,/, $query); とすると本来$bに入って欲しいデータの,（カンマ）から後の部分が$cに格納されてしまいます。（そこから先が１つずれます） これをずれずに分割させるにはどのようにしたらいいでしょうか？ ちなみに ($a, "$b", $c) = split(/,/, $query); と試しにやってみましたが、エラーになってしまいました。 実は長年の悩みで、データを格納する際に,（カンマ）を別のあり得ないような文字列に置き換えて、取り出したあと,（カンマ）に戻すというやり方でやっていたのですが、１つのデータファイルを複数のperlで取扱うようになり、対応が難しくなってきたので、これを機にきちんとした方法でデータを取扱いたいと思っています。
Linux＋Perlでのお話です。 内部でsystem関数を使ってrshコマンドを実行しているperlスクリプト（以下、スクリプトＡという）があります。 スクリプトＡをフォアグラウンドで実行するとうまく流れるのですが、バックグラウンド実行すると、rshコマンドを実行した直後でjobが止まってしまいます。 もっと詳しく言いますと、スクリプトＡのrshコマンドは、ディスクを共有しているリモートマシンに対して、スクリプトＢを実行するように指示しています。 スクリプトＢではとある計算を行なっており、その計算結果をファイルに出力しています。 そして、その結果をスクリプトＡで読み込んで後処理を行うというものです。 ----- …(前処理)… system("rsh (ホスト名) \"(スクリプトＢ実行コマンド及び引数) 1> /dev/null 2> /dev/null\""); # ここでjobが止まってしまいます。 # ここで標準出力（ログファイルにリダイレクトしてる）に何か出力しようとしても、何も出力されてません。 (スクリプトＢの結果ファイルの読み込み) …(後処理)… ----- Jobが止まってしまうと言っているのは、jobsコマンドで見ると"job stopped"となっている状態のことを言っています。 この状態でスクリプトＢの結果はファイルに出力されているので、rshのコマンドはうまく投げられていると思います。 （「rshやsshは標準入力が期待されてるとバックグラウンド実行が出来ない」（？）というような記述をどこかで見かけたので、念のためrshに"< /dev/null"の記述を加えてもみたのですが、変わりませんでした） その後、止まっているjobをfgコマンドでフォアグラウンドで再開させると、最後まで問題なく実行されます。 フォアグラウンドで実行すればうまくいくのに、バックグラウンドで実行すると止まってしまうのが理解出来ません。 これは何が原因なのでしょうか。 そして、どうしたら解決出来るのか。 どなたかご存知でしたら、ご教示頂きたくお願い致します。
perlでホームページのURLが正しいか判定したいのですが、ネットで調べていても出てくるのがメールアドレスの判定方法ばかりで、ホームページに関してのことがなかなか見つかりません。 if($url !~ /^https?:\/\/[\w\.-~\?&=\/]{4,}/) { } こんな感じで適当にやっていたのですが、なぜか ,(カンマ） のチェックをスルーしてしまったりと思うように制御できておらず、 http://www.din.or.jp/~ohzaki/perl.htm#httpURL このページを読んでもちんぷんかんぷんで、とりあえず if($url !~ /\b(?:https?|shttp)://(?:(?:[-_.!~*'()a-zA-Z0-9;:&=+$,]|%[0-9A-Fa-f ][0-9A-Fa-f])*@)?(?:(?:[a-zA-Z0-9](?:[-a-zA-Z0-9]*[a-zA-Z0-9])?\.) *[a-zA-Z](?:[-a-zA-Z0-9]*[a-zA-Z0-9])?\.?|[0-9]+\.[0-9]+\.[0-9]+\. [0-9]+)(?::[0-9]*)?(?:/(?:[-_.!~*'()a-zA-Z0-9:@&=+$,]|%[0-9A-Fa-f] [0-9A-Fa-f])*(?:;(?:[-_.!~*'()a-zA-Z0-9:@&=+$,]|%[0-9A-Fa-f][0-9A- Fa-f])*)*(?:/(?:[-_.!~*'()a-zA-Z0-9:@&=+$,]|%[0-9A-Fa-f][0-9A-Fa-f ])*(?:;(?:[-_.!~*'()a-zA-Z0-9:@&=+$,]|%[0-9A-Fa-f][0-9A-Fa-f])*)*) *)?(?:\?(?:[-_.!~*'()a-zA-Z0-9;/?:@&=+$,]|%[0-9A-Fa-f][0-9A-Fa-f]) *)?(?:#(?:[-_.!~*'()a-zA-Z0-9;/?:@&=+$,]|%[0-9A-Fa-f][0-9A-Fa-f])* )?/){ } こんな感じで代入してみても予想どおり構文エラーとなってしまい、どうやればいいのか困っています。（あまりの長さに理解できていないためエスケープも一切させてないので、エラーが出て当然といえば当然ですが） そこまで厳密にでなくてもかまわないのですが、ホームページのURLに間違いがないかチェックする方法はないでしょうか。 （特に　.　と　,　や　:　と　;　や　~　と　^　の入力間違い、スペースが入っていないかとか全角入力になっていないかなどをチェックしたいです）
CSVデータの区切りが「","」で区切られてます。 (ここから) "山田","埼玉県","男性" "田中","埼玉県","男性" "井上","栃木県","女性" "志村","千葉県","男性" (ここまで) 以下のような区切りで行うと思ってます。 (ここから) open(DB,"<$bunfile") || &error("Can't write $bunfile"); flock(DB, 1); @lines = <DB>; foreach $lines (@lines) { ($name,$addr,$seib) = split("\",\"", $lines); 省略; } (ここまで) この場合、先頭と最後の「"」が残ってしまいます。 どのような方法で削除出来るのかがわからず悩んでます。 「s/\"//g」を使用しようかとも思ったのですが、違う方法がないかと思い質問いたしました。 ご教授いただけますと幸いです。 よろしくお願いします。
Perlからリモートファイルを参照する方法がわかりません。 参照というのは、ファイルをOPENして順次読み込みをするという意味です。 リモートファイルはURLでのみ指定して参照しようとしています。 FTPは使えません。 いろいろと調べたのですが、そもそもPerlでは出来ないのか、または何か方法があるのかわかりません。 是非よきアドバイスをお願い致します。
例えばphpの場合、下記の<?php～?>の間にphpの記述をしますが、同じことをperlで行おうとした場合、どのように記述すれば良いか分からなかったため、アドバイスいただける方がいらっしゃいましたら、ご教示の程、よろしくお願いします。 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>title</title> </head> <body> <?php ?> </body> </html> なお、既存のhtmlにperlを追加したいと思っているため、上記のhtml自体をperlで書きなおす以外でお願いします。 以上、宜しくお願いします。
ホームページのカウンターなどPERLでかけると聞きました。 これはhtmlファイルやCSSファイルのほかにPERLファイルみたいのがあって、HTMLファイルからPERLファイルにリンクで飛んで、PERL言語を動かして、カウンターを表示させる、みたいな手順でしょうか？ プログラム素人なので、なるべく簡単にお教えいただければあり額存じます。 よろしくお願いいたします。
ローカルに保存してあるファイルをMySQLにバイナリデータとして格納して保存したいと思ってます。 データは格納できるのですが、文字エンコード？の問題でファイルが壊れてしまっているみたいです。 格納後、出力した際にjpgなどの画像は問題なく表示されるのですが、xlsやpdfなどのファイルが開けなくなります。MySQLの文字コードはUTF8です。 #!/usr/bin/perl use DBI; my $dbh = DBI->connect('DBI:mysql:database:localhost:3306', 'user', 'password'); # ファイルパス my $file = '/tmp/test.xls'; # ファイルサイズ my $size = -s $file; # バイナリデータ読み込み my $line; open(IN, $file); binmode(IN); sysread(IN, $line, $size); close(IN); # DBに格納 my $sth = $dbh->prepare(qq|INSERT INTO file_table ( `file_name`, `file_data` ) VALUES (?, ?)|); $sth->execute('test.xls', $line); $dbh->disconnect; 上記のようなコードなのですが、おかしな点があれば教えてください。 よろしくおねがいします。
何をしてもサーバーエラーがでます。 たとえば$a=1;　の数字を変えてまた元に戻してサーバーにアップすると エラーが出ます。 プログラムの部分をいじるとエラーが出ます。 パラメーター設定の部分の数値を変更するだけではエラーがでません。 何が原因なのでしょうか。 サーバーの設定上エラー番号はわかりません。 編集ソフトを変えても同じでした。 コードはシフトJISでFTP転送はバイナリとアスキー両方試しましたが エラーはでます。 文法的には間違いありません。 プログラムの部分に手を加えるだけでエラーが表示されます。
こんにちは。 かなりハマってしまいました。 多分これ以上は、自身の力で解決できそうにないと思い質問させて頂きます。 現在、Perlを使ったシステムを作っています。 そこでページが見つからなかった場合に、どのページが見つからなかったのか、そのURLに合わせて 「ページが見つかりません。○○を確認してください」のような動的なページを作成したいと思っています。 ■現状 htaccessで、 ErrorDocument 404 /maintainace/cgi/make_page_err.cgi の記述をしています。 ■期待する結果 呼び出し先のCGI側で$ENV{'REQUEST_URI'}から エラーとなったURLを取得し、それに合わせて「Print　ｘｘｘｘ」をする (さらに最終的にはHTMLを作成し、それを表示したい) ■現在の結果 無反応。 ただし、処理が走っているかを確認するために、呼び出し先のCGIに open File, ">>./404_log.txt"; を入れると正しくテキストファイルが書き込まれる　→　通っていることまでわかる。 試しにCGIの先頭に print "Content-type: text/html\n\n"; print "aaa"; exit; とすると「Oops! This link appears to be broken.」(Firefox)のエラー画面が表示。 上記のテキスト書き込みなし。 更に ErrorDocument 404 /maintainace/cgi/make_page_err.cgi を絶対パスにしたところ 動作はするが、$ENV{'REQUEST_URI'}の値が「make_page_err.cgi」とCGI自身なり、 元のURLが拾えない。 このような状態です。 ネットでもいろいろ検索しましたが、求めている回答は見つかりませんでした。 直接の回答でなくても、参考になるURLなどでも構いませんので ご存じある方お願いいたします。
こんばんは。 最近perl言語を授業で習い始めたので、家でも出来るようにとcygwinをダウンロードして使い始めたのですが、terapadに入力したプログラムを呼び出すことができません。 学校でやったときは、ホームディレクトリにcheminfというファイルを作り、その中にterapadで入力したファイルを入れていました。 おそらくファイルを置く場所に関係があると思うのですが、調べはしたもののさっぱり分からず…＾＾； また、terapadのプログラムには#!/usr/bin/perlって打ち込んでいるのですが、いったいこれがなんなのかも気になります。 相当初歩的な質問だとは思いますが、どうぞよろしくお願いします。
Perlに詳しい方教えてください。 WinXP(SP3)＋ActivePerl-5.10.0.1004の環境で、重複データのチェックプログラムを 作成していますが、foreach文の挙動がよく分かりませんので教えてください。 ※Perlは独学です。 ＜入力ファイル＞ あいうえお あいうえお かきくけこ あいうえお ＜出力期待値その１＞ あいうえお,重複しています あいうえお,重複しています かきくけこ あいうえお,重複しています ＜出力期待値その２＞ あいうえお,重複しています あいうえお,重複しています かきくけこ あいうえお ＜プログラムの要約＞ open(IN,$input_file); # 入力ファイルを読み込み @BASE = <IN>; close(IN); @BASE_2 = @BASE ; # 配列のコピーを作成 $count_1 = '0' ; foreach $data_1 (@BASE) { 　　$count_1++ ; # 何行目を処理しているかのカウンター 　　$flag_1 = '0' ; # フラグの初期化 　　$count_2 = '0' ; 　　foreach $data_2 (@BASE) { # ←★ここの記述方法の質問です★ 　　　　$count_2++ ; 　　　　if ( $count_1 == $count_2 ) { next; } # 自分自身の行とは比較しない 　　　　if ( $data_1 eq $data_2 ) { $flag_1 = '1' ; } # 一致したらフラグを立てる 　　} 　　 　　if ( $flag_1 == '0' ) { # フラグが立たなかったらそのまま新しい配列へ追加 　　　　push(@kekka,$data_1); 　　} else { # フラグが立ったらコメントを追加して新しい配列へ 　　　　$data_1 =~ s/\n//g; 　　　　$data_3 = $data_1 . ",重複しています\n" ; 　　　　push(@kekka,$data_3); 　　} } $kekka_2 = join("",@kekka) ; # 配列のデリミタ対策 open(OUT,"> $output_file"); print OUT "$kekka_2"; close(OUT); exit; ＜質問＞ 上記プログラムの★マークの箇所で、 foreach $data_2 (@BASE_2)　としますと、＜出力期待値その１＞が得られます そして、 foreach $data_2 (@BASE) としますと、＜出力期待値その２＞が得られます プログラムの途中で　@BASE_2 = @BASE　としていますので、一見しますと 同じ処理をしているように感じるのですけれども、実際には出力結果が異なり ますので、何かが違うのだと思います。 その違いを教えて戴きたいです。 ※投稿確認画面でTABが消えてしまいますのでTABは全角スペースに変更して 　おります。 　見えづらい場合には申し訳ありません
「Twitterから学ぶ，Web APIのキホン」（http://gihyo.jp/dev/serial/01/perl-hackers-hub/000403）のサンプルプログラムを参考にitunesの検索apiの検索結果を解析しようとしているのですが解析できなく、何も表示されない状態になります。 itunes 検索api http://www.apple.com/itunes/affiliates/resources/documentation/itunes-store-web-service-search-api.html まずは上のSearch Examplesにいくつか示しているitunes　apiの検索結果（jsonデータ）から"artistId"に対する項目や"artistName"に対する項目を抜き出そうと試みています。 以下は実際に私が実行しているプログラムです。 ----------------------------------------------------------------- print <<"HTML"; Content-type: text/html <html> HTML use LWP::UserAgent; use URI; use JSON qw(decode_json); use Encode qw(encode_utf8); my $uri = URI->new('※ここにitunes apiの検索結果のurl入れています'); my $ua = LWP::UserAgent->new; my $res = $ua->get($uri); my $json = $res->content; my $ref = decode_json($json); for my $applist ( @{ $ref->{results} } ) { print encode_utf8("$applist->{artistId}: $applist->{artistName}\n");} -------------------------------------------------------------------------------------- としているのですが結果は何も表示されません。※cgiはmac 環境にてUTF-8 Mac(CR)で保存しております。 「Twitterから学ぶ，Web APIのキホン」のサンプルプログラムは正常に動いて表示出来ているのでモジュールやPerlのパスには問題ないと思います。 どうすればitunes 検索apiのjsonデータがPerlでちゃんと解析されるのかご教示お願いします。
以前も質問させていただきましたが、 大量データから抽出する際の効率よいperlプログラム作成について また、教えてください。 例） 大量データ　Aファイル　3列　可変値（数値、URL、数値）タブ区切り　重複値あり 123　http://www.XX.co.jp/XX　4567 1111　http://www.XX.co.jp/XX　3333 3　http://www.XX.co.jp/YZ　4567 1111　http://www.YYY…　116 … 抽出対象データ　Bファイル　1列（URL）重複なし http://www.XX.co.jp/X http://www.YYY.co.jp … BファイルにあるURLで始まるURLがAファイルにある場合　Aファイルのその行を抽出したい。 grepで実施すると　すごい時間がかかってしまうため、効率よい抽出方法をおしえてください。 今回は、完全一致ではなく、Bファイルに入っているリストのURLから始まるものにしたいと考えているので、前の手法（hash連想配列）が使えないと考えております。 Aファイルが容量大きいため、ｇｒｅｐ処理では1週間たっても終わらないのです。
現在、jcode.plを使用したShift JISで構成されていた Perlのcgi を UTF-8 に改造しています。 フォームに書き込んだPAGETITLEを別ファイルへUTF-8で書きこむ際に、文字化けしてしまいます。 書きこんだファイルを開けてみると、日本語が文字化けしています（アルファベットは大丈夫） 以下のPerlのPAGETITLEをどのように改造すれば、文字化けしないで、$foundations_fileへUTF-8で書き込みすることができるのでしょうか？ ※個人的にはデータ書き込みの sub REGIST 以下を改造すれば良いのではと推測していますが、どうやれば良いのか分かりません。 どうかご教示、よろしくお願い致します。 m（＿ ＿）m ------------------------------------- #!/usr/bin/perl use utf8; binmode STDIN,":utf8"; binmode STDOUT,":utf8"; #基本セットアップファイル読込 require './setup_manage.cgi'; #このファイル $cgi = "./foundations.cgi"; #デコード処理 &DECODE; sub VIEW { #基本設定ファイルの読み込み &FOUNDATIONS_READ; 【省略】 <TABLE width="100%" border="0" cellspacing="0" cellpadding="1"><TR> <TD width="70%">変更するデータを直接書き換えて [ 編集実行 ] を押して下さい。</TD> <FORM method="post" action="./login.cgi"> <TD width="30%" align="right"><INPUT type="submit" value="メインメニューに戻る"></TD> <INPUT type="hidden" name="mode" value="main"> <INPUT type="hidden" name="pw" value="$in{'pw'}"> </FORM> </TR></TABLE> 【省略】 <TABLE border="0" cellspacing="1" cellpadding="4" bgcolor="#999999"><TR> <FORM name="SUBMIT" method="post" action="$cgi" onSubmit="return kakunin()"> <TD width="160" bgcolor="#eeeeee"> <TABLE border="0" cellspacing="0" cellpadding="1"><TR> <TD>ページタイトル</TD> </TR></TABLE> </TD> <TD width="400" bgcolor="#ffffff"> <TABLE border="0" cellspacing="0" cellpadding="1"><TR> <TD><INPUT type="text" name="PAGETITLE" size="60" value="$PAGETITLE"></TD> </TR></TABLE> </TD> 【省略】 ------------------------------------------------- # データ書き込み #------------------------------------------------- sub REGIST { #全角英数字を半角に変換 $zenkaku = '０１２３４５６７８９'; $hankaku = '0123456789'; $in{'PAGETITLE'} =~ s/\,/&%/g; $in{'PAGE1'} =~ s/\,//g; $in{'PAGE2'} =~ s/\,//g; $in{'PAGE3'} =~ s/\,//g; $in{'CATECOL'} =~ s/\,//g; $in{'PERIOD'} =~ s/\,//g; $in{'TABLECOL'} =~ s/\,//g; $in{'SIZECOL'} =~ s/\,//g; $in{'SIZEROW'} =~ s/\,//g; $in{'COPYRIGHT'} =~ s/\,/&%/g; #ファイルロック開始 if( $lockkey ne '0' ){ &LOCK; } #ファイルに書きこむ if (!open(OUT,">:utf8",$foundations_file)) { &ERROR( read_foundations ); } print OUT "$datenow,$in{'PAGETITLE'},$in{'INIMODE'},$in{'MODECHG'},$in{'PAGE1'},$in{'PAGE2'},$in{'PAGE3'},$in{'CATEVIEW'},$in{'CATECOL'},$in{'INICATE'},$in{'PERIOD'},$in{'RANKING'},$in{'CMODE'},$in{'RANKVIEW'},$in{'TITLEVIEW'},$in{'SRCHVIEW'},$in{'INPVIEW'},$in{'DATAROW'},$in{'TABLECOL'},$in{'BARCLR'},$in{'BARPER'},$in{'IMGPRT'},$in{'IMGSIZE'},$in{'SIZECOL'},$in{'SIZEROW'},$in{'IMGFRM'},$in{'COPYRIGHT'},$in{'GPVIEW'},"; close(OUT); #ファイルロック解除 if( $lockkey ne '0' ){ &UNLOCK; } &COMP; }
プログラミング初心者です。うまくいかないので、ご教授願います。 Mac(Snow Leopard)でperlを学びたいと思い、 CPANモジュールをインストールしましたが、 いざ、XML：：Feedを使用しようとすると、下記のエラーが出ます。 「Can't locate XML/Feed.pm in @INC ...........(続く)」 これはきちんとモジュールがインストールされていないことでしょうか？ 考えられる可能性と回避方法を教えていただけないでしょうかm(_ _)m
(1) <input type="hidden" name="word" value="大阪市"> (2) if ($wd =~ /^[\w.']+$/ ? $address =~ /$wd/i : index($address, $wd) >= 0) (1)のHTMLタグから受け取った「大阪市」を(2)のCGIによってデータ検索します。 東大阪市だと問題ないのですが、大阪市だと東大阪市も一緒にヒットしてしまいます。 何処を書きかえれば良いか教えて下さい。お願いします。
現在、jcode.plを使用したShift JISで構成されていた Perlのcgi　を UTF-8　に改造しています。 冒頭で　use utf8;　を宣言した後、jcode関連の文は、全てコメントアウトしてきました。 複数ある別ファイルからデータ読み込む場合も、 open(IN,"<:utf8","$別ファイル"); という形で、"<:utf8"を挿入して、うまく読みこめています。 ただ、読み込んだ後、別ファイルへUTF-8で書きこむのが、どうしてもうまくいきません。 書きこんだ後、文字化けしてしまいます。 書きこんだファイルを開けてみると、日本語が文字化けしています（アルファベットは大丈夫） 以下のPerlをどのように改造すれば、文字コードをUTF-8で書き込みすることができるのでしょうか？ どうかご教授、よろしくお願い致します。 m（＿　＿）m --------------------------------- #------------------------------------------------- # 編集内容登録処理 #------------------------------------------------- sub EDITREGIST { #全角英数字を半角に変換 $zenkaku = '０１２３４５６７８９'; $hankaku = '0123456789'; #Jcode::tr(\$in{'CLICK'}, $zenkaku , $hankaku ); $in{'attach_file'} = &AttachCheck($attach,$attach_name); #ファイルロック開始 if( $lockkey ne "0" ){ &LOCK; } if (!open(IN,"<:utf8","$linkdata_file")) { &ERROR( read_linkdata ); } @BASE = <IN>; close(IN); foreach $data (@BASE) { &LINKDATALIST; if( $in{'editnum'} eq $CNTNUM ){ if( $in{'attach_file'} eq '' ){ if( $in{'CHDEL'} eq '1' ){ $in{'attach_file'} = ''; unlink("$updir/$IMAGE"); }else{ $in{'attach_file'} = $IMAGE; } }else{ unlink("$updir/$IMAGE"); $in{'attach_file'} =~ s/$updir\///g; } $in{'LINKNAME'} =~ s/\,/&%/g; $in{'LINKURL'} =~ s/\,/&%/g; $in{'LINKURL'} =~ s/&amp;/\&/g; $in{'COMMENT'} =~ s/\,/&%/g; $in{'COMMENT'} =~ s/\<br \/\>/!%/g; if( $in{'CLICK'} eq "" ){ $in{'CLICK'} = 0; } $new_data = "$CNTNUM,$datenow,$DATE_LMT,$DATE_ESY,$in{'OPN'},$in{'NEWMARK'},$in{'CATEGORY'},$in{'LINKNAME'},$in{'HONORIFIC'},$in{'LINKURL'},$in{'COMMENT'},$in{'CLICK'},$in{'attach_file'},\n"; }else{ $new_data = "$CNTNUM,$DATE_LINKDATA,$DATE_LMT,$DATE_ESY,$OPN,$NEWMARK,$CATEGORY,$LINKNAME,$HONORIFIC,$LINKURL,$COMMENT,$CLICK,$IMAGE,\n"; } push( @TOTAL,$new_data ); } #実際にファイルに書き込む if( !open(OUT,">$linkdata_file") ){ &ERROR( read_linkdata ); } print OUT @TOTAL; close (OUT); #ファイルロック解除 if( $lockkey ne "0" ){ &UNLOCK; } &SendFinish2; }
Pdicの一行形式なのですが、 あ /// / 母音の一 あ /// 足 / あし あ /// 畔・畦 / 田のあぜ これを あ /// / 母音の一 あ【足】 /// / あし あ【畔・畦 】 /// / 田のあぜ のように一気に置換する方法はありますか？ 「/// ～ /」 の、「～」の部分には様々な文字列が並んでいる（文字列がない場合もある）ので、 おそらく無理かなとも思っています。 Perlかなにかで一気にできそうな気もするのですが、Perlの知識はゼロですのでなんとかエディタでできないかと・・・ あまり知識がないので質問する場所が違っているかもしれません。。
OS：Windows7でサーバーはロリポップを使用しております。 Perlのcgiを「utf-8」で保存し、Perl内のhtmlも、「<meta http-equiv="Content-Type" content="text/html; charset=utf-8">」などのutf-8の設定にしていますが、ffftpでutf-8の文字コードで転送すると、「※ＣＧＩ もしくは ＳＳＩ が正しく動作していません。」と表示されてしまいます。 ffftpのホストの設定での、文字コードは「ホストの漢字コード Unicode(UTF-8)」、「ファイル名の漢字コード　Unicode(UTF-8)」にしています。 何パターンか試してみましたが、ffftpの転送時の設定が「Unicode(UTF-8)」だと、「※ＣＧＩ もしくは ＳＳＩ が正しく動作していません。」と表示されるみたいです。 転送時の設定を「ホストの漢字コード 無変換(SHIFT-JIS)」、「ファイル名の漢字コード　SHIFT-JIS」 にすると、cgiは動作します。但し、文字化けします。→　黒い菱形に？マークの文字化け。 どうすれば、上記問題を解決できるでしょうか。 アドバイスをお願いします。 ｍ（＿　＿）ｍ
お世話になります。 フォームから送られてくるデータを動的に作ったハッシュで参照出来るように取り組んでるんですが、思ったように出来ず思い悩んでおります。 どうすれば、意図した形でデータを取り出すことが出来ますでしょうか my %FORM = ( 'd01' => 'あ', 'd02' => 'い', 'd03' => 'う', 'd04' => 'え', 'd05' => 'お', 'd06' => 'か', 'd07' => 'き', 'd08' => 'く', 'd09' => 'け', 'd10' => 'こ', ); for(sort { $FORM{$a} cmp $FORM{$b} } keys %FORM){ print "$_ = $FORM{$_} \n"; } $list="d01,d02,d03,d04,d05,d06,d07,d08,d09,d10,"; $i=-1; foreach (split/,/,$list){ $i++; $hash{$_}=$i; } for(sort { $hash{$a} <=> $hash{$b} } keys %hash){ print "$_ = $hash{$_} \n"; $view = ${"FORM$_"}; print "$view\n"; }; 最後のprint "$view\n";箇所で、 $list="d01,d02..." を split/,/,$list したので、 $FORM{d01} $FORM{d02} となるようにして、 「あ い う え お」と取り出したいのです。 ご教授のほど、よろしくお願い致します。
お世話になります。 標題のとおりですが、 $ymdに20110517のように日付が指定されます。 この前日を求めたいのですが、コーディングを教えていただけますか。 宜しくお願いします。
現在、Perlでcgiを作成していますが、ページの最上部にヘッダー、ページの両端にメニューや広告、中央にメインコンテンツを配置する3カラム（三段組み）、最下部をフッターにしたいと考えています。 現在、メインコンテンツは完成しております。 cssは、使わないで上記のようなレイアウトをPerlで組みたいのですが、上記にようにしたい場合は、どのように書けば良いのでしょうか？ 横幅全体は800。(ヘッダーとフッターも横幅は800) 左メニュー180、中央メインコンテンツ 440 、右メニュー180 で組みたいと思っています。 お手数をおかけ致しますが、アドバイスよろしくお願い致します。
CGIメールです。 元々shiftjisなので、これをiso-2022-jpに変換させようとしてます。 $charset = "iso-2022-jp"; open(MAIL,"| $sendmail -t") || &error("失敗"); print MAIL "To: <$to>\n"; print MAIL "From: <$from>\n"; &jis("タイトル"); &base64("$msg"); print MAIL "Subject: $str\n"; print MAIL "MIME-Version: 1.0\n"; print MAIL "Content-type: text/plain; charset=$charset\n"; print MAIL "Content-Transfer-Encoding: 7bit\n"; foreach ( split(/\n/, $body) ) { &jis("$_"); print MAIL $_, "\n"; } close(MAIL); sub jis{ $msg = $_[0]; Encode::from_to($msg, "shiftjis", $charset); ####1#### } sub base64 { use MIME::Base64; $str = $_[0]; if($str =~ /[^!-~\s]/){ $str = encode_base64($str, ""); if($charset eq "utf8"){ $str = '=?utf-8?B?' . $str . '?='; }else{ $str = '=?iso-2022-jp?B?' . $str . '?='; } } } このようにしてみたのですが、タイトル部分はきちんと表示されるのですが、ボディー部分が文字化けしてしまいます。（メーラーで手動にてshit-jisにエンコードしたらボディー部分が読めタイトル部分は文字化けする） Encode::from_to($msg, "shiftjis", $charset); の$charsetを"$charset"にしても同じ現象です また、元々参考にしたものでは####1####に retern $msg; があったのですが、これを入れるとsyntax errorになったので、これをコメントアウトしたらエラーにはならず送信そのものはできました ただ目的の文字変換ができないのですが、どこをどう改善すればいいでしょうか。 どうかご存じの方ぜひ教えてください。 よろしくお願いします。
プログラムのアクセスカウンターをするプログラムを作成しましたが、アクセスカウンターのデータが消去されてしまいます。 プログラム抜粋 (ここから) #アクセスカウンターカウント数計上ロジックを入れる $data = ""; open(IN11,"$countcsv") || &error(" countcsv をopen出来ません"); flock(IN11,1); while($lines11 = <IN11>) { ($seq,$acc) = split("\,", $lines11); if ($page == $seq) {$acc = $acc +1; } $data .= "$seq,$acc\n" } close(IN11); open(IN21,">$countcsv")|| &error(" countcsv をopen出来ません"); flock(IN21,2); print IN21 "$data"; close(IN21); (ここまで) count.csvの構成は以下のようになってます。 (ここから) 1,0 2,0 3,0 4,0 5,0 6,0 7,0 8,0 9,0 10,0 (ここまで) カウンターを計測するデータ(行数)が多いと、データが全てなくなってしまいます。 ファイルロックの方法に問題があると思ってますが、どこが悪いのかがわかりません。 ご教授いただけますと助かります。 よろしくお願いいたします。
投票cgiを作成していますが、以下のPerlでは、同一IPから1日１回の投票しかできません。 同一IPからの投票を１日連続５回まで許可する仕組みにしたいと考えています。（６回目以降は単にカウントされないだけで警告等は出さない） 以下のPerlをどのように改造すれば良いか具体的にアドバイスを頂けると大変助かります。 かなり専門的な内容で恐縮ですが、困っておりますので、何卒よろしくお願い致します。 ｍ（＿　＿）ｍ --------------------- # IPアドレスのチェック sub IpCheck { if (!-e $iplog) { &TimeLog; } $last = (localtime((stat($iplog))[9] + $jisa))[3]; $today = (localtime($nowtime))[3]; if ($last != $today) { unlink($iplog); &TimeLog; } open(TLOG,"<$iplog"); @IP = <TLOG>; close(TLOG); $l = 0; foreach (@IP) { $_ =~ s/\r|\n//g; if ($_ =~ /^$addr/) { &NoCnt; } elsif ($l == $#IP) { if (!open(RTIP,">>$iplog")) { &Error(4); } print RTIP "$addr\n"; close(RTIP); &CNTUP; } $l++; } } sub TimeLog { if (!open(TIME,">$iplog")) { &Error(5); } print TIME "$addr\n"; close(TIME); chmod(0666,$iplog); &CNTUP; } #------------------------------------------------- # クリックカウントアップ sub CNTUP { #ファイルロック開始 if( $lockkey ne '0' ){ &LOCK; } if (!open(IN,"$linkdata_file")) { &ERROR( read_linkdata ); } @BASE = <IN>; close(IN); foreach $data (@BASE) { #データリスト読込 &LINKDATALIST; if( $in{'targetno'} eq $CNTNUM ){ $COUNTERUP = $CLICK + 1; $targeturl = $LINKURL; $new_data = "$CNTNUM,$DATE_LINKDATA,$DATE_LMT,$DATE_ESY,$OPN,$NEWMARK,$CATEGORY,$LINKNAME,$HONORIFIC,$LINKURL,$COMMENT,$COUNTERUP,$IMAGE,\n"; }else{ $new_data = "$CNTNUM,$DATE_LINKDATA,$DATE_LMT,$DATE_ESY,$OPN,$NEWMARK,$CATEGORY,$LINKNAME,$HONORIFIC,$LINKURL,$COMMENT,$CLICK,$IMAGE,\n"; } #ファイルの最初にデータを保存する push( @TOTAL , $new_data ); } #実際にファイルに書き込む if (!open(NOTE,">$linkdata_file")) { &ERROR( read_linkdata ); } print NOTE @TOTAL; close(NOTE); #ファイルロック解除 if( $lockkey ne '0' ){ &UNLOCK; } #HTML出力 print "Location: $targeturl\n\n"; exit;
ある、複数行の文章内に散在する 最低4桁以上の金額を全て抽出するには？ 例えば \#### \####- ####円 と、それぞれ3桁を「,」で区切った数値を金額とみなす場合 1度のパターンマッチで、 上記3つのバリエーションとカンマ付き全種の 不純物が入らない厳密なパターンを記すことは、できますでしょうか？ 追記、 以下のような場合は金額とみなしません。 ####(金額に関する記号が前後に付かないため) ####-(頭に\が足りないマイナス単独なため) ###(3桁しかないため) # ###(数値の間の区切りがカンマ以外のため)
perl, v5.8.6で、Perl/Tkを利用した環境です。 従来は、Windows-XP(x32）で利用していて、特に問題なかったのですが、 同じ環境をWindows7（x32）に導入して利用しようとしたところ、 Menu メソッド呼び出しのところで、ちょうど Devel::peekのdumpで表示させた ような内容のものが、DOSプロンプト上に出てしまいます。 ↓こちらの記事（英文）に書かれていることも試してみましたが、解決できませんでした。 http://community.activestate.com/forum-topic/perl-tk-cause-warning Windows7だからということではなさそうですが、 この表示が出てしまう原因、出さなくする方法について、教えてください。 何かご存知の方、よろしくお願い致します。 サンプルスクリプト： test.pl ----------------------------- use strict; use Tk; my $mw = MainWindow->new(); my $menu = $mw->Menu(); MainLoop; ----------------------------- このスクリプトをWindows7環境上で実行すると、 MainWindowのダイアログは画面に正しく表示されていますが、 DOSプロンプトで、下記のメッセージも出てしまいます。 ⇒４行目（my $menu = $mw->Menu();）をコメントアウトするとこの表示は出ません。 ----------------------------- C:\Perl\Tk\Win7>test.pl @ 535 not utf8 SV = PV(0x3d4f9d0) at 0x3d53870 REFCNT = 2 FLAGS = (POK,pPOK,UTF8) PV = 0x3d0d9e4 "\203\201\203C\203\212\203I 9"\0 [UTF8 "\x{c1}C\x{c3}C\x{ca}\x{283}\x{c9}I 9"] CUR = 10 LEN = 11 SV = PVMG(0x214bf74) at 0x3d53870 REFCNT = 2 FLAGS = (SMG,POK,pPOK,UTF8) IV = 0 NV = 0 PV = 0x3d0d9e4 "\203\201\203C\203\212\203I 9"\0 [UTF8 "\x{c1}C\x{c3}C\x{ca}\x{283}\x{c9}I 9"] CUR = 10 LEN = 11 MAGIC = 0x3d5d5a4 MG_VIRTUAL = &PL_vtbl_utf8 MG_TYPE = PERL_MAGIC_utf8(w) MG_LEN = 10
おそれいります。 親プロセスから子プロセスを複数呼び 子プロセスが全て終わった後に次の手順に移行する。。。という処理をflockを使って作っているのですが、 うまくいきません。 下の「main.pl」を実行すると、「lock.pl」を10回呼び出して、 すべて終了したら「OK」と表示したいです。 lockというファイルを全部のプロセスで共有して、 子の全部の処理が終わった時点で、mailにロックが移る。。。という動きを想定したのですが、 なぜか、数回実行しているとMAIN LOCK(1)　が最後に発動しているにもかかわらず、 子プロセスが終了していないのに「OK」の表示を出してしまいます。 flockは順番を守らないのでしょうか・・・・？？？？？ どのようにしたらうまく動くでしょうか。。。。 ==> main.pl <== #!/usr/bin/perl use Fcntl ':flock'; for (1..10){ system("./lock.pl $_ &"); } sleep 5; # 子プロセスが開始するまで待つ print qq("MAIN LOCK\n"); # ... (1) open LC,"+<lock" or die; flock LC,LOCK_EX; sleep 1; print qq("OK\n"); ==> lock.pl <== #!/usr/bin/perl use Fcntl ':flock'; print qq(lock $ARGV[0]\n!); # ... (2) open LC,"+<lock" or die; flock LC,LOCK_EX; sleep $ARGV[0]; print qq(release $ARGV[0]!\n);
Perlで以下の通り、 htmlファイルを全て読み込んだ後に正規表現を当てたいのですが、うまくいきません。 恐縮ですが、原因をご存知の方いらっしゃいましたら教えて頂けませんでしょうか。 また、他に良い解決方法がありましたら教えて頂けると幸いです。 ※PC環境はwindows7, perl5.12です。情報に不足がございましたらご指摘下さい。 ----- #--test.html(左側の数字は行数) 000001 <dl> 000002 <dt>aaa</dt> 000003 <dd>12345</dd> 000004 </dl> （中略） 120001 <dl> 120002 <dt>bbb</dt> 120003 <dd>6789</dd> 120004 </dl> #--test.pl open IN , "test.html"; local $/ = undef; $data = <IN>; close IN; $data =~ s|<td>bbb</td>|<td>ccc</td>|; print "$data\n"; ----- ファイルの始めの方だと当たるのに、後半では当たりません。 正規表現の対象として大きすぎるんでしょうか・・・。 $data =~ s|<td>aaa</td>|<td>ccc</td>|; は、当たりますが $data =~ s|<td>bbb</td>|<td>ccc</td>|; だと当たりません。 どうぞよろしくお願いいたします。
本日、同じ質問をしたものです。 前回の問題は解決したのですが、ファイルがアップロードできないで悩んでします。 ＣＧＩのプログラムは以下のソースです。 #! c:/perl/bin/perl use CGI; #　CGIヘッダーの出力 print "Content-type: text/html\n\n"; my ($query,$fileName); $query = new CGI; $fileName = $query->param('fileName'); open(OUT, ">./a.csv"); binmode(OUT); while(read($fileName,$buffer,1024)) { print OUT $buffer; } close(OUT); close($fileName); #ファイルハンドルをcloseしています。 exit ; ファイルは、作られるのですが、中身が書き込まれません。 どなたか教えてください。 お願いします。
Perl初心者です。 「Learning Perl」（オライリー社、第５版）を勉強中なのですが、４章の練習問題３でつまずいています。 #!/usr/bin/perl use strict; sub total { my $sum; foreach (@_) { $sum += $_; } $sum; } sub average { if(@_ == 0) {return} my $count = @_; my $sum = total(@_); $sum/$count; } sub above_average { my $average = average(@_); my @list; foreach my $element (@_) { if($element > $average) { push @list, $element; } } @list; } my $average = average(100, 1..10); print "\$average = $average\n"; my $barney = above_average(100, 1..10); print "\$barney = $barney\n"; とやったのですが、結果が $average = 14.0909090909091 $barney = 1 となってしまいます。 （$averageの値は正しいのですが、$barneyの値が100となってほしいのに、１になってしまっています。） すみませんが、識者の方、どこが悪いのか、ご教授お願いします。
PerlでDBに格納するプログラムを作成しています。 パラレルで行ないたいためにforkを使っているのですが、 いまいちわかっていないのでご教授ください。 やりたいことはパラレルでのDB格納です。 親、子両方のプロセスが完了したら後続処理を行い、 ０を戻したいのですが、下記の方法ですと、 子が終了したらprintしてからreturnしているようです。 このように、親子の処理が完了したら後続処理に移るようにするためには どうしたらよいのでしょうか？ if ($pid = fork()) { #親プロセス insertDB(); wait; return 0; } else { insertDB(); } print"ここは最後に通したい"\n;
お世話になります。 くじのプログラムを書いていますが、 ４桁の番号のくじを引いて貰い、 毎回数人ずつ抽選します。 当選者を選ぶところで教えて欲しいのですが、 例えば、0100　2455　4782　といった３個が当選となったときの 命令です。 if ($kekka =~ /[0100][2455][4782]/){ とやったのですがダメでした。 [　]の中は１桁しかダメなのでしょうか。 ここら辺が分かっていません。 正しい書き方を教えてください。 宜しくお願いします。
perl初心者です。RSSを取得してタイトルや内容をhtmlに吐き出すというプログラムを作成しています。Xサーバーで指定時間に指定コマンド（プログラム）を自動的に実行させるサーバーの機能（cron）といものがあったのでマニュアル　 http://www.xserver.ne.jp/man_program_cron.php を見て自動更新しようと試みているのですがプログラムが実行されません。 hello.cgiというプログラムを実行しようとしているので マニュアルにある絶対パスの記入例の通り /home/●●●/▲▲▲/public_html/hello.cgi とXサーバーのCron設定で記入しています。自動更新の時間になったら「Cron結果の通知アドレス」で設定したメールは届くのですがプログラムは実行されてません。 cronの機能を使う際perlのほうで（ここではhello.cgi）何か記述する必要があるのでしょうか？もしくは何かモジュールとか必要なのでしょうか？ ps. cron以外でもperlのプログラムを自動的に動かす方法があったら教えて下さい。宜しくお願いします。
早速ですが、 ”１５日分”のように始まるフィールドを持つレコードがあります。 このレコードを抽出基準日付（２桁、例えば”09”）で抽出したいのですが、 抜きたいレコードの日付は１桁の時には前にゼロがありません。 （例えば　”９日分”の如く） どのように考えればよいでしょうか。 抽出基準日付の２桁を１桁にするということは別の理由で出来ません。 宜しくお願いします。
初めて記載します。宜しくします。 perlでプログラムするのが初めてでなので、大分間違ってるかもしれません。 ※UNIX環境でシェルで日付差分(yyyymmddhhmmss)を求めたいのですが、「date -d」コマンドは使用出来ません。 シェルを実行しコマンドラインにて入力された【引数1】：実行区分(1 or 2)【引数2】：日付(yyyymmddhhmmss)、【引数3】：日付(yyyymmddhhmmss)と区分をperlに引数として渡して、perlでは"引数3-引数2"をして日数を算出しファイルに出力させたいです。 perl名：MCPFZAR_Compl.pl 実行コマンド例： perl MCPFZAR_Compl.pl 1 20110302000000 20110306000000 以下にperlのプログラムを掲載します。 #!/opt/perl/bin/perl ⇒入力パラメータチェック実行 # 日付1を年、月、日、時、分、秒に切り分け $L_Year = int(substr($ARGV[1],0,4)); $L_Mon = int(substr($ARGV[1],4,2)); $L_Day = int(substr($ARGV[1],6,2)); $L_Hour = int(substr($ARGV[1],8,2)); $L_Min = int(substr($ARGV[1],10,2)); $L_Sec = int(substr($ARGV[1],12,2)); # 取得日付チェック関数を実行する。 ($L_Ret, $L_Ret_Msg) = &MCPFLCF_DayExists($L_Year, $L_Mon, $L_Day, $L_Hour, $L_Min, $L_Sec); # 異常終了した場合 if( $L_Ret != 0 ){ # エラーを返却する。 return ($L_Error_End, "$L_Err_MSG_4 [$L_Ret_Msg]"); } # 日付1を秒に変換 $L_Time1 = timelocal($L_Sec, $L_Min, $L_Hour, $L_Day, $L_Mon - 1, $L_Year); ⇒同様に日付2も変換 # 日付1と日付2の差分を取る。 $L_TimeRet = ($L_Time2 - $L_Time1); # ファイルに書き込む為に、ファイルopenしてから書込み open (OUT,"> $outfile"); # 結果形式種別が1の場合 if($ARGV[0] == 1){ # 結果を日数で参照渡しする。 $L_LET = int($L_TimeRet / (60 * 60 * 24)); print OUT "$outfile"; } # 結果形式種別が2の場合 elsif($ARGV[0] == 2){ # 結果を秒で参照渡しする。 $L_LET = $L_TimeRet; print OUT "$outfile";; # CLOSEする close(OUT); シェルを実行すると、エラーにはなりませんが ファイルの出力もされません。 かなりどうしたらよいかわからない状態なので回答宜しくお願い致します。 足りない情報がありましたらご教授願います。
いつもお世話になります。 現在、jperlを使用し、 あるフォルダ内の中にあるサブフォルダをlaplusを使用し コマンドラインから圧縮をかけるというスクリプトを作成しております。 そこで、下記ロジックを実行するとエラーになります。 【ロジック】 　$cmd = "\"c:\\Program Files\\Lhaplus\\Lhaplus.exe\" /c:lzh 　 o:\"C:\\Users\\testtaro\\Documents\\LAPLUS_TEST\" 　 \"C:\\Users\\testtaro\\Documents\\LAPLUS_TEST\\2011-03-11(0100)\""; 　system($cmd); 【エラーメッセージ】 　'c:\Program' は、内部コマンドまたは外部コマンド、 　操作可能なプログラムまたはバッチ ファイルとして認識されていません。 「$cmd 」の内容をデバック出力しそれを直接コマンドプロンプトで実行すると 正常に圧縮されます。 おそらく「Program Files」の半角スペース内で切れてしまっているのだと思いますが、 ダブルクォテーションでくくるやり方が間違っているのでしょうか。 超初心者の質問で大変申し訳ありませんが宜しくお願いします。
プログラムの学習を始めようと思いますが、MySQL・CGI/Perl言語を学ぼうと思っております。 そこでどの言語から始めたらいいのか？お薦めの書籍はどんな物か等など教えて頂きたいです。 学びたい言語とは異なりますが以前、やさしいJava第2版で学習していましたが、中盤以降から何故この機能が必要なのか？また具体的にどういった場面で使用するのかが書かれてなく只やり方しか書かれてなく、挫折してしまいました。 時間が出来た事もありまして最近になって又興味を持ち始めたので、どの言語からの学習がいいのか、 そしてお薦めの書籍（どういった場面で使用するプログラムか具体的に書かれている等）がありましたらよろしくお願いします。 最終的にはCGIプログラムからデータベースにアクセス？してデータの追加・削除、不特定多数の方が出来るログイン機能等の作成（簡単に言えば通販サイトの仕組や、よくあるCGIゲームの様な代物）到達するくらいのレベルが目標です。
Perlで月盤の60進数を作って頂きたいんです。 西暦2008年12月=1 西暦2009年1月=2 西暦2009年2月=3 ・・・ 西暦2013年11月=60 アルゴリズムを教えてください。 宜しくお願い致します。
http://www.plusmb.jp/2008/10/03/444.html こちらのページを参考にvpopmailを使って空メールの自動返信プログラムを作ってます。 固定のメールアドレス(hoge@hogehoge.jp)では問題なく出来たのですが、引数を絡めて処理する必要(hoge_hige1@hogehoge.jp※hoge1は引数)が出てきたため、そのように拡張したいのですが、どういう風にプログラムに流していいかわからず困っています。 まとめると hoge@hogehoge.jpで空メール送信⇒hoge.plを起動⇒hoge.plで送られてきたアドレスに返信 はできるのですが、 hoge_hoge1@hogehoge.jpで空メール送信⇒hoge1があるためhoge.plを起動できない ということです。 小さなことでもかまわないのでよろしくお願いいたします。
お世話になります。 perlを始めて２月、mysql触って３日目ですが、 webを見ながらperlでmysqlを動かしてみたいと思いました。 そこでDBD::mysqlをインストールしたいのですが、上手く行きません。 当方は mac os x 10.6.6でオリジナルのperlを使ってます。 DBD-mysql-4.018をcpanから落とした所まではよかったのですが、 カレントディレクトリでperl Makefile.PLを実行すると下記のように Can't exec "mysql_config": No such file or directory at Makefile.PL line 82. Cannot find the file 'mysql_config'! Your execution PATH doesn't seem not contain the path to mysql_config. Resorting to guessed values! 略 To change these settings, see 'perl Makefile.PL --help' and 'perldoc INSTALL'. Using DBI 1.607 (for perl 5.010000 on darwin-thread-multi-2level) installed in /System/Library/Perl/Extras/5.10.0/darwin-thread-multi-2level/auto/DBI/ Writing Makefile for DBD::mysql と表示が出るのですが、その後にmakeをするとエラーが出ます。 make時のエラーは長過ぎて掲載できないのですが、 lipo: can't open input file: /var/folders/yq/yq1TdC-AE3qmYQFQJKK2xE+++TI/-Tmp-//ccO23h5K.out (No such file or directory) make: *** [dbdimp.o] Error 2 となってしまいます。 どのようなことを行えば、正しく、DBD::mysqlをインストールできますでしょうか？ また、このサイト以外に　perlや　mysqlの相談所みたいな所があれば、 併せてご教授いただければ幸いです。 よろしくお願いいたします
perlでホームページを作っていまして動作確認をしたところ、 IE以外（opera,safari,クローム,firefox)で画像が表示されませんでした。 コードを要点だけ書きますと、 まずファイルを一行読みこんで、 そこに入っている１～１０までの数字を$bに納めます。 そしてsozaiディレクトリには b1.png～b10.png があります。 print"<table style=\"background-image:url(./sozai/b$b.png);\" width=\"1024\" border=\"0\">\n"; として、ファイル内容によって背景画像を変えようとしたのですが、 IE以外では背景が真っ白になってしまいます。 上記のb$b.pngの部分を普通にb1.pngと書くと全てのブラウザで表示されます。 $bにちゃんと数字が入っていないんじゃ？とも思ったのですが、 print"b$b.png";と書いてみたら普通にb1.pngとなるので$bにはちゃんと数字が入っています。 IEでは思うように表示されているので、単なる記述ミスとは思えないのですが 、 なにか根本的にルールが違ったりするのでしょうか、、？ ちなみに、動作確認はスクリーンショットhttp://screenshots.jp/で行っています。 うまく伝わらなかったらすいません。 ささいなことでも構いませんのでよろしくお願いします。
いつもお世話になっております。 現在、perlとmysqlの接続について苦戦しています。 私の状況としては　Mac osx 10.6.6 使用３ヶ月。 プログラムを独学で勉強し始めて２ヶ月弱。 習熟進度としては　「初めてのperl」ある程度わかる。２週は読んだ。 「すぐわかるオブジェクト指向Perl」１週読んだ。　なんとなくわかる。 という状況です。 昨日より、MySQL（GPL）をダウンロードして挑戦しています ネットに置いてあったソースコードで、 #!/usr/bin/perl use DBI; my $dbh = DBI->connect("DBI:mysql:futomi", "futomi", "password"); my $sth = $dbh->prepare("SELECT * FROM test"); $sth->execute; print "Content-Type: text/plain\n\n"; print "\n"; while(my @row = $sth->fetchrow_array) { print "$row[0]:$row[1]\n"; } $sth->finish(); $dbh->disconnect(); exit; という形でperlからmysqlをつなごうとしているのですが、 install_driver(mysql) failed: Can't locate loadable object for module DBD::mysql in @INC というエラーメッセージと Perhaps a module that DBD::mysql requires hasn't been fully installed というエラーメッセージが表示されます。 cpanからDBD::mysqlもダウンロードし、Makefile.PL・・・コンパイルでよろしいのでしょうか？も終わっており、DBD::mysqlとDBIも@INK上に設置していると思われるのですが、 一向に接続する事ができません。 どのように対処すれば接続する事ができるのでしょうか？ ご説明いただければと思います。 また、足りない文章、ソース等がありましたらそれらもあげさせていただきますので、 なにとぞご協力くださいませ。 それでは失礼いたします。
$_ = [ [1, 2, 3], [4, 5, 6], [7, 8, 9] ] 例えばこのような2次元配列からリスト(2, 5, 8)を一発で取る式はありますか イメージ的には、 $$_[0, 1, 2]->[1] のようなことをしたいのですが・・・
perlの初心者です。下記のCGIを実行しましたが、全く表示しません。 最初の「環境変数」と言う文字も表示しません。 どこか初歩的なエラーがあると思いますが、わかりませんので質問させていただきます。 --- #!/usr/local/bin/perl print "Content-type: text/html", "\n\n"; print "<HTML><BODY>", "\n"; print "<H1>環境変数</H1><HR>", "\n"; foreach my $key( keys %ENV ){ print "$key: $ENV{$key}<BR>", "\n"; } print "<HR>", "\n"; print "</BODY></HTML>", "\n";
PerlCGIのデコードでつまづいています。ｊcode.plで$valueの値を「%E3%81%BF%E3%81%AE%E3%82%8A%E5%8F%B0」から「みのり台」の日本語に変換しようとしたのですが「%E3%81%BF%E3%81%AE%E3%82%8A%E5%8F%B0」が返されてうまくいきません。申し訳ありませんが知恵を貸して頂けないでしょうか、よろしくお願い致します。 #!/usr/bin/perl require './jcode.pl'; #デコードするためのプログラム # プラウザからのデータ取込み #if ($ENV{'REQUEST_METHOD'} eq "POST") { # read(STDIN, $buffer, $ENV{'CONTENT_LENGTH'}); #} #else { $buffer = $ENV{'QUERY_STRING'}; #} # プラウザからのデータ変換 #$i = 0;　#※２ @pairs = split(/&/,$buffer); foreach $pair (@pairs) { #１行毎に$name,$valueを取り出す ($name, $value) = split(/=/, $pair); # 変換演算子　tr　+　を　スペースに置き換え # $value =~ tr/+/ /; # 変換演算子　s/// 単語の構成文字にマッチ # $value =~ s/%([a-fA-F0-9][a-fA-F0-9])/pack("C", hex($1))/eg; # " を &quot; に変換 # $value =~ s/"/&quot;/g; #\n を "" に変換 # $value =~ s/\n//g; print qq( 　 <tr><td>やった</td></tr> 　 ) , "\n"; # jcodeでデコードがうまく出来ませんでした。 # 日本語に変換(デコード処理部分) &jcode'convert(*value,'sjis'); &jcode'convert(*$name,'sjis'); # $FORM{$name} = $value; #※１ # @num[$i]=$value; #※２ # $i=$i++; #※２ # $str = decode('shiftjis', $value); # $value = encode('shiftjis', $str); } @varuee = split(/&*q=/,$ENV{'QUERY_STRING'}); print qq( 　 <HTML> 　 <HEAD> 　 <TITLE>画像の検索結果</TITLE> 　 </HEAD> 　 <BODY bgcolor="#FFFFFF"> 　<H2 align="center">画像データベースの検索結果</H2> 　<!--画像の検索結果を２～３件ためしに表示--> 　<BR> 　 <hr> 　 <CENTER> 　 <table> ); print qq( 　 <tr><td>$value</td></tr> 　 ) , "\n"; exit;
たとえば、ショッピングサイトのオーダーフォームなどで、 お客様情報（氏名、発送先住所、決済方法）を入力してもらい、「注文確定」ボタンを押す。 このとき、「決済方法」で「銀行振り込み」が選択されていたら、次に起動する画面は「終了画面」。 「クレジットカード決済」が選択されていたなら、合計金額などの情報をPOSTしてクレジット決済代行会社の決済ページを起動する。。 ということは可能なのでしょうか？ Perlでなら、そのような分岐処理は実現可能でしょうか？
Perl my $fhandle = $query ->upload('A'); HTML <INPUT TYPE="HIDDEN" VALUE="C:\temp\1.txt"/> ボタンクリックで、JavaScriptでHTMLのhiddenに値をセットしています。 その値をPerlでuploadすると、値がセットされません。 <INPUT TYPE="FILE" で、手動でセットすると上手くいきます。 なんんとかHIDDENでできないでしょうか？ FILEでしか駄目な場合、JavaScriptで、FILEにセットする方法をご教授下さい。 今、現状はIFRAMEでFILEで選択したファイルパスをボタンクリックで、メインのFORMのHIDDENに渡して、CGIを呼んでいます。
以下の記事の方法を試したいのですが、DBD::SQLiteがダウンロードできません。 http://g2s.livedoor.biz/archives/51172937.html この方法を試すにはWindows7では難しいのでしょうか。 よろしくお願い致します。
perl初心者です。 CygwinへCFITSIOをCPANを用いてinstalｌしようとしています。 すると下記のエラーが出ました。 どのようにすればinstallができるのでしょうか？ ######################################################################## cpan[1]> install Astro::FITS::CFITSIO CPAN: Storable loaded ok (v2.20) Going to read '/home/Owner/.cpan/Metadata' Database was generated on Sun, 06 Mar 2011 09:30:02 GMT Running install for module 'Astro::FITS::CFITSIO' CPAN: YAML loaded ok (v0.70) Running make for P/PR/PRATZLAFF/Astro-FITS-CFITSIO-1.06.tar.gz CPAN: Digest::SHA loaded ok (v5.47) CPAN: Compress::Zlib loaded ok (v2.02) Checksum for /home/Owner/.cpan/sources/authors/id/P/PR/PRATZLAFF/Astro-FITS-CFITSIO-1.06.tar.gz ok Scanning cache /home/Owner/.cpan/build for sizes ............................................................................DONE CPAN: Archive::Tar loaded ok (v1.52) Astro-FITS-CFITSIO-1.06/ ##中略## CPAN: File::Temp loaded ok (v0.22) CPAN.pm: Going to build P/PR/PRATZLAFF/Astro-FITS-CFITSIO-1.06.tar.gz CFITSIO environment variable not found, assuming /usr/local/cfitsio Checking if your kit is complete... Looks good Note (probably harmless): No library found for -lcfitsio Writing Makefile for Astro::FITS::CFITSIO Can't exec "make": No such file or directory at /usr/lib/perl5/5.10/CPAN/Distribution.pm line 2003. PRATZLAFF/Astro-FITS-CFITSIO-1.06.tar.gz make -- NOT OK Running make test Can't test without successful make Running make install Make had returned bad status, install seems impossible Failed during this command: PRATZLAFF/Astro-FITS-CFITSIO-1.06.tar.gz : make NO ######################################################################## なおホームディレクトリは下記です。 /cygdrive/c/Documents and Settings/Owner/ みなさまお忙しいところ恐縮ですが よろしくお願いいたします。
早速ですが、 覚えたことをメモ（形式は普通の日本語テキスト）しており、 あとから検索でキーワードを与えると該当の文章を抜き出し表示するようなcgiを作っています。 基本的には上手く行くのですが、漢字をキーワードに入れると抜き出せるときと、抜き出せないときがあります。 抜き出しは此処で教わった、 if($target =~ m/$key/i) {実行rtn を使っています。 どのような対処が必要でしょうか。 理由と対処法を教えてください。 宜しくお願いします。
対象サイトの内容を取得するCGIを構築したいのですが、うまくいきません。 対象サイトがJavascript中心に構成されているせいでしょうか。 原因の判る方、どうかご教示願います。m(__)m #!/usr/bin/perl use LWP::Simple; my $html = get("http://jun.sakura.ne.jp/~dk3/result/result225.html"); #相対指定部分の置換 $mae = '\.\./'; $ato = 'http://jun.sakura.ne.jp/~dk3/'; $html =~ s|$mae|$ato|g; print "Content-type: text/html\n\n$html\n";
教えてください。 例えば、perlの次の様な要素が３つある配列で、 @t = ('A',,'C'); 2要素目が空で有ることを判別したいのですが、どうしたら良いでしょうか？
WinXP　SP3,IE8を使っています。 この環境で、クッキーを自動削除するアプリを作りたいのですがうまくいきません。 どの様にすればいいでしょうか？ ちなみに、PERL下記スクリプトを作って見ましたが、 opendir(DIR, "C:/Documents and Settings/main/Local Settings/Temporary Internet Files/"); @dirs = readdir(DIR); closedir(DIR); open(F,">>filenames.txt"); print F join("\n",@dirs); close(F); 出力結果を見ると、 . .. AntiPhishing Content.IE5 Content.MSO Content.Word desktop.ini gegl-0.0 となっており、削除するためのファイル名すら取得できずお手上げ状態です・・・ どなたか、詳しい方教えて頂けないでしょうか？ 宜しくお願い致します。
下記のPerl正規表現ですが、どんな意味か分かるでしょうか？ $var =~ s!/([^/]+|~(\.\.))/\.\./!/!g 参考書も読んでみたのですが分かりませんでした（セットされている文字列にどんなマッチング、置換をしているのでしょう） お分かりの方いれば、よろしくお願いします。
(1)Perl(cgi)から(2)Perl(cgi)へ引数（データ）を渡す方法を教えてください。 プログラムの流れとしましては、 (1)：データベースを検索＆該当結果の番号をリンクで表示 (2)：(1)でクリックしたリンクと対応する結果を表示 となっております。 また、セキュリティの事を考えて「POST」で送りたいと考えています。 よろしくお願いいたします。
私の質問は初歩的なもので申し訳ないのですが、file1.plとfile2.plというファイルが存在するとします。 file1.plは ________________________ use strict; use warnings; require 'file2.pl'; print $x; _________________________ file2.plは __________________________ $x =12; 1; _________________________ この状態でfile1.plを実行するとエラー文が表示されて、$xにパッケージネームを要求されてしまいます。しかし、use strict; use warnings;を削除して実行すると12が表示されます。 そこで質問です。 1.　use strict; use warnings;を付けた場合なぜ、エラーメッセージが表示されるのか。この使い方は間違っているのか。 2.　外部から値のみを呼び出すときに最適な他の方法があるのか。 以上をお答えいただければ幸いです。 ご回答の方よろしくお願いいたします。
以前も問い合わせさせていただいた件なのですが、 未だ解決していないので、再掲させていただきます。 やりたいことは、 個人認証のページを作り、ログオフ後、ブラウザの戻るボタンを押しても、 ログイン中となるのを避けたい。 以下のような感じで、cookieを使って実現しようとしているのですが、 ログオフ時にcookieの削除は、うまくいったのですが、 ブラウザの戻るボタンでログイン中のページに戻ると、 $ENV{'HTTP_COOKIE'}の中身を見ると、実際にはCookieは削除されているにも関わらず、 Cookieの情報がよみこまれているため、ログイン中となってしまいます。 何か基本的なやり方を間違っているような気がします。 どなたかご教授願います。 ↓a1.cgi（ログイン画面）-------------- 　： （ID、パスワード認証後） #Cookie書き込み print "Content-type: text/html\n"; print "Set-Cookie: NAME=aaa; expires=Tue, 1-Jan-2030 00:00:00 GMT;\n"; print "\n"; 　： ↑a1.cgi（ログイン画面）-------------- ↓a2.cgi（ログイン中）-------------- 　： #Cookie読み込み $cookie01 = "$ENV{'HTTP_COOKIE'}\n"; 　： <HEAD> <!-- キャッシュクリア --> <meta http-equiv="Pragma" content="no-cache"> <meta http-equiv="Cache-Control" content="no-cache"> <meta http-equiv="Expires" content="Thu, 01 Dec 1994 16:00:00 GMT"> 　： </HEAD> 　： ↑a2.cgi（ログイン中）-------------- ↓a3.cgi（ログオフ）-------------- 　： #cookie削除。 print "Content-type: text/html\n"; print "Set-Cookie: NAME=aaa; expires=Fri, 31-Dec-1999 23:59:59 GMT;\n"; print "\n"; 　： </HEAD> 　： ↑a3.cgi（ログオフ）-------------- ※a1.cgi、a2.cgi、a3.cgiは同じディレクトリです。 よろしくお願いします。
アップロードするファイルを指定して同じファイル名で拡張子を変えてログを出力したいのですが、半角カナなどがあると化けたファイル名になってしまいます。 どう変換すればよいのでしょうか？
お世話になります。 現在perlを勉強しているのですが(ActivePeal5.12.2) コマンドプロンプトから test.pl > test.log と実行した場合、test.pl内で標準出力した文字列がtest.logにリダイレクトされますが test.pl内で ～die "ERROR～"とした場合、"ERROR～"はtest.logに出力されません。 これを簡単にtest.logに出力する方法はないでしょうか。 リダイレクトせず実行した場合、画面に出力されているのでリダイレクトすればそのまま良いと思っていたのですが・・
初心者向けのperl参考書がなんとか理解できる程度のperl初心者です。 一週間ほど思考錯誤してきたのですが、いくらスクリプトを書いてもどうしても自分では解決できない処理がありましたので、初めてなのですが、質問させていただきました。 二つの同じ形式の、一部情報だけ異なるファイルから一行ずつ配列を読み込んで、数値の大小を比較したいのですが・・・ ファイル構造は、下のように2行でひとつのtextデータの情報を表示する形式となってまして、 奇数行には、各textファイルの情報が、.以下の部分に4552221.2:(30.2):100、のように記載されています。 偶数行には、各テキストファイルの、IDとなる情報が、13333331のように記載されています。この奇数行と、偶数行一行ずつで、ひとつのtextデータの 情報を表しています。textというファイルは、text１から順に,text2000000まで、 2000万程度,行で言えば4000万行ほど存在しています。よって、file１もfile２も、同じ行であれば、同じtextで、同じIDのものを示しています。ずれはありません。 file1 ----------------------------- >text1. 4552221.2:(30.2):100 13333331 >text2 87999999 >text3. 3444444.1:(20.0):300 75533333 ----------------------------- 数値は意味が変わらない範囲で、比較しやすい数値に変えてあります。 この上のfile1と、下のfile2を比べたいのですが、 file２ ----------------------------- >text1. 4552221.2:(20.9):100 13333331 >text2 87999999 >text3. 3444444.1:(23.3):300 75533333 ----------------------------- 偶数行のtextファイルの欄が大事で、text名のドット（.)の後に、続けて数値が書いてある場合（上ではtext1とtext3が該当）、そのドットの後の括弧（）で囲まれた中の数値の大小を比較して、 差が一定以上あるtextだけを出力するスクリプトが書きたいと思っているのですが、 これをいきなりすべてひとつのスクリプトにまとめるのは、私の知識と力量では到底無理なので、ひとつひとつ段階を踏んで処理していこうと考えました。 １、奇数行の、text.の後半に情報があるもの場合、tempファイルにその奇数行と、対になる偶数行を出力する。それを、file1、file2、個別に行う。（temp1、temp2を出力） file1で取り除かれる３、4行目のtext2は、file２でも必ず取り除かれるので、１の処理後も、file1と２の各行は、比較することが可能な状態です。 ２、正規表現を使って、各行の（）で囲まれた部分の最初の2桁の数字（一部は一桁の数字の場合もあり）、をtempに出力する。（temp3、temp4を出力） (この処理を行わなくても可能かもしれませんが、ややこしいので、数字だけ出すようにしました) 最後に、file1とfile2の各行の数字を一行ずつ読み込んで、数値に一定以上の差がある行の情報だけ出力したいのですが、各行を順番に分析できる方法は、while文か、配列に読み込む方法しか知りません。 前者のwhile文では、ファイルオープンは、ひたつ以上は同時には取り扱えないという情報を得たので、使えない思っています。後者の配列に読み込む方法は、桁が大きいので、実用的ではないと感じています。 二つ以上のファイルの各行の特定の数値データを、一行ずつ順に比較して、差があるものだけ抽出するにはどのようなスクリプトを書けばよいのか、ご教授下さい。 いろいろ調べましたが、（僕の調べ方が悪いと思いますが）適切なコマンドや方法にたどり着けません。 試してみた方法 ファイルハンドルを二つ指定して、while文の条件中に、andで条件を二つ指定してファイルハンドルから読み込んでやればよいと思ったのですが、実行するとエラーになってしまいます。ググっていろいろ調べてみたところ、ファイルハンドルの二つ指定はできないとの記述を見つけたので、whileの条件に複数のファイルハンドルを記述するこの方法はあきらめて、ここで、ストップしています。 まわりに、perlを扱える方がいらっしゃれば質問に伺うのですが。もしよろしければ、簡単でもご教授いただけますと幸いです。宜しくお願い申し上げます。
以前、ORACLEにアクセスする方法で悩んでいたものです。 結局、ORACLEを直接アクセスすることをあきらめてACCESS経由にしました。 自分のパソコンでCGIと同じフォルダにACCESSのDBを作って試験しました。 この環境では、成功しました。 そこで、ACCESSのDBをファイルサーバー上（色々なPCからアクセスさせるため）に おいて、同じことをしようとしましたら、DBへCONNECTできなくなりました。 ホスト名やポート番号はあっています。 何か他に必要なことがあるのでしょうか？ どなたか教えていただけないでしょうか？ 宜しくお願いします。
お世話になります。 現在、perlの勉強中です。 状況は　mac osx 10.6.6です。 使用参考書は「perl言語プログラミングレッスン[入門編]」です。 CGIは関係なしで行っております。 open関数について参考書を読みながら、 勉強をしているのですが、openでファイルをオープンするときについてなのですが、 参考書上では、「関数openは、指定されたファイル名を持つファイルをハードディスクから探し出し、オープンしようと試みます」と言う説明があるのですが、 今現在、試している文例では、特定の場所にファイルがあるときでないと、 オープンしてくれません。 文例は [test.pl] use strict; use warnings; my $filename = 'file.txt'; open(FILE, $filename) or die "$filename: $!"; while (my $line = <FILE>){ $line =~ s/ /_/g; print $line; } close(FILE); という形で、ファイルの " " (スペース)を抜き出して "_" （アンダースコア）に置き換えるという設問です。 ただ、現況は　　　　　　　　　　　　　　　　　 /Users/(myname)/Documents/test/test.pl　＃(myname)は私の名前のフォルダです。 にあるコードをターミナル上で実行すると、 /Users/(myname)/file.txt に配置しているときしか、読み込んでくれません。 そこから、ファイルを移動させてしまうと、 読み込んでくれないのです。 そこで、ご質問ですが、 １ 「関数openは、指定されたファイル名を持つファイルをハードディスクから探し出し、オープンしようと試みます」 と参考書に記載がありましたが、実際には探し出しはしてくれないのでしょうか？ それとも、自分のパソコン、コードに問題があるのでしょうか？ ２ 自分が指定した場所にあるファイルをオープンするには どのようにすればよいでしょうか？ ターミナルで指示するのか、それともコードに加えるべきか、 ご指示くださいませ。 また、詳しい方がおられましたら、 お答えいただければと思います。 それでは失礼します。
本日、DBI－＞CONNECTで返ってこないと質問をしたものです。 色々と調べているうちに、もしかしたらDBアクセスはおわり、その後のCGIが表示できなくなっているかもしれないと思うようになりました。 ORCLE9iがあるあとで、PERL,Apacheをインストールしました。 DBアクセスをしない状況ですと、CGIのプログラムは何の問題も無く、動きます。 ただ、DBアクセスしようとするとエラーもでない状況で、画面に何も出ません。 ApacheのORACLEに関する環境設定が必要なのでしょうか？ 環境は、Windows　XP 　　　　　Active　Perl 5.8.7.813 　　　　　　　DBI 1.602 ,DBD-Oracle 1.17 　　　　　Apache 2.0.54 どなたか、わかる方いらっしゃいますでしょうか？ この件で２日悩んでおります。 宜しくお願いします。
perlでプログラムを作成しています。 作成後、複数の人にプログラムを配るために、実行体の形式にしたいと思います。 PARを使えば、できそうと聞いたのですが、具体的にどのようにすればいいかわかりません。 どなたかご教授願えないでしょうか？ 宜しくお願いいたします。
active perlでdbi-connect処理から戻ってきません。教えてください。 以下のテスト的なプログラムで試しました。 Xには、数字が入ります。（会社のファイルサーバーになります） DBI->connectから戻ってきていないようです。（hhhhhhhhが表示されません） ちなみにDBI->connectをコメントにすれば表示されます。 申し訳ありませんが、どなたかご存知の方いらっしゃらないでしょうか？ エラーがかえってこないと、何が悪いかわかりません。 困っています、宜しくお願いします。 ちなみにPerlは、Ver. 5.8.7.813でdbi,dbd-oracleは、昨日ｐｐｍでダウンロードしました。 # DBへコネクトする my $datasource = 'dbi:oracle:usrDB:xxx.xxx.x.xx:8080' ; my $usr = 'usrname' ; my $pass = 'usepass' ; my $dbh = DBI->connect($datasource,$usr,$pass) ; print "hhhhhhhhhhhh\n" ; if( ! $dbh ){ print "gggggggggggg\n" ; } $dbh->disconnect();
Perl初心者です。レンタールサーバでｍｙｓｑlからデータを取得して表示するプログラムを作りたいのですインターネットで捜したのですがよく分かりませんでした。申し訳ありませんが駄目出しでも結構ですので直すポイントになるようなアドバイス、お願い致します。 #!/usr/bin/perl #変数宣言 print "Content-type: text/html;\n\n"; use DBI; $ds = 'DBI:mysql:XXXXXXXXXXX:localhost'; $user = 'XXXXXXXXXX'; $pass = 'XXXXXXXXXX'; print "test<br>\n"; $db = DBI->connect($ds, $user, $pass) || die "Got error $DBI::errstr when connecting to $ds\n"; print "test<br>\n"; #$sth = $db->prepare("SELECT mei FROM name"); #$sth->execute; # バス経路票の中身を表示したかったたのですが出来ませんでした。 $sth= $db->prepare(qq(SELECT * FROM 'バス経路票')); $sth->execute; while(@row = $sth->fetchrow_array) { print qw($row[0]\t$row[1]\t$row[2]\n); } # 経路票の中身を表示したかったたのですが出来ませんでした。 $sth = $db->prepare(qq(SELECT * FROM '経路票')); $sth->execute; while(@row = $sth->fetchrow_array) { print qw($row[0]\t$row[1]\t$row[2]\n); } # 駅バス停関係票の中身を表示したかったたのですが出来ませんでした。 $sth = $db->prepare(qq(SELECT * FROM '駅バス停関係票')); $sth->execute; while(@row = $sth->fetchrow_array) { print qw($row[0]\t$row[1]\t$row[2]\n); } # バス経路票の中身を表示したかったたのですが出来ませんでした。 print "@basskeiro<br>\n"; # 経路票の中身を表示したかったたのですが出来ませんでした。 print "@keiro<br>\n"; # 駅バス停関係票の中身を表示したかったたのですが出来ませんでした。 print "@bassteikeiro<br>\n"; print "test<br>\n"; $rc = $sth->finish; $rc = $db->disconnect; exit;
お世話になっております。 Mac os X 10.6.6でperlに挑戦しています。 私の知識量としては、 プログラムは初めて、macを使いだしてから２ヶ月と超初心者です。 現在、初歩のperlの本を参考に取り組んでます。 ターミナル上から、perldocを見ようと思い、記入しているのですが、 何故か上手く行きません。（perldoc はperlのマニュアルということで私は認識してます。） 例えば、joinと言う関数を調べようと思い、 ターミナル上で １、perldoc join　また　２、perldoc -f joinと記入しているのですが、 １の場合であれば、 No documentation found for "join". ２の場合であれば、 No documentation found for "perlfunc".と表示がされます。 ちなみに、ターミナルで打つのもおぼつかないのですが、 ３、join　とだけ打つと、 Usage: open [-e] [-t] [-f] [-W] [-R] [-n] [-g] [-h] [-b <bundle identifier>] [-a <application>] [filenames] [--args arguments] Help: Open opens files from a shell. By default, opens each file using the default application for that file. If the file is in the form of a URL, the file will be opened as a URL. Options: -a Opens with the specified application. -b Opens with the specified application bundle identifier. -e Opens with TextEdit. -t Opens with default text editor. -f Reads input from standard input and opens with TextEdit. -R, --reveal Selects in the Finder instead of opening. -W, --wait-apps Blocks until the used applications are closed (even if they were already running). --args All remaining arguments are passed in argv to the application's main() function instead of opened. -n, --new Open a new instance of the application even if one is already running. -g, --background Does not bring the application to the foreground. -h, --header Searches header file locations for headers matching the given filenames, and opens them. と表示されます。 １の命令では、　perldocにある「join」を探せ、 ２では　perldocにある関数の「join」を探せと命令していると思うのですが、 ３は何を意味しているのか少々わからないため、怖いなあと思っています。 また参考書上はperldoc -f join で関数の説明が出てくるとの記載があるので、 出てこない私のパソコンには何か問題でもあるのかと不安に思ったりもしています。 そこで、質問ですが １、perldoc -f ～で出てこない私のパソコンは何か問題があるのでしょうか？ また、あるのでしたらその対応方法をご教授ください。 ２、単に関数を打った場合、これはどのような命令になっているのでしょうか？ 上記２点ご回答いただければと思います。お願いします。
perlを使用してcsv形式のテキストファイルを下記のように変換したいと思っています。 【変換前】 10, abc , def , ghi ,jkl　　　　----1行目 10, abc , def , aaa, bbb　　 ----2行目 10, abc , def , ccc , ddd　　----3行目 11, abc , def , eee , fff　　 ----4行目 11, abc , def , aaa , ggg ----5行目 11, zzz , def , aaa , ggg　　----6行目 12, abc , def , aaa ,ggg ----7行目 12, zzz , def, aaa , ggg　　　----8行目 【変換後】 10, abc , def , ghi ,jkl　　　　----1行目 11, abc , def , eee , fff　　 ----4行目 11, zzz , def , aaa , ggg　　----6行目 12, abc , def , aaa ,ggg ----7行目 12, zzz , def, aaa , ggg　　　----8行目 変換内容はcsv形式のテキストファイルで、”,”で区切った先頭3列が 前の行の先頭3列と同じならその行は出力しない、といった 変換をしたいと思っております。 (例えば2行目ですと先頭3列は10, abc ,defになっており、 　1行目の先頭3列と同じ文字列になっているためこの行は出力しない) 当方、Perl初心者で上記のようなことがPerlでできるかも よくわかっておりません。 そこで、上記のような変換はPerlで可能なのか、そしてもし可能であるのなら どのようにPerlで記述すればできるのか教えていただけないでしょうか。 よろしくお願いいたします。
以下のようにカテゴリーとURLが書いてあるファイルがあり これをPerlでカテゴリとURLに分けて処理したいと思っております。 例えば配列としてカテゴリとURLを自由に呼び出せるよう にしたいのですが、あまりに初心者で方法が思いつきません。。。 テキスト ------------------------------------- Search Engine http://www.yahoo.co.jp http://www.google.co.jp Shopping http://www.rakuten.co.jp http://amazon.co.jp Sports http://www.mlb.com http://www.j-league.or.jp その後多数のカテゴリとURLが続く。。。 ------------------------------------- どんな方法でもカテゴリと関連したURLが取り出せればよいのですが、 例えば下記のような配列や、 $shopping[1] = http://amazon.co.jp あるいは下記のような多重配列にしてURLを扱うにはどのようにしたらよいでしょうか？ $url[0][1] = http://www.google.co.jp よろしくお願いいたします。
macで独学でperlを勉強しています。 私の状況としては、 macを使って２ヶ月。 macbookair の　mac os x の　バージョン10.6.6　です。 windowsは５年くらい使っていましたが 映像編集とかネットサーフィンくらいにしか使っていませんでした。 macを買ってからは、 htmlはだいたい使えるようになった。 perlというより、プログラムは初めて勉強する。周囲にプログラム経験者はいない。 という状況です。 perlの勉強を開始して、１週間程、 地道に教科書を勉強して、localhost上でアクセスカウンタは実行できる。 まできました。 ただ、本来であれば作成の環境設定の段階で行うapacheの設定が理解しがたく、 設定を行っていませんでしたので、 フォームをhtmlに送るという段階で躓いてしまいました。 教科書では、ターミナルでapacheの設定を行うとの記載があったのですが、 調べて、Finder上の移動→/etc で隠しファイルを見つけて、 httpd.confを開くまでなんとか、辿り着きました。 ただ、この後、どのように設定を変えればいいのかが、わかりません。 いろんなサイトを見ましたが、 それぞれ書いてあることや記述日が異なり、 また、中級者以上向けに記載のあることがほとんどです。 大変お手数ですが、 この後どのような設定を行えばいいのでしょうか。 ご存知の方がおられればお教えください。
独学でmacでパールを勉強しています。 始めてからまだ１週間すこしくらい。 教科書読みながら、 CGIへフォームを渡す所の段階まで進んできました。 現段階で、htmlからperlへフォームを渡そうとしているのですが、 上手く行きません。 状況としては、htmlのフォームを入力して、登録を押す。 成功であれば→実行結果が表示されるはずなのですが、 現段階ではFinderがその実行htmlの場所を開くだけという形になっています。 下記は実験用に使っているソースです。 ーーーーーーーーーーー htmlは <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta http-equiv="Content-Type" content="text/html;charset=utf-8" /> <title>test</title> <style type="text/css"> </style> </head> <body> <h1>メンバーズリスト</h1> <form method="post" action="form.cgi"> <p> 名前:<br/> <input type="text" name="name"/> </p> <p> 性別: <input type="radio" name="sex" value="male" checked>男 <input type="radio" name="sex" value="female">女 </p> <input type="checkbox" name="megane">メガネを付けてる </p> <p> <select name="kankei"> <option value="yuujin">友人 <option value="kaisya">会社関係 <option value="sonota">その他 </select> </p> <p> 住所: <textarea name="jyusyo" rows="5" cols="40" ></textarea> </p> <p> <input type="submit" value="登録"/><input type="reset" value="クリア"/> </p> </form> </body> </html> ーーーーーーーーーーーーーーーーー perlは #!/usr/bin/perl require 'cgi-lib.pl'; &ReadParse(*form); $name = $form{'name'}; $sex = $form{'sex'}; $megane = $form{'megane'}; $kankei= $form{'kankei'}; $jyusyo = $form{'jyusyo'}; print "Content-type: text/html\n\n"; print "<HTML>\n"; print "<HEAD><TITLE>情報受け取り</TITLE></HEAD>\n"; print " <BODY>\n"; print "<H1>情報受け取り</H1><HR>\n"; print "名前:${name}<BR>\n"; print "性別:${sex}<BR>\n"; print "めがね:${megane}<BR>\n"; print "関係:${kankei}<BR>\n"; print "住所${jyusyo}<BR>\n"; print "</BODY>\n"; print "</HTML>\n"; __END__ です。 ちなみに　localhost上で同一ファイルに入れて、 動かしてます。 ご確認の上、ご助言ください、 perlの教科書に書いてあった構文は、 htmlの学習をするために使ってきたものと全く違ったため、 要点だけ残す形で、再度書いたものです。 htmlの文章がおかしいのか、perlがおかしいのか、 頭が変になりそうです。お助けください。
独学でmacでパールを勉強しています。 始めてからまだ１週間くらい。 教科書みながら、print命令でファイルハンドルに指示を出してるのですが、 書き込めはできるのですが、 ファイルが無い場合、 新規に自動でファイルが作成されるはずとの記載があったのですが、 何故か、自動でファイルが生成されません。 調べても、設定が必要等言われてますが、 mac自体も初心者でほとんどわかりません。 どのような設定にすればいいのでしょうか？ また、ソースに何か悪い所があるのでしょうか？ お助けください。 下記は実験用に作ったソースですが、 作動もしてるのですが、　 新規に自動でファイルが作成されるはず が 何故か作成されません。 ちなみに　localhost上で動かしてます。 #!/usr/bin/perl print "Content-type: text/html\n\n"; print "<HTML>\n"; print "<HEAD><TITLE>test</TITLE></HEAD>\n"; print " <BODY>\n"; print "<H1>test</H1><HR>\n"; open ( FH ,">tukuruzo.txt"); print FH "tukuruzo"; close ( FH ); print "</BODY>\n"; print "</HTML>\n"; __END__
独学でmacでパールを勉強しています。 始めてからまだ１週間くらい。 教科書みながら、print命令でファイルハンドルに指示を出してるのですが、 書き込めはできるのですが、 ファイルが無い場合、 新規に自動でファイルが作成されるはずとの記載があったのですが、 何故か、自動でファイルが生成されません。 調べても、設定が必要等言われてますが、 mac自体も初心者でほとんどわかりません。 どのような設定にすればいいのでしょうか？ また、ソースに何か悪い所があるのでしょうか？ お助けください。 　 ちなみに下記がソースです。 ーーーーーーーーーーーーーーーーーーーーーーーーーーーー #!/usr/bin/perl print "Content-type: text/html\n\n"; print "<HTML>\n"; print "<HEAD><TITLE>アクセスカウンタ</TITLE></HEAD>\n"; print " <BODY>\n"; print "<H1>test</H1><HR>\n"; if ( open ( FH , "count.txt")){ $cnt = <FH>; close( FH ); $cnt++; print"<CENTER>あなたは${cnt}人目の訪問者です。</CENTER>\n"; if ( open(FH, ">count.txt" )){ print FH $cnt; close(FH); } else { print "ファイルの書き込みオープンに失敗しました。\n"; } } else { print "ファイルの書き込みオープンに失敗しました。\n"; } print "</BODY>\n"; print "</HTML>\n"; __END__ ーーーーーーーーーーーーーーーーーーーーーーーーーー
超初心者からプログラムを初めて１週間、 プログラム言語にはperlを使用しています。 mac os x です。 perlの教科書読みながら、アクセスカウンタを作ろうとした所、 何故かgif画像が表示されません。 ネットの素材置き場からとってきましたが、パソコン自身、gif自体は認識してくれてます。 ただ、それをperlに組み込んで使おうとすると、表示されません。 ブラウザはfirefoxとsafariで試しましたが、両方認識してくれませんでした。 ちなみにソースは ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー #!/usr/bin/perl print "Content-type: text/html\n\n"; print "<HTML>\n"; print "<HEAD><TITLE>アクセスカウンタ２</TITLE></HEAD>\n"; print " <BODY>\n"; print "<H1>test</H1><HR>\n"; if ( open ( FH , "count.txt")){ $cnt = <FH>; close( FH ); $cnt++; print"<CENTER>\n"; foreach $fld (split (// , $cnt)){ print "<IMG SRC=\"${fld}.gif\">"; } print"</CENTER>\n"; if ( open(FH, ">count.txt" )){ print FH $cnt; close(FH); } else { print "ファイルの書き込みオープンに失敗しました。\n"; } } else { print "ファイルの書き込みオープンに失敗しました。\n"; } print "</BODY>\n"; print "</HTML>\n"; __END__ ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー です。 テキストファイルを確認しているので、 perl 自体の活動と、アクセスのログ？自体は正常に動いているみたいです。 お願いします。 助けてください！
お世話になっております。 Lingua::JA::Sort::JISモジュールを使用して、 五十音ソートを行ってますが、 うまく五十音ソートができません。 具体的には配列Nameの順番がほとんど変わらない状態で 出力されてしまいます。 なぜうまくソートできないのでしょうか？ ＜環境＞ OS：FreeBSD 7.1-RELEASE-p15 i386 Apache：Apache/1.3.42 (Unix) mod_ssl/2.8.31 OpenSSL/0.9.8e Perl：5.8.9 モジュールの使い方はこちらを参考にしました。 http://oshiete.goo.ne.jp/qa/3412594.html 上記URLでは、文字コードの変換を行っていますが、 UTF-8でスクリプトを書いているので文字コードの変換は 不要と考えています。 Lingua::JA::Sort::JISモジュールは下記URLから取得し、 LinguaJASortJIS.pmへリネームし、カレントディレクトリへ設置しています。 http://cpansearch.perl.org/src/SADAHIRO/Lingua-JA-Sort-JIS-0.05/JIS.pm 以下スクリプトです。 test.cgi -- #!/usr/local/bin/perl use utf8; use LinguaJASortJIS; binmode(STDIN, ":utf8"); binmode(STDOUT, ":utf8"); print "Content-type: text/html\n"; print "Pragma: no-cache\n"; print "Cache-Control: no-cache\n"; print "Expires: Thu, 01 Dec 1994 16:00:00 GMT\n"; print "\n"; print "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n"; print "<html lang=ja>\n\n"; print "<head>\n"; print "<meta http-equiv=\"Content-type\" content=\"text/html; charset=utf-8\">\n"; print "</head>\n\n"; print "<body>\n"; my @Name = ("みかん", "＠なし", "ちくわ", "マルチョウ", "もも", "たまご", "シロ丸", "Pig", "てばさき☆", "ホルモン～", "ギアラ・アカセン", "ミノ", "SENMAI☆", "蜂巣", "焼きセンマイ♪", "バウムクーヘン", "MinoII", "(有)蜂巣JP", "生レバーIII"); my @NameSort; my $Jis = Lingua::JA::Sort::JIS->new; #ソート前 print "ソート前"; print "<table border=1>"; print "<tr><td>name</td><td>utf8 flag</td></tr>"; for (my $i = 0; $i <= $#Name; ++$i) { print "<tr><td>".$Name[$i]."</td><td>".utf8::is_utf8($Name[$i])."</td></tr>"; } print "</table>"; #ソート for my $Sort ($Jis->jsort(@Name)) { push(@NameSort, $Sort); } print "ソート後\n"; print "<table border=1>"; print "<tr><td>name</td><td>utf8 flag</td></tr>"; for (my $i = 0; $i <= $#NameSort; ++$i) { print "<tr><td>".$NameSort[$i]."</td><td>".utf8::is_utf8($NameSort[$i])."</td></tr>"; } print "</table>"; print "</body></html>"; -- 以上、よろしくお願いします。
perlのメールフォームが文字化けして困っています。 メールフォームの出力ＨＴＭＬは、shift_jis それを、ISO-2022-JPに直して、送信しています。 また、jode.pl、mimew.plを使用しています。 何が原因で文字化けしているのか、教えていただけないでしょうか？ よろしくお願いします。
あるディレクトリにtest1.txtとtest2.txtというカンマ区切り（拡張子はcsvではないですけど）があったとして、それらのファイルを1行ずつ読み込み、それを追加書き出しで1つのファイルに収めていこうとしています。 そこで以下のようなコードを書いてみたのですが、どうやらtest1.txtしか読み込んで書き出せていないようなのです。その原因が分からずに困っています。 $dir = 'C:/Perl/workdir';# 対象ディレクトリ名 open MYHANDLE, ">>out.txt";# 追加書き出しモードでファイルハンドルをオープン opendir DH, $dir or die "$dir:$!";# ディレクトリを開く while ($file = readdir DH) {# ディレクトリにあるファイル名を取得し、$fileに格納 next if $file =~ /^\.{1,2}$/;# '.'や'..'も取れるので、スキップする open MYFILE, "$file";# 取得したファイルを開く while (<MYFILE>) { chomp; @dat = split /,/;# 読み込むファイルは「カンマ区切り」としてレコードを読み込む。 $n = @dat; for($i=0; $i<$n; $i++){ print MYHANDLE $dat[$i];# ファイルに追加書き出し(ファイルがなければ新規作成される) print MYHANDLE ",";# カンマ区切りで書き出していく } print MYHANDLE "\n";# 1行読み終えるごとに改行 } close MYFILE;# i番目のファイルを読み終えたら閉じる print $file, "\n";# 読み込み・書き出しをしたファイル名を表示する } closedir DH; close MYHANDLE;
早速お世話になります。 標題のように、 <input type=submit value="処理">とやった場合、 「処理」と表示されたボタンになりますが、 これをボタンの形にせず、文字のママにしたいのですが。 方法はありますでしょうか。 宜しくお願いします。
メール送信のシステムをPerlで作っています。 文字コードUTF-8で送信しようと思っていますが、UTF-8の場合の問題点を教えてください。 自分で調べた限りでは、昔は対応していないメーラーだと文字化けしていたが、今は対応していないメーラーはないので、大丈夫、という認識です。 しかしながら、大手のAmazonやYahoo!、プロバイダや銀行などから飛んでくるメールは、ほとんど全てがISO-2022-JPで飛んできます。 自分が知っている限り、UTF-8を使用しているところはありません。 なので、UTF-8でメール送信することに不安を感じています。 AmazonやYahoo!は、UTF-8だと何か問題があったので、あえてISO-2022-JPを使っているのでしょうか？ ISO-2022-JPだと 髙 などが文字化けするはずなのですが、髙→高に変換してメール送信しているのでしょうか？ よろしくお願いします。
比較が上手く機能していません。 下のように書いていますが、全て緑になってしまいます。 （真の結果が採用されてしまいます。） if ($trm14 eq "●") {print "<font color='green'>";} else {print "<font color='red'>";} 全角は比較できないのでしょうか。 $trm14には間違いなく「●」が入っています。 入らない場合は""になっています。 $trm14はファイルの１項目です。 ちなみに、 以下のようにやればチャンと期待通りに機能します。 ●の代わりに「8」を入れてみました。 if ($trm14 == 8) {print "<font color='green'>";} else {print "<font color='red'>";} 宜しくお願いします。
下記のようなスクリプトがあります。 これは、CSVファイルを1行表示し、編集可能にするスクリプトの1行表示部分です。 これを全行表示するスクリプトに変更したいと考えています。 while ($cnt) { foreach(@csv2){ 　.............................. } } とすると無限ループするようです。(サーバーが固まる) webで調べたのですが、$cnt = '1'or die "$!"としても抜けだせません。 行が無くなったら作業を終了するとしたいのですが、どうすればいいでしょうか? 初歩的な質問で恐縮なのですが、レンタルサーバーをこれ以上固まらせるわけ にもいかないため、ご教授頂ければと思います。 @csv2 = split(/\<>/,$csv[$param{'num'}]); $cnt = '1'; foreach(@csv2){ &trString(\$_, "1",); if($_ eq $csv2[-1]){ chomp($_); } print "<tr>\n"; print qq|<td><input type="text" name="$cnt" size="30" value="$_"></td>|; print "</tr>\n"; $cnt++; }
Perlで、大きいソート順になっている配列があります。 その中には重複しているデータもあります @list = (100,80,80, 50, 50, 45, 10, 0, 0, 0); のような配列を @ranking = (1,2,2, 4, 4, 6, 7,10,10,10); と順位を格納させたいです。 簡単な方法がありましたら、教えてください。
perlでメールフォームを作成しようとしています。 fakesendmailでフォームデータを送信するように設定していますが、うまくいきません。 perlは動作しているみたいですし、fakesendmailのエラーログも動作しているので、パイプも問題ないと思います。 ですが、設定したメールアドレスの方にフォームデータが送信されません。 受信サーバ、送信サーバ、メールアカウント、パスワードもプロバイダ（フレッツ光）に教えてもらった通り設定しています。 サーバソフトはhttpdです。 何が原因で送信されないのでしょうか？ 原因だけでも、教えていただけないでしょうか？ よろしくお願いします。
Perl5.8からsendmailを使ってメール送信しています。 髙や﨑が入ると文字化けします。文字化けしないようにする方法を教えてください。 #!/usr/bin/perl require 'jcode.pl'; require 'mimew.pl'; $sendmail = '/usr/lib/sendmail'; print"Content-type: text/html\n\n test\n"; if (!(open(OUT,"| $sendmail -t -i -f xxxx\@hogehoge.co.jp"))) { ; } print OUT "To: xxxx\@hogehoge.co.jp\n"; print OUT "From: xxxx\@hogehoge.co.jp\n"; print OUT "Reply-To: xxxx\@hogehoge.co.jp\n"; $subject = "サブジェクト 髙﨑"; $subject = &mimeencode($mail_subject); print OUT "Subject: $mail_subject\n"; print OUT "Mime-version: 1.0\n"; print OUT "Content-Type: text/plain\; charset=\"ISO-2022-JP\"\n"; print OUT "Content-Transfer-Encoding: 7bit\n\n"; $honbun = "メール本文 髙﨑"; &jcode'convert(*honbun, 'jis'); print OUT "$honbun\n"; close(OUT);
CSVファイルを変換するPGを書きたいのですが、 変換したいCSVには改行コード\nと\r\nが混在しています。 改行コード\r\nはそのままにして \nだけ削除したいのですが どのように書けばよろしいのでしょうか。 Perlは5.12.2です。 よろしくお願いします。
perlを利用して文字列処理を行う際に、入れ子になった文字列を削除したいのですが、正規表現のうまいやり方が思い浮かびません。 例としましては 今日は雨（雪ではない（この辺の処理に困っている））が降っている。 という文章を 今日は雨が降っている。 と処理できるようにしたいです。 $data =~ s/（.*?）//g; $data =~ s/）//g; というやり方では、３重以上になった時の処理ができません。 できれば何重になっても可能な方法をご教示ください。
下記のような簡単なスクリプトなんですが、なぜかサーバーにアップすると動きません。 ローカルでコマンドプロンプトから直接実行するとまともに動作します。 パーミッションは「755」と「705」でやってみましたが。 perlのパスは合っていますし、実際同じ場所に置いた他のCGIは動作します。 #!/usr/bin/perl open (DT, "<./data/***/***.csv") or die "File '***.csv' Open Error."; @data = <DT>; $data[0] = ",,,,,,\n"; open (OUT,">./data/***/***1.csv") or die "File '***1.csv' Open Error."; print OUT @data; close (DT); close (OUT); 原因が分からず困っています。 解決策でなく、原因と思えるだけの回答で結構ですので何卒よろしくお願いいたします。
データ管理の為perlで データの保存先のパスを　\から/に変換させる事をしたいのですが、パスの途中、ファイル名に　十 申 曾 箪 貼 能 表　等の文字が入ると　文字が化けてしまいます。いろいろ調べて化ける理由は分ったのですが、やりたい事が出来ません。対応できる方法があれば教えてください。 文字コードはSHIFT-JISです 例：c:\申請表\能力検定\貼付け\十分.txt　を　c:/申請表/能力検定/貼付け/十分.txt　に変換したいがどうしても以下の様になってしまう。　c:/・請・・力検定/・付け/・分.txt　
perl(CGI::Session)を利用したセッション管理について教えてください。 【実現したい機能】 会員ＤＢ（IDやパスワードを保持）を使用し、認証を行い、 認証成功したらCookieを発行し、会員別のページを表示する。 会員DBのIDとCookieを紐づける機能は、CGI::Sessionにあるのでしょうか。 CGI側でCookieから会員DBのIDを結びつけるためには新たにファイルなどを作成する必要があるのでしょうか。
ロボットが回遊してきてcgiを実行され、被害が出るので、 .htaccessでアクセス制限を掛けたく調べています。 .htaccessファイルは以下のとおり作れました。 ***ここから order allow,deny allow from all deny from xxx.xxx.xxx.xxx ***ここまで ただ、このファイルを置く場所が分かりません。 プロバイダーの指定では、 /use/local/www/htdocs/user-id/public_html/目的のディレクトリ と在ります。 これは、.htaccessファイルをここに置け、ということかと思いますが、 ここはどのように指定するのでしょうか。 使っているのは、フリーウェアのffftpです。 ffftpを実行したとき、 サーバー側に表示されているアドレスは / となっています。 そしてそこに、cgi-binフォルダやindex.htmlが表示されています。 .htaccessの説明を読んだ限りでは、 制限を掛けたいフォルダ（ディレクトリ）に置け、となっていました。 であれば、このルート部分に置きたいのですが。 関連でもう一つ、やらなければならないことはこれだけで宜しいのでしょうか。 例えばcgiファイルなどで何か定義し直す必要とか。 宜しくお願いします。
perlプログラム内で、grepを行っております。 grep対象の中身に　+、*、（、）、[、]などの文字列が含まれているため、エラーとなり、 プログラムがうまく動作しません。 grepしたい対象データ例：http://www.XXX.co.jp/○○+▲▲ http://www.XXX.co.jp/○○+▲▲の+を　文字として判断し、正規表現扱いではないとしたい。 http://www.XXX.co.jp/○○+▲▲を含む文字を抽出したい。 perl　プログラムにおいて @line1 = grep(/$url/,<ARG>); という記述しておりますが、どのように変更すればよいでしょうか？ また、grepしたい対象データがファイルに格納されておりますが、 その中で、+を　\+　にファイル一括変換する場合、:%s/+/\+/g　で　やろうとしても、変換されません。 perlプログラムでの対応、grep元ファイルの変換処理方法　それぞれのやり方について教えてください。
早速ですが、 現在、指定された単語を含む文字列を抜き出す様なcgiを作っています。 現在のコーディングです。 foreach $line (@lines) { $an = index $line,$skey; if ($an >= 0) { 上記では、 $skey と全く同じモノしか検索（抽出）出来ないため、 今回、$skey　が英字の時は、大文字、小文字、およびその混在でも 抜き出せるように改善したいと思っています。 例えば、abc と指定されたら、abcでもABCでもAbcでも抜き出せるような。 （英字と数字の混在や、全角は対象外で構いません。） 考え方として、 指定されたキー（文字列）を基に大文字、小文字を作り、 （uc関数、lc関数） 両方で検索してやれば殆どokと思うのですが、 混在の場合はどうやればいいか思いつきません。 また、 そもそも指定されたキーが英字であるかの判断方法が分かりません。 （大文字、小文字の変換は英字に限りますので） ということで、 (1)大文字、小文字の混在時の対応方法 (2)指定されたキーが英字であるかの判断方法 を教えていただきたくお願いします。
Perl　初心者です。 FTP接続時失敗時、接続先名をcsvに出力する(書き出す)プログラムを作成しております。 ※複数FTPサーバがあり順番に接続していき、接続失敗したところをcsvに一覧にして出力したいです。もし、csvファイルがない場合、C:/logの下にERROR.csvを作成する必要もあります。 今現在、私が作成しているプログラムが以下になります。 #!C:/Perl/bin/perl use Net::FTP; use strict; my $i; my $j; my @ftp_data = ( ['ftp','192.168.0.0'], ['ftp2','192.168.0.10'], ); sub error{ my $file = "ERROR.csv"; if(!-d"C:/log/$file"){ open(TFILE,"+>> $file") or die($!); print OUT "$ftp_data[$i][0]"; close(TFILE); } else{ open(OUT, ">> $file"); # 追加オープン print OUT "$ftp_data[$i][0]"; close(TFILE); } exit; } for ($i = 0; $i <= $#ftp_data; $i++){ #FTPサーバーへの接続 my $ftp = Net::FTP->new("$ftp_data[$i][1]") or &error; #ユーザー名とパスワードを指定してログイン $ftp->login('user','password') or die $ftp->message; print "connect $ftp_data[$i][1]\n"; #接続終了 $ftp->quit; } 実行してみると何もでないでずっとループ?しているみたいなのですが、 どこが悪いのかよく分からないのです。 ご教示いただけないでしょうか?
csvから接続先名とIPアドレスを多次元配列を利用して引っ張り for文等でcsvに書かれている全接続先につなぎデータを取ってくるプログラムを作成しようと思っております。 しかし、多次元配列の使い方やfor文を調べても良くわからず困っています。 csvは、例えば以下の通り設定します。 【hp_ftp.csv】 hp1　192.168.1.12 hp2　192.168.1.10 hp3　192.168.1.20 以下、perlのプログラムです。 #!C:/Perl/bin/perl use Net::FTP; use strict; #FTPサーバーへの接続 my $ftp = Net::FTP->new('各サーバIPアドレス') or die; #ユーザー名とパスワードを指定してログイン $ftp->login('user','password') or die $ftp->message; #保存先ディレクトリの存在確認・作成 if(!-d"C:/接続先名"){ mkdir "C:/接続先名"; } else{ print"Directory already exists!\n"; } #保存先ディレクトリの変更 chdir("C:/接続先名/") or die; 以下略 #取得元ディレクトリの変更 #データ取得(for文で) #接続終了 【質問】 ・IPアドレス(192.168.1.12....)をcsvから引っ張りperlの'各サーバIPアドレス'に入れたい ・接続先(hp1...)をperlの'接続先名'と書かれている部分に入れたい どのようにプログラムを組めば良いのでしょう? ご教授の程宜しくお願いいたします。
perl初心者です。 FTPの設定で、ホストの設定名・ホスト名(アドレス)などありますが、 FTPホストの設定名(HPSERVER)を変数として代入させ、その変数でフォルダ名として 使用することは可能でしょうか? 例えば、以下の場合 #FTPホスト名(アドレス) 111.111.111.111 #FTPホストの設定名 HPSERVER #作成するフォルダ名(C直下に作成) FTPホストの設定名(HPSERVER)
表題のとおり「ＧＥＴリクエストのヘッダにX-WSSE認証を追加して送出する」方法がわからず困っています。 なぜそれをやりたいかと申しますと ライブドアブログに投稿するのに、XML::Atomを使った方法はわかったのですが、 XML::Atomを使わないでやるにはどうしたらいいのかとおもい試しています。 http://www.witha.jp/Atom/Chapter-3_The_Atom_Publishing_Protocol_or_AtomAPI.html#Atom3-4-3 によりますと、 ---- エンドポイントのhttp://cms.blog.livedoor.com/atomに認証情報をヘッダに挿入したGETリクエストを送信します． 　生のHTTP通信は以下のようになります． リクエスト： GET http://cms.blog.livedoor.com/atom HTTP/1.1 X-WSSE: UsernameToken Username="＊＊＊", PasswordDigest="eNSBiuFfcLpau1RfWc3lOWufje0=", Nonce="ZGFrZHZueGJ6aGh1", Created="2004-10-31T14:08:34Z" --- と、あっさり書いてあるのですが、 ◆「認証情報をヘッダに挿入したGETリクエストを送信」◆はどうやれば良いのやら・・・ 強引にこうかいてみたのですが・・ -------- use LWP::UserAgent; $request = HTTP::Request->new(GET => 'http://cms.blog.livedoor.com/atom', ['X-WSSE'=>'User nameToken Username="＊＊＊＊＊", PasswordDigest="KxZ4DElJVqsIBXiF9ZIWCp59ghM", Nonce="YWFh", Created="2004-01-20T01:09:39Z"']); $ua = LWP::UserAgent->new; $response = $ua->request($request); print $response->content; ---------- 以下のように成ってしまいました。 ---------------- <?xml version="1.0" encoding="utf-8"?> <error>Invalid login</error> ---------------- どうかよろしくおねがいします。
以下のようなリンク先の画像の縦横のピクセルサイズを取得することは可能でしょうか。 http://www.hogehoge.com/images/sample.gif 登録式の検索エンジンで登録バナーサイズの判定をしたいと思っております。 もし出来るということであれば具体的なソースも教えて頂ければ幸いです。 どうぞ宜しくお願い致します。
Perlのサブルーチンで連想配列（ハッシュ）を渡す方法 -------------------------------------- $str=rep::replace(%A,$B,@C); -------------------------------------- sub refidrep ( \%\$\@ ){ my(%A,$B,@C)=(@_); } -------------------------------------- では、上手くいきませんでした。 どのようにしたら、連想配列をサブルーチンに渡せるのでしょうか？ 分かる方いらっしゃいましたらご教授ください。
最近 学習し始めたばかりの Perl ですが、 リファレンスとは、機械語に出てくるメモリ（記憶装置）の アドレス（番地）という解釈でよいのでしょうか？ （画面上１６進数の番地等は表に出てこないようですが・・） また、下記サンプルの場合 リファレンスを番地と仮定しまして、 配列@arrayの番地は、５個ぶんのメモリ領域が確保されるのでしょうか？ そしてスカラー$ref_arrayに代入される番地は、 その５個ぶんの番地の先頭番地でしょうか？ （スカラー変数１つに、５個のデータは入らないですよね？） @array = (1,2,3,4,5); $ref_array = \@array; 表現的にわかりにくいかもしれませんが よろしくお願いします。
perl初心者です。 FTPサーバーのLOGを取得する場合のプログラムをperlで作成しております。 保存先設定を1回(1行)設定しただけで設定先フォルダにLOGファイルが保存されるような方法はありますでしょうか? 今現在以下のように保存先を指定して取得しています。 my $local_file1 = 'C:/log/aaa.csv''; my $local_file2 = 'C:/log/bbb.csv'; my $local_file3 = 'C:/log/ccc.csv'; $ftp->get('取得元パス/aaa.csv',$local_file1); $ftp->get('取得元パス/bbb.csv',$local_file2); $ftp->get('取得元パス/ccc.csv',$local_file3); ただ、1ヶ月分のLOGを取得するとなるとmy $local_fileも$ftp->getも1ヶ月分作成しなければならないため長文のプログラムになってしまいます。 他、1ヶ月分ならFor文でこんな感じでやれば・・・というアドバイスがあればお願いいたします。
このプログラムソースでやりたいことは、 東海と入力すると 地方だと 東海は900円になります。 と表示させたいのですが、 うまく表示されません。 分かる方いましたら、教えてください。 教えて頂けると、助かります。 よろしくお願いします。 以下、プログラムソースです。 print"愛知県から小包の地方を入力してください。\n"; chomp($t=<>); if ( $1=="関東,信越,近畿,東海,北陸") { print"$t地方だと \n"; } elsif ( $1=="東北,中国,四国" ) { print"$t地方だと \n"; } elsif ( $1=="九州") { print"$t地方だと \n"; } elsif ( $1=="北海道") { print"$t地方だと \n"; } elsif ( $1=="沖縄" ) { print"$t地方だと \n"; } if ( $1 == 60 ){ print"$1は700円になります。\n"; } elsif ( $1==80) { print"$1は900円になります。\n"; } elsif ( $1==100 ) { print"$1は1,100円になります。\n"; } elsif ( $1==120 ) { print"$1は1,300円になります。\n"; } elsif ( $1== 140 ) { print"$1は1,500円になります。\n"; } elsif ( $1== 160 ) { print"$1は1,700円になります。\n"; }else { print"$1は1,900円になります。\n"; }
配列 @in=(10,20,30,40) がある、各項目を $n 倍するプログラムを作っていますが、 $n 倍出来ません。 以下、プログラムです。 #!/usr/bin/perl @in=(10,20,30,40) ; print"@inを"; print"何倍しますか？:"; chomp($n=<>); foreach $ni_tall (@in) { $n *= $ni_tall; } $ave = $n * @in; print "結果: $ave\n"; print "結果: $ni_tall\n"; print "結果: $n\n"; print "結果: @in\n"; ＿＿＿実行結果＿＿＿ 10,20,30,40を何倍しますか？:７ 結果：6720000 結果： 結果： 1680000 結果： 10 20 30 40 となってしまいます。 例えば、 ：２ 結果：20,40,60,80 としたいのですが、 分かりません。 分かる方いましたら、教えて頂けると助かります。 よろしくお願いします。
こんにちは。私はperlの勉強に掲示板を作成しようと試みております。 しかし、cgiは間違ったプログラムをサーバに送ってしまうとサーバ全体に迷惑をかける可能性があるるそうです。 そこで、自分のPC上で動作確認をする方法があれば教えていただきたいです。 使用しているPCはwindows vistaです。 AN HTTPDはvistaに対応していないそうなので、その他のファイルを利用した方法や手順を教えていただければ、またそのような手順が掲載されているサイトを教えていただければ幸いです。 まだまだ初心者の身なので、できるだけ易しい解説でされましたら尚嬉しい次第です。 それでは回答の方よろしくお願いいたします。
PerllのWeb::Scraperを使って商品の情報を取得するみたいなことをしたいのですが、下のコードでなぜかブランドと製造販売元が取得することができません。 http://www.kenko.com/product/item/itm_6521067072.htmlのソースを見てみると、<div class="ltxt brand">にブランド情報が、<div class="ltxt">に製造販売元の情報が書かれています。それなので、process "div.ltxt", "maker" => "TEXT";とすれば製造販売元の情報（文字列）が取得されるはずなのですが、なぜかブランド情報（process "div.ltxt.brand", "brand" => "TEXT";として得られるはず？）が得られてます。これはなぜでしょうか？ またこのスクリプトWeb::Scraperでは基本的にclass="***"のようにクラスの定義がされていないものについては情報を取得できないのでしょうか？例えば、同ページのソースコードにある<div>内容量：250ml</div>や<div itemprop="identifier" content="upc:4987222787413">JANコード：　4987222787413</div>から内容量とJANコードの情報を得ることはできないでしょうか？ #!usr/bin/perl use strict; use warnings; use Encode; use Web::Scraper; use URI; use utf8; binmode STDOUT, ":encoding(shiftjis)"; #scraperオブジェクトを作成 my $shinkan = scraper{ #processメソッドで抽出する要素と展開方法を指定 process "div.mainBox","fil_list[]"=> scraper{ #scraperメソッドを渡して,"td.c-table01"要素をさらに展開する process "h1.fn", "goods" => "TEXT";# 商品名 process "div.ltxt.brand", "brand" => "TEXT";# ブランド process "div.ltxt", "maker" => "TEXT";# メーカー process "span.price" => "price" => "TEXT";# 価格 }; }; #scrapeメソッドでスクレイピングを実行 my $res = $shinkan->scrape(URI->new("http://www.kenko.com/product/item/itm_6521067072.html")); foreach my $dat(@{$res->{fil_list}}){ #undefの場合は、""を代入する。 unless(defined($dat->{goods})) {$dat->{goods} = ""}; unless(defined($dat->{brand})){$dat->{brand} = ""}; unless(defined($dat->{maker})) {$dat->{maker} = ""}; unless(defined($dat->{price})){$dat->{price} = ""}; print "goods = ", $dat->{goods}, "\n"; print "brand = ", $dat->{brand}, "\n"; print "maker = ", $dat->{maker}, "\n"; print "price = ", $dat->{price}, "\n"; };
perlで数字の下二桁を削除したい場合、どうすれば宜しいでしょうか？ 例えば、 987654321 112233441 998877 上の数字から下二桁を切り捨て以下の様にしたいのです。 9876543 1122334 9988 よろしくお願いします。
はじめまして。 現在javascriptを勉強中の者です。 PerlからHTML構文内にjavascript構文を追記し出力しようとしていますが、追記してPerlを実行させただけでInternal Server Errorとなってしまいます。 過去ログをいくつか見させて頂きましたが、自分のソースのどこが悪いのかさっぱりです；； やりたいことは、登録完了ポップアップを表示させるだけです。 表示条件等は別として、まずjavascript構文をソースに追記してポップアップを表示させたいです。 どうか良きアドバイスをお願い致します。 #!/usr/bin/perl require "cgi-lib.pl"; print "Content-type: text/html\n\n"; print qq! <HTML> <HEAD> <META Http-Equiv="Content-Type" Content="text/html;charset=EUC-JP"> <META name="robots" content="noindex,nofollow"> <TITLE>登録画面</TITLE> </HEAD> <BODY> <script type="text/javascript"> <!-- alert("登録完了"); // --> </script> <FORM ACTION="test.cgi" METHOD="post"> <FONT SIZE="4"><B>登録画面</B></FONT>　 </BODY> </HTML> !;
お世話になっております。 perlでファイルない文字データを抽出する作業をしたいですが、やり方が分からなくて、ご存知の方ぜひ教えて頂けばと思います。 001.html内の内容 ＜html＞ ＜head＞ ＜/head＞ <body> テキストテキストテキストテキストテキストテキストテキストテキストテキストテキスト＜img　src＝"aaa" \/＞テキストテキストテキストテキストテキストテキストテキストテキスト＜img　src＝"bbb" \/＞＜img　src＝"ccc" \/＞＜img　src＝"aaa" \/＞テキストテキストテキストテキストテキストテキストテキストテキスト</body> </html> 質問内容 (1)このなかの＜img　src＝"aaa" \/＞イメージファイル名を抽出したいです。本文ではイメージファイルの拡張子はなしです。入力の間違いではないです。 (2)抽出した文字列をimg.txtファイルで出力 以上よろしくお願いします。
現在、csvファイルの一覧から特定のデータを表示出来るdatabase.cgi を保有しています。 例えば、csvファイル2列目のジュエリーのID(1001)で検索すると、2列目が1001となっている「3列目の真珠、ダイヤモンド... 及びそれぞれのコードナンパー(4列目)」が表示されることが可能です。 例　database.cgi?equal2=1001　で検索 表示内容の中に 真珠　1011 ダイヤモンド　1012 ルビー　1013 　　と表示させることが可能です。 一方、URLの一番最後でコードナンバーを指定すると、そこにある商品がxmlファイルから自動表示されるphpを組みました。(hoge.php?1011) この2つを組み合わせると、ジュエリーで検索して、3行目の真珠　というの文字をクリックすると、phpにより「xlmファイルにある商品一覧を表示」させることが可能です。 <a href　="./hoge.php?1011>真珠</a> <a href　="./hoge.php?1012>ダイヤモンド</a> <a href　="./hoge.php?1013>ルビー</a> 質問です。 上記のようにクリックさせることにより、hoge.php?1011を表示させることは可能ですが、これをcgi内でそのまま表示したいと考えています。 htmlファイルであれば、SSIを利用して利用可能ですが、今回はcgiファイルですので使用できそうにありません。 一方、phpファイルであれば、file get contents で取得可能のようですが、今回はcgi上での表示ですのでこのコマンドは使えません。 インラインフレームでの表示なら可能ですが、これにはしたくありません。 cgi上でphpが吐き出したファイルをそのまま表示する方法はございませんでしょうか? よろしくお願いいたします。
2ちゃんのように　書き込みがあると　 TOPにスレッドをあげるのは どう作ればいいんですか？ いちいち全部のファイルを書き換えるのは　厳しそうだし。 どんなシステムなんでしょうか？ 教えてください
とあるソースで $hogehoge =~ s!<文字列>! do{ $hoge =qq(hogehoge);} !egiox; $_ = $hoge; というのを見たのですが $hogehoge =~ s/<文字列>/hogehoeg/egiox;とは何が違うのでしょうか？ また修飾子gとoではどちらが評価されるのでしょうか？または二つとも評価されるのでしょうか？ 宜しくお願い致します。
Perlにてファイルの一括読み込みを以下記述で実施しております。 実行環境はAIXです。 ------------------------------- #!/usr/bin/perl open(FH,"/tmp/filename1.txt"); @aaa=<FH>; close(FH); print "@aaa\n"; ------------------------------- 上記内容をWindows XPにて実行した場合、何も表示されません。 print文が動いていないのか、ファイルの読み込みができていないのか不明です。 ファイルのパスは以下のように変更しております。 ------------------------------- open(FH,"C:\filename1.txt"); @aaa=<FH>; close(FH); print "@aaa\n"; ------------------------------- Windowsにて動作するようにはどのようにすれば宜しいのでしょうか？ 初歩的な質問かもしれませんが、宜しくお願い致します。
perlスクリプト内でLINUXコマンドのsourceを実行する方法はないでしょうか？ system()を試みたところ、組み込みコマンドだとエラーとなってしまいます。 sourceしたいファイルの内容を解読して$ENV{～～}に設定する方法もあるかと 思いますが、何か単純にできる方法があるのではと思っております。
　cgiやplファイルは殆ど触ったことがないので、わかりやすく教えていただけると助かります。 　今、入力フォームをhtmlで作成しており、郵便番号から住所を自動入力させるAjax利用のフリーサイトを見つけたのですが、郵便番号の更新手順がわかりません。 http://www.kawa.net/works/ajax/ajaxzip2/ajaxzip2.html#download 上記URLに郵便番号辞書のアップデート手順があるのですが、具体的にどのように行ったらよいのかわかりませんので、教えていただけると大変助かります。 「サーバ上でなくても、Windows 環境（ActivePerl）や Mac OS X クライアントでも csv2jsonzip.pl は実行できそうです。」とありますが、当方はサーバ上ではなく、Windowsクライアントです。
先の質問「プログラムのヒントを下さい」でも扱ったのですが、 apple best apple END apple beer beer END zero child death zero のようなテキストから、ENDとENDの間か、ENDと最初もしくは最後の間の重複した文字列を取り除くスクリプトを書こうと思います。出力例は以下のようになってもらいたいです。 apple best END apple beer END zero child death 自分で頑張って下のコードまで書きましたが動きませんでした。特に、ENDと最初もしくは最後の間 の取り扱いがわかりません。どなたかご教授お願いいたします。 open(IN, "datafile"); @xx = <IN>; @zz = (); foreach $yy (@xx) { if ($yy eq "end"){ @uniq = uniqArray(\@zz); foreach my $value ( @uniq ){ print "$value\n"; } @zz = (); }else{ push(@zz,$yy); } } close(IN); sub uniqArray{ my $array = shift; my %hash = (); foreach my $value ( @$array ){ $hash{$value} = 1; } return( keys %hash ); }
C言語は勉強しましたが、perlはまだまだ初心者の者です。 統計ソフトRの処理のためのスクリプトを書こうと思ってますが、うまくいかずに悩んでいます。 ファイルに以下の用に任意個の文字列が記述されています。ただし、ファイルの途中にはEND が複数かかれており、END以降も文字列が続きます。 apple best china dutch END apple beer END child death zero このファイルを受け取って、 c("apple","best,"chine","dutch"),c("apple","beer"),c("child","death", ,"zero") のようにENDが出てくるまでc(" ",...)を繰り返しを出力するスクリプトを書こうと思っています。 open(IN, "datafile.txt"); @xx = <IN>; print "c("; foreach $yy (@xx) { print "\"$yy\","; } print ")"; close(IN); のように書くとこまではいけたのですが、この先が進めません。どなたかご教授ください。
Perlで複数ファイルをアップロードする方法？ Perl勉強中の初心者です。 掲示板などで、フォルダ内にある複数ファイルを一度に ファイルアップロードする方法はどうやるのでしょうか？ 一番は、サンプルプログラムがあれば、教えてほしいです。 また他の言語で可能なら、その方法論を知りたいです。 それを元にPerlで実現できないか検討したく。 よろしくお願いします。
Perl初心者で、既出の質問かもしれませんが、ご教授願います。 以下のように"*"が入っている値を抽出する処理があります。 ーーーーーー処理ーーーーーー @array = ('aaa', 'b*b', 'ccc', 'dd*'); foreach (@array) { if ($_ =~/\*/) { print "OK\n"; } else { print "NG\n"; } } ーーーーーーーーーーーーーーーー ーーー結果ーーー NG OK NG OK ーーーーーーーー ＜質問＞ 上記結果より、OKとなった値の配列(添え字)を取得するにはどのようにすれば宜しいでしょうか？ 宜しくお願い致します。
perlかphpでwebページの操作をするにはどうすればいいのでしょうか？ webページの操作とは、 ユーザID/パスワードを入力してログイン、ページを進んで行き、値を入れて実行ボタンを押す、 みたいなことです。 よろしくお願いします。
連想配列（ハッシュ）のファイルへの書き込み方と、 そのファイルからの読み込み方で困っています。 たとえば以下のような連想配列（ハッシュ）があって %colorFile = ( 'red'=>'5', 'green'=>'10', 'blue'=>'3' ); この情報をサーバーの color.dat ファイルに書き込んで保存し、 変更があったときにファイルからデータを読み込むには どのようにしたらいいのでしょうか？ 連想配列（ハッシュ）のまま保存すると color.datの中身が green10blue3red5 のようになってしまい、 読み込んだときに連想配列（ハッシュ）に復元できません…。 よろしくお願いします。
$ref == 0 が正常に判定されていないようです。なぜでしょうか？ また、if($tag =~ m/^tag$/ && $ref == 0){について、どのように改良するのが適切でしょうか？ $| = 1; my $tag = "tag"; my $ref = "test"; if($ref eq ""){$ref = "0";} $ref =~ s/%([a-f\d]{2})/pack 'H2',$1/egi; if($tag =~ m/^tag$/ && $ref == 0){ print $ref; }
