この８と書かれている枠をクリックして、数字を書き換えてフォントサイズ指定しても ８ に戻されてしまいますか？
コンピューターかどうかは関係なく、関連・依存する複数の処理をまとめて一つの処理単位として扱い、そのような処理単位をトランザクションと言います。その処理のことトランザクション処理と呼び、主にデータベースシステムや業務用ソフトウェアなどで用いられる概念です。 例えば、銀行などの金融機関の入出金処理、企業の在庫入出庫処理のように、一連の作業を全体として一つの処理として管理するために用いる考え方です。 ここで質問することではなく、自分でIT用語を調べれば分かると思いますけどね。
そのスマホがWindows phoneならこちら。 https://msdn.microsoft.com/ja-jp/library/hh202860(v=vs.92).aspx Androidならこちら。 https://codezine.jp/article/detail/4814 VBAの知識は直接の役にはたちません。
関係データベースに似せてISAMを集合にし、クエリ操作させたデーターベースです。なので表面上、利用上からはRDBに見えます。しかしマネージメントはしていません。 Wikiに書いてあるのは利用上RDBだという意味で書いてあります。構造上はRDBMSではありません。ほど遠いものです。 これをRDBといったらExcelもVBAでクエリ関数を作成して使ったらRDBになってしまいます。RDBというのは内部検索アルゴリズムに特徴があります。ツリー検索で処理すると言うものです。 https://ja.wikipedia.org/wiki/%E9%96%A2%E4%BF%82%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9 に書いてあるDBが大方のRDBMSです。Accessは無いのです。MSはSQLServerをサイベースからライセンス供与されるまでこの技術を持っていませんでした。Accessはその前に作成されたDBです。その後改良はされていますがそれでもRDBMSには程遠い構造になっています。
添付に示したようにしたいということですか? これはこういう風にしました。 テキストボックスの規定値を「Default Value」として、文字の色を灰色にします。 フォーカス取得時のインベントとして、値をヌルにして文字の色を黒にします。 ただそれだけです。 なお、どこかのタイミングで、文字の色を灰色に戻しておく必要があります。
こんにちは。 他の方もおっしゃっていますが、個別の製品に関する問題は出ません。 データベースの設計や運用に関わる汎用的かつ専門性の高い問題が出題されます。また、データベースの理論的な問題や仮想の実務ケースをもとにした問題解決方法などが問われます。SQL、RDBMSの仕組み、実運用系のバックアップやリストア、リカバリ、ロールバック、ロールフォワード、排他制御などについては一通り理解しておく必要があると思います。午前の問題に関しては情報処理技術者共通の問題が出題されますのでプログラミング、ソフトウェア工学、ネットワークなどの知識も一通り学んでおく必要があります。 ご参考になれば幸いです。
あれれ？ なんだかわかりませんが、端末のメッセージが正常なものに変わってますね。 　C:\>mongo 　MongoDB shell version: 3.2.6 　connecting to: test 　Welcome to the MongoDB shell. 　For interactive help, type "help". 　For more comprehensive documentation, see 　http://docs.mongodb.org/ 　Questions? Try the support group 　http://groups.google.com/group/mongodb-user 　> 最後の > で mongo shell が命令を待ってます。ちなみにこのメッセージはクライアントとサーバが初めて接続した時だけ出るもので、次からは以下のような簡単なメッセージになります。 　C:\>mongo 　MongoDB shell version: 3.2.6 　connecting to: test 　> 試しに show log でも試してみましょう。これはクライアントでサーバのログを表示させるコマンドです。今実行すると、サーバの端末と同じメッセージが表示されるはずです。 　> show log 　2016-06-12T17:41:38.788+0900 I CONTROL [initandlisten] MongoDB starting : pid=3744 port=27017 　（中略） 　connection accepted from 127.0.0.1:49717 #1 (1 connection now open) 　> ここまでできればサーバもクライアントも正常に動いています。
rs.Filter = "(名前 = 'test' and 対象外 = 0) or (名前 = '共通' and 対象外 = 0)" だと？ ＠酔
取引、データのやり取り。
アクセスでしょう、元のプラットフォームがAccessはWindows、ファイルメーカーはMacですから、それぞれのシェアの大きさの違いが需要の違いになると思います。 また機能面では「ファイルメーカー」は比較的簡単にデータベースが作れて、操作し易い 「Access」はＳＱＬでのデータベースの操作やＶＢＡで高度なプログラムが組める といった違いがあります。 ファイルメーカーも新しくなると色々と機能強化されていますけど、まだAccessには及ばないと思います。 http://ivystar.jp/ms-office/access/filemaker-seen-from-access-user/ http://ywc.com/filemaker/?p=489 http://www.recrear.jp/2009/04/249/
https://www.google.co.jp/search?sourceid=navclient&aq=hts&oq=&hl=ja&ie=UTF-8&rlz=1T4GUEA_jaJP587JP587&q=Jet%e3%83%87%e3%83%bc%e3%82%bf%e3%83%99%e3%83%bc%e3%82%b9%e3%82%a8%e3%83%b3%e3%82%b8%e3%83%b3 上記に色々解説があります。 また、エンジンに関しては以下の解説を参考にしてください。 http://e-words.jp/w/%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3.html
正規化と言っても色々なレベルの正規化があります。 https://ja.wikipedia.org/wiki/%E3%83%AA%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E6%AD%A3%E8%A6%8F%E5%8C%96 をざっと見てみてください。 やってみようと思うが、上記の説明で分からない場合は、データベースの入門書を読んでください。
途中から失礼します。 これ、ADOに参照設定をしていますよね？ こんな感じでどうでしょ。 Sub test() Dim rs_issues As ADODB.Recordset Dim adoCn As ADODB.Connection 'ADOコネクションオブジェクト Dim sSql As String Set adoCn = New ADODB.Connection adoCn.Open "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & _ "データベース名" Set rs_issues = New ADODB.Recordset rs_issues.CursorLocation = adUseClient sSql = "SELECT * FROM T_issues WHERE i_チケット番号=123456" rs_issues.Open sSql, adoCn, adOpenDynamic, adLockOptimistic Debug.Print rs_issues.LockType '(1)LockType=3 rs_issues!あれ = "昼飯" rs_issues!いつ = Now rs_issues.Update rs_issues.Close: Set rs_issues = Nothing Set adoCn = Nothing End Sub
テーブルとモジュールがバックエンドで、フォームがフロントエンド、クエリがちょっとわからないですがバックエンドなのかなぁともいます。 考え方としてはフロントエンドが画面に映るところという感じで受け取っています。
http://qiita.com/KENJU/items/cde7f5b4f4cfacf749ed
アクセスのデータをそのまま使うとか、Windows環境で作りたいならVisualBasicとかC#でしょう。 サーバをLinux等で構築するならPHPが手っ取り早いと思います。
前回のSQL、タイプミスしてました。 下記に訂正します。 select * from table_name as t1 where 出席番号 in ( select 出席番号 from table_name as t2 where t1.クラス = t2.クラス order by 点数 desc limit 2); 動作確認もしました。下記で確認してください。 http://sqlfiddle.com/#!15/d2f72/1 あるいは、クラスが３つだけなら、union でマージしてもいいですね。 (select * from table_name where クラス = 1 order by 点数 desc limit 2) union all (select * from table_name where クラス = 2 order by 点数 desc limit 2) union all (select * from table_name where クラス = 3 order by 点数 desc limit 2) ;
　もしかしますと、コピー&ペースト等の方法によって複数のセルに対して同時に入力が行われる事もあるかも知れませんし、A列のセルに入力済みであった値を消去した場合には、その右隣に入力されている日時も消える様にした方が良いのではないでしょうか？ 　その事を考えますと、A列のセルの値が変更された際に、変更後の値が空欄の場合と、空欄ではない場合に分けて、それぞれ異なる処理をVBAで行う様にするよりも、値が変更されたA列のセルの右隣のセルに対してのみ「A列が空欄の場合は何も表示せず、空欄ではない場合には現在の日時を表示する」というワークシート関数を一旦入力してから、そのワークシート関数によって得られた値を、同じセルに値のみを入力し直すというVBAとした方が簡単かも知れません。 　又、例えば2行目は各列のデータの名称(項目名)を入力するために使用されていて、実際のデータは3行目以下に入力される様になっている場合において、A2セルの項目名を変更した際にB2セルに入力されていた項目名が、日時のデータに上書きされて消えてしまう様な事があれば不味いのではないかと思いますので、A列の値が変更された際に、その右隣のセルに日時が入力される様になるのは、何行目以下の行からにするのかという制限を設けておいた方が良いと思います。 　そういった事を考えますと、次の様なVBAは如何でしょうか？ 　尚、下記のVBAは、A3以下のセルの値が変更(入力されていた値の消去も含む)された場合にのみ、その右隣のセルにその時の日時を入力する様になっております。 Private Sub Worksheet_Change(ByVal Target As Range) Dim myChange As Range, myColumn As String, _ FirstRow As Long, LastRow As Long, myNow As Date myColumn = "A" 'データが入力される列 FirstRow = 3 '実際のデータが入力されている最初の行 LastRow = Cells.SpecialCells(xlCellTypeLastCell).Row If FirstRow > LastRow Then Exit Sub Set myChange = Application.Intersect(Target, _ Range(myColumn & FirstRow & ":" & myColumn & LastRow)) If Not myChange Is Nothing Then myNow = Now() With myChange.Offset(0, 1) .FormulaR1C1 = "=IF(RC[-1]="""","""",""" & myNow & """)" .Value = .Value End With End If End Sub
Q、何か対処方法は無いでしょうか？ A、対策は二つ。 その１、不具合を解消する。 その２、オートナンバーの使用を中止する。 その１については、[Access オートナンバー　重複]等で検索すれば正常化する幾つかの方法が見つかります。 ですが、やはり＜その２＞が王道かと思います。テーブルが壊れた場合にはオートナンバーの使用が復旧のネックになるからです。
あなたの質問を見た時に右側にある「関連するQ&A」から http://okwave.jp/qa/q7911345.html のDexMachinaさんの回答では？
SELET AAA, SUM(BBB) AS CCC FROM DDD GROUP BY AAA　構文のアレンジで・・・。 SELECT 　　受付CD, 　　Sum(IIf([区分1]=1,金額,0)) AS 合計1, 　　Sum(IIf([区分1]=2,.金額,0)) AS 合計2, 　　[合計1]-[合計2] AS 売上 FROM AAAA GROUP BY 受付CD ORDER BY 受付CD;
もし、既存のテーブルにデータをいれるというのであれば、 No1でいいのですが。「新しいテーブル名」→「既存のテーブル名」。 既存のテーブルにデータが存在するのか、あるいはデータを 入れ替えるのかによって方法はことなりますが、 データの取り扱いがわからないので No1とNo2の両方を回答とすることにします。
1日30件ですか。だとすると年1万件程度。取引が激増して100倍になっても100万件。 割と小規模のシステムのようですのであまり気にしなくてもいいと思います。10年たったら新しい別システムを作っている可能性も高いと思いますし。 大規模システムの場合はきちんと予測し拡張計画を立てたりします。で、一定期間経過後に古いデータを別テーブルや別DBに移動して保存し、過去データも検索したい場合には結合するとかします。 めったに使わないデータの場合はテープに保存なんてケースもあります。特に昔は多かったです。でも不便ですし、大容量のストレージがどんどん安くそして高容量化しているので、テープはお勧めしません。 >ひと月ごとや一定の取引件数毎に分かれているのでしょうか？ ひと月ごととかはありません。通常は、「1年以上経過したデータをoldテーブルに移動」とかそういう感じです。
win7でAccess97が使用できるのか確認はしていません。 その上で、質問の、「With DATA」の「DATA」が何をさしているのか わかりませんが、一般的なVB6とAc97での方法を書いてみますと、 質問のデータベース名、テーブル名を使用すると、 Private Sub Command1_Click() Dim strPath As String Dim strSQL As String Dim db As DAO.Database Dim ws As Workspace strPath = "E:\U SS VB\IK NY DATA\SV_TL.mdb" strSQL = "DELETE * FROM UER01" Set ws = DBEngine.Workspaces(0) Set db = ws.OpenDatabase(strPath) db.Execute strSQL db.Close: Set db = Nothing ws.Close: Set ws = Nothing End Sub のようになります。ここで、テーブルのデータをすべて 削除する場合は、「DELETE * FROM UER01」のように 普通は明示的に「*」を使用します。そして、このSQL文をdb.Executeを使って データベースに対して実行します。 なお、この場合はDAOを使用しています。ADO接続の場合は接続方法を 変更してください。DAOの参照設定をプロジェクトで確認してください。
1. 『ソフトが販売されて』とはちょと感触が違います。 RAID を実現するには「ハードウェアRAID」と「ソフトウェアRAID」の2種類があります。ハードウェアRAID は RAIDコントローラという機器をサーバやパソコンに搭載する方法です。ソフトウェアRAID はOSなどのソフトウェアで RAID を実現する方法です。詳しくは以下の記事を参照してください。 http://itpro.nikkeibp.co.jp/article/COLUMN/20060712/243118/ 2. 『使うこともできる』と言ったほうが良いでしょう。 RAID を導入するのには、それなりにお金がかかりますので、家庭用途程度で導入するかは迷うところです。2枚の HDD に分散保存する目的なら、手で2回保存れば済む話ですからね。 サーバの場合は『手で2回保存』などできませんから、RAIDを使うことが現実的になってきます。 3. 以下の記事が詳しいので、こちらを参照してください。 http://www.atmarkit.co.jp/ait/articles/0102/27/news002.html
単一のデータベースでデータを抽出するのと、大量のコンピュータで分散並列処理を行うのとでは根本的な考え方が違うので性能差はしかたないでしょう。 それにRDBはデータが更新される際の安全性・一貫性にも考慮が必要ですが、Web検索のようなビッグデータからの抽出は検索と更新の処理が完全に分離されるので、余計な事を考えないぶん高速に処理させられますね。
～前略 debug.print .filter .FilterOn = True End With と１行追加し、イミディエイトウィンドウに出力された値を確認してみてください。 and の前に半角スペースが無さそうです。 あと、蛇足かもしれませんが Like 演算子を使っているのにワイルドカードは使用していませんね。 = で十分のような気がしますけど。
>そこで下記のようなSQLを書きました。 >SELECT * FROM MyTable WHERE MyDate >= substr(1,8) どう突っ込んでいいのか…。DBをさわるのもプログラミングをするのもほぼ初めてという感じの方なのでしょうか？ それを前提に書きますが 「WHERE」の右側には評価される式を書きます。 「MyDate >= substr(1,8)」ここですね。 この等号もしくは不等号の左右に比較する値を書くわけです。 で、あなたは何と何を比較したいのか、そこをまずあわてずにきちんと考えましょう。 あなたの式だと「MyDate」の値と 「substr(1,8)」を実行した結果を比較しているわけです。 そうしたいのですか？違うのではないでしょうか？ 「201502以上のデータを取得したい」というのなら、 式でも「201502」と比較しなければいけないとは思いませんか？ で、「MyDate」の先頭8文字を切り取った文字列と「201502」を比較したいのですよね。 そもそもsubstrの使い方も違うのでそこも書き換えますと、こんなかんじでしょうか。 「substr('MyDate', 1, 8) >= '201502'」
ネットワーク越しでも、DBオープンで正しい接続設定をすれば、このコードで接続できます。 ただし「相手のサーバ」「手元のクライアント」「サーバ・クライアントをつなぐネットワーク経路上」のどこかで SQL Server の通信を遮断されている場合は、当然ですが接続できません。
できますよ。 select * from 売上T,単価T where 売上T.品目=単価T.品目 and 日付 between 単価T.FROM and 単価T.TO とやればね。
リンク先見てないんですが、phpの動作確認と言うのは、phpでmysplに接続できることを確認したんですよね？ phpで、 echo "Hello World"; なんてテストしても無意味と言うか不十分ですよね。
FMDB ということは使用しているデータベースは SQLite3 ですね。この場合は INSERT ～ SELECT ～ WHERE NOT EXISTS で存在チェックしながら挿入します。 以下に SQL例を提示します。(FMDB ライブラリ表記への変換は質問者さんのほうで工夫してください) INSERT INTO search (date, site, title, url) SELECT データ1, データ2, データ3, データ4 WHERE NOT EXISTS ( SELECT 1 FROM search WHERE date=データ1 AND site=データ2 AND title=データ3 AND url=データ4) ※NOT EXISTS 内の WHERE 句は、search テーブルにPKが張られているのであれば PK の項目のみに省略できます。 なお、insert ignore は MySQL の『方言』ですので、他の DBMS で使用することはできません。
WHERE (busyo = '" & 部署 & "' OR '" & 部署 & "' = '') AND ... のように、ひとつひとつの検索条件に OR 文で『空白の場合の条件』を加える方法があります。ただ、この方法の場合、DBのインデックスが効かなくなりますので検索パフォーマンスが遅くなるという問題が出る可能性があります。 やっぱり IF 文で判別するほうが良いかと思いますけどね。 sql = "SELECT ... WHERE " concatWord = "" IF 部署 <> "" THEN sql = sql & concatWord & "busyo = '" & 部署 & "'" concatWord = " AND " END IF IF 月 <> 0 THEN sql = sql & concatWord & "m2 = " & 月 concatWord = " AND " END IF :
総量が分からないのですが。もしかしてこれ1枚ですか？また、通貨単位は円ですよね。20万円請求されているということですよね。とりあえずそうだとして。 (1)このHPは20万の価値はありますか？ ありません。よくて2万円です。通常ならこんな内容では恥ずかしくて金など取れません。この内容で20万円をとろうとするのなら、ヤクザか詐欺師、もしくはそれに準ずる類の人間です。 (2)『俺の仕事をなめるな』と言われていますが、そんなに凄いものですか？ こんな恥ずかしい内容で、20万円も金を取ろうろするのはすごいです。 (3)詳しい方からみて、率直、いかがなものでしょうか？教えてください(T_T)しつこく困っています。 いまどきXHTMLなんて使いません。わざわざ使う意味を聞いてみたい。聞いてもどうせまともな理由など何もないとは思いますが。またいまどきアンカータグでメールを送ろうとするなんてありえません。20年前の技術で、21世紀になってからはそんな書き方しているサイトをまず見かけません。 っていうか何のためにjQuery読み込んでんだよ、そもそもどこにもJavaScript使ってねーじゃねーか(analytics以外)。なんでEUCにしたの？と、ツッコミどころが多すぎて困ります。 10年以上前の本を古本屋で買って、HPを勉強し始めて3時間の学生の作る内容です。せめてHTML5で作れよと思います。 「友人がこのHPでの制作内容質問を教えて下さい！」この部分が何を言っているのかよく分かりませんが、「友人」に依頼して作成してもらったということなのでしょうか？だとすれば、あなたが「友人」だと思っている人は、少なくともあなたを友人だとは思っていません。脅せば金をむしりとれるカモだとしか思っていません。縁を切ったほうがいいでしょう。 出来れば、受け取らない金も払わないで済ませ、もう少しまともな技術を持った人や会社に作ってもらったほうがいいでしょう。
http://www.google.com/intl/ja/analytics/ ぐーぐるが無料提供するアクセス解析のためのデータ取得用のタグです。
> タスクスケジューラーで、シャットダウンの時にも、「フォームを閉じる」イベント適用されるのでしょうか？ 下記の前提が成立するなら、そうです。 Accessファイルは開いている。 フォームも開いている。（メニューフォームあるいは非表示のフォーム） タスクスケジュラーで定時にPCをシャットダウンする。 つまり、下記のような流れです。 PCをシャットダウンするコマンド → 開いているAccessファイルは閉じられる→開いているフォームは閉じられる→フォームの「閉じる」イベントは実行される > ただ、このDBの場合、フォームを押されたボタンにより条件分岐により行き来します、終了イベントと分ける方法はありませんでしょうか？ ちょっと意味がわかりません。もう少し具体的に説明してもらえますか。 > お客様に勝手に操作してもらうため、常時開いているフォームがありません。 それなら、データベースファイルの起動時に非表示のフォームを開いておくようにするといいでしょう。 下記のマクロを作成します。 アクション　フォームを開く フォーム名　非表示フォーム ウィンドウモード　非表示 このマクロを AutoExec という名前で保存します。 AutoExecマクロは起動時に実行されますので、起動時に「非表示フォーム」が非表示で開かれます。 このフォームの閉じるときに、バックアップ処理を割り当てれば、Accessファイルを閉じるときに、バックアップ処理が必ず実行されます。 > １．フォームをタイマープロシージャで定期的に再読み込み > ２．フォームの読み込みイベントに、時間を取得 > ３．２で取得した時間を条件分岐で、終了処理プロシージャーを実行 > こんな感じで良いのでしょうか？ Accessの方で定時に実行する場合ですね。 そんな面倒なことをしなくても、上記の非表示フォームのタイマー時イベントで、 時刻判断をして終了処理を実行すればいいだけです。 例えば、午後10時に自動終了する場合、 タイマー間隔は 60000 （60000ミリ秒＝1分）に設定しておいて、 Const CloseTime = #10:00:00 PM# Private Sub Form_Timer() If Time >= CloseTime And Time < DateAdd("n", 10, CloseTime) Then Me.TimerInterval = 600000 '終了処理 ElseIf Me.TimerInterval = 600000 Then Me.TimerInterval = 60000 End If End Sub ただし、 ユーザーが自由に操作できるという運用なら、当然ファイルも自由に閉じることができますよね。 ということなら、Accessの方で定時に実行するという処理を組み込んでも無意味のように思います。 定時にAccessが開いている保証はないのですから。 上で説明した非表示フォームの閉じるときに実行する方法にしておけば、もしユーザーが定時前にフォームを閉じたら、その時点でバックアップ処理が実行される。ユーザーがファイルを開いたまま帰宅したら、タスクスケジューラでシャットダウンするときに、やはりバックアップ処理が実行される、というように確実にバックアップが実行されます。 別の方法としては、バックアップ処理専用のファイルを作成しておいて、タスクスケジュラーでそのファイルを起動するようにするという方法もあります。 バックアップ処理専用のファイルはAutoExecマクロから終了処理プロシージャーを実行して、処理終了後ファイルを閉じるようにしておけばいいでしょう。
>コードの書き方が違うだけでしょうか？ いいえ手順が違います。 DAOはAccessだけに使える接続手順ですが、ADOは.NETで使え、OracleやSQLServerにも使えるユニバーサルな手順です。 この違いはストアドプロシージャの呼び出しやサーバー側カーソルがつかえ、しいてはサーバ側でSQLセットを回すことができます。 そもそもはマイクロソフトはRDOという効率のよい手順をSQLServer用に最適化した接続を用意しましたが、この手順は記述が難しくあまり普及しませんでした。 そこでどのDBにも同じ記述で接続できるようにADOを開発したわけです。RDOよりもスピードは落ちるけどプログラマーにとってはありがたいというわけです。 現在ではLINQという言語も開発し、さらにユニバーサルな接続を打ち出していますが、こちらもまた難しく今のところ普及はしていません。なにしろテキストファイルやXMLやRDBを総合的に接続でき、SQLを投げるそれらを結びつけてしまうのでネット上のどの情報も結合できるものですが、すべてをメモリで処理するのでメモリー上の操作が、VBなどになれているプログラマーらしき人たちには理解が難しいということです。 つまり今はまだADOが主流であることには違いありません。DAOとRDOはすでに過去の互換性のためのみにあります。
すみません。かなり寝ぼけてました。。。 これでどうかな？（システムのあるCドライブでは失敗します） Public Sub FolderSearch(strTargetDir As String) Dim fso As Object Dim folder As Object Dim subFolder As Object Dim file As Object Dim objFileSys As Object Dim objDrive As Object Dim strDriveLetter As String Set fso = CreateObject("Scripting.FileSystemObject") Set folder = fso.GetFolder(strTargetDir) strDriveLetter = Left(strTargetDir, 1) Set objFileSys = CreateObject("Scripting.FileSystemObject") Set objDrive = objFileSys.GetDrive(strDriveLetter) For Each file In folder.Files 'With file Me.ボリューム名 = objDrive.VolumeName Me.ファイル名 = file.Name Me.ファイルパス = folder.Path Me.ファイルサイズ = folder.Size DoCmd.GoToRecord acDataForm, "F0001_フォーム1", acNewRec 'End With Next file For Each subFolder In folder.SubFolders '←エラー箇所 If subFolder.Attributes <> 22 Then FolderSearch subFolder.Path End If Next subFolder Set objDrive = Nothing Set fso = Nothing Set folder = Nothing End Sub
プログラマから見ると、SQLサーバーみたいなものです。SQLが使える。 仕組みは違います。クライアント・サーバー型ではない。
なかなか厄介な量ですね。 以前試験的にではありますが、約1億件のデータを登録したことがあります。 1件あたり数十バイト程度のデータでしたが、このレベルになると使いにくいなという印象です。 重複データがかなりあり、重複を除くと100万件程度のものです。（同じ値が100件ずつ程度ある） インデックスを作らずに書きこむとそんなに時間はかからなかったですが、全部書き込んだあとインデクスをつくりだすと半日くらいはかかったと思います。印象としては重複が多いデータほど時間がかかるようです。 一度1億件程度で試されてはいかがでしょうか。 SQlite3は読み出すのは結構速いです。上の場合で数十ms程度で検索可能でした。 それよりもハッシュテーブルのように、抽出したいカラムのハッシュ値（同じデータは同じ値を返すならなんでもよい）を計算して、それに基づいて別々のファイルに分割してデータサイズをメモリに入る程度に小さくする。同じデータは必ず同じファイルに入るので、分割したファイル単位で操作できます。
以下のクエリを作成し、名前を「Qクエリ」とします。 SELECT [氏名], [役員名],[就任月],[任期] FROM [Aクエリ] UNION ALL SELECT [氏名], [役員名],[就任月],[任期] FROM [Bクエリ] UNION ALL SELECT [氏名], [役員名],[就任月],[任期] FROM [Cクエリ]; このクエリをテーブルとして以下の選択クエリを作成します。 氏名と役員名をグループ化し、就任月と任期を合計します。 SELECT Qクエリ.氏名, Qクエリ.役員名, Sum(Qクエリ.就任月) AS 就任月の合計, Sum(Qクエリ.任期) AS 任期の合計 FROM Qクエリ GROUP BY Qクエリ.氏名, Qクエリ.役員名; ミソは、「Qクエリ」でUNION ALL　としているところです。 勘違いしていなければ、ですが。
＞読み取り専用であれば、そもそもロックをかけない、という選択肢はないのでしょうか？ DBMSによってはそういう読み方も可能です。「ダーティーリード」といいます。 更新頻度の高いシステムの場合、ロックを全く掛けないと、一度読んでその後同じレコードをもう一度読むと値が変わっていることがあるわけですが、そういうのが許容できるならダーティーリードします。 1トランザクション内では同じレコードを何回読んでも同じ値でいて欲しいという場合は、共有ロックを掛けて、更新トランザクションを待たせます。 「レコードを読んでみてその値によっては更新するかも」という場合、ロックを掛けずに読んで、更新しようと思って、再度排他ロックを掛けて読んでみたら値が変わっていたというケース。 （ロックを掛けて読み直さないで更新するとまずいことはわかりますよね？） 最初から、排他ロックを掛けて読めばこういう困ったことは起こらないわけですが、更新しないかもしれない読み取りのために排他ロックを掛けると、トランザクション同士の待ちが発生する可能性が高くなります。ということで、最初の読み取り時に共有ロックを使うわけです。 読み取り同士で待ちが発生しないためのロックが共有ロックです。 というわけで、 ＞「共有」ロックというからには、なんらかのグループ単位でのロックになるのかな？　と解釈しているのですが……。 これは全然違います。 読み取り同士がレコードを共有できるという意味です。排他＝共有できない。 参考： http://ja.wikipedia.org/wiki/%E3%83%88%E3%83%A9%E3%83%B3%E3%82%B6%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E5%88%86%E9%9B%A2%E3%83%AC%E3%83%99%E3%83%AB
>RewriteEngine On >SetEnvIf User-Agent "MSIE [1-8]\.[0-9]" UA=IE8le >RewriteCond %{REQUEST_URI} !^/under_ie8.* >RewriteCond %{ENV:UA} ^IE8le$ >RewriteRule ^(.*)$ /old_style/ [R,L] IE8以下の専用ページのパスを　/under_ie8/ にしたのなら RewriteRuleも /old_style/のままじゃだめです。 RewriteRule ^(.*)$ /old_style/ [R,L] ↓ RewriteRule ^(.*)$ /under_ie8/ [R,L]
どんな出力結果があなたにとってベストなのかが分からないと・・・。 こんな方法もあるよ・・・という事で。 元テーブルの名前をテーブル1とします。（部門CDは数値型と仮定しています） 部門CDごとに社員名で連番をとります。 SQL文は SELECT [テーブル1].社員名, [テーブル1].部門CD, DCount("*","テーブル1","社員名<='" & [社員名] & "' and 部門CD=" & [部門CD]) AS 連番 FROM テーブル1; これをクエリ1とします。 クロス集計クエリをクエリ1を元に TRANSFORM IIf(IsNull(First([部門CD])),"","◎") AS 式1 SELECT [クエリ1].社員名, Count([クエリ1].連番) AS 兼任部門数 FROM クエリ1 WHERE ((([クエリ1].部門CD)<>0)) GROUP BY [クエリ1].社員名 PIVOT [クエリ1].部門CD;
A.accdb から B.accdb のフォームやモジュールを利用したい場合なら A.accdb のVBE で参照設定で B.accdb を登録すれば テーブル・クエリなどをレコードソースとしていないフォーム・標準モジュールなら 使用できるようです。詳しくは不明です。 別のAccessが立ち上がっても良いのならハイパーリンクの設定で行うとか。 少し見当違いの回答のような気がします。ご参考まで。
>レジストリを見てみると該当するパスに「TypeGuessRows」がそもそも存在してませんでした。 見てる場所が違うのかも。。。下記のURLを参照してください。 ・Excel ODBC ドライバでデータが 255 文字に切り捨てられる http://support.microsoft.com/kb/189897/ja
質問文からおそらく販売管理ソフトをご所望なのかなと思いますが、いかがでしょうか？ もし販売管理であれば最終的に会計ソフトに連動していくわけですよね。現在会計ソフトをご利用でそれを継続利用を考えてるなら、その会計ソフトメーカーや代理店に当たるのが常道な気がします。 以下、憶測濃度は濃い目ですがｗ 質問者様の勤務先規模で、有名どころの会計ソフトだと弥生会計でしょうか。もしそうなら弥生販売をまず候補にされてみては？ http://www.yayoi-kk.co.jp/products/dealing/ もっとも安価なスタンダードは仕入系機能が無いようですのでご注意を。リンク先の「弥生販売 15 製品一覧」に価格が掲載されてますので参考まで。 ＴＶのＣＭで有名な奉行シリーズならこちらかと。 http://www.obc.co.jp/click/bugyo-i/akinai/?serect=top02 ただしリンク先の「商奉行iのシステム概要図」を見るとわかるのですが、商奉行は販売側のみ。仕入もとなると蔵奉行という別の製品が必要になります。 商奉行の価格はこちら http://www.obc.co.jp/click/bugyo-i/akinai/feature06.html#price 蔵奉行の価格はこちら http://www.obc.co.jp/click/bugyo-i/kura/feature06.html いずれにしても現在、会計ソフトの有無とその継続利用がキーになりそうです。また販売管理は企業によってやりたいことにかなりバラつきがあるので、こういう掲示板で聞くよりもメーカーや代理店を呼びつけて、のアイミツ的な進め方が基本かと。その方が導入後にパートナーとなる相手の質もわかりますし。 大概の会計ソフトや販売管理で使われるPCの選定も慎重に。可能であればなるべく高性能なPCでのご利用を。 ではご健闘をお祈りしています。長文駄文失礼しました。
> どうやら、２０１０から、テキストボックスのNullの扱いが変わったようです。 えっ、そうなんですか。当方、Access2010で今まで IsNull で判定を行ってきましたが、問題になったことはないです。 確認するために、サンプルを作成して実験してみましたが、"" が入るという現象は再現できませんでした。 ファイル形式は、Accdb と MDB で試してみましたが、どちらもフォームを開いた直後は Null でした。 環境依存の問題なのかな。それとも、旧バージョンのファイルからアップデートしたらでるのだろうか。 ちなみにテストした環境は、 Windows8.1 64bit Access2010 32bit 複数の同じ症状と報告があるということは、 IsNullを、Nz([フィールド],"")="" に変更したほうがよさそうですね。
> ダブルクォーテーションのみ、Instr関数に入れられなくて > 弾けなかったので、課題として残ってしまいました。 コードのリテラル文字列内("で囲まれている部分)では、ダブルクォーテーションは、"" と重ねます。 If InStr(1, Me.strFullPath, """",vbBinaryCompare) > 0 Then
このフォームは連結フォーム（レコードソースにテーブルかクエリで設定してある）ですか。 もし非連結フォーム（（レコードソースが空白）なら、AllowEdits の設定は無意味です。 AllowEdits プロパティは連結フォームのみ有効ですので。 連結フォームなのに、AllowEdits = False が効かないという場合は、フォームが編集中ではないですか。 レコード保存してから、更新不可 ボタンをクリックしてください。 あるいは、強制的にレコード保存知るか。 Private Sub 更新不可_Click() If Me.Dirty Then Docmd.RunCommand acCmdSaveRecord Me.AllowEdits = False End Sub
＞select japanese from table2 where id = (select id from table1 where english = 'foo'); englishがユニークでない場合 select id from table1 where english = 'foo' で得たidは1つとは限りません。 上記で2つ以上のidが返ってきたときid=・・・は文法的にエラーになります。 どうしてもサブクエリでやりたいならinをつかうことになるでしょう (SQLiteに該当する文法があるなら) select japanese from table2 where id in (select id from table1 where english = 'foo'); #1さんのSQL文で問題ありませんが、 ロジック的には絞ったtable1からtable2の値を得たいので select japanese from table1 inner join table2 on table1.id = table2.id and english = 'foo'; の方が、より直観的かもしれませんね。 ちなみにMySQLでテストする限り適切なインデックスさえ貼ってあれば、 効率は変わらないみたいです。
戻り値かえしてないんじゃないかな その"関数名"に代入する形で、値を返します。 Function moji() 　'～処理～ 　moji = "結果"　'←戻り値 End function 一応、Subでも引数に代入することで値を返すことはできますが、Functionなら式に組み込めます。違いはそのくらい。
レポートをデザインビューで開き グループと並び替えをクリック。 「グループ化、並び替え、集計」の小窓で グループの追加から納期を選択しグループヘッダーとします。 またヘッダー内に納期コントロールも配置。 で、このヘッダーの改ページをカレントセクションの前に設定。 http://accessvba.blog.so-net.ne.jp/2011-12-15
エクセルの最新版は、古いバージョンで作成したエクセルファイルを 問題なく開くことができますので、今回開けなかったのは、 USBフラッシュメモリに保存したエクセルファイルが部分的に壊れてしまったためと思われます。 私も経験があるのですが、ファイルをダブルクリックすると、 エクセルが立ち上がるものの、グレーの画面のまま止まってしまう、 という状況ではありませんでしたか？ この場合、エクセルを開いて、ファイル→開く　とし、破損したエクセルファイルを選択、 右下の「開く(O)」の右にくっついている下向き黒三角「▼」をクリックし、 「開いて修復する」をクリックすると、罫線や色塗りなどの情報は失われるものの、 セルに入力した情報は拾い上げることができます。 最も確実なのは、USBフラッシュメモリの破損したデータを消去して、 あなたのPCから再度保存し直すことです。 元ファイルが破損していない限り、二度も続けて同じファイルが破損するとは考えられないので、 先方の2013で問題なく開けるようになるはずです。
【アドバイス】質問のテーマに関して再考を！ 今回のテーマは、 ・受注情報管理とは異なる工事発注伝票の仕様に関わる質疑応答。 さて、[工事発注伝票]は、これまでの受注情報管理の考えだけでは不十分です。 １、発生主義で情報を管理しなければならない。 ２．月単位での締切処理に対応しなければならない。 さて、そうなると[工事依頼伝票]と[工事依頼明細]の設計がこれまでと多少違ってきます。それは、[工事依頼明細].[行区分]の登場です。 [行区分]=0: 通常行 [行区分]=1: キャンセル行 [行区分]=9: 調節行 もう一つは、[工事依頼明細].[見積金額]。これは、伝票発行時点での[工事台帳明細].[単価]×[数量]のコピー。ここは、決して、リンクさせてはいけません。あくまでも、発生主義の原則を貫きます。 【工事依頼伝票】 ID 日時 依頼先_ID 摘要 【工事依頼明細】 ID 工事依頼伝票_ID 行番号 行区分 受注台帳_ID 工事台帳_ID 受注案件名 工事名 発注金額 見積金額 摘要 さて、こういう風に質問のテーマに関して考察していけば、[工事依頼明細].[受注台帳_ID]はコンボボックスで選択もありという状況が見えてくるかと思います。また、テーブル[受注台帳]に[工事依頼完了]（Yes/No）列があったら・・・。ということも。 と、
他の場所に、コード番号と商品名の一覧があるなら、VLOOKUP関数が使えます。 https://www.google.co.jp/search?q=VLOOKUP&ie=utf-8&oe=utf-8&hl=ja
Q、帳票フォームの行の順番を簡単に変えたいのですが、何か方法はありますでしょうか？ A、ソート。 http://hatenachips.blog34.fc2.com/blog-entry-58.html
２５５〔Ｂ〕×３７万＝９４〔ＭＢ〕 なので、実際に使っているデータ量が９４ＭＢありますので、圧縮はできません。 ここから、データの削除、挿入を繰り返すと、ブランクデータが増えて、 ファイルサイズはさらに増加します。ブランクデータは最適化によってなくす ことはできますが、それでも９４ＭＢに戻るだけです。 工夫としては、リンクデータのキーの見直し、（１）のＭＤＢにはキーだけを持ち、 データは（２）のＭＤＢに移行するなどの方法があります。 根本的な解決としては、Ｏｒａｃｌｅ、ＳＱＬＳｅｒｖｅｒなどのデータベース ソフトを使うことです。
【お知らせ】 　　　　　　If M > 99 Then 　　　　　　　　MsgBox "読込む行総数を100行に下方修正しました。(DBSelect)", _ 　　　　　　　　　　　 vbInformation, _ 　　　　　　　　　　　 " お知らせ" 　　　　　　　　M = 99 　　　　　　End If DBSelect()に99行制限をかけていました。この６行はバッサリと消して下さい。500行や1000行では変数オーバーはしないので大丈夫です。
回答No.2です > 受注＝請求→ n:1　はあっても、1:n　は、NG > というのは、どんな業界でもそうなのでしょうか・・・ そんなことはありません。『請求は月締めで会社毎にまとめる。 さらに状況によって(分割納品だったりして)請求が一部 月またぎ することがある』というパターンに遭遇したこともあります。 これですと受注と請求は N:N ですね。 ここらへんは、販売管理システムの "あるある" なので、むしろ 仕様確認時にエンジニアからユーザに確認しておきたい事項です。 解決策はご紹介した書籍を見てほしいのですが、質問サイトで伝え られる程度のヒントだけご紹介します。 受注データの [受注] ＋ [受注明細] という構成になっていると思い ます。これに対して [請求] は、[受注] と直接の関係を持たせずに、 [請求]対象の [受注明細] をチョイスするという構造にします。 [請求]データの作成時に[受注明細]の内容を選べるようにするわけ ですね。 これのもっとも単純な構成はこうです。こうすると、受注と請求の 関係を 1:N にすることができます。 　　受注テーブル　　受注明細テーブル　　請求テーブル 　　受注ID　　　←　受注ID 　　　　　　　　　　受注明細ID 　　　　　　　　　　請求ID　　　　　→　請求ID ※[受注明細] テーブルの請求IDは、受注時はNULL。請求時に初めて 　値が入ります ※[受注] テーブルと [受注明細] テーブルは 1:N の関係、 　[受注明細] テーブルと [請求] テーブルは N:1 の関係になります。 　テーブル設計では直接の関係で N:N を作らないのが鉄則です。 もちろん、これは最も単純な形です。 実際には『請求は[受注]を選択して作りたい』などの要件によって、 テーブルに色々な付加情報が付いたり、場合によっては [受注明細] テーブルと [請求] テーブルの間に[引き当て]テーブルが必要にある こともあるでしょう。 また、内部データはこのように作っても、UI 的には請求時に明細を 毎回ひとつひとつ選択していたら大変です。『[受注]ごとまとめて 選択』とか『受注明細の検索機能』の充実が必要になるかと思います。
SingleおよびDoubleでは、小数計算において、誤差が生じる場合があります。 （参考：http://dobon.net/vb/dotnet/beginner/floatingpointerror.html ） 通貨型(Currency)を使うようにしてください。これなら上記の問題はありません。
細かいことですが「RecordsetClone」は「変数」ではなくて「プロパティ」です。 さて、本題ですが、 > 一つお聞きしたいのですが、RecordsetClone変数だと、フィールド更新後に使うと、値が古いものが取得されてしまい、うまく計算が出来ない時があります。 フィールドは更新したが、まだレコード保存していない状態だとそうなるかもしれません。 フィールドを更新して、それを参照して使用する場合は、事前にレコード保存してテーブルに格納しておくべきですね。 テーブルに格納せずに、エラーや操作ミスで終了してしまった場合、テーブルの値と参照使用した値に矛盾が生じてしまう可能性があります。 フィールドを更新した場合は、RecordsetClone でデータを参照する前に、 DoCmd.RunCommand acCmdSaveRecord でレコード保存しておくといいでしょう。。 Me.Recordset だと、レコードセットでの操作（レコード移動など）が直接フォームに影響を与えてしまうので、 処理が重くなるので避けるべきです。 他にもフォームのレコードセットを参照する方法として、RecordSet.Clone があります。 「フォームの Recordset, RecorsetClone, RecordSet.Clone の違い」はWEB検索すると詳しい解説が見つかると思います。
チェックボックスは連結コントロールで、「チェック」というフィールドと連結していると仮定して回答します。 条件付き書式を使います。 フォームのデザインビューで入力可/不可を設定したいテキストボックスを選択します。 リボンの「書式」タブ→[条件付き書式]→[新しいルール]で、書式設定で「式」を選択して、隣のボックスに [チェック]=False という式を入力します。 ボックスの下の右端の「有効化」のアイコンをクリックして選択状態にします。 以上で、チェックボックスにチェックを入れてあるレコードのみ編集可能になります。
入力画面（フォーム）とテーブル設計は別に考えるようにしましょう。 通常は、注文履歴のテーブルに、商品ID（外部キー）以外の商品データ（商品名や品番）は保存すべきではないです。 履歴入力画面からは、商品管理テーブルは参照だけで変更できないような設計にすれば問題ないので。 また、リレーションシップで「参照整合性」にチェックを入れておけば、履歴テーブルのデータと紐づいているレコードをマスターから削除しようとすると警告が出て削除できないようになります。 ただし、例外として、例えば「単価」が頻繁に変わるように場合は、単価を注文履歴の方にも格納するということはあります。 注文履歴入力画面（フォーム）での商品名や品番の参照は、コンボボックスを利用すると簡単にでき、また、入力しやすいものになります。 ■T'sWare Access Tips #360 ～コンボの２列目をテキストボックスに表示する方法（コントロールソース版）～ http://www.tsware.jp/tips/tips_360.htm
速度的にどうなるかはわかりませんが、積集合を使って みるとかどうでしょう。 SELECT head, body FROM dic WHERE body MATCH 'foo bar' INTERSECT SELECT head, body FROM dic WHERE head MATCH 'bar'
会社名だけならもっとシンプルに出せるかと思います。 SELECT [Table B].会社名 FROM [Table B] WHERE EXISTS ( SELECT 0 FROM [子Table] WHERE [子Table].ID3 = [Table B].ID3 AND [子Table].ID1 = 1 );
いま手もとにアクセスがないので自分で確かめてみることができないのですが、↓これはヒントになりませんか？ http://www.ilovex.co.jp/blog/system/access/accessaccess2010.html http://ivystar.jp/ms-office/access/if-the-cause-of-the-calendar-does-not-appear-in-the-text-box-in-access/
cがsqlite3.Cursorだとして。 c.execute("SELECT * FROM stocks") に成功した後で、c.descriptionを調べることでわかります。 http://docs.python.jp/2/library/sqlite3.html#sqlite3.Cursor.description r=c.fetchione() 等としたときの r は sqlite3.Row のオブジェクトになります。 http://docs.python.jp/2/library/sqlite3.html#row Rowにはkeysメソッドがあります http://docs.python.jp/2/library/sqlite3.html#sqlite3.Row.keys もし、簡単な参考書とかしか読んでいないのなら、公式マニュアルも読むことをお勧めします。 > 最初のRecord Setが(date,qty) = ("2014/12/1", 5)の場合 この例は「登録内容を得た後」だと思うのですが。 前と後、どちらなのでしょうか?
たぶんソートを実行するスクリプトが組んであると思います。 自身で作成されたものであれば、スクリプトを調べてみてください。 もしくは、そのレイアウトに移動する時にスクリプトトリガで 設定されているのかもしれません。 他者が作成したものであれば、作成者に聞いてみてください。
「SubForm」のフィールドのどれかのフィールドの ダブルクリックなどで、 　msgbox me.parent.name などとすれば、メッセージボックスでは 「FormA」が表示されますが、これは あくまでも「SubForm」でのイベントなので 当然ながらコードは「SubForm」に書き込みます。 同様にして、 ＞サブフォームのイベントで何かの処理をスル場合に、 ＞自分のフォームのフィールドの値を取得するのには の場合も、コードは「SubForm」に書き込みます。 たとえば、「SubForm」にボタンを設定して、 そのクリックイベントで、 msgbox Me.Controls("フィールド名").Value とすれば、現在「SubForm」でカレントになっている レコードの「フィールド名」の値が表示されます。
No.1です。 > Knoppix上での解決方法も教えて下さい puppy linux上の環境では、python 2.7.3でも前述のサンプルソースのコメントアウトだけで動作しました。つまりpythonではなく、インストールされているsqlite3のバージョンに依存するということになります。 通常ですと、sqlite3の最新版のソースをもってきてコンパイルし、インストールして、作成されたsqlite3.soを元のファイルと置き換えれば良いことになります。 ./configure --prefix=sqlite3のインストールされているディレクトリ make make install ただしKnoppixってCD-ROM(DVD-ROM)から起動しますよね？ いまご利用になっているsqlite3がCD-ROM(DVD-ROM)上に存在すると置き換えは難しいと思います。
Me.cmbo会社ID.RowSource = "会社ID1;依頼ID;会社ID2;会社ID3;会社名" Me.cmbo施工会社ID.RowSourceType = "テーブル/クエリ" "会社ID1;依頼ID;会社ID2;会社ID3;会社名" ↑ 少なくとも、これはテーブルでもクエリでもない。 次のサイトが参考になるかもです。 http://www.moug.net/tech/acvba/0060002.html
新宿区__3__2__5__15　←ここを出したい。 クロス集計クエリに関する質問だと仮定して・・・。 【クロス集計クエリ作成手順】 １、[クエリ].[新規作成]クリック。 ２、[クロス集計クエリ　ウィザード]クリック。 ３、テーブル選択し次へ。（コール履歴） ４、[市区町村]を選択し次へ。 ５、[電話結果]を選択し次へ。 ６、集計方法の”カウント”を選んで次へ。 ７、オプション[クエリのデザインを編集する]を指定して完了。 ８、SQLビューにて次の２箇所を修正。 TRANSFORM Count(コール履歴.XXX) AS XXXのカウント SELECT コール履歴.市区町村, Count(コール履歴.XXC) AS [合計 XXX] FROM コール履歴 GROUP BY コール履歴.市区町村 PIVOT コール履歴.電話結果; ↓ TRANSFORM Count(*) AS リストのカウント SELECT コール履歴.市区町村, Count(*) AS リスト合計 FROM コール履歴 GROUP BY コール履歴.市区町村 PIVOT コール履歴.電話結果; ↓ TRANSFORM Count(*) AS リストのカウント SELECT コール履歴.市区町村, Count(*) AS リスト合計 FROM コール履歴 GROUP BY コール履歴.市区町村 ORDER BY コール履歴.都道府県 PIVOT コール履歴.電話結果; 並びとか列名とかを編集で指示します。
SELECT t_エクセル貼り付け.地域, Format([フロントNG]/([後確NG]+[エントリー後NG]+[アンテナ後確NG]+[フロントNG]+[決裁者NG]+[アンテナNG]+[検討NG]+[対象回線済G]+[NG]),"0%") AS フロントNG率 FROM t_エクセル貼り付け; と、シンプルに書いてOKだったらNz()を付加。 と、面倒でも手順を追ったがいいですよ。
>エクセルだと思いつくのですが・・・ ほとんど一緒ですよ。 SELECT 地域名, Format((NZ([在宅])+NZ([OK])+NZ([NG])+NZ([改め]))/(NZ([在宅])+NZ([OK])+NZ([NG])+NZ([改め])+Nz([留守])),"0%") AS 在宅率 FROM コール履歴; 相違点１、SQL言語のSELECT文を使う事。【選択クエリ】 相違点２、NZ関数でNullを0に置換する措置が必要なこと。 Format文は一緒です。 後、通常は、列[ケイ]は設けずに、その都度に合計します。
回答No.1 です。 # そろそろリモートで状況を探り合いながら考えるのに限界を # 感じてきています。というか手元に今 Access がないのが # どうにもこうにも。 ○On error Resume Nextとエラー処理開始時点で書いて 　いるのに止まる 　⇒ VBA のエラートラップ設定によっては無視されたと思います ○Me.Recordset.Reqeueryとすると、フォームが非連結 　になると書いてあり 　⇒ Me.Recordset.Reqeuery のように Recordset を直接 　　 Reqeuery してはダメです。フォームと Recordset が 　　 切れちゃいますので。が、今回元々実行していたのは 　　 フォームの Me.Reqeuery の実行で、こちらは大丈夫 　　 だったと思うんですけどねぇ。 ○その場合、Me.Requeryではなく、上の 　Me.RecordSource = Me.RecordSourceとしています 　⇒ Requery に頼らずに、Recordset を自分で再作成して 　　 RecordSource に入れなおすのは対策案としてはアリ 　　 だと思いますが、それで上手くいくかどうかはフォーム 　　 の作りに依存するので私には何とも言えません。 そろそろ私のほうも時間切れです (平日は普通に働いており ますゆえ)。大変申し訳ございませんが、私はギブアップ扱い として頂けますでしょうか。 (今日中に何か天啓が閃いたら開陳します。その前に解決する ようでしたら、一言解決しましたと記載しておいてください…)
開示されたレコード定義が列名のみなのでなんとも。 制約はどうしていますか？ Null、空文字を受け入れるなら、 レコード追加できますが、値を代入していない列はNullでしょうね。
varRet に入れているURL文字列の末尾に &oe=shift_jis を追加してみてください。 それでもだめなら、参考URLの記事をみて他の値も試 してみましょう。
>※先に開いている人には読み取りは可能 >※後から開いた人は、データの編集が可能にする >※先に開いた人が、後から開いた人がデータの編集をしている時に該当レコードの変更は出来ないようにしたい ？？？ 開いた順は特に関係ないと思います。 先に編集し始めた人に権限を与えるなら、OpenRecordsetで適切に設定することで可能です http://msdn.microsoft.com/ja-jp/library/office/ff820966%28v=office.15%29.aspx
Q1 で、Table2との結合を外部結合にすれば、Table2に対応する部屋IDがなくても影響は受けません。 当然、Table2の部屋データは参照できません。 ただ、参照先のない外部キーを残しておくのは通常は意味がないと思います。 残しておきたいなら、マスター側のレコードは削除せずに、もう使用しないという意味のフィールドを持たせてそこにフラグを立てるという方法にすると思います。 例えば、社員マスターで、社員が退職しても削除せずに、退職フラグを立てる、あるいは退職日を入力するというように。 おそらくアパート等の賃貸管理だと思いますが、その部屋を使用しなくなった日時と理由を格納するフィールドを用意して管理するのがいいと思います。、
> その場合には、更新されたかどうかを何らかの方法でフォームに持たせることは可能でしょうか？ 本テーブルと比較するか、ワークテーブルに更新チェック用のフィールドを持たせるかですね。 ただ、面倒だし、それほどパフォーマンスには影響しないと思いますので（逆に遅くなる可能性もあり）、上書きでいいとおもいます。
連結フォームなら、フィルターなどで対象の１レコードのみ抽出して「追加の許可」を「いいえ」にしておけば、レコード移動はしません。 あるいは、非連結フォームにしてもいいですね。 サブフォームのレコードソースがWorkテーブルと言うことは、本テーブルとは非連結ですので、親フォームも非連結フォームにすれば統一性があっていいかもしれませんね。 あるいは１レコードのみのWorkテーブルをレコードソースにするいうのもいいかも。
http://msdn.microsoft.com/ja-jp/library/b1e65aza.aspx > 有効桁数: 7 桁 です。 9999999.999999 を入れようとしたら、途中で打ち切って概数にする必要があります。 9999999.999999 を有効数字7桁にするには、 9999999 で .999999 を四捨五入するとかする必要があります。 四捨五入すれば 10000000 です。 これは 1.0 * 10の7乗 であり、これを「指数表現」という方式で表現したのが 「1E+07」 です。 対策ですが ・C#でfloatを使うのなら、あきらめるしかありません。 ・doubleを使うと、SQLiteのREALと同じ精度になります。
揚げ足とりの意図では無い旨、あらかじめお断りしたうえで。 > うまく行きません。 「どう」うまく行きませんか？ 「コピペしたので補足の記述が一字ー句違わない」なら、 [MyID]と[optSelect]の間はカンマではなく ! であるべき。 NzでNull対策すれば、iifの条件式そのものが結果として欲しい値。 iifもthenの値、elseの値、それらを区切るカンマもカッコも不要です。 画面の流れではフォームが３つになりましたが、必要？ 以下、AフォームのIDフィールドと内容が見える状態で進めて下さい。 > Aフォーム → 帳票型Bフォームで、レコードを選び「開く」ボタンを押す→ Bが子フォームですので、「レコードを選び」の段階で 親フォームであるAフォームのIDフィールドへ値が入りますか？ ３つのフォームなら、親・子・孫です。代入のイベントをどこに書いてますか？ 孫フォームでクリックしたoptSelectのIDが親フォームに届いてますか？ まずはこれを確認してみて下さい。 ＃タブレットの手書き入力なのでしんどい。 ＃夕食の支度したら戻って来ます。
当方の Access2013 で確認したところ、日付選択カレンダーがオンでも更新前イベントは発生します。 Office 365 でも同じだと思うのですが、違うのかな？ ただ、カレンダーで日付を選択した直後では発生しません。Enterキーを押す、別のコントロールへ移動するなどの更新確定操作をした後で発生します。 日付選択カレンダーがオフでもこの動作は同じです。キーボードで日付を変更してから、Enterキーを押す、別のコントロールへ移動するなどの操作が必要です。
とりあえず下記の手順を試してみてください。 1. 4つぐらいのテーブル間でリレーションを設定 2. その中の1つのテーブルから、フォームの自動作成 3. 出来たフォームのレコードソースの「・・・」ボタンをクリックして、1で設定した3つのテーブルを追加し、必要な項目を追加して、その設定内容を保存 　→最初のテーブルは「テーブル名.*」として一覧に追加、その他のテーブルは、必要な項目だけを追加 ここまで実行した後で、レコードソースのクエリデザインビューを閉じて、フォームのデザインビューに戻ります。 プロパティのレコードソース以外の項目をクリックしてフォーカスを移動させます。 ここで Ctrl + S を押してフォームを保存します。 4. 以降の手順を実行します。 以上でどうでしょうか。
＞各フォルダのデータを閲覧するためルートを作ってあげて目的のフォルダをひらけるようにしたいと ＞考えております。 私は、セルにHYPERLINKリンク関数を使って、ファイルやフォルダーを開いています。 URLやエクセル以外のファイルもクリック一つで開くことが出来ます。
建物NOを文字列化して、数字以外で、かつ、部屋番号に使わない文字（例えばアンダーバー）を間に挟んで、部屋番号と連結して、文字列を生成する。 例： 建物NO：125、部屋番号：A301⇒125_A301 建物NO：128、部屋番号：202⇒128_202 建物NO：1282、部屋番号：02⇒1282_02 建物NO：211、部屋番号：103⇒211_103 建物NO：21、部屋番号：1103⇒21_1103
すみません。 「ABC から、 AB を探す」 のルールがはっきりしません。 この1例だけ聞くと 「AB をヒットさせたいなら、 ABCから一文字削って AB にして、検索すればいい」 ってなります。でも、そうでは無いですね? 例えば。 キーに AB,ABC があったら、 ・ AB, ABC 両方にヒット ・ AB だけヒット ・ ABC だけヒット のどれなのでしょうか?その理由は? キーに AB,ABD があったら、 ・ AB, ABD 両方にヒット ・ AB だけヒット ・ ABD だけヒット のどれなのでしょうか?その理由は? キーに ABC,ABD があったら、 ・ ABC, ABD 両方にヒット ・ ABC だけヒット ・ ABD だけヒット のどれなのでしょうか?その理由は? キーに ABD,ABE があったら、 ・ ABD, ABE 両方にヒット ・ ABD だけヒット ・ ABE だけヒット ・どちらもヒットしない のどれなのでしょうか?その理由は? .... 等々。この「その理由」を整理して「一般的なルール」にすれば、他の方法も考えやすくなるでしょう。 > row数が0以上の一番小さい数のデータを取得 というのは R1 = 「select * from テーブル where キー like 'A%';」で抽出される件数 R2 = 「select * from テーブル where キー like 'AB%';」で抽出される件数 R3 = 「select * from テーブル where キー like 'ABC%';」で抽出される件数 の、0でない Rx が最小となる条件を選択する という意味でよろしいでしょうか? それだと R1≧R2≧R3 なのがあきらかなので select * from テーブル where キー like 'ABC%'; → ヒットしたら採用して終了 select * from テーブル where キー like 'AB%'; → ヒットしたら採用して終了 select * from テーブル where キー like 'A%'; → ヒットしたら採用、ヒットしなければ0件 と、少ない方から実行すれば、全部実行する必要が無い場合があります。 ・先頭から一文字ずつ比較し、連続で一致する文字数を求める ・上記の「一致数」の最も多いものを抽出する というのがルールなら「先頭から一文字ずつ比較し、連続で一致する文字数を求める」関数を作って、MAXの行を抽出する、という方法があります。
http://okwave.jp/qa/q8847812.html の方に回答を書いたので、そちらを参照して下さい。
こんばんは！ Sheet2のA1セルに =IF(Sheet1!A1="","",Sheet1!A1) という数式を入れておけば大丈夫だと思いますが・・・ どうしてもVBAで！というコトであれば ↓のコードをSheet1のシートモジュールにしてSheet1のA1セルにデータを入れてみてください。 Private Sub Worksheet_Change(ByVal Target As Range) If Target.Address = "$A$1" Then Worksheets("Sheet2").Range("A1") = Target End If End Sub ※　汎用性から考ると、数式で処理できるのであればそれの方が簡単だと思います。 （1）VBAの場合、範囲等こちらで設定してやる必要がある。 （2）本来は考えられるエラー等も対処しておく必要がある。 などなど・・・ ※　上記コードはA1セル限定です。m(_ _)m
添付図を忘れていました。
＞何しろ、ITの担当が私だけですので。1人で全部作っていますから。 私も、設計からプログラミング、導入時のレクチャーを一人で担当してきました。各種伝票のレイアウトに印刷発注、事務所と工場のレイアウトの設計、原価計算の仕組みから売上計算システムの改変。超片田舎なもんで地元のソフトハウスにも、この手の開発経験者はゼロ。まあ、でも、一人でもできました。質問者もできますよ。 Q、(1)(2)については、どのような設計をされていましたでしょうか？ A、生データの編集とインポートを行うプログラムで対応。 出力部門によって生データのどれとどれが必要なのかは大きく違ってきます。ですから、各担当部署は、生データ蓄積データベースから適当な時間を見計らって必要なデータを利用しやすい形に加工しつつインポート。加えて、独自に入力すべきデータの入力処理を行った後に、必要な演算と出力を行ってきたと記憶しています。なお、生データ蓄積PCと各部門PCとは、サーバーで共有すべきデータについても吐き出していたんじゃーないかと・・・。 ＞バッチのようなものを作り、それを深夜実行する。 これは、MS-DOS時代のやり方。今の時代、どんなに大量のデータであっても数十秒で加工しつつインポートすることができると思いますよ。 PS、できれば的を絞って再質問されて本当のプロからのアドバイスを！
その連番フィールドを レコードメニューのフィールド内容の全置換でシリアル番号で全置換する とか 計算フィールドにして、式をGet(レコード番号)にして索引を非保存にする とかで。
過去に、奇しくも「同タイトルの質問」がありました。 「テキストデータをSQLServerに取込むには」2002/07/11 http://oshiete.goo.ne.jp/qa/306391.html 小生、「教えて！goo」からの参加なので、 ＵＲＬの違いが気になる（不安）なら ご自身が参加されてるＵＲＬで「質問番号」だけ打ち替えて下さい。
> また、テーブルと画面とで分割しようと考えています。 というのが、どのようなことを想定しているのか、理解できません。 もう少し具体的に説明してもらえますか。 とりあえず、これは無視して、 > ・連結フォームの場合でネットワークで複数ユーザ（二人～三人ほど）が使用する。 > ・非連結フォームの場合で、ネットワークで複数ユーザ（二人～三人ほど）が使用する。 複数ユーザーが同時接続するなら、採番管理用のテーブルを利用したほうがいいでしょう。 採番管理テーブルには現在の主キーの最大値を格納しておきます。 新規追加するときに、採番管理テーブルを排他ロックをかけて開き、取得した値に+1して、その値を入力テーブルの主キーに設定して、採番管理テーブルの値も更新します。 もし、採番管理テーブルを開こうとしてロックがかかっていた場合は、しばらく待って、再試行をするというようにします。 非連結テーブルの場合は、上記の処理を保存コマンドボタンに設定します。 連結フォームなら、フォームの更新前処理で、NewRecord のときに実行します。
accessなら以下参考にしてください http://oshiete.goo.ne.jp/qa/3239942.html
＞テキストボックスのrecordソースがその式であれば、 ＞式が判断した値が自動で表示されるのが当たり前のような気がしますが・・・ 私もそのように思いますよ。実際に、（リレーショナルの有無に関わらず）普通はそうです。なぜ、そうならないのか？そこが不思議だということです。
＃７です 修正量がそう多くなかったので回答してみます。 修正点 ・ハイパーリンクしない ・出来上がるシート名は「1R」「2R」・・・「xR」 ・抽出内容が無くてもシートは初期化する ・騎手名は C1 から始まり、終了は空白が２行続いたら 　（24 に限定せず、書かれていた分を処理する） Public Sub Samp2() 　　Dim cn As Object, rs As Object 　　Dim sSql As String, sS As String 　　Dim v As Variant 　　Dim iRow As Long, iRowN As Long, iR As Long 　　Dim i As Integer 　　Const adStateOpen = 1 　　Const PN2007 As String = "Microsoft.ACE.OLEDB.12.0" 　　Const PN2003 As String = "Microsoft.Jet.OLEDB.4.0" 　　Const CMDB As String = "\2014.mdb" 　　Const CSQL = "SELECT * FROM 2014 WHERE 騎手名 IN ('{%1}');" 　　On Error Resume Next 　　Set cn = CreateObject("ADODB.Connection") 　　For Each v In Array(PN2007, PN2003) 　　　　cn.Open "Provider=" & v _ 　　　　　　& ";Data Source=" & ThisWorkbook.Path & CMDB 　　　　If (cn.State = adStateOpen) Then Exit For 　　Next 　　If (IsEmpty(v)) Then 　　　　MsgBox "環境不足で処理中断", vbCritical 　　　　Set cn = Nothing 　　　　Exit Sub 　　End If 　　On Error GoTo 0 　　Application.ScreenUpdating = False 　　With Worksheets("SheetDB") 　　　　iR = 1 　　　　iRow = 1 　　　　While (.Cells(iRow, "C") <> "") 　　　　　　iRowN = iRow 　　　　　　With .Cells(iRow, "C") 　　　　　　　　If (.Offset(1) <> "") Then iRowN = .End(xlDown).Row 　　　　　　　　v = WorksheetFunction.Transpose(.Resize(iRowN - iRow + 1)) 　　　　　　End With 　　　　　　If (IsArray(v)) Then 　　　　　　　　sSql = Replace(CSQL, "{%1}", Join(v, "','")) 　　　　　　Else 　　　　　　　　sSql = Replace(CSQL, "{%1}", v) 　　　　　　End If 　　　　　　sS = iR & "R" 　　　　　　For Each v In Worksheets 　　　　　　　　If (v.Name = sS) Then Exit For 　　　　　　Next 　　　　　　If (IsEmpty(v)) Then 　　　　　　　　With Worksheets.Add(After:=Worksheets(Worksheets.Count)) 　　　　　　　　　　.Name = sS 　　　　　　　　End With 　　　　　　Else 　　　　　　　　v.Activate 　　　　　　　　Cells.ClearContents 　　　　　　End If 　　　　　　Set rs = cn.Execute(sSql) 　　　　　　If (Not rs.EOF) Then 　　　　　　　　With Range("A1") 　　　　　　　　　　For i = 0 To rs.Fields.Count - 1 　　　　　　　　　　　　.Offset(, i) = rs(i).Name 　　　　　　　　　　Next 　　　　　　　　　　.Offset(1).CopyFromRecordset rs 　　　　　　　　End With 　　　　　　End If 　　　　　　rs.Close 　　　　　　Set rs = Nothing 　　　　　　iRow = iRowN + 2 　　　　　　iR = iR + 1 　　　　Wend 　　　　.Activate 　　End With 　　cn.Close 　　Set cn = Nothing 　　Application.ScreenUpdating = True End Sub
ExcelからAccessのテーブルを更新するということならば 以下のような感じですか。Accessで更新クエリを作ってみれば わかりますが。 Sub test() Dim cn As New ADODB.Connection Dim cmd As New ADODB.Command Dim strSQL As String Dim strPath As String strSQL = "UPDATE Childrenテーブル INNER JOIN Parentsテーブル " & _ "ON Childrenテーブル.ParentID = Parentsテーブル.ID SET Childrenテーブル.Flag = 1 " & _ "WHERE ([Parentsテーブル]![HasChild])=True AND ([Parentsテーブル]![AGE])=20 AND ([Childrenテーブル]![Male])=True" strPath = ThisWorkbook.Path & "\sample.mdb" cn.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & strPath Set cmd.ActiveConnection = cn With cmd 　　　　.CommandText = strSQL 　　　　.CommandType = adCmdText 　　　　.Prepared = True End With cmd.Execute Set cmd = Nothing cn.Close: Set cn = Nothing End Sub なお、SQL文の中身は UPDATE Childrenテーブル INNER JOIN Parentsテーブル ON Childrenテーブル.ParentID = Parentsテーブル.ID SET Childrenテーブル.Flag = 1 WHERE ([Parentsテーブル]![HasChild])=True AND ([Parentsテーブル]![AGE])=20 AND ([Childrenテーブル]![Male])=True; ですので、コード表が乱れていたら訂正してください。
　ＳＱＬインジェクションの発生原因から考えれば、この対策が何をしようとしているのか見えてくると思います。 　ちょっと復習しておきましょう。 　例えば、すっごく安直ですが・・・ 　ｓｅｌｅｃｔ　name, age　ｆｒｏｍ　ｔｂｌａ　ｗｈｅｒｅ　ａｇｅ＞＊＊＊＊ 　というＳＱＬを発行する手続きがあったとします。 　＊＊＊＊の部分には、フォームの入力が来ます。つまり、ページの閲覧者が指定した年齢以上の人の一覧表を出そうとしているわけですね。 　さて、なんにも考えずに、普通に作ってみましょう。 　フォームからの入力は、変数 　string Form_age 　に入っているとします。 　string sql = "select name, age from tbla where age>" + Form_age; 　execute_sql(sql); 　なんてやったら、どうなるか。普通の入力が入ってくれば、何にも不都合はありません。正常にちゃんと機能します。 　問題は、悪意のある人がコレを使ったらどうなるかです。 　悪意のある人は、フォームにこんな入力をします。 　23;delete from daijinatable; 　さて、これが、Form_ageに入っている中で、先の文を実行すると、 　select name,age from tbla where age>23;delete from daijinatable; 　を実行することになります。 　ＳＱＬでは、;で文を区切ることにより、複数のＳＱＬを一度に実行することが出来る場合が多いです。 　つまり、先の文だと、select と　deleteの二つの文を一気に実行します。 　その後の結果表示は、deleteのせいでデタラメになるでしょうし、多分、プログラム側がエラーとなるでしょう。でも、悪意のある人にはそんなことはどうでもよいのです。彼が実行したかったのは、delete from daijinatableの方です。これは、ちゃんと無事に実行されます。その結果、あなたは、何日か後に、大事なテーブルのデータがいつの間にか消滅していることに気がつき悲鳴を上げることになります。 　 　これが、ＳＱＬインジェクションの基本です。 　何が原因でこんなことになったのか？form_ageの中には必ず数字を表す文字列が入っていると固く信じて、そのままＳＱＬ文の一部分にしたのが最大の原因です。 　 　根本的に、この問題を解決するためには、from_ageの中身をちゃんとまず検査することです。今回の場合であれば、form_ageの中に数字が入っていることを確認し、数字で無ければ、エラーページを出すということをちゃんとやっていれば良いわけです。 　このように、中身が数字とか、ある一定の規則に従った文字列・・・なら検査も簡単です。でも、これが、ワード検索の単語とかだと、何が入ってくるかは様々ですから、検査も大変です。 　代案を考えてみましょう。 　間違った文字が入っていることそのものは、システムやプログラムに対しては無害です。問題になるのは、ＳＱＬ文にとって特別な意味を持っている一部の文字に対しての扱いです。文字列はちゃんと"か'で囲う。文字列中の"や'は、ちゃんとエスケープする。;等の文末文字が文字列の外に出ないようにする・・・等等等等の構文的な解釈を全部ちゃんと自分でチェックして、所用のエスケープ処理をしてから、ＳＱＬ文の一部に結合すれば、システム的には問題なくなります。 　でも、これ、自分では書かないでください。間違いなく抜けが出ます。 　このようなことは、システムに任せましょう。システムにも時としてバグがありますが、まぁ、少なくともあなたが書くよりは抜けは少ないです。 　これをシステムに任せるために使うのがプリペアードＳＱＬです。 　先の例だと、 　string sql = "select name,age from tbl1 where age > %age" 　のようにしておいて、システム関数で、%ageに対して、値を代入して、ＳＱＬを実行します。このとき、ＤＢＭＳは、%ageに入ってる文字列は、いかなる場合でもageとの比較にしか使わない事を保証します。実装としては、%ageへの代入の際に徹底したエスケープ処理をしているかもしれませんし、もっと本質的に、ＤＢＭＳ側で、%ageの管理を別途行い、比較処理をしているかもしれません。それはシステムにより異なります。 　ちなみに、プリペアードＳＱＬを使ったから、フォームに入力された値のチェックはやらなくていいよねとはしない方が良いです。外部からの入力に関しては、自分で簡単にできるチェックはちゃんと自分でやるのが基本です。自分でやれば、フォーム欄の意味に沿ったエラーページを出すことも出来ますし、ユーザーフレンドリーです。 　その上で、プリペアードＳＱＬのようなシステム側の機能「も」利用する。そうすることにより、よりいっそう強固なシステムと出来ます。
Q1、売上が確定するとは、入金された時ということでしょうか？ A1、それは、私ではなく会社に聞くべき事柄。 私は、一般論として発生主義としか言えません。 Q2、どこで、どうやって帳尻を合わせたらいいのでしょうか？ A2、それも、私ではなく会社に聞くべき事柄。 私は、帳尻を合わせる必要はさらさらないと思いますよ。 そのための、見積り金額からの自由の確保ですから・・・。
昨今のAccessで実現できるかどうかですが・・・。VBAでバックアップシステムを書けば・・・。例えば、私が作成した汎用問合せフォーム「Perfoem」ですが・・・。 １、クライアント側からSQLが実行できます。 ２、クライアント側からOSQLも実行できます。 performでは列名（Field Nmae）も取得しています。つまり、動的にバックアップSQL文を走らせることも可ということ。ですから・・・ ＞それぞれテーブル作成クエリでローカルにテーブルを作成しております。 これをプログラムするとよいと思います。
実行しているファイルの参照設定がどうなっているのか 明記されていないので、憶測でしか言えませんが。 エラーが生じるコードの変数宣言で、 Dim ClsDao As ClsDao とありますが、これはクラスモジュールで何かDAOを 定義している、ということでしょうか。そうすると ファイルの参照設定で、DAOはチェックされていない、 あるいはチェックされていてもDAOがADOの上位に 表示されていない、ということなのでしょうかね。 ということであれば一度、参照設定でDAOにチェックを 入れ、 ＞Dim Rec As Recordset を、 Dim Rec As DAO.Recordset としてみてはどうですか？ ところで、もしクラスモジュールでDAOを定義しているならば その理由は？
標準では、PDFファイルはスタート画面の「リーダー」に関連付けされているので、PDFファイルをダブルクリックすると「リーダー」が起動して見れるはずですが… 「リーダー」の使い勝手が悪ければ、Adobe ReaderなどのPDF閲覧ソフトなどをインストールすれば良いかと
＞どうも、大文字と小文字の差の様ですが case-sensitive=OFFの時、sqliteはLIKE演算に対してインデックスを使わないとのことです
"bcc" & vbTab & "abc@xx.com" & vbTab & "def@xx.jp" & vbTab & "ｇhi@xx.com" ↑テキストボックスに入れた『vbTab』がタブコードとして 認識されていないから。ダブルクォーテーションも必要ありません。 >・・・ >の所を、 >Mailto ="bcc" & vbTab & "abc・・・ にすれば送信できるのですから msgbox mailto とか イミディエイトウィンドウで確認すると bcc□abc@・・・になってるハズです。 （Tabコードは見えないので□で代りに表しました） テキストボックス中でタブキーを押すと次に飛んで行ってしまうので bcc abc@xx.com def@xx.jp ｇhi@xx.com と半角スペース区切りで入れておいて Mailto = replace(Me!bcc," ",vbtab) とか Mailto = replace(Me!bcc,chr(32),chr(9)) では？
>とりあえず最初の容量等をしれればと思いました。 「微々たるもの」じゃ回答になっていませんか？ ＞PostgreSQLに関してはどこに載っているか探しましたがわからず・・・。 たとえば例示したリンクからダウンロードリンクをたどれば 各OSの各バージョンがリンクされていますよね？ たとえばWin版だとアーカイブファイルで50Mそこそこですから インストールしても2～300Mでしょう もしそのくらいの容量が気になるPCなら、データの保存ができないので DBでデータ管理するのはあきらめた方がよいです。
Windows8とAccess(Word、Excelをふくむ)は別物です。 Windows8を買えばもれなくついてくる、というわけではないのです。 これらは別途購入すべきもの。 いまなら次の手段があります。 A)パソコンにはWord、Excelが入っている・・・Access 2013 単品を買う。 http://kakaku.com/pc/office-soft/itemlist.aspx?pdf_ma=121&pdf_se=6 B)パソコンには何も入っていない・・・Office2013 Professionalを買う。 http://kakaku.com/item/K0000447473/?lid=ksearch_kakakuitem_image どちらか、ご自身のニーズに合ったほうをご利用ください。
並べ替えあるいはピボットテーブルを使ってみてください。
ハイパーリンク型はAccessのヘルプに 『ハイパーリンク (ハイパーリンク型: ハイパーリンク アドレスを格納する Access データベース フィールドのデータ型。アドレスは最大 4 つの部分から成り、次の形式に従って記述されます。displaytext#address#subaddress#)型の 4 つの部分には、それぞれ 2048 文字まで指定できます』 とあるので内部的にはメモ型と考えてよいかと。
#1 の回答は番号フィールドにNull がある複数のレコードが存在する場合の サンプルです。 ※最後に採番テーブルの番号の値を変更するのが抜けてました。 rs.close:set rs =nothing の前に currentdb.execute("update 採番テーブル set 番号 =" & maxnum) を追加してください。 １レコードずつ手入力で行っている場合はまた別の話になります。 フォームのレコード移動時イベントに if me.newrecord then me!フォームの番号コントロール名 = Nz(DMax("番号", "採番テーブル"), 0) +1 ・・・とかになりますが 採番テーブルの方の番号を更新するタイミングは更新前処理に行えば 良いでしょう。 が、もしかしてマルチユーザー環境で・・・と考えているのなら 全部忘れてください。ハードルがぐっと上がりますので確かな回答は出来ません。 こちらが参考になるかと思いますけど。。。 [VB] DAO でユーザー定義カウンターを実装する方法 http://support2.microsoft.com/default.aspx?scid=kb;ja;191253 私からは以上です。
　Microsoft　は、オートナンバーの主キーの型を長整数（Long型）にしています。その理由は、整数（Intege型）についで処理速度が速いからです。キーの命は、なんと言っても処理速度。とは言っても、社員テーブルなんかは整数（Intege型）で十分間に合う訳です。でも、私は、そのように細かく使い分ける時代は終わったと思っています。なんでもかんでも主キーは長整数（Long型）で押し通しても問題ないかと思います。ただ、DECIMAL型を用いる意義はほとんどないと思いますよ。
セキュリティセンターで信頼できる場所を設定してそこにファイルを置いても駄目ですか? http://www.mkkobo.com/SecuritySet/SecuritySet2013.htm
> strfilter = strfilter & " AND ステータス = 1" OR "ステータス = 3" を 　　strfilter = strfilter & " AND (ステータス = 1" OR "ステータス = 3)" にしてください。
昔は1年位勉強してからじゃないとコンピューターには触らせてもらえなかったものです。今はPCがあるからいきなり機能の操作だけを覚えてしまい基本がおろそかという人が多い。弊害ですね。 業務系のシステムはもちろんそれだけで一つの企業が食っていけるほど専門分野です。簡単だとは思わないことだということを前提に順番を追って勉強してみてください。 データーベースにはDBAといった業務に合わせてDBをチューニング出来るプロや、テーブル設計をするSE、業務を洗い出すビジネス要件を定位するオーナーSE、DBに対してどのような安全策を取るか決めるバックアップ管理者などいろいろな仕事に分担されます。 つまり本来覚えることは山ほどあると言うことです。いい加減に始めると結局はデーターが入ったDBの修正というのは作るより大幅に大変なので、無駄になります。つまり田舎に道を作るのは簡単だけど、都会に新しい道を作るのは不可能に近いと言うことですね。 テーブル設計というのは簡単に思えますけど、実はDBのソフトの特徴や概念を知らないと出来ないものなのです。オラクルとSQLサーバーでも違うものなのです。MySQLのようなパラメーターが少ないものならそれなりに考えも必要です。業務を見てどのソフトが最適なのかから始めるべきなのです。 その上でテーブルを決めていきますが、どういう業務でどこに一番負荷がかかるか、格納する情報は何が多いのか、頻繁に更新するものと参照だけのもの。それぞれで変わって来ます。業務ありきだと思って下さい。 場合によってはRDBじゃないほうが良い場合もあります。XMLDBのようなものも最近では普通に使います。 ようするに奥は深すぎて今のプロでも知らずにやっている人も多いです。 まあ本はいくらでもありますし、資格も多いです。 http://www.amazon.co.jp/%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E8%A8%AD%E8%A8%88%E3%81%AE%E8%AC%8E%E3%82%92%E8%A7%A3%E3%81%8F-%E5%BC%B7%E3%81%84SE%E3%81%AB%E3%81%AA%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E3%80%81%E6%A9%9F%E8%83%BD%E8%A8%AD%E8%A8%88-%E5%85%A5%E5%87%BA%E5%8A%9B%E8%A8%AD%E8%A8%88%E3%81%AE%E6%A5%B5%E6%84%8F-%E9%AB%98%E5%AE%89-%E5%8E%9A%E6%80%9D/dp/product-description/4797358181/ref=dp_proddesc_0?ie=UTF8&n=465392&s=books
この問題を根本的に解決するには 参照設定から外して実行時バインディングしかありません。 これならエラートラップできます。 マルチポスト・質問をほったらかし・・・ http://stakasaki.at.webry.info/200512/article_3.html 回答者から相手にされなくなりますよ。マナーは大事。 （貴方だけじゃないんですけどね・・・。）
>CurrentDb.Updatable　って何をしようとして... よく知らないですけど、、、 アクセスの環境変数みたいなものとして持っているものを返しているんじゃないかな？ ざっくばらんに言うと、どういう形でDBを開いたかをどこかで覚えておくためのものだと思います。 （ldb内に格納されているんじゃないかな）。 多分、参照だけなので、他には何の影響もないと思いますが、まあ、納品物なら 動作検証等はやっておいたほうがよいのかもしれませんね。
ブックマークが参照できません・・の時点で エラー処理出来たら良かったんでしょうけど、 いまさら言っても始まらないですね・・・。 以下は推測にすぎませんが ファイルをパスワード保護しているか、 「レコードレベルでロックして開く」のチェックが外れている場合に ページレベルのロックになります。 http://office.microsoft.com/ja-jp/access-help/HP005240860.aspx （2010でも同様です） で、Accessのキャッシュか遅延書き込みの際に 何かしらの問題があってカレントレコードだけではなく ページ（４Kバイト）単位でおかしくなったのでは？ Accessの場合1日１回のバックアップでは安心できません。 モノによってですが、タスクスケジューラで 出社時・昼食時・定時退社時間時 の１日３回×三日分の世代バックアップを取っています。 （安定動作するようになってからはお世話になっていませんが大事な保険）
【補足の補足】 色々とテストした結果、列[年月]がテキスト型の場合には、In句が自動生成されませんね。日付型ですと、自動生成されるのですが・・・。 PIVOT [年月日] In ("2014年01月","2014年02月","2014年03月","2014年04月","2014年05月"); そして、テキスト型に限っては、このような書き方でも「型の不一致エラー」はでないようです。 In句を自動生成させるのか否か？ ちょっと、検討事項かもしれませんね。
【補足】売上入力と工事台帳との関係。 これは、補足するまでもないこと。あらゆるソフトが、そのようになっていることですが・・・。 ＜工事台帳入力⇒売上伝票入力が主な流れとは限らない＞ 既製品を繰り返し販売しない場合、売上入力時に工事台帳に追加するフォームをオープンすることがほとんどでしょう。そうして、そのフォームを閉じる時に、売上入力フォームに各種データをコピー。もちろん、リンクさせてはダメですよ。 なお、当然に、新規顧客の場合も、売上伝票から顧客登録フォームを開きます。 PS、顧客台帳には、有効・無効フラッグを指示できる列があるといいでしょう。それで、各種集計を高速化できるでしょう。
単純にテーブル[会社]のみでフォームを作成し、社員表示用テキストボックスを追加。そして、そのプロパティを表示し コントロールソース=DBLookup("SELECT 社員名 FROM 社員 WHERE 会社ID=" & [会社ID] & " ORDER BY ソート番号") これは、以下の標準モジュールに登録したユーザ関数 DBLookup()を使っています。これで、クエリを用意しなくても目的を達成できます。 さて、かかるユーザ関数を標準ライブラリに登録したくない場合、 １、"社員ソートクエリ"を作成します。 SELECT 社員.会社ID, 社員.社員名 FROM 社員 ORDER BY 社員.ソート番号; ２、コントロールソースに次のように書きます。 =DLookUp("社員名","社員ソートクエリ","会社ID=" & [会社ID]) http://office.microsoft.com/ja-jp/access-help/HA001228825.aspx DLookup()については、マイクロソフトの解説を参照されてください。 【DLookup()の限界を破るにはVBAで同じ関数を作るしかない】 マイクロソフトの解説を読めば判りますが、ORDER BY 節を指定する引数が用意されていません。ですから、どうしても、"社員ソートクエリ"を作成するという手間が必要となります。そこで、SQL文を引数とするDBLookup()をVBAで書けば、その手間を省けるという算段になります。この辺りは、好みと趣味の問題。どっちでも良いと思います。そういうお断りをした上で DBLookup()を紹介しておきます。なお、ADOは、つぎのように参照設定しないと利用できません。 http://www.happy2-island.com/access/gogo03/capter00307.shtml Public Function DBLookup(ByVal strQuerySQL As String, _ 　　　　　　　　　　　　　Optional ByVal ReturnValue = Null) As Variant On Error GoTo Err_DBLookup 　　Dim DataValue 　　Dim rst　　　　 As ADODB.Recordset 　　Set rst = New ADODB.Recordset 　　With rst 　　　　.Open strQuerySQL, _ 　　　　　　　CurrentProject.Connection, _ 　　　　　　　adOpenStatic, _ 　　　　　　　adLockReadOnly 　　　　If Not .BOF Then 　　　　　　.MoveFirst 　　　　　　DataValue = .Fields(0) 　　　　End If 　　End With Exit_DBLookup: On Error Resume Next 　　rst.Close 　　Set rst = Nothing 　　DBLookup = IIf(Len(DataValue & ""), DataValue, ReturnValue) 　　Exit Function Err_DBLookup: 　　MsgBox "SELECT 文の実行時にエラーが発生しました。(DBLookup)" & Chr$(13) & Chr$(13) & _ 　　　　　 "・Err.Description=" & Err.Description & Chr$(13) & _ 　　　　　 "・SQL Text=" & strQuerySQL, _ 　　　　　 vbExclamation, " 関数エラーメッセージ" 　　Resume Exit_DBLookup End Function
オートメーションで操作する場合は http://allabout.co.jp/gm/gc/297724/ のように少なくとも構造は把握しておかないと。 以前の質問と重複するようですが復習の意味で読んでください。 Q8801507 も停滞中のようですし。 で、ユーザーさんがExcelを立ち上げていないのを確認後 Dim XL as object Dim BK as object Dim SH as object '未使用です set xl=getobject("D:\123.xls").application set bk=xl.workbooks.open("D:\123.xls") bk.sheets("sheet1").cells(1,1) =1234 bk.close savechanges:=true xl.quit set bk=nothing:set xl=nothing みたいな感じです。 処理の間はユーザーにはExcelを立ち上げることすら行ってほしくないので 注意喚起は必要だと思います。
ファイルメーカーのレイアウトですよね、用紙が100mmの148mm、 これが最大の用紙なら、上下、10ミリは、マージンを取らないと、上10ミリ、ヘッダー領域、 した10ミリ、フッダーになります。 その領域の中に、レコードやフィールドを設定するので、 もちろん、サイドも5ミリはマージンを取ってください。
私もほとんど分かりません。キッパリ！ 嘘をつくつもりは有りませんが・・・、それでも宜しければ。 WindowsXPの頃？にWMIサービスが登場しました。 管理ツールのサービスの中に、Windows Management Instrumentation てのがあります。 例の呪文はここへ問い合わせしています。 ちょうどデータベースに問い合わせするのに似ています。 Win32_Process がテーブルみたいなモノです。 で、私の場合は「*」が気になりますデータベースならフィールド名（カラム名）も指定できますよね。 そこで、Set cCol = oWMIsvc.ExecQuery("Select ・・・ の後で止めてローカルウィンドウを出して眺めて 適当に[+]をクリックして開いてみたりすると Properties_ を発見。 なんか色々入っているようだが45個もクリックして開くのは面倒くさい。 For ～ Each で取れるのでは？と思って調べたりしています。 色々と分かったので 前略 Set cCol = oWMIsvc.ExecQuery("Select Commandline From Win32_Process where name = 'excel.exe'") For Each cn In cCol Debug.Print cn.commandline Next End Sub とできます。 ここから始めてみてください。 WMI スクリプト入門 http://msdn.microsoft.com/ja-jp/library/ms974579.aspx https://gallery.technet.microsoft.com/scriptcenter/d15ede23-8fb4-4922-b49c-5bf8d865f900 ですが、説明中のVisualBasicの strComputer = "." は自PCを指定しています。 Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2") で 自PCへの問い合わせを行う準備をしています。 なら、strComputer = "隣のPC名" などと入れ込めばと思いますが ファイアウォールに色々小細工をしないと出来なくなってから諦めました。 で、余計なところをカットしたのがあの呪文です。 WMIを使えば非常に多くの情報を得ることができます。 http://www.wmifun.net/library/ ↑半年くらいは十分遊べると思います。 レスポンスは WMI よりも API を使用したほうが速いです。 ただ、色々とたいへん？なので WMI のお世話にもなっています。 #1 さんのリンク先の内容もこのさき必ず役に立ちます。 この辺でご勘弁願えますか？ あとはあなたが切り拓いていってください。 PS. API よりもとても安全ですが何回かPCを「応答なし」にしたことがあります。(^_^;) あれこれ試す際はバックアップを怠りなく。
csvがタブ切りなのですね。それならば一旦ファイルを変換して 変換したファイルをインポートするようになりますね。 手動でするか、VBAで、変換し、ファイルをインポートするかの 差はありますが。 ＞インポートするCSVファイルはユーザーにより見出し（フィールド）の ＞並びが異なる場合がある為、インポート定義を予め作っておくことが ＞できない状況です。 これに目がいってとんちんかんな回答しました。カンマ切りならば フィールドの順序が違っていても、 DoCmd.TransferText acImportDelim, , "temp", path, True でＯＫですね。 失礼しました。
VBAになりますが、フォームのコマンドボタンのクリック時イベントなどに On Error Resume Next DoCmd.OpenReport "レポートの名前", acViewPreview DoCmd.RunCommand acCmdPrint DoCmd.Close とすれば近いことは出来るかもです。 （実際に印刷まで行って検証した訳ではありません） 印刷プレビュー画面の上に設定画面が出ます。 但し、印刷設定画面を閉じない限り、プレビューに切り替えてみることは出来ませんでした。 On Error Resume Next は印刷設定画面でキャンセルした場合に 実行時エラー 2501 RunCommand アクションの実行は取り消されました。 のエラー表示を回避するために入れています。 印刷設定で何を変更したいのかにもよりますが Docmd.PrintOut メソッドについても調べると 吉 かもしれません。
＞AccessのSQLで算術型丸め処理をするにはどうしたらいいでしょうか。 0.5を足してINTで切り捨てして下さい。 INT(元の値+0.5) これで「2.5」が「3」になります。 小数点第二位で行う場合は INT(元の値*10+0.5)/10 のように、10倍して0.5を足してからINTで切り捨てして10で割って桁を戻します。 これで「0.25」が「0.3」になります。 ＞銀行型丸め処理と算術型丸め処理というらしいです。 算術型丸め処理（普通の四捨五入）では「値が増加する方が多くなる」ので、四捨五入した後に合計を取ると、合計が「大きめ」になってしまいます。 銀行型丸め処理には「偶数丸め」と「奇数丸め」の２つがあり、値が増加するのと値が減少するのが均等になるため、丸めした後に合計を取っても、合計が狂いにくくなります。 因みに、AccessのSQLのRound関数は「偶数丸め」なので「0.5→0、1.5→2、2.5→2、3.5→4…」となります。
=IIF(IsNull(Filed1),0,1)+IIF(IsNull(Filed2),0,1)+IIF(IsNull(Filed3),0,1)+・・・+IIF(IsNull(Filed14),0,1) みたいな式でどうでしょう？
＞その計算の元ネタとなる過去３ヶ月間の移動平均出荷数が求めたかったのです。 私の最終回答で、出荷数=0の月も含めて求められていると思いますよ。 7月---10 8月---10 9月---0 ----->(10+10+0)/3・・・(7月+8月+9月)/3 10月--10 ---->(10+0+10)/3・・・(8月+9月+10月)/3 11月--10 ---->(0+10+10)/3・・・(9月+10月+11月)/3 添付図では、このように計算しています。こういう計算結果を9月にも出力するには、9月にも出荷数=0の行も必要。その為に、ユニオンクエリで求めた出荷数=0を全ての月に加えています。 １、ユニオンクエリーで集荷数=0を全ての組み合わせを全ての月に追加してもDistinct句を使えば出力では重複することはありません。 ２、ユニオンクエリーで集荷数=0を全ての組み合わせを全ての月に追加しても、移動平均出荷数の計算結果は同じです。10+0=10ですから。 添付図の結果は、[会社コード], [品目コード], [月度],[集荷数]=0を追加した後に、次のSQL文を実行したもの。 SELECT DISTINCT [会社コード], [品目コード], [月度], Format(Rounds(DSum("出荷数", "出荷履歴", WHERE 会社コード='" & [会社コード] & "' AND 品目コード='" & [品目コード] & "' AND 月度 BETWEEN ' MoveMonth([月度],-3) & "' AND '" & [月度] & "'")/3,0,2),"0.00") AS 平均出荷数 FROM 出荷履歴 WHERE 月度 BETWEEN "201408" AND "201410" ORDER BY [会社コード], [品目コード], [月度]; 動かないとすれば、単なる転記ミスです。 １、DISTINCT句を使っていること。 　　これで、ダミー行を出力から追放することができます。 ２、表示する期間を指定していること。 　　表示する期間は、まあ、実際に運用する際に全期間の結果を求めないだろうと考えたからに過ぎません。 なお、MoveMonth([月度],-3) でBETWENNを簡略化、あるいはRounds()で四捨五入していること。これらは、枝葉の問題。 要は、[会社コード], [品目コード], [月度],[集荷数]=0を追加すればよいだけと思いますが・・・。
以下 ★ 部分を追加してみてどうなりますか Set MyRs = MyDB.OpenRecordset(MySQL) obj.Worksheets(シート名).Select For i = 0 To MyRs.Fields.Count - 1 ' ★ 　　obj.Application.Cells(22, i + 1) = MyRs(i).Name ' ★ Next ' ★ obj.Application.Cells(23, 1).CopyFormRecordset MyRs ※ これ動いていました？ CopyFormRecordset　のスペルは　CopyFromRecordset　なのでは？ （そのままにしておきますけど） GetObject した環境ですけど > obj.Worksheets(シート名).Select これ、オートメーションエラーになりませんでした？ （Vista+2007 の環境ですけど） エラーになっていなければそれはそれで・・・ obj.Worksheets(シート名).Activate はエラーなく動くようですが・・・ ※ obj.Application.Cells(23, 1) の部分は、 わざわざ obj.Application でトップに行かなくても？ Application.Cells 記述では、 アクティブブック・アクティブシートが隠れているだけで・・・ obj の正体はブックでしょうか？ （以下の様にトップに行かずに obj から辿った方が良さそうに思いますけど） Set MyRs = MyDB.OpenRecordset(MySQL) With obj.Worksheets(シート名) 　　.Activate 　　For i = 0 To MyRs.Fields.Count - 1 ' ★ 　　　　.Cells(22, i + 1) = MyRs(i).Name ' ★ 　　Next ' ★ 　　.Cells(23, 1).CopyFormRecordset MyRs End With
Access VBAよりExcelのシート名を取得 http://oshiete.goo.ne.jp/qa/8772873.html ここでの OpenSchema を使用したものは不評だったでしょうか というのは置いといて 関数を用意しました いろんなパターンでテストはしていないので・・・ （完成形ではないので不具合等は修正してください） GetExcelSheet に、Excelファイルのフルパスを与えると シート名の配列が Variant で得られます。 内部でエラーがあったら、最後のエラー番号を返します。 内部の動きとして、GetObject で対象の Excel ファイルを開きます。 GetObject で初めて開かれた場合、そのファイルの Visible は False False なら後始末としてそのファイルを閉じ、 結果 Excel で開いているファイルが無ければ、Excel を終了します。 つまり、既に開いていたものについては閉じる事はしません。 この関数の使い方は、後半の Samp1 を例としてください。 Public Function GetExcelSheet(sPath As String) As Variant 　　Dim oApp As Object, oBook As Object 　　Dim vA() As Variant, v As Variant 　　Dim i As Long 　　On Error Resume Next 　　i = 0 　　Set oBook = GetObject(sPath) 　　If (Not oBook Is Nothing) Then 　　　　For Each v In oBook.Worksheets 　　　　　　ReDim Preserve vA(i) 　　　　　　vA(i) = v.Name 　　　　　　i = i + 1 　　　　Next 　　　　Set oApp = oBook.Application 　　　　For Each v In oApp.Windows 　　　　　　If (v.Caption = oBook.Name) Then 　　　　　　　　If (Not v.Visible) Then 　　　　　　　　　　oBook.Close SaveChanges:=False 　　　　　　　　End If 　　　　　　　　Exit For 　　　　　　End If 　　　　Next 　　　　Set oBook = Nothing 　　　　If (oApp.Workbooks.Count = 0) Then oApp.Quit 　　　　Set oApp = Nothing 　　End If 　　GetExcelSheet = vA 　　If (Err <> 0) Then GetExcelSheet = Err.Number End Function Public Sub Samp1() 　　Dim v As Variant 　　Dim sS As String 　　Dim i As Long '　　v = GetExcelSheet(CurrentProject.Path & "\test.xlsm") 　　v = GetExcelSheet("C:\test\テスト.xlsx") 　　If (IsArray(v)) Then 　　　　sS = "> シート数 = " & UBound(v) + 1 & vbCrLf 　　　　For i = 0 To UBound(v) 　　　　　　sS = sS & v(i) & vbCrLf 　　　　Next 　　　　MsgBox sS 　　End If End Sub 余談） piroin654 さんのは >　　With appObj >　　　　For Each appObj In .Sheets 部分の、For Each 用の変数を変更すれば良いと思います。 また、Shell で起動しておくことは不要と思います。 （/Runtime オプション付きで起動した中での確認なので？）
イミディエイト・ウインドウでテストするのも一つの手です。 テスト要領は、添付図を参照されて下さい。
フォーム参照のパラメータクエリをVBAで扱う方法 http://www.tsware.jp/tips/tips_586.htm かな。
Q、レコード入力空欄回避のVBA。 A、その前に＜空欄の発生対処＞の見方・考え方。 １、「空欄があれば、次のレコードい移動できない」という縛りの是非。 　もしかしたら、その箇所の入力データが判読不能、あるいは不備があるかも知れない。そういう時、ユーザーは空欄のまま次のレコードのデータ入力を行うかも知れない。そうして、調査後に空欄を埋めるかも知れない。こういうケースはままあること。だとしたら＜縛り＞はユーザーにとっては邪魔でしかない。 ２、「空欄」の警告の是非。 　私が入力担当者であれば、一々の警告は御免被りたい。入力作業の邪魔でしかない。せめて、２．５秒程度の警告を表示して自動で閉じる＜PauseMsg()＞でも使用されているのであれば我慢できる。 ３、しかし、「空欄」のままのレコードをテーブルには残すべきではない。 　とは言っても、空欄を無原則に許可すると、後々の処理で不具合が発生する。そういう不具合の発生原因となるレコードの存在は許すべきではない。「空欄」の発生は許すが、不具合の原因となる「空欄」を含むレコードの入力は許さない。このことを実現するには、入力フォームを閉じる時に、 (1)「許可されていない空欄を含むレコード（OO件）を削除します。」と告知。 (2)そして、DoCmd.RunSQL "DELETE FROM XXX WHERE XXX で一斉削除。 というやり方があります。
＞請求先から複数の依頼案件にまたがって入金されたりすることもあるので、 ＞それをシステム設計で自動的に、 ＞顧客がどの依頼案件の支払なのかを作りこむことは出来ないのでしょうか？ もちろん出来るが、絶対に挑戦してはいけない！ ＞つまり、このようなカラムをテーブルに作れば、 ＞少なくとも請求と入金の日々の記録を付ける事は可能ということでしょうか？ 全く、違います。記録するのは、売上と入金のみです。ですから、用意するテーブルは、次のようです。 [得意先台帳] ID・・・・・・・・・1 名前・・・・・・・・鈴木建設 請求締め日・・・・・25日 前月期首繰越額・・・12,000円 前月売上額・・・・・30,000円 前月入金額・・・・・20,000円 前月調節額・・・・・-5,000円 当月期首繰越額・・・17,000円 当月売上額・・・・・20,000円 当月入金額・・・・・20,000円 当月調節額・・・・・-5,000円 得意先別に売上・入金状況を月次で締切・繰越処理した結果を反映する。 課題１、システム起動時得意先別期首設定アプリケーション。 課題２、月次締切・繰越処理アプリケーション。 課題３、先月繰越再処理アプリケーション。 課題４、月次締切レポート。 このように月次締切・繰越処理はバックエンドであるテーブルのテーマではなくフロントエンドであるアプリケーションの役割です。なお、ここに言う締切・繰越処理＝請求締切処理ではありません。売上・入金の月次締切処理と請求書管理とは少し目的と内容が違います。 [得意先別売上台帳] ID・・・・・・・・・1 得意先_ID・・・・・・1 年月日・・・・・・・2014/10/10 区分・・・・・・・・0:売上、1=値引、・・・9=調節 金額・・・・・・・・20,000円 摘要・・・・・・・・物件A代金 [得意先別入金台帳] ID・・・・・・・・・1 得意先_ID・・・・・・1 年月日・・・・・・・2014/10/10 区分・・・・・・・・0:入金、1=返金、・・・9=調節 金額・・・・・・・・20,000円 摘要・・・・・・・・物件A代金 さて、これでは見積りテーブルとの関連は皆無。でも、それで良いのです。あくまでも、売上と入金との関係を把握するのが目的。見積りは、あくまでも見積りなんです。そこを関連付けようとすると、永遠に完成できないでしょう。 もう一つ。得意先テーブルには”請求締め日”以外に請求に係わる列が見当たりません（ちょっと、、修正しました）。それは、”請求書発行アプリケーション”さえあれば解決できるからです。もちろん、請求書発行に当たっては、得意先ごとに設定した締め日に沿って請求残、新規売上、新規入金を求める必要があります。ですから、月次の売上や入金を加算・減算して求めてはダメです。請求履歴等は、あえてテーブルに記録しなくても紙媒体で残しておけば良いでしょう。少なくとも、そういった設計で顧客からクレームが出たことはありません。 【お詫び】先の回答の[請求]を[売上]と訂正しました。こっちの方が一般的かと思います。なお、先の回答で示したのは請求書発行アプリケーションのそれです。得意先別売上・入金元帳のそれではありません。 販売管理アプリケーションを開発したのは1996年のこと。ちょっと、記憶が怪しいところがあるかと思いますが、そこはご勘弁を。
失礼しました。SQLの最後の「商品」 の末尾に「、」がくっついていました。 補足のBit型についてはAccessでは、 Yes/No型にします。したがって 以下のようにします。 CREATE TABLE まっさら2 ( ID AUTOINCREMENT CONSTRAINT PrimaryKey PRIMARY KEY, 受注日 Date, 商品 TEXT (64), 削除フラグ YESNO ) なお、規定値についてはAccessではSQLでは設定 できないとおもいますので、VBAでDAOのTableDef を使って変更するようになります。SQLとVBAでの 組合せは以下にあります。 http://www.accessclub.jp/bbs2/0041/beginter13571.html
複数ユーザーで共有している場合のフロントエンドファイルのバージョンアップ http://hatenachips.blog34.fc2.com/blog-entry-422.html が参考になるかと思います。 更新のになるのはテーブルに入れてあるバージョン番号です。 私の場合は、 バックエンドのファイルのテーブルにバージョン番号を入れておいて フロントエンドにリンクテーブルを設けます。 もう一つフロントエンドに普通のテーブルをおいてここにもバージョン番号を入れます。 メニューフォームが最初に立ち上がるように設定し、 そのなかでDlookup関数とかでリンクテーブルと自テーブルのバージョンをチェックし 違っていたら バージョンアップ用のMDE（ACCDE）を呼び出し、自身は閉じます。 呼び出された方はフロントエンドが完全に終了しているのを確認後に削除 ファイルサーバーにある新しいフロントエンドファイルを デスクトップにコピーし、立ち上げ、自身を終了。 というのを作ってました。 ユーザーの中にはズルしてファイルサーバー上のフロントエンドファイルを 直接開いて使う人がいましたので（ネットワークドライブ設定の場合） Currentdb.name とAPIのWNetGetConnection で調べ警告を出して閉じるようにもしました。 http://support.microsoft.com/kb/160529/ja それから、ユーザーの誤操作によってバックエンドのファイルが消されてしまう場合がありましたので フォルダのアクセス権を変更し一般ユーザーの削除の権限を取り上げました。 これによりロック情報ファイル（ldb、laccdb が残りますが私もユーザーの一人だったので問題無し） ただ、一般ユーザーの『最適化』は失敗しますので「閉じるときに最適化」オプションは変更しました。 またバックエンドのファイルには当然パスワードを設定し フロントエンドはVBAのコード中にパスワードが含まれているのでMDE/ACCDEにしました。 あと、大事なのはバックエンドのファイルのバックアップですね。 VBSで作ってタスクスケジューラで定期的に実行するか フリーウェアのBunBackUpを使わせてもらうと世代バックアップも楽になります。 懇切丁寧、手取り足取り教えてくれる奇特な人は期待しない方が・・・。 以上簡単ですがご参考まで。
一致条件を判断する関数をVBAで作成すれば可能ですが、 「S001234とS1501234E」が一致するということは、1234 が一致しているということですが、前者の一部と後者の一部の一致も許可するということですよね。 だとすると、「S001234」は一つ前のデータ例「S1234」とも一致するし、「S1501234E」は同じく「123456/S1234」とも一致するということになりますね。 これでは、一致する条件が緩すぎて、複数の組み合わせが多数できてしまい使い物にならないと思いますが。 もう少し厳密な条件定義が必要ですね。 また、関数で一致条件を定義するとインデックスの機能が使えませんので、レコード件数が多いと処理が重くなります。 加工して完全一致になるフィールドを作成する方法をとることをお勧めましす。 どちらにしても現状の条件ではどうにもなりません。
お礼拝見しました。Access（というか、データベース）を使うのであれば、このデータ構造では無理です。二つのデータを結合するためのキー項目が必要です。 例えば、ファイル1,2がそれぞれデータベースのテーブルだとします。以下の過程は成立しますか？ ・ファイル1は1項目め（郵便番号？）が一意に定まる（つまり、同じものが2行出てこない） ・ファイル2の各行が、ファイル1の1項目めのどの番号に対応づくのかがわかっている この場合、 ・ファイル1から作るテーブルでは1項目めをプライマリーキーとする ・ファイル2から作るテーブルでは、ファイル1の1項目めのデータ項目を加えて、それをファイル1から作るテーブルのフォーレンキー（外部参照キー）とする としておいて、キー項目を元に結合条件を書けば処理できます。
リンクテーブルマネージャでリンク先の変更は成功しているのでしょうね？ （そのリンクテーブルを直接開けますよね？） なら、クエリ中に以前のテーブルを参照する部分があるのでは？ クエリをデザインビューで開いて（プロパティも表示する）見るか、 SQLビューで開いてみれば確認できるのでは？
＜IIFとNull値の関係＞ それは、添付図が示す通りです。 ＞そもそもNull同士の評価は"×"になってしまうのでしょうか？ "〇" という結果を得るには、添付図の３つ目のやり方があります。
通常、ご質問のような事はしません。 同じデータが複数のテーブルにあることで ファイルサイズが大きくなってしまう。 一つのテーブルだけ一部のデータを更新し、 残りのテーブルの更新を行わなかった場合にデータの整合性が取れなくなる。 （顧客番号110の商品番号10の3月のデータがテーブルAとテーブルBで異なるけどどっちが正しいの？） などよろしくありません。 一般的？には テーブル1 顧客番号|商品番号|　年月|金額 　　　10|　　　10|201401|　50 　　　11|　　　10|201401|　20 　　　10|　　　10|201402|　30 　　　10|　　　20|201401|　50 　　　11|　　　20|201401|　30 　　　10|　　　30|201402|　10 のようなテーブル構造にしてクロス集計クエリで 顧客番号|商品番号|合計金額|201401|201402 　　　10|　　　10|　　　80|　　50|　　30 　　　10|　　　20|　　　50|　　50| 　　　10|　　　30|　　　10|　　　|　　10 　　　11|　　　10|　　　20|　　20| 　　　11|　　　20|　　　30|　　30| とすると思いますけど？ ※レイアウトが崩れてしまっていたらメモ帳にでもコピペしてフォントを等幅にしてください。 Access2002の場合のでちょっと古いですが今どき（2010など）でも一緒です。 https://www.microsoft.com/japan/office/previous/xp/suminaka/access/sousa/1/sousa1_20_1_honbun.htm ご参考まで。
なんだか以前にも似たような質問を見かけたことが あるのですが、忘れました。 「参照」とあるのはこのテーブルの値を参照して 他のテーブルの数値の合計を出すとか、そういうことですか。 もし、そうであるならば、二つのテーブルをレコードセット にしてグルグルとループさせる必要があるならば少し 具体的でないと関数が書けないと思いますが。 質問のテーブルは連続した数値が1から並んでいますが、 実際にもそうなのですか。 データベースのテーブルはデータの並びにユニークキーが なければ、データの並びはランダムなので、「3セル分上の値」 ということは確定できません。あるいは、質問の「数字」の フィールドのようにデータが昇順になっている、あるいは 昇順に設定できる、ということであれば話は別ですが。 もっとも「7を基点に4までの範囲」と「７を起点に7,6,5,4という 感じで3セル分上の値を指します。」の部分が謎なのですが。 No2さんは理解しておられるようですが。 どのように「数字」からデータを取り出し、どのような合計を 出したいのか具体的なプロセスがわかれば簡単なのですが。
＞この場合、一つのテーブルに同じ都道府県や市区町村が重複して入るのを良しとす ＞るお考えでよろしいでしょうか? ＞この場合、運用上のやりやすさを考えたご提案かと思いましたが、その場合、デー ＞タ量が多少大きくなるのはOKとされますか? ENUMやSETで処理する限り、内部的には数値で管理されるため理論的に容量はさほど 大きくはなりません。したがって都道府県などリストの内容がほぼ普遍的なものに ついては容量を理由に正規化する必要はありません。 （とはいえ10年単位で考えると都道府県合併も可能性はありますが・・・） http://ja.wikipedia.org/wiki/%E5%88%97%E6%8C%99%E5%9E%8B#MySQL また市区町村は結構変更があるのと都道府県の下につく二次データであることから ENUMやSETに向きません。 正規化してもいいし、そのまま文字データで持ってもいいと思います。 ＞「SQLにおける効率的なデータは必ずしも容量を少なくするものではありません。」 正規化というのは多数の重複がある前提の技術です。 重複数があまりない場合は理論的には効率化されていますが実際には無駄な処理に なります。 また該当するカラムを集計のキーに使わない場合は無駄にインデックスを消費するため データは大きくなる半面全体的なスピードは低下する傾向にあります。 たとえば仮に「東京都」でデータを抽出するとき、ダイレクトに書いてある場合は 直にインデックスが効きますが、正規化してあると都道府県テーブルから 「東京都」を探し、都道府県IDを抽出したうえで都道府県IDに紐づいたレコードを 探すことになるので、処理的にはむしろ効率的ではありません。 実際には都道府県IDを最初から抽出した状態から検索するインタフェースなので 逆に正規化しておかないと、都道府県リストを都度つくる無駄がでますので 善し悪しでしょう。 ＞「都道府県名を入力欄にいれると不正にデータを抜かれやすくなると言われていた ＞時期もありますが、 ＞セキュアな技術を使えばそれは避けられるでしょう」 端的にいえばSSLで解決します。 もちろん都道府県IDに紐づけばトラフィックも減らせるので悪いわけではありません。 またインターネットのトラフィックが爆発的に増えている現在 よほど重要な個人情報でないかぎり住所からデータを不正に抜くことが 現実的ではなくなっているきらいもあります。 ＞都道府県名に対して、外部制約キーをつかったり、データ型をsetにしたりする ＞ことでデータを効率化することも可能です。 一部訂正します。 住所は都道府県が２つ以上存在しないためSET型よりENUM型がよいでしょう。 http://dev.mysql.com/doc/refman/5.1-olh/ja/enum.html ＞市町村名まで正規化するのが実用的かどうか 経験則でいえば、正規化する意義はあまり感じません。 例えば何万、何十万というデータ郡から市町村単位で広範なデータを集計する ようなケースを想定しているのであれば話は別ですが、単なる住所録としては メンテナンス性がおちるため市区町村名での正規化はお勧めしません。
利用者数 に対してフィールド名の別名宣言を省略しているのことに対する疑問でしょうか。 ユニオンクエリにした場合、フィールド数とデータ型があっていればフィールド名は異なっていも問題ないです。 最初のSELECT文のフィールド名が採用されます。 ですので、2番目は別名の宣言は省略しても問題ないのです。 SELECT "商品数" AS 項目, 年月, 商品数 AS 数量 FROM テーブル名 UNION ALL SELECT "利用者数", 年月, 利用者数 FROM テーブル名; これでもいいし、省略せずに丁寧に書けば、 SELECT "商品数" AS 項目, 年月, 商品数 AS 数量 FROM テーブル名 UNION ALL SELECT "利用者数" AS 項目, 年月, 利用者数 AS 数量 FROM テーブル名; となります。 最初のSQLは片方は別名宣言して、片方は省略したので紛らわしかったですね。 疑問に思ったことはこのようなことでしたしょうか。
Salary　テーブルの index がどうなってるかによります。 データ自体は、参考例に１，２行あればいいので、create 文の方を載せてほしかったですね。カラム区切りも解らなくなっていて、ほとんど載せる意味がない。 テーブルの意義から言って、Salaryテーブルでは、日付とEmployeeIDが決まれば、一行しか存在しないことが必要だと思いますが、もし、この２カラム連動でのunique index を貼っていなくて、同日に同一者に多重支払いしている行が存在するなら、Bと名付けたサブクエリ内でgroup by EmployeeID として、取得結果側カラムは sum(Amount) as Amount とする必要があるでしょう。 でも、現実の状況で、もし、同じ日付＆同じEmployeeIDで複数行あったら、バグ扱いになりそ。
テキストエディタでCSVファイルを開いて見ましょう。 まともなテキストエディタなら、文字コードや改行コードの種類が確認できるようになってます。
Set Db = OpenDatabase(xlsFile, True, True, "Excel 14.0;")　←ここで止まる を Set Db = OpenDatabase(xlsFile, True, True, "Excel 12.0;")　'←ここで止まる ならOffice2010では出来ましたよ？ アプリケーションのバージョンではなくファイルのバージョン指定っぽいです。 ちょっと蛇足かもしれんが、参考になると思われます。 ・・・本来 Null でない Excel 列内の一部の値が Null として返されることがあります・・・ http://support2.microsoft.com/kb/194124/ja >この名前は既に・・・ Microsoft DAO 3.6 Object Library の上位バージョンの Microsoft Office 14.0 Access Database Engine Object Library に チェックが入っていれば OK です。
テーブル名を ★★ フィールド名を、左から F1 ～ F5 と仮定します。 また、提示あった内容の順が保証されるように、 オートナンバ「an」昇順で表示されているものとします。 以下をクエリの SQLビューに記述してどうなりますか SELECT * FROM ★★ AS Q1, ★★ AS Q2 WHERE Q1.F1=1 AND Q1.F1<>Q2.F1 AND Q1.an < Q2.an AND IIF(Exists (SELECT 1 FROM ★★ WHERE F1=1 AND an>Q1.an), Q2.an < (SELECT Min(an) FROM ★★ WHERE F1=1 AND an>Q1.an), Q2.an <= (SELECT Max(an) FROM ★★));
> で、実際のCSVファイルは数十万行あるのですが、 このファイルをコピー、編集して３行とかにしたら、２行目はきちんと取り込めますか？ 対象のCSVファイルの改行コードがVBAで想定しているものと違っていて、１行読み込むつもりが改行をきちんと見つけられずにファイル全体を読んでしまうとか？
> 勉強不足で大変恐縮ですが、このSQLは現在の年月から-0ヵ月、-1ヵ月、-2ヵ月・・・としたものを、yyyy年m月のフォーマットで昇順に表示している・・という認識でよろしいでしょうか。 はい、それでいいです。 Date関数、DateAdd関数、Format関数についてヘルプで調べるといいでしょう。
それぞれのフィールドのレコードが、1利用者あたり1件だけなら、 このテーブルから集計クエリを作成して、下記のように設定してください。 利用者　グループ化 AサイトのID　最後 BサイトのID　最後
変数にそのcsvファイルのパス例えば "file:" & Get ( デスクトップパス ) & "ファイル名.csv" とかを入れて、Event送信ステップでその「ファイルを開く」にすると エラー処理オン時はそのファイルが存在しない場合Get(最終エラー)=100 が返ります。有るときは開いてしまうけど、Windowsのコマンドか何かで 閉じることできるのかな？
さて、ワークテーブルの各列の値ですが、[商品マスター_ID]さえ確定すれば、以下のコードで確定できます。 Private Sub 商品マスター_ID_BeforeUpdate(Cancel As Integer) 　　Dim lngID As Long 　　Dim strSQL(3)　 As String 　　Dim strWHERE(1) As String 　　 　　lngID = Val(Me.商品マスター_ID & "") 　　 　　If lngID > 0 Then 　　　　strWHERE(0) = "ID=" & lngID 　　　　strWHERE(1) = "商品マスター_ID=" & lngID 　　　　strSQL(0) = "SELECT [商品コード] FROM [商品マスター] WHERE " & strWHERE(0) 　　　　strSQL(1) = "SELECT 商品名 FROM [商品マスター] WHERE " & strWHERE(0) 　　　　strSQL(2) = "SELECT 単価 FROM 商品別単価一覧 WHERE 単価区分=1 AND " & strWHERE(1) 　　　　strSQL(3) = "SELECT 単価 FROM 商品別単価一覧 WHERE 単価区分=2 AND " & strWHERE(1) 　　　　Me.商品コード = DBLookup(strSQL(0)) 　　　　Me.商品名 = DBLookup(strSQL(1)) 　　　　Me.単価1 = DBLookup(strSQL(2)) 　　　　Me.単価2 = DBLookup(strSQL(3)) 　　End If End Sub PS1、通常は、このような手法は使わない。 ・[商品マスター_ID]に"0"が入力されると検索フォームを開く。 ・商品を検索・選択したら検索フォームを閉じる。 ・その際に、各列の値を更新する。 PS2、DLookup()でも良いが動作は遅い。 DBLookup()は３倍速で動作します。 Public Function DBLookup(ByVal strQuerySQL As String, _ 　　　　　　　　　　　　　Optional ByVal ReturnValue = Null) As Variant On Error GoTo Err_DBLookup 　 Dim DataValue 　 Dim rst　　　　 As ADODB.Recordset 　 Set rst = New ADODB.Recordset 　 With rst 　　　 .Open strQuerySQL, _ 　　　　　　 CurrentProject.Connection, _ 　　　　　　 adOpenStatic, _ 　　　　　　 adLockReadOnly 　　　 If Not .BOF Then 　　　　　 .MoveFirst 　　　　　 DataValue = .Fields(0) 　　　 End If 　 End With Exit_DBLookup: On Error Resume Next 　 rst.Close 　 Set rst = Nothing 　 DBLookup = IIf(Len(DataValue & ""), DataValue, ReturnValue) 　 Exit Function Err_DBLookup: 　 MsgBox "SELECT 文の実行時にエラーが発生しました。(DBLookup)" & Chr$(13) & Chr$(13) & _ 　　　　　"・Err.Description=" & Err.Description & Chr$(13) & _ 　　　　　"・SQL Text=" & strQuerySQL, _ 　　　　　vbExclamation, " 関数エラーメッセージ" 　 Resume Exit_DBLookup End Function
入力済みのデータなら、重複クエリウィザードで確認できます。 http://www.nbcom.co.jp/PC-Support/FAQ/acc/ht/acc072002ht007.shtml 新規のデータの追加をさせないなら、ロット、商品ID、生産者コードでユニークキーにすればいいのでは？ まあ条件付き書式でこだわるなら =DCount("*","テーブル名","ロット = '" & [ロット] & "' And 商品名 = '" & [商品名] & "' And 生産者 = '" & [生産者] & "'") >1 DCount関数 http://office.microsoft.com/ja-jp/access-help/HA001228817.aspx
[バグ] エラートラップを抜かしていました。 Public Sub GoToNewRecord(ByVal intRowMax As Integer) On Error Resume Next 　　Dim I As Integer 　　Dim J As Integer 　　DoCmd.GoToRecord , , acLast 　　J = intRowMax - 1 　　For I = 1 To J 　　　　DoCmd.GoToRecord , , acPrevious 　　Next I 　　DoCmd.GoToRecord , , acNewRec End Sub
強いて、Accessのレポート機能等を利用する必要はないと感じました。 01:先頭行の列1を出力する。 02:先頭行の列2を出力する。 03:次の行を読み込む。 04:列3が存在すれば列3を出力する。 05:列3が存在しない時は列4を出力する。 06:改頁する手前まで04、05を繰り返す。 07:締めの文言を出力する。 08:04～07を繰り返す。 以上のようなプログラムを書けませんか？仮に書けないとしたら、作表ソフトの出番かと思いますよ。要は、単なる作表作業ですから・・・。 １、Sheet1に呼び込む。 ２、Sheet2の先頭で[締めの文言]を定義する。 ３、先頭行の列1を出力する。 ４、先頭行の列2を出力する。 ５、03～07に相当する関数を定義する。 ６、以下、ツツーッ。 こういうアプローチもあろうかと思いますよ。
よくあります。 何度もチャレンジしてみてください！ わたしは繰り返ししてたらできましたよ（＾∇＾）
CopyFromRecordsetについて調べてみると http://www.moug.net/tech/acvba/0090011.html オートメーションでExcelを操作した時にハマりそうな事 http://hanatyan.sakura.ne.jp/vbhlp/ExcelErr.htm
純粋なランタイム環境ではありませんが、 ファイルの拡張子を、accdb → accdr に変えたランタイムモードでは テーブル削除・作成クエリも Excelファイルのインポート（Docmd.Transferspreadsheet Acimport・・・）も 機能しました。 ご参考まで。 >ただ、一時テーブル（作業テーブル）として使うなら、最初から空のテーブルを用意しておいて、そこにレコードを追加、使用後レコード削除という運用法の方が、高速だし安全だと思います。 ↑御意。
Hadoopについてよく知りませんが分散コンピューティングのためのフレームワークであって分散型データベースとは違うような。 分散型データベースも分散コンピューティングの範疇には入るんでしょうけど。 http://oss.infoscience.co.jp/hadoop/
下記のSQLを実行すればOKです。 update Members set name = 'ABC' & name & 'XYZ' where status = 200
構築は可能です。 ただし運用できるかは質問者さんのスキル次第。 自分でファイルサーバを立ち上げることで解決しますね。 　　　ＲＡＩＤ１＋５ くらいで構築すれば良いと思います。 （ＲＡＩＤ６が必要かは判断できません） 手元にファイルサーバがあれば、それなりに早いＬＡＮ接続なら データの転送速度に不満は出ないと思います。 複数のパソコンから同時にアクセスするなら１００Ｇ　ＬＡＮおすすめ。 （１０Ｇでも良いかもしれませんがｗ） モバイル用途であれば、外付けＨＤＤを必要数用意してフォルダ単位で同期を取り 使用するデータが含まれる外付けＨＤＤを持ち出せばＯＫ。 まさかファイルサーバごと持ち出すわけにはいきませんからねｗ 手っ取り早く通信速度が速いプロバイダ契約をするというのもアリかもしれません。 （専用回線を契約するとかね）
CSVファイルの内容が提示無いので推測ですが 項目1,項目2,項目3 1,あ,あ,いい なら当然の結果と思います。 あ,あ　を１つの項目として扱いたいのなら、少なくとも 項目1,項目2,項目3 1,"あ,あ",いい という内容になっていないと１つの項目として解釈しないと思います。 元々のCSVファイルを作成する際に変更するよう依頼してみては？
CSV ファイルを、ヘッダなしファイルとして解釈させます。 以降得られるフィールド名は、F1、F2、・・・ 不要な　XXXXXX　部分は、２番目のフィールド以降 Null で除外判別できます。 ２行目の項目名部分の項目1は、 おそらく、以降のデータを解釈した際に数値と解釈されると思うので （項目1 部分が数値として解釈されたのなら Null に置き換わります） 項目1,項目2,項目3 ↓ Null,項目2,項目3 解釈が違っても項目1の有効なデータ部分は数値の様なので・・・ そこで、IsNumeric(F1) AND F2 Is Not Null　の条件を付加して インポートしたいテーブルと項目を列挙し、 それに対応する F1、F2、・・・・を記述した SQL を実行させれば終わりです。 以下は、項目3 までの記述になりますが Public Sub Samp1() 　　Const CSQL As String = "" _ 　　　　& "INSERT INTO テーブル名(項目1,項目2,項目3) " _ 　　　　& "SELECT F1, F2, F3 FROM [{%1}] IN " _ 　　　　& "'{%2}'[text;FMT=Delimited;HDR=No;IMEX=1] " _ 　　　　& "WHERE IsNumeric(F1) AND F2 Is Not Null;" 　　Const CPATH As String = "CSVファイルがあるフォルダへのフルパス" 　　Const CNAME As String = "CSVファイル名" 　　Dim sSql As String 　　sSql = CSQL 　　sSql = Replace(sSql, "{%1}", CNAME) 　　sSql = Replace(sSql, "{%2}", CPATH) 　　CurrentDb.Execute sSql End Sub ※ CSV ファイルのパスが D:\tmp\Hoge\テスト.csv だったら CPATH は、D:\tmp\Hoge CNAME は、テスト.csv
分割フォームは単票フォームとデータシートを同時に表示するものです。 データシートを単票フォームの上下左右のどこに表示するからプロパティで設定できます。 データシートを下に表示するように設定した場合は、下記のような表示になります。 フォームヘッダー フォーム詳細セクション フォームフッター データシート ひょっとすると フォームヘッダー フォーム詳細セクション データシート フォームフッター という表示にしたいというのが希望でしょうか。 だとしたら分割フォームでは無理です。 帳票フォームにして、詳細セクションをデータシートぽくデザインするか、 単票フォームにデータシートビューのフォームをサブフォームとして埋め込む方法になります。
私はActiveRecordのloggerを使っています。 これを使うことで何か不都合はありますか？ 数行追加するだけですが。
No.6です。 >Rubyのexcel2csvライブラリから勉強してみようと思います excel2csvはエクセルで作成したファイルをシート単位でデータを読み込むライブラリです。ドキュメントを見てもよくわかりませんでした。例が書いてあるのでそれを真似した使えるようになりました。主はRubyです。Pythonなどのスクリプト言語でもかまいませんが、一から始めるのでしたらRubyが良いのはないか勝手に思っています。多少複雑なことをするのでしたら強力なツールになりますので、何かのスクリプト言語を知っておくと業務の効率化に役に立つことが多いです。 ただし、excel2csvは既存のエクセルファイルのどこかのセルに書き込むなどの複雑なこと無理です。集計した結果を表示するとか、新しいエクセルファイルとして書き出すという用途には適しています。既存のEXCELファイルに手を加えるのでしたらVBAや http://magazine.rubyist.net/?0027-ExcellentRuby など（リンクの下の方に関連したリンクも）を参考にしてください。 さて、先に書いたファイルメーカーで作った予算管理データベースのことについて少し触れておきます。 だいぶ前になるのですが、外部資金をもらったプロジェクトをやっていて、そのプロジェクトのために会社のシステムと切り離した厳密な予算管理を要求されていましたので、土日を二回ほど潰して作ったものです。 発注、納品、支払いの品目ごとの管理と、月々の支払いの集計ができ、注文書や集計表の印刷や、未払いの金額を含めた予算管理ができるようにしました。 ファイルメーカーでもやる気になればこの程度のことはできます。結構複雑なことをしていましたので、作るのがたいへんではありましたが。 今だったら、Ruby on Railsで作った方がだいぶ楽なように思いますが、 顧客名簿などの比較的単純なものでしたら、ファイルメーカーが適していると思います。 No.7にの書かれているように共有が簡単にできますし、 顧客名簿程度でしたら素人でも手をつけられるものです。（私も素人ですが）
こんにちは！ Sheet1にコマンドボタンを挿入しておいて、コマンドボタンをクリックすると Sheet1の2行目データをSheet2の最終行以降にカット＆ペーストしたい！ という解釈です。 もしそうであればわざわざSheet1にデータを入力し、おなじデータをSheet2に持ってこなくても ユーザーフォームにテキストボックスを4個とコマンドボタンを配置し、 ユーザーフォームのコマンドボタンをクリックで直接Sheet2に表示させる方が簡単だと思いますが、 敢えて質問通りにやれば、 Sheet1のコマンドボタンのコードを↓のようにしてみてはどうでしょうか？ ＞したいことは、データ４列で・・・ とありますので、A2～D2セルとしています。 Private Sub CommandButton1_Click() Dim wS As Worksheet Set wS = Worksheets("Sheet2") Range("A2").Resize(, 4).Cut wS.Cells(Rows.Count, "A").End(xlUp).Offset(1) End Sub Excel2007以降をお使いだとして・・・ （ActiveXコントロールのコマンドボタンを挿入するとします） メニュー　→　開発　→　挿入　→　ActiveXのコマンドボタンを選択し、Sheet1に挿入 →　挿入したコマンドボタン上でダブルクリック　→　上記コードの1行目と最終行はすでに表示されている状態ですので、 2行目～最後から2行目までをドラッグ＆コピー　→　そのままVBE画面のカーソルが点滅しているところに貼り付け →　「デザインモード」を解除してSheet1に戻りA2～D2セルにデータ入力　→　コマンドボタンをクリック！ としてみてください。 ※　今回はActiveXコントロールのコマンドボタンとしましたが、 オートシェイプ等でも構いません。m(_ _)m
こちらの質問をされた方ですよね。 http://oshiete.goo.ne.jp/qa/8691890.html AccessとSQLServerによる環境構築(フロントエンドやバックエンドと仰っている新環境)について、ちょっとうまく伝わらなかったみたいですね(汗)それは後述するとして、先に質問に回答させて頂きます。 >【質問1】 >構築後、Accessのテーブルやフィールドを変更することはできるのでしょうか。 →後述しますが、質問者様がされようとしている新環境を実現すると、Accessからテーブルがなくなります(要らなくなります)。なので直接の回答としては「できません(もしくは不要)」が回答になります。 >【質問2】 >上記の仕組みをWindowsサーバではなく、UNIXサーバ上で実現できるでしょうか。 →AccessもSQLServerもWindowsのパソコンやサーバーで動きます。残念ながらUNIXでは動きません。 こちらはSQLServer。システム要件をご確認下さい。 http://www.microsoft.com/ja-jp/download/details.aspx?id=42299 Access2013はこちら。OfficeアプリケーションのAccess2013→オペレーティングシステム参照。 http://office.microsoft.com/ja-jp/products/FX102921529.aspx さて…AccessとSQLServerによる新環境を作ろうとするとテーブルがなくなると回答致しました。 質問者様も書かれている通り、SQLServerはデータベースを構築するソフトです。そのデータベースには様々ないわば部品を作ることが可能ですが、テーブルもその一つ。Accessにもテーブルはありますよね。つまりSQLServerにAccessのテーブルとデータを引っ越してしまい、個々のPCからはAccessからSQLServerのテーブルを参照する、というのがこの新環境。個々のPCからはSQLServer内のテーブルにデータを読み書きしに行くので、Access内にテーブルは不要となります。 これにより、みんなで同じSQLServerのテーブル(の中のデータ)を読み書きするので、データの一元管理ができる、個々のPC内のAccessにデータが分散されない、というのがこの新環境のミソだったかと。 新環境は↓こちらの図のようなものになるかと思います。 http://dba.fyicenter.com/faq/sql_server_2/Connecting_Applications_to_SQL_Servers_via_ODBC.html ご健闘をお祈りしています。
SQLを考える時は理論の組み立てが肝要です。 (1)部門別に日時の最大値を求める。 (2)テーブルから、部門と日時が(1)と同じものを求める。 厄介なのは英語だから逆になることです。 SELECT A.* FROM テーブル AS A INNER JOIN (SELECT 部門,MAX(日時) AS 日付 FROM テーブル GROUP BY 部門) AS B ON A.部門=B.部門 AND A.日時=B.日付 ()の中のサブクエリが(1)になります。外側のSELECTが (2)に該当します。
私流のやり方です。 SELECT A FROM T2 WHERE T2.id<5; UNION SELECT A FROM T1 WHERE T1.id>0; ダミーテーブルを用意し UNION クエリーを作成します。 [T2.A] _dummy01 _dummy02 _dummy03 _dummy04 ・・・・ _dummy99 ダミーテーブルのA列には、先頭ブランクのデータを上のように登録します。 これで、レポートには必要なダミー列が表示されます。 ＜出力時にダミー列の文字の色を白に変更＞ 僅かに１行のコードを書けば、これが達成されます。 ※正規のやり方ではないので参考までに！
ヘルプウィンドウのステータスバーの右端のボタンが「Office.comに接続」という表示になっていませんか。 もし、そうなうなら、そこをクリックして、「このコンピューター上のコンテンツのみ表示」をクリックしてください。
>指定した式で、閉じているかまたは存在しないオブジェクトを参照しています ということなので オブジェクト＝フォームが見つからないよ？と言ってます。 ・フォームを開いていないか ・フォーム名が間違っているか ・フォームの指定方法が間違っているか↓ http://hatenachips.blog34.fc2.com/blog-entry-347.html ではないですか？ では。
＃１です 以下を参照してください http://ja.wikipedia.org/wiki/%E9%96%A2%E4%BF%82%E4%BB%A3%E6%95%B0_(%E9%96%A2%E4%BF%82%E3%83%A2%E3%83%87%E3%83%AB)#.E7.9B.B4.E7.A9.8D この中の、S:E だけの E=1,2,3 の場合を考えてみてください。 「T連番」の「連番」が、S:E に相当して、用意した連番の <=3 を使うものになります。 ※ これで回答になっていたでしょうか
すみません。Q1のSQLは SELECT 番号,住所 FROM テーブル１ UNION SELECT 番号,住所 FROM テーブル２; に修正し、それからのクエリのSQLは SELECT Q1.番号, Q1.住所, [テーブル１].好物, [テーブル２].[ランク] FROM (Q1 LEFT JOIN テーブル１ ON Q1.番号 = [テーブル１].番号) LEFT JOIN テーブル２ ON Q1.番号 = [テーブル２].番号 ORDER BY Q1.番号; に修正してください。 上記のようにクエリを二段に分けないでまとめると （Qx が上のQ1にあたります） SELECT Qx.番号, Qx.住所, [テーブル１].好物, [テーブル２].[ランク] FROM ( (SELECT 番号,住所 FROM テーブル１ UNION SELECT 番号,住所 FROM テーブル２ )AS Qx LEFT JOIN テーブル１ ON Qx.番号 = [テーブル１].番号) LEFT JOIN テーブル２ ON Qx.番号 = [テーブル２].番号 ORDER BY Qx.番号; のようにも出来ます。
インポート定義を利用して行うのはご存知ですよね。 http://office.microsoft.com/ja-jp/access-help/HA001226307.aspx フォーマット（項目数や内容）がバラバラな不特定のファイルだと VBAでゴリゴリ作るしかないと思います。 CSVフォーマットだとして、位取りのカンマがついている項目 "1,234" や 項目内で改行がある項目などなど処理が面倒です。 何かの設定を変えればすべてテキスト型でインポートされる・・・というのは 無いハズです。
phpからJDBCドライバーは使えんぞなもし（ひょっとしたらそういうエクステンションがあるのかも知れないけど）。 phpではデータベースに対する接続はDBMSごとにエクステンションというもので管理している。 エクステンションというのは、phpのスクリプトから呼び出せる関数を増やしてくれる仕組みだ。 現在DB2エクステンションが登録されていないためにdb2_connectという関数が未定義になっている訳だ。 で、エクステンションの設定はphp.iniで行う。 参考URLを二つほど紹介しておきましょう。 http://www.php.net/manual/ja/book.ibm-db2.php http://pecl.php.net/package/ibm_db2 いっそのことIBM DB2 ODBCドライバーを入手してWindows上でODBCによる接続設定を行い、phpからはODBCブリッジを利用して接続するという方が楽かも。もちろんODBCの制限に引っ張られるけど。
PHP_INT_SIZE で32bit版か64bit版かはわかりません。 http://www.php.net/manual/ja/language.types.integer.php 一般に、64bitOSにPHPの32bit版は入らないはず。 古いバージョンでは入りますが、最新版はダメです。 タスクマネージャでphp.exeを見て*がなければ64bitです。 大原則として、64bitプロセス空間には64bitのDLLしか ロードできません。同じく32bitプロセスには32bitのDLL しかロードできません。ODBCがDLL実装(これが大半)で あれば32bit版のODBCを64ｂｉｔPHPで扱うことはできません。 プロセス間通信を使って、異なるプロセスでＯＤＢＣを稼動 させ、データを通信により受け渡します。プロセスが違う ので、64bit/32bitの壁をスルーできます。但し、これを実装 するには独自にPHPエクステンションを作るか、exe型の COMモデルを使うしかないと思います。 私は前者は開発した経験がありますが、後者は経験が ありません。PHPエクステンションの開発は非常に難しく、 Windowsのプロセスにやスレッドに関する技術、PHPの データ管理法、DLLとのインターフェースなどの知識が 無いと作れません。 また、exe型のCOMモデルは非常に少なく、Office系での 実装しか見たことがありません。 Accessがインストールされていれば、とりあえず、COM オブジェクトでAccess.Applicationをインスタンス化して 操作を試みます。成功すれば何とかなると思います。 PHPとCOMでググってみてください。
質問1については、 例えば名前と完全一致で検索するような場合は以下のようなSQLが実行されると推測されます。 select * from test_table where name='入力された内容' 「入力された内容」の部分にシングルクォートのことを何も考慮せずに「SQL'」を入れれば、 select * from test_table where name='SQL'' となり、エラーになります。 シングルクォートを正しくエスケープしていれば、エラーにはなりません。 他の質問も、where句にそのままいれたらSQLがどうなるかを考えればわかります。
同じテーブルを追加する時は、alias (別名)をつけます。 SELECT Persons.ID, Persons.pName, Persons_1.ID, Persons_1.pName FROM (Persons INNER JOIN Relations ON Persons.ID = Relations.yourID) INNER JOIN Persons AS Persons_1 ON Relations.spouseID = Persons_1.ID WHERE Persons.IsHusband=True;
商品コードとは別に、オートナンバー型のフィールドを作成しておいた方が安心だと思います。 主キーが商品コードの場合、一意制約の関係で不便が生じると思います。 例えば以下の手順です。 　(1)商品コードAで登録 　(2)商品コードAのマスタの削除フラグを立てる 　(3)新しく商品コードAを登録(出来ず。同じ商品コードの物は再登録出来ない) もちろん削除フラグを立てたマスタをDELETEすれば問題ありませんが、あまりおすすめしません。
下記でどうでしょう。 クエリを新規作成して、Aテーブル、Bテーブル を追加します。 明細ID 同士で結合します。 集計クエリにします。 フィールドを下記のように設定します。 フィールド / 集計 / 抽出条件 ------------------------- 年度 / グループ化 個人ID / グループ化 達成数: 個人ID / カウント 実績 / Where 条件 / >=5 SQLなら、 SELECT B.年度, A.個人ID, Count(A.個人ID) AS 達成数 FROM A INNER JOIN B ON A.明細ID = B.明細ID WHERE A.実績>=5 GROUP BY B.年度, A.個人ID;
クロス集計クエリという機能がありますが、まさにその例題的な案件ですね。 リボンの[作成]-[その他]-[クエリウィザード]で「クロス集計クエリウィザード」を選択してOKをクリック。 テーブルを選択して「次へ」 行見出しに「個人ID」を選択して「次へ」 列見出しに「月数」を選択して「次へ」 集計する値で「体重」を選択、集計方法で「先頭」を選択して「次へ」 これで完了です。 保存して、開いてみてください。希望の結果になっていると思います。 ちなみに、デザインビューでするなら、リボンでクロス集計クエリをクリックして、 下記のように設定します。 フィールド　/　集計 / 行列の並べ替え 個人ID　/　グループ化　/　行見出し 月数　/　グループ化　/　列見出し 体重　/　先頭　/　値
No.1の回答者さんも重くなる原因にはなりますが、簡単に変更できなかったり、変更したら目的にそわなくなったりしますよね。 遅くなる要因は、他にも多くあります。 > 関数を使ってるからですか？ 関数を使うとやはり重くなりますね。 特にDCount, DSum, ・・・などの定義域集計関数は重くなります。 インデックスを適切に設定すれば大幅に改善しますが、関数を使うとそのフィールドのインデックは使用されなくなります。 重くなる要因は他にもいろいろありますので、具体的にアドバイスを得るには、 現状のテーブルのフィールド構成、主キー設定、インデックス設定、 クエリの設計がどうなっいてるのか、などの情報が必要ですね。 クエリの設計の説明が難しければ、SQL文を提示していたければいいですね。
下記のようにイベントプロパティに "" を代入して、イベントとプロシージャの関連付けを解除してから実行してください。 .OnCurrent = "" .FilterOn .OnCurrent = "[イベント プロシージャ]"
> 言葉足らずですみません。 > 「T担当者マスタ」の「担当者名」と > 「T得意先マスタ」の「担当者名」をリレーションシップでリンクしています。 それは間違いですね。 それでは、参照整合性に「チェック」を入れることができないはずです。 主キーと外部キーをリンクさせる必要がありますので、 担当者コード 同士でリンクさせないとだめです。
[登録日]+[登録時] で最大するのが一番簡単だと思います。 （ちみなに、& で結合すると文字列になってしまうので、+ で連結した方がいいでしょう。） それ以外でとなると、逆に複雑になります。 例えば、 　ケースID：グループ化　（条件 100） 　登録日：最大 とういクエリで登録日の最大を求める。 元のテーブルと上記のクエリを登録日と登録日の最大で結合する。これを集計クエリにして、 登録時の最大を求める。 他にも、サブクエリを使うとか、DMax関数を使うとか、考えられますが、複雑になります。
SQLはこの手の処理は縦方向(?)に出力します select flag,sum(number) as sumNumber from test group by flag; しかし面倒ですが横方向に出せないこともありません select sum(number*(flag=4)) as sum4 ,sum(number*(flag=5)) as sum5 ,sum(number*(flag=6)) as sum6 ,sum(number*(flag=7)) as sum7 ,sum(number*(flag=8)) as sum8 ,sum(number*(flag=9)) as sum9 from test
　なぜ、アクセスは、インデックスの設定のデフォルトを「いいえ」にしたのかを考えましょう。やみくもに「はい」にすれば早くなるなら、デフォルトが「はい」になってそうなものですよね。 　そう。インデックスの使用は諸刃の剣です。正しく使えば、絶大なパフォーマンスを手に入れることが出来ます。が、闇雲にやると、かえってパフォーマンスが低下します。 　単純なパターンでは、検索は早くなりますが、その替わりに、データの更新・追加が遅くなります。 　また、インデックスは最初に作ればお終いではありません。メンテナンスも必要です。（ある程度自動でやってくれますが、これもシステムのパフォーマンスの低下要因になります。） 　さらにインデックスそのものにも格納領域が必要なので、データベースファイルが肥大化します。このデータベースファイルの肥大化に付随して、検索まで遅くなることもあります。 　 　基本的には、検索の条件に非常に良く使われるフィールド、フィールドのセットに対して、一つづつインデックスをＯＮにして、システム全体としてのパフォーマンスを確認する・・・という作業を地道にやるのが基本です。（ある程度、慣れてくれば、どの程度のフィールドにインデックスをつけるかは、ある程度経験で判断できるようになりますが、かなり慣れた人でも、複雑な要件になると、勘が狂うことも多々あります。）
"CREATE TABLE hoge (yobi char(5))" "INSERT INTO hoge VALUES ('土'),('日'),('月'),('木'),('水'),('火'),('金')" "select yobi from hoge order by case yobi when '日' then 1 when '月' then 2 when '火' then 3 when '水' then 4 when '木' then 5 when '金' then 6 when '土' then 7 end" こんなところでしょうか
１・ 追記する場合。 前もって前回回答の Set RS = DB.OpenRecordset("実際のテーブル名に", dbOpenSnapshot) を Set RS = DB.OpenRecordset("select * from 実際のテーブル名に order by メーカー名", dbOpenSnapshot) のように並び替えを指示してやる必要があります。 http://support.microsoft.com/kb/834927/ja または「実際のテーブル名」を出力したクエリで並び替え指定を 行っているのならテーブル名の代わりにクエリ名を指定します。 で一回目の出力をします。 二回目は前回回答の一部を修正して Sub xlS2() Dim oXL As Object Dim oBK As Object Dim oSH As Object Dim DB As DAO.Database 'ここでエラーになったら参照設定の変更を Dim RS As DAO.Recordset Dim i As Long, j As Long Set DB = CurrentDb Set RS = DB.OpenRecordset("select * from 実際のテーブル名 order by メーカー名", dbOpenSnapshot) 'か前述のようにクエリ名 Set oXL = CreateObject("Excel.Application") 'oXL.Visible = True Set oBK = oXL.Workbooks.Open("e:\123.xlsx") 'ここ Set oSH = oBK.sheets(1) 'For i = 1 To RS.Fields.Count 'フィールド名転記 'oSH.cells(1, i) = RS.Fields(i - 1).Name 'Next j = 3 'レコード転記は３行目から ’ここ Do Until RS.EOF For i = 1 To RS.Fields.Count oSH.cells(j, i) = RS.Fields(i - 1).Value Next RS.MoveNext j = j + 5 '空き間隔調整 Loop oBK.Close True 'ここ oXL.Quit Set oBK = Nothing: Set oXL = Nothing RS.Close: Set RS = Nothing End Sub です。 まとめて一気にというのでしたら、 直積とユニオンクエリで空白行を作っても 出来そうですが、すみません割愛させてください。
標準モジュールの場合ですがこんな感じで。 Sub xlS() Dim oXL As Object Dim oBK As Object Dim oSH As Object Dim DB As DAO.Database’ここでエラーになったら参照設定の変更を Dim RS As DAO.Recordset Dim i As Long, j As Long Set DB = CurrentDb Set RS = DB.OpenRecordset("実際のテーブル名に", dbOpenSnapshot) Set oXL = CreateObject("Excel.Application") 'oXL.Visible = True Set oBK = oXL.Workbooks.Add Set oSH = oBK.sheets(1) For i = 1 To RS.Fields.Count 'フィールド名転記 oSH.cells(1, i) = RS.Fields(i - 1).Name Next j = 2 'レコード転記は２行目から Do Until RS.EOF For i = 1 To RS.Fields.Count oSH.cells(j, i) = RS.Fields(i - 1).Value Next RS.MoveNext j = j + 5 '空き間隔調整 Loop oBK.SaveAs "e:\123.xlsx" '適宜変更を oXL.Quit Set oBK = Nothing: Set oXL = Nothing RS.Close: Set RS = Nothing End Sub
下記のコードでどうぞ。 Private Sub Form_Click() Docmd.OpenForm "フォームB", , , "ID=" & Me!ID End Sub
非常に幅広い選択肢があるので、どれが正解というものでもないと思います。それぞれ「自分はこれを選ぶ」というのが違いますので……。 私なら、クラウドサービス前提で設計しますね。Google App Engineならば、JavaまたはPythonが使えます（個人的にはJava推奨）。またHerokuではRuby（Rails）などがスタンダードですね。この「GAE + Java」または「Heroku + Ruby」のどちらかを利用して開発するでしょう。理由はいくつかあります。 ・費用がかからない。いずれも作って動かすだけならタダです。アクセスが急増し、割り当てリソースを増やさないといけなくなったらその分だけ費用を払えばいいだけで、個人での利用ならまず無料枠で十分でしょう。 ・管理が楽です。今どき、FTPでファイルをアップロードしているレンタルサーバーなどを見ると「いつの時代だよ」とか思ってしまいます。GAEやHerokuは専用の開発ツールで開発し、そのままデプロイできるので非常に効率がいいです。 ・データベースが無料で使えます。GAEは、非SQLデータベースなのでちょっと癖がありますが高速です。HerokuはPostgreSQLが標準で使えます。 ・GAEの場合、Googleアカウントでログイン管理が簡単に実装できるので、「自分以外がアクセス出来ないようにする」とかの実装が非常に楽です。 ・Webアプリケーションフレームワークの導入が楽です。GAEはSlim3というシンプルで快適なフレームワークがありますし、HerokuはRailsが標準で使えます。 ・情報が豊富。レンタルサーバーの場合、サイトごとに環境が違ったりしますので、ロリポップなど大手でない限りは情報が非常に限られてきます。HerokuやGAEは世界規模なので、英語でよければ山のように情報があります。 現在、サーバーサイド開発はどんどんクラウドサービスに移行している印象がありますので、今から勉強するのであれば、レンタルサーバーのようなものより、クラウドの利用を考えたほうが将来的にもいいんじゃないかと思います。あくまで個人的な意見ということで。
ご使用のヤマト送り状は単票なんですか。 だとしたら、詳細セクションの「改ページ」プロパティを「カレントセクションの後」に設定して、 さらに、プリンターの設定で、ユーザー定義用紙 でご使用の用紙のサイズを設定して、 その用紙を指定して印刷してください。
2007から仕様が変わりマウスホイールではレコード移動しないようになりました。 これは、レコードの編集中にうっかりホイールにふれてレコード移動してレコード保存されてしまうのを防ぐためです。 2007以降でマウスホイールでレコード移動できるようにする方法は、下記を参照してください。 マウス ホイールを使用しても、Access 2007 または Access 2010 フォーム内のレコードをスクロールすることはできません。 http://support.microsoft.com/kb/2458709/ja
keyを変数で単純に置き換えるだけだと sth = dbh.execute("select * from book where id = '#{key}';") で可能です。 active_recordにはSQLインジェクション対策できる構文がありますので、それを使う手もあります。 こちらではrailsでデータベースを作成、管理して、 active_recordを使ってRubyプログラムでデータベースにアクセスしています。 ご参考に
> ＞Set rs = CurrentDB.OpenRecordset(stSQL, dbOpenDynaset) > > やってみましたが、少しは改善されました。 > というのも、この「While～～Wend」間を通るのは３～７回位です。 > しかしこれを５３回呼び出しています。 特定のグループ（予約西暦年）だけでなく、テーブル全体を更新したいということでしょうか。 だとしたら、下記のようにすれば OpenRecordset 一回で済みますので高速化できます。 Dim jj As Long Dim atSQL As String Dim rs As DAO.Recordset Dim curDate As Date 　　stSQL = "SELECT * FROM 予約クエリ OREDER BY 予約西暦年, 計算" 　　Set rs = CurrentDB.OpenRecordset(stSQL, dbOpenDynaset) 　　Do Until rs.EOF 　　If curDate = rs!予約西暦年 Then 　　　　　　jj = jj + 1 　　　　Else 　　　　　　jj = 1 　　　　　　curDate = rs!予約西暦年 　　　　End If 　　　　rs.Edit 　　　　rs!順番 = jj 　　　　rs.Update 　　　　rs.MoveNext 　　Loop これで改善しないなら、 予約西暦年、計算 フィールドにインデックスを設定する。 計算 フィールドが、クエリ上の演算フィールドなら、その式を見直す。 ぐらいでしょうか。 また、全レコードを更新する必要があるかどうかの検討もしてみてはどうですか。 グループ内の更新したレコード以降だけ順番を振り直せばいいはずです。
私には、ここが解りやすかったです。 http://rfs.jp/sb/sql/s01/05-13.html 私としては、第２と第３の方が区別が付きにくい気がします。部分と推移の意味がつかみにくい。 SQL文操作に慣れてくると、分離した状態から考え始めるので、第３正規形となったtableの全てをjoin して第１正規化前へ戻すSQL文構築から逆算するとすこし理解が進むかも？ まず、第３正規化で分離した table は、 join `th3rd` on `main`.nonprimary = `th3rd`.primary となって本星の`main`テーブルと非プライマリーキーのフィールドで結びつきます 次に、第２正規化で分離した table は、 join `th2nd` on `main`.primaryX = `th2nd`.primary となって `main`テーブルとプライマリーキーのうちの１フィールドで結びつきます つまり、複合プライマリーキーがあるテーブルでないと、第２正規形が理解しにくいのだと思います。 最後に、第１正規化で分離したtable は、こちらのtableの方が全体を連結して、これまでの`main` テーブル側が、FOREIGN KEY の関係になります。 `the1st` join `main` on `the1st`.mainid = `main`.id join `the1stCategory` on `the1st`.Categoryid = `the1stCategory`.id
「ファイル」「共有設定」「FileMaker Server にアップロード...」選択「ホスト」一覧に表示するホストのタイプを選択・・・以下参考URL ＞現在クライアント(Fm13)の方で共有ファイルが見えません 「クライアントとしての共有ファイルの開き方」 http://www.filemaker.com/13help/ja/html/sharing_data.16.6.html#285850
演算で求められるものはテーブルのフィールドに設定しない のがAccessに限らずデータベースの基本です。 『テーブルの正規化』でGoogleってみてください。 正規化の例外としては、時間のかかる複雑な演算や膨大なレコード数 などで支障が発生する場合です。 テーブルにフィールドを設定せず、クエリで演算フィールドを設定し、 これをフォームのレコードソースとした方が良さそうなんですけどね。 >表記件　↓　で　上手くいった あなたのフォームでの『具体的な説明が無い』ので ご質問の回答は出来かねます。 もっとも、お勧めするのはクエリで演算フィールドを使う方法です。
SELECT * FROM xxxx WHERE tablename LIKE '%あいうえお%いうえ%' or tablename LIKE '%いうえ%あいうえお%' って感じでどう？
昔からよくある話ですね。 sinsouさんのお考えも分かります。 ところがです。 sinsouさんがその業務システムのメンテを最後まで担当するなら、それでもいいと思います。 しかし、仕事はいつ別な人が担当するか分からないですね。場合によってはsinsouさんが転職のため退社してしまうかもしれません。 ですから、会社ではいろんなリスク・ヘッジを考えるのです。別な担当者が急にその社内コードの変更作業をしなければならないとすれば、どこを直せばいいのか苦労しますね。最終的にソースコードの中に入っていたと分かるでしょうが、DBやテーブルに格納してあれば簡単に見つけられますね。 業務システムによっては40年位動いているものもあります。 次世代の担当者のためにDBなどに統一していた方がいいのではないでしょうか。
AccessやExcelのVBAと、VB2010はいろいろ違って大変ですね… 私も移植でいろいろ苦労しています。 さて、クエリを作成して発行する以外の方法は、絶対ダメですか？ クエリは、結局はSQLですから、データを選択してくるSELECTのＳＱＬの結果を元に、UPDATEのＳＱＬを制作して、接続しているデータベースに発行してはどうでしょうか？ -------------------- Dim sql_01 As String Dim sql_02 As String Dim com As OleDb.OleDbCommand Dim cn As OleDb.OleDbConnection = New OleDb.OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Database\ｘｘｘｘｘs.mdb") Cn.Open() sql_01 = "SELECT * FROM xren;" Dim command As System.Data.OleDb.OleDbCommand = Cn.CreateCommand command.CommandText = sql_01 Dim reader As System.Data.OleDb.OleDbDataReader = command.ExecuteReader() If reader.HasRows = True Then While reader.Read() sql_02 = "UPDATE [tb0] SET [avkei04] = " sql_02 = sql_02 & reader(1) sql_02 = sql_02 & " WHERE [ren_no] =" sql_02 = sql_02 & reader(0) sql_02 = ";" com = New OleDb.OleDbCommand(sql_02, Cn) com.ExecuteNonQuery() com.Dispose() End While Else ' レコードが取得できなかった時の処理 MessageBox.Show("レコードがありません") End If -------------------- SELECT * FROM xren; でいくつフィールドが返ってくるのか判らないので、とりあえず、IDともう一つしか返ってこない前提です。 reader(0)　reader(1)　は、SQLのフィールド番号になります。 ハズしているかもしれませんが、いかがでしょうか？
> ページ設定＞レイアウトタブ＞サイズ「高さ」 > この「高さ」に入力された数値を、ページ設定ウインドウを閉じた直後に取得する方法があればよいのですが。 Printer.ItemSizeHeight で取得できるようです。 Private Sub レポートヘッダー_Format(Cancel As Integer, FormatCount As Integer) Me.詳細.Height = Me.Printer.ItemSizeHeight End Sub これで、レウアウトの高さの設定が反映されるのを確認しました。 しかし、こんなことをしないと、反映されない設定ってなんなんでしょうね。（バグ？）
> 今までRecordsetプロパティにはテーブルあるいはSQL文を > セットしていましたが、ADOやDAOのレコードセットを使うことも > できるのですか。 テーブルあるいはSQL文をセットするのは、RecordSourceプロパティです。 レコードセットをセットするのは、RecordSetプロパティです。 下記のリンク先を参考にしてください。 ADO レコードセットにフォームを連結する方法 http://msdn.microsoft.com/ja-jp/library/ff835419.aspx ちょっと古いですが、Microsoft SQL Server への接続例があります。 [ACC2003] Microsoft Access フォームを ADO レコードセットに連結する方法 http://support.microsoft.com/kb/281998/ja
＞落とし所をを教えてください どこかITコンサルに効率化を依頼して、その箇所を指摘させるしかないですね あとは他力本願でだれかイキのいい若手が空気を読まずに「これじゃだめじゃん」って いったのを「検証する」体で上申するくらいですね 最悪評価がさがるのは生意気な若手社員です。 無駄だと思っていてもそれがルールならやるのが会社員ですし、 私なら火中のクリを拾いに行くことはしません
貼り付けが終って初めて切り取りが有効になります。 貼り付けをしなかったのだから切り取りはキャンセルされたことになります。
Set rpt2.Printer = rpt.Printer だけで内容が反映されるのが謎です・・・ こんな感じでも試してみてください。 Sub Test() Dim rpt As Report, rpt2 As Report On Error GoTo g001 Application.Echo False DoCmd.OpenReport "レポートA", acViewPreview DoCmd.OpenReport "レポートB", acViewDesign Set rpt = Reports("レポートA") Set rpt2 = Reports("レポートB") rpt2.Visible = False 'これがミソ rpt2.Printer = rpt.Printer 'rptで指定したプリンターを使う場合 'rpt2.UseDefaultPrinter = True 'OS既定のプリンターの場合 'この二行は必要に応じて。無くても可 With rpt2.Printer 'レポートの設定を逐一指定する必要があったような。 .TopMargin = rpt.Printer.TopMargin .BottomMargin = rpt.Printer.BottomMargin .LeftMargin = rpt.Printer.LeftMargin .RightMargin = rpt.Printer.RightMargin '中略 End With DoCmd.Close acReport, "レポートA", Save:=acSaveNo DoCmd.Close acReport, "レポートB", Save:=acSaveYes Set rpt = Nothing Set rpt2 = Nothing Application.Echo True Exit Sub g001: Application.Echo True If IsEmpty(rpt) = False Then Set rpt = Nothing If IsEmpty(rpt2) = False Then Set rpt2 = Nothing MsgBox err.Number & vbCrLf & err.Description End Sub
ここで質問しましょう。 http://joy-h.com/bbs2/viewforum.php?id=2
30万の予算があるなら、小さめな構成のWindows Server + SQL Server Express Edition とかでもいいのでは。 NASの代りに、Linuxサーバー+MySQL/PostgreSQLとか。
Access2013は持ち合わせていませんが Dim Rs As Dao.recordset Set Rs=Me.recordset ’または、Set Rs=Me.recordsetClone RS.MoveFirst i = 1 While (Not Rs.EOF) Rs.edit Rs("フィールド") = i i = i + 1 Rs.update Rs.MoveNext Wend だと？
> ためしにCdate関数を使ってみましたが 元のデータはテキスト型ということですか？ 日付型のまま、大小比較するのは危ないと思います。 (1)どうしてこういった現象がおきるのか。 「たぶん」程度ですが、日付表記の文化の違いかも。 日本では「年月日」の言葉通り、yyyymmddですよね。これは大小比較しやすい。 でも合衆国ではmm-dd-yyyyだし、他の英語圏ではdd-mmm-yy。 クエリに日付を#で囲んで記述する際に#14/03/2014#と書くようです（参考URL) なので > ?Deduction!To > 2014/02/13 は　14/02/13　→　2013/02/14と解釈されてるのかも。 if format(Deduction!To, "YYYY/MM/DD") > format(Contract!To, "YYYY/MM/DD)　Then みたいに明示したほうがトラブルにならないと思います。（処理速度が不利としても） バージョンによるのかも、とは思いますが １）ACCESSでタイムスタンプ目的で年月日時分秒を記録して ２）レコードコピーして、 ３）EXCELにペーストすると、dd-mmm-yyになる。 ４）それをEXCELでコピーして ５）ACCESSにペーストすると、yyとddが逆転する。 何度か痛い目に遭いました。
こんなのでもいいかな。 B1:=MIN(A1,40) C1:=A1-B1
　 CSVで保存すると書式などは保存されません。 だからCSVで保存するなら、貴方の希望を叶える事は不可能です。 excelのブックとして保存するしか方法はありません 　
　基本的には回答No.1様の方法に似た方法ではありますが、私の場合は、作業用シートの1行目に入力するシート名を間違えたり、将来的に作業人数を増やした場合における新たなシート名を記入するために、1行目が空欄の列を設けて置いたりした場合においても、エラーとはならない様にするために、次の様にします。 　まず、作業用シートのA1セルに「シート名」と入力して下さい。 　次に、作業用シートのB1～D1セルに各担当者シートのシート名を入力して下さい。 　次に、作業用シートのB2セルに次の関数を入力して下さい。 =IF(B$1="","",IF(ISERROR(1/(INDIRECT("'"&B$1&"'!A"&ROW())<>"")),"",ROW()+COLUMNS($B:B)*10000000)) 　次に、作業用シートのB2セルをコピーして、作業用シートのC2～D2の範囲に貼り付けて下さい。 　次に、作業用シートのB2～D2の範囲をコピーして、同じ列範囲の3行目以下に貼り付けて下さい。 　次に、集計シートのA4セルに次の関数を入力して下さい。 =IF(ROWS($4:4)>COUNT(作業用!$B:$D),"",INDEX(INDIRECT("'"&INDEX(作業用!$B$1:$D$1,INT(SMALL(作業用!$B:$D,ROWS($4:4))/10000000))&"'!A:C"),MOD(SMALL(作業用!$B:$D,ROWS($4:4)),10000000),COLUMNS($A:A))) 　次に、集計シートのA4セルをコピーして、集計シートのB4～D4の範囲に貼り付けて下さい。 　次に、集計シートのA4～D4の範囲をコピーして、同じ列範囲の5行目以下に貼り付けて下さい。 　以上です。 　因みに、 COLUMNS($B:B)*10000000 等の箇所において掛け合せる数を、何故100や1000等ではなく、10000000としているのかと申しますと、例えば掛け合せる数を100とした場合において、もしも、「ああ」シートの100行目よりも下の行、例えば102行目などの所にデータが入力されていますと、作業用シートの「ああ」の列の102行目の所には「202」(=102+100)と表示されてしまい、右隣の「いい」列の2行目に表示される「202」(=2+100)と区別がつかなくなります。 　一方、現行のExcelで使う事が出来る行数は、1048576行までですので、列数×10000000としておけば、万が一にも上記の様な事が起こる恐れは無くなるため、掛け合せる数を10000000としております。 　若しくは、10000000の代わりに ROWS(A:A) 等とするという方法もあります。
確認しました。確かに挙動が変ですね。 Access2010 と 2013 で同じ現象でした。 2007 と 2003 では一回のクリックでOKでした。 バグぽっいですね。 Application.FileDialog 以外の方法ならどうだろうかと、API を使う方法を試してみました。 Windows APIを用いてファイルを開く方法：SampleFile078 http://www.accessclub.jp/samplefile/samplefile_78.htm 2013で試してみました。だめでした。 ならば、WIZHOOK を使う方法はどうだろう。試してみました。1回のクリックでOKでした。 getFilePicker関数を下記のように書き換えてください。 Function getFilePicker(Optional dTitle As String = "ファイル選択") 　　Const ENABLE_WIZHOOK = 51488399 　　Const DISABLE_WIZHOOK = 0 　　Dim strFile　 As String 　　Dim intResult As Integer 　　WizHook.Key = ENABLE_WIZHOOK　　' WizHook 有効化 　　intResult = WizHook.GetFileName( _ 　　　　　　　　　　0, "", "dTitle", "", strFile, _ 　　　　　　　　　　CurrentProject.Path, _ 　　　　　　　　　　"Text Files(*.csv)|*.csv", _ 　　　　　　　　　　0, 0, 0, True _ 　　　　　　　　　　) 　　WizHook.Key = DISABLE_WIZHOOK　　' WizHook 無効化 　　getFilePicker = strFile End Function どうでしょうか。 WIZHOOK の詳細は下記参照 [ファイルを開く] ダイアログを表示する方法 | YU-TANG's MS-Access Discovery http://www.f3.dion.ne.jp/~element/msaccess/AcTipsGetFileName.html
以前に出力した伝票があると比較しやすいのですが 印字位置が僅かずつ縦に伸びて行っているとかかも？ 当方2010なのですが、2013でも下記のような問題があるのかもしれません。 http://d.hatena.ne.jp/keuko/20110614 あとは、プリンタードライバーの出来が良くない場合。 メーカーサイトに最新のドライバーがないか確認。
自分で無理なら、情報の分類学が確立するのを待ちましょう。 1日3万件ほどの新規統計、開発データ管理なら、人力では無理です。 自動ソフトを作りましょう。 ちなみに、現在は、統計学の考え方を間違っている人が多く、少ないデータで全体推測することが統計学であることを忘れてビッグデータが良い！とか勘違いしている人が多いようです。
はじめまして、通りすがるというものです。 パススルークエリの方法ですが、パススルーでググってみると、以下のｕｒｌが検出されました。 http://support.microsoft.com/kb/303968/ja これで、解決されるのでしょうか？ データ量が増えて、ｓｑｌserverに移行した。ということですが、今まで、クライアント側のアクセスを回線 を通して、ｄｂから抽出したデータをクライアントに送信する形式となったのでそのネックで当然 レスポンスは落ちると思います。 また、氏名検索にて同一名が複数存在した場合（データ量増大により）サーバーとクライアントとの データ量が増大しレスポンスが低下することが予想されるかと思います。 これらにより、パススルークエリによる（これはアクセス特有の機能？　）レスポンスの改善はあまり 効果ないと思います。 レスポンス向上の方法として氏名のみの検索条件だけでなく、たとえば住所とか、生年月日などの 複合条件で検索することを検討したほうがよいかと思います。 複合条件で抽出件数を絞ることにより、サーバーからクライアントへのデーター送信量を絞るため レスポンス向上を図れると思います。 これに合わせ、サーバー自体に付加がかかるのであれば、インデックスを追加するとかメモリ割り 当てなど、検討してはいかがでしょうか？
Runtime版を作ろうとしているのだろうと思います。 最初の一歩でつまずくかも？ http://infith.com/system/database/mysql_odbc_win7_64bit/ Access2010 の場合ですがファイルの拡張子を、accdr にすると Runtimeモードで起動できます。
ゴメン。 激しく勘違な回答のようです。 Access2003でPDF出力ですよね。Excel2010みたいに。 本家AcrobatやフリーウェアのBullZipPDFなどのPDF出力アプリを別途用意しないと 無理のように思います。
　まず、各「担当者のSheet」のシート名を、担当者名と同じ名称となる様にして下さい。 　次に、新しいシートを1枚設けて、そのシート名を 作業用 等として下さい。 　次に、作業用シートのA1セルからC1セルにかけて、各「担当者のSheet」の"シート名"を入力して下さい。 　次に、作業用シートのA2セルに次の様な関数を入力して下さい。 =IF(ISREF(INDIRECT("'"&A$1&"'!A1")),IF(IF(集計!$B$2="",集計!$B$3=A$1,AND(OR(集計!$B$3="",集計!$B$3=A$1),INDIRECT("'"&A$1&"'!A"&ROW())=集計!$B$2)),COLUMNS($A:A)*10000000+ROW(),""),"") 　次に、作業用シートのA2セルをコピーして、作業用シートのB2～C2の範囲に貼り付けて下さい。 　次に、作業用シートのA2～C2の範囲をコピーして、同じ列範囲の3行目以下に貼り付けて下さい。 　次に、集計シートのA7セルに次の様な関数を入力して下さい。 =IF(ROWS($7:7)>COUNT(作業用!$A:$C),"",IF(INDEX(INDIRECT("'"&INDEX(作業用!$A$1:$C$1,INT(SMALL(作業用!$A:$C,ROWS($7:7))/10000000))&"'!A:C"),MOD(SMALL(作業用!$A:$C,ROWS($7:7)),10000000),COLUMNS($A:A))="","",INDEX(INDIRECT("'"&INDEX(作業用!$A$1:$C$1,INT(SMALL(作業用!$A:$C,ROWS($7:7))/10000000))&"'!A:C"),MOD(SMALL(作業用!$A:$C,ROWS($7:7)),10000000),COLUMNS($A:A)))) 　次に、集計シートのA7セルをコピーして、集計シートのB7～C7の範囲に貼り付けて下さい。 　次に、集計シートのA7～C7の範囲をコピーして、同じ列範囲の8行目以下に貼り付けて下さい。 　以上で準備は完了で、後は集計シートのB2セルに工場名や担当者名を入力しますと、集計シートのA列～C列の7行目以下に、3人の担当者シートにあるデータの中で、該当する全てのデータが表示されます。
> レコードを新規追加するマクロです。 ならば、その新規追加のマクロで新規追加できなかったのか、キャンセルするような処理がされたことになりますね。 新規追加するマクロの内容を検討してみてください。 また、そのフォームで新規追加できる状態なのか、入力値にキー違反がないかなどチェックしてみてください。 そのマクロの具体的な内容が不明なのでこのような回答しかできないです。
> tbl家族（テーブル名） > 顧客NO > 家族名 > 誕生日 > 性別 本人に加え1名しか持てませんよ？ 枝番号持たせるとか
SQLサーバーにはユーザーばかりでなくグループも設定出来ます。SQL　Serverを扱えるグループを設定し、SQLサーバーに登録し、SQL　Serverを扱うユーザーにそのグループを設定すれば、個々にユーザーをSQL　Serverに登録する必要は無くなります。
フォームはレコードソースにそのテーブルを設定してあるのですか（連結フォーム）？ もし、そうなら、フォームと連結しているレコードセットはDAOレコードセットになります。 複数値フィールドの Value もDAOレコードセットになります。 下記のコードでカレントレコードの複数値フィールドにデータを追加できます。 Dim rs As DAO.Recordset With Me.Recordset 　　.Edit Set rs = !学歴.Value rs.AddNew rs!Value = "中卒" rs.Update .Update End With もし、すでに入力済みのデータを追加しようとするとエラーになりますので、 エラー処理を追加するか、FindFirstで値が存在するかどうかチェックする処理を追加してください。
＞;extension=php_sqlite.dll エラーは、上記行の先頭にコメントアウトがあるせいだとは思うけど、 sqlite_open関数群は、sqlite２用です、SQLite3のデータファイルは扱えません。 SQLite3　を利用するなら、PDO または、SQLite3 クラスしか有りません。
SQLiteには累積計算はないので、２つの同じ table を結合して、group 化という手順が必要だが、randam 順が同じ２つのテーブルを用意するには、temporary table を作る必要が有ると思う。 元のテーブルに primary keyカラム id が有るとして、以下の定義だとすると create table bungu ( id integer primary key not null ,name char ,nedan int ); create temporary table t_bungu as select id ,nedan from bungu b order by random ; -- 毎回作り直しすれば、毎回違う順になるので、temporary とする。 select id, name, nedan from bungu as a where id in ( select id from t_bungu c join ( select a._rowid_ , sum(nedan) as x from t_bungu a join t_bungu b on a._rowid_ >= b._rowid_ group by a._rowid_ having sum(nedan) > 1000 limit 1 ) d on d._rowid_ >= c._rowid_ ); -- _rowid_ は、t_bunguテーブルに挿入された順。SQLite は、primary key がなくても、これで、行の特定が可能 -- 多重サブクエリは問題なく実行できます。実行速度的にどうなのかは、未検証。何千行もあるとかでなければ、そう待たされはしないと思うけど。
ビルドボタンで生成されるコードを勝手に変えてはいけません。 Private Sub Form_Open(Cancel As Integer) Dim DB As DAO.Database Dim rs As DAO.Recordset Dim F As Form Set DB = CurrentDb Set F = Forms!カレンダA Set rs = DB.OpenRecordset("calen", dbOpenDynaset) End Function ただ、このコードは変数に値を代入しただけで、後は何もしていないので意味のないコードですね。 非連結フォームでカレンダー表示したいということでしょうかね。 だとしたら、まだまだ乗り越えなければならないハードルは多そうです。
あれからちょっと考えてみました。 テーブルからクエリを作成して、 「住所」フィールドの抽出条件を、 Like "*" & [TempVars]![mati] & "*" [世帯主] フィールドの抽出条件を、 Like "*" & [TempVars]![setai] & "*" ・・・・以下略 と設定してこれを元にフォームを作成します。 一時変数に値を代入した後、再クエリすればどうでしょうか。
文章が長くて理解し辛いですが・・・ ACCSESSにはインポートだけでなく、EXCELシートのリンクという方法もありますよ。 物理的にファイルをインポートせずとも、リンクするだけです。 KEYとなる情報が其々のシートやファイルにあれば、何ら難しい事でもありません。 VBAでプログラムを作成するほどでもありません。 的が外れていたら申し訳ないですが、文章を見る限り高度な技術は不要と思います。 ただACCSESSは難解といえば難解。 頭がいい悪いの問題ではありません、好きか嫌いかの問題です。
確かめたわけではないですが、下記の式だとどうでしょうか。 ｓｔｒSQL = "select 次回検査日 from 管理台帳クエリ where CDate(次回検査日) <= #" & txtDate & "#" あるいは、 ｓｔｒSQL = "select 次回検査日 from 管理台帳クエリ where 最終検査日 <= DateAdd("yyyy",-[検査周期], #" & txtDate & "#)"
>>これで動作させるとエラーになります。 エラーの内容を確認して、エラー原因を取り除いてやれば、うまくいくんじゃあないですか？
クエリを新規作成して、テーブル1 と テーブル2 を追加します。 デザインビューで下記のように設定 フィールド___商品名 テーブル_____テーブル1 抽出条件____Like "*" & [テーブル2].[除外キーワード] & "*" SQLビューでは、 SELECT テーブル1.* FROM テーブル1, テーブル2 WHERE テーブル1.商品名 Like "*" & [テーブル2].[除外キーワード] & "*";
これはですね。パススルークエリーではなくふつうのクエリーですよね。 この方式ですとデーターセットが使えないと一回でまとめて更新は無理です。つまりAccessではなくC#でSQLサーバーとAccsessを両方使うとかなら出来ます。 データーセットに読み込めばソースの形式は何でも構わないので。メモリ上に展開してメモリでリレーションを掛け更新もできます。 もしどうしてもAccessを使いたい場合は本当にパススルークエリをプロフラムでその都度作るしかありません。そのパススルークエリーを元にさらにふつうのテーブル作成クエリを作成しDoCmdなどで実行するしかありません。 まずパススルークエリを作成する前に、同じクエリは削除します。 　　Dim CAT As ADOX.Catalog On Error GoTo errc Set CAT = New ADOX.Catalog Set CMD = New ADODB.Command Deleteobj = True CAT.ActiveConnection = CurrentProject.Connection If CAT.Procedures.Count > 0 Then For Each i In CAT.Procedures If i.Name = クエリの名前 Then CAT.Procedures.Delete (i.Name) End If Next Exit Function End If そのあとに新しいSQLでパススルークエリのオブジェクトを作成します。 　　 qd.SQL = "SELECT * FROM MAINDATA WHERE((DATE>=" & str月初 & ") And (DATE<=" & str月末 & "))" Set CMD.ActiveConnection = CAT.ActiveConnection CMD.CommandText = qd.SQL CMD.ActiveConnection.Properties("Jet OLEDB:ODBC Command Time Out") = 0 CMD.Properties("Jet OLEDB:ODBC Pass-Through Statement") = True CMD.Properties _ ("Jet OLEDB:Pass Through Query Connect String") = _ "ODBC;DRIVER=SQL Server;SERVER=" & server ";DATABASE=" & database CAT.Procedures.Append クエリの名前, CMD CAT.Procedures.Refresh これでAccessにクエリオブジェクトが作成されています。 テーブル作成クエリは予め作成しておいても構いません。名前は同じなので。 この後にそのテーブル作成クエリを実行します。
記載のSQLをインラインビューにすればいいのではないでしょうか。 select * from ( select *,(select count(*)+1 from card as c where c.n < card.n) as idx from card ) where ...; という感じです。 参考までに http://ideone.com/uSQ3fe
>現在、ＤＢ移行（が可能かどうか）の第一段階目として、 >とりあえず１行（１レコード）を文字化け等なしで抽出する方法を模索しております。 私の説明が悪かったのかもしれませんが、レコードレイアウトがわからないとそれができないのです。 私のいうレコードレイアウトは何バイト目～何バイト目が商品コードとかいうものではなく 何バイト目～何バイト目が1バイト整数 何バイト目～何バイト目が2バイト整数 何バイト目～何バイト目が4バイト整数 何バイト目～何バイト目が4バイト浮動小数点 何バイト目～何バイト目が8バイト浮動小数点 何バイト目～何バイト目がテキスト など、そこが何の型のデータなのかです。 例えば2バイトで構成されたレコードがあり、そのうちの1レコードの16進ダンプが 30 31 だった場合、 1バイト整数が2つと見るなら 48,49 ですし 2バイト整数が1つと見るなら 12592(ビッグエンディアンなら12337) テキスト(ASCIIコード)と見るなら "01" など何の型のデータとして見るかによって得られるデータはまったく変わります。 これがわからない状態で「文字化け等なしで抽出」といったことができると思いますか？
デザインビューで、得意先コードをSELECTする条件のうち、下記の部分がうまく動いていないのだと思います。 誤：[T_得意先]![抽出フラグ]='True' 正：[T_得意先]![抽出フラグ]=0 ＃ちなみに、Trueは0、Falseは-1と同義です シングルクオートで括ってしまう('True')と、通常文字列として判断されてしまいます。 ただ、SQLビューで確認できるSQLでは、きちんとシングルクオートを外している(True)ようです。 さらに、上記SQLがエラーが出ている(型違いなど)訳でもなさそうなので、私の指摘の方向が誤っていることも考えられます。 一応、ご参考ということ、宜しくお願い致します。
> フィールド1はＩＤ番号です。 ということは、オートナンバという事を言いたかったのでしょうか オートナンバであれば、以下の SQL でいけると思います INSERT INTO テーブル名(フィールド2,フィールド3,フィールド4) SELECT フィールド2,フィールド3,フィールド4 FROM テーブル名 WHERE フィールド4='巨人'; オートナンバ、いやいや自分で採番・・・テーブルによってはいろいろあると思います いろいろ対応できるかな・・・　というものを作ってみました Public Sub fncRecCopy(sTable As String, sFld As String _ 　　　　　　　　　　, Optional bAn As Boolean = False _ 　　　　　　　　　　, Optional sWheres As String = "") というインターフェイスになるのですが、 使い方（指定方法）は、 sTable　：　テーブル名 sFld　：　フィールド名の列挙　（,）カンマ区切り 　　　　　先頭が採番するフィールド bAn　：　その先頭のフィールドがオートナンバなら True を指定（既定：False） sWheres　：　抽出条件以降の記述（既定：条件なし） Call fncRecCopy("テーブル名", "フィールド1,*", True, "フィールド4='巨人'") とすると、前述SQLでの処理と同じになります ※ 処理性能は、SQL一発の場合より遅くなります フィールド1 がオートナンバでなければ Call fncRecCopy("テーブル名", "フィールド1,*", False, "フィールド4='巨人'") とすれば、フィールド1 を採番します フィールド部分の列挙を "フィールド1,*" ↓ではなく "フィールド1,フィールド3,フィールド4" とした場合、指定されたフィールド部分しかコピーしません コピーするレコードの順が必要なら、条件以降に ORDER BY 記述します "フィールド4='巨人'" ↓例えば "フィールド4='巨人' ORDER BY フィールド1" ※ 汎用的にするには ・Where 指定と、 ・ORDER BY 指定は 分けた方が良いんでしょうけど 標準モジュールに記述して利用します Public Sub fncRecCopy(sTable As String, sFld As String _ 　　　　　　　　　　, Optional bAn As Boolean = False _ 　　　　　　　　　　, Optional sWheres As String = "") 　　Dim rs As New ADODB.Recordset 　　Dim rsC As ADODB.Recordset 　　Dim sSql As String 　　Dim i As Long, j As Long 　　Dim iM As Long 　　sSql = "SELECT " & sFld & " FROM " & sTable 　　If (Len(sWheres) > 0) Then 　　　　sSql = sSql & " WHERE " & sWheres 　　End If 　　sSql = sSql & ";" 　　If (Not bAn) Then iM = DMax(Split(sFld, ",")(0), sTable) 　　rs.Open sSql, CurrentProject.Connection, adOpenStatic, adLockOptimistic 　　Set rsC = rs.Clone 　　For i = 1 To rs.RecordCount 　　　　rsC.AddNew 　　　　For j = 1 To rs.Fields.Count - 1 　　　　　　rsC(j) = rs(j) 　　　　Next 　　　　If (Not bAn) Then 　　　　　　iM = iM + 1 　　　　　　rsC(0) = iM 　　　　End If 　　　　rsC.Update 　　　　rs.MoveNext 　　Next 　　rsC.Close 　　Set rsC = Nothing 　　rs.Close End Sub ※ エラー処理は入れてません ※ 不都合あれば、変更するとか・捨てるとかしてください エラーがあったら、エラー番号を返す様に Function にするとか・・・
＞結合するテーブル数が多すぎるのが問題なのだと思いますが、 ＞どのような方法がよいのでしょうか。 テーブル結合を、INNER JOINかLEFT JOINにする。 現状では「全部のテーブルが無条件結合」されるので、内部的に「総当りですべての組み合わせ」が内部的に作られてから、WHEREに一致しないレコードが除外されるので、たぶん、４GBのメモリがあっても足りないだろうと思われます。 「総当りですべての組み合わせを作った場合のレコード数」は「すべてのテーブルのレコード数を掛け算した数」です。 例えば、700レコードある基本のTBLに、50レコードあるテーブルを無条件に結合すると、内部的に700×50＝35000レコードのデータが生成されます。 もし、主テーブルが700レコード、各サブテーブルが100レコードあれば、主のTBLにTBL1～TBL10を無条件結合すると、700×100×100×100×100×100×100×100×100×100×100＝70000000000000000000000レコード生成されます。 １レコードに200バイト使用すると仮定すると、14000000000000000000000000バイト必要です。 自分が、どんだけ無謀な事をしようとしているか、理解した方が良いです。
INSERT文になって再度発行処理をすればいいだけです。 Dim cmd As New OleDbCommand( "INSERT INTO table1 (オペレータ名, ランク, 補足, パスワード) VALUES " & "(?, ?, ?, ?)", cn) cmd.Parameters.Add("ランク", OleDbType.Integer).Value = RANK cmd.Parameters.Add("パスワード", OleDbType.Char).Value = PWORD cmd.Parameters.Add("補足", OleDbType.Char).Value = HOSOKU cmd.Parameters.Add("オペレータ名", OleDbType.Char).Value = OPE cmd.ExecuteNonQuery() ところでcn.Open()の後にcmd.ExecuteNonQuery()が2回もありますが、1回で十分です。
AddNewする前の時点で、どのDBのどのテーブルに対して行うかをセットしていないためだと思います。 例えば、現在のDBの「T_追跡」テーブルをRSにセットする場合はこんな感じです。 Dim DB As DAO.Database Dim RS As DAO.Recordset Set DB = CurrentDb Set RS = DB.OpenRecordset("T_追跡") 参考URL： http://www.geocities.jp/cbc_vbnet/DAO/database.html この一番下のサンプルが参考になります。
GetDate = ">=#" & sDate & "# And <=#" & eDate & "#" と文字列を & で結合してますので、GetDate の返り値は文字列になります。 おそらく日付型のフィールドの抽出条件にこの関数を設定していると思われますので、当然「抽出条件でデータ型が一致しません。」とのエラーになります。 >=#2013/1/1# And <=#2014/1/1# というような式を返したいと期待しているのだと思いますが、 そもそも関数は値しか返すことはできません。 Public変数を使いたいのなら、 Public sDate As Date Public eDate As Date Public Function GetSDate() As Date GetSDate = sDate End Function Public Function GetEDate() As Date GetEDate = eDate End Function として、クエリの日付型フィールドの抽出条件の式を下記のようにします。 >= GetSDate And <= GetEDate
ですから、 ＞など設定がばらばらなのでQueryDefを使ってパラメータを ＞VBAで設定するならば、他の方への補足の内容をもとにすると、 ＞SQL文を、 として、補足にあるパラメータの宣言、 ＞PARAMETERS 納期1 DateTime; をはずしたクエリのSQL文を提案し、VBAでは、 ＞With qdf ＞.Parameters("納期") = Format(Forms![受注データ一覧]![納期], "yyyy/mm/dd") ＞Set rs = .OpenRecordset ＞.Close ＞End With のところで、 With qdf qdf.Parameters("XYZ") = CDate(Format(Forms![受注データ一覧]![納期], "@@@@/@@/@@")) Set rs = .OpenRecordset End With のように、Parameters("納期")　を　Parameters("XYZ")　のように パラメータが「納期」というようなフィールド名と同じになるのを 避けるために「XYZ」としているのですが・・・。パラメータと フィールド名を同じにするとエラーが出るのでこのようにしています。 補足にある、 ＞フォームからyyyy/mm/ddの書式で日付を指定し該当する ＞レコードをクエリで抽出します。 ということは、フォームではテキストボックスの書式が 日付型に設定してあると、いうことだと解釈します。したがって、 VBAでは、 .Parameters("XYZ") = Forms![受注データ抽出]![date1] とします。 ＞上記記述で ＞実行時エラー3061 ＞パラメーターが少なすぎます。2を指定してください。 ＞エラーが発生します。 これは、補足にある書き変えたVBAの中で、 ＞With qdf ＞.Parameters("納期1") = Forms![受注データ抽出]![date1] ＞Set rs = db.OpenRecordset("確定クエリ", dbOpenDynaset) ＞End With のところで、 db.OpenRecordset としているために、「確定クエリ」をパラメータを指定せずに レコードセットとして接続しようとしているためにエラーが エラーがでるのです。したがって、ここのところは、もともとの 設定のようにQueryDefを使って、 With qdf .Parameters([XYZ]) = Forms![受注データ抽出]![date1] Set rs = .OpenRecordset("確定クエリ") End With とします。ようするに、 Set rs = qdf.OpenRecordset("確定クエリ") ということです。 以上より、クエリの「納期1」の抽出条件に「[XYZ]」 (XYZではなく、[XYZ]です）と記入し、 そのクエリのSQL文は、 SELECT 確定.注文番号, 確定.注文年月日, 確定.発注者品名コード, 確定.[品名(品名仕様)], 確定.[注文数量(受注数量)], 社内データ.SNP, 確定.単位, 確定.納期1, 確定.納入No1, 確定.納品キー番号1, 確定.受渡場所名, 確定.発注者用備考, 確定.発注者名, Int([納入指示数量1]/[SNP]+0.5) AS 印刷枚数 FROM 確定 LEFT JOIN 社内データ ON 確定.発注者品名コード = 社内データ.得意先品目コード WHERE (((確定.納期1)=[XYZ])); VBAは、 Private Sub コマンド23_Click() Dim db As DAO.Database Dim rs As DAO.Recordset Dim qdf As DAO.QueryDef Set db = CurrentDb Set qdf = db.QueryDefs("確定クエリ") With qdf .Parameters("XYZ") = Forms![受注データ抽出]![date1] Set rs = .OpenRecordset End With MsgBox rs![注文番号] qdf.Close: Set qdf = Nothing rs.Close: Set rs = Nothing db.Close: Set db = Nothing End Sub
ページヘッダーは必ずページの最上部になりますので無理ですね。 現在の決済月グループの下に、さらに決済月のグループを追加して、そこにページヘッダーの項目を配置します。 「セクション繰り返し」プロパティを「はい」にします。 これで毎ページ出力されますので、ページヘッダーの代用になります。
そう思うのなら、改行コードを調べてはどうでしょうか? MacOSのバージョンが記載されていませんが、 OS9以前のMacでは、標準の改行コードはCR でした。 OSXになってから、UNIXベースになり、標準の改行コードは LF です。 特に、ターミナルから入力するようなコマンドは、UNIXベースのコマンドであり、LFを改行コードとするものがほとんどです。(一部に自動判別するものや、オプションで指定できるものなどがあります) 一部アプリケーションで、OS9以前のMac用の意味で、「改行コード: CR(Mac)」等となっているものがあります。 もし、in.txt を保存するときに「CR」を選んでいるのなら、それを「LF」にしてください。
>Webでの公開設定してましたが、解除できません。 共有設定のインスタントWeb公開をオフにするだけ。
PSV という拡張子というか、パイプ｜で区切るのを初めて知りました。 根本的なのはファイルを作成している方で対応してもらうのが一番でしょうけど、 多分、無理な相談だと思われますので、 VBA でファイルをリネームしてインポートする処理を作るくらいではないですかね。 Excelだと柔軟に読み込めますが、Access は頑固一徹です。 >インデックスが有効範囲にありません"のエラーになるとき 既存のテーブルに追加インポートなら フィールドのインデックスが、「はい重複なし」に設定されている場合が Google とありますね。
デフォルト16回で設定されているようです。 回数を変更するにはレジストリをいじる必要あるので気をつけてください。
質問日時がだいぶ前なので既に解決されているかもしれませんが・・・ VBAを使う方法になってしまいますが、 コンボボックス名は仮に「コンボ0」とし、以下のような感じでどうでしょうか。 （コンボボックスの変更時イベントあたりに埋め込むのが良いかと思います） Private Sub コンボ0_Change() Dim db As DAO.Database Dim rs As DAO.Recordset Dim tbsql As String Dim xlapp As Object Dim xlbook As Object Dim i As Long '抽出条件の設定 tbsql = "select * from テーブル名 where [部署名] ='" & コンボ0.Value & "';" Set db = CurrentDb Set rs = db.OpenRecordset(tbsql) 'エクセルを起動 Set xlapp = CreateObject("excel.application") xlapp.Visible = True xlapp.ScreenUpdating = False '新規ブックを追加し、抽出した内容を出力 Set xlbook = xlapp.Workbooks.Add With xlbook For i = 0 To rs.Fields.Count - 1 '1行目にフィールド名を出力 .Sheets(1).Cells(1, i + 1) = rs.Fields(i).Name Next .Sheets(1).range("A2").CopyFromRecordset rs 'A2セル以降にデータを出力 .Sheets(1).Name = コンボ0.Value 'Sheet1の名前を変更 .Sheets(2).Delete 'Sheet2を削除（このあたりは不要な処理なら削って下さい） .Sheets(3).Delete 'Sheet3を削除 End With 'コンボボックスの値をファイル名とし保存 xlbook.SaveAs "c:\フォルダ名\" & コンボ0.Value & ".xls" xlapp.ScreenUpdating = True rs.Close db.Close End Sub
人気といえば最近では、Redisですかね。 Redisはレプリカやその運用を考えると様々な機能が充実しており、 無料だし非常に使いやすいです。 商用の様々なシステムのフロントシステムに使用されています。 ただやはり基幹系には活用は難しく、 複雑なクエリは投げることはできません。 ECサイトや、コンテンツ系WEBサイトで、 非常に多くのエンドユーザ向けシステムに向いているといえます。 NoSQL自体は、RDBMSと比べて更新性能が非常によいです。 なので、顧客情報はRDBMS、更新系の多い揮発型データは NoSQLでといった使い方をしたりします、
Nameでリレーションしているのですよね。 ポータルの行数も表示させたい画像の数分（10個）作ってますか。 チェックボックスなので、チェックした順にポータルに画像が表示されることになります。 リレーションは完全一致限定なので両テーブルのNameの内容も全く同一である必要もあります。
プリントアウトの体裁はレポートでグループ化を行えば実現できそうです。 http://office.microsoft.com/ja-jp/access-help/HA010006894.aspx 商品単価が頻繁に変化するのなら、T_注文履歴に加えてしまった方が『楽』はできます。 （「テーブルの正規化」に反しますけど） 部署間・チーム間で人員のトレードが行われると 前年対比などの場合に今年の構成で前年も比較するのか、前年は前年の構成で行うのか、 も問題になりそう。
可能ですが、先頭32文字と末尾20文字を切り捨てるからには、 元のデータは必ず52文字以上あるんですかね？ UPDATE [A表] SET [A表].F1 = iif( len([F1]) > 52, mid([F1], 33, len([F1]) - 32 - 20), ''); F1列が52字を越えていれば途中を切り出し、52文字以下なら空文字をセットします。 ELSE部分は適宜変更してください。
No2のIf文はこの形ではなく、単に Private Sub 修正_Click() CopyRec MsgBox("修正が完了しました。フォームを閉じます。") DoCmd.Close acForm, Me.Name End Sub のように、コードを羅列しても同じなので どちらでもいいです。 一応、No1とNo2はIf文を使った例です、ということに します。
そこまでできていれば悩むこと無いと思うのですが ボタンの表記をvbaで書き換え、開始ボタンの時に public変数に時間を記録+ボタンの表記を停止に変更 ボタン表記が停止の時はpublic変数の時間と現在時刻から経過時間算出とか色々方法があると思います
SQLite環境ないため無試験ですが。 構文は参考URLを参照 かんたんに書いておくと update テーブル名 set 更新列名 = 更新内容 [where条件]; ですよ set 更新列名 = 更新内容は は set keyword = keyword || 'あああ' と書ける。等式ではなく代入なのでA=A+1と同じ でも追加したいキーワードが　"本" のとき keywordが '本社 料理' だったり　'貸本 ブック cooking book'だったら "本" を追加するんですよね？ なのでキーワードを区切る半角スペースを含め判断が必要。 where条件で like検索してNotで否定。つまり含まれないなら更新対象。 Keywordには先頭に、追加文字列は前後に半角スペース補ってから判断。 update テーブル名 set keyword = keyword || ' ' || 追加キーワード where (' ' || keyword || ' ') not like (' ' || 追加キーワード || ' ') ; かな
UPDATE tableA SET tableA.name = ( SELECT tableB.name FROM tableB WHERE tableA.id = tableB.id ) WHERE EXISTS ( SELECT tableB.name FROM tableB WHERE tableA.id = tableB.id )
正直、書いてあることからどういうデザインなのか今ひとつピンときません。 普通、ロックによる性能劣化の解消方法はロックの粒度を細粒度にするか、ロックフリーアルゴリズムの採用だと思いますが、提案されている方法はどちらでもないように思います。 > DBに書き込み前にロック用ファイルをファイルロックをし、書き込みが終わったらロックを解除する、という感じです。 というデザインにしたことでどうして現状より良くなるんでしょうか？ これはSQLiteがロックしてくれていたところを自分でやっただけで、本質的に現状と変わらないと思います。むしろ、自分の実装ミスによってロックがされず、にデータの消失や不整合を招くリスクのほうが高いのではないでしょうか。 いや、RESERVEDやPENDINGといったSQLite3のロック状態を使えない分だけ、それをちゃんと使って書いたコードよりも、ロックの粒度は粗くなっているので、トータルでの性能は落ちそうです。 質問者が言うところのロックファイルを使う実装というのは、要はすべてEXCLUSIVEにするということですよね？ ちなみに、 http://www.sqlite.org/lockingv3.html によると、SQLite3からはPENDING状態があることでリードの多発によってEXCLUSIVEロックが取れない状態というのは解消されたそうです。 > その他に、メインのDBに書き込みできるのはマスターのPHPだけにして、ユーザーは一切書き込みできないようにする、という方法です。 ロックを取る話と今ひとつつながって見えませんが、普通に考えていくつも問題が思い浮かびます。 1. DBの内容の不整合 2. スレーブ？によって新規作成されたDBファイル名の競合 3. スレーブ？によって新規作成されたDBが書き込み中であったことによるマスターの待ち 4. スレーブ？によって新規作成されたDBファイルによるディスク領域の圧迫 1についてですが、例えば、持っている商品の数に整合性がないわけですから、ヘタしたら自分が持っている数以上に商品を出してしまいますよね。商品数が1個で、ユーザーAもユーザーBもそれを使えると思って確保したら、マスターが突き合わせをした時に不足しているとわかると。 あるいは、新規商品の追加だけしかしないとしたら、同一商品の追加があった時に微妙に内容が違っていたことでエントリーが複数できたりしませんか？また、登録したものがマスターが処理を終えるまで見られないという状況になるとも思います。 2について、被らないようにファイル名をつけないと、先の入力を後の入力で上書きしそうです。あるいは、マスターによるDBの削除でデータがあるファイルを削除しそうです。 3について、1分ごとにマスターのデータベースを止めてひたすらアップデートをするので、スレーブ？が作ったファイルが著しく多かったり、スレーブ？が自分が書いているDBのロックを取ったまま帰らないことが多かったりすると、その間マスターを使えないということになりませんか？ 4について、それぞれのスレーブがDBファイルを作るとなると、書き込みが増えれば増えるほどファイルのオーバーヘッドの部分によるディスク領域の圧迫もありそうです。 > しかし同時書き込みでデータベースがロックしてしまうSQLiteの仕様では複数人数での運用ができません。 一応確認ですが、書き込みにはちゃんとトランザクションを使っていますよね。使うのと使わないのとでは雲泥の性能差がSQLite2のころからあるようですが。 http://www.sqlite.org/speed.html あと、釈迦に説法だと思うのですが、インデックスをちゃんと設定してquery planも確認してますよね。 http://www.sqlite.org/eqp.html http://www.sqlite.org/queryplanner.html それでだめならMySQLの採用もやむなしだと思うのですが。 自分だったらSQLite3でちゃんと性能が出るように実装してみて、ダメだったらもっと細かい粒度でロックが取れるRDBMSを採用するというアプローチを取るでしょう。 #1さんと同じく、ロック機構を自分で実装するというのは、リスクが高すぎてやりたくないです。
カラムに check 制約付けるとかで対処できるかな。 codeカラムが空文字列になってる行を削除してから、alter table文を発行して下さい。check 制約に引っかかる行が既にあると、変更できませんので。 alter table `tablename` modify `code` varchar(255) NOT null primary key default NULL check( code <> '' );
Accessは2007からmdbに替わりaccdbという形式のデータベースファイルを使うようになった・・・・が、肥大化も最適化に関する状況は全く変わっていない。 なので止められないシステムの場合肥大化は防げないと思う。mdbよりかは多少マシになったと期待するくらい？ と、ここまでが本題で以下、あなたの質問内容で何か参考になればというような駄文だが。 > ODBCではAccessくらいだと思っています これは、あなたが作るプログラムからODBCを用いてmdbファイル内のテーブルを操作するという意味だよね？ それなら普通にMicrosoft SQL Server 2012 Express Editionでも使っておけば良いと思うのだが・・・・。 そもそもODBCはDBを特定せずにDB操作を行うために作られた仕様なので、SQLの方言を除けばDBを運用途中で挿げ替えても問題ない。 あるプログラムがODBCでmdb内のテーブルを操作する時、Accessの機能は一切使っていない。mdbやaccdbはテーブルもプログラムも一つのファイル内に入れるので誤解されがちだが、Accessというのはテーブルなどのデータストアのみの機能ではないし、DBを操作するフロントエンドフォームのみでもない。その両方があって初めてAccessだ。かつ、その2つの機能は独立している。つまり、今回あなたがやろうとしていると思われる、単なるデータストアとしてのみ使う事もできるし（この場合Accessはインストールされてなくても良い）、テーブルは一つもなくフォームだけ作ってDBはMicrosoft SQL Serverなど他のDBを見に行くという事もできる。 あなたが開発しようとしているシステムの開発言語が例えばMicrosoft .Net Frameworkなら、ODBCじゃなくてADO.NETを用いてどこかのDBMSに接続する方が良いのではないかな。 ODBCしか使えないというのは純粋なC言語での開発で最小限のライブラリしか使えないような状況しか思いつかない。 餅は餅屋、AccessはMicrosoft自身が「パーソナルなシステムに使うもの」と言っているし、別のDBを使う方法を模索した方が良いのではないだろうか。 開発言語や使ってる開発環境が分かれば「DBはこうして接続はこうするのがお勧め」とかそういう回答も出やすいと思いますです。
　データベースを取り扱う時に、良くある誤解の一つのせいです。 　データベースのテーブルをファイルと同じように考えると、このようなミスをやります。 　ファイルの場合は、いったん書き込みをしたら、変更しない限りは、レコードの順番が変わったりすることはありません。何度開き直しても、常に同じ順番で同じデータを返すことが保証されています。ですから、レコード番号の意味があります。 　データベースのテーブルの場合は、テーブルに入れたデータは、単なる集合です。ここで集合という用語を使うのは、このレコード群には、「順番」がないんです。ですから、データの書き換えをしなくても、前に見た時と、今回見た時には、データの順番が違うことがあります。順番を保証しないので、たとえ、画面で見た時に、同じ順番で返してくれているように「見えても」、前提としては、今回のレコードセットと前回のレコードセットでは順番が変わると考えてプログラムは組まなければなりません。 　今回の場合は、手順の１・２・３で、当然、レコードセットは開き直しているはずです。この３回のレコードセットでのレコードの順番は、全部違います。（偶然、同じような順番になることもありますが、あくまで偶然です。偶然の比率は実は結構高いんですけどね。） 　ここで、ＭＳＤＮから、AbsolutePositionの説明の一部を引用します。 ＞AbsolutePosition プロパティを使うと、Recordset オブジェクト内の位置に基づいて特定のレコードに移動したり、カレント レコードの位置を決定することができます。 　この説明通り、Recordsetの位置を決定するものなんです。たとえ、同じテーブルから同じ方法で生成したRecordsetでも、それは、違うレコードセットであり、AbsolutePositionの値を共用することはできません。 　これは、次の説明にあります。 ＞注意 AbsolutePosition プロパティで、レコード番号の代用はできません。レコードの位置は、上位のレコードを削除すると変更されます。また、Recordset オブジェクトを再びクエリしたり開いたときに、レコードが AbsolutePosition の値と同じになるとは限りません。所定の位置を保持し、そして戻るにはブックマークを使います。ブックマークは、すべての型の Recordset オブジェクト間で位置を決定できる唯一の方法です。 　はっきり書いてありますね。レコード番号の代用は出来ません。 　ちなみに、acsessの場合は、ここにも書いてあるようにブックマークをこのかわりに使うことが出来ます。が、これも実は、結構使いでが制約されます。 　データベースを取り扱う時に、レコードの順番が意味を持つ場合は、クエリで明確に順序を指定します。（そのための句がorder by句です。） 　そして、レコードを特定する時には、常に、主キーを使用します。レコードセットから、特定の行を特定する場合は、主キーの値を基本として、findメソッドでカーソルを移動することになります。 　ソート順をちゃんと指定した場合でも、テーブルの更新によりレコードの順位が変わりますから、ソート順を指定してAbsolutePositionの値をレコード番号として使うという手法はやめた方が良いです。
まず、「元データ」から「区分」以外のフィールドの選択クエリを作ります。 ツールバーの「Σ」ボタンをクリックし、集計行を表示します。 「社員コード」「日付」を　グループ化。 「勤務時間」から「訪問のカウント」までは 合計。 「開始時間」を 最小。 必要なら、フィールド名を変更。 以上です。
>このようなものが２0個程あり、年度が変わるごとに全ての値を入力し直しています。 >（年度・西暦・配付率などその年の数値） これのデータを何に使用するのですか？レポートなど？ >そこで”年度”を主キーにしたテーブルを作成し、そこに他の項目（西暦・配付率など）の >フィールド（２０個）を設定し、そのデータを利用できないかと考えています。 これだと、データとして何にも使えますが、用途は？
SQLiteでは、insert or replace しかないけど select文からの入力とサブクエリは使えるから replace into [table_name] (n,c1,c2,c3) select x.n, org.c1, x.c2, org.c3 from (select 1 as n, 1 as c2 ) as x left join [table_name] as org on x.n=org.n ; n がprimary key または uniqueの前提で１行書き換えまたは、新規挿入。
　単純に、Firebirdへの接続エラーを例外でトラップして、例外処理の一環として３０秒の待機後、もう一度リトライしてみればどうでしょうか？
(1)とは別に、(2)のデータを作るためのクロス集計クエリーを作成し、二つを社員コード、日付でリンクし、それぞれをフィールドを結合させます。この時、クロス集計クエリーは、＊で全フィールを追加します。これは、クロス集計で作成されるフィールドはその都度変化するので、フィールド名を特定できない事への対応です。 以下に具体的に書いてみます。 先ず(2)に必要なデータを求めるクエリーとして、社員コード、日付、訪問名：[区分] & ([Gコード]-1),業務時間: DateDeff("n",[開始時間],[終了時間])として、区分＝"訪問"だけを選択し、下記データのダイナセットを作成します。 社員コード| 日付 |訪問名|業務時間 ==================================== |1111111 |2013/10/01　|訪問1 |　20 |1111111 |2013/10/01　|訪問2 |　240 |2222222 |2013/10/01　|訪問1 |　60 |2222222 |2013/10/01　|訪問2 |　30 次にこのクエリーを元に、行見出し：社員コード、日付、列見出し：訪問名、集計値：業務時間としたクロス集計を行います。この結果として、下記データのダイナセットが作成されます。 社員コード| 日付 |訪問1|訪問2 ==================================== |1111111 |2013/10/01　|20 |　240 |2222222 |2013/10/01　|60 |　30 (1)の集計クエリーと上記クロス集計クエリーを社員コード、日付で連結し、(1)から社員コード、日付を除くフィールド、クロス集計からは＊を使って全フィールドを追加、結合したクエリーを作成すれば、目的の結果が得られます。確認して下さい。社員フィールド、日付フィールドの位置が中程になってしまいますが、訪問数がその都度変化することに対応するとこうなります。不明点があれば補足ください。
>特定の作業（レイアウトモードに切り替える等）をすると、 >タブ1の表示にもどってしまいます。 無理です。タブコンではなく別レイアウトにした方がまだいいかも。
もっとも肝腎なところが抜けています。 リモートマシンからどのような方法で、MySQLサーバーのあるマシンへ接続するのでしょうか？ とはいえ、第１にMySQLサーバー自体では、リモートにあるファイルは直接は読めません。 load data local infile文は、クライアントとなるアプリを通してそのファイルとSQL文とを送り込むから読めているだけです。 第２にクライアントは、何を使うのでしょうか？ mysqlクライアントツールが、リモートマシン側にあって、そこからログインするとしても、mysqlクライアントツールも、sql文を書いたテキストファイルを読んで実行することは出来ても、入力中のSQL文に、外部ファイルからのデータは取り込めません。 しかし、「特定のテキスト」自体をSQL文全文にしてしまえば、SQLスクリプトファイルとして読んで、実行することが出来ます。 http://dev.mysql.com/doc/refman/5.1/ja/batch-commands.html または、クライアント側のバッチファイルなり、シェルスクリプトなり、または、phpやperlなりで、そのテキストを読みとったうえで、SQL文全文を作成するプログラムを書けばよいでしょう。
#1の方と書き方が違うだけですが、 SELECT * FROM テーブル名 WHERE SUBSTR(chk_open_date_time,1,4) || SUBSTR(chk_open_date_time,6,2) || SUBSTR(chk_open_date_time,9,2) = '20131115' 後、カラムの型がもしDATE型の場合、TO_CHARでフォーマットしてみる SELECT * FROM テーブル名 WHERE TO_CHAR(chk_open_date_time, 'YYYYMMDD') = '20131115'
(1)SUBSTRで必要部分を取り出して検索する SELECT * FROM テーブル名 WHERE SUBSTR(chk_open_date_time,1,10) = '2013-11-15' SUBSTR(文字列(カラム名), 開始位置, 文字数)で必要部分を取り出して検索条件つ使用する (2)LIKEで前方一致 SELECT * FROM テーブル名 WHERE chk_open_date_time LIKE '2013-11-15%' LIKEで指定日付で始まるものを条件とする
ANO.1,2です。 >繰り返し、エクセルファイルを作成する試験を行ったところ、オブジェクト変数のclose処理を行ったのに改善されませんでした。 とは、私も意外でした。 なにか他に悪さをしている処理があるのでしょうけど、 ちょっと見当がつかないです。 ただ、最後に１個だけ、 ・・・ XLWS.Select With ActiveSheet.PageSetup ・・・ With XLWS.PageSetup に変えても動いたと思うのですが、 これでやってみてもだめでしょうか？ （ 例えばExcel自体が２個立ち上がっていると With ActiveSheet.PageSetup とすると、どちらのExcel？ってことになるように思われますので。 ）
やったことはないけど、間にリンクテーブルだけのmdbを置くことは、パフォーマンス向上にはつながらないと思う。　これまたやったことないけど、パフォーマンスがあがる可能性としてはリレーションを組まないでよいテーブルは別のサーバに置くことじゃないかな？　同じＰＣに複数ＭＤＢをおいても意味はないと思う。（テーブルを結合させたＳＱＬを発行する場合は、テーブル同士が別サーバーにあるとローカル処理になるので、これは避けたいところ） 一般的な流れとしては、 ・ｄｂはなるべく一つとしておいたほうが、管理が簡単。　（スケールが小さい場合はサーバーを分散させるより、機能を高めたほうが費用がかからないことが多い。） ・パフォーマンスを向上させるには、ハードウエア（サーバー・クライアント）、ＤＢシステム、ネットワーク、データベースの正しい設計を行なう、などなど。　これらは、ユーザー数やトランズアクション数をあらかじめ想定した上で、どれだけ費用をかけてどのようなものを作るか考えるべき。 ・ＤＢは定期的にメンテナンスを行なう。　（アクセスだと、レコードの削除がある場合は最適化など） ・アクセスはユーザー数とトランズアクション数によっては、時々変なことが起きるので、データベース部分は早めに他のＤＢに切り替える。（簡単にＳＱＬサーバとかにアップスケールできたと思う。）
前回の回答を転載しておきます。 > SELECT [mの全てのフィールドの列挙] > FROM Archive_Sample m JOIN Archive_Order o > 　　　　ON m.ArchiveID=o.ArchiveID AND m.Order_Sampleid=o.Order_SampleID > WHERE UPPER(o.Order_PatientID) LIKE '%234%' SELECTの後ろにDISTINCTをつけてください。
SELECT [mの全てのフィールドの列挙] FROM Archive_Sample m JOIN Archive_Order o 　　　　ON m.ArchiveID=o.ArchiveID AND m.Order_Sampleid=o.Order_SampleID WHERE UPPER(o.Order_PatientID) LIKE '%234%' ですね。where条件のフィールド間違ってました。
音楽管理ソフトは何をお使いですか？ ソフトによっては、ライブラリ中の楽曲の情報をCSV形式などで書き出せるものもありますけど。 当方が使用のMediaMonkeyですと、標準で選択ファイル群の情報をCSV形式やExcel形式で書き出せます。項目は固定で、アーティスト、タイトル、アルバム、長さ、録音年、ジャンル、評価、ビットレート、パス（CSVの場合）。 更に、CustomReportという追加スクリプトを入れれば、ソフトが管理してる情報のほとんどすべてから任意に出力項目を選んでCSV形式やExcel形式で書き出しも可能。 http://mediamonkey.xn--m8jfw.jp/index.php?%A5%B9%A5%AF%A5%EA%A5%D7%A5%C8#zc56b73f タグエディタのMP3Tagでも上記と同様のことが出来ますね。 また、表計算ライクなタグエディタのSTEP、STEP_Mとかですと、セルを選択して直接Excelとの間でコピペ出来ます。 一旦Excelに読み込ませることが出来れば、後は如何ようにも出来ますよね。
> Application.Forms![フォームB].Controls![担当者名] = "担当A" ここでエラーになるということですか。 その行とDo ... Loop を削除して、 フォームB の開くときか読み込み時に、 Me.Controls![担当者名] = "担当A" とするのではだめですか。 "担当A"という値をフォームAの方で決めたいということなら、 DoCmd.OpenForm "フォームB", OpenArgs:="担当A" として、フォームB の開くときか読み込み時に、 Me.Controls![担当者名] = Me.OpenArgs
クエリを新規作成して、ユニオンクエリを追加して、テーブル作成クエリにすればいいだけです。 SQLで記述するなら、下記のようにサブクエリを使います。 SELECT * INTO Tbl_C FROM (SELECT Tbl_A.* FROM Tbl_A UNION ALL SELECT Tbl_B.* FROM Tbl_B) AS T;
補足です。 私のところではできなかった(権限が無かった)のですが、もし新規作成で雛形の中の掲示板を利用できるのなら、それで新規掲示板をローカルに作成し、それにサイズフィールドを追加して、既存の掲示板から文書をコピーしたほうが早いと思われます。 システム部門がなかなか動いてくれないのは、部門ごとの掲示板とかでしたら、部門ごとに仕様が違うものを作成していると管理がやりにくく面倒になるのと、一度でもどこかの部門の仕様変更に応じると、他の部門からの注文にも応じないといけなくなり、きりが無くなるので渋っている可能性がありますね。また、部門ごとにIT管理者がいるのでしたら、単にめんどくさいなぁと思ってるだけかもしれません。
画像のデータからという意味では無理ですね。 画像にURLなどは記録されていません。 Googleの画像で検索する機能で同じ画像のあるサイトを発見することはできるかもしれません。 http://www.google.co.jp/insidesearch/searchbyimage.html
SQL Serverの話ですよね？ > ntextの代わりにnvarchar(4000)を使う そういうことでしたらそうしてください。 ただし、インデックスに使わないのであればnvarchar(max)の方がよいでしょう。 http://technet.microsoft.com/ja-jp/library/ms187993.aspx > ntext 、text、および image の各データ型は、将来のバージョンの Microsoft SQL Server で削除される予定です。 　(中略) > 代わりに、nvarchar(max)、varchar(max)、varbinary(max) を使用してください。 で、本題の「nvarcharを使うときはとりあえずnvarchar(4000)でいいんじゃないか？」という話ですが、 1列または1レコードのサイズが大きすぎるとこんな落とし穴があるようです。 クエリ関連 http://msdn.microsoft.com/ja-jp/library/ms345371%28v=sql.105%29.aspx キー・インデックス関連 http://technet.microsoft.com/ja-jp/library/ms163207%28v=sql.105%29.aspx http://technet.microsoft.com/ja-jp/library/ms143432.aspx このあたりのことも理解した上でサイズを決めた方が良さそうです。
どんな目的でインポートしたいのか分からないですが エクセルの1セルのデータはFMの1フィールドとなります。 1行が1レコードという意味です。 1レコードに全部入ったらDBとして何の意味も無いです。 単にエクセルのシートを保存したいという意味なら オブジェクトフィールドに挿入したらいいのでは？ エクセルなんか使わずに最初からFMにすればいいのに・・・
Access2000の環境がないので未検証ですが「ユニオンクエリ」で可能かと思います。 SELECT 名前1 AS 名前,タイム1 AS タイム FROM テーブルA UNION SELECT 名前2 AS 名前,タイム2 AS タイム FROM テーブルA UNION SELECT 名前3 AS 名前,タイム3 AS タイム FROM テーブルA このような感じです。
クエリではできない、と思いますが。 以下、DAOで。 Sub test80() 　　Dim db As DAO.Database 　　Dim rs1 As DAO.Recordset 　　Dim rs2 As DAO.Recordset 　　Dim i As Long 　　Set db = CurrentDb 　　Set rs1 = db.OpenRecordset("テーブルA") 　　Set rs2 = db.OpenRecordset("テーブルB", dbOpenDynaset) 　　rs1.MoveFirst 　　Do Until rs1.EOF 　　　　'コメントアウトしている部分は参考 　　　　'rs2.AddNew 　　　　'rs2!名前 = rs1.Fields("名前1").Value 　　　　'rs2!タイム = rs1.Fields("タイム1").Value 　　　　'rs2.Update 　　　　'rs2.AddNew 　　　　'rs2!名前 = rs1.Fields("名前2").Value 　　　　'rs2!タイム = rs1.Fields("タイム2").Value 　　　　'rs2.Update 　　　　For i = 1 To 2 　　　　rs2.AddNew 　　　　rs2!名前 = rs1.Fields("名前" & i).Value 　　　　rs2!タイム = rs1.Fields("タイム" & i).Value 　　　　rs2.Update Next i 　　　　rs1.MoveNext 　　Loop 　　rs1.Close: Set rs1 = Nothing 　　rs2.Close: Set rs2 = Nothing 　　db.Close: Set db = Nothing End Sub
ネットからデータを自動で落としてくるソフトを「クローラ」と言うのだけどハッキリ言ってやめた方がいいですよ。 過去に図書館のデータベースに自作のクローラを使ってアクセスして訴えられた事件があります。 最終的には図書館側のシステムにも問題があり不起訴になったらしいのだけど、もしあなたも同じ事になったら嫌でしょう。 特にお役所相手のシステムに自動アクセスするのは避けたほうが良いと思います。
適正なインデックスがあれば特にスピードは変わらないと思いますが？ //元データ create table user(user_id int,user_name varchar(20),index(user_id,user_name)); insert into user values(1,'aaa'),(2,'bbb'),(3,'ccc'); create table user_agreements(user_id int ,money int,index(user_id,money)); insert into user_agreements values(1,5000),(2,3000),(2,5000),(1,8000),(2,4500),(3,10000),(3,2500); //例1 select user_id,count(money) as money,user_name from user inner join user_agreements using(user_id) group by user_id; //例2 select user_id,(select count(money) as money from user_agreements where user_id=t1.user_id) as money,user_name from user as t1; //例3 select user_id, money,user_name from user as t1 inner join (select user_id,count(money) as money from user_agreements group by user_id) as t2 using(user_id); 例1と例2はほぼ同じ、例3は若干効率が悪いかもしれません
桐は持ち合わせていませんが・・・。 ODBCの設定では？ C:\Windows\SysWOW64\odbcad32.exe を立ち上げると32bit版の設定ができますので、 システムDSNにエクセルの設定を追加。 名前は適当で構いません。 これを桐で使用したら出来るかもです。 AccessからVBAでODBC経由で接続した経験からですので どうかな？ http://support.microsoft.com/kb/942976/ja
MacならエクセルをPDF保存してFMのレイアウトに貼り付けると綺麗。 Winではそうは行かなかったはず。たしか。 解像度を設定してjpeg保存できるのでしたら5倍くらいに大きくして 貼り付けてから小さくドラグすれは良かったような・・・
エクセル持ってないけど私のスプレッダシートでは HOUR(C1)*60+MINUTE(C1) とか C1*24*60 とかで出ます。
No2です 蛇足ではありますが、示したページにはボタンで実行するように説明さてれてますが、アクション名：キー送信、キー操作：%TDCをご自身のマクロの最後に付け足すということで実行してください。 もちろん、ページのように最適化マクロという名前にしてご自身のマクロから「マクロの実行」「最適化マクロ」で実行させてもよろしいでしょう。 ただし、ページに書かれている注意事項は確認しておいてください。
Private Sub calendarForm_DateChanged(newDate As Date) 　　Me.[日報選択] = newDate 　　Call 日報選択_AfterUpdate End Sub では、どうですか。 あるいは、 Private Sub calendarForm_DateChanged(newDate As Date) 　　Me.[日報選択] = newDate 　　Me!F_日報商品売上.Requery 　　Me!F_日報扱い現金.Requery 　　Me!F_日報扱いクレジット.Requery End Sub これでは。 もし、構文エラーになるなら、メニューの [デバッグ]-[****のコンパイル] で反転選択される部分のコードを教えてください。
(1) 解りません。 もちろんkgyqk433さんがそのように要求される権利はありますが、私が従う義務はありませんので従いません。 この後に発言するかどうかはその時に決めます。 (2) 既に回答済みなので、読解力があるならご一読ください。
>>となると、データベースを扱うという部分ではパフォーマンスはあまり変わらないのでしょうか？ Oracleは、データベースとしてパフォーマンスと耐障害、信頼性を十分に考えた作り方をしていると思います。 Oracleの内部動作について学べば、「プログラマーとして考えたら、こういう作りにするだろうなあ（作るのは面倒だけど・・）」と思えるような正当派の堅実なやり方をしているように思えてきます。 ですので、たぶん、大規模になれば、オープンソースソフトよりも、パフォーマンスがいいような気がします。 でも、個人ベース、中小企業レベルでは、そこまでの大差はつかないような気もします。 たぶん、どのソフトを使うかという場合、単なる速さ以外にも、さまざまな要求項目が出てくると思います。そういう中で、消去法によって残るのがOracleが多いってことだと思いますし、要求項目が少ないなら、オープンソースのソフトから選んでもいいように思います。 そして、データベースを選択するときは、単なるパフォーマンスだけでなく、「自分がこの部署を去ったあとも、システムを維持できるか？」なんてことも考えることになると思います。 そこまで考えたとき、「コストパフォーマンスとしては、最高ではないかもしれないけど、代わりの技術者が得やすくて、安心して使える有償のＤＢを選択する」という判断となることもあると思います。
プロシージャに直接ショートカットキーを割り当てることはできませんが、マクロならできますので、 マクロからプロシージャを呼び出すようにして（プロシージャの実行）、そのマクロにショートカットキーを割り当てればどうでしょうか。 マクロにショートカットキーを割り当てる方法は下記を参照してください。 キーボード ショートカットを使用して Access マクロを実行する - Access - Office.com http://office.microsoft.com/ja-jp/access-help/HA010239111.aspx
> 「マクロのコマンド：データベースの最適化」があるので、 > 必ずできるはずだとおもうのですが、 そのコマンドは他の閉じているデータベースファイルを最適化することは可能ですが、 開いている自分自身を最適化することはできません。（エラーメッセージどおりです。） 過去ログでも何度もでてきています。 Access、マクロの最後に最適化を入れられる？ | その他MS OfficeのQ&A【OKWave】 http://okwave.jp/qa/q5235314.html オプションの[閉じるときに最適化する] にチェックを入れておけばどうですか。
フィールドA&" "&フィールドB&" "&フィールドC などの計算フィールドを作るだけでは？
> マクロの一連の流れの最後で、データベースの最適化をしたいと > 思っていますが、具体的にどのようにすれば、 > データベースの最適化を実行できるのでしょうか？ 一連のマクロの最後に最適化するということなら可能だと思いますが、 一連の流れの途中に入れるは原理的に不可能だと思います。 最適化はいったんデータベースファイルを閉じますので。 方法は下記を参照ください。 Access2003以前の場合 開いているデータベースを最適化する(Access VBA) http://www.ka-net.org/office/of05.html Access2007 開いているデータベースを最適化する(Access 2007 VBA) http://www.ka-net.org/office/of06.html VBAになりますので、上記の Sub を Function に書き換えて、マクロの「プロシージャの実行」で呼び出します。
いくつか方法はありますが。 1 ツールバーの「ツール」の「起動時の設定」 を選択し、「フォーム/ページの表示」のところで、 フォームを選択し、「ＯＫ］とする。 http://office.microsoft.com/ja-jp/access-help/HP005188501.aspx 2 マクロの新規作成を選択し、「アクション」で 「フォームを開く」を選択し、下のほうで 「フォーム名」からフォームを選択する。 このマクロを、「AutoExec」という名前で 保存する。 http://office.microsoft.com/ja-jp/access-help/HA010336239.aspx このような感じですね。
Accessにぴったりの要件のように思います。 提示された要件はAccessですべて可能です。 ビジュアルスタジオ等の開発環境だと、一からすべて作成していく必要がありますが、Accessなら、テンプレートやウィザードである程度の雛型はできるので、それをもとに手直したり、機能追加したりという形で開発できるので、かなり楽できます。 プログラミング知識がなくても、ウィザードやプロパティの設定である程度のものは作成できますし、VBAを使用してプログラムすればかなり高機能なことまで可能です。 画像データの管理に関しても、2003以前のバージョンでは弱かったですが、最近のバージョンは強化されて楽に扱えるようになりました。 パーソナルに使うなら問題なくお勧めです。一桁台の人数までなら共有する運用でも使用できます。MSの製品ということもあってユーザーも多く情報も豊富にあり簡単に入手できます。 ただ、まがりなりにもデータベースなので、テーブル設計にはそれなりの知識が必要です。それなしエクセルの間隔でテーブル設計をすると使い物にならないものになります。データベースに関数する知識は他にも活かせるので苦労してでも取得しておいて損はないです。 入門書や初心者向け解説サイトは豊富にありますので、まずはその中から自分の目的にあいそうなものを見つけるといいでしょう。顧客管理をサンプルに解説しているものも見つかると思います。
サブフォームを埋め込んでいるコントロール名が、「埋め込み1」とします。 With Me.埋め込み1.Form.RecordsetClone 　　.MoveFirst 　　Do Until .EOF 　　　　.Edit 　　　　!行番号 = .AbsolutePosition + 1 　　　　.Update 　　　　.MoveNext 　　Loop End With
下記のSQLてどうでしょう。 SELECT * FROM テーブル名 WHERE 名前 Not Like "[tk]*" AND 入社日 Between "19900101" And "20000101";
SELECT お客様リスト.会員ID, お客様リスト.会員氏名, Max(IIf(購入日>=#1/1/2012# And 購入日<=#6/30/2012#,"●","")) AS 2012上期, Max(IIf(購入日>=#7/1/2012# And 購入日<=#12/31/2012#,"●","")) AS 2012下期, Max(IIf(購入日>=#1/1/2013# And 購入日<=#6/30/2013#,"●","")) AS 2013上期 FROM お客様リスト WHERE (((お客様リスト.購入日)>=#1/1/2012# And (お客様リスト.購入日)<=#6/30/2013#)) GROUP BY お客様リスト.会員ID, お客様リスト.会員氏名; 最期のWHERE条件は、名簿に居るけど、どの期間にも購入が無い場合に、リストに出ないようにする為のもの。
　質問の例題が、あまりにも省略されている為に、正確な要件が解らなくなってしまっています。 　おそらく、商品テーブルにも在庫テーブルにも、そのほかのフィールドがあるはずですよね。そうで無いと、在庫テーブルはレコードの特定が出来ませんし、商品テーブルに至っては存在価値を疑ってしまいますので・・・ 　で、質問の結合方法も、そのほかのフィールドがらみで方法が変わってきそうです。 　本当に、質問内容だけでしたら、一番単純な解は、 select distinct ID from 在庫テーブル 　です。結合の必要なんてありません。 　こんなのも、いちおうあり・・・ですが・・・ 　select distinct z.ID from 商品テーブル s join 在庫テーブル z on s.ID=z.ID 　これで、少なくとも、商品テーブルに存在する商品ＩＤのうち、在庫テーブルに存在する商品の重複の無いＩＤが取得できます。が・・・普通、商品テーブルに存在しない商品IDてのが想像しがたいので、意味があるかどうか・・・ 　普通は、この類のテーマだと、 select s.ID, sum(z.数量) from 商品テーブル s join 在庫テーブル z on s.ID=z.ID group by s.ID 　等とやって、「商品の在庫量が知りたいです」となるんですけど・・・ 　さて、いったい何がやりたいのでしょうか？ 　「いろいろとやりたいこと」の内容を書かれた方が、的確な答えが返ってくると思います。
ネットワークを使わず、１台のPCで完結していることをいいます。 今回の件ではLANを介した共有フォルダ内のファイルを開いていることも想定されるため、スタンドアローンであるかどうか断言できません。逆に、そのPC内のファイルならスタンドアローン運用ということになります。
別テーブルを使わずにとなると、ユオニンクエリを使うことになります。 先に、ユニオンクエリで、数量、金額、数量合計、金額合計 を縦に連結して、これをサブクエリとしてFROM句に入れて、クロス集計クエリにします。 TRANSFORM Sum(値) SELECT 支払先, データ FROM (SELECT T_支払.年月, T_支払.支払先,"数量" AS データ, T_支払.数量 AS 値 FROM T_支払 UNION ALL SELECT T_支払.年月, T_支払.支払先,"金額", T_支払.金額 FROM T_支払 UNION ALL SELECT T_支払.年月, "合計", "数量", T_支払.数量 FROM T_支払 UNION ALL SELECT T_支払.年月, "合計", "金額", T_支払.金額 FROM T_支払) T GROUP BY 支払先, データ ORDER BY 支払先, データ DESC PIVOT 年月;
ANo.1の方がショックを受けておられたようですが、 DB2にisnumeric等の文字かどうかや数値かどうか等を判定する関数は、なかったと思います。 以下はAS400のDB2のマニュアルですが。。。（すぐに見つかったのがこれだったので。） http://publib.boulder.ibm.com/html/as400/v4r5/ic2962/info/db2/rbafzmst02.htm#ToC ということで、 ANo.1の方が書かれているＵＲＬの方法を応用するとか、 select max(項目名１) from テーブル名１ where length(trim(translate(項目名１,' ','0123456789'))) = 0 とするとかしないとダメと思います。 注：このwhere句の意味。 (1) translate(項目名１,' ','0123456789') 0から9までの数字を空白にする。 (2) trim( ・・・ ) 前後の空白を除去する (3) length( ・・・ ) 長さを調べる。 0から9までの数字は空白に置き換えられた後、他の文字がなければ、trim()で消去され、 長さ０になっています。 ただし、空白が途中に入っていても数値とみなしてしまうので、'12 3'等があれば使えません。 未検証です。 マニュアルの文法では、 translate(項目名１,変換先文字列,変換元文字列) と書いてあったので多分大丈夫と思いますが。 （Oracleなんかと逆なのでちょっと気がかり。ご自身の持つマニュアルで確認するなり、 　動かしてみて確かめるなりしてください。）
SELECT 組 ,1+IIF([タイムA]>[タイムB],1,0)+IIf([タイムA]>[タイムC],1,0) AS Aの順位 ,1+IIf([タイムB]>[タイムA],1,0)+IIf([タイムB]>[タイムC],1,0) AS Bの順位 ,1+IIf([タイムC]>[タイムA],1,0)+IIf([タイムC]>[タイムB],1,0) AS Cの順位 INTO テーブルＢ FROM テーブルＡ; イムA],1,0)+IIf([タイムC]>[タイムB],1,0) AS Cの順位 FROM テーブルＡ; 同一のタイムが複数ある時については何も書いていないので考慮していません。
ACCESSからやると接続文字列テストは面倒なので単体でってみるとか。 デスクトップで右クリック＞新規作成＞テキストファイルとやって ファイル名はTEST．UDLとでもして下さい。 「表とＰＣ」みみたいなアイコンに変るので起動。 ここで順を追って進めて下さい。
Ａ．VBE(エディタ)は、Shift-JISみたいです OfficeやVBAの文字列型はUnicodeなので、処理は可能です。 ただ、エディタがsjisなので、補助漢字はコード上に書くことができません。なぜかMsgBoxもsjisです。 　→ 仕様かと。ChrWしかないと思います。 　参考)http://codezine.jp/article/detail/1718 Ｂ．VBAはサロゲートペア(4byte文字)未対応です 2byte*2として扱われます。 　→ "𠮟"なら、ChrW(&HD842) & ChrW(&HDF9F) 　参考)http://codezine.jp/article/detail/1592
【DAOでのソートに関して・・・】 rst.sort は、テーブルタイプで使用しても並び替えない。 テーブルタイプの並び替えでは Index を使う。 Access95 では、このような使い分けをしていました。 ですから、今回の件はDAOのバグではなく私らの勘違い。 今、やーっと思い出しました。
自分のソフトにデータベースの機能を組み込みたいと思ったときに使うものです。 たとえば、メールソフトで、 受信したメールを詰め込んだデータベースを作る。 並べ替え（件名、受信年月日、送信者など）などがすぐ出来ます。
「クライアントサーバー」方式ではないでしょうか。
Access2007は持ち合わせていませんので、ここんとこだけですが >※因みにアクセス2007に関してはネット環境がありませんので >ソフトやPCはアップデートはされません。 SP3未適用でしたら http://www.microsoft.com/ja-jp/download/details.aspx?id=27838 をダウンロードして、USBメモリなどを経由してインストールされれば？
http://www.mahoutsukaino.com/ac/ac2000/ac2000/actionq/action03.htm ここに非常に判りやすく書かれています。 ＞んでは、まずは普通にクエリを作り始めます。 ここまで出来たら、完成したも同然です。 添付画像を手掛かりにアタックされてください。
Access2002・2010（多分2013も）で フィールドのデータ型を設定してあっても インポートの際にはAccessが頑固一徹にデータ型を決めてしまいます。 Excelの場合はデータ行で先頭から8行を空読みして決定しています。 これはレジストリに登録されています。 レジストリエディタを立ち上げ Ctrl + F で Typeguessrows を検索すると（当方では最初に見つけるまで１分程度） WindowsXPなら HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\4.0\Engines\Excel にあるかと思います。 複数個所（Windows7 & Office2010なら二か所でした）にあることも。 規定値は、8 になっていますので この値を10進数なら30位の適当な大きな値にするか 0 にすればすべてを空読みしてからデータ型の決定を行います。 (0 だとモノによっては時間が掛かるかも） CSVファイルなら、Maxscanrows を検索してみてください。25行になっているかと。 FF1　FF2 1　　123 2　　123 3　　123 4　　123 5　　123 6　　123 7　　123 8　　123 ここまでで数値型に決定される 9　　abc データ型が違うので除外される レジストリの変更をすれば、その後はデータ型に注意しなくともすみますが、 権限の問題でRegedit.exe を立ち上げられない（変更ができない） レジストリの変更に不安 な場合は、 先頭に近いセルの値に一つにシングルクォーターしょんを付け、123 → '123 にしてしまうことです。 そうすればすべてテキスト型で読み込まれます。 なお連続している順番が 数値→数値・・・・・・・・・テキスト だと変換エラーになりますが テキスト→テキスト・・・・・・・数値 だと数値もテキスト型として読んでくれます。 テキスト型はある意味オールマイティです。
Q_商品クエリは選択クエリでしょうか。 Q_商品とT_テストのフィールド名・フィールドサイズが同じなので currentdb.execute "insert into [T_テスト] select * from [Q_商品]",dbfailonerror で機能するかと思います。 >'システムメッセージの非表示 >DoCmd.SetWarnings False >DoCmd.RunSQL "DELETE FROM T_テスト" >'システムメッセージの表示 >DoCmd.SetWarnings True は、 currentdb.execute "DELETE FROM T_テスト" ,dbfailonerror だと確認メッセージを出さずに進行します。 Setwarnings で切り替える必要がなくなります。
> vDt = DMax("番号", "営テーブル", "番号 Like '" & Format(Date, "ee") & "*'") これでは、先頭の 「漢字1文字」 が無視されていますね。 vDt = DMax("番号", "営テーブル", "番号 Like '営" & Format(Date, "ee") & "*'") とか、 vDt = DMax("番号", "営テーブル", "番号 Like '?" & Format(Date, "ee") & "*'") さらに > 番号 = "営" & Left(vDt, 2) & Format(Val(Right(vDt, 4)) + 1, "0000") を 番号 = Left(vDt, 3) & Format(Val(Right(vDt, 4)) + 1, "0000") 上記は "営テーブル"の "番号"フィールドには , 「営250001」 のように保存されているものとします。 １桁目は"営"固定の場合です。 そうでない場合は、また変わってきます。
最も簡単な対応は、[支店マスタークエリ]を作成されることです。そのクエリで、列[新支店CD]を生成されると目的は達成されます。 ※本来は、支店コードという可変なデータ列ではなく長整数の一意な数字を主キーに。もちろん、列[支店コード]はあっても構いません。が、それは、あくまでも表のデータ。リレーションを内部管理するキーとしては不適です。
> 出席番号１さんがライバルだと思っているのが、 > 出席番号３さん、５さんとします。 > ３さんは１さんのことをライバルと思っていませんが、 > ５さんは１さんのことをライバルだと思っています。 という関係は，「ライバル」テーブルに次の3行を登録すれば表現できます。 (user_id, rival_id) = ((1, 3), (1, 5), (5, 1)) (user_id, rival_id) = (1, 5) と (user_id, rival_id) = (5, 1) は，主キーの値はまったく別です。 ちなみに， 「ライバル」テーブルのrival_idが「生徒」テーブルの主キーを参照する外部キーであるのと同様， 「ライバル」テーブルの user_idも「生徒」テーブルの主キーを参照する外部キーです。 それから。 出席番号というのはクラス内の連番を指す概念ですか？ であるなら。 変則的な理由で年度の途中で出席番号が変わる可能性もありえますし，1年→2年→3年の進級によっても出席番号は維持できません。学籍番号（学生番号）に代表される，入学以降変化しない識別値を「生徒」テーブルの主キーにすべきです。
削除クエリーの場合、サブフォームに#Deletedと表示 me!サブフォーム名.form.requery じゃダメですかね。ゴミレス勘弁。 dao.recordset の件は分かりません。 調べる気力も体力もスキルも。。。 Access2010のヘルプでは Sub SupplierID_AfterUpdate() 　　Dim rst As DAO.Recordset 　　Dim strSearchName As String 　　Set rst = Me.Recordset 　　strSearchName = CStr(Me!SupplierID) 　　rst.FindFirst "SupplierID = " & strSearchName 　　If rst.NoMatch Then 　　　　MsgBox "Record not found" 　　End If 　　rst.Close End Sub ともなっています。 Sub CheckRSType() 　　Dim rs as Object 　　Set rs=Forms(0).Recordset 　　If TypeOf rs Is DAO.Recordset Then 　　　　MsgBox "DAO Recordset" 　　ElseIf TypeOf rs is ADODB.Recordset Then 　　　　MsgBox "ADO Recordset" 　　End If End でRecordsetのどちらを使っているか判別できるようです。 投稿用にタブインデントは全角スペースにしています。
No.1です。 データ様式の変更ができないということですね。 その場合、クエリーで、式1: CDbl(Left([テーブル1]![名前1],Len([テーブル1]![名前1])-1))のように入力し、このカラムを昇順にソートすればOKです。 Left関数で、文字長-1の文字を取り出し、℃を除き、数字部分だけを取り出し、これを数字（倍精度浮動小数）に変換し、この値でソートするという事です。 確認下さい。
こちらで試した限りでは dim fld as object j = "select * from [Sheet1$] " 　'←ここです。 myRS.Open j, myCon for each fld in myrs.fields debug.print fld.name next だと Alt + Enter （chr(10)）は、_ アンダーバー になってますね。 j = "select count(*) from [Sheet1$] where H24_決済 = '済';" だと？
8と12は殆ど別のソフトということになるので無理です。 7～11までか、全部12にするなど統一しないといけません。
バッチファイルとはコマンドプロンプトの BAT でしょうか。 テーブルだけではなくて、まるっと変換なら Accessの起動オプション /convert を使ってみては？ http://office.microsoft.com/ja-jp/access-help/HP005188300.aspx VBAなら、ConvertAccessProject メソッド があります。 http://support.microsoft.com/kb/304318/ja
あまり良い設計とは言えませんが、性能的な要請が厳しく、他の手段（後述のパーティショニング等）も無くて、そうせざるを得ない場合は有るでしょうね。 ということで、「一般的なやり方ではないが、アプリ内容(仕様)によっては普通に起こりうる」になるかと。 ただし、パーティショニング機能の有るDBMSでは、それによって月や日付によって物理テーブルが分割される事は一般的だと思われます。 http://lets.postgresql.jp/documents/technical/partitioning/1 http://www.atmarkit.co.jp/ait/articles/0611/22/news141.html もっとも、この場合は日付や月などのカラムもそのまま残しつつテーブルを分割する事になるのですが。
なら、ゴールは見えたも同然？ まずは頑張って不一致クエリウィザードを使って 未登録車両を抜き出せるクエリを作成してください。 そのクエリ名を仮に、Q未登録チェック とします。 このクエリだけでも目的の大半は達成かと思います。 あとは前回回答のを流用して Sub UnknownCarCheck() 'Microsoft Office xx.x Access database engine Object Library←Access2007から出来ました 'または、Microsoft 3.6 Object Libary←2003だと多分こっち のいずれかに参照設定が必要です　　 　　Dim db As Database 　　Dim rs As DAO.Recordset 　　Set db = CurrentDb 　　Set rs = db.OpenRecordset("Q未登録チェック", dbOpenSnapshot) 　　rs.MoveLast 　　If rs.RecordCount <> 0 Then 　　　　MsgBox rs.RecordCount & "件不一致あり" 　　　　DoCmd.OpenQuery "Q未登録チェック" 'クエリを開いて確認 　　Else 　　　　msgbox "未登録車両はありませんでした" 　　End If 　　 　　rs.Close: Set rs = Nothing 　　Set db = Nothing End Sub というのを必要な時に行えばどうでしょ。 なお、上記回答は CSVファイルを一時的なテーブルにインポートして それと車番マスタを照合する場合を想定しています。
>具体的な方法が知りたいっす！ テキストファイルデータベースを作ればいいだけですが。 簡単なものならロックの制御、ファイルの読み書き、ファイル内の検索と更新ができればできるでしょ？ ただし効率は悪いですが。
何処まで早くしたいのか解りませんが、大して変わりません。HUBが10mbpsとかで遅いものならともかくいまのHUBでそんなに遅いものは無いでしょう。 やりたいことは‘AccessのDB共有と言う事でもし遅いとかんじるならそれはAccessの作り方を疑ってください。 共有するには共有用の作り方があります。その辺の知識が無いとどんなにはやいネットワークでも無駄です。本当に早くしたいならSQLServerの無料版の方が全然よいと思います。
表示されたメッセージの末尾にあるファイルは、記述通りの場所に存在しますか？
良いと思います。 フロントエンドは「ユーザとのインターフェイス部分」、 バッグエンドは「向こう側の処理部分」と捉えると、 別サーバにＤＢを配置しているなら、フォームに限らず 「MS-ACCESSそのものがフロントエンド」になります。
FromにSelectを書く場合でも、数式と同様にカッコが優先されるから、と思います。
「レポートの元（テーブルorクエリ）で計算しておく」ではダメなんですか？ 単価: iif([商品]='商品A', 100, iif([商品]='商品B', 300, iif([商品]='商品C', 200, 0))) 金額: [個数]*[単価] の列を追加したクエリを新たに作り、それをレポートの元とする。 合計金額でsum(金額)を月別に求めればよさそう。
「その列」をｗｈｅｒｅ条件に記述して、is null またはis not nullで絞れますか？ どちらもできないなら、nullと空文字を混同しているのかも
2013環境はないので2010で確認しましたが、質問者さんと同じ結果でした。 クエリでの比較は、テキストモードでの比較なのでそれのバグが原因だと思われます。 （テキストモードとは、大文字/小文字、半角/全角、ひらがな/カタカナ を区別しないというモード。） 吉 だけなら No.1の回答者さんの方法でいいと思いますが、他にも環境依存文字の存在する可能性があるなら、StrComp関数でバイナリモードで比較するといいかもしれません。その代わり、大文字/小文字、半角/全角、ひらがな/カタカナ を区別するという比較になりますが。 フィールド　StrComp([フィールド名],[氏名を入力してください。],0) 抽出条件　0 これで2010環境では、パラメータに 土口 の吉田さんを入力すると1件のみの表示になりました。
＃１、＃２です。すみません。漏れがあるので訂正。 select 区分, 理由１ as 理由　from <テーブル名> UNION ALL select 区分, 理由２ as 理由　from <テーブル名> UNION ALL select 区分, 理由３ as 理由　from <テーブル名> ; です。 UNION と　UNION　ALLの違いは、 UNION　ALLだとおのおののselect結果すべてを返す、 UNION　だけだと　区分, 理由　の重複を除去した結果を返す、の違いです。
(1)または(2)の方法、どちらにしても、 1番のユーザはＡさん 2番のユーザはＢさん と静的に対応させる必要はないんじゃないかな、と思います。 どういうことかというと、(1)の方法でいうと、 未読フラグは「01001」としたら、 1番のユーザは、対応テーブルを参照して、Ａさん　で未読 2番のユーザは、同じくＢさん　で既読（または更新者） 3番のユーザは現在いません。 4番のユーザは、同じくＤさん　で未読 5番のユーザは、同じくＣさん　で既読（または更新者） 対応テーブル 位置　数値(未読フラグの何バイト目に対応するか) ユーザ　文字列（ユーザＩＤ） <データ> 1,AさんのID 2,BさんのID 4,DさんのID 5,CさんのID ・・・ユーザー登録・更新・削除時にいっしょに処理します。 　　　メインテーブルの登録・更新・削除は関係しません。 また、(1)の方法に関して言うと、 メインテーブルの更新者を記録しておきたかったら、 メイン以外の別テーブルに分けたほうがいいと思う。 文書の更新は、メインテーブルの更新者ＩＤを更新するが、 文書閲覧でメインテーブルが更新されたら、更新者ＩＤを更新してはいけない、 なんてややこしいことになるから。 項目としては、管理番号・版数・未読フラグ・削除フラグ（管理番号・版数キー）か 管理番号・未読フラグ・削除フラグ（管理番号キー）か。 削除フラグは、未読の一覧を出すとか言うことがあるならあると楽だがいらないかもしれません。 修正の取消っていうのがあるなら、管理番号・版数キーにしておかないと、１世代前へ戻れません。 （ないなら、どちらでもいいと思います。） あと、アクセス権限という概念はないんですね？ 例えば、登録や更新した人以外の人が勝手に削除していいのか？ とか、参照してほしくない人がでてきたら除外できない、とか・・・。 ⇒何か作るのなら、未読フラグに2とか3とか作れば簡単に対応できそうですが。
websql での関数が callback であるところ、結構混乱しますね。 プレースホルダーに入れるデータを、わざわざ変数に入れ替えてるのが仇になってるんじゃないかな。callback関数は、非同期　つまり元の呼び出し時のデータではなく、その変数が最終的に持ってる値をみると言うこと。local 変数で渡すのは、メモリリークの原因にもなって危ないみたいです。 補足のスクリプトにコメント追加してみました。 for (var i=0:i<dt.length;i++) { // var cd=dt[i][0];// 不要 // var nm=dt[i][1];// 不要 db.transaction( function(tx) { tx.executeSql( /* "insert into 対象 (番号,名称) values(?,?)",[cd,nm], // ← ここ cd, nm は、変数の参照が渡されているので、実際の実行時には、最終値　つまり dt[n-1][] の値になってしまう ↓　配列 dt[i] で入力すれば、とりあえずこの関数全体が終了するまでは、個別に違うメモリ位置を見てくれるはず。 */ "insert into 対象 (番号,名称) values(?,?)",dt[i], function(tx,rs) {}, fiunction(tx,er) {alert(er.message);} ); }, function(er) {alert(er.message);}, function() {} ); }
SQLの種類によっては以下でもいけます select hoge,sum(stat='a') as a,sum(stat='b') as b from test01 group by hoge; なおcountでやるならnullを利用します select hoge , count(if(stat = 'a' ,0,null)) as a , count(if(stat = 'b' ,0,null)) as b from test01 group by hoge; もうすこし複雑になってくるとピボットテーブルという処理用のテーブルを 用意すると効率的に処理ができます
select count(*),hoge from test01 group by hoge;
> Like "81*"の人で、負担金が600以上の人を追加しようとしましたが出来ませんでした。 式2として「何を」追加したいのでしょうか？ [番号]のLike条件が3つありますが、80*、90*の場合には式2に何を返しますか？ 以下、「Like "81*"の人で、負担金が600以上」でtrueを、それ以外はfalseを返します。 式2: IIf(([番号] Like '81*') and ([負担金]>=600)),True,False)
まずVBAのコーディングが出来る画面を出す。イベントビルドでもモジュールのついか画面でもよい。 そこでツールメニューからの参照設定をひらく。そこの参照ボタンでPCの場所のOCXを選ぶ。リストアップされれば成功。
表示しないが計算しないなら その計算式をCase ( 計算式 ≥ 0; 計算式 )にする。 見えなくするなら、条件付き書式を使って 計算結果<0の条件で、文字色を白(フィールド色、背景色)にするのが簡単。
可能です。 理論を組み立てます。 (1)レコードの順位付けを行う。→クエリQ (2)上記のQを第1列用、第2列用、第3列用として結合する。 (3)第1列用は順位を3で割った剰余が0のものを抽出する。 (4)第2列用は順位が第1列用の順位+1のものを結合する。 (5)第3列用は順位が第1列用の順位+2のものを結合する。 元のテーブルをT、第1列目をSEQと仮定すると、以下のように SQLを構築します。 (1)クエリQのSQL SELECT A.SEQ ,MAX(A.郵便番号) AS 郵便番号 ,MAX(A.住所) AS 住所 ,MAX(A.氏名) AS 氏名 ,MAX(A.TEL) AS TEL ,COUNT(B.SEQ) AS 順位 ←★ FROM T AS A LEFT JOIN T AS B ON A.SEQ > B.SEQ ←★ GROUP BY A.SEQ ★同じテーブル同士で、自分よりキーの小さいものの数を 数えます。先頭レコードから0、1、2…となります。 (2)目的のクエリ SELECT A.SEQ ,A.郵便番号 ,A.住所 ,A.氏名 ,A.TEL ,B.SEQ ,B.郵便番号 ,B.住所 ,B.氏名 ,B.TEL ,C.SEQ ,C.郵便番号 ,C.住所 ,C.氏名 ,C.TEL FROM (Q AS A LEFT JOIN Q AS B ON A.順位 = B.順位 - 1) ←★1 LEFT JOIN Q AS C ON A.順位 = C.順位 - 2 ←★2 WHERE (A.順位 MOD 3)=0 ←★3 ★1 Aの順位が0の時にBの順位が1のものと結合します。 ★2 Aの順位が0の時にCの順位が2のものと結合します。 ★3 Aの順位を3で割った時の剰余が0のものを抽出します。 いずれも不等号の結合条件なので、クエリビルダでは 作成できず、SQLビューでの直接入力になります。
Access2007は持ち合わせていませんが2010では オブジェクト（ナビゲーションウィンドウのテーブル名）上で右クリック 「このグループに表示しない」を選択すれば隠しオブジェクトになります。 表示したい場合は、 ナビゲーションオプションで隠し『オブジェクトの表示』にチェックを入れ グレー表示されているオブジェクト上で右クリック、「このグループに表示」です。 隠しオブジェクトになっている場合はリンクテーブルマネージャには表示されませんね。
今日、見つけたんですが [印刷プレビュー]タブを丸ごと表示して良いなら こちらの方法で。 http://mukkumuku.blogspot.jp/2010/10/access2010-ribbon-startfromscratch.html グループ毎の非表示もできそうですが、ID を調べたりしなくちゃいけないので。 <customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui"> <ribbon startFromScratch="true" > <tabs> <!-- idMsoで指定し明示する --> <tab idMso="TabPrintPreviewAccess" visible="true" /> </tabs> </ribbon> </customUI> もっと良い方法があるかもしれないけど、 一応動いている方法。 印刷プレビュー時 に 「印刷」「印刷プレビューを閉じる」だけを表示します。 USysRibbons に レコードを追加。 RibbonName ： PrintRibbon （何でもいいけどとりあえず「PrintRibbon」） RibbonXml ： <customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui"> <ribbon startFromScratch="true"> <tabs> <tab id="frmPrintTab4" label="コマンド"> <group id="frmPrintGroup1" label="印刷"> <control idMso="PrintDialogAccess" size="large"/> </group> <group id="frmPrintGroup2" label="プレビューを閉じる"> <control idMso="PrintPreviewClose" size="large"/> </group> </tab> </tabs> </ribbon> </customUI> 各レポートの「リボン名」プロパティ に「PrintRibbon」 を設定。 カレントデータベースのリボン名 は、非表示用のまま変更せずに。 以上です。
普通に「=」を入れて検索ですけど。 未入力では困るフィールドには自動入力オプションの 「空欄不可」を設定しましょう。
TextFormatRemove関数
私も質問者さん同様、中間ファイルを作成してから・・と思っていましたが、 Windows Vista および Windows 7 で Access 97 ファイル形式のデータベースを Access 2007 または Access 2010 ファイル形式に変換できないことがある http://support.microsoft.com/kb/942394/ja ↑のようにすれば一発変換ができました。 以下、手順。 （当方Windows7 64bit & Access2010 32bit 環境です。適宜、読み替えてください。） （検証したファイルは唯一残っていたNorthWind.mdb です。） Windowsのスタートボタンを押し、「Microsoft Access 2010 」を右クリック、 プロパティを選択し、互換性タブを選択、 「互換モードでこのプログラムを実行する」にチェックを入れ、 直下のプルダウンメニューから、「Windows XP(Service Pack 2)」を選択、 OKを押して閉じます。 Accessを今まで通り立ち上げて新規ファイルを作成します。 リボンの外部データタブから、Access を選択してウィザードに従って 全てのオブジェクト（テーブルやクエリ、フォームなど）を選択してインポートします。 途中でエラーが発生するかもしれませんが最後まで進めます。 そのまま修正作業に入りたいところですがぐっとこらえてAccessを終了し、 前述の互換モードのチェックを外します。 Accessを立ち上げて必要に応じてインポートしたファイルの細々とした修正作業を行います。 （ここからが大変かもしれません。） なお、 Windows 7 上の Office 製品を Windows XP SP3 互換モードで実行し VBEditor を開くと、マクロの全角文字の一部が削除されコンパイル エラーが発生する http://support.microsoft.com/kb/2297924/ja というバグがありますので、互換モードはSP2を選択が無難です。 また、互換モード中であれば直接97形式のmdbを開く事も出来ました。 開く際に変換するかそのまま開くかの選択肢が現れます。
mdbの制限は調べられましたか？ http://support.microsoft.com/kb/965659/ja
UPDATE "T_在庫" SET "在庫" = 0 ではだめでしょうか？ SQLITEではないですが テーブル名.カラム名でアップデートかけたらエラーになったことはあります。 そのさい、テーブル名をとったらいけました。
[参加県TB] テーブルに存在しない '東北' の県レコードを [都道府県TB] から削除するってこと？ [参加県TB] の [県ID] が主キーなどユニークである必要がありますが、クエリ ウィザードの不一致クエリ ウィザードで作成されたものを DELETE に作り変え、AND で ((都道府県TB.地域名)="東北") を WHERE に付け加えるだけ。 DELETE 都道府県TB.* FROM 都道府県TB LEFT JOIN 参加県TB ON 都道府県TB.[県ID] = 参加県TB.[県ID] WHERE (((参加県TB.県ID) Is Null) AND ((都道府県TB.地域名)="東北"));
byteで作れると思います。 create table テーブル1 (年 smallint , 月 byte);
こんな感じでもいいかもしれません。 select * from テーブルA T1 where not exists ( select * from テーブルB T2 where T2.F1 = T1.F1 and (T2.F2 > T1.F2 or (T2.F2 = T1.F2 and T2.F3 > T1.F3)) );
dcount("日付","テーブルA","日付 in(select 日付 from テーブルB") とか？
> 入力された日付に該当するレコードを、ソースとなるテーブルから選択クエリで抽出し この選択クエリの名前を、クエリ1 として下記のようなコードでどうでしょうか。 If IsNull(DLookup("日付","クエリ1")) Then MsgBox "該当するレコードはありません。" Else DoCmd.OpenReport "レポート名" End If
SQLiteは、insert文１つに、１行のデータしか書けないので、万を超えると結構たいへんですね。 defaultではtransaction off で、１行insertの度に、ファイル書き換えが発生するのでとても遅くなります。 transaction を使うと、on memory で複数回insertして最後にcommit時にファイル書き込みしますので、格段に速くなります。rollback すると、ファイルに書き込まずにデータが破棄されます。 あまり大量の処理はしたことがないのですが、千行(500K byte)くらいならcsv読みとり時間＋１Mの書き込み時間程度で出来たと思います(phpのPDO接続利用時)。万を超えると、メモリーの容量問題になってくるかもしれません。 SQL文でtransaction 実行するには以下参照。 http://net-newbie.com/sqlite/lang.html#transaction AccessVBAの方は、使ったこと無いけど、ご呈示ページの最後にtransaction利用法が載ってますね。SQLite接続の時も、BeginTrans メソッドってうまく機能してるのかな？ あと、SQLite3では、完全一括実行は、コマンドラインツールでしか出来ません。 http://www.sqlite.org/　からツールをダウンロードしてインストールする必要があります。 インストール解説ページは以下 http://www.dbonline.jp/sqliteinstall/install/index1.html ツールを起動して、importコマンドを利用します。 http://www.dbonline.jp/sqlite/manage/index2.html
補足に気付かず遅くなりました、すみません。 コントロールの位置関係がよくわからないのですが、大雑把な流れは以下の様かと思います。 ※印のところが不明点です。 このサイトではTabインデントが使えないので全角スペースで代用しています。 Private Sub 予約ボタン_Click() On Error GoTo errH 　　Dim db As DAO.Database 　　Dim rs As DAO.Recordset 　　Dim WSP As Workspace 　　Dim reTryCount As Integer 　　Set db = CurrentDb 　　Set WSP = DBEngine.Workspaces(0) reTry: 　　'※Me!機材番号txtコントロール とこのコマンドボタンが同じフォームにあると仮定 　　Set rs = db.OpenRecordset("SELECT * FROM T_管理テーブル WHERE 機材番号='" & Me!機材番号txt & "'" _ 　　　　, dbOpenDynaset, dbPessimistic) 　　DBEngine.Idle dbRefreshCache 　　If rs.EOF And rs.BOF Then 　　　　MsgBox "該当する機材番号はありません", vbOKOnly 　　　　Me!機材番号txt.SetFocus ' 　　　　GoTo atoShimatu 　　End If 　　If rs!選択フラグ = True Then 　　　　MsgBox rs!機材番号 & "は既に他者に貸出中です。", vbExclamation, "入力依頼" 　　　　Me!機材番号txt.SetFocus 　　　　GoTo atoShimatu 　　End If 　　WSP.BeginTrans 'トランザクション処理開始 　　rs.Edit 'ここでロック開始 　　　　rs!選択フラグ = True '選んだことで選択フラグをセット 　　　　rs!担当者 = Forms!F_新規貸出フォーム!担当者 'メインフォームの予約担当者をセット 　　　　rs!予約日時 = Forms!F_新規貸出フォーム!年月日 'メインフォームの予約日をセット '　　　　　　　　・　（省略） '　　MsgBox "lock" '確認用です 　　rs.Update 'ロック解除される 　　WSP.CommitTrans dbForceOSFlush 'トランザクション処理終了 　　rs.Close 　　Set rs = db.OpenRecordset("T_TMPテーブル", dbOpenDynaset) '　　rs.AddNew '　　　　rs.機材番号= ・・・・（省略） '　　　　　　　　・（省略） '　　　　　　　　・ '　　　　rs.Update 'ここで　サブフォームのリクエリーを実施 'DoCmd.GoToControl "検索"　←　コントロールをメインフォームへ移動しようとしています。 '※↑コマンドボタンはサブフォームにおいてあるのかな？ 'DoCmd.Requery "機材詳細表示リスト" '※以下二行の説明がほしいです。PS.メインフォーム名とサブフォーム名も。 'DoCmd.Requery "予約済み機材表示" errH: 　　Select Case err.Number 　　　　Case 0 '正常処理の場合、何もしない 　　　　　　 　　　　Case 91 'rs の閉じエラー 　　　　　　err.Clear 　　　　　　Resume Next 　　　　Case 3218 '同時に複数から同じレコードに更新処理が掛かった場合 　　　　　　err.Clear 　　　　　　WSP.Rollback 　　　　　　MsgBox "他の人によって更新中です。", vbOKOnly 　　　　　　reTryCount = reTryCount + 1 　　　　　　 　　　　　　If reTryCount < 2 Then 　　　　　　　　Resume reTry 　　　　　　Else 　　　　　　　　MsgBox "データを更新できませんでした。" 　　　　　　End If 　　　　Case Else 　　　　　　Debug.Print err.Number, err.Description 　　　　　　MsgBox err.Number & vbCrLf & err.Description 　　End Select 　　 atoShimatu: 　　rs.Close: Set rs = Nothing 　　Set WSP = Nothing 　　db.Close: Set db = Nothing End Sub
つまりAccessは必ずExcelと一緒のフォルダーにあるということでしょうか。 であればExcelを開いたときにマクロを走らせればよいだけだと思いますけど。 Private Sub Workbook_Open() ActiveWorkbook.RefreshAll With ActiveWorkbook.Connections("接続1").ODBCConnection .BackgroundQuery = True .CommandText = Array("SELECT * FROM table名")　ここは自分で変える。 .CommandType = xlCmdSql .Connection = Array(Array( _ "ODBC;DBQ=" & Application.ActiveWorkbook.Path & "\Access_名.accdb;DefaultDir=" & Application.ActiveWorkbook.Path & ";Driver={Microsoft Access" _ ), Array( _ " Driver (*.mdb, *.accdb)};DriverId=25;FIL=MS Access;MaxBufferSize=2048;MaxScanRows=8;PageTimeout=5;SafeTransactions=0;Threads=3" _ ), Array(";UserCommitSync=Yes;")) .RefreshOnFileOpen = False .SavePassword = False .SourceConnectionFile = "" .SourceDataFile = "" .ServerCredentialsMethod = xlCredentialsMethodIntegrated .AlwaysUseConnectionFile = False End With With ActiveWorkbook.Connections("接続1") .Name = "接続1" .Description = "" End With ActiveWorkbook.Connections("接続1").Refresh ActiveWorkbook.RefreshAll end sub つまり Application.ActiveWorkbook.Path が現在のフォルダー名を持ってきます。 こいつをBookのOpenで毎回走らせればリフレッシュです。 あとは不都合な部分をアレンジしてみてください。何時もフォルダ変更時にやってる操作をマクロ記録してみればこういう風に書かれるのでは？ マクロ付きExcelで保管することになりますが。
参考に http://filemaker-jp.custhelp.com/app/answers/detail/a_id/9033/~/ http://recstyle.blog6.fc2.com/blog-entry-87.html
> フォーム上に「yyyy/mm/dd」と日付を入力するテキストボックスを設けて、レポート上にそのテキストボックスの日付をソースにして表示させたいのですが、可能でしょうか？ レポート上のテキストボックスのコントロールソースを下記のように設定すれば、フォームのテキストボックスの値を表示させることができます。 =Forms!フォーム名!テキストボックス名 > より詳しいことを申し上げると、クエリ内で「between」を使っています。 > 開始日と終了日のふたつの日付を表示させたいのです。 レポートのレコードソースがクエリで、抽出条件の between の値をフォームのテキストボックスを参照したいということでしょうか。 同じく、下記のように設定すればいいでしょう。 Between Forms!フォーム名!開始日 And Forms!フォーム名!終了日
>>・先駆者がいてそれじゃ不十分だから発展していったのか、 そうだと思います。 >>・そもそものＥＲ図の使用度。そんなに使う？の意味合いで いままでの開発経験では、一番良く使われる資料でした。 >>・使い分けされてるのか、→だとしてその使い分けは？どれが頻度高いのか ＥＲ図なんてエンドユーザは関係無いものです。自分たちが分かりやすく、使いやすいものが一番です。 些細な記述上の相違よりも、ＥＲ図を作るツールの値段や、使いやすさで決まることが多い気がします。 つまりは、「あれがベストだけど、手が出ないんだよ。で、次善策としてフりーのコレ」となったりします。
こんにちは。 1）旧書式も新書式もEXCELで作成。 2）旧書式２号は、原紙（フォーマット）となるシートをもとに、 　 工事現場毎に構成は変えず、データ入力したものを別ファイルで作成している。 　 （行・列・セル番地などの配置が変わらない←ココ重要です） 3）旧書式の当該シート内のセルから、他のシート・ファイルへのリンクは無い。 3）別途、個人データ用のデータベースなどは作成されていない、必要としない。 4）基本的に、旧書式に入力済みの個人データに変更は無い。 上記を前提とするならば、 新書式５号の様式追加・変更部分（健康保険や年金の欄？）を確認して、 別々のファイルに散らばっている、２号の対象となるシートを ひとつのファイルに集めて（念のため[シートのコピー]）、 [作業グループ]としてから、 行や列の追加、幅・高さの調整、文字の修正など、一括でシートの修正を行ってはどうでしょう？ この方法であれば、元データをそのまま使用するので、 切り貼りする手間は少なくなるかと思います。 シート名が重なってしまうので、ひとつに集めた段階と元のファイルに戻す際に、 シート名の変更をする必要が出てしまいますが。 ※新書式にて、追加変更を加えた状態での出力確認は、先に行われたほうが良いですね。
UPDATE テストTB A INNER JOIN テストTB B ON A.責任者名 = B.社員名 SET A.責任者ID = B.社員ID という感じでどうでしょう？
SELECT 商品コード,数量 FROM 注文テーブル GROUP BY 商品コード まず、このSQLでエラーが出ますね。下記の書き間違いですよね。 SELECT 商品コード, Sum(数量) AS 合計 FROM 注文テーブル GROUP BY 商品コード; で、サブクエリを使うなら、 SELECT 商品コード, Sum(数量) AS 合計, (SELECT Sum(数量) FROM 注文テーブル T WHERE T.フラグ='x' AND T.商品コード=注文テーブル.商品コード) AS X合計 FROM 注文テーブル GROUP BY 商品コード; しかし、サブクエリを使わなくても、下記でシンプルに求められます。 SELECT 商品コード, Sum(数量) AS 合計, Sum(IIf(フラグ='X',数量,0)) AS X合計 FROM 注文テーブル GROUP BY 商品コード;
Ｄ１セルに次の式を入力して下方にドラッグコピーします。 =IF(AND(LEFT(A1,1)=1,B1="男",C1="無"),1500,IF(AND(LEFT(A1,1)=2,B1="女",C1="有"),1000,""))
一般的には、 【Ａ】顧客テーブル 主キー(1)顧客ID（オートナンバー・・・長整数型） (2)氏名（テキスト型） ※同一顧客で複数の発注を受けたら同じ顧客IDを使うように考えます。 （発注コードは入れるべきでない） 【Ｂ】商品テーブル 主キー(1)商品ID（オートナンバー・・・長整数型） (2)品名（テキスト型） (3)単価（通貨型）・・・定価があるなら設ける。 ※同一商品で複数の発注を受けたら同じ商品IDを使うように考えます。 （注文番号は入れるべきでない） 【Ｃ】注文テーブル 主キー(1)注文ID（オートナンバー・・・長整数型） (2)日付 (3)発注コード（テキスト型） 　　　　　　　※発注コードは『英数字』のためテキスト型。リンク元も『テキスト型』 (4)顧客ID・・・顧客との紐付けはこの項目で行う。 【Ｄ】注文明細テーブル（注文番号は全て4ケタの数字です。重複Noはありません） 　主キー(1)注文明細ID(オートナンバー型・・・長整数型） 　(2)注文ID（長整数型） または 　(1)注文ID（長整数型） (2)枝番・・・1から連番 主キーは(1)と(2)のセット (3)注文番号(数値型・・・長整数型) (4)商品ID (5)数量（注文番号1） (6)単価（通貨型）・・・商品マスタの単価はいつでも同じではないので、注文と一致しないことあり。 金額は、数量×単価で求めるか、別途(7)金額を設けるか。 （金額設定の仕方によりけりで、3本1000円とかがあるなら、(7)金額も必要。） 注文明細テーブルは、「ひとり最大50個の商品を一枚の注文書で発注します」に対応して、 １枚の注文書で、最大50レコード作ります。 リレーション 【Ａ】(1)-【Ｃ】(4) 【Ｂ】(1)-【Ｄ】(4) 【Ｃ】(1)-【Ｄ】(1)か(2) というふうにしますが。 （まずは、何でこういう設計にするのか、現状との違いから話をしていったほうが 　いいのかなと思います。 　⇒現状のほうがいいというのなら、それで話を進めてもいいのですが、 　　後の実績抽出は処理が面倒になると思っておいてください。）
対象の Excel ファイルを一時的に別名 (必要であれば別の場所に) コピーして、コピーしたものを開くようにしたらどうだろうか。 これなら 「対象のファイルが存在するか」 というチェックを事前に行うことも可能なので、誰かが対象のファイルを間違って消してしまった場合にもプログラムでエラーを検知できる。
>【Ａ】顧客テーブルは　(2)の発注コードが主キー >【Ｃ】注文テーブルは、(1)のID（オートナンバー）が主キーです。 これはOKです。ただし、注文テーブルのID は 注文ID というように内容が分かる名前に変更しましょう。 >【Ｂ】商品テーブルは、(1)のID（オートナンバー）が主キー これは、ID を主キーにするなら、リンク先も ID(長整数型)にする必要があります。 注文番号をリンク先に格納したいのなら、「注文番号」を主キーにする必要があります。 注文テーブルは、下記のように２つに分割してください。 【Ｃ】注文テーブル 　　　(1)注文ID（オートナンバー） 　　　(2)発注コード 　　　(3)日付 　　　(4)氏名 ←この氏名が顧客テーブルの氏名ならば、このフィールドは不必要 　　　　　　　　　担当者とか別の内容のデータならOK、その場合は意味を表すフィールド名に変更したほうがよい。 【Ｄ】注文明細テーブル 　　　(1)注文明細ID(オートナンバー型） 　　　(2)注文ID（長整数型） 　　　(3)注文番号　　←商品テーブルの主キーが「注文番号」の場合 　　　(4)数量
update "store_table" set "t_tiket" = "取扱っている" where "kaiin_no" = ANY('{"100","101","103"}'); ではないですか？ IN句使うなら、それでも問題なさそうですけど
DCount で件数を取得して、それから連番を生成してますね。 途中のレコードが1件削除されてませんか。 そうすると連番が重なるようになります。 DMaxで最大値を取得するようにすればいいと思いますが、区分や年月などの余分な情報が付いているためそれを除いた最大値を取得する必要がありますね。 Me![契約NO] = Me![区分] & "-" & Me![コード] & Format(Me![入力日], "yymm") & "-" & Format(Val(DMax("Right([契約NO],4)", "取引台帳")) + 1, "0000")
そりゃあ、"○○.csv”と、"C:\hogehoge\インポート\インポート済み\○○.csv"を比較したら絶対に一致しませんよ。 以下の様で良いかと（動作未確認） If strFile = strImportedFile Then ↓ If strFile = Dir(strImportedFile) then
以下でどうですか。 UPDATE 修正TB INNER JOIN 参照TB ON (修正TB.F8 = 参照TB.F8) AND (修正TB.F6 = 参照TB.F6) AND (修正TB.F1 = 参照TB.F1) SET 修正TB.F2 = [参照TB].[F2], 修正TB.F7 = [参照TB].[F7] WHERE (((修正TB.F1)=[参照TB].[F1]) AND ((修正TB.F6)=[参照TB].[F6]) AND ((修正TB.F8)=[参照TB].[F8]));
この辺を参考に http://dev.mysql.com/doc/refman/5.1/ja/connecting.html ただしコマンドラインでつなぐ意味がないので phpMyAdminなどでブラウザ経由で接続した方がなにかと便利です
都道府県テーブル を変更することが可能なら、 下記のようにするのが一番簡単でしょう。 m_prefecture prefecture_ID　prefecture_name 0　---選択してください--- 1　北海道 2　青森県 3　岩手県 コンボボックス 名前　cb都道府県 値集合ソース SELECT m_prefecture.prefecture_ID, m_prefecture.prefecture_name FROM m_prefecture; 規定値　0 連結列　1 列数　2 列幅　0cm フォームの 更新前処理 で、 Private Sub Form_BeforeUpdate(Cancel As Integer) If Nz(Me.cb都道府県) = 0 Then Cancel = True MsgBox "都道府県を選択してください。" Me.cb都道府県.SetFocus End If End Sub
条件に"カラム=" & "'" & Replace("テキストボックス","'","''") & "'" としてあげれば、' の存在を気にする必要は無くなるのでは？
顧客リストの規模とか使い方によりますね。 ただ、さっぱりわからないなら、そういった方がいいと思います。 相手があなたに十分なコンサル能力というか技術的な能力がある事を期待している以上、相手の意図が分からない場合でも、自分の知識でわからない場合でも分からないので相談することが必要な内容だと思います。 今後毎回ここで質問してもいいですが、その結果困るのはあなたでは無いでしょうか。
> 仰る方法で3つのレポートが一つのページにまとまりましたが、各サブレポートのページヘッダーが表示されません。 サブレポートではページヘッダーは表示されません。 ページヘッダーに配置している項目を、レポートヘッダーに移動させてください。 そうすれば表示されます。 > また、3つのレポートのソースになっているクエリは、パラメータクエリなのですが、まとめたレポートを表示させるたびに値の入力（具体的には「日付」なのですが）をレポートの数の回数分求められます。一回で済ませられないものでしょうか？ レポートを呼び出すフォーム上にテキストボックスを配置して、そこに日付を入力するようにします。 クエリのパラメータはそのテキストボックスを参照するようにします。 テキストボックスを参照する書式 [Forms]![フォーム名]![テキストボックス名]
Accessで処理をしたいということで。 関数を作成してクエリで使用します。 標準モジュールに以下を貼り付けます。 DAOをつかっているのでコード表の ツール→参照設定で Microsoft DAO xx Object Library にチェックを入れておいてください。 xxは3.6のような数字です。 テーブル名は実際にあわせて変更してください。 Function funcStr(ByVal mystr As String) As String 　　Dim db As DAO.Database 　　Dim rs As DAO.Recordset 　　Dim strBuf As String 　　Set db = CurrentDb 　　Set rs = db.OpenRecordset("テーブル1") 　　If rs.RecordCount > 0 Then 　　　　rs.MoveFirst 　　　　Do Until rs.EOF 　　　　　　If mystr = rs!品目コード Then 　　　　　　　　strBuf = strBuf & rs!区分 & "," 　　　　　　End If 　　　　　　rs.MoveNext 　　　　Loop 　　　　If Right(strBuf, 1) = "," Then 　　　　　　strBuf = Left(strBuf, Len(strBuf) - 1) 　　　　End If 　　　　funcStr = strBuf 　　End If 　　rs.Close: Set rs = Nothing 　　db.Close: Set db = Nothing End Function 次に以下のようなクエリを作成してみてください。 テーブル名は実際にあわせて変更してください。 SELECT テーブル1.品目コード, funcStr([品目コード]) AS 区分 FROM テーブル1 GROUP BY テーブル1.品目コード;
こんな感じで。 Dim strFile As String Dim strPath As String strPath = CurrentProject.Path & "\インポート\" strFile = Dir(strPath & "*.csv") If strFile <> "" Then 　　DoCmd.RunSQL "DELETE * FROM tbl_import" 　　DoCmd.TransferText acImportDelim, "インポート定義", "tbl_import", strPath & strFile, True 　　Name strPath & strFile As strPath & "インポート済\" & strFile End If
大変申し訳ありません。 私の勘違いだったようです。 検証結果、条件に合致しない場合には、EOF BOF ともに True になりました。 迷宮に入っていたのはヘルプを~@;}%した私でした。 orz こちらでは何故か、主キー設定無し・全てのフィールドでインデックス無し にしても機能しました？ >1つ目のメールアイテムに対して・・・ こちらです。
No1です。式の中のファイル名が違っていました。 ついでに定義名もぬけていたので、 \Honkasei.csv　　→　seikyu.csv なので、 DoCmd.TransferText acExportDelim, , "Tbl_output エキスポート定義", "tbl_output", CurrentProject.Path & "\seikyu.csv", True ですね。 No1を補足すると、mdbと同じディレクトリにする場合は、 CurrentProject.Path & "\seikyu.csv" のように、CurrentProject.Pathを指定することで可能になります。 しかし、いずれにしてもCurrentProject.Pathを使うことは 内部的にはフルパスを指定することと同じであることには かわりありません。
エクセルやテキストでも書き出せますが、更新されたレコードに フラグを立てたりして区別できるのであればFMファイル同士で レコードのインポートができます。 各レコードにシリアル番号などが付いている場合、それを照合し て旧ファイルには無いレコードのみを追加することも可能です。
クエリが更新可能なら変更できるし、 更新不可能なら更新できません。 URLはクエリが更新可能/不可能の 判断基準が掲載されています。 理屈はともかく、クエリをデータシートで 開いた時に、新規行が入力可能ならば 更新も可能です。新規行が表示されない 場合は参照のみのクエリです。
＞ ソフトはマック 「マック」ってこれ↓のことですか? http://www.apple.com/jp/osx/ もしそうなら、たいていOS X標準の印刷機能を使ってPDFファイルに転換できますので、コンビニに持ち込んでプリントできます。 くわしくは、コンビニの店員にお尋ねください。 http://www.lawson.co.jp/service/counter/copy.html http://www.sej.co.jp/services/print_document.html
クエリでの表示になりますが、以下でどうでしょうか SELECT Q1.オーダーID, Q1.商品コード, Q1.数量, Q1.お店番号, IIF(Q2.商品コード Is Null,"×","○") AS 判別 FROM 注文テーブル AS Q1 LEFT JOIN 確認用注文テーブル AS Q2 ON (Q1.数量=Q2.数量) AND (Q1.お店番号=Q2.お店番号) AND Q2.商品コード Like '*' & Q1.商品コード & '*'; DLookup するのであれば、上記クエリに対して XX = DLookup("判別","クエリ名","商品コード=' & [商品コード] & "'") とかすれば良い様な気がします。 上記クエリを使わない方法としては、DLookup内にゴリゴリ記述すれば良さそうです。 例えば、テキストボックスのコントロールソースに =IIF(IsNull(DLookup("商品コード","確認用注文テーブル", "数量=" & [数量] & " AND お店番号='" & [お店番号] & "' AND 商品コード Like '*" & [商品コード] & "*'")) ,"×","○") とか・・・ ※ [ ] で囲っている部分は、注文テーブルでのものになります。 ※ 処理性能はわかりません。
スキーマ(ベンダーによってはデータベースとも呼びますね)が別なテーブルを使った差分ということでいいんですよね？ 例として、サーバAにdb1, db2スキーマが存在する場合は、「スキーマ名.テーブル名.カラム名」で参照することが可能です。 また、サーバAにdb1,サーバBにdb2というように各スキーマが別サーバにあるような場合は、ベンダーごとに変わってきます。 このような場合は各ベンダーのリファレンスを参照して、それにあわせたクエリを書く(または接続方法や接続ユーザの権限を 適切に設定する)ことになります。 また、同一スキーマのテーブルであれば、「テーブル名.カラム名」で参照することが可能です。 どちらの方法でも並び替えであれば、 「order by スキーマ名.テーブル名.カラム名 - スキーマ名.テーブル名.カラム名 asc(またはdesc)」 で並び替えが出来ます。
## 問題見てないけどこの質問内容なら。 入庫情報に"出庫番号"属性がある。 ”入庫元拠点コード”属性は、"出庫番号"属性から参照できる。 しかし、解説にあるように "出庫番号"属性から参照した"入庫拠点""対象部材""入庫数"の各属性は、 実際に入庫される時点で異なっている可能性があるので、 別途保持しないといけない。 というのは、配送先がｘｘ倉庫のはずがｘｘ営業所に持って言ってしまい、間違えたのはわかっているがいったん営業所在庫とする⇒"入庫拠点"が一致しない。 配送するときに入れ間違えたため"対象部材"が違っていた⇒"対象部材"が一致しない。 配送中に１個壊れてしまった。⇒"入庫数"が一致しない。 （壊れた処理を入庫側で行うなら一致させて壊れた処理をしてもいいのですが、出庫側で行うなら、 　一致させてはいけないです。出庫側で、１個出庫取り消しして不良品振り替えします。） ※入庫拠点の在庫を正しくしようと考えるので出庫と一致しない入庫を可能にしないといけないです。 一方で、"出庫番号"に対する”入庫元拠点コード”（つまりは、出庫した元拠点）は、 入力ミス以外にかわる可能性がないです。（入力ミスなら元を変えるだけ。） ということで別途保持する必要はないです。 ※出庫した拠点の情報は、入庫拠点の在庫に影響ないです。 ## 個人的意見：関係スキーマとかいうからややこしくて、普通に業務を考えたほうが簡単なのに～ ## と思ってしまうようなケースですね。
まずは、B-PCのAccessのツール→オプション→詳細タブの 既定の開くモードが共有モードになっているか を確認してください。 なお、既定のレコードロックは、編集済みレコード レコードレベルでロックして開く にチェック もお勧めします。 これでダメならA-PCのアクセス権の設定かもですね。 ちなみに現状の使い方はMDBファイルを壊す危険性が大です。 せめてデータ部分（テーブル）とそれ以外は分けた方が。。 http://office.microsoft.com/ja-jp/access-help/HP005240860.aspx
普通？はグローバルフィールド(G)に表示したい画像を入れておいて オブジェクトフイールド（いつもは空っぽ）の計算式を =Case ( Get ( レコード番号 ) = Get ( 対象レコード数 ); G)　とします。 Get ( 対象レコード数 )にしておかないと検索等で絞り込まれたとき 最終レコードになりませんから・・・・ オブジェクトフィールドを背景色で塗り潰しましょう。
＃２です では、以下でどうなりますか SELECT Q1.契約番号, Q1.契約種別, Q1.明細契約年月日, Q2.基本SEQ, Q2.契約者名, Q2.基本契約年月日 FROM 契約明細 AS Q1, 契約基本 AS Q2 WHERE Q2.基本SEQ = (SELECT TOP 1 基本SEQ FROM 契約基本 WHERE 契約番号=Q1.契約番号 AND 基本契約年月日<=Q1.明細契約年月日 ORDER BY 基本契約年月日 DESC, 基本SEQ DESC);
>sFileName = oWH.specialfolders("DeskTop") '此処でデスクトップのPathを得ています。 >sFileName = sFileName & "\" & "1234.xlsx" ここでファイル名を、★ → 1234 に↑代えてますから ★は見つからない・・・ということでは？ ついでに ～前略～ Set oSH = Nothing Set oBK = Nothing Set oXL = Nothing createObject("Shell.Application").shellExecute sFileName End Sub と一行加えてください。 保存されたエクセルファイルが開かれます。
No.1です。 各プロパティは私も同じでした。 「すべてのフィールドの固定解除」もやったり逆に固定もしてみましたが、 どちらでも、幅は固定できます。 確認なのですが、フォームビュー/レイアウトビュー/デザインビューのうちのレイアウトビューで幅を変更→上書き保存されてますでしょうか？ （該当のフォームのタブを右クリックして選ぶか、アプリケーションのウインドーの右下にある３つの小さいアイコンのうち、真ん中のものをクリック）
CPUの性能が違います。 富士通Lifebook MH20/C　Atom N455(1.66GHz/1コア/キャッシュ512MB) 東芝Dynabook N300/02DC Atom N570(1.66GHz/2コア/キャッシュ1GB) 下記のwebを参考にされると判りますが、CPUの性能が倍ぐらい違います。 http://botchyworld.iinaa.net/cpu.htm 購入先はどこでも変わりません。単純にCPUの性能だけでLifebook の方が動作が重く感じるのでしょう。 以上、ご参考まで。
リンクテーブルはODBCで接続可能なデータベースであれば設定可能だったと記憶しています(ODBCは分かりますよね…？)。 そのため、ODBCで接続できない状況にある場合は出来ません。 GUIで操作したい、というだけならネイティブ接続が可能なフリーソフトがありますので、 クエリを発行するのが面倒でなければこちらでもいいかと思います。 http://www.hi-ho.ne.jp/tsumiki/ また、他の方が勧めているようにphpMyAdminなどを入れてみるのも手です。 ただしブラウザベースなのでaccessとは使い勝手はもちろん違います。 ちなみに、webサービスのシステムだとは思うのですが、管理画面はないんでしょうか？ 通常管理画面上でデータの追加や修正ができるようにするのが普通だと思いますが、 フロントエンドだけ作ってバックエンドは何もなしだったりすると、それはそれでシステムと見た場合にまずい気はします。 直接クエリを実行して変更することもありますが、経験上それはよほど大規模なデータ修正や構成変更があった場合のみです。
temp = dmax("表記", "T_時間帯", "開始 <= #" & Me.時間帯 & "#") でどうですか？
Accessは勝手にSQLを投げます。これはODBCなどの仕様にもなります。 要するにAccessは一人で使うもの。だからリソースをふんだんに使ってよいという設計になってます。 SQLサーバーに限らずOracleでも複数人で使うDBはPG側で考慮が必要なので、TBをスクロールするなどの処理は避けます。というような基本的な事は後で学んでください。 パフォーマンスを上げる事だけに特化すれば、まずその情報は何を基準に検索するのか。どのキーでビューを作成しているのか。 キー項目ならインデックスは自動で付加されますが、キー項目以外でリレーションを張る場合は、対象の項目にインデックスを張る。さらに検索対象の項目にもインデックスを張ります。 インデックスは多ければ今度は更新時に遅くなります。その辺はDB設計に考慮を組み込んでおきます。 またAccessはテーブルリンクは使わない。TBになるものを全てパススルークエリで作ります。 つまりAというTBをリンクするのではなく、SELECT * FROM Aというクエリをパススルー定義で作り参照するという苦肉の策です。本来は目的の情報だけをAccess側で扱うようにするため、SELECT　XXX,XXX,XXX,XXX from　A Where XXX = 'YYY' とちゃんとそのたびにクエリをパススルーで投げるのが一番です。そのためにはパススルークエリをADOXでそのたびに作成する必要があります。 そこまでやるなら、VBAで全て書き直しEXCUTEした方が早いです。 さらに早くするのはストアドプロシージャをSQL上に作成し、変数を投げて結果だけを取得するなどしてください。
DESCRIBE TABLE [テーブル名]; ですかね。
単純にメールを送るだけなら、1の方が書いた方法で可能です。 ただし、Filemakerのメール送信機能は文字コードの問題で、携帯等で化けやすいです。 その場合は、プラグインがいくつかあるのでこれらを利用します。 http://manual-mailmakerpop.joy-h.com/
クロス集計クエリの部分だけで良いですか？ クエリの表示結果は添付図の様になります。 テーブル名を ★★ と仮定します。 TRANSFORM First(Day(来店日)) AS 値 SELECT Year(来店日) AS 年, クライアントID FROM (SELECT Q1.クライアントID, Q1.来店日, Count(*) AS CT FROM ★★ AS Q1 INNER JOIN ★★ AS Q2 ON (Q1.クライアントID=Q2.クライアントID) AND (Format(Q1.来店日,'YYYYMM')=Format(Q2.来店日,'YYYYMM')) AND (Q1.来店日>=Q2.来店日) GROUP BY Q1.クライアントID, Q1.来店日) AS T1 GROUP BY Year(来店日), クライアントID, CT PIVOT Month(来店日) & "月"; ※ PIVOT Month(来店日) & "月" のまま 10月以降も表示しようとすると、順が狂います。 その時には、クエリ列見出しを設定してください。 たぶん、以下の様な感じに PIVOT Month(来店日) & "月" IN ("1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月") ※ 処理性能はわかりません ※ 不都合あれば修正してください
簡単なのは 元レイアウトに「検索モード」というボタンを作ってレイアウト切り替え（レイアウト2へ） にしておく。 新規レイアウトでレイアウト2を作り、検索条件入力用のグローバルフィールドを置き その横に「検索実行」ボタンを配置。 検索実行ボタン用のスクリプトを作る。 　・切り取り　グローバルフィルド 　・レイアウト切り替え　元レイアウト 　・検索モードに切り替え　一時停止しない 　・貼り付け　検索するフィールドに 　・検索実行　条件を記憶しない 検索レイアウトに移動する部分を新規ウインドウにしてウインドウサイズ変更などを 加えると、よりそれらしくなります。 検索実行スクリプトは検索しても該当するレコードが無かった場合等のためのエラー 処理も考えて下さい。
普通（かどうかは知りませんが）こういう要件のときは、 部屋ID=A で '2013-03-22 11:00:00' から '2013-03-22 15:00:00' と画面で入力されたとすると、 SELECT count(*) FROM 予約テーブル WHERE 部屋ID=A AND 開始時刻<'2013-03-22 15:00:00' AND 終了時刻>'2013-03-22 11:00:00' の結果が0でなければ重複しているとしてエラーにします。 00:00は含まれないので、データの持ち方は、00分00秒でＯＫです。 なにをやっているかの補足： AND 開始時刻<'2013-03-22 15:00:00' は、開始時刻が入力した終了時刻以降のものは関係ありません。 （今回の予約時間が終わってから始まります。） AND 終了時刻>'2013-03-22 11:00:00' は、終了時刻が入力した開始時刻以前のものは関係ありません。 （今回の予約時間が始まる前に終わってます。） ⇒上記以外とは、今回の予約時間が終わる前に始まり（今回の予約開始前か予約開始後かは問わない） 今回の予約時間が始まる前には終わっていない（今回の予約終了後か予約終了前かは問わない） 予約が既にあるということを調べています。
NOが主キー、CDとDATEはCD1・DATE1から順に設定されていくという前提で、 select COUNT(*), CD1, CD2, CD3 from ( --DATE1、DATE2、DATE3の全てが一致 select T1.CD1, T1.CD2, T1.CD3 from T T1 where exists ( select * from T T2 where T1.NO <> T2.NO and (T1.CD1 = T2.CD1 and T1.DATE1 = T2.DATE1) and (T1.CD2 = T2.CD2 and T1.DATE2 = T2.DATE2) and (T1.CD3 = T2.CD3 and T1.DATE3 = T2.DATE3) ) union all --DATE1、DATE2のみが一致 select T1.CD1, T1.CD2, null from T T1 where exists ( select * from T T2 where T1.No <> T2.NO and (T1.CD1 = T2.CD1 and T1.DATE1 = T2.DATE1) and (T1.CD2 = T2.CD2 and T1.DATE2 = T2.DATE2) and ((T1.CD3 is null and T2.CD3 is null) or ((T1.CD3 = T2.CD3) and ((T1.DATE3 <> T2.DATE3)))) ) union all --DATE1のみしかデータがない select T1.CD1, null, null from T T1 where T1.CD2 is null ) group by CD1, CD2, CD3; とか。 やりたいことを正しく理解できているか分かりませんが。
DB2が手元に無いので一般論的な事を・・・。 まず、SQLのチューニングをする場合、何はともあれ EXPLAIN は取りましょう。 http://www.atmarkit.co.jp/fdb/rensai/db2bestprac06/db2bestprac06_3.html EXPLAIN の結果を見て、時間が掛かっていそうな箇所を重点的に改善するのが良いでしょう。 なお、DB2で出来るかどうかは分かりませんが、EXPLAINにて各ステップの実際の実行時間が取れる機能があるなら、それを見るのが一番です。 SQLを修正する方向性としては、下記の様な点が挙げられるでしょう。 a. 大きなテーブルのシーケンシャルスキャンが起こらないように b. JOINは極力絞り込んでから c. ディスクソートが起きないように aを実現するためには結合や絞込みで極力INDEXを使うように書くことがポイントになるでしょう。 この質問のSQLについては、パッと見、A2TBL, A3TBL, A4TBL の NUMBER, MACHIN_ID, TYPE 辺りにインデックスを貼っておくと効果が有るかも知れません。 下記のページも参考になると思います。 http://www.geocities.jp/mickindex/database/db_optimize.html http://itpro.nikkeibp.co.jp/article/COLUMN/20070919/282395 http://itpro.nikkeibp.co.jp/article/COLUMN/20071012/284416 それから、～～～ LIKE '%' は無意味な気がするのですが・・・。もしかして IS NOT NULL の代わりですか？
> フォームでアルバム名のコマンドボタンをクリックしたら、そのアルバムを全曲（アルバム単位で一曲目から最後の曲まで）を再生することはできるでしょうか。 プレイリストファイル(～.wpl)を作成し、そちらをMedia Playerで開くとかでは。 wplファイルはテキストファイルですし、タイトルと曲名書き換えれば使えるでしょうから、適当なプレイリスト作って内容確認してみるのが良いです。
「オブジェクト・・・・・が見つかりませんでした」 "・・・・・" が最大のヒントだと思うのですが、、、 そんでその mdb を開いたときに期待する本来の動作はどうなのか、と。 どこかに置いてあるテキストファイルとかを自動的にインポートするようにしてあるとか、何か外部との連携を取ろうと設定してあるとかね。 その外部に置いてある何かへのパスが今回の PC から見つからない場所になってしまっているとか。
アクセスやめてFilemakerにすると簡単にできますよ。
そのフォームは単票でしょうか。 帳票なら以下の方法ではできません（コントロールを重ねないと不可能だと思います。） 現状のフォームをコピーし、コピーした方で動作確認してみます。 レコードが更新されても良いようにバックアップは取っておきます。 コピーした方のフォームに記述してあるイベント関係のものをすべて削除し、 以下の記述と置き換えてみます。 Private Function EnterCheck() 　　Dim vN As Variant 　　Dim i As Long, j As Long 　　vN = Array("大分類", "中分類", "小分類") 　　For i = LBound(vN) To UBound(vN) 　　　　If (Me.ActiveControl Is Me(vN(i))) Then 　　　　　　For j = LBound(vN) To i - 1 　　　　　　　　If (IsNull(Me(vN(j)))) Then 　　　　　　　　　　Me(vN(j)).SetFocus 　　　　　　　　　　Exit Function 　　　　　　　　End If 　　　　　　Next 　　　　　　Exit For 　　　　End If 　　Next 　　With Me.ActiveControl 　　　　.Requery 　　　　.Dropdown 　　End With End Function Private Function UpdateCheck() 　　Dim vN As Variant 　　Dim i As Long, j As Long 　　vN = Array("大分類", "中分類", "小分類") 　　For i = LBound(vN) To UBound(vN) 　　　　If (Me.ActiveControl Is Me(vN(i))) Then 　　　　　　For j = i + 1 To UBound(vN) 　　　　　　　　Me(vN(j)) = Null 　　　　　　Next 　　　　　　If (i <> UBound(vN)) Then 　　　　　　　　Me(vN(i + 1)).SetFocus 　　　　　　　　Exit Function 　　　　　　End If 　　　　　　Exit For 　　　　End If 　　Next End Function Private Sub Form_Load() 　　Dim vN As Variant 　　Dim i As Long 　　vN = Array("大分類", "中分類", "小分類") 　　For i = LBound(vN) To UBound(vN) 　　　　With Me(vN(i)) 　　　　　　.ValidationRule = "Is Not Null" 　　　　　　.OnEnter = "=EnterCheck()" 　　　　　　.AfterUpdate = "=UpdateCheck()" 　　　　End With 　　Next End Sub Private Sub Form_BeforeUpdate(Cancel As Integer) 　　If (IsNull(Me.小分類)) Then Cancel = True End Sub ※※ 操作は、必ず　"大分類" → "中分類" → "小分類"　の順であるとします。 ※ Enter 時の動き どのコンボボックスの Enter でも同じ処理を走ります。 まず、Enter になったのは「誰」を求めます。 求まったら、前操作のコンボボックスが入力されているか確認します。 値が設定されていなければ、そのコンボボックスにフォーカスを移動します。 値が設定されていれば、 Requery 後 Dropdown 表示します。 ※ AfterUpdate 時の動き どのコンボボックスの AfterUpdate でも同じ処理を走ります。 まず、AfterUpdate になったのは「誰」を求めます。 求まったら、後操作のコンボボックス値を Null に変更します。 次のコンボボックスにフォーカスを移動します。 ※ フォームのオープン時 各コンボボックスに上記関数を実行する様、イベントに設定していきます。 また、入力規則に念のため Is Not Null を設定しておきます。 既に値が設定されていて、Delキー 等で削除された場合エラーとなるように・・・ ※ フォームの更新前処理 コンボボックスは、必ず　"大分類" → "中分類" → "小分類"　の順と決めたので、 最後の Me.小分類 が Null なら Cancel = True として、更新を拒否します。 ※ コンボボックス３つの処理をまとめましたが、個別に記述しても良いと思います。 ※※ 検証等は十分に行ってください。また、不具合等あれば修正してください。
つうか、エクセルをデータベースみたいに使うほうがよっぽどつかえない。 エクセルの表でVlookup関数が使いたくなったら、私は迷わずアクセスにする。 エクセルで何とかできる程度のことなら、そんなに構えなくても、気軽にアクセスが使えるよ。 #1さんのご意見にことさら意を唱えるつもりはないけど、でも、ちょっと大げさじゃないかなぁ。 まずはクエリをつかえるようになればいいと思うな。 クエリこそがデータベースのかなめだからね。 とはいえ、みんなが使いたくないものを無理やりに使わせるわけにはいかない。 みんな新しいことを覚えたくないんだよ。 察するところ、エクセルおじさんばっかがいる職場じゃない？ワードを使う場面でも、パワーポイントを使う場面でもみんなエクセルで押し通す人のことを言っているんだけど。 余談だけど、そういう人がエクセルのことよく知っているかというとそうじゃなくて、ピポットテーブルとかいうと、？？？？？？ だったりするんだね。 そうそう、いきなりアクセスに飛ばずに、ピボットテーブルを作ってみるのも手だよ。 そういう性質の表なら、だけど。 あとは、いつまでもエクセルにしがみついている人は、そのままにしておいてあげて、あなただけアクセスに移行することもできるかもしれない。 エクセルのシートをアクセスから呼び出すことができるから(アクセスにリンク貼り付けする)、データはエクセルに入れたままにして、データの処理はアクセスでするんです。 もっともシートが、きちんとデータベースで処理できる形式になってなければいけないですけどね。
商品番号&"_"&色 などという計算フィールドを作って、これでソートするとGetSummary も使えます。 別テーブル（重複の無い商品マスタのような）からリレーションで集計した方がいいかも。
今朝がた回答した者です。 参考とすべきは、やはりここです。 RDBMSで使われるB木を学ぼう － ＠IT http://www.atmarkit.co.jp/fcoding/articles/delphi/05/delphi05a.html 論理的な「形」は上記サイトの絵のとおりです。 積み木の様なピラミッドのような。 物理的な「形」はPCやサーバーのディスクやメモリの中なので、人間に見える物ではありません。 「利点」は今朝も回答したとおり「索引」です。 参考サイトの絵のような木構造があるから、最短な道のりのランダムアクセスで目的のデータを取得できます。 木構造がない場合、シーケンシャルアクセスとなり、ブロックを一個一個見て周る事になり、目的のデータを取得するまでに時間が掛かります。 日常生活に置き換えると。 B-Tree を使ったランダムアクセス ↓ 近道を使用して目的地まで100歩。 道もキレイ（メモリに乗っている）なので凄く速く到着。 B-Tree を使わないシーケンシャルアクセス ↓ 近道を使わないで目的地まで2000歩。 道は普通の道（ハードディスク）。 凄く時間が掛かる。
文字コードの何を知りたいのでしょうか？ 文字コードについての全般的なことを知りたいのだったら、下記のページが参考になるかと。 http://ja.wikipedia.org/wiki/%E6%96%87%E5%AD%97%E3%82%B3%E3%83%BC%E3%83%89 http://itpro.nikkeibp.co.jp/article/COLUMN/20061122/254626/ http://euc.jp/i18n/charcode.ja.html
syscmd(acSysCmdRuntime) で取得できますよ。
はい。そのつもりで回答しました。 結果や如何に？ ※時間が重複している場合は考えてません 2013/03/01　　1111　　　　AAA　　　　09:00　　　　　　 10:00 ↓AAAさんが掛け持ちで何かやっている場合など 2013/03/01　　1111　　　　AAA　　　　09:00　　　　　　 10:00 2013/03/01　　1111　　　　AAA　　　　09:00　　　　　　 09:30 その他、未入力の場合など。 １２～１３時の処理ですが 前回回答では、8：40 ～18：00で考えてましたが 8:40 ～ 12:00 と 13:00 ～ 18:00 に分けて Where 終了時間 >= #12:00# Where 開始時間 <= #13:00# の二つのレコードセットでそれぞれ処理すれば良さそうです。 ただ、昼食時間をまたがっている場合があると・・・没。 2013/03/01　　1111　　　　AAA　　　　11:00　　　　　　 13:30 もっと洗練された考え方が有るような気がします。
> Me.Recordset.FindFirst "[社員番号]=" & Num 検索するのは親フォームではなくサブフォームですから 　Me.SF1.Form.Recordset.FindFirst "[社員番号]=" & Num だと思います。（未検証、まちがっていたら御免。）
この場合の SELECT * FROM 商品表　AS　商品表A WHERE EXISTS (SELECT * FROM 商品表　AS　商品表B WHERE 商品名 = 'BEER'); は、サブクエリの商品表Bに商品名がBEERのレコードがあれば、商品表Aのすべての行を抽出しなさい。 なので、このSQLでは商品表にBEERがあれば、BEERも含めてすべてのレコードが抽出されるし、BEERがなければ、１行も抽出されません。 > これは1行でも結果が帰ってきたら、それはTRUEとみなされて、EXISITSはサブクエリをTRUEと評価するということでしょうか？ 正しいです。１行でも見つかったらTRUEです。 EXISTS (SELECT * FROM 商品表 WHERE 商品名 = 'BEER') は (SELECT COUNT(*) FROM 商品表 WHERE 商品名 = 'BEER') > 0 と同じ結果が得られます。結果は同じですが、実行計画は異なりますので、応答時間とかは違ってくると思いますが。
次回からは、Accessのバージョンは明記するようにしましょう！ 操作方法が異なる場合があります。 2003以前なら参考にされたサイトのように 『並べ替え/グループ化』の設定で フィールド/式　　　　　　　　　　　　　　並べ替え順序 グループ化したいフィールド名　　　　　　　　昇順 NO.　　　　　　　　　　　　　　　　　　　　昇順 と[NO.]を追加すればできます。 >NO. というフィールド名は変更することを強くお勧めします。 http://support.microsoft.com/kb/286335/ja トラブルの元になりかねません。
試していませんが SELECT 会員番号,利用日,利用目的,使用器具 FROM 明細テーブル 　　　　　WHERE (会員番号,利用日) IN (SELECT 会員番号,MAX(利用日) FROM 明細テーブル GROUP BY 会員番号) でいけませんか？
第３正規化を突き詰めるから、、、ということにつきるかと 疑問１　構成（大問ID , 中問ID , 小問ID） 　小問ID は、中問ID に紐付いており（従属関係）、中問IDがあれば、小問は決定するので、構成table から小問の情報を分割可能 よって、大中（大問ID , 中問ID)と中小(中問ID , 小問ID) に分解すると、３つのIDを含む「構成」tableは不要となります 。 別の表現では、（大問 , 中問）の１ペアごとに複数の 小問の行が生成されるのは、大問の情報が無駄に複製されていると云うことである。この無駄な複製をなくすために、tableを分割するのが第３正規化 構成と同じ表は、以下のように join で作成可能 select lm.大問ID, lm.中問ID , ms.小問ID from `大中` as lm left join `中小` as ms on lm.中問ID = ms.中問ID 実際の運用では、join に無駄な時間が掛かると考えるなら、第２正規形のままとしたりもします。 疑問２　答案tableでも、上記の join 文を view にしておけば、大問ID から、中問や小問の問題文情報は全て得られるので、受講者IDと大問ID が紐付けば、そこにさらに中問IDや小問IDを含ませる必要はない。 あと、複数回解答の区別のために解答日時が連動キーとして用いられているので解りにくのだと思うが、 {受講者ID，大問ID，解答日時} の関数従属性として与えられる採点tableの各行に、採点id を振れば、解答tableにも日時カラムは不要になるだろう 　　ということで、同一受講者の同一大問IDへの複数回の解答を全部管理するなら、私ならこっちにするけど。元のtableにない解答idや採点idカラムを作ることは、この課題の目的ではないのだろう。というか連動キーそのままで理解出来るかを問うているのか。 回数{解答id, 受講者ID，大問ID，解答回数} 採点{採点id, 解答id，解答日時，解答時間，評点} 解答{採点id，小問ID，解答，得点}
新規ユーザーを作って試してみました。 Access（Office）を一回も開いていない状態 HKEY_CURRENT_USER\Software\Microsoft 下にVBA というキーは無し Access を立ち上げてテーブルを一個だけ作成 HKEY_CURRENT_USER\Software\Microsoft\VBA\7.0\Common まで出来て中味は↓だけ 名前 種類データ （既定）REZ_SZ （値の設定なし） Access閉じても変化なし Access立ち上げて標準モジュールに MsgBox "" だけのSub Module作成 実行しても変化なし Access終了後 （既定）、CtlsShowSelected、Dock、DsnShowSelected、FolderView、MainWindow MdiMaximized、OGGroupMembers、PropertiesWindow、Tool、UIAccess に増える。 （多分、モジュールの保存時に出来るものと思われるが確認漏れ） Access立ち上げてVBEのツール→オプションで、『自動構文チェック』のチェックだけ 外す。直後に （既定）、「AlignToGrid」、「AutoQuickTips2」、「AutoStatement2」、「AutoValueTips2」、 「BackGroundCompile」、「BackgroundProjectLoad」、「CollapseWindows」、「CompileOnDemand」、 CtlsShowSelected、Dock、「DragDropInEditor」、DsnShowSelected、「EndProcLine」、 FolderView、「GridHeight」、「GridWidth」、MainWindow、MdiMaximized、OGGroupMembers、 PropertiesWindow、「SaveBeforeRun」、「ShowGrid」、「ShowToolTips」、 「SyntaxChecking」、Tool、UIAccess、「UpgradeVBX」 に増える。（「」内は増えた分） Accessを再起動しても名前をその数には変化なし。 なお、本番環境だともう少し設定を変えてあるので３６個ありました。 （既定）、AutoValueTips2、AutoQuickTips2、AutoStatement2、DragDropInEditor RequireDeclaration、EndProcLine、CompileOnDemand、BackGroundCompile FontHeight、FontCharSet、FontFace、GridWidth GridHeight、ShowGrid、AlignToGrid、SaveBeforeRun ShowToolTips、CollapseWindows、UpgradeVBX、BackgroundProjectLoad PropertiesWindow、MainWindow、MdiMaximized、Dock FolderView、Tool、CtlsShowSelected、DsnShowSelected UIAccess、OBGroupMembers、UI、SyntaxChecking CodeForeColors、CodeBackColors、OBSearchHeight 数の多寡は関係ないような気がします。。。 （根拠はまったくありません） 何もしないのに数がちょこまかと増減したらマズイとは思いますけど。 それにしても解せない。 同一PC内でアカウントによって変わるなんて？ もしかして、アカウント名に日本語（全角文字）使ってるとか。 ミスリードが怖いので、少し回答を控えます。 明日は我が身かもしれないので、進展（解決）ありましたら教えてください。 最後に残念な苦言です。 困っていらっしゃるのは良く分かるのですが、 マルチポストは如何なものかと。 せめて、ここと、あそこと、あっちに同じ質問を立てています、 のようにしてください。 ↓をご一読ください！ http://stakasaki.at.webry.info/200512/article_3.html
英語版Wikipediaに掲載されている図がこちら。 http://en.wikipedia.org/wiki/File:SQL_ANATOMY_wiki.svg 命令文(statement)，節・句(clause)，述部(predicate)，式(experssion)という英単語が登場しています。 英語版Wikipediaに登場するClausesの説明文を日本語翻訳したのがこちら。 http://translate.google.co.jp/#en/ja/Clauses%2C%20which%20are%20constituent%20components%20of%20statements%20and%20queries.%20(In%20some%20cases%2C%20these%20are%20optional.) [10] ANSI/ISO/IEC International Standard (IS). Database Language SQL—Part 2: Foundation (SQL/Foundation). 1999. に登場する記述とのこと。
そのテーブルに、『非表示』というフィールドを加えます。 データ型は、Yes/No 書式は、True/False 『ルックアップ』タブに切り替えて、表示コントロールを「チェックボックス」に。 テーブルでは 非表示にしたい企業だけチェックを入れます。 クエリを一個作成して、非表示フィールドの抽出条件に、False とすれば？
以上と言いつつ、 最初の質問の Me.Refresh を見逃していました。 Me でフォーム全体のRefreshを行うのではなく 個々のコントロールのRefresh、Recalc、Requeryを行えませんかね？ Me!コントロール名.Re… ただ、Me.Refresh を外しても若干の改善となると。。。 実際にファイルを見られればもう少し何とかなるかも？ですが やり取りはこのサイトではご法度なのでゴメン。
Access Excel ともに2010で試しました。 パスワード・・のエラー発生。 ググリまくると http://www.access-programmers.co.uk/forums/showthread.php?t=220521 Franz Haidacher さんによれば Access2010 から採用された既定の暗号化方法（高度なセキュリティ）は ADO OLEDB では接続できないようです。 Accessのオプションのクライアントの設定から 以前の暗号化方法を使用するに変更したうえでパスワードを設定するしか 現在のところ方法がなさそうです。 (-"-) DAOなら・・・と試しましたが同じく orz
たぶん、 [Database].Offset(行 - 1).Resize(1).ClearContents で、１行上の行をクリアしているのでは？ 直後の [Database].Cells(行, 1) = txtNo.Value [Database].Cells(行, 2) = txtName.Text ・・・ を見ていると、 [Database].Offset(行).Resize(1).ClearContents とすべきでは？と思います。 ## 前の質問で大体見当はついたのだけど ## 書く前にクローズされていたようで。 ## でも、今回の質問のほうが全体のイメージが、かなりわかりやすいです。 ## →したがって、回答しやすいです。 ## 前回の質問では、Userformとかがどう絡んでいるのかまったくわからなかったので ## 回答書くのに躊躇して後回しにしていましたから。
列Ｊが１０列目、列Ｋは１１列目。 ＶＢＡ中に"１０"はあるが、"１１"が見当たらない。 もう一度、やりたいことを整理して。
スクリプトの課題ですよね？ 超手抜きの電卓作ってみましたよ。FM7～11用です。 リンク先からダウンロードして下さい。 12の場合は変換してください。 http://pupld.net/28/130205/df3y860kbh/index.cgi
OSは？ Win7あたりであれば「windows」キー＋Fで更新日を指定して検索とかできます
自宅にとか自宅でを聞いたのではないです。 パソコンとiPadを両方とも自宅に持ち帰ってという意味ですか。 でしたらwi-fi関連の問題になるでしょう。
＃１です > 通常状態で触れさせないようにする良い方法はないでしょうか？ VBA は大丈夫だったでしょうか。 考え方をちょっと変えてみます。 テキストボックス「テキスト0」をいじらせたくないので、Enabled / Locked で制御している。 ↓ テキストボックス「テキスト0」の Enter で異なるコントロールに Focus を移動する。 例えば、テキストボックス「テキスト0」の フォーカス取得時に以下を記述しておきます。 Private Sub テキスト0_Enter() 　　Me.テキスト1.SetFocus End Sub この場合、「テキスト0」にフォーカスが入ろうとした場合、「テキスト1」に無条件で移動させます。 意味合い的に、「テキスト0」にはフォーカスが入らないので修正等できません。 では、テキスト0.Text にどうやって値を設定し、イベントを発生させるかですが・・・・ 一旦、「テキスト0」の フォーカス取得時を無効にしてから設定して、終わったら戻します。 Dim ctl As Control Dim sS As String Set ctl = Me.ActiveControl sS = Me.テキスト0.OnEnter Me.テキスト0.OnEnter = "" Me.テキスト0.SetFocus Me.テキスト0.Text = "こんにちは" ctl.Setfocus Me.テキスト0.OnEnter = sS 今の アクティブコントロールを覚えておいて、 フォーカス取得時を無効にして、 "こんにちは"　を設定して フォーカスを元のところに戻して、 フォーカス取得時を有効にして・・・・ お礼にあった記述と変わらないですかね・・・・（上記コードは未検証） また、違う方法と言えば、手間でも自分で呼び出す・・・・ 設定後、「テキスト0」の更新後処理を動かしたい場合、 Me.テキスト0.Value = "こんにちは" Call テキスト0_AfterUpdate とすれば、同じことになると思います。 ※ フォーカスがあるうちに、Enabled = False はエラーになったような・・・・ ※ ご質問の内容をもう一度読み直してみました。 > テキストボックスの値を変更する段階で別のコードを入力すれば対応は可能なのですが、「テキストボックスの値を変更した時」のタイミングで別コードを動作させることで、コードをまとめたいと考えています。 という事ですが、アクセスで用意されているイベント（フォームに関して）は、操作する人がいること・・・ が、主だと思います。 VBA とかで値を設定する・・・・操作の範疇じゃないので自分で面倒をみることになると思います。 上記での SetFocus しないとイベントが発生しない・・・・操作していればあたり前のことなので・・・ Enabled = False / Locked = True にした状態のものの、変更イベントを取りたい・・・ 私にはチョッと理解できない部分になります。 ※ 他の方の回答を待ってください ※ 解釈違い等あれば、ごめんなさい。
テーマに連動しているようなのでできないです。
> Me![性] = Rs![性] 「指定された患者番号でレコードを取得して、内容を表示」はわかるけど テーブル構造もFormの項目も提示が無いので推測。 きっとどちらか、あるいは両方が定義されていない。 ホントに「性」ですか？姓名の「姓」が正解じゃないですか？ この手のものなら「性別」と定義していそうに思います。
そのまま作れますよ。 問題ごとの値一覧を作って、チェックボックスでは無くラジオボタン にします。 合計はSum(回答1;回答2;回答3・・・・)です。 回答フィールドは数字フィールドにしたほうがいいのかと思いました が、テキストフィールドでも数字部分だけ合計してくれますね。 何m歩けますかの問題の回答が 5点　5m 4点　4m ではダメですが。
V列の一番上の「V1」セルに以下の式を入力 =IF(ROW()=1,S1&"\"&T1,IF(OFFSET(S1,-1,0)=S1,OFFSET(V1,-1,0)&"\"&T1,S1&"\"&T1)) 入力したらV1セルを下方向の「V2」～「V10」にコピーする
郵便局のホームページから、適当に１県のデータをダウンロードして テーブルにし、降順のクエリーを作って、テキストにエクスポートしたところ問題はございませんでした。 あくまで仮定ですが、すべて７桁で揃っていますでしょうか。 （郵便局提供のデータでは頭にゼロがつく郵便番号にゼロがないデータでした。） 郵便番号は、数値型か文字列型かといえば、おそらく文字列型のほうが扱いやすいと思います。 詳細分かりませんので、まずは仮定ということでご容赦ください。
GoもiPhone、iPadも持ってませんが、Pro12のホストDBにアクセスして 使用する場合はPro12のオブジェクトフィールド内の画像を外部保存して あればいいはず。 DBをGoに転送している場合は、Pro12のオブジェクトフィールドに画像 を埋め込んでから転送しないと見えないはず。（各デバイスに画像の実体 が必要という意味で）
クエリーの機能を使って簡単に出来ます。 クエリーの抽出条件のところで、一つの条件を書き込み、その下の「または」のところに次の条件をそしてその下に３番目の条件を書き込めばよろしいです。
親と子の連動する部分は、宛名の会社の人と「同じ会社」の「ランク１のリスト」という点だと思います。 親には、印刷するしないに関わらず会社ＩＤを配置します。（会社ＩＤを印刷したくない場合には、プロパティの「可視」を いいえにします） サビレポートのプロパティ「データ」タブで「親フィールド」を「会社ＩＤ」「子フィールド」も「会社ＩＤ」にします。 サブレポートのデータソースは、クエリーで「社内ランク１」に絞り込んだ「氏名」および「会社ＩＤ」とします。 前述と同様手順でサブレポートの「会社ＩＤ」も非表示扱いにします。
＃４です ＃４の補足にあった > T_コーチマスタ(テーブルＡ) > ランク　ヒット数　 コーチ名 　担当者MAX > ---------------------------------------- > 　A　　　10　　　　　佐藤　　　　3 > 　A　　　 3　　　　 　鈴木　　　　3 は構成がおかしい(?)ので、上記「ヒット数」は考えないことにします。 ＃２でのVBAで 　　While (Not rsB.EOF) 　　　　If (sS <> rsB("ランク")) Then　' ★ 　　　　　　sS = rsB("ランク")　' ★ 　　　　　　rsA.Filter = "ランク='" & sS & "'"　' ★ 　　　　　　i = 1　' ★ 　　　　End If　' ★ 　　　　rsB("人数(連番)") = i 　　　　rsB("コーチ名") = rsA("コーチ名") 　　　　rsB.Update 　　　　i = i + 1　' ★☆★ 　　　　If (i > rsA("担当数MAX")) Then　' ★☆★ 　　　　　　rsA.MoveNext　' ★☆★ 　　　　　　i = 1　' ★☆★ 　　　　End If　' ★☆★ 　　　　rsB.MoveNext 　　Wend ★：選手側「ランク」が変わったか判別して、 　変わっていたら、その「ランク」のコーチを求め直して・・・ 　連番を 1 に ★☆★：連番をカウントアップして、 　そのコーチの「担当数MAX」を超えたら次のコーチにして、連番を 1 に なので > (最後の3までふられない理由は？) 確認された時の「担当数MAX」が 2 だったのでは・・・と思います。 （ 3 を 2 にする処理は入っていないので） ※ 以前は「担当数MAX」でしたが、＃４補足では「担当者MAX」になってますね テーブルは新しく作って変えたけど、VBAで参照しているテーブルは前のまま・・・とか？ この処理での大前提は、選手側のデータは「ランク」で並んでいる必要があります。 「ランク」で並んでいるのなら、そのランク内の並びは？？？ それを指定してあげればよいです。（それが＃３の冒頭に記述したものになります） 割り当てしたい順に並んでいる・・・・並んだ後は「ヒット数」等、確認はしません。 （なお、この前提以前に、１選手１データであること・・・・があります） コーチの方も、コーチの並び順を指定しておけば、その順は Filter 後も維持されるようです。 回答になっていたでしょうか？
ネットワーク フォルダーを使用してデータベースを共有する データベースを共有する最も簡単な方法は、データベースを共有ネットワーク フォルダーに格納することです。これはシステム要件が最も少なく最も簡単な方法ですが、堅牢性が最も低くなります。この方法を使用するには、次の条件を満たす必要があります。 データベースを同時に使用するユーザーが数人であると予想されること。 データベース内にメモ型フィールドが存在しないこと (存在する場合は、複数のユーザーによって同時に更新されることがないこと)。 ユーザーがデータベースのデザインをカスタマイズする必要がないこと。 メモ この方法では、各ユーザーがデータベース ファイルの完全コピーを保有し、無断アクセスのリスクが増えるため、他のデータベース共有方法よりもセキュリティが低くなります。 ネットワーク フォルダーを使用してデータベースを共有するには 1.共有ネットワーク フォルダーを設定していない場合は、共有ネットワーク フォルダーを設定します。 この手順の詳細については、データベースの共有に使用するコンピューターのオペレーティング システムのヘルプ システムを参照してください。共有フォルダーをネットワーク サーバー上に設定するときは、ネットワーク管理者への問い合わせが必要になる場合があります。 2.各ユーザーのコンピューターで Access が共有モードで開くように設定されていることを確認します。これは既定の設定ですが、必ず確認してください。データベースを排他モードで開いているユーザーがいると、データの可用性が低下します。各ユーザーのコンピューターで次の手順を実行します。 a.Access を起動します。 b.[ファイル] タブをクリックし、[オプション] をクリックします。 c.[Access のオプション] ダイアログ ボックスの左側のウィンドウで、[クライアントの設定] をクリックします。 d.[Access のオプション] ダイアログ ボックスの右側のウィンドウにある [詳細設定] セクションの [既定の開くモード] で、[共有モード] をクリックします。 e.[OK] をクリックし、Access を終了します。 3.データベース ファイルを共有フォルダーにコピーします。ファイルをコピーした後、ファイルの属性設定で、データベース ファイルの読み取り/書き込み権限が許可されていることを確認します。ユーザーがデータベースを使用するには、読み取り/書き込み権限が必要です。 4.各ユーザーのコンピューターに、データベース ファイルへのショートカットを作成します。 ショートカットの [リンク先] プロパティにデータベース ファイルへのパスを入力するとき、マッピングされたドライブ文字ではなく UNC アドレスを使用します。たとえば、F:¥sample.accdb の代わりに、¥¥computername¥shared.accdb を使用します。 メモ この手順はユーザー自身でも実行できます。 http://office.microsoft.com/ja-jp/access-help/HA010342110.aspx 上記の内容が参考になると思います。
基本的な流れは、ユーザー関数を作成して・・になります。 例えば 標準モジュールに Function delStr(delOrg As String, delList As String) As String Dim delAry As Variant Dim i As Integer delAry = Split(delList, " ") delStr = delOrg For i = LBound(delAry) To UBound(delAry) delStr = Replace(delStr, delAry(i), "") Next End Function とします。 左のフィールドのフィールド名が、F1 として下記が入ってると仮定 ブリキ看板 テキサコ ダルメシアン TEXACO ブリキカンバン ぶりき看板 ティンサイン サインボード インテリア TINサイン アメリカン雑貨 同様に右のフィールドのフィールド名が、F2 として下記が入ってると仮定 ブリキ看板 ブリキカンバン アメリカン雑貨 クエリのデザイングリッドに F1｜F2｜F3:delstr(F1,F2) とすればF3フィールドに結果が表示されます。 ただ、上の関数はあくまでも基本形ですので以下のような事が不明ですので 期待した結果が出ないと思います。エラー処理も入れてません。 １・ >ブリキ看板 テキサコ 文字と文字の区切りが半角スペースになっているが 全角スペースが紛れ込んでいないか ２・半角スペースが２個以上になっているのがないか ３・>TEXACO<=>texaco 大文字・小文字は同一視するのか ４・TEXACO<=>ＴＥＸＡＣＯ 半角・全角の場合は パッと思いつだけでも色々あります。
テーブル名を、T1 とした場合には SQL文では SELECT ID, 氏名, 科目, 点数 FROM T1 WHERE (科目 = '国語' AND 点数<=59) OR (科目 = '数学' AND 点数 <= 49) です。 クエリのデザインビューに切り替えても確認できます。 なお、フィールド名の 『No.』は適切ではないので 『ID』に変更しています。 http://office.microsoft.com/ja-jp/access-help/HA010030643.aspx
No1の訂正です。 ＞一応、数値が0であったり、抜けている場合は無視するように ＞しています。 の処理が不十分なコードを載せていました。以下のようにしてください。 Sub cmdxy() 　　Dim db As DAO.Database 　　Dim rs1 As DAO.Recordset 　　Dim rs2 As DAO.Recordset 　　Dim varArray() As Variant 　　Dim i As Long 　　Dim j As Long 　　Dim lnNum As Long 　　Set db = CurrentDb 　　Set rs1 = db.OpenRecordset("テーブル1", dbOpenDynaset) 　　Set rs2 = db.OpenRecordset("Qキー項目") 　　rs2.MoveFirst 　　Do Until rs2.EOF 　　　　'カウンタ、及び配列の初期化 　　　　i = 0 　　　　ReDim Preserve varArray(0) 　　　　'データの取込 　　　　rs1.MoveFirst 　　　　Do Until rs1.EOF 　　　　　　If rs1!キー項目 = rs2!キー項目 Then 　　　　　　　　If IsNull(rs1!数値) Or rs1!数値 = 0 Then 　　　　　　　　'何もしません 　　　　　　　　Else 　　　　　　　　　　varArray(i) = rs1!数値 　　　　　　　　　　ReDim Preserve varArray(UBound(varArray) + 1) 　　　　　　　　　　i = i + 1 　　　　　　　　End If 　　　　　　End If 　　　　　　rs1.MoveNext 　　　　Loop 　　　　'最小公倍数の計算 　　　　lnNum = varArray(0) 　　　　For j = 0 To UBound(varArray) - 1 　　　　　　lnNum = funcLCM(lnNum, varArray(j)) 　　　　Next 　　　　'最小公倍数の書き込み 　　　　rs1.MoveFirst 　　　　Do Until rs1.EOF 　　　　　　If rs1!キー項目 = rs2!キー項目 Then 　　　　　　　　If IsNull(rs1!数値) Or rs1!数値 = 0 Then 　　　　　　　　'何もしません 　　　　　　　　Else 　　　　　　　　　　rs1.Edit 　　　　　　　　　　rs1!最小公倍数 = lnNum 　　　　　　　　　　rs1.Update 　　　　　　　　End If 　　　　　　End If 　　　　　　rs1.MoveNext 　　　　Loop 　　　　Erase varArray 　　　　rs2.MoveNext 　　　　Loop 　　rs1.Close: Set rs1 = Nothing 　　rs2.Close: Set rs2 = Nothing 　　db.Close: Set db = Nothing End Sub No1の関数、およびこのプロシージャを 標準モジュールに保存し、No1での使用方法で 実行してみてください。
H2を良く知らないのですが、一般的には、group byとRownum()とを一緒に使うと うまくいかないのではなかったかと。 SELECT ROWNUM ( ) AS ID,ADDRESS,COUNT(*) AS 出身人数 FROM SAMPLE GROUP BY ADDRESS ではなく、 SELECT ROWNUM ( ) AS ID,ADDRESS,出身人数 from ( select ADDRESS,COUNT(*) AS 出身人数 FROM SAMPLE GROUP BY ADDRESS ) とするとうまくいくのでは？ ANO.1の方が示しておられるURLの The first row has the row number 1, and is calculated before ordering and grouping the result set・・・ To get the row number after ordering and grouping, use a subquery. というのが、 「group byの前に連番振りますよ、但し・・・。 サブクエリを使うと、group byの後に連番を振りますよ。」（適当な意訳ですけど） つまり上記の意味です。
書き方として合っていると思いますが、 ただ、最後に括弧で閉じていないだけでは？ ＞DCount("Answer", "Table1", "[ID] = '" & A & "' And [Bangou] = " & B DCount("Answer", "Table1", "[ID] = '" & A & "' And [Bangou] = " & B)
これは、単純に「APIの違い」と考えればよいと思います。別に、GAEのシステムの中にDatastoreとBlobstoreという２つのデータベースがあるわけではありません。Googleの基盤にはBigTableというデータベース環境があり、それを利用するためのAPIとしてDatastoreとBlobstoreがある、と考えればいいと思います。 両者の最大の違いは、保管できるデータサイズです。Datastoreは最大データサイズが１Mbという制約がありますが、Blobstoreでは最大２GbまでOKです。 もう１つの違いは、Blobstoreは金がかかる、という点ですね。Blobstore自体は有料ではありませんが、GAEでは無料で保管できるデータサイズは１Gbまでです。従って、Blobstoreででかいファイルをアップしようと思えば、有料サービスに切り替えて保管できるデータサイズを拡張しないといけません。 他、APIが異なりますので利用する際のこまかな関数・メソッドのたぐいはもちろん違ってきます。また両者のデータは互換性がないので、例えばBlobsotreに保管したデータをDatastoreのデータとして取り出したりはできません。
「書式」プロパティに 数値を表す書式　（例えば 「#,##0」 など） が 設定されているのでは？
DBエンジニアではなく，本業を他に持つ者です． Accessを本格的に使うようになって10年ほど経ちます．ADOなどが使えるようになった2000から今は2007を使っています． DBエンジニアのようなプロからするとおもちゃのようなDBなのでしょう．個人向けOfficeパッケージの製品でもあり，あくまでデスクトップデータベースとの位置づけだから，そういう評価になるのでしょう． 私個人はこれは非常によくできた製品だと思います．VBAとSQLをマスターすれば，専門エンジニアの居ない職場では最強のツールだと思います．例えば，学校の成績処理などすぐできます． ネックは共有ですね．私は次のようにして破損，肥大化を逃れつつ60人規模で（時間差で）共有しています．もちろん，実際同じ時間にアクセスする人数は数人です．排他処理とエラー処理で同時利用を回避しています．順番待ち利用ですね． ・インターフェイスはExcelですべてのVBAはExcelに作り込み，ワークシートにデータを展開して，編集する．このExcelファイルを共有者に配布する． ・Excelがaccdbファイルからデータを読み取り，データを編集している間は接続を切る．変更分はシートの行にチェックをつけ，変更分を一気に接続してaccdbファイルを更新する． ほとんどの書類はExcelインターフェイスで印刷しますから，Accessはインストールされている必要がありません．しかし，Accessで作ったレポートをExcelから印刷するときは，Accessアプリケーションがインストールされている必要があります． このやり方はネットでも紹介（Excel ADOでググる）されていますが，込み入った具体的な事例は書籍が詳しいです（古川順平氏のデータベースなど）．Accessの全般的知識，Excel全般的知識とVBA，ADO，SQLなどの知識が要りますが，これで業務用DBいらずに何とかやっています． どれぐらいの安全性・快適性かというと，定期考査の成績処理で，800人の1人当たり10数科目，テスト・評価データ10回分，出欠集計分で10数MBのaccdbファイルを使い，10回分の成績集計表，成績一覧表・順位表・通知表，出欠集計表などをインターフェイスのExcelから出力，通知表のみAccessで印刷して，1年使って，破損なし，肥大化ほとんどなし，同時利用衝突クレームなしです． この件についてDBエンジニアにネットなどで質問すると，「Accessだけでやればいいのに」「SQLServerExpress使えば」などと言われますが，本業のある人間には敷居が高いこともあり，この方法がもっとも手軽だという結論に至りました．とくに，ExcelVBAが得意ならSQLさえ使いこなせばかなりのシステムが素人ながら作ることができます． さて，MSがAccessに本気じゃないというのはそのユーザーの少なさだと思います．Excelの方が圧倒的にユーザーが多いし，ビジネスになります．AccessまたはExcelとの連携はやはり一般の人には敷居が高すぎるのだと思います．しかし，業務用でないDBとしての完成度は非常に高いと思います．デスクトップデータベースとしてできることは十分なので，使いこなせる人にとってはかなり重宝しているはずです．私も2000で機能は十分です． あのビルゲイツもAccessをほめていたのを聞いたことがあります．今のところ，AccessとSQLServerのギャップがそのままエンジニア出ない人でAccessを重宝する人と，業務用DBを使うエンジニアのギャップということなのでしょう． 設計思想がもともと個人利用なので無理なのかもしれませんが，あまり工夫しなくても小規模職場で多人数利用ができるようになれば，もっともっとユーザーも増えるのではないでしょうか． 非常に良いものでも使われなければ消えていきます．例えば，TeXという組版ソフトがありますが，これは数学者，物理学者は使いますが，一般の人はやはりWordを使います．MSにLaTeXの開発者ランポートが移籍したことを知ったとき，もしかしたらTeXがWord並みの使いやすさになってMSからでるのかと期待しましたが，音沙汰なしです．MSも企業ですから，どんなによいものでもビジネスにならなければ撤退すると思います． リレーショナルデータベースが世に出て40年ほどたちますが，これにかわるものはでていません．やはり，エンジニアにとって使いやすかったからです．AccessはRDBとしてのとっつきやすさは天下一品だと思います．RDB自体が一般の人には理解されていません．一般の職場で表と言えばクロス集計表しか連想されないように，RDB特有の正規化の考えが浸透していないのもAccessが使いにくいと思われている要因の一つだと思います．もし，数学の科目のようにリレーショナル代数が教えられるようになったら，Accessも市民権を持つのではないかと思います．まあ，すぐそうなるとは思えませんが． MSが本気になるかどうかはユーザーが増えてビジネスになるかどうかにかかっていると思います．今のAccessユーザーにはぜひがんばって使い続けてほしいと思います．
とか。
グラフの元の表ではもちろん日付けが１月１日・１月１０日・１月２０日に２月１日・２月１０日といったようになって体重が入力されていることが必要でしょう。そこで横軸に日付が表示されていることでしょうが、その日付表示の部分で右クリックし「軸の書式設定」を選択します。 「軸のオプション」項目で軸の種類のところで「テキスト軸」にチェックをして「閉じる」をクリックすればよいでしょう。
自分はMongoDBを使ったことはありませんが、MongoDBのマニュアルにはそういうことが書いてあるように見えます。 http://docs.mongodb.org/manual/faq/concurrency/ http://docs.mongodb.org/manual/faq/concurrency/#how-granular-are-locks-in-mongodb によれば、ほとんどの操作に対してdatabase単位でロックを行なっているようです。 read/write lockなのでwrite lockが必要なケースが少ないと問題ないでしょうが、ユーザーによる更新が多発する場合には大きな問題になりそうです。 http://docs.mongodb.org/manual/faq/concurrency/#which-operations-lock-the-database 更新の際には当然、write lockが行われるようです。 work aroundとしてはすべてのユーザーを単一のdatabaseに入れるのではなく、ユーザーIDごとに散らして入れておくという方法がありそうですが。複数のユーザーに関わる操作をされた場合には複数のdatabaseのロックを取得しないといけなくなります。
ひとつの繰り返しフィールドの消去は 変数を設定 [ $n; 値:1 ] Loop 　消去 [ テーブル::その繰り返しフィールド[$n] ]　---[]は繰り返し数指定欄に 　変数を設定 [ $n; 値:$n+1 ] 　Exit Loop If [ $n=LeftWords( FieldRepetitions ( Get ( ファイル名 ) ; 　　　　　　　　　 Get ( レイアウト名 ); Get ( アク ティブフィールド名 ) ) ; 1 )+1 ]　※ End Loop ※の部分は繰り返し表示数が3なら、単にExit Loop If [ $n=4]でもいいです。
Connectionを開きっ放しにして置くと排他や競合で問題が発生する可能性が高いので、 必要な時だけ開き終わったらすぐ閉じるのが原則かと思います。 細かく書いてゆくのが基本かと考えますが 標準モジュールに Sub myOpenCn・・・ Sub myCloseCn・・ のようなものを作成して 各ボタンには Call myOpenCn 処理・・・・ Call myCloseCn のようにしておけば良いのでは？
>SQLが使えるツール によって変わってくる場合がありますが、 SELECT メルアド FROM テーブルA WHERE 郵便番号 IN (SELECT 郵便番号 FROM テーブルB) とか。
こんな感じで、Access2010で書いたので2000だとエラーになるかも？ DAO 3.6？に参照設定が必要です。 タブインデントの代わりに全角スペースを使っています。 Sub test() 　　Dim DB As Database 　　Dim DB2 As Database 　　Dim tdf As DAO.TableDef 　　Dim i As Integer 　　Const mdbPath As String = "c:\顧客管理.mdb" 　　Const tblName As String = "MT住所録" 　　　　 　　If Dir(mdbPath) = "" Then 　　　　MsgBox mdbPath & "が見つかりません" 　　　　Exit Sub 　　End If 　　 　　For Each tdf In DB.TableDefs 　　　　If tdf.Name = tblName Then 　　　　　　DB.Execute ("drop table " & tblName)　'テーブル削除 　　　　　　Exit For 　　　　End If 　　Next 　　 　　Set DB = CurrentDb 　　Set DB2 = DBEngine.OpenDatabase(mdbPath) 　　For Each tdf In DB2.TableDefs 　　　　If tdf.Name = tblName Then 　　　　　　i = 1 　　　　　　Exit For 　　　　End If 　　Next 　　 　　If i = 0 Then 　　　　MsgBox mdbPath & " に " & tblName & "がありません" 　　　　DB2.Close: Set DB2 = Nothing 　　　　Exit Sub 　　End If 　　 　　DoCmd.TransferDatabase acLink, , mdbPath, acTable, tblName, "リンクテーブル１" 　　 　　'[切り離し] 　　'DoCmd.DeleteObject acTable, "リンクテーブル1" 　　DB2.Close: Set DB2 = Nothing End Sub
「更新用のフォーム」で ＞ボタンを押すと「フォームと連結したテーブル」を使った更新クエリを実行する、 ＞というマクロを実行する ということならば、たとえばボタン1のクリック時に、 Private Sub ボタン1_Click() '更新クエリの実行 Forms!検索フォーム.Requery End Sub のように、更新クエリの実行コードの後に、 検索フォームをRequeryしてみてください。 ただし、エラー処理をしていないので 検索フォームが開かれていることが前提条件 です。
「マクロで」 ということなら 簡単に考えれば 「更新用のデータの入ったテーブルを空にする」 削除クエリを作っておき 「クエリを開く」 で 削除クエリ を実行する。 新たに クエリを作りたくない、ということなら No1 さんの VBA と同等の処理を マクロで 行えばよろしいでしょう。 アクション ： SQLの実行 SQL ステートメント ： DELETE * FROM テーブル名
ACCESSのバージョンによって違うと思いますが、ACCESS2010で説明すると テーブルのデザインビューで「CTRL」キーを押しながら項目A、C、Dを選択し「デザイン」リボンに有る鍵のマークの「主キー」をクリックすればPrimaryKeyになります。
番外回答： 提示されたサイトを見ましたが自分には理解できませんでした マイクロソフトなのでIIS起動が条件になると思うのですが・・ というような人の回答です 大げさな表現をさせますが、1台のパソコンに無償の「Xampp」なるソフトを組み込み、このパソコンに無線LANルーター（WiFi）を有線LANで接続して電波を発信します この無線LANルーターの届く範囲に持ち込まれた無線受信可能パソコンが発信電波をとらえて使用許可が取れれば（WiFi）親PCが持っている固有のデーターベースに接続できます この親PCがどのような固有データーベースを発信しているかによって、持ち込みPCのユーザーは使う使わないを判断します ということで全く不可能ではありません（ここが言いたかっただけ）
並べ替えについて回答させてください。 >>レポート1の問題を踏まえ、一応、項目名Eを除外して集計しています（現時点で未解決） ここでは、担当者の並び替えを任意に行いたいです。 昇順や降順ではなく、例えばあ・い・う・え・おを、い・う・あ・お・えのように並べたいのです。 リレーションの機能を使って出来ます。記載順のテーブルを別に作成し、これに二つの項目を入れます。順番の番号(1,2,3・・・)と担当者氏名です。そこで並べ替えをしたいテーブルと記載順テーブルを氏名をもとにリレーションを設定します。 次にクェリーを実行します。二つのテーブルの必要事項を取り込み、ここで並べ替えの設定を記載順のテーブルの番号を基準に指定すれば、実行の結果は希望のものになります。
ご質問のコードは１行目の第０番目のデータを表示させていますが、select命令の取得フィールドを２つとも指定するようにできます。 そして、fetch を　fetch_assocに変えて、count(*)に別名kosuを与えて、連想配列で$num->idと呼び出すようにできます。 ただし、このようにしてデータ件数分だけ繰り返したとして、count()関数をその度に繰り返すでしょうから時間的ロスは出るので、別々にするのが効率的と思われます。 また、ＰＤＯを活用するとしたら、基本的なＳＱＬの操作方法は共通ですから、ＳＱＬの文法と繰り返し取得とフィールドの分割が分かれば、SQLの違いに関わらす自由に操作できます。 $pdo = new PDO(sqlite:test.db); $query = $pdo->prepare('SELECT id, count(*) AS kosu FROM testTable WHERE id > 0 AND id < 10'); $query->execute(); $num = $query->fetch_assoc(PDO::FETCH_NUM); // id,kazuを指定して echo $num->id; echo $num->kazu;
管理番号がテキスト型でしたらこちらで。 累計: DSum("試験時間","テーブル9","管理番号='" & [管理番号] & "' AND 開始日付 <= #" & [開始日付] & "#") 確認してみてください。
何を聞きたいのかよく分かりませんが、 Excleで桁を指定して四捨五入をしたいと言うことであれば 　　　ROUND関数 を使います。 　=ROUND(数値,桁数) として使います。 　=ROUND(105.25,-1) → 110 　=ROUND(105.25, 0) → 105 　=ROUND(105.25, 1) → 105.3 こんな感じに四捨五入されます。　 質問のケースでは二つ目の例で、桁数を 0 と指定して使う事になるでしょう。 数値のところには演算式をそのまま入れれば良いでしょう。 　=ROUND(売上額/売上数, 0) 何が難しいのかを書いてもらうと、それについて詳しく解説しながら回答できるんですけど 　　「とりあえず目の前の問題を解決できれば良い」 のであればそれはそれでも良いでしょう。理解できなくても解決はできるんですね。 回答する側は虚しいだけですけどｗ
下記のようなSELECT文を作成して結果を見てください。 SELECT 在庫テーブル.ID, 在庫テーブル.数量 AS 在庫数量, 追加テーブル.数量 AS 追加数量 FROM 在庫テーブル Inner Join 追加テーブル On 在庫テーブル.ID = 追加テーブル.ID 出力結果 ID 在庫数量　追加数量 001　1　3 001　1　4 002　2　1 002　2　2 これをUPDATE文にしたものが質問のSQLですが、これを実行すると、 上記のレコードセットを上から順に 在庫テーブル.数量 = 在庫テーブル.数量 + 追加テーブル.数量 という演算を実行してきます。 1行目を実行すると、IDが001の在庫テーブル.数量は 1+3 = 4 となります。 2行目を実行するとき、IDが001の在庫テーブル.数量はすでに4になってますので、在庫テーブル.数量 = 4+3 = 8 となります。 3行目を実行すると、IDが002の在庫テーブル.数量は 2+1=3 となります。 2行目を実行するとき、IDが002の在庫テーブル.数量はすでに2になってますので、在庫テーブル.数量 = 3+2 = 5 となります。 という具合に順に、在庫テーブル.数量 に 追加テーブル.数量　を加算していきますので、集計結果を得ることになります。
リストボックスの名前が LST1 チェックボックスの名前は CHK1 LST1の隣などの同じセクションにCHK1 が有るとしたら CHK1 のクリック時イベントにて Private Sub CHK1_Click() Me!LST1.Visible = Me!CHK1.Value End Sub とかでは？
【要旨】 値集合ソースやクエリのSQL文では、 　((テーブル.カラム) like "'*" & Forms!フォーム!テキスト1 & "*'") と、「'」は入れずに、 　((テーブル.カラム) like "*" & Forms!フォーム!テキスト1 & "*") としてください。 【詳細】 VBA上でSQL文を扱う場合や、DMaxなどの定義域集計関数の引数にする 場合は、確かに「*」と同時に「'」を使用しますが、クエリ(又は値集合ソースへの 直接入力)に使用する場合は「'」は使用せず「*」だけを指定します。 ちょっとわかりにくいかもしれませんが(汗)、完全一致の場合も、 　((テーブル.カラム) = "'" & Forms!フォーム!テキスト1 & "'" ) ではなく 　((テーブル.カラム) = Forms!フォーム!テキスト1 ) と、「'」を使用せずに指定しないと正しい結果が得られないのと同様と 考えて戴ければいいかと思います。 くどくなるのを承知で(汗)、さらに説明すると・・・ VBAでは、例えば「Me.氏名」に「鈴木」という値が入っていたとして、 　strSQL = "Select * From テーブル1 Where 氏名 Like *" & Me.氏名 & "*;" という変数への記録を行った場合、実際のWhere句は 　氏名 Like *鈴木* となって 　氏名 Like "*鈴木*" とはなってくれません。　 (「*」がワイルドカード文字ではなく乗算の演算子として扱われてしまう、と) これを防ぐため、VBA上でSQL文を扱う場合は、「'」を(又は「"」を重ねて) 使用する必要があります。 一方、クエリやSQL文を直接編集する場合は、 　氏名 Like "*鈴木*" とか 　氏名 Like "*" & Forms!フォーム!テキスト1 & "*" といったように、予め「*」を「"」で括って文字列(ワイルドカード文字)として 明示していることになります。 なので、逆にここに「'」を追加すると、その「'」まで「検索文字列」として 指定したことになってしまうので、意図した抽出結果が得られなくなる、 ということです。 ・・・以上、長くなりましたが、参考まで。 なお、余談になりますが、この「Like」は「関数」ではなく「演算子」になります。
レポートを開いた時には、まだサブレポートは生成されてませんので、エラーになります。 そのサブレポートを配置しているセクションのフォーマット時のイベントプロシージャにそのコードを記述してください。 あと、レポートではなく、フォームをレポートに埋め込んだのですか。もし、そうなら、ReportプロパティではなくFormプロパティで参照しないとエラーになります。 Me.サブＳ.Form.フィールドＣ.Visible = False
> SQLの抽出条件「forms!サブ１!a」として、上記で取得した > テキストボックスaを使用しております。 > > サブ１をメインフォームで開き上記を実行すると値を抽出します。 Forms!メインフォーム名!サブフォームコントロール名.Form!a としてください。 あるいは、単純に、[a] とするだたけでもOKです。Formsの指定がない場合は自分自身のフォームから探しますので。また、この方法だと単独で開いても、サブフォームとして開いても正常に動作しますのでお勧めです。
ゴミではないと思いますがGoogleっても、MS社のですら出てきませんね。 とりあえず確認できたこと。 MDBファイルには存在せず、ACCDBファイルにのみ存在する。 Access2010でMDBファイルを作っても無い。 新規ACCDBファイルでオブジェクトを全く作成せずに MSysObjectsテーブルを見ると既にある。MDB→ACCDB変換に関わらず作成される。 作成時刻を見ると新規にACCDBファイルが作成された時刻になっている。 f_・・・・・・_Dataの文字桁数が同じなので何かの識別用UIDかもしれない。 気にしない事がイチバンかも？ (^^ゞ
集計クエリやサブクエリを含むクエリは更新できません。ですので、ANo.1さんのSQLでも同じ結果になります。 DSum関数を使って集計を取得すれば更新可能になります。 UPDATE トータル動物テーブル SET トータル動物テーブル.数 = トータル動物テーブル.数 + DSum("数","追加動物テーブル","ID = " & ID); ID が数値型の場合です。テキスト型の場合は、DSumの第3引数を "ID = '" & ID & "'" としてください。 あるいは、リンクさせて追加動物テーブルの数をすべて加算していく方法でも可能です。件数が多い場合は、こちらの方が高速化もしれません。 UPDATE トータル動物テーブル INNER JOIN 追加動物テーブル ON トータル動物テーブル.ID = 追加動物テーブル.ID SET トータル動物テーブル.数 = トータル動物テーブル.数+追加動物テーブル.数;
現状のコードはフォームBが既に開いているという前提のコードです。 フォームBが開いてない状態でこのコードを実行するとそのようなエラーになります。 フォームBを開いて、該当のレコードのみ表示するとこ言うことなら、下記のコードです。 Private Sub Form_DblClicj(Cancel As Integer) Docmd.OpenForm "フォームB", , , "ID=" & Me!ID End Sub
UNION ALL で 重複するレコードも抽出されます。 SELECT A.製品コード, A.数量, A.受注日 FROM A UNION ALL SELECT B.製品コード, B.数量, B.受注日 FROM B;
件数にもよりますが、お手軽なものから http://postcode.goo.ne.jp/ 一括変換ができます。 また、こんなのもあるようです。 http://office.microsoft.com/ja-jp/excel-help/HP001057416.aspx データベースソフトでやりたいのなら、 http://www.post.japanpost.jp/zipcode/download.html からデータをダウンロードして、 ○○市○○町○○　012345678（郵便番号） のような形式になおし、住所からデータベース検索をかければいかがでしょうか。
VBAでの回答は却下でしょうか？ また、フォームAをダブルクリックするとして その際に選択された行の中に、フォームBで一意に指定できる要素 （単一または複数のフィールドの組み合わせで一意となるもの）がありますか？ たとえば、『ID』というのが一意なら、フォームAのダブルクリック時イベントで Private Sub Form_DblClick(Cancel As Integer) Forms!フォームB.Filter = "ID=" & Me!ID Forms!フォームB.FilterOn = True End Sub 等なんですけど。。
> この機能のオン・オフをＶＢコードから制御できないでしょうか？ ご質問の制御の対象がフォーム上ということでよろしければ、 郵便番号・住所の入力/表示に使用しているテキストボックスの 「PostalAddress」プロパティの値を切り替えてやればOkのようです。 (普段この機能は使用しないので(汗)、今試してみました：Acc2007) 既にウィザードなどで機能を設定済みのテキストボックスがある ことを前提に、式を例示します。 『郵便番号欄』『住所欄』の2つのテキストボックスがあって、 それぞれの『住所入力支援』プロパティ(→テキストボックスの プロパティシートの『その他』タブにあります)の値が、それぞれ 　　『郵便番号欄』テキストボックス　→　プロパティ値=「住所欄」 　　『住所欄』テキストボックス　→　プロパティ値=「郵便番号欄;;;」 となっている場合は、 　　Forms!フォーム名!郵便番号欄.PostalAddress = "住所欄" 　　Forms!フォーム名!住所欄.PostalAddress = "郵便番号欄;;;" 　または、同じフォーム上なら 　　Me!郵便番号欄.PostalAddress = "住所欄" 　　Me!住所欄.PostalAddress = "郵便番号欄;;;" と、プロパティ値を「"」ダブルクォーテーションで括って代入すればオンに、 　　Forms!フォーム名!郵便番号欄.PostalAddress = "" 　　Forms!フォーム名!住所欄.PostalAddress = "" 　また、上と同様に同じフォーム上なら 　　Me!郵便番号欄.PostalAddress = "" 　　Me!住所欄.PostalAddress = "" と、空文字("")を設定してやればオフに、それぞれできます。 住所を『都道府県』と『市区町村』などに分割している場合も、 基本的には上記と同様にプロパティ値の代入で切り替え可能です。 (郵便番号系・住所系で使用しているテキストボックスの数だけ、 　代入式が必要になります： 　上の例では郵便番号欄/住所欄の2つなので、2つの代入式、と) ・・・以上、参考まで。
No5です。 「True」という文字列がBooleanで返す「True」とまぎわらしい、という ことであれば、 Function funcJudge(ByVal fP As Long, ByVal fQ As Long, ByVal fR As Long, ByVal fS As Long) As String '最初の条件 If fP = 0 And fQ >= 1 And fR = 2 And fS = fQ Then funcJudge = "同値" Exit Function End If '二番目の条件 If fP >= 1 And fQ >= 1 And fR = 1 And fS = fP Then funcJudge = "同値" Exit Function End If End Function のように「同値」でもかまいませんが。
確認ですが　JavascriptよりAjaxの方がチェックが減ると思いますが．． Javascriptなら　という理由はどういうものでしょうか 個人的には　jQueryからPHPに投げるものを作ります http://alphasis.info/2011/11/jquery-gyakubiki-jquery-get-php/ http://alphasis.info/2011/11/jquery-gyakubiki-jquery-post-php/ http://alphasis.info/2011/11/jquery-gyakubiki-jquery-ajax-url-javascript/ http://alphasis.info/2011/11/jquery-gyakubiki-jquery-ajax-url-php/ http://alphasis.info/jquery-api/gyakubiki/ajax/ サンプル付で分かりやすいものを紹介しておきます 分かりにくい場合は詳しく説明します　補足を
イミディエイトウィンドウでの、?DLookup・・・はDlookupの戻り値を表示せよ、という意味です。 Print DLookup・・・ の省略です。 一方、Private Sub s店舗no_LostFocus()では Dlookupの戻るところがありませんのでエラーになります。 通常は 変数 = DLookup("[店舗名]","[t店舗]","[店舗no]="& Forms![ft店舗seach]![s店舗no]) などと使用します。 また、ヘルプをご覧になれば 「criteria に適合するレコードがない場合や、domain にレコードが含まれていない場合は、Null 値が返されます。」 とも記載されています。 加えて、s店舗no がフォーカスを失うごとにDLookupで調べるよりも 更新後に行った方がベターかと思います。 具体的に何をしたいのかよく分かりませんが Private Sub s店舗no_AfterUpdate() dim へんすう as string If Not IsNull(s店舗no) Then msgbox nz(DLookup("店舗名","t店舗","店舗no="& Forms!ft店舗seach!s店舗no),"見つからない") へんすう = nz(DLookup("店舗名","t店舗","店舗no="& Forms!ft店舗seach!s店舗no),"見つからない") debug.print へんすう End If End Sub のような感じでは？ なお、オブジェクト名やテーブル名などに、 スペースが含まれていたり、予約語である場合を除いて、[] で囲まなくとも可。 http://support.microsoft.com/default.aspx?scid=kb;ja;286335 nz関数で括るのは余計かもしれない。。
>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel3, _ strac, strxls, True, strrange Excel では、RTEST という範囲名が設定されていないのでは？ なら此処は・・・strac, strxls, True だけで。 また、acSpreadsheetTypeExcel3 はExcel3.0形式の指定です。8 あたりでは？
>SQL = "select * from T1 where keyword = '" & tb1 & "'" でエラーになるかと思ったら出来るんですね・・・？？ Accessが気を利かしてくれているらしいのですが、少し気味が悪いので Private Sub cmd_exe_Click() Dim SQL As String If isnull(me!tb1) then SQL = "select * from T1 " else SQL = "select * from T1 where keyword = '" & ME!tb1 & "'" end if me!sf1.form.recordsource = sql ・・・ では？
以下では？ DoCmd.OpenReport "領収記録", acPreview, , "[領収日付] >=#" & Me!開始日 & "#"
できますよ。 PDFをコピーしてレイアウトモードで貼り付け とか レイアウトモードで挿入メニューからオブジェクト挿入 等で。 でもWinではレイアウトにPDFを取り込むと汚くなるはず。 JPEGと両方試してみてください。
>指定の場所に移動に移動してレコードのインポート→フォルダで参照データのみのインポートをおこなっています。 別のFMファイルからのデータのインポートなども同じで、 新規レコードとしてインポートすると今インポートしたレ コードだけが対象レコードになりますよ。 既存レコードは混ざりません。
今年からってことは新卒？研修で習ってけど解らなかったってことでしょうか？ RDBSではなくRDBMSですね。DB2はIBM以外はあまり使ってないDBなのでなかなか知ってる人も少ないのでは？ DB2の場合はAIX版やAs400版、OS390版、さらにPCサーバー版もあるのでそれぞれ特徴が違います。つまりIBMの資料を研究することが一番いいのです。深く勉強してもDB2には追いつかないです。せいぜいSQLServer、よくてOracelを覚えられるだけです。それほどDB2は違うのです。一応基本概念は同じなんですけど一般的なRDBの概念の勉強であれば雑誌で十分です。一日で理解できると思います。 Javaはプログラミングなのでそれなりに理解は大変ですが、RDBは概念なので。 特にOS390の概念はPCマニア程度では全く理解できない領域にあります。AS4００もそうですね、OS400のCLのコマンドを知ってる人はこれだけITが一般的になった今でも、殆ど居ないでしょう。 OS400がWindowsの基本概念の元と言う事ももはやだれも知りません。元々WindowsサーバーはOS400を目標に作られ現在のWindows８につながっています。OS400からMSが学んだものは大きいのです。 とにかくOSの上にRDBMSが乘ってると考えるUNIXサーバーやPCサーバーの概念とは違うのです。OSの中にDBが組み込まれていると考えるのが正しいです。一体化しているから処理が早い。この概念はPCユーザーには理解に苦しむところなのです。 IBM製品は市販マニュアルは殆どありません。IBMの信頼は確実なサポート。つまり独学を許さないのです。IBMなら社内研修プログラムが充実しているはず。そちらを利用するのが一番です。
＃２です できそうなそぶりを見せて申し訳ありません。 私のわからないところに行ってしまいました。 ＃２で想像していたのは、 コンボボックスのデータが、何らかのタイムアウトで空欄になり・・・・ だったら Requery すれば裏方さんが繋ぎ直してくれるのでは・・・・ という考えからでした。 そして、その想像も打ち消されました。 ごめんなさいです。 そこで提案ですが、 現QAでは、他の方の登場は期待できないかも・・・ 時間的余裕があれば、待ってみるのもありかと思いますが・・・・ 本QAは締切扱いとして、 ・Microsoft Community　とか　http://answers.microsoft.com/ja-jp/office/forum/access?tab=all （モデレーターさんがどこまで面倒を見てくれるのかわかりませんが） ・moug の一般機能　とか　http://www.moug.net/faq/viewforum.php?f=3 で質問しなおされることを望みます。 ただ、回答が得られるかは・・・・ 質問しなおされる場合には、 ・ログインフォームの構成　コンボボックスで ID、パスワードを持たせている事 ・＃２で記述された どの様な時間経過でどうなるか ・Access2010 or Runtime 以外に OS を簡潔に記述されたらと思います。 なお、締め切ってから質問してください。くれぐれもBAは付けないように。 質問しなおされる時には、このQAのアドレスを記述しておいた方が良いと思います。 解決しなかったから質問した・・・と くれぐれもマルチポストにはならないように・・・・ 長々と時間を取らせて、すみませんでした。
MSの公式では、65,536件までというのが仕様のようですね。 [ACC2002]コンボボックス/リストボックスのリスト制限 65536 (64KB) について http://support.microsoft.com/kb/207601/ja
こんにちわ うちはいじったことがありませんが、Accessとほぼ同等なぐらいの プログラミングができるようです。 ですが、Accessとは勝手が違うので、細かいところはわかりませんが・・
、販売店コードフッターに配置したテキストボックスのコントロールソースを下記のように設定してください。 =Sum(IIf([売上額]>0,1,0))
No2の変更漏れがありました。Ｂのフィールドの型はテキスト型に する必要があります。 この修正を行なった後に、もし以下のことであれば補足してください。 そこで、No2の補足について、 (1) tx1に表示されているデータは、日付で、たとえば、 2012/10/29 のような表示ですか。それならば、 i = CStr(Format(Nz(Me!tx1), "yymm")) & CStr(Nz(Me!tx2)) & CStr(Nz(Me!tx3)) または、 i = CStr(Format(Me!tx1), "yymm")) & CStr((Me!tx2)) & CStr((Me!tx3)) というなかで、 CStr(Format(Nz(Me!tx1), "yymm")) または、 CStr(Format(Me!tx1), "yymm")) というのは、Format関数で2012/10/29 を　1210　のように変換して、 その上、CStr関数で文字列に変換する、というコードです。 したがって、tx1のフィールドの型が日付型であっても構わないのですが。 そこで、 ＞先に変更して実行したのですが とはどの時点でどのような変更を実行したのですか？、
レコードの削除 実行前、削除の確認メッセージが出ないように設定します。 そのままでは、メッセージなしに削除されてしまいますので、自前で Msgbox関数で確認メッセージを出します。 下記の部分を、 If not [Form].[Newrecord] Then 　　　　メニューコマンドの実行 　　　　　　　　　　コマンド　レコードの削除 If文の最後 下記のように変更してください。 If Not [Form].[NewRecord] And Eval("MsgBox('レコードを削除します。@「はい」をクリックすると、削除したレコードを元に戻すことはできません。@削除してもよろしいですか?',52)")=6 Then 　　　　メッセージの設定 　　　　　　　　　　メッセージの表示　いいえ 　　　　メニューコマンドの実行 　　　　　　　　　　コマンド　レコードの削除 　　　　メッセージの設定 　　　　　　　　　　メッセージの表示　はい If文の最後 「メッセージの設定」アクションを表示させるには、リボンの[マクロツール]-[デザイン]の「すべてのアクションを表示」を押し込んでおいてください。
この場合、INNER JOINの後を()でくくる必要はないのだが。 それはさておき、 SELECT c.CarNo, c.Model, cs.FirstName, cs.LastName, b.Date, b.Duration FROM Location l INNER JOIN ( ( (Own o INNER JOIN Car c ON o..FK_CarNo = c.CarNo l.LocationNo) /* o..FK_CarNo は、 o.FK_CarNo のあやまりでしょう。 また c.CarNoの後にあるl.LocationNoは何のためのものか分らないので文法エラーになります。 */ INNER JOIN Book b ON c.CarNo = b.FK_CarNo) INNER JOIN Customer cs ON b.FK_CustomerID = cs.CustomerID) ON l.LocationNo = o.FK_LocationNo WHERE l.LocationName =:user_input ; ANO.1の方が書いた方法で悪いとは思わないのですが、ご自身で書かれたselect文を試してみたければ /* ・・・　*/内に書かれた内容を直した下のselectを試して見られたらいいでしょう。 SELECT c.CarNo, c.Model, cs.FirstName, cs.LastName, b.Date, b.Duration FROM Location l INNER JOIN ( ( (Own o INNER JOIN Car c ON o.FK_CarNo = c.CarNo) INNER JOIN Book b ON c.CarNo = b.FK_CarNo) INNER JOIN Customer cs ON b.FK_CustomerID = cs.CustomerID) ON l.LocationNo = o.FK_LocationNo WHERE l.LocationName =:user_input ;
簡単なのはあなたのデータベースをWEB上に公開して それを他のPCからWEBブラウザで閲覧・検索します。 DBの入っているPCは静的アドレスで常に電源を入れて おく必要があります。 私はMacなのでaccessでこんなことができるかどうか 知りませんけど、FileMakerならプログラミングの知識 無しでもすぐできます。（暗号化セキュリティは別）
> 正しくは　（各ページ合計）　（表示したい方）　 > 　　　1P　　　A＝2　B＝1　→　A＝2　B＝1 > 　　　2P　　　A＝1　B＝3　→　A＝3　B＝4 > 　　　最終P　A＝2　B＝2　→　A＝5　B＝6 > とページ合計を累計して表示したいのでした。 それなら、簡単です。 ANo.7の回答の、詳細セクションのテキストボックス RunSumA、RunSumA はそのままのこします。 ページフッターには、テキストボックスを２つ残して、それぞれ下記のように設定します。 コントロールソース　=[RunSumA] コントロールソース　=[RunSumB] コードは一切不要なので、レポートモジュールのコードは全て削除します。 以上です。
最近、同様のトラブルがありましたので まだ解決していないようでしたら参考にしてください。 原因については推測によるものです。 開発環境とトラブルのおきた環境でプリンタが異なっている場合です。 私の場合は、たまたまプリンタが故障して 間に合わせで、 「給紙方法」 が 「後トレイ」 しかない機種を 「通常使うプリンタ」 にしていました。 その状態で作成したレポートは デザインのページ設定で給紙方法が 「後トレイ」 に設定されていました。 それしかないのですから 「自動選択」 にならないのは当然と言えば当然ですが。 客先から、用紙切れのメッセージが出る、と報告があるまで 全く気が付きませんでした。 で、対策としては 「通常使うプリンタ」 を 「カセット」もある機種に戻して （本体が無くてもドライバさえあればOKです） デザインのページ設定で「給紙方法」を「自動選択」に変更して保存。 デザインで 「自動選択」 になっていれば 「通常使うプリンタ」を「後トレイ」しかない機種にもどしても正常に印刷できます。 いずれにしても、レポートのデザインでの「給紙方法」 を確認してください。
２００５のコンパクトエディションは入ってますね。後のはアクセスするためのオブジェクトですが、一般の個人のPCには初めから入っているものではないと思います。 おそらく何かのアプリに同胞されていたものだと思います。すべて無料配布版ですから。これを使って動くアプリは結構あります。ただし、ネットから落としたとかいう物ではなく、購入したアプリだと思います。 ゲームとか家計簿ソフトとか。
前回のコードはちょっと間違い。 下記でどうかな。 Const n = 10 '「次へ」 Private Sub コマンド13_Click() Dim p As Long On Error Resume Next DoCmd.GoToRecord , , acNext, n * 2 If Err = 2105 Then p = Me.CurrentRecord DoCmd.GoToRecord , , acLast DoCmd.GoToRecord , , acGoto, p + n Else DoCmd.GoToRecord , , acPrevious, n End If End Sub '「前へ」 Private Sub コマンド16_Click() DoCmd.GoToRecord , , acPrevious, n * 2 If Err = 2105 Then p = Me.CurrentRecord DoCmd.GoToRecord , , acFirst DoCmd.GoToRecord , , acGoto, p - n Else DoCmd.GoToRecord , , acNext, n End If End Sub
グループフッターの「改ページ」を「カレントセクションの後」に設定していませんか。 もしそうなら、Access2010から発生するようになった不具合のようです。 晴れ - 日記 http://d.hatena.ne.jp/keuko/20110711 グループフッターの「改ページ」を「しない」にして、グループヘッダーの「改ページ」を「カレントセクションの前」に設定してください。 グループヘッダーを表示したくない場合は、セクションの高さを0cmにしておけばいいでしょう。
ANo.1です． 私自身あまり親表という表現を使わないですが，マスターテーブルやトランザンクションテーブルも厳密な定義があるわけではないようです．SQL文もデータベースによって方言があります． とは言え，状況から言って，今の場合customerが親表（≒マスターテーブル）で，orderが子表（≒トランザンクションテーブル）でしょう．マスターテーブルはあまり更新されず，トランザンクションテーブルは頻繁に更新されるという特徴はあるでしょう． 子表は親表を参照します．そのための子表の参照列を外部キーといいます． 親表と子表の間でデータの整合性を保ち，子表に入力される値は必ず親表に存在しなければなりません．
何をインポートするのでしょうか。 テキストファイルなら、下の画像のように、インポートウィザード画面の下部にある[設定]ボタンをクリックすると「インポート定義」画面が開きます。 エクセルファイルの場合はインポート定義は存在しません。
なんどもすみません（汗）。 ANo.6 ですが、FROM を FORM とタイプミスしています。 SELECT DISTINCT 果物TBL.* FROM 果物TBL WHERE (ID In (SELECT ID FROM 果物検索TBL) AND EXISTS (SELECT 1 FROM 果物検索TBL WHERE ID Is Not Null)) AND (名前 In (SELECT 名前 FROM 果物検索TBL) AND EXISTS (SELECT 1 FROM 果物検索TBL WHERE 名前 Is Not Null)) AND (値段 In (SELECT 値段 FROM 果物検索TBL) AND EXISTS (SELECT 1 FROM 果物検索TBL WHERE 値段 Is Not Null));
『大分類コード・大分類名称』 １ ↓ 多 『中分類コード・中分類名称・大分類コード』 １ ↓ 多 『小分類コード・小分類名称・中分類コード』 １ ↓ 多 『質問コード・質問ユーザーID・質問内容・小分類コード』 １ ↓ 多 『質問コード・回答連番・回答ユーザーID・回答内容』 そして， 『ユーザーID・各ユーザー情報』
PHPでしたら、SQLiteが使えるかもしれません。 PHP5以降でしたら、標準でバンドルされていますので。 （もしかしたら、レンタルサーバの業者さんが使用禁止している可能性もありますが・・）
結論から言うと，定義Ａ，定義Ｂどちらも正しいということになります。 -------- コンピュータ科学の観点から関係データベース(RDB)を解説した解説書を読むと，関係代数とか関係論理という数学を基にした用語が登場します。RDBというのは集合に対する演算なんです。 このようなコンピュータ科学の観点で捉えた，第一正規形の本来の定義は「定義Ａ」です。 コンピュータを勉強しはじめたばかりの初心者が，この「定義Ａ」の第一正規形の表を見て，次のような感想を漏らすときがあります。 「繰り返しの部分を複数のレコードにして繰り返しを排除する操作，と言っているけれど……。たしかに伝票の明細部分は複数行に分かれたけれど，伝票のヘッダ部分は複数行に同じ内容が繰り返し書かれているよね。繰り返しは排除されていないじゃん？」 これは「繰り返しを排除する」という意味を勘違いしているわけです。 正しい解釈は，（Excelにおける１つのセルに）複数の値が格納されているようでは個別の値を扱えない。社員1，社員2，社員3のように同一定義域の属性が繰り返されているようでは社員というものを簡潔に扱えない。だから同一定義域の属性は１つにまとめて，なおかつ１セル＝１値の形式にしなさいということです。 数学的には，同じデータが繰り返されているというのは問題ではないんです。 まったく同じ行(tuple)が絶対に存在しないのであれば，行中のいくつかの属性値が他の行と同じデータの繰り返しであろうとも，RDBとしては整合性がとれています。 集合に対する演算で正しい結果が得られるのならば，それがどれだけ肥大化したデータ群であろうとも，数学的にはなんの問題もありません。 -------- しかし，システム開発の観点からすると，そうもいきません。 「定義Ａ」の表が，数学的には正しいRDBだとしても，それをそのまま実装すると同じデータを複数行繰り返して記録する羽目になります。 時代的にDBというものを知らず，昔のファイル設計しか経験していないシステムエンジニアであっても，というかコンピュータを知らない一般人であっても，「定義Ａ」の同じデータの繰り返しをそのまま実装することには相当な違和感を覚えるのではないですか。 ですから，システム開発の現場では「定義Ｂ」が第一正規形だと教えるのです。 定義Ａが本来の定義なのですが，理論屋的な定義Ａの形式を経なければならないなんてことはシステム開発の現場ではまったく？無いので，実務屋的な定義Ｂで大丈夫なのです。
＃３です 申し訳ありません。 各フィールドの型を記述していませんでしたね。 テーブル「TA」では、LV（数値型/長整数）、その他はテキスト型 テーブル「TB」では、LV（数値型/長整数）、SLV はテキスト型 　（テーブル「TB」の主キーは　LV） たぶん、この型があっていなかったので、コンボボックスの SELECT TA.ID, TA.名前, TA.PWD, TB.SLV FROM TA LEFT JOIN TB ON TA.LV = TB.LV; が取得できていなかった可能性があります。 デザインで、この「値集合ソース」の表示部分をクリックすると、 右側の SELECT・・・・が反転表示になると思います。 その状態で、右側の[・・・]をクリックすると、クエリのデザインの様な表示になります。 「F_LOGIN：クエリ ビルダ」の表示部分で、マウス右クリックし、 「データシート」表示にしてデータがどう並んでいるか確認してみます。 OK なら保存して終了です。 標準モジュールへの変更は＃３の通りです。 確認するフォーム「F_MENU」は＃２から変更なしです。 （コントロール名に _ が付いている状態のものです） また、私が確認したのは、テーブルを以下の様に設定していました。 テーブル「TA」 ID　　名前　　PWD　LV A1234　AAAA　1234　1 B1234　BBBB　1234　2 C1234　CCCC　1234　3 D1234　DDDD　1234　6 テーブル「TB」 LV　SLV 1　,2,3,4, 2　,2, 3　,3,5, 4　,4, 5　,5,1, これで確認できると思います。 （上記では D1234 さんがオールマイティ） 繰り返しになりますが、 他のフォームでも同じように Enabled 設定したかったら、そのフォームに Private Sub Form_Load() 　　Call FrmLevelSet(Me) End Sub を記述するだけです。ただ、コントロール名は命名規則に従っている事が前提です。 また、 Call FrmLevelInit ' 初期化　を記述するのは、ログアウトする直前の最後の最後です。 途中初期化してしまうと情報が消えてしまうので、再ログインが必要になります。 ２）の方法で良かったんでしょうか。 押しつけるつもりはありませんので、良い方法が見つかればそちらの方で・・・・ ※　２）はレベルをコントロール名に持っていましたが、この部分にタグ（Tag）を使う 　　っていう方法もあります。雰囲気わかっていただけるかと思います。 ２）で「btn_4」となっていたらタグ（Tag）に ,4, を設定しておいてコントロール名は自由に >　　i = InStr(.Name, "_") >　　If (i > 0) Then >　　　　If (InStr(sUserLevel, "," & Mid(.Name, i + 1) & ",") > 0) Then >　　　　　　.Enabled = False >　　　　End If >　　End If 部分を 　　If (Len(.Tag) > 0) Then 　　　　If (InStr(sUserLevel, .Tag) > 0) Then 　　　　　　.Enabled = False 　　　　End If 　　End If に変更するだけです。 この方法では、タグ（Tag）は書き換えれませんが、 テーブル「TB」の SLV 変更で、途中からでも変更要求には対応できます。 おかしな所等ありましたら、補足いただければと・・・
MS-Access 2000での例。
http://zipcloud.ibsnet.co.jp/ 郵便番号データはこちらをすすめます http://typhoon.yahoo.co.jp/weather/jp/warn/14/ http://typhoon.yahoo.co.jp/weather/jp/warn/23/ http://www.jma.go.jp/jp/warn/320_table.html http://www.jma.go.jp/jp/warn/329_table.html もし自分なら　気象庁　の地域を参考にします http://cpf.uub.jp/seirei.html http://cpf.uub.jp/chukaku.html http://cpf.uub.jp/tokurei.html 政令市　中核市　特例市　はある程度の規模なので 分割が必要なのかもしれません http://www.water.city.nagoya.jp/user/renraku/renraku_list.html 名古屋では水道局などが情報でありました http://www.iezo.net/tiikinavi/aichi/nagoya/ 学区で分けるとか https://www.google.co.jp/search?num=100&hl=ja&safe=off&q=%E7%A5%9E%E5%A5%88%E5%B7%9D%E7%9C%8C%E6%A8%AA%E6%B5%9C%E5%B8%82+%E4%BD%8F%E6%89%80+%E6%A8%AA%E6%B5%9C%E5%B8%82%EF%BC%88%E5%8D%97%E9%83%A8%E3%83%BB%E8%A5%BF%E9%83%A8%EF%BC%89+http%3A%2F%2Ftabelog.com 個人的には　食べログを逆検索で地域をリストアップするプログラムなど用意します
Ｑ１）人数「５」を選択したときに、対象レコードを５部印刷することはできるか。 印刷時に最初のレコードに移動して部数を変数に入れて 1部印刷するたびに変数を1ずつ減らしてLoopすればいいですよね。 >できれば、１枚の用紙に数人分印刷したい 1枚の用紙に何人分印刷できるのですか。それを人数分切り離すのですか。 Ｑ２）チームＤの、「い」の一部内容修正を行う場合の方法、例えば、「い－２」のようなものを作るとして、それをチェックボックスに自動反映させることはできるか。 ポップアップメニューやドロップダウンリストにする。
表をコピーして、貼り付けたい場所を右クリック＞形式を選択して貼り付けをクリック、「すべて」から「数値」を選択すればいいのでは
＞桐の　どのメニューから選べばできるか　ご存じの方　教えてください 入力フィールドを右クリックらしいです。 ＞カレンダーを利用して　日付データを　入力 カレンダー入力コントロールは提供されてないので、カレンダーを模した入力フォームを自作する必要があるのだそうで。
2行目がファイル名だけということではないですよね。 計算式はいろいろありそうですけど =GetValue ( Substitute (オプジェクト ; "/" ; "¶" ) ; ValueCount ( Substitute (オプジェクト ; "/" ; "¶" ) ) ) とかはどうですか。オブジェクトはオブジェクトフィールドのことです。 オブジェクトフィールド内の「/」全部を改行に変更して最後の行の値を 取得する式です。ファイル名に「/」があるとダメですけど。
> 二度手間を避けるため、一度入力した顧客コードを空のフォーム上に表示させるには > どうすればいいでしょうか。 「メインメニュー」フォームにテキストボックスを配置して、名前を txt顧客コード とします。 ここに、「顧客登録」に表示させたい顧客コードを入力します。 埋め込みマクロのWhere条件式で [顧客コード]=[Forms]![メインメニュー]![txt顧客コード] と設定します。 「顧客登録」フォーム上の「顧客コード」テキストボックスの既定値プロパティを =[Forms]![メインメニュー]![txt顧客コード] と設定します。 以上でどうでしょうか。
全パターンというのは、最終的に値が取れないものも含めてでしょうか？ 値が取れるものすべて、ならば少し変えるだけで済みます。 http://ideone.com/fQFUC
「(4)検索実行（クエリ）」とは具体的に何をしているのでしょうか。 検索結果表示（フォーム） を開くときに引数で抽出条件を設定するか、抽出条件を設定したクエリをレコードソースにしておけば、抽出結果を表示出来ると思いますが。 普通は、クエリを実行する必要はないと思います。 一度、「(4)検索実行（クエリ）」の処理を削除して試してみてください。 それでも解消しないなら、「検索」ボタンの埋め込みマクロの最後に、 「オブジェクトの選択」アクションで検索結果表示（フォーム）を選択する処理を追加すればどうでしょうか。
最初の回答者の方と重複しますが 問題MDBを自身のPCにコピー。 Accessで空のMDB作成 （初期値はDatebase1.accdbになってますので拡張子をmdbに変更） （Access2003以前では使用しないのならばaccdbでも可） 空のMDBの、ファイル→オプション→カレントデータベース の名前の自動修正オプションのチェックは全て外す。 一旦MDBを閉じる。 再度開いて、リボンの外部データで問題MDBを全て、 この新規MDBにインポートする。 新規MDBでオブジェクト名が正しいか等、 VBAでは参照設定に参照不可になっているものがないかチェック。 その他諸々のチェック。 問題が無いのを確認したら、MDBを閉じる。 新規MDBのコピーを作成し（最適化の時に壊れる可能性を配慮） 新規コピーMDBを開いて最適化を試みる。 ■解決するかどうかの保証は出来ません。■ ※ファイルサイズが2GB近いならAccessの仕様の限界です。 テーブルにOLEオブジェクトの埋め込みでもしているのでしょうか？ もし問題が解決したとしても、ファイルサイズが2GB近いのなら 早晩また問題が発生する可能性があると思います。 また、Accessからも警告メッセージが出ていたはず。 なお、ファイルを共有しているので 「閉じる時に最適化」のオプションにチェックは入れないように。
その式では、「[Forms]![frm検索1]![消費者名]」で始まるデータを抽出することになります。 そのような名前の消費者が存在するはずもないので当然0件となります。 ""から出して & で連結しましょう。 Like [Forms]![frm検索1]![消費者名] & "*"
データ例をもとに説明した方が分かりやすいと思います。 テーブル1 グループ ---------- A A A B B このテーブルを元に選択クエリを作成してフィールドに下記の式を記述します。 件数: DCount("*","テーブル名","グループ='" & [グループ] & "'") グループ　件数 ---------- A　3 A　3 A　3 B　2 B　2 というようにグループ件数がすべてのレコードに表示されます。 式を下記に変更すると、 式1: 1/DCount("*","テーブル名","グループ='" & [グループ] & "'") グループ　式1 ---------- A　0.3333333 A　0.3333333 A　0.3333333 B　0.5 B　0.5 テーブルから集計クエリを作成して、 フィールド　件数: Sum(1/Count("*","テーブル名","グループ='" & [グループ] & "'")) 集計 演算 とすると、 .3333333 + 0.3333333 + 0.3333333 + 0.5 + 0.5 = 2 となり下記の結果になります。 件数 ---- 2 この方法は初めてみました。なかなかユニークな方法ですね。 ただし、DCountは重い関数で、データ件数分繰り返し呼ばれますので、件数が多い場合重くなります。また、逆数にするときに有効桁数以下が切り捨てられますので、誤差が出る可能性もあります。 参照先の回答でも「クエリを2段に使うほうが一般的だしスマートですよ」と言われているようにクエリを2段に使う方がはるかに高速に処理できます。 クエリが増えるのはいやだ、1個のクエリで実現したい場合は、SQLビューでサブクエリを使って下記のように記述すれば可能です。 SELECT Count(*) AS 件数 FROM (SELECT DISTINCT グループ FROM テーブル1);
修正したときのみ、「元に戻す」を実行するようにすればいいでしょう。 修正したかどうかは Dirtyプロパティで調べられます。 　　条件　　　　　　　　　　　　　　アクション　　　　　　　　引数 [Forms]![フォーム名].[Dirty]　　コマンドの実行　　　　元に戻す
すみません。 t2の抽出条件が抜けていましたね・・・ ただ、No.4の補足にある >inner join t2 on (t2.key = (SELECT key FROM t2 WHERE name = 't2_name1')) では正しくないです。 こうしてしまうと、t2とt5の結合条件がなくなってしまうので、 t2に存在しない、t5の'2011-03-03'のレコードまで抽出されてしまうことになります。 ですので結果が13300になってしまいます。 >inner join t2 on (t2.key = (SELECT key FROM t2 WHERE name = 't2_name1')) こうではなくて inner join t2 on (t2.key = t5.t2_key and t2.name = 't2_name1') とすればいいです。 なので、 select sum(t5.amount * (t4.percent / 100.0)) result from ( 　( 　　select strftime('%Y', date) year, t2_key, t3_key, amount 　　from t5 　　where strftime('%Y', date) = '2011' 　) t5 　inner join t2 on (t2.key = t5.t2_key and t2.name = 't2_name1') 　inner join 　　( 　　　select t4.* from t4 　　　inner join t1 on (t4.t1_key = t1.key and t1.name = 't1_name1') 　　) t4 　on (t5.t3_key = t4.t3_key and t5.year = t4.year) ); これでどうでしょうか。
下記のSQLでどうでしょうか。 select top 1 * from mydata where 'P2342' Like key1 & "*" order by key1 desc;
管理番号とデザイン内容のフィールドオプションで入力値の自動化で 計算式を選んで、式を「" "」にして既存値を置き換えるにチェックす ると複製したときどちらのフィールドも空になります。 スクリプトでやるときは 　レコードの複製 　消去/管理番号 　消去/デザイン内容 　フィールドへ移動[]　--指定しない
テーブル名を「TF」と仮定します。 また、name に重複が無いものとします。 クエリのSQLビューで以下を記述します。 SELECT Q1.name, Q1.friendname, Q2.friendname AS friendname2 FROM TF AS Q1 LEFT JOIN TF AS Q2 ON Q1.friendname = Q2.name; この表示結果は以下となります。 name　　friendname　　friendname2 aaaa　　bbbb　　cccc bbbb　　cccc　　aaaa cccc　　aaaa　　bbbb dddd　　aaaa　　bbbb eeee　　bbbb　　cccc ffff　　eeee　　bbbb
見た目Accessですが、DBシステムにより 方言があるので、何のDBか記述すべき。 Acccess2003ならサブクエリができる。 SELECT A.author,SUM(X) AS 集計 FROM (SELECT A.author,A.money*B.cnt AS X FROM book AS A INNER JOIN daityou AS B ON A.bookname=B.bookname) AS A GROUP BY A.author
SQLの土俵はなんですか？ あと、カンマの後ろに半角スペースを入れる習慣をつけると読みやすいですよ。 select book.author, sum(book.money * daityou.cnt) from book, daityou where book.bookname = daityou.bookname group by book.author ;
フォームに配置したテキストボックスのプロパティを下記のように設定。 コントロールソース　=CDate([退勤])-Cdate([出勤])-CDate([休憩]) 書式　hh:nn ただし、深夜0時を超える退勤はないものとしてます。 以下、回答ではなく、アドバイスです。 現状のようにテキスト型にしておくと、計算したり、集計するときに日付/時刻型に変換する必要があります。 勤務時間を集計したりする場合、データ件数が多いと重くなる可能性があります。 データ型は、日付/時刻型か、数値型にして分単位で格納するか、にしたほうがいいでしょう。 日付/時刻型にしておけば、上記の式は下記のようにシンプルになります。 =[退勤]-[出勤]-[休憩]
＃１です 訂正です。 以下の様なデータがあった場合は想定していませんでした。 ID 判定 日本語　　　英語 ・・・・ 11　　 o 　テスト　　　tests 12　　 o 　テスト　　　tests １）での ORDER BY 日本語, ID　は、ORDER BY 日本語, 英語, ID　としてください。 ２）での　日本語=Q2.日本語　の後に、 AND 英語=Q2.英語　を追加してください。 重複クエリを使った例になっていなかったので、 １）は、 SELECT Q1.ID, Q1.判定, Q1.日本語, Q1.英語 FROM TE AS Q1 INNER JOIN (SELECT 日本語, 英語 FROM TE GROUP BY 日本語, 英語 HAVING Count(*)>1) AS Q2 ON (Q1.日本語=Q2.日本語) AND (Q1.英語=Q2.英語) ORDER BY Q1.日本語, Q1.英語, Q1.ID; ２）は、１）を「Q_TE_1」名で保存したとして（＃１と変わりありませんが） SELECT ID, 判定, 日本語, 英語 FROM Q_TE_1 AS Q3 WHERE EXISTS (SELECT 1 FROM Q_TE_1 WHERE 判定<>Q3.判定 AND 日本語=Q3.日本語 AND 英語=Q3.英語); なお、これらは更新できない表示となります。 ＃１は、更新可能です。
ごみ箱を右クリックで フォルダーを空にするで出来ないですか。
現在表示されているレコードだけを印刷したいということですね。 DoCmd.PrintOut の部分を、 DoCmd.PrintOut acSelection と変更すればいいでしょう。
現状はマクロですか、VBAですか。 VBAならば、下記のようになります。 メインフォームのレコード移動の「イベントプロシージャ」に下記のように記述します。 Private Sub Form_Current() If Me.NewRecord Then Me.サブフォームコントロール名.Enabled = False Else Me.サブフォームコントロール名.Enabled = True End If End Sub 会社名の更新後処理で、 Private Sub 会社名_AfterUpdate() If IsNull(Me.会社名) Then Me.サブフォームコントロール名.Enabled = False Else Me.サブフォームコントロール名.Enabled = True End If End Sub マクロも同じ考え方でできます。
クエリの抽出条件を下記のように設定します。 フィールド　対象フィールド　Forms!フォーム名!コンボボックス名 表示　　　　　レ　　　　　　　　□ 抽出条件　<>""　　　　　　　"あり" または　　　Is Null　　　　　　"なし" これで質問で提示された条件で抽出されます。 ただし "" と　Null が混在する場合、どちらにも表示されない場合がありますが。
> チェックボックス付きの一覧が表示されるフィールドと,表示されないフィールド 定義されている内容と、登録されているデータはどんな状態？ 「チェックボックス付きの一覧を表示させる」意味が無い状態とか。 性別フィールドが定義されていて、取りうる値が「男性/女性」の２値なら 「チェックボックス付きの一覧を表示させる」意味はあろうけど チェックボックス付きの一覧が表示されないフィールドは 何万もレコードがあって、登録されているデータの種類も何万とあるなら、 「チェックボックス付きの一覧を表示させる」意味はなさそう。 （例：全国郵便番号簿テーブルの"郵便番号"）
> オプショングループのコントロールソースは何も指定していません。 オプショングループのプロパティ設定が下記になっているか確認。 使用可能　はい 編集ロック　いいえ フォームのプロパティ設定が下記のなっているか確認。 更新の許可　はい
With Me 　　Debug.Print .Controls("単価_" & cnt) End With とか。 Me("単価_" & cnt) でも参照できます。
質問者さんが書かれていることはリレーショナル型のデータベースが一番得意とすることです。多分全部できると思います。 EXCELだとどうなんでしょうか。VBAの得意な人はある程度のことができる様な気もしますが、データベースソフトならあまり苦労しないで可能です。 高度な使い方ではないので、No.1に書かれているようにFilemakerがちょうど良いのではないかと思います。最初はEXCELなどで、表をつくってみられてはいかがでしょうか。 食器の種類ごとに、整理番号、食器名称、大きさ、形状、色調、用途、数量、保管場所など、１種類につき１行で。 それと、 献立ごとに必要な食器の種類と数量（人数にも依存するでしょうから大皿は何人１枚とか）の表をつくると、献立と人数を入れると必要な食器をリストアップしてくれるなどが可能です。 献立が同じでも、数種類の食器の候補から選ぶのはちょっと考えないといけないような気もしますが、組み合わせの種類が多くないのなら難しくないように思います。 あとは顧客管理や予約管理も一緒にやってしまうこともできます。 EXCELでのデータがある程度できた段階で、Filemakerに読ませればそれなりのデータベースができます。試用版で試してみてはいかがでしょうか。
カスタムダイアログ表示ステップの後ろに Get ( 最終メッセージ選択 ) を入れて分岐していますか？ ボタン１が「OK」、ボタン２が「キャンセル」の場合 If [Get ( 最終メッセージ選択 ) = 2 　現在の（全）スクリプト終了 とか。
レポートの集計機能を使っても、クエリを使っても、どちらでもできます。 レポートウィザードを使えば、レポートの集計機能を使った方法が簡単にできます。 ウィザードによりレポート作成する方法 http://www.microsoft.com/japan/office/previous/xp/suminaka/access/sousa/1/sousa1_27_1_honbun.htm 上記のページの説明で、集計オプションの指定のところで表示するデータの「集計値のみ」にチェックを入れておくと合計のみ表示されます。 クエリを使う場合は下記の手順で。 クエリを新規作成して、消費者マスターと判定マスターを追加します。 ２つのテーブルを判定コードで連結します。 集計クエリにします。 下記のように設定します。 フィールド____販売店コード___判定コード___判定結果____件数: 消費者コード___料金合計: 料金 集計__________グループ化______グループ化__グループ化__カウント_________________合計 このクエリをレコードソースとするレポートを作成します。 レポートフッターにテキストボックスを2つ配置してコントロールソースを下記のように設定します。 =Count([消費者コード]) =Sum([料金]) これで総件数と総合計が表示されます。
グローバル数字フィールドを作って 閉じるときのスクリプトでそのグローバルフィールドにレコードIDを入れる。 開く時のスクリプトを レコードへ移動/最初の Loop Exit Loop If [Get(レコードID)=そのグローバルフィールド] レコードへ移動/次の End Loop などとするかな？
Null値（未入力値）は特殊な値ですので、=演算子では比較することはできません。Is演算子を使います。 抽出条件欄に Is Null としてください。Null以外を抽出するときは、 Is Not Null とします。
レポートのテキストボックスのコントロールソースを下記のように設定してください。 =Choose([用途区分],"家庭","業務用","その他") ただし、データベースの機能を活かしたお勧めの方法は、下記のようなマスターテーブルを作成してそれを利用する方法です。 T_用途区分 -------------------- 用途区分　区分名 -------------------- 1　家庭用 2　業務用 3　その他 レポートのレコードソースの「ビルドボタン」をクリックして、クエリのデザインビューを表示させて、T_用途区分 を追加して、 用途区分フィールド同士で結合します。T_用途区分の「区分名」をダブルクリックしてフィールドに表示させます。 レポート上に「区分名」フィールドをテキストボックスとして配置します。 こちらの方法ですと、例えば用途区分が増えたり、変更になっても、テーブルデータの編集のみですみます。 最初の方法だと、フォームのコンボボックスやレポートのコントロールソースなど複数箇所の変更が必要になります。
「年月」フィールドのデータ型は何ですか。また、データはどのような書式で入ってますか。 日付/時刻型 ならクエリの「年月」フィールドの抽出条件欄に下記の式を設定すればいいでしょう。 <DateAdd("m",[月数を指定してください],Date()) で、このクエリを削除クエリにして、実行すれば、「月数」を聞いてきますので、希望の月数を入力すればそれ以前のレコードは削除されます。
例えばピリオドがある場合にピリオドより後ろをフィールドBに入れるという方法ではどうでしょうか。 式は Middle(フィールドA ; Position(フィールドA ; "." ; 1 ; 1)+1 ; 100) 最後の100はちょっと手抜きで使われてる文字数より大きな数字です。ピリオドが社名に使われている場合はまず無いと思いますが、もし使われている場合は他の記号で区切ってください。
状況がよく分かりませんけど レコードの保存なら、VBA では、Docmd.RunCommand acCmdSave なんですけどね。 Access2000は落としてしまったので違うかも知れませんが ショートカットキーなら F9 や Ctrl + S かな？
ANo.1さんの回答の参照先は Visual Basic の例ですね。 AccessVBAはちょっと異なっていて癖がありますのでVBのコードをそのまま使えません。 ■コントロール名(文字列型)を変数にする場合 Dim　strCtl As String strCtl = "TextBoxName" Me.Controls(strCtl).FontSize = 9 .Controls は省略することもできます。 Me(strCtl).FontSize = 9 ■コントロールオブジェクト（オブジェクト型）を変数にする場合 Dim objCtl　As Object Set　objCtl = Me.TextBoxName objCtl.FontSize = 9
どこかにあるかもしれませんので、写真の検索を行ってみて下さい。
すみません、不都合が二つほど 標準モジュールは Function countStr(s As Variant) As Long 　　Dim i As Long 　　For i = 1 To Nz(Len(s),0) 　　　　If Mid(s, i, 1) Like "[A-z,Ａ-ｚΑ-ω]" Then 　　　　　　countStr = countStr + 1 　　　　End If 　　Next End Function に変更してください。 F1 と F2 のどちらかが Null だった場合のことを考慮。 また、クエリは 判定:iif(countStr([F1]) = countStr([F2]) ,"一致","不一致") にしてください（前回F1どうしを比較してましたorz） これで抽出条件に、"不一致"で出来るハズです。 以下は独り言です。 ギリシャ語のホームページからAccessのフィールドにコピペすると ほとんどの文字が全角文字に変換されてしまいます。 しかし、中には半角文字のままのが少々。 なあぜぇ？？ 少々の半角文字になってしまう文字については nora1962 さんの回答で SELECT regexp_count( 項目, "[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□]")　FROM テーブル △□は、その文字を順次一文字づつ追加したイメージです。 にすれば出来ました。 F1の個数:regexp_count([F1],"[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□]") F2も同様に 判定:iif(regexp_count([F1],"[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□]") = regexp_count([F2],"[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□])","一致","不一致") 私は文字について根本的な事がわかっていないので危ない雰囲気 (^^ゞ 私の回答ではpattern をコード中に埋め込んでしまっているので出来ません。 （VBEではShift-JIS？ですのでコピペした時点で半角ギリシャ文字が『?』になります） また前回回答でキャラクタコード云々の事をエラソーに言ってますが、これも忘れてください。 さっぱり判らなくなりました。
デスクトップにあるaaaというフォルダに対象レコードのオブジェクトフィールドを書き出す例です。 画像名は「画像名」というフィールドに入っているとします。 ・レコードへ移動/最初の ・Loop ・変数を設定　 　　名前「$p」　 　　値「"filemac:/Macintosh HD/Users/ユーザ名を入れる/Desktop/aaa/" & 画像名 ・フィールド内容のエクスポート　ターゲットはそのオブジェクトフィールド　 　　出力ファイルの指定欄に$pと手入力 ・レコードへ移動/次の/最後まで来たら終了 ・End Loop
はい，それでよいでしょう。
現状のクエリに下記のフィールドを追加してください。 フィールド　　　　判定: IIf(Count([フィールド名])=3,"OK","NG") グループ化　　　演算
>「果物の出現回数が多い順に並べる」 ということなら、 select * from tableA x order by (select count(*) from tableA y where y.name = x.name ) ,No とか、 select x.no,x.name from tableA x, (select y.name,count(*) cnt from tableA y group by y.name ) z where x.name = z.name order by z.cnt,x.No とか。 DBにより多少変わるかも。(as句が必要だったりとか・・・）
すべてのページに表示させたいと言うことですね。 販売店コードフッターで正常に表示されているなら、出力範囲も販売店コードも、 ページフッターに単純に移動させただけで問題なく表示されるはずです。 frm出力範囲 は開いたままにしてますよね。 とりあえず現状の設定してある式をコピーして貼り付けてください。 それと、Accessのバージョンも教えてください。
ＣＭＳにもよるかと思いますが可能だと思いますよ。 例えば、ＣＭＳの代表としてWORDPRESSなどがありますが、この場合、現在のサーバーの管理パネルにログインして、【エクスポート】というものでデーターを抜き出します。 次に新しいサーバーにWORDPRESSのプログラム本体をインストールした後で、同じようにバックアップデーターを復元するを選択すると、そのサーバーに最初のサーバーの時と同じデーターが瓜二つでできます。 もちろん写真などのデーターもすべてコピーできています。 ＣＭＳは基本的にサーバーのデーターベースという機能を使用しますので、サーバーそのものの管理パネルの中にデーターベースの中身をエクスポートできる機能がありますし、復元もできると思います。 ドメインというのは、たぶん独自ドメインのことだと思いますので、ドメインの管理パネルにログインして、サーバーのデーターとして、【ネームサーバー】というところを新しいサーバーの指定するものに変更します。 ネームサーバーというのは、その独自ドメインのURLが呼び出された時に、どのサーバーへそのことを転送するか？という役割を一瞬で振り分けているだけになります。 ネームサーバー変更を行いますと、早ければ１時間後に新しいサーバーの方のデーターを呼び出しますが、古いサーバーと新しいサーバーがまったく同じデーターになっていると、どちらが呼び出されているのかがわかりにくくなりますので、インデックスページなどを少しだけ書き換えたりして、自分でわかるようにしたりもします。
sub 印刷ボタン_click() DoCmd.OpenReport "テストレポート, acViewPreview, , "テスト1 = '" & txt_inputID & "'" を DoCmd.OpenReport "テストレポート, acViewPreview, , "テスト1 = '" & me!txt_inputID & "'" ,openargs:=me.name にしてください。 あとチェックボックスの方なのですが、印刷プレビューだけの場合でもチェックを入れて構わないのでしょうか？ 勝手に印刷時のみと思い込んで回答します。 レポートの其々のイベントに下記のように、といってもYU-TANG さんの受け売りですけど。 Option Compare Database Option Explicit Private IsPreview As Boolean ' プレビュー判定用フラグ Private Sub Report_Activate() 　　IsPreview = True End Sub Private Sub レポートヘッダー_Format(Cancel As Integer, FormatCount As Integer) 　　If Me.Visible Then IsPreview = False End Sub Private Sub Report_Close() 　　If Nz(Me.OpenArgs, "") = "" Then 　　　　Exit Sub 　　End If 　　If IsPreview Then 　　　　' 印刷プレビューの場合の処理 　　　　MsgBox "印刷プレビュー" 　　Else 　　　　' 印刷の場合の処理 　　　　If MsgBox("印刷は無事終了しましたか？", vbYesNo) = vbNo Then 　　　　　　Exit Sub 　　　　End If 　　　　 　　　　CurrentDb.Execute ("UPDATE てーぶる名 SET テスト5 = True WHERE テスト１='" & Me!txt_inputID & "'") 　　　　Forms!テストメインフォーム.Recalc 　　End If End Sub 補足 　　If Nz(Me.OpenArgs, "") = "" Then 　　　　Exit Sub 　　End If はレポートを単独で開かれた場合には何もしないということです。 DoCmd.OpenReport "テストレポート, acViewPreview, , "テスト1 = '" & me!txt_inputID & "'" ,openargs:=me.name でフォームから開いた場合は、openargs:=me.name で名前を渡しています。 蛇足 　　　　If MsgBox("印刷は無事終了しましたか？", vbYesNo) = vbNo Then 　　　　　　Exit Sub 　　　　End If は今回の場合は１レコードだけ？の変更なので邪魔かもしれないです。 多くのレコードの一括変更の場合などの時は入れとくと幸せになれるかも。 ※夏バテ気味で何処かにポカが空いてるかも知れません。。。
提示された情報からは、No.2 の回答の ="住所コード：" & Forms![frm出力範囲]![住所自] & "～" & Forms![frm出力範囲]![住所至] & Chr(13) & Chr(10) & "販売店コード：" & Forms![frm出力範囲]![販売店自] & "～" & Forms![frm出力範囲]![販売店至] & Chr(13) & Chr(10) & "担当者コード：" & Forms![frm出力範囲]![担当者自] & "～" & Forms![frm出力範囲]![担当者至] で問題ないはずです。 情報に間違いがあるか、式に記述ミスがあるとしか思えません。 オブジェクト名に間違いがないか、記述に間違いがなかい注意深く確認してください。全角/半角が違っていたり、空白が入っていたりなど、ちょっとでも違うとエラーになります。 あと、このレポートを開くときに、フォーム「frm出力範囲」は開いたままにしてますよね。閉じちゃったら参照できませんのでエラーになります。
CSVをリンクテーブルとして取り込みます。 テーブルを元に更新クエリを作成して、DLookupでリンクテーブルの値を参照して更新するようにすればどうでしょうか。。
> なので、「Accessのレポートのグループフッターにおいたテキストボックス」だと > > 255文字で制限されるのですが、 > > 「Accessのレポートの詳細においたテキストボックス」では、 > > すべての文字が表示されます。 クエリでグループ化すると２５５文字で制限されるという報告もありました。 それと似た現象のように思えます。 詳細においたテキストボックスではすべて表示されるということなら、 そのテキストボックスの可視を「いいえ」にしておいて、 グループフッターに配置したテキストボックスから、そのテキストボックスを 参照するようにしてみてはどうでしょうか。
コマンドボタンのクリック時のイベントプロシージャに下記のコードを記述します。 対象フィールドのデータ型が数値型の場合 DoCmd.OpenReport "レポート名", acViewPreview, , "フィールド名=" & Me.テキストボックス名 対象フィールドのデータ型がテキスト型の場合 DoCmd.OpenReport "レポート名", acViewPreview, , "フィールド名='" & Me.テキストボックス名 & "'" 対象フィールドのデータ型が日付/時刻型の場合 DoCmd.OpenReport "レポート名", acViewPreview, , "フィールド名=#" & Me.テキストボックス名 & "#"
「フォームを開く」マクロの「Where条件式」に提示の式を設定したと言うことでしょうか。 で、希望することは、マクロを実行すると、「パラメータの入力」ウィンドウが開き、標題に「消費者コードは？」と表示されていて、ユーザーが入力した値と一致する[消費者コード]のレコードをフォームに表示させたいということでしょうか。 上記の推測があっているとすると、、、 「フォームを開く」マクロの「Where条件式」に下記の式を設定してください。 [消費者コード]=[消費者コードは？] この推測が違っているのなら、 どこに提示の式を設定して、 どのような動作を希望しているのか、 具体的に説明してください。
ビジネス活用事例から見て，(1)(2)(3)すべてNoです。 http://japan.zdnet.com/cio/analysis/35011528/
SDカード内にデータペースを作るちょっと特殊な方法だと削除は出来るけど通常の方法の rom内にデータペースを作るタイプだとrootでも取ってない限りそこにアクセスしてデータを削除することはできない。 アプリの管理画面からデータの削除をするしかない。
CSVとか MDBとか
今までの機能は2007？から削られたようです。 私の場合は、Alt + Tab で切り替えていたのでがっかりです。 代替案としては、最初の方の回答の他には ナビゲーションフォームを作る位しか無さそうです。 http://msdn.microsoft.com/ja-jp/library/office/ff851947.aspx なお、タブの表題の所を、得意先 → 得意先 &1 （半角の数字やアルファベット） 等としておくと、 フォームビューでは、得意先 1 の1の下に _ （アンダーバー？）が付きます。 この状態で Alt + 1 とするとそのタブに移動します。 ですが、いずれにしても以前に比べると・・・ですね。(-"-) MukkuMuku さんが考えられたようですが、私はAPIに関しては門外漢なのでご紹介まで。 http://mukkumuku.blogspot.jp/2010/11/office2010-win32api-getwindowlongptrget.html
「入力インターフェイスにExcel」 「同時利用者が数十名」 「ADO」で接続してデータ操作 「閉じるときに最適化する」にチェックしておいて、 「ExcelからAccessアプリケーションを呼び出してある資料をレポート出力」 という運用を考えているのですね。 No1、No2の回答でも言われてますが、ADOで接続して接続を閉じただけでは最適化されませんし、CreateObject で Access を起動しているのなら、Accessオブジェクトを閉じた時に最適化されます。 ただし、このような運用は、非常に危険だと思います。 例えば、誰かが ADOで接続してデータ操作しているときに、別のユーザーがレポートを印刷して閉じて最適化されたら、どうなるのか。 あるいは、二人がほとんど同時にレポートを開き印刷後閉じて、同時に最適化が始まったら、どうなるのか。 accdbファイルが破損する危険性が非常に高い運用だと思います。 最適化に失敗してデータファイルが消滅したという報告をまれにWEBでみることもあります。 レポートを印刷するたびに最適化を繰り返すというのはやはり破損の危険性を高めます。 No1の回答で紹介されているリンク先 http://office.microsoft.com/ja-jp/access-help/HA010341740.aspx でも、 > ネットワーク上で複数のユーザーが単一のデータベース ファイルを共有する場合を除き、最適化と修復を自動で行うようにデータベースを設定します。 というようにファイルを共有している場合は、最適化を自動で行うのは推奨していません。 accdbファイルを置いているサーバーが常時電源オンになっているなら、深夜など誰も使用していない時に、あるいは毎朝、電源を入れるならPC起動時に、自動で最適化するようにするのがいいかと思います。 安全性を重視するなら、バックアップをとってから最適化するようにするのがよりいいでしょう。Accessにおいては定期的なバックアップは必須です。 具体的な方法としては、Windowsのタスクで、上記のリンク先の最適化ショートカットのコマンドを実行させるようにします。
レコードの並び順は保証されていません。 http://support.microsoft.com/kb/834927/ja http://www.naboki.net/access/achell/achell-03.html 指定してやる必要が有ります。 入力順などというプロパティは無いので、 入力順に並べたい場合は、オートナンバー型のフィールドを追加して そのフィールドを並び替えのキーに指定するとかではないですかね。
UTF-8 で間違いはないのでしょうかね。 以下思いついたことです。 １・BOMの有無で読み込みが変わらないか。 ２・Shift-JIS に変換してしまったら・・。 ３・ADODB.Stream で読み込んだら。 http://d.hatena.ne.jp/replication/20091117/1258418243 ４・Excelに一旦読み込ませたらどうなるか。 ５・テキストファイルをそのままデータベースとして開いたら。 http://home.att.ne.jp/zeta/gen/excel/c04p47.htm そちらのAccessのバージョンが不明なので "Provider=Microsoft.Jet.OLEDB.4.0;" & は "Provider = "Microsoft.ACE.OLEDB.12.0;" かも知れない。 Ｘ・もしかしてファイルが壊れてる？ そのファイルの製作元にShift-jis で出力できないか頼んでみる。 以上、ご参考まで。
select table.id, table.stock from [table] where id = (select table.id from [table] where table.stock is null) and table.stok is not null とかかな。
where 日付 = '" & getDate & "'" 　　　　　↓ where 日付 = #" & getDate & "#"
質問者様はグラフに表示された数式と同じワークシートの数式を正しく作成されています。 （実際の数式ではyはなくxのところにセル参照が入っているのですよね） 元データと合わない原因ですが、グラフに表示された数式の係数の精度不足ではないでしょうか。 それが原因であれば、グラフに表示された数式の表示形式を変更して係数の精度を上げ、その数値でワークシートの数式を作り直せば多くの場合解決します。 どのような数値でも精度良く表示するためには、表示形式を指数にして小数点以下14桁にするとよいと思います。 ご存知かもしれませんが、以下念のためグラフに表示された数式の表示の変更方法を説明します。 Excel2003とExcel2007についての解説となりますが他のバージョンも大きくは違わないと思いますのでそこのところの対応はよろしくお願いいたします。 １．グラフに表示された数式を右クリック ２．2003なら「データラベルの書式設定」をクリック、2007なら「近似曲線ラベルの書式設定」を左クリックする。 ３．書式設定のダイアログが出るので、「表示形式」を左クリック（2003は上、2007は左上。最初からクリックされた状態になっている可能性あり。） ４．「分類」（表示形式）の「指数」を左クリック。（「数値」はNG） ５．「小数点以下の桁数」を14にする。（最大30だが「分類」（表示形式）が「指数」ならば15以上は無意味。Excelの精度が15桁であるため。） ６．「OK」を左クリック なお、質問者様の作成された式の「2*POWER(10,8)」の部分ですが、「2*10^8」「2E+08」「2e8」などとしても数式の値としては同じになります。
No.1です。 レコード数が多いだけにメモリ上に全部は乗らないし、HDD上でも巨大なファイルになってしまうので扱いにくいですね。 さらに、weight_gramが同じ値が何度も現れるので、インデックスをつくるのにかなり時間がかかってしまうようですね。 さて、これもご存知かもしれませんが、フリーのものとして mongoDBがあります。 http://www.mongodb.org/ 多くのOSに対応し、APIもいろいろあるようです。 こんな比較記事をみつけました。 http://mojix.org/2011/06/15/couchdb-mongodb また、ベンチマークも http://blog.livedoor.jp/sasata299/archives/51429383.html
それは、選択クエリです。 http://www.geocities.jp/haku1569/pasocom/microsoft/access/qeri/0024.html 更新クエリに変更してください。 2007以降ならクエリをデザインビューで開けば リボンの中に『更新』てのが有ります。
aliasは，あるSQL文において定義され，そのSQL文の実行中に限って一時的に使用できる別名です。 synonymは，create synonym文によって定義され，他のオブジェクトからも永続的に使用できる別名オブジェクトです。 シノニムも エイリアスも「別名」ですか？　と問われれば，はいそうです，と答えますけれど， シノニムと エイリアスは同じ意味？　と問われたなら，いいえ違います，と答えます。
アクセスで空白がグループ化されない http://oshiete.goo.ne.jp/qa/7600416.html という場合もありますので、抽出条件には NZ([フィールド名],"") = "" NZ([フィールド名],"") <> "" で分けた方が良いかと。
こういうことですか。 Table1 ユーザーID,商品ID,数量 001,ABC,3 001,XYZ,2 002,FFF,4 だとして、種テーブルを一個作ります テーブル名：Tno Rno 1 2 3 4 ・ 数量の最大値を超えるまで連番で。 クエリのデザインビューに上記のTable1とTnoを加えます 結合線は引きません。 フィールド：ユーザーID｜あれ:1|　　数量｜Rno テーブル：　　　Table1｜　　　｜Table1 ｜Tno 表示：　　　　　　レ　｜　レ　｜　レ　 ｜レ 抽出条件： 　　　　　 ｜　　　｜　　　 ｜<=Table1.数量 これで確認してOKなら、数量とRnoの表示のチェックは不要です。 かな？
Values の中に Select は書けません。 下記のように書いたらよいはずです。 INSERT INTO TableA SELECT COUNT(*), 'データ' FROM TableA
テーブル名を、T1 として 品番　数量　場所 A　　　100　　上 B　　　 50　　上 B　　　 30　　下 ならクエリをSQLビューで表わすと SELECT 品番, (SELECT Sum(数量) FROM T1 AS Tx WHERE T1.品番= Tx.品番) AS 数量2,場所 FROM T1 ORDER BY 品番; で 品番　数量　場所 A　　　100　　上 B　　　 80　　上 B　　　 80　　下 になりますので、レポートで品番と数量2の重複レコード非表示にすれば 品番　数量　場所 A　　　100　　上 B　　　 80　　上 　　　　　　　下 の様にはなります。 （レイアウトが崩れていたらメモ帳などで等幅フォントで見てください） 添付図のように品番と数量を上下センターに収めたい時は・・・ http://www.accessclub.jp/bbs/0231/beginers72024.html のhatena さんのレスをご参考に。 中途半端な回答で御免。
Accessの場合も、Accessというソフトとデータが入ったファイルの2つが必要ですよね。 サーバにインストールされているデータベースソフト（Accessのようなもの）上で、データファイルが1個持てますという意味です。 PHP自体にはデータベース機能はありませんので、PHPからデータベースソフトに接続して、データベース内のデータを検索したり、あたらなデータを登録したりして使用します。
こう? SELECT t1.name AS site_name, t2.* FROM stock_sites AS t1 LEFT JOIN stocks AS t2 ON t1.id = t2.stock_site_id and t2.item_id = 1 ORDER BY t1.id;
　この情報では、出来ることもあれば出来ないこともある。効率が悪いこともあるしそれが最善であることもある。 　としか書けないです。答えになってませんよね（苦笑） 　そうですね。あなたが書いたｓｅｌｅｃｔ文を全部省略せずに書いてください。テーブル名とフィールド名は適当に変えてもかまいません。でもそれ以外の分は何も変えずに省略せずに書きましょう。 　又は、テーブルの定義と、あなたが求める結果を日本語で省略せずに書いてください。この場合は、出来れば、フィールド名・テーブル名も変えて欲しくないですね。最低でも、あなたが求める答えを作るのに必要なテーブル間・フィールド間の関係が解るだけの説明が必要です。 　フィールド名やテーブル名がそのまま全部出せるならどちらでもかまいませんが、名前が事情により出せないのであれば、前者の方が簡単でしょう。 　ここまで出てくれば、たくさんの人がいろいろな方法を提示してくれるでしょう。
オリジナル文字列が abc___________ とａｂｃ＿＿＿＿＿ だった時にインポートした時点で末尾の半角スペースは削除されます。 半角文字フィールド｜全角文字フィールド abc　　　　　　　 ｜ａｂｃ＿＿＿＿＿ なので 半角全角のフィールドを結合したいのなら クエリなどで 結合:[半角文字フィールド] & space(14-len([半角文字フィールド])) & [全角文字フィールド] にして行うとか。
データが大量になってくるとデータベースを使うのが便利だと思います 1) No.1で書かれている無料で手に入るOpenOffice(あるいはLibreOffice) 2) 質問者さんが書かれているMS Access 3) それとFileMaker が個人で使われている有名どころです。 曲がりなりにもデータベースですのでそれなりの敷居の高さがあります。 上に書いたものほど敷居は高いように感じます。 私自身は全部使ってみましたが、 a) データ量が多くなりExcelでは対応できなくなった b) データをいろいろな形式で加工し出力したい。 という時には威力を発揮します。 それぞれ試用版がありますので試されてはいかがでしょうか。 http://www.microsoft.com/ja-jp/office/2010/trial/default.aspx http://www.filemaker.co.jp/products/filemaker.html Excelでやれている間はExcelでやるのも一つの選択かと思います。
変換しなくても、書式を ggge\年m\月d\日 とすれば和暦で表示されますが それでは不都合がありますか？
一番の違いは結合は二つのテーブルのデータ双方を抽出結果に含められるのに対し、相関副問い合わせによるクエリでは一方のテーブルからしかデータを抽出できないことです。 後、評価順序としては外部結合の場合、外部結合がされたのちにWHERE条件の判定が行われます。 相関副問い合わせを用いる場合は多くのRDBMSでは駆動表に対する他のWHERE条件の判定を行った後に副問い合わせの判定を行う傾向がありますが、ORACLEで「PUSH_SUBQ」ヒントを使用したりすると副問い合わせを優先的に判定条件に使用したりできます。 後、「結合は最初に結合された一時的なテーブルを絞りこむ」イメージではなく、可能な限り結合された行を連続的に判定していきます。ソートや集約演算など一時テーブルを作らざるを得ない限りはできるだけ避けている実装が大半だと思います。
アクセスは確か『マルチユーザ』には対応して居ないと考えますので。 ファイルメーカをお勧めします。 メインが不動産基本情報、入居者情報 家賃台帳は『不動産基本情報、入居者情報』をリンクします。 詳細はユーザグループが有りますので、検索して下さい。
パッと思いつくのは、「二段階のクエリを作成する」かな １）キーになる２項目を行見出し、カナデータを列見出しにしたクロス集計クエリを作成する。 ２）１）を元にキーになる２項目、すべてのカナデータを連結して１項目にした選択クエリを作成する。
質問の表示通りにということであれば。 会員番号並びを確定するためにオートナンバー型のID というフィールドを追加します。主キーである必要は ありません。 なお、テーブル名は実際に合わせて変更してください。 会員番号が数値型の場合は、 SELECT テーブル1.会員番号, DCount("*","テーブル1","[会員番号]=" & [テーブル1]![会員番号] & " AND [ID] <= " & [テーブル1]![ID]) AS カウント値 FROM テーブル1; 会員番号がテキスト型の場合は、 SELECT テーブル1.会員番号, DCount("*","テーブル1","[会員番号]='" & [テーブル1]![会員番号] & "' AND [ID] <= " & [テーブル1]![ID]) AS カウント値 FROM テーブル1;
>ストアドプロシージャーとは、選択クエリやアクションクエリのことですか？ 全然違います。 ----- プロシージャとは？ プログラム内で繰り返し出現する処理を行うために、一連の命令を一つの手順としてまとめたもの。 （以下略しますが読んでおいたほうがいいでしょう。） ----- 出典元：http://e-words.jp/w/E38397E383ADE382B7E383BCE382B8E383A3.html このプロシジャをデータベース内に格納していつでも使えるようにしたものがストアドプロシジャ。 （ストアド＝stored で、英語では備蓄とか貯蔵という意味。 ） 選択クエリやアクションクエリはあくまでも問い合わせの方法のひとつです。 ストアドプロシジャの中で、選択クエリやアクションクエリを使うことは多々あります。 例えば 「変数Ｘを1から10まで変化させて、項目Ａが変数Ｘの値である選択クエリを繰り返して実行する」 とかがプロシジャになり、 それをデータベース上に格納したものがストアドプロシジャと思ってもらえばいいかと。
属性A,B,C間の関数従属性が与えられていないので (E)
単純なのでは、ファイルが開いたままになっているとか。
初めまして。 MongoDBのGUIツール作っています。 よかったら使ってみてください！ 　■MongoDB GUIツール 「JMongo」 　　http://d.hatena.ne.jp/moremagic/20120625/1340606614 →Java Swingで実装してあり、環境を選ばず起動できます。 　※Win、Linux　で起動することを確認してます。 ではでは。
「テキストのみペースト」はショートカットがcommand+option+vに割り当てられています。もしうまく行けば儲け物です。 さて、CiPTというソフトもあります。PlainClipは他のソフトでショートカットを登録しないといけませんが、こちらはその機能がすでにありますし、邪魔にならなければずっと起動しておくこともできます。 http://tama-san.com/?page_id=2 昔は、複数の操作を1つのショートカットに登録できるソフトがあったのですが、今はできるのでしょうか。 それができるのでしたら、command+option+vに、書式情報を取り除くのとペーストの2つを登録しておけば簡単なのですが。
Sub test() Dim numStart As Integer Dim numEnd As Integer Dim i As Integer numStart = InputBox(Prompt:="最初となるページ番号を入力してください。") numEnd = InputBox(Prompt:="最終となるページ番号を入力してください。") For i = numStart To numEnd Range("D47") = Format(i, "0000") ActiveSheet.PrintPreview Next i End Sub ActiveSheet.PrintOutをActiveSheet.PrintPreview にして確認しましたが、表示されますが。 なお、セルのD47の書式を文字列にしておいてください。
質問は ＞日付型で作成してなく、年齢の出し方も分かりません。 ということでよろしいでしょうか？ まず、下記の列を追加します。これは生年月日をまとめて西暦になおしたものです。 生年月日:Format([年号] & [生年] & "年" & [月] & "月" & [日] & "日", "yyyy/mm/dd") 次に、下記の列を追加します。 これは、「年齢計算に関する法律」によって誕生日の前日に満年齢に達することになっているためで、学校教育法の第22条の就学の基準では「子女の満六才に達した日の翌日以降における最初の学年の初から」となっているためです。もし、この年齢ではなく、当日に満年齢になる計算をお望みの場合は、「Date()」だけに修正すればよいです。（基準日がわからないので、動かした当日にしています） 基準日:DateAdd("d",+1,Date()) 最後に、下記の列を追加します。 年齢:IIf(Format(生年月日,"mm/dd")>Format(基準日,"mm/dd"), DateDiff("yyyy",生年月日,基準日)-1, DateDiff("yyyy",生年月日,基準日)) 上記で年齢の出し方は大体分かるかと思います。 あとは年齢をもとに条件にあう列を追加していくことになるか、上記の年齢計算自体を修正するかになると思います。
A1の日付が15～21日で、なおかつ木曜日なら第三木曜日って事でいいのではないかな？ = IF(AND(DAY(A1)>=15,DAY(A1)<=21,WEEKDAY(A1)=5),"○","_")
次のようなコードにすればよいでしょう。 Sub ページ番号付印刷() Dim mypage As Integer mypage = InputBox(Prompt:="最終となるページ番号を入力してください。") For i = 1 To mypage Range("A10") = i ActiveSheet.PrintOut Next End Sub
7は持っていませんが、ファイルメニューに「レコードをPDFとして送信」 などというのはありませんか？これを（現レコードのみで）実行して メールに添付するだけでいいと思いますが。 PDF保存機能が無くても、ファイルメニューから印刷→PDFがあります。 バージョンアップするとメールを送信スクリプトとともに使って自動化 できます。7の機能が分からないのでここまでですが。
試してみた方が早いのでは？ クライアント条件として FileMaker Pro / Pro Advanced クライアントに、ライセンスされた FileMaker Pro / Pro Advanced 9、10、 または 11 が 1 コピー必要です。 となっていますね。互換性の無い機能を除いては共有出来るとは 思いますけど。
No.2のお礼欄について 基本的には質問者さんの認識でよいと思います。 しかし、データベースをがんがん構築するなんてあまり考えられないのですが。 Filemaker ProやFileMaker Pro Advancedでは少人数での使用を考えた場合に良い選択になると思います。 それ以上になるとFileMaker Server などになってくると思います。 データベースの導入が初めてでしたら、FileMaker Pro Advancedを１ライセンス購入して、必要になったときにFileMaker Proライセンスを追加するのが良いように思います。 Advancedだと個人で名刺管理をしたい場合にも、ライセンスのない他のパソコンで利用できるデータベースが作れますので。
Goは関係無いです。 >そして、やはり一台しかインストールしていないようです。 そのFM12は正規品の購入ですか？ どんな仕組みになっているのか解りませんけどWAN側でも 同一シリアルを感知するのかも。 中古品を購入されたのなら、そんな仕組みだとひっかかりそう。 未登録なら登録してみたらわかるのかな。 どちらにしてもFM社に電話した方がいいのでは？
「ｘｘできない」とか「エラーになる」とかでなく、具体的にどのようなエラーメッセージが出るとか事象を具体的に提示してください。 データ不整合やVACUUMができないなら、必要なデータを可能な限り救出して、データベースを再作成するしかないのでは？ .dump　→ .read　でダンプしてリストアするといった方法があります。ただし、動画などbinaryデータを格納しているなら、selectでhex関数を使って16進数でファイル出力といった工夫をする必要があるかも知れません。
簡単なのはリレーション集計です。 別テーブルからの場合、元テーブルの日付から年月を取り出します。例201204とか。 別テーブルに部署とこの年月フィールドを作り、元テーブルとリレーション。 別テーブルにSum(元テーブル::時間)の計算フィールドを作って、部署と年月を入力 すると出ます。もちろん別でブルでは無く元テーブルの自己リレーションでも可能。
>画像通りコードで格納されています。 普通は、コードで格納します。 （「焼肉定食」と「焼き肉定食」、同じものを違う名称で登録されたらデータを使うときに 　大変ですから。 　・・・「カルビ焼肉定食」と「ロース焼肉定食」を分ける必要あるのだろうか？とかもあるので、 　通常マスタに「焼肉定食」だけ登録して他は指定できないようにしておきます。 　また、「焼肉定食」の名称を変えたいとき全データを修正する必要がないようにコードで 　格納します。 　例えば、「焼肉定食（生野菜付）」を新たに作りたいので今までの「焼肉定食」を 　「焼肉定食（サラダなし）」に変えようと思うと、コードで格納しているなら、 　マスタを１個変えたらしまいですが、全部文字で持っていると変更が不可能に近い。） まあ、コードの作り方は良くなさそうですね。 昼食におにぎりはでないのだろうか？・・・ そもそも、何を管理したいのか？ ということによってテーブルの持ち方は変わってきます。 それが明示されていないのでテーブルの内容について論議しても意味無いのですが、 私なら例えば以下のような持ち方をして、 食事管理マスタの登録画面と食事コードマスタのメンテナンス画面を用意します。 朝昼夕夜区分はマスタにしますがメンテナンスはＳＥがするということで。 ## ぱっと見るともっとややこしいと思うでしょうね。 食事管理マスタ (普通日付が入ると思うのだが、一応、ないとしておきます。) 名前,朝昼夕夜区分,食事コード,備考 山田,1,11, 山田,2,16, 山田,3,00,唐揚定食 山田,4,17, 佐藤,1,13, 佐藤,2,15, 佐藤,3,14, 佐藤,4,17, ・・・ 食事コード,食事名 00,その他 11,パン 12,蒟蒻畑 13,おにぎり 14,カレー 15,焼肉定食 16,パスタ 17,ソーセージ 18,ヨーグルト 99,（なし） 朝昼夕夜区分,区分名 1.朝 2.昼 3.夕 4.夜 >しょうもないことでSEの人に結合してもらわないと誰も分かりません。 大抵のデータベースにはビューというものがあって、 SQL文というもので、食事管理マスタの食事コードと食事コードマスタの食事名を結合して、 食事管理マスタビューを表示したら、食事コードも食事名もいっしょにでてくるようなものを作れます。 ・・・利用者がいろいろと加工したい場合はこれを用意するのが一般的とは思います。 （ただし、利用者が直接テーブルやビューからデータを取得できる能力・環境がある場合。） ということで、質問の答えとしては、 >こんなデータの持ち方をしますか? ちょっと違うけど、同様。質問者の方には、似たような持ち方にしか見えないでしょう。 >もっと効率的な方法はありませんか? ビューという便利なものが大抵のデータベースにはあるので （データベースに何を使っておられるのか書かれていませんので 　別の呼び方になっているかもしれませんが同等の機能はあるはずです） それを利用すれば使う側は効率的になるはずです。 ##### ビューの機能がないデータベースはほとんど生き残っていないはずだけど、 ビューの機能がないデータベースならごめんなさい。 #####
（主として企業内の)情報共有のためのウェブサイトを構築するためのソフトです。 (クライアントにも有料のライセンスが要るのでインターネットに公開されているウェブサイトでSharePointを使った物は無いでしょう) ドキュメントを登録したり検索したりする機能があるので、「ドキュメントファイルのデータベース」と思うことも出来ます。 Wikiや掲示板の機能もあります。
Accessのバージョンはいくつでしょう？ それによって回答も少し変わるのですけど。 まずはこちらをご覧になって分からなければ ご返答ください。当方2010と2002を所有 複数列のレポートを作成する方法 http://www.nurs.or.jp/~ppoy/access/access/acR008.html 後半部分は『課』をグループヘッダーにして 改ページを『カレントセクションの前』に指定すれば出来そうですが もっと正確なイメージが欲しいところです。 （こちらに関しては解決までの自信はありません）
MySQLを用いて動的に生成されたWebページがSEO的に有効に作ってあるか不利に作ってあるかというだけで，MySQLを使うこと自体はSEOには無関係です。 話は変わってAmazonの場合，ある一冊の本が掲載されたページのURLとして必要な情報は， http://www.amazon.co.jp/dp/477414195X/ なのですけれど，本のタイトルや著者名をURLに組み込んで， http://www.amazon.co.jp/「最速」SEO-~たった28日で上位表示する驚速ビジネスサイト構築術~-デジタル仕事術-芳川-充/dp/477414195X/ という形式で公開しています。Amazonの目に見えて分かるSEOの代表例です。
CSVファイルの段階で36MBもあると、Excelでは辛いかもしれません。 CSVファイルの先頭行の有無にもよりますが、ExcelでADOで開けば何とかなるかも？ ADODBでCSVファイル読み込み＠Excel マクロ・VBA http://www.cocoaliz.com/excelVBA/index/35/
＃２です 訂正です。 ＃２では、＃１の補足を元に、サブクエリ部分を関数に置き換えましたが、 質問を読み直してみると、A, B 逆ですね。 書き方一緒で、内容を逆にしてみて、どうなりますか。
＞SELECTに書く列名は、GROUP BYで指定された列名でなければならない 　または、集計関数でなければならない。が必要ですね。 　とまぁ、これはおいておいて・・・ 　group byで指定された列以外の列名がselect句に書かれたらどうなるかを考えてみましょう。 　例えば、Y.勤務時間がselect句に書かれていたら・・・ 　当然、ある従業員のレコードを集めてきたら、勤務時間はいろいろな数字があるでしょう。どれを選べばいいのかは解りませんよね。 　ですから、最初の規則があります。 　 　この規則に従えば、示された解答は間違いです。 　さて、ここからは、現実のシステムの実装の問題です。 　規則に反したＳＱＬ文が入力された時に、エラーメッセージを出して処理を中断しなければならないという規則はありません。 　つまり、ルール違反のＳＱＬに対しては、システムは何をやってもＯＫです。 　エラーメッセージを出すのもよし。でたらめな答えを出しても、それはそれでＯＫなんです。 　このgroup byにおけるルール違反に対する一番簡単な実装は何か？group byで集計対象になったものの中から適当な任意のレコードの値をそのまま出してしまうことです（適当な任意のレコードの正体は多分、一番最初に扱ったレコードか一番最後に扱ったレコードです。）。 　そして、この安直な実装をしているシステムは多いです。 　さて、この安直な実装をしているシステムに、解答のＳＱＬ文を入れてみましょう。 　ここで、問題文に書かれていない仮定をもうけます。従業員コードと、賃金テーブルの従業員区分はprimary key指定がされているものとします。（普通、この様なテーブルは・・・多分そうです。） 　従業員コードはgroup by句に指定されていますから一意に決まります。 　仮定から、従業員コードが一意に規定されると従業員区分も一意に定まります。よって、時間単価も一意に定まります。 　さて、ここで時間単価が一意に定まったので、集計対象のどのレコードから時間単価を取ってこられても「害はありません。」同じ答えが出てきます。 　このやり口をX.従業員氏名に適用すると、やはり同じ結論が出ます。 　よって、group by句に指定すべき列名は、X.従業員コードのみとなります。 　この安直な実装したシステムのselect文の文法を見ると、ちゃんとこれがマニュアルに明示してあるシステムもあります。 　例えば、ＭＹＳＱＬのマニュアルだと、 --------------------------------------------------------------------------- MySQL は GROUP BY の使用を拡張し、GROUP BY 句には現れない SELECT リストでの、超集約カラムまたは計算の使用を可能にします。この機能を利用して、不要なカラムのソートやグループ分けを避けることで、性能を改善することができます。 （中略） GROUP BY 部から省略したカラムがグループ内で一定していない場合は、この機能を 使用しないで ください。サーバはいかなる値もグループから自由に戻すことができ、すべての値が同じでない限り、結果は不確定です。 ---------------------------------------------------------------------------- 　とちゃんとこのことが明示されています。 　規格に準じるか、多数派に準じるか・・・いずれにせよ、中途半端な解答ですね。 　あるシステムでは、明確に間違い（エラーメッセージではねられる）ですし、あるシステムでは正解だけれども効率が悪い。（group byに指定する列名が多くなれば、計算量が増えます。） 　解答に対して抗議したい気分です。
http://www.tsware.jp/tips/tips_082.htm http://www.moug.net/tech/acvba/0040019.html http://www.accessclub.jp/ado/adox/index.html 書き換えるか　削除して再作成など
作業セルを使いますが、こんな方法はどうでしょう。 「亜（JIS:0x3021）」～「碗(JIS:0x4F53)」までをランダムに表示します。 セルA1を作業セルとして使うとし、↓を入れます。 =RANDBETWEEN(0,2964) 漢字を表示させたいセルには↓と、入れます。 =CHAR(12321+INT(A1/94)*256+MOD(A1,94))
