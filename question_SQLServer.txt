SQLSERVERのSQLで以下の【期待する結果】を取得する方法はありますか？ SELECT NAME,COUNT FROM CLASSROOM 【結果】 AAA,2 BBB,1 CCC,3 【期待する結果】 AAA AAA BBB CCC CCC CCC よろしくお願いします。
いつもお世話になります。 ツールを作ることになり四苦八苦しているのですが、 各支店での商品毎の最新情報を表示する一覧表を作成したいと考えております。 商品マスタから外部結合にて作成しているのですが、表示項目に日付のみを表示 するのは日付の最大値ので表示できるのですが、項目が増えると表示できずに 困っております。 ２つのテーブルの結合では下記のやり方でできたのですが、３つ以上の結合では どのようにすれば良いのでしょうか？ http://okwave.jp/qa/q3297506.html 環境はC#及び データベースはAccess MDBです。 よろしくお願いいたします。 商品マスター 商品品番商品名 A 商品A B 商品B C 商品C 支店Aテーブル 日付 商品品番 売上 2016/5/1 A 100 2016/5/2 B 120 2016/5/3 C 140 支店Bテーブル 日付 商品品番 売上 2016/6/1 A 100 2016/6/2 A 120 2016/6/3 C 120 支店Cテーブル 日付 商品品番 売上 2016/7/1 B 100 2016/7/2 B 120 2016/7/3 C 100 実現したい表示 商品品番 商品名 支店A販売日 支店A売上 支店B販売日 支店B売上 支店C販売日 支店C売上 A 商品A 2016/5/1 100 2016/6/2 120 null null B 商品B 2016/5/2 120 null null 2016/7/2 120 C 商品C 2016/5/3 140 2016/6/3 120 2016/7/3 100
下のようなSQLで重複したレコードを削除することができることがわかりました。 テーブル名：TEST DELETE * FROM TEST AS T1 WHERE ID <> (Select Min(ID) From TEST As T2 WHERE T2.受付日 = T1.受付日 And T2.シリアルNO = T1.シリアルNO); しかしIDのように一意のフィールドがないテーブルで重複を消し一意にする方法はありますか。 Distinctを応用するとできるのですが、削除クエリで一発する方法はありませんか。 お願いします。
SQL Server2014 Expressのダウンロードを考えています。 32ビット版なんですが、公式の どれをダウンロードすればいいのでしょう？
顧客テーブルと連絡テーブルを"番号"、"名前"、"地域"、"性別"で比較し、 顧客テーブルに存在しないデータを、連絡テーブルから削除するSQL文の 書き方を教えてください。 　 ＜顧客テーブル＞ 番号、名前、地域、性別、登録日 ０１、足立、東京、男性、2016/04/24 ０２、加藤、大分、女性、2012/03/01 ０４、田中、香川、女性、2003/07/21 　 ＜連絡テーブル＞ 番号、名前、地域、性別、生年月日 ０１、足立、東京、男性、1998/05/21 ０１、足立、群馬、男性、1974/03/06　存在しない ０１、足立、東京、女性、1961/12/30　存在しない ０２、加藤、大阪、女性、1965/06/01　存在しない ０２、加藤、大分、女性、1981/02/03 ０３、佐田、香川、男性、1972/10/24　存在しない 　 --- 実行結果 ------------------------------------ 　 ＜連絡テーブル＞ 番号、名前、地域、性別、生年月日 ０１、足立、東京、男性、1998/05/21 ０２、加藤、大分、女性、1981/02/03 　
sql server express2012 のselect文で select * from 商品マスタ where 商品コード in (1,2,3,1)とした場合、商品マスタには商品コード＝１のデータは１件しかないけど、商品コード＝１のデータ（同一データ）を２行表示する方法はありませんか？ 宜しくお願いします
Aceess2010+sql server2012 expressでタイムカード（打刻）を２０か所の営業所で利用しています。朝、夕方の打刻が重なる時にロック（クエリーでタイムアウト）が時々発生します。 ※画面から社員コードを入力して出勤などのボタンを押そうとするときに、社員マスタを読み込むときにクエリーでタイムアウトが発生します (1)社員１が退勤などを押して、社員マスタに更新する Set cn = CurrentProject.Connection cn.BeginTrans sql = "UPDATE TM_社員マスタ" sql = sql + " SET" sql = sql + " 打刻ボタン=9" sql = sql + " WHERE 社員コード='" & Me.社員コード & "'" cn.Execute sql cn.CommitTrans cn.Close Set cn = Nothing (2)社員２が退勤を押す前に自分の社員コードを入力（ここでクエリータイムアウトになる） sql = "SELECT * FROM TM_社員マスタ" sql = sql + " WHERE 社員コード='" & Me.社員コード & "'" rs.Open sql, cn If Not (rs.EOF And rs.BOF) Then Me.社員名 = rs!社員名 Me.雇用区分 = rs!雇用区分 (1)(2)の社員は別な社員で社員コードは違います ロックを発生させないための修正としては、(1)のトランザクショをやめて、(2)のSELECTでNOLOCKをつけて参照すれば良いのでしょうか？ ちなみに、(1)でトランザクションをはずしてもUPDATE中は社員マスタ全体にロックがかかるのですか？それともWHEREで指定した社員コードのレコードだけロックがかかるですか？ あまり、SQL　SERVERが詳しくないのですが、宜しくお願いします
SQLServer2012でのビューを使用したデータ変更(追加・変更・削除)は どこまで可能でしょうか？ １．ビューのデータ変更を行う場合複数テーブルのデータを 　　変更することは可能でしょうか？ ２．上記の変更の際の条件や制限事項はありますでしょうか？ ３．上記を回避する方法などありましたらご教授ください。 未熟者で的を得ていない質問となっているかと思いますが、 ご教授いただければ幸甚です。
あるシステムのデータベース設計をしております。 あまり知識、経験が無い為ご知恵をお借り出来たらと思います。 システムの概要としては、 「600件程度のデータを1時間毎にデータベースに取り込む。これを24時間365日続ける。さらに20箇所分同時に処理を行う。」 というものなります。 ざっと試算すると、1年だと ((600件 * 24時間) * 365日) * 20箇所 = 105,120,000件のデータを持つことになります。 これを10年間で考えると、105,120,0000件となります。 今のところ、シンプルに600件をそのまま取り込もうとしておりますが、 データ量が膨大になってしまう為、ディスク容量やインデックス等貼ったとしてもパフォーマンスが落ちないか等不安になってしまいます。 MSDNの情報でデータベースの容量を見積もったのですが、105,120,0000件だと１TB程必要となるようでした。 SQLSeverでこの位の件数、容量は一般的なのでしょうか？ もしくは600件をそのままでは無く、1データとして取込み、 データを表示する際にプログラムで分割して処理する等の形にするのが良いのでしょうか？ ちなみにWindows 2008 R2サーバーでSQLServer 2008 R2 Webエディションの環境となります。 宜しくお願いします。
【環境】 SQL Server 2008 R2 Express Edition (x64) データベースの勉強をしています。 データベースの場合、データベースを管理しているのはOSではなく、DBMSのため、ユーザーデータベースを戻しただけでは、戻らないとに認識しています。 EXCELのファイルのバックアップ／リストアは、単にEXCELファイルをバックアップしてリストアすればいいのは分かりますが、データベースの場合のバックアップ／リストアについての仕組みについてよく理解できていません。 理解する上で、いろんなパターンのバックアップ／リストアを試そうと思っており、以下の件につきましてご教示を頂けますようお願い致します。 (1)　障害が発生した場合を想定してのデータベースのバックアップですが、ユーザーデータベースだけではなく、masterデータベースのバックアップも必要という認識であっておりますでしょうか。 masterデータベースにはユーザーデータベースの場所、ユーザー情報、ユーザーのロール情報が含まれているため、バックアップしたユーザーデータベースだけリストアしても復旧できないということでよいでしょうか。 masterデータベースが損傷していなければ、バックアップしたユーザーデータベースだけリストアすれば、復旧できる。 (2)　ユーザーデータベースが10個あり、そのうち特定なユーザーデータベース1個のバックアップおよびリストアテストをする手順については、下記でよろしいでしょうか。 テスト後は、次のテストパターンを学習するため、元の状態に戻したいと考えています。 <手順> 1.システムデータベース、必要なユーザーデータベース1個をのバックアップを行う。 2.ユーザーデータベース10個をデタッチする。 3.システムデータベースをデタッチする。 4.デタッチしたシステムおよびユーザーデータベースを別の場所に退避する。 5.システムデータベース、特定のユーザーデータベース1個をリストアする。 6.リストアしたユーザーデータベースが問題ないことを確認する。 7.リストアしたユーザーデータベース1個をデタッチする。 8.リストアしたシステムデータベースをデタッチする。 9.退避したシステムデータベース、ユーザーデータベースを元の場所に戻す。 10.システムデータベースをアタッチする。 11.ユーザーデータベース10個をアタッチする。
この方面に詳しくないので用語などに間違いがあるかもしれません SQL Server2008 RC2 を使っています データベースに複数のデータ列が存在してデータ件数（レコード数）は不定です プログラムは VC2010にて自作　　ODBC経由でアクセス データベースの構造はある程度自分で加工可能 データベースへの件数の削除・追加・更新は自作プrグラム以外からも行われる 自作プログラム以外には以外には極力影響与えたくない 上記データベースの件数の変化については現状 SELECT COUNT (*) FROM [データベース名]　　のポーリングで件数の増減の検出 新規追加の判断に関してはデータ列の中に　データ登録日を保存することで それをソートして処理していますが 何処かのデータの一部が更新されたというのを検出することは可能なのでしょうか？ 　　※ 判断したいのはデータの追加と更新だけで削除されたデータが 　　　 どういったものであったかを判断する必要はありません 更新データも全データを都度ポーリングチェックすれば判断はできるでしょうが データ件数によってレスポンス的に使えない代物になると考えています データベースの設定やプログラム的なもので対処できるものなのか 無理なのか（個人的に無理だと考えてる） 可能であればどういった方法で実現できるのか わかる方がいたら教えていただけないでしょうか （無理なら無理で構わない　　－＞　　詳しい方の判断を求めたい） 内容に不足があれば補足させていただきます
現在、20名ほどの町工場で、10台ほどのPCと、Server（Windows Server 2008 R2 Standard） をワークグループで接続しています。 Serverは、ファイルサーバとして利用しています。 SQL Server 2005 Express を、私個人のPC(Windows7 Professional)で運用していますが、これをServerへ移設しようとしました。 Server に SQL Server(SQL Server 2008 Express)をインストールし、データベースファイルをコピーし、アッタチして、Server上にデータベースが存在しています。 Server側の Managiment Studio から私個人のPCの SQL Server へは接続できますが、私のPCからServerのSQL Serverへは接続できません。 SQL Server の認証は、SQL Server Authentication を使用してきました。 これを Windows Autehntication に変更するべきでしょうか？ それとも、他に簡単な方法がありますか？ Windows Authentication の場合、Server 側に、Domain を設定して、User を登録するという流れで良いのでしょうか？ 尚、海外の現地企業のため、Windowsは、全て英語版を使用しています。 以上、宜しくお願い致します。
Windows8.1 Pro上のSQL SERVER 2012 Expressに接続しようと思っています。 Windows8.1のファイアーウォールをOFFにするとクライアント側から接続できます。 ONにすると「アプリにWindowsファイアーウォール経由の通信を許可する」のところで C:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS1\MSSQL\Binn\sqlsvr.exeを登録してもだめ。 「ローカルコンピュータのセキュリティーが強化されたWindowsファイアーウォール」の「受信の規則」のところで 1433を登録してもだめ。 という状態なのですが、ほかに何か設定が抜けていますでしょうか？ OFFにするとつながるということなので、SQL SERVER自体の設定は合っていると思うのですが。 よろしくお願いいたします。
いまだ、Accessプロジェクトを利用しているものです。 SqlServerにユーザー定義関数(スカラ値関数)があり、Access(adp)からそのユーザー定義関数に、フォーム上のコントロール値をパラメータとして渡し、その戻り値をAccessで受け取りたいのですが、そのやり方で躓いています。 　　例　SqlServerのユーザー定義関数 　　　　　Alter Function dbo.Total (@Para1 int,@Para2 int) Returns int As Begin Declare @Total int End BEGIN @Total = Para1 + Para2 Teturn(@Total) End 　　　　　とし、 　　　　　AccessのForm1のテキストボックス1、2をパラメータとして、テキストボックス3 　　　　　に、SqlServerのユーザー定義関数の戻り値「@Total」を表示させたいと望んでいる　　　　　のですが。 　　　　　お知恵を借りたく、質問させていただきました。
3年毎の契約期間のデータがあり、 現在日と比較して、契約終了の1ヵ月前なら、 契約データを一覧表示したとして、警告を出そうかと思ってます。 契約日 2009年10月1日の場合は、 2012年9月（3年後の1ヵ月前 2015年9月（6年後の1ヵ月前 2018年9月（9年後の1ヵ月前 ・・・というような具合のタイミングで、 例えば現在日が2015年9月15日の場合は 上記に該当するので項目として、わかるように表示・抽出したいです。 select 契約番号 契約日 契約終了1ヵ月前の区分項目 from 契約データ 契約終了1ヵ月前の区分項目のSQLの書き方がわからず困っております。 どうかご教示お願い致します。
訪問管理・問合せ履歴管理のシステムを作成しています。 システム設計段階ですが、 以下の様な分類を履歴データに組み込みたいと思ってます。 ユーザーに自由に追加させるようなマスタを作成する場合 どういった風に各マスタを作成すれば良いでしょうか？ 作成したマスタを履歴データに項目追加する場合も含めて 教えていただけると助かります。 宜しくお願い致します。 ------------------------- 部門 営業・広報など 担当 電話・訪問 業務 業務1、業務2 内容 問合せ・トラブル・TODOなど ------------------------- データ 営業・電話・業務1・問合せ 営業・電話・業務2・問合せ 営業・訪問・業務1・問合せ 営業・訪問・業務1・トラブル 広報・訪問・業務1・トラブル 広報・電話・業務1・トラブル 広報・電話・業務1・問合せ 広報・電話・業務2・問合せ
現在SQLを勉強しています。 C♯とSQLServerを使用しているのですが betweenを使って困った点があります。 自分で入力するAとB(どちらも数字)をbetweenの条件にしていしているのですが 例) select フィールド名 from テーブル where フィールド名 between A and B； → テーブルのフィールド名 の中のAからBのデータを選択する は問題ありません。 ですがAとBが未入力だとエラーが当然でてしまいます。 そこで未入力だとフィールド名の中を全件selectするようにしたいのですが、これはbetween で出来るのでしょうか？ おそらくは条件であれこれ指定するのだと思いますが… 回答お願いします
お世話になります。 SQL Server2008 Standard Scriptを実行し手動でAAAテーブルをバックアップしております。 ※バックアップ用テーブルがあり、その全レコードを削除し 　AAAテーブルの内容をコピーしてます。 基本的には問題なくバックアップ出来ているのですが、たまに エラーになるときがあります。 エラーになったときのSQLログに、 　「'DB名' のファイル 'DB名_log' の自動拡張をユーザーが取り消したか、 　xxxミリ秒でタイムアウトしました。ALTER DATABASE を使用して、 　このファイルの FILEGROWTH の値の設定を小さくするか、または 　新しいファイル サイズを明示的に設定してください。」 と出ます。 上記メッセージで調べると、トランザクションログの何たら・・・ とありますが、エラーだったとしても、数分後に実行すると 問題無かったりします。 なので、トランザクションログサイズの拡張？とかは関係が 無いように思えるのですが。。 どのようなことが考えられますでしょうか。 ご教示の程、宜しくお願い致します。
C言語やVBをC#に変換するツール等はよく見かけますが、SqlServerのsqlをOracle等に変換するツールはありませんか？精度が低くでもよいので、お願いします。
お世話になっております。 httpで、インターネット経由にて SQL Serverのテーブルから条件に合致したデータをCSVへ出力しダウンロードする 仕組みを作りたいと考えております。 例 ■テーブルA KeyA　項目1 項目2 001 100 200 002 200 250 003 300 350 select * from KeyA =para paraはパラメタとして渡し、結果をpara.CSVのようにCSVファイルへ出力したいのです。 sqlcmdを使えば、できそうな感じだったのですがよくわからなかったのが （１）sqlcmdのSQL文にパラメタを渡すことができるのか、できるのならどうやるのか （２）出力ファイル名もパラメタ化したいのだができるのか、できるのならどうやるのか （３）ネット経由でsqlcmdを実行することができるのか、できるのならどうやるのか （環境） SQLServer2008R2 IIS ご教授頂けましたら大変ありがたいです。 よろしくお願いいたします。
OS：Wondpws Server 2012 Standard SQL：SQL Server 2008 R2 Standard Edition インスタンスは任意で作成していて、正常に動作しているのですが、 SQL Server 構成マネージャーでSQL Serverのサービスを確認すると リモート プロシージャ コールに失敗しました〔0x800706be〕と表示されます。 通常ですと、Sql Server（インスタンス名）Sql Server Agent（インスタンス名）Sql Server Browserが 表示されるんですが。
このようなことが実現できるのかというご相談です。 ご存知の方がいらっしゃいましたらご教授ください。 環境はSQL Server2008です。 ２つのテーブルがあります。 １度のSQLでその２つを比較し、以下の条件のデータを抽出することは可能なものでしょうか？ （１）テーブルAに存在するが、テーブルBにはない （２）テーブルBに存在するが、テーブルAにはない （３）テーブルAとBの両方に存在するが、項目のいずれかが異なる。 なお、テーブルBには、テーブルAには存在しない項目がありますが、 その項目は比較対象外です。 お知恵を拝借できましたら、とてもありがたいです。 よろしくお願いいたします。 ■テーブルA Key Komoku1 Komoku2 001 1000 2000 002 2000 3000 005 3000 4000 006 4000 5000 ■テーブルB Key Komoku1 Komoku2 Komoku3 001 1000 2000 X1 003 2000 3000 X2 005 3000 5000 X3 006 4000 5000 X4 ■結果 Key Komoku1 Komoku2 002 2000 3000 003 2000 3000 005 3000 4000 (あるいは 005 3000 5000) ※005はテーブルA,B両方には存在するが、koumoku2の値が違う例です。 その場合、どちらのテーブルの値を出力しても構いませんし、あるいは両方を 出力しても構いません。 よろしくお願いいたします。
MySQLを使っています。 商品テーブルの中で、 同じ商品のレコードが複数あります。 その多数のレコード中に、日付項目があります。 そこから、 １）商品IDで重複せずに、２）指定日に、３）一番近い過去の日、４）指定日を含めて、複数ある未来の全レコード、を抽出するには、 どのようなSQL文を書けばよいでしょうか？ 商品でユニークになるように、 １．過去に複数ある日付の中から、指定日に、一番近いレコード。 ２．未来に複数ある日付の中の、全ての未来の、レコード。 ３．同一商品レコードは、複数抽出されない。
現在、サーバーマシンのリプレイスを行おうとしています。 Microsoft SQL Server 2005 のDBファイル（ mdf ファイル）が67GBもあり、そのままコピーしようとすると非常に時間がかかります。 圧縮してコピーしたいと思いましたが、67GBの巨大なファイルは圧縮できないのでしょうか？
下記は、何を使用としているのかを、解析したいと思っています。 Source / destination /protocol /length /info A / B / TCP / 54 / 10085-80 (ACK) Seq=572 Ack=2032 win=65700 Len=0 B / A / TCP / 54 / 80-10085 (FIN, ACK) Seq=2032 Ack=572 win=6992 Len=0 A / B / TCP / 54 / 10085-80 (ACK) Seq=572 Ack=2033 win=65700 Len=0 A / B / TCP / 54 / 10085-80 (FIN, ACK) Seq=572 Ack=2033 win=65700 Len=0 B / A / TCP / 54 / 80-10085 (ACK) Seq=2033 Ack=573 win=6992 Len=0 素人に説明出来る方、宜しくお願い致します。
お世話になります。 Windows Server2012 Standard SQL Server2008 R2 Standard 当該サーバー機のスペックは CPU：Intel Xeon E5-2403 1.80GHz メモリ：8GB です。 タスクマネージャーで使用メモリを確認したところ、常にSQL Server だけで3.8GB程使われており、トータルでは5.3GBとなっておりました。 ※67～8％が常に使われている状況。 SQL2008のシステム要件を見てみると、最小で1GB以上、推奨は 4GB以上となっております。 ＜質問＞ SQLで使用されるメモリサイズは、積んでるメモリサイズによって 変わるのでしょうか。 例えば、元々4GBしか積んでなければ、SQLでは2GBぐらい使われるとか。 今回、サーバーにてパフォーマンス監視をすることとなり、社内規定で メモリは「1時間の平均で60％を超えたら警告」となっております。 ですが、現状は常に67～8％なので既に超えている状況です。 調べたところ以下のような情報がありました。 https://support.microsoft.com/en-us/kb/321363/ja?wa=wsignin1.0 オプションで使用メモリの上限値を設定できるようなので、ここで設定する ことにより、60％未満に抑えられそうなのですが、できればメモリは制限せずに 使えるだけ使いたいところです。 ご教示の程、宜しくお願い致します。
select * from A select ef from B where ef = '3' かつ、A.ab = B.ab and A.cd = B.cd 至急質問させてください。 上記SQLを結合したいです。 取得したいデータはAのテーブルの全項目で、 取得条件として、Aのテーブルのキー項目 = Bのテーブルのキー項目に、Bのテーブルの項目ef = '3' だったらという条件を加えたいです。 どのようなSQLがスマートでしょうか。。 無知で申し訳ございませんが、ご教授いただけますと幸いです。 よろしくお願いいたします。 ※キー項目の値は条件に指定できない(持っていない)ことがわかりました。 先ほどの質問にご回答下さった皆様、申し訳ございません。
パソコンの知識はあまりありません。 エクセルデータマイニングアドインを使ってみたいと思い、手順を見ていると、 アドインと同時にSQL Serverをダウンロードし、 Analysis Serverというものに接続しなければならないようです。 初めにSQL server 2014 Expressで試したところ、Analysis Server へ 接続することができませんでした。 そこで評価版をダウンロードしようと考えているのですが、 https://technet.microsoft.com/ja-jp/evalcenter/dn205290.aspx 評価版は１８０日間しか使用できないのでしょうか？ 今のところデータマイニングアドインのみでの使用を考えていますが、 もしそうであれば、その後の料金なども知りたいです。 バージョンが３つあるようですが、どれをダウンロードしたら良いのでしょうか？ ・SQL Server 2014 on microsoft azure ・SQL Server 2014 ISO ・SQL Server 2014 CAB 自分のパソコンは、office2013 Windows8 32bitです。
アクセスプロジェクト、SQL Server、ネットワークデータベース等 質問したい内容についてまったくの初心者ですので、 質問文が漠然としておりおかしな点が多々あるかと思いますが何卒ご容赦下さい。 社内システムでアクセスプロジェクトを利用しています。 OSはWindows7でAccess2003を使用しており、SQL Serverにつないでいます。 フォームでデータを入力したりレポートで結果を印刷したりという用途です。 将来的にPCやオフィスの入れ替えに伴いアクセスプロジェクトが使えなくなるので 「ODBCで置き換えたら良い」ということでシステムを作らなければならないのですが知識が全く無く、 それがどういうことなのか、何から手をつけたらよいか具体的なイメージがわきません。 当方の状況は以下のとおりです。 ・通常のAccessなら大体使用できます。 ・初歩的なSQL文を書くこともあります。 ・Visual Studio Express 2012 for Windows Desktopの使い方の勉強を始めたばかりです。言語はVBです。 （↑今回のシステム作成とは全く関係なく始めたので、生かせるものなのかどうかも分かりません） そこで質問なのですが ・ODBCに置き換えるというのはどういうことなのでしょうか。 アクセスプロジェクトで使っているフォームに似たような入力フォームを何かしらで作成しコーディングしてシステムを作る、ということでしょうか。 アクセスプロジェクトで行っている入力処理、出力処理を完全に置き換えることができるのでしょうか。 ・どういった環境が必要なのでしょうか。 ・参考書、参考URL、セミナー・研修等、何を勉強するべきかのご案内でも構いません。 皆様のお力をいただきたく、何卒宜しくお願いします。
住所テーブルの住所項目に 東京都東京市東京1 とあって、 例えば、 東京都東京市東京1-1-1 で検索した時に、東京都東京市東京1をselectする方法はないものでしょうか。 select 住所 from 住所テーブル where 住所 like '%東京都東京市東京1-1-1%' だと検索できないようでして。何か方法はございませんでしょうか？ どうかご教示お願い致します。
位置参照情報ダウンロードサービス http://nlftp.mlit.go.jp/isj/ ダウンロードしたデータを利用して、SQLServerで地図データ（緯度経度）を検索しようと思ってます。 中身は、 都道府県コード,都道府県名,市区町村コード,市区町村名,大字町丁目コード,大字町丁目名,緯度,経度,原典資料コード,大字・字・丁目区分コードとなってます。 以下のURLを参考にして、 http://linyi-zatta.blogspot.jp/2014/02/sqlserver.html geometry型のデータを作成しようとしているのですが、作成できません。 手順は ダウンロードしたCSVファイルを取込テーブルへbulk insert 緯度と経度2つにわかれているfloat型のデータをgeometry型に変換し、別テーブルへ移行 43.041403（カラム名:緯度） 141.31998（カラム名:経度） といった具合に分かれてます。 こちらをgeometry型に変換、取込テーブルからselectしたものを 別のテーブルに移行したいのですが、geometry型でselectできません。 select geography::STGeomFromText('POINT(緯度 経度)',4326)) from 取込テーブル というイメージでできるかなと思ってたのですが、上手く行かず。 直接、値を書くやり方は以下で問題ないのですが。 geography::STGeomFromText('POINT(134.993299 34.647755)',4326)) どう、SQL文を作成すればよいのか、ご教示どうかお願いします。
データストアに保存したデータの中から、dateと言う項目を参考に最新一件を取り出すには String query = "select from" + Place.class.getName() + "order by date desc range 0,1" ; という文法で取得できることは調べたのですが、 最古一件を取り出すにはどの様な記述に変えればいいのでしょうか？
在庫管理を行う上で、３つのテーブルを結合したいと考えておりますが、うまく結合できません。 【テーブル抜粋】 ・販売 　販売日 　部門CD 　店舗CD 　商品CD 　販売数 ・仕入 　仕入日 　部門CD 　店舗CD 　商品CD 　仕入数 ・棚卸 　棚卸日 　部門CD 　店舗CD 　商品CD 　実在庫 各テーブルから、日付で絞りこんで抽出は出来ていますが、上記を結合させる方法がわかりません。 ※各テーブルの商品数がバラバラです。 例えば、棚卸にはあるが、仕入も販売もない商品。 販売にはあるが、在庫も仕入もない商品Ｎ。 試した方法、在庫を基本に販売をLEFT OUTER JOINで結合し、仕入をLEFT OUTER JOINで結合しGROUP　BYで集計 SELECT 部門CD,店舗CD,商品CD,ISNULL(実在庫,0) AS Z,ISNULL(販売数,0) AS Ｂ,ISNULL(仕入数,0) AS S FROM( SELECT 部門CD,店舗CD,商品CD,SUM(実在庫) FROM 棚卸 WHERE 棚卸日 BETWEEN (開始日) AND (終了日) ORDER BY 部門CD,店舗CD,商品CD )AS ZAI LEFT OUTER JOIN（ SELECT 部門CD,店舗CD,商品CD,SUM(販売数) FROM 販売 WHERE 販売日 BETWEEN (開始日) AND (終了日) ORDER BY 部門CD,店舗CD,商品CD ) AS BAI ON ZAI.商品CD=BAI.商品CD LEFT OUTER JOIN（ SELECT 部門CD,店舗CD,商品CD,SUM(仕入) FROM 仕入 WHERE 仕入日 BETWEEN (開始日) AND (終了日) ORDER BY 部門CD,店舗CD,商品CD ) AS SII ON ZAI.商品CD=SII.商品CD 上記の結果、結合はしたのですが、店舗間の商品数がバラバラとなりました。 例えば、aという店舗の販売数に、b販売数がはいっていたらり？ ※結合する前の、クエリは正常に抽出しておりますので、結合方法が悪いと考えております。 もしかすると、テーブルの項目をそろえて、UNION ALLでつなげばと思ったのですが、コーディング方法がわからす・・・ 結合方法をアドバイス頂けたら幸いです。
締め日が21～翌20日なのですが、ある実績表を月度毎で集計したい場合みなさんならどういうクエリにしますか？ できたらクロス集計で、横軸が○/21～翌/20でならぶようにしたいです。 1～月末なら、月毎に集計させればいいのですが。 よいお知恵をおかしください。 Excelでもいいです。
本番環境のSQL SERVERのデータを開発環境のSQL SERVERへ SQL SERVER ManagementStudioのインポート・エクスポートウィザードを使い移動させているのですが、自動化出来ないかと考えております。 【本番環境】 WindowsServer2008R2(32bit) SQL SERVER 2008R2 【開発環境】 WindowsServer2008R2(64Bit) SQL SERVER 2008R2 EX ◎現在の作業手順 １．開発環境上のテーブルを一括削除 ２．開発環境側のSQL MAGAGEMENT STUDIOのインポートおよびエクスポートウィザードにて、本番環境のテーブルを一括インポート 問題は、テーブルが５０以上あり、内１００万行以上のテーブルが複数ありますので、移行中に本番環境の動きが悪くなることです。 そのため、業務終了後にバッチでデータ移行ができればと考えております。 ※なお、本番環境については閲覧権限しかないため、本番環境にストアドを作成するには ベンダーへ依頼する必要があるので、できれば避けたいと考えております。 上記の件について、アドバイスを頂けましたら幸いです。
sqlserver2012のシステム日付（現在の日時）の取得なのですが、 current_timestampかgetdateかで取得しようとしているので すが、両方とも同じ内容となります。 current_timestampとgetdateの違いは何でしょうか。 また、どちらを使うのがよいのでしょうか。 よろしくお願いします。
ユーザ環境の制限により、ミストが多い環境にFANレスPCを設置して、別の場所にNASを設置することになりました。 NASにSQL Server2008R2のインスタンスを作成したいのですが、FANレスPCでインストール時にNASドライブを認識できず困ってます。 NASをネットワークドライブに割り当てても、コンピュータ名「\\NAS\MSSQLSERVER」で指定しても認識できません。 また、いったんSQL Serverをローカルドライブ（C:\）にインストールして、 SQL Server Management StudioでMDFをデダッチして NASドライブ（ネットワークドライブ）にアタッチしようとすると 「特殊なセキュリティ権限・・・」でエラーとなります。 SQL Serverのサービスのログインは 　・Network Service 　・Local System 　・Windowsログインユーザ（Admini権限） で試しましたが症状は変わりませんでした。 NASはバッファロー製の TS-X2.0TL/R5 を使ってます。 なお、USB外付けHDDにはSQL Serverのインスタンスをインストールできることは確認してます。 対策方法の助言いただけると幸いです。
すみません初心者です。 SQLSERVERの圧縮について教えてください 完全、単純とありますが、単純での環境で、ＤＢをバックアップして復元したときに 何か問題はおきますか？ また、データが重くなり、パフォーマンスを上げたいとき、圧縮という考えは有効 でしょうか？ よろしくお願いいたします。
SELECT CASE WHEN 項目1 = 1 THEN '月' END+ CASE WHEN 項目1 = 2 THEN '火' END+ CASE WHEN 項目1 = 3 THEN '水' END AS 曜日 FROM テーブル1 として、文字列を「月火水」と続けたいのですが、NULLが表示され上手く行きません。 解決方法をご教示お願い致します。
はじめまして、SQLを勉強はじめたばかりのものです。 現在２つのテーブル間であいまい検索を行いたいのです。 テーブル１ id　配列 1　ABCDEFG 2　HIJKLMN 3　OPQRSTU 4　VWXYZ12 テーブル2 id 配列 1 CDE 2 BCDEF 3 OPQR 4 HIJKLM 5 DEFG 6 VWXY 上記のような２つのテーブルで、実際は数万行あります。 LIKE演算子でテーブル２の配列情報を順次テーブル１に あてはめる方法がわかりません。 結果としては id 　配列　　　　id　配列 1　ABCDEFG 　 1 CDE 1　ABCDEFG 　 1 BCDEF . . . のようなテーブルが作成されることを期待しています。 SQLクエリだけでは作成は無理でしょうか？ 上級者の皆様ご助言お願いします。
以下のテーブルはAコードでキーになっています。 テーブルA、Bのコード・名称・住所項目は型レングスともに同一形式になります。 テーブルA Aコード 名称 　　　　住所 　1　　　あいうえお　 東京都足立区 　2　　　かきくけこ　 東京都目黒区 テーブルB Bコード 　名称 　　　 住所　　　　　　　　Aコード 100　　　さしすせそ　 東京都荒川区　　　　1 200　　　たちつてと　 東京都板橋区　　　　2 300　　　なにぬねの　 東京都板橋区　　　　2 400　　　はひふへほ　 東京都江戸川区 500　　　まみむめも　 東京都大田区 テーブルBのAコードが入力されていて、テーブルAに存在したらテーブルAから情報を取得し、 なければ、テーブルBを取得するということがしたいです。 上記例としては、SELECTの結果として以下のようにしたいです。 　　1　あいうえお　 東京都足立区 　　2　かきくけこ　 東京都目黒区 　400 はひふへほ　 東京都江戸川区 　500 まみむめも　 東京都大田区 何卒ご教示お願いします。
お世話になります。 Visual Strudio 2012 で VB.Netで開発をしております。(以降VS) 最近、SQL Server 2014 をサーバーにインストールいたしまして、VSの SQL Server オブジェクトエスクプローラーにて SQL Server 2014接続させ(接続までは出来ました)、そこから展開させようとしてもオブジェクトのツリーが表示されず、最新の情報に更新を実行すると、『オブジェクトの現在の状態に問題があるため、操作は有効ではありません。』と表示されてしまいます。VSをコンパイルしてSQL Server 2014とのデータ連携はきちんとされており、正常に動作いたします。ですが、開発の際にテーブルの項目の追加、ストアドプロシジャーなどの作成など、いちいちサーバー側で作成しなくてはならないのが面倒で仕方ありません。ちなみに、サーバーには SQL Server 2005 ,2008もインストールされており、両方とも SQL Server オブジェクトエクスプローラーで表示、展開ができ、テーブルの作成から項目の追加、ストアドプロシジャーなどもきちんと作成が可能です。VS2012 と SQL Server 2014の相性が悪いのでしょうか？SQL Server オブジェクトエクスプローラーで、2005、2008同様にテーブル、ストアドプロシジャーの作成をしたり、項目の追加をしたいのですが、どうすればよいでしょうか？皆目見当がつかないで難儀しております。もしかして、VS 2012 と SQL Server 2014は 2014の方が新しいから VS2012では編集不可などということがあるのでしょうか？(AccessではAccessのヴァージョンより新しいSQL Serverの編集ができません)　お分かりになる方がいらっしゃいましたら、どうかお知恵をお借りできれば幸いでございます。何卒よろしくお願い申し上げます。
商品　　商品番号　　単価　　 あああ　　10　　　　　200 いいい　　10　　　　　201 ううう　 　　20　　　　　202 えええ　　20　　　　　203 おおお　　40　　　　　204 上のような1つのテーブルから単価の一番高いものの、商品と商品番号だけを表示させたい場合はどのようなsql文にすればいいのでしょうか？ よろしくお願いします。
<A> 商品　　商品番号　　単価　　 あああ　　10　　　　　200 いいい　　10　　　　　201 ううう　 　20　　　　　202 えええ　　20　　　　　203 おおお　　40　　　　　204 <B> 商品番号　　会社名　　 数　 10　　　　　　 AA　　　　　　　3 20　　　　　 　BB 　 　 2 30　　　　　 　 CC 　　 1 40 　　　　　　　 DD 　　 3 　　　　　 この２つの表を結合して 商品　　商品番号　　会社名　　単価　　 あああ　　10　　　　　　　AA　　 200 いいい　　10　　　　　　　AA　 　201 ううう　 　20　　　　　　　BB　 　202 えええ　　20　　　　　　　BB　 　203 おおお　 40　　　　　　　DD　 　204 このようにしたいのと <C> 商品　　商品番号　　単価　　グループ aaa 　　 　 1 　　　　 0 　　　　　　　 0 iii 　　　 2 　　　　　　 0 　　　　　　　　 0 uuu　　　　　　3　　　　　 0 　　　　　　 0 あああ　　　10　　　　　　201 　　　 aaa いい　 　20　　　　　　202 　　　 aaa ううう　　　20　　　　　　　203 　　　 iii おおお　　40　　　　　 204 　　 uuu この表を 商品　　商品番号　　単価　　グループ　　あああ あああ　　10　　　　　 　201 　 aaa　　　　　　　1 いい　 　20　　　　　 　202 　 aaa 　　　　 　 1 ううう　　　20　　　　　 　203 　 iii 　　　　 　 2 おおお　　40　　　　　　 204 　 uuu 　　　　　 3 このようにしたいのですが、どういったsql文を書けばいいのか分かりません 表がとても見にくいと思いますが、よろしくお願いします。
Visual Studio Express 2013 for Webでデータベースアプリを作成しています。 例えば、 Person表 IdS_IdC_IdZ 11212 2222 323NULL 444NULL 54444 6555 7111 8167 9777 10666 1115NULL 12455 13455 14678 のようなデータがあり、横軸S_Id、縦軸C_Idの数、の積み上げ棒グラフ（StackedColumn） （S_Id毎にC_Idの数の内訳を示したグラフ。カウント対象はZがNULLでないものだけ） を作成するには、どのようなSQL SELECT文を書けばよいでしょうか。 目的とする要素数は、 SELECT S_Id, C_Id, COUNT(Z) FROM Person GROUP BY S_Id, C_Id; で出るのですが、 積み上げ棒グラフのためには、 SELECT S_Id, C_Id=1の数(ZがNULLでない), C_Id=2の数(ZがNULLでない), C_Id=3の数(ZがNULLでない), ．．． FROM Person GROUP BY S_Id; のような形にする必要があるようで、うまく書けません。 COUNTで、ZがNULLでなくかつC_Id=1のものをカウントする、というようなことができればよいのですが。
分かりやすくするために、テーブル名などは日本語で書きます。 曲名テーブルのアーティストはアーティストテーブルの番号から参照していて、 さらに、アーティストテーブルのアーティストは名前テーブルの番号から参照しています。 この場合に、曲名テーブルのアーティストを検索(例えば：「大塚愛」と検索)したいのですが、 検索してみても、なかなかピンとくる答えがありませんでした。 JOINで結合いいかと思いますが、テーブルから参照、さらにそのテーブルは、また別のテーブルから参照。 この様な場合はどうクエリーを書いたらいいか全くわかりません。 詳しい方宜しくお願いします。 現在、検証出来る環境がありません。 where 曲名 like '%大塚愛%'" 曲名テーブル +---------------+---------------+---------------+ |................[番号]............|................[曲名]............|.......[アーティスト].....| +---------------+---------------+---------------+ アーティストテーブル +---------------+---------------+ |................[番号]............|.......[アーティスト].....| +---------------+---------------+ 名前テーブル +---------------+---------------+---------------+ |................[番号]............|...............[名前]............|................[読み]............| +---------------+---------------+---------------+
テーブルAへINSERTをした場合のIDENTITY列の値を 同じトランザクション内で テーブルBの別のフィールドへINSERTしたいのですが、 どのようにSQLを書けばよいのか、困っています。 どうか、ご教示お願い致します。 INSERT INTOTABLE_A (NAME_A) VALUES ('あいうえお') ↓ INSERT INTOTABLE_A (A_ID,NAME_B) VALUES (取得したA_ID, 'さしす') INSERT INTOTABLE_A (NAME_A) VALUES ('かきくけこ') ↓ INSERT INTOTABLE_A (A_ID,NAME_B) VALUES (取得したA_ID, 'たちつ') INSERT INTOTABLE_A (NAME_A) VALUES ('さしすせそ') ↓ INSERT INTOTABLE_A (A_ID,NAME_B) VALUES (取得したA_ID, 'なにぬ') TABLE_A ID NAME_A 5　　'あいうえお' 6　　'かきくけこ' 7　　'さしすせそ' TABLE_B ID A_ID NAME_B 1　　5　　'さしす' 2　　6　　'たちつ' 3　　7　　'なにぬ'
SELECT * FROM Orders WHERE data >= '25' dataの部分で値が25以上の情報を出してもらいたいのに、出てくるのが25以上もあるし、下回るのも平気で出てくるので、どうやって検索すればわからないです。 dataの部分のTYPEがVARCHARになってるのが問題のような気がするのですが、DOUBLEに変えようと思ってもできませんでした。 何か対策がないでしょうか？ 回答よろしくおねがいします！
現在Accessで組まれているデータベースがあるのですが、複数人で入力をする必要が出てきたため、SQL Serverへ移行したいと思っています。 ただ、まだデータベースの内容が完全にFIXしておらず、項目に変更や追加が発生する可能性があります。 そこで、 ●Accessを管理画面として使い、 ●Access上で内容を変更したら、システム全体もその通り変わる ような仕組みを作りたいのですが、可能でしょうか。 （完全にSQL Serverへ移行するのではなく、AccessとSQL Serverを連携させる？） よき方法がありましたら教えて頂けましたら幸いです。 ちなみにコストはあまり大きくはかけられません・・。 どうぞよろしくお願いします。 （※私はシステムはど素人なので、なるべく簡単に教えて頂けたら嬉しいです。なお、説明がおかしなこともあるかと思いますがご容赦ください。）
SQL文で２つのSELCT文の結果を繋げる方法はありますでしょうか。 Left Join でもと思ったのですが、片側にしかないのも、１レコードとして出力したいです。 テーブルの例と出力の理想は以下です。 また、上記の応用でこれを４テーブル(SELECT文)を繋げて、下記例で言うと、日付と商品コードがキーで、どのテーブルに存在しても、結果を１行で返せるでしょうか。 【テーブル１(SELECT文１)】 Ｆ_仕入 伝票日付　商品コード　仕入金額 2014/07/01　101　　　　　10,000 2014/07/02　102　　　　　15,000 2014/07/05 104 20,000 【テーブル2(SELECT文2)】 Ｆ_売上 伝票日付　商品コード　売上金額 2014/07/01　101　　　　　15,000 2014/07/02　102　　　　　25,000 2014/07/03 103 13,000 上記２つのSELECT結果 伝票日付　 商品コード　仕入金額　売上金額 2014/07/01 101 10,000 15,000 2014/07/02 102 15000 25,000 2014/07/03 103 13,000 2014/07/05 104 20,000 よろしくお願いします。
お世話になります。 SQL Serever 2008 Standard イントラにてブラウザを介してDBへアクセスしております。 日時を登録するときに、yyyy/mm/dd hh:mm形式で登録させたいのですが、テーブルの該当フィールドのデータ型がdatetimeだと秒まで登録されてしまいます。 上記フォーマットでの登録は無理なのでしょうか。 ※テーブルには文字列として登録するのではなく、ちゃんと日時で登録したいところです。 ご教授の程、宜しくお願い致します。
あるテーブルAがあり、そこにINT型の列bと列cがあるとします。 |b|c| |1|2| |1|3| とデータが格納されているとき、ここから[1,2,3]という風に、重複のない結合結果を出すにはどういったSQLを書けば良いでしょうか。 2列だとDISTINCTも使えず、簡単そうなのに自分ではできませんでした。出力後に結合するのでは色々と不都合なことがあったため、この出力が一発で出せれば便利だと思い質問させていただきました。ご回答よろしくお願いいたします。
sqlserver2008,2012を使用しています。 あるフィールドの値が、"999-999"の書式になっているかチェックを行いたいのですが、 SQLで簡単にチェックできますか？ 文字列（nvarchar）エリアで、３桁の数値＋'-'＋３桁の数値　以外のデータを抽出したいと思っております。 どなたかご教授お願いします。
SQLserver 2005 Expressを使用してます。 csvをBULKINSERTでインポートする際にcsvの最終行に終了コードのようなデータが 入っていてインポートに失敗します。 BULKINSERTのWITHオプションのLASTROWの引数に変数を使用して 日々行数の変化するcsvの最終行-1の値をセットしたいのですが構文エラーに なります。どのように記述したらいいのでしょうか？ 試した事は test.csv 1,あ,4200 2,い,5300 ．　←　何かのデータ CREATE PROCEDURE [dbo].[test1] AS bulk insert test_table from 'C:\test.csv' with (firstrow = 1,formatfile = 'C:\Import_Fmt.xml') で実行するとエラー「一括読み込み: データ ファイルで予期しないファイルの終了が検出されました。」になるので、最終行の「．」が原因かと思い。 ALTER PROCEDURE [dbo].[test1] AS bulk insert test_table from 'C:\test.csv' with (firstrow = 1,lastrow = 2,formatfile = 'C:\Import_Fmt.xml') で実行するとエラー無くインポートされました。 実際のcsvは行数10000件はあり日々増減しますので毎回手作業で数えることは難しいです。 そこで一度仮テーブルを作り改行コードまでを一つのカラムにインポートして 行数をカウントし、変数にセットしてLASTROWの引数に渡そうとして ALTER PROCEDURE [dbo].[test1] AS declare @maxseq as int drop table test2 create table test2(F1 varchar(max)) bulk insert test2 from 'C:\test.csv' with (firstrow = 1,formatfile = 'C:\ImportOrg_Fmt2.xml') set @maxseq = (select count([F1]) from test2) --ここにreturn @maxseqを記述して以降を削除して実行し、ストアドを実行したら 　　　　　 --取り込んだcsvの行数が表示されました。 bulk insert test_table from 'C:\data\test.csv' with (firstrow = 1,lastrow = @maxseq -1 ,formatfile = 'C:\ImportOrg_Fmt.xml') と記述して実行すると メッセージ 102、レベル 15、状態 1、プロシージャ test1、行 23 '@maxdeq' 付近に不適切な構文があります。 となりました。 どのように記述したら構文エラーにならずに実行できるかご回答をよろしくお願いします。
お世話になります。 SQL Server 2005 から SQL Server 2014にする際に、 2005のデータ(MDF,LDF)は　そのままアタッチして使用することが可能でしょうか？ 2005のSQL文はそんなに特殊な事は記述していませんが、2014にする際に、 気を付けなければならない事などございましたら、 何卒ご教授いただければと存じます。 よろしくお願いいたします。
SQL文について勉強中ですが、集計のやり方が分からないためお教えください。 SQL SERVER2008r2 Management StudioでSQLを書いてます。 ◎TM部門（店舗マスタ） 店舗CD 店舗名 ◎TM店舗部門（店舗部門マスタ） 店舗部門CD 店舗部門名 ◎TT売上伝票（売上伝票） 伝票番号 行 店舗ＣＤ 店舗部門CD 売上日 売上時間 商品CD 商品名 数量 税抜単価 税込単価 税抜金額 税込金額 消費税 伝票合計 上記テーブルがあり、日付を限定して集計したいのですが、うまくSQLが書けません。 【希望結果例】 集計期間：2014/04/20　～ 2014/05/20 日付　　　　 　｜　店舗名　｜店舗部門名　　｜　　日別合計 2014/05/21　｜　店舗Ａ　　|　店舗部門A　　 ｜ sum(伝票合計) 2014/05/21　｜　店舗A　　|　店舗部門Ｂ　　 ｜ sum(伝票合計) 2014/05/21　｜　店舗Ａ　　|　店舗部門Ｃ　　 ｜ sum(伝票合計) 2014/05/21　｜　店舗Ｂ　　|　店舗部門Ｄ　　 ｜ sum(伝票合計) 2014/05/21　｜　店舗Ｂ　　|　店舗部門Ｅ　　 ｜ sum(伝票合計) 2014/05/21　｜　店舗Ｂ　　|　店舗部門Ｆ　　 ｜ sum(伝票合計) 　　　　　　　　　　　　　　　　　　　～ SELECT 伝票日付, 店舗CD, 店舗部門CD, SUM(伝票合計) AS 日別合計 FROM TT売上伝票 GROUP BY 伝票日付,店舗CD,店舗部門CD HAVING 伝票日付 BETWEEN '2014-04-21' AND '2014-05-20' AND 店舗CD IN(1,2,3,4) ORDER BY 伝票日付,店舗CD,店舗部門CD 上記の結果 日付　　　　 　｜　店舗CD　　　｜店舗部門CD　 　｜　　日別合計 2014/05/21　｜　店舗Ａ　　　　｜　店舗部門A　　 ｜ sum(伝票合計) 2014/05/21　｜　店舗A　　　　｜　店舗部門Ｂ　　 ｜ sum(伝票合計) 2014/05/21　｜　店舗Ａ　　　　｜　店舗部門Ｃ　　 ｜ sum(伝票合計) 2014/05/21　｜　店舗Ｂ　　　　｜　店舗部門Ｄ　　 ｜ sum(伝票合計) 2014/05/21　｜　店舗Ｂ　　　　｜　店舗部門Ｅ　　 ｜ sum(伝票合計) 2014/05/21　｜　店舗Ｂ　　　　｜　店舗部門Ｆ　　 ｜ sum(伝票合計) 集計は全く問題ないのですが、ここからリレーションし、店舗名、店舗部門名を表示したいのですが、書き方が分かりません。 無知ながら、下記方法を試しました結果 SELECT TT売上伝票.店舗CD, TM店舗.店舗名, TT売上伝票.店舗部門CD, TM店舗部門.店舗部門名 FROM TT売上伝票 JOINTM店舗 ONTM店舗.店舗CD=TT売上伝票.店舗CD JOINTM店舗部門 ONTM店舗部門.店舗部門CD=TT売上伝票.店舗部門CD UNION ALL SELECT 伝票日付, 店舗CD, 店舗部門CD, SUM(伝票合計) AS 日別合計 FROM TT売上伝票 GROUP BY 伝票日付,店舗CD,店舗部門CD HAVING 伝票日付 BETWEEN '2014-04-21' AND '2014-05-20' AND 店舗CD IN(1,2,3,4) ORDER BY 伝票日付,店舗CD,店舗部門CD エラーメッセージ ステートメントが UNION、INTERSECT、EXCEPT のいずれかの演算子を含んでいるときは、選択リスト内に ORDER BY 項目が必要です。 無知ながら、UNION演算子でやる方法と、サブクリエを使う方法があるのではと思いますが、出来れば利点と欠点を含めてお教え頂けたら幸いです。
SQLServer 2008 です。 以下のツリーデータの場合に A ┬C │├D ┬H ││　├I ││　└J │└E B ┬F ┬I 　│　└L 　└G 次のようなデータを登録しています。 ┌──┬──┬──┐ │OYA │KO　│Data│ ├──┼──┼──┤ │A │C 　│"C" │ ├──┼──┼──┤ │A　 │D 　│"D" │ ├──┼──┼──┤ │A　 │E 　│"E" │ ├──┼──┼──┤ │B　 │F　 │"F" │ ├──┼──┼──┤ │B　 │G 　│"G" │ ├──┼──┼──┤ │D 　│H 　│"H" │ ├──┼──┼──┤ │D 　│I 　│"I" │ ├──┼──┼──┤ │D 　│J 　│"J" │ ├──┼──┼──┤ │F 　│I 　│"I" │ ├──┼──┼──┤ │F 　│L 　│"L" │ └──┴──┴──┘ 引数OYA＝"A"でSQLを実行した場合に 以下のような この引数を含むそれ以下のツリーに関する データを取得する方法を教えてください。 ┌──┬──┬──┐ │OYA │KO　│Data│ ├──┼──┼──┤ │A │C 　│"C" │ ├──┼──┼──┤ │A　 │D 　│"D" │ ├──┼──┼──┤ │A　 │E 　│"E" │ ├──┼──┼──┤ │D 　│H 　│"H" │ ├──┼──┼──┤ │D 　│I 　│"I" │ ├──┼──┼──┤ │D 　│J 　│"J" │ └──┴──┴──┘
MS SQL2005 の”SQL Server Management Studio”を使って下のクエリーを実行します。 例１は実行できますが、例２は実行できません。 なぜでしょうか？ 例１ select * from [test].[dbo].[test_table] 例２ select * from （'[test].[dbo]' + '.[test_table]'）
質問をお願いします。 現在、複数のネットショップを運営しています。 各ショッピングモールに出品するのが大変なので、自社で商品データベースを作って、それぞれのモール用（楽天、Yahoo、Dena、自社、ヤフオク、ポンパレ）のCSVデータと画像を吐き出すようにしています。 ただ、社員が勉強しながら作ったソフトなのでトラブルが多発し、困っています。 このような素人が作成したソフトのソースをプロに渡し、理想の形に仕上げていただきたいのですが、可能でしょうか？ 価格的にもどのくらいかかるのか心配です。 人の書いたソースは理解するだけでも大変そうです。ちなみに私自身は全く理解できていません。 開発環境は Windows Server 2008 R2 Visual Basic 2010 Express と聞いております。 よろしくお願いします
初めて、データベースを作成するのですが、 基本的な部分でつまずいています。 テーブルのレコード削除において、 そのテーブルの主キーを外部キーに使用している他のテーブルの修正に関して 教えて頂きたいのですが？ 例えば、テーブルが2つ(Table-A、Table-B)あり、 フィールドとして、 Table-A　(1)販売員コード(主キー)　(2)名前　　　 　　(3)年齢 Table-B　(1)顧客コード(主キー)　　(2)販売員コード(外部キー)　(3)注文日　　(4)商品コード(外部キー) があったとします。 この時、Table-Aの販売員コード　0015番が辞めたので、削除する場合、 1.通常、0015番は、永久欠番にするのでしょうか、それとも新しい販売員に 　割り当てることもあるのでしょうか？ 2.もし、後者である場合、Table-Bの(2)販売員コードフィールドの0015番のすべてのデータは、 　元の販売員と名前が違う訳ですから、どう対応したらよいのでしょう？ 　 永久欠番であれば、まだ分かるのですが、一般に各テーブルの主キーは一度決めたら、 変更しないものなのか、変更もありえるのか教えて欲しいのです。 初心者なので、質問内容が質問になっていないかもしれませんが、宜しくお願いします。
プログラミング初心者です。 テキストボックスに、グーグルとかみたいに、 ○文字○　スペース　●文字●と入れて、検索ボタンをおすと、 ○文字○と●文字●の両方の文字を含んだデータを表示したいと思っています。 ストアドプロシージャを使って、1つの文字列なら検索することは可能になったのですが、 スペースで区切った文字2つを使ってのAND検索をすることができなくて困っています。 以下は、1つの文字列のみ検索できるストアドプロシージャのです。 ALTER PROCEDURE [dbo].[対応依頼書文字列検索V99] @strnvarchar(1000) As Create Table #tblIrai ( IraiNoint Primary Key(IraiNo) ) Insert#tblIrai Select依頼書No Fromyamagata.dbo.対応依頼書基本情報 Where[依頼書No]Like '%' + @str + '%' Or[依頼日]Like '%' + @str + '%' Or[依頼部署]Like '%' + @str + '%' Or[依頼者]Like '%' + @str + '%' Or[作業希望日]Like '%' + @str + '%' Or[作業希望日補足]Like '%' + @str + '%' Or[区分]Like '%' + @str + '%' Or[依頼種別]Like '%' + @str + '%' Or[法人コード]Like '%' + @str + '%' Or[会社コード]Like '%' + @str + '%' Or[法人名称]Like '%' + @str + '%' Or[システム/機器名]Like '%' + @str + '%' Or[バージョン(品番)]Like '%' + @str + '%' Or[受付日]Like '%' + @str + '%' Or[受付者]Like '%' + @str + '%' Or[作業開始日]Like '%' + @str + '%' Or[作業終了日]Like '%' + @str + '%' Or[作業時間]Like '%' + @str + '%' Or[作業担当者]Like '%' + @str + '%' 複数の条件で検索する方法が全く浮かびません。 スペースで区切った条件で検索する場合は、事前に処理が必要なのでしょうか。 ご存知の方がいらっしゃいましたら、お手数ですが、ご教授いただけると助かります。
SQLServer2012で、row_number()とover()を使って抽出を行っています。 以下の様なテーブルがあるとして ------------------------------------------- ID NO distination expensen rnak flg ------------------------------------------- A001 001 広尾 1000 1 1 A001 002 品川 1000 2 1 A002 001 大森 500 3 0 A003 001 品川 1500 2 0 A001 003 新宿 2000 4 0 A001 004 渋谷 1200 5 0 A003 002 新宿 3000 4 1 A004 003 広尾 4000 1 0 A005 002 大森 500 3 1 A003 002 品川 1000 2 1 A003 003 池袋 1300 6 0 A005 001 大森 500 3 1 これに対して row_number()とover()を使って、 (1)IDとflgでグループ化し (2)flgの降順(”1”が優先） (3)flgが”1”の場合、rankの降順、NOの昇順 (4)flgが”0”の場合、rankの昇順、NOの昇順 (5)ID毎の連番（行番号）を割り当てる これを以下に様なID毎の連番で結果を得たい。 row_number ID NO distination expensen rank flg ------------------------------------------------------- 1 A001 002 品川 1000 2 1 2 A001 001 広尾 1000 1 1 3 A001 003 新宿 2000 4 0 4 A001 004 渋谷 1200 5 0 1 A002 001 大森 500 3 0 1 A003 002 新宿 3000 4 1 2 A003 002 品川 1000 2 1 3 A003 001 品川 1500 2 0 4 A003 003 池袋 1300 6 0 1 A004 003 広尾 4000 1 0 1 A005 001 大森 500 3 1 2 A005 002 大森 500 3 1 と1回のSQLで抽出したいのですが、SQLを教えて下さい。
いつも楽しく勉強させていただいております。 環境はSQLServer2012のExpressでOSはWindowsServer2008です。 Test1というデータベースのバックアップを取ってTest2という名前で復元しようとしましたが、なぜか失敗してしまいます。 どなたか原因を教えていただけませんか。 次の手順でバックアップを取り、復元をしています。 ○バックアップのフェーズ 1.データベースのバックアップのダイアログボックスを開く。 2.ソースにTest1、バックアップの種類に完全を指定する。 3.バックアップ先は以下のファイルに 　C:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS\MSSQL\Backup\Test1.bak 4.OKをクリックし、「データベース'Test1'のバックアップが正常に完了しました」を確認。 ○復元のフェーズ 5.データベースの復元のダイアログボックスを開く。 6.ソースはデバイスにする。 7.ファイル名に上記3.のファイル名を指定 8.転送先データベースはTest2とする。 9.OKをクリック（ここでエラーとなる）。 エラーメッセージは以下の通りです。 ------------------------------------------ データベース'Test2'の復元に失敗しました。（Microsoft.SqlServer.Mangement.RelationalEngineTasks) 追加情報: System.Data.SqlClient.SQLError:ファイル'C:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS\MSSQL\DATA\Test1.mdf'に上書きできません。 データベースTest1が使用中です。(Microsoft.SqlServer.SmoExtended) ------------------------------------------ メッセージの内容で引っかかるのはTest1.mdfに上書きできませんというところです。 上書きでなくTest2という新規データベースに書き込みたいのですが。 ためしにTest2というデータベースを作成しておいて「既存のデータベースに上書きする」をチェックしてやってみましたが、やはり失敗。 メッセージは上と同じです。 SQLServerを再起動して試してもやはり結果は同じです。 何が悪いのでしょう。
＜環境＞ SQLSERVER 2012 入力フォームに、入力した後で、DBに登録した際に、 依頼Noに、既にあるデータのMAX+100の値を登録したいです。 依頼NoにMAX+100の連番をふることは以下の方法でできたのですが、 ＩNSERT INTO テーブル1(依頼No) SELECT MAX(依頼No)+100 AS NEW_ID FROM テーブル1 入力フォームのデータと登録と同時に、依頼Noを振りたいのですができません。 以下のように書いてみましたが、 根本的に間違っていると思うので、いい方法をご教授いただけたらと思います。 ※iraibi は入力フォームで、依頼日を入力した値です。 INSERT INTO テーブル1 (依頼No,依頼日) VALUES ('SELECT MAX(依頼書No)+100 AS NEW_ID FROM テーブル1','" & iraibi & "') 宜しくお願いいたします。
Windows server2012へSQL SERVER2008 R2 EXPRESSをインストールすると、「このプログラムには互換性の問題があります」（2008 and 2008）と表示されます。 色々調べて、Windows Server2012へ.NETFramework3.5はインストールしたのですが、まだ同じメッセージでSQL SERVER2008 R2がインストールできません。 対応策をご存じの方は、教えてください お願いします
メール送信処理において、 以下の実験を行った際、エラーとして処理したいのですが、 エラー値を取得する事が出来ず（Returnには常に0が入る）困っています。 また、【mailitemid】のヘルプを見ると送信が成功した場合、IDが入ってくると記載があったので、 Returnにセットしてみましたが、メール送信の成否に関わらず0でした。 ーーーーーー記ーーーーーー 1.プロファイル情報が正しく無い時(送信サーバアドレスが間違えてる等) ※当然メールは飛んできません --------------------------メール送信プログラム開始-------------------------- ALTER PROCEDURE [dbo].[SEND_MAIL] @pra_profile_name nvarchar(1000), @pra_recipients nvarchar(1000), @pra_subject nvarchar(1000), @pra_body nvarchar(1000), @pra_file_attachments nvarchar(1000) AS DECLARE @get_return int DECLARE @mailitemid int BEGIN TRY exec @get_return = msdb.dbo.sp_send_dbmail @profile_name = @pra_profile_name, @recipients = @pra_recipients, @subject = @pra_subject, @body = @pra_body, @file_attachments = @pra_file_attachments, @mailitem_id = @mailitemid OUTPUT; END TRY -- 例外処理 BEGIN CATCH RETURN ERROR_NUMBER() END CATCH Return @get_return --------------------------メール送信プログラム終了-------------------------- 以上、何卒宜しくお願い致します。
あるテーブルに追加処理を行った場合、ストアドを実行を実行したく、 トリガを作成してみましたが、 『トランザクションはトリガーで終了しました。バッチは中止されました。』という エラーが出てしまい困っています。 エラー内容で検索してもあまり出てこないので、 初歩的且つ、根本的に間違っているかと思うのですが、 初めて作成した為、なにがいけないのかも検討がつかない為、 ご教示頂きたく、投稿させて頂きます。 ○トリガ ALTER TRIGGER [dbo].[TRIG_SEND_MAIL] ON [dbo].[SEND_MAIL_INFO] FOR INSERT AS begin EXEC dbo.mail_test end ○目的としては対象テーブルを実行するとトリガを発動し、【dbo.mail_test】を起動させたい insert into SEND_MAIL_INFO (PROFILE_NAME,SEND_FLG) values ('AAAAAA','0') 上記SQL文を実施するとエラーなってしまいますので どうすればよいのか具体的な対処方法をご教示頂きたく、 何卒宜しくお願い申し上げます。
sql server2005 バックアップファイルから復元すると、「RESTOREでバックアップセットを読み取った時に、データベースXXXXXXのページ（0.978）でエラーが検出されました」と90％終了後に表示されます。一部が壊れていうrと思いますが、破損部分を無視して戻す方法をご存じの方がおられたら教えてください。マシンは立ち上がらず、このバックアップしかありません。 宜しくお願いします。
SELECT ID, NAME FROM TEST たとえば上記の結果で ID NAME 1 'A' 2 'B' 3 'C' 4 'D' 5 'E' と返ってくるとします。 これにテーブルには存在しない列をつけて、かつ、 こちらで指定した値を入れたいのですが可能でしょうか。 ID NAME VALUE 1 'A' 'あ' 2 'B' 'い' 3 'C' 'う' 4 'D' 'え' 5 'E' 'お' こうしたいのです。 SELECT ID, NAME, 'あ' AS VALUE FROM TEST これだと全て「あ」になってしまいますし…。 可能であればご教授いただけないでしょうか。
SQL　Server で　翌月10日を取得する方法を教えてください。 isnull(convert(char(10),dateadd(month,1,(dateadd(day,9,DATE))),111),'') as DATE ↑これだと、DATE(月末)の翌月の９日後で、翌月10日も可能なのですが、 当然ながら、DATEが月末とは限らないので。。。 常に10日を固定で表示するにはどうしたら、よいのでしょうか？ よろしくお願いいたします。
お世話になります。 SQLで困っています。 [環境] SQLServer2008 [テーブル] 売上テーブル 売上テーブルには日付、種別、金額のみ持っています。 [データ] 日付｜種別｜金額｜残高 2014.01.01｜繰越｜1,000,000 2014.01.05｜入金｜35,980｜1,035,980 2014.01.06｜出金｜290,000｜745,980　　←最低額 2014.01.07｜入金｜955｜746,935 2014.01.08｜入金｜33,020｜779,955 2014.01.09｜入金｜34,960｜814,915 2014.01.10｜入金｜41,960｜856,875 上記データで最低額を求める簡潔なSQLを考えていますが、思いつきません。 どなたかご教授頂けたらと思います。
SQLでORDER BYをして、n番目からm番目を取得したい場合、 どのようにしたらいいのでしょうか？ TOP mで取得してnまでをスルーするしかないのでしょうか？
LEFT OUTER JOIN と TOP10との組み合わせ テーブルAと LEFT OUTER JOIN するテーブルBがあり、 単にLEFT OUTER JOINすると、 レコードA01 レコードB01 レコードA01 レコードB02 レコードA01 レコードB03 のようにレコードBに対し、該当する同じレコードAが複数取得されます。 この状態でTOP10をかけると、テーブルAのTOP10が欲しいのに、 テーブルBも混じった数で取得されてしまいます。 （テーブルAは１０レコード取得できない） これをテーブルAのTOP10を取得して、それにJOINするテーブルBの数は問わない方法は可能でしょうか？
こんにちは。 Microsoftが提供しているPower Povitについて質問です。 このツールを利用するにはMicrosoftSQL2008以上とExcel2010以上が必要なのはわかったのですが それ以外に何かライセンスは必要でしょうか。 勤めている会社でBIツールを提供する可能性が出てきており 何をベースとして使用するか選定しています。 少し調べている限りでは非常にこちらの条件とマッチしているのですが ライセンスなどに触れている記事に当たらなかったのでこちらに投稿させて頂きました。 よろしくお願いします！
SQLServer2012のインストールについての質問です。 SSDで起動しているCドライブにインストールし、DATAフォルダを HDDのDドライブにして運用していたところ、わずか3ヶ月でSSDが 壊れました。 原因はLogフォルダへの書き込み件数だと思われます。 日々、数１０万単位のInsert処理が行われていたため、その都度 Logファイルへの書き込みがあったと想定されます。 CドライブにインストールしたとしてLogファイルをDドライブへ 書き出すように設定変更は可能でしょうか？
MS SQL server 2005 express edition をWindows７のパソコンにインストールをしたいです。 必要なインストール物、必要な環境条件など分からない素人です。 教えていただけないでしょうか。 以下の２つで宜しいのでしょうか？ Microsoft SQL Server 2005 Express Edition Service Pack 3 Microsoft SQL Server Management Studio Express Service Pack 3 .NETFrameworkのバージョンやWindow7の更新プログラムやサービスパックなどは どのような環境であれば宜しいのでしょうか？ すみません。よろしくお願い致します。
お世話になります。 Windows7 Pro(64bit版)に、32bit版のSQLServerをインストールすることは可能でしょうか。 ※ダウンロードサイトには64bit版と32bit版があります。64bit版のSQLを32bitOSにはインストールできないと思いますが、32bit版のSQLを64bitOSにはインストールできるのかどうか。。てところです。 <経緯> こちらに投稿させて頂きましたが、mdbでの抽出に時間がかかるようになってしまいました。 もし32bit版のSQLがインストール可能なら、検証したいと思っている次第です。 http://questionbox.jp.msn.com/qa8461343.html 本来なら、実際に試してみればよいのですが、64bitのPCが今手元になく試せません。なので、とりあえずインストール可能か否かを知りたいところです。 ご教授の程、宜しくお願い致します。
お世話になります。 マイクロソフトのSQL Server2005 Express、SQL Server2008 R2 についての質問です。 職場の私のＰＣ（Windows7 Pro 64bit版）には各種開発ツール、ＤＢがインストールされています。 VS2005をインストールした時にSQL Server2005 Express（？）もインストールされたようです。 社内のＤＢサーバー機のSQL Server2008 R2 に接続するために製品版のSQL Server2008 R2の クライアントツール（Management Studioなど）もインストール済みです。 私のPCにSQL Server2008 R2 Expressをインストールしたいのですがどうすればよいでしょうか？ （可能なのかどうか？　導入手順は？） すでにSQL Server2005 Express や 製品版のSQL Server2008 R2（クライアントツール）が インストール済みですのでそれらとバッティングしないかと気になっています。 やりたい事は、スタンドアロン環境でＤＢを動かしストアドプロシージャのテストなどの実施です。 ※SQL Server2008 R2 の環境からバックアップを取ったDBを復元する必要があるので 　SQL Server2008 R2 Express以降のバージョンが必要です。 ご教授よろしくお願いいたします。
SQL Server 2008R2/2012でのVIEWのアクセス権限の付与について パケージのシステムを構築しており、ユーザにVIEWの読み取り権限だけを公開したいと考えています。 ユーザは、SQL Server Management StudioでそのVIEWに対してSELECTだけできるようにしたいのですが、やってみるとVIEWに対しての権限の他に元となるテーブルのアクセス権限も必要となり、見せたくないテーブルとそのテーブルの列が見えてしまいます。 なんとか、DBへの特定のログインユーザだけVIEWに対して読み取り（SELECT）ができようなユーザが作れないでしょうか？ アドバイスをお願いします。
sqlserver（2008R2）についてクエリ文が上手く書けません。 お手数をおかけいたしますが、お分かりになる方はご教授いただければと 思います。 まず、元となるテーブルおよび作成したい完成系は添付ファイルをご確認下さい。 personal_id、personal_name、personal_address、personal_tel、personal_date列を 持つテーブル(personal_table)から 「select * into #table01 personal_table」に よって一時テーブル#table01を作成し、personal_name・address・telがnullの場合に、 personal_dateが直前時におけるnull以外の値をセットしたいと思っています。 （ただし、セットするのはpersonal_id毎で、最もpersonal_dateが若い者には 必ずpersonal_name・address・telが入っているものとします）。 なお、以下は私が作成したクエリになります。　項目1つずつっと思い、 とりあえずpersonal_nameをpersona_idおよびpersonal_dateを用いて updateしようと思ったのですが、personal_nameがすべてnullになってしまいました。 --------------------------- select * into #table01 from personal_table update #table01 set personal_name = (select personal_name from #table01 A where #table01.personal_id = A.personal_id AND #table01.personal_date = (select MAX(A.personal_date) from #table01 A where #table01.personal_date > A.personal_date AND #table01.personal_id = A.personal_id)) SELECT * from #table01 --------------------------- 完成系を作成するにあたってどのようなクエリを書けばよろしいのか、 ご教授いただければと思います。
macでsqlite3でcsvのインポートができません。 in.txt -------- 1,りんご,赤色 2,みかん,黄色 ターミナル上で sqlite> .separator , sqlite> .import in.txt tbl1 といった具合にやると、改行が認識されないのか、 expected 2 columns of data but found 4 といったエラーがでます。 対処法を教えてください(><)
SQLServer 2005にて文字列型に入っている日付データの変換を行いたいと思っています。 現状yyyy/M/d（2010/1/1）のようになっているのをyyyy/MM/dd(2010/01/01)に変換したい のですが方法が分かりません。 SELECT CONVERT(DATETIME,(CONVERT(VARCHAR(10),テーブルの値)),120) FROM テーブル名 とするとCHAR データ型から DATETIME データ型への変換の結果が日付/時刻の値の範囲外です。 というエラーになっていまいます。どういった方法なら実現できるのでしょうか。 すみませんがご教授ください。 宜しくお願い致します。
SQLServer2008R2を使用しています。 次のようなテーブルAがあります。 ID　Code1　Code2　Code3　Val1　Val2　Val3 -------------------------------------- １　　A1　　　　　　　　　　　　　１ ２　　A1　　　Z1　　　　　　　　 ２　　　１ ３　　B1　　　A1　　　　　　　　 １　　　１ この時、Code1～３にあるA1に該当するVal1～3の合計をそれぞれ取得したいのですが、SQL文の書き方がわかりません。 SELECT Sum(Val1), Sum(val2), Sum(Val3) FROM A WHERE Code1='A1' OR Code2='A1' OR Code3='A1' のようなSELECT文では、B1・Z1の数も合計してしまいます。 B1・Z1の数が含まれないようなSQL文は、どのように記述したらよいでしょうか？ どなたか有識者の方いらっしゃいましたら、宜しくお願い致します！
AccessからSQL　Server2008に接続しています。 MSDE2000で、ストアドプロシージャを作成するときは @ST INT = 1 AS SELECT ....... で実行できましたが、2008はエラー となります。 DECLARE @ST int = 1 SELECT ...... とすると、変数@STは宣言済みとエラーになりますが、なぜでしょうか？ ご存じの方がおられましたら、よろしくお願いします。
こんにちは。 T-SQLでMySQLのGROUP_CONCAT関数と同等の結果を出力する方法を探しています。 やりたいことは、 テーブル"T_A"の項目にカラム"C1"、"C2"があると仮定します。 テーブル"T_A"にはデータが以下のように登録されています。 C1|C2| ------ A1|YY| A1|XX| カラムC2のYY、XXの値を文字列連結"YY/XX"として、1レコードで表示したいです。 C1|C2 | --------- A1|YY/XX| ご存知の方がいらしたら、お教え願います。
SQLでSELECT文を使う場合、大抵 　SELECT ID, user FROM u_table のように、取得する項目を指定すると思います。 これを、 　SELECT ＊ FROM u_table としないのには、トラフィックの問題以外に何か理由があるのでしょうか？
Windows2003ServerにてSqlServer2005をバッチファイルから実行する時について質問させてください。 下記の「sql.bat」にて「script.sql」を実行した場合、「log.txt」に出力される内容は'222'をアップデートした結果「(x行処理されました)」のみが出力されますが、'000'や'111'を更新した結果も出力させたい場合、「script.sql」を3分割し、「sql.bat」で3ファイル実行するしかないのでしょうか。 「sql.bat」 sqlcmd -S SERVERNAME -d SCHEMANAME -i c:\script.sql -o c:\log.txt 「script.sql」 update tablename set data1 = 'aaa' where data1 = '000' update tablename set data1 = 'bbb' where data1 = '111' update tablename set data1 = 'ccc' where data1 = '222'
COBOL上（NETExepress5.0）にSQL構文を埋め込んでプログラムを作っています。 DELETE文を発行して、そのDELETE件数を取得して、DISPLAY文に表示したいのですが、 どのようにすればよいでしょうか。 DELETE文（COBOL文中） 例） 　EXEC　SQL　DELETE　FROM　テーブル名 　END-EXEC 先にSELECT　COUNT（*)　FROM　テーブル名 とかしてもかまわないです。 よろしくお願いします。
SQLServser2012で縦持ちになっているデータを横持ちにしたいのですが、どうしたらよいでしょうか？ 〇以下のように現在、テーブル設計されております。 請求TBL --------------------------------------------- 請求ID 請求先名 001 田中 太郎 002 鈴木 一郎 注文TBL ------------------------------------------------ 請求ID 注文ID 発送先 商品ID 個数 001 001 田中 太郎 A 10 001 002 佐藤 次郎 A 5 002 003 鈴木 一郎 B 3 商品TBL ----------------------------- 商品ID 商品名 A みかん B りんご このデータを以下のような結果として得たいのですが、どのようにしたらSQLを作成したらよろしいでしょうか？ 請求ID 請求先 商品内容 ------------------------------------------------- 001 田中 太郎 みかん*10、みかん*5 002 鈴木 一郎 りんご*3 ご教授の程、宜しくお願い致します。
以下のEx1,2のJOIN句の記述方法の違いはクエリのパフォーマンスに影響するのでしょうか？ 2万件程度のデータ量で試してみたのですが明確なパフォーマンスの違いを確認できませんでした。(1秒～2秒) 単純に書き方だけの違いであれば心置きなく自分ではわかりやすいと感じているEx1の記述方法で統一したいので。 よろしくお願いします。 -- /* SQL Server 2008 R2 */ -- /* 受注した全ての商品名を取得するクエリ(例) */ -- /* 登場テーブル・カラム */ -- // M_goods 商品マスタ -- // code 商品コード -- // name 商品名 -- // T_orders 受注テーブル -- // number 受注番号 -- // T_orderdetails 受注明細テーブル -- Ex.1 SELECT M_goods.name FROM T_orders LEFT JOIN T_orderdetails ON T_orders.number = T_orderdetails.number LEFT JOIN M_goods ON T_orderdetails.code = M_goods.code -- Ex.2 SELECT M_goods.name FROM T_orders LEFT JOIN T_orderdetails LEFT JOIN M_goods ON T_orderdetails.code = M_goods.code ON T_orders.number = T_orderdetails.number
SQL Server2008でパフォーマンスの悪いSQLなどを調べようと思い、 以下のような説明を参考にしています。 http://msdn.microsoft.com/ja-jp/magazine/cc135978.aspx http://msdn.microsoft.com/ja-jp/library/ms189741.aspx しかし、エラーが出て実行できません。 SQL文から抜粋しますと、以下の様なエラーが発生ます。 　・THEN LEN(CONVERT(nvarchar(max), qt.text)) * 2 　　　→'max' の近くに無効な構文があります。 　・CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) AS qt 　　　→'APPLY' の近くに無効な構文があります。 　・SELECT qs.execution_count 　　FROM sys.dm_exec_query_stats AS qs 　　　→'sys.dm_exec_query_stats' は無効です。 調べても何が悪いのかわからず困っています。 何がいけないのかご教授いただけませんでしょうか。 よろしくお願い致します。
5年間くらいの期間で、毎年300万件くらいのデータを統合して管理しようとしております。 こういった時どんなソフトを使うのがいいか教えてください。 「Microsoft SQL Server 2008 Developer Edition」というのが出てきて検索してみましたが、アクセスに比べかなり敷居が高いように思いました。 （アクセスでは2Gは軽く超えます）
SQLServerでGROUP　BYを使用してデータをSELECTする場合について質問があります。 GROUP　BYを行う項目に’△△1’と’1△’というデータが入っていた場合、 　　※上記の△は半角スペースです。 ’△△1’と’1△’は同じグループとして、グルーピングされるのでしょうか。 Oracleにデータを移行して、GROUP　BYをかけると上記のケースはデータ件数が異なります。 これはSQLServerの仕様なのでしょうか。（バージョンは2000です。） お手数ですが、ご教示願います。　
標記の件なのですが弊社ではデ－タ－ベ－スにＳＱＬを使用しております。 今は新しい販売管理システム構築に向けて複数のソフト開発会社様と話し をしておりだいたい概算の見積りが出揃いまして、基本的にはACCESS+SQLServer でとなっているのですが１社だけ極端に安い見積りがあるなって思ったら 無料版のexpressになっておりました。 零細企業でサ－バー１台にクライアントＰＣが８台だけの構成なのですが 無料版でも大丈夫な物でしょうか？勿論無料版には容量の制限等あるのは 存じております。また、販売管理システムですので大きなファイルは無いとは 思いますのでそれで無料版を使用しようとされているではないかと思っており ます。 是非、皆様にアドバイスをして頂きたく質問させて頂きました。 宜しくお願い致します。
SQL Server2012 Expressで作成したデータベースをＵＳＢメモリにバックアップしました。 最近、マシントラブルでドライブが死んだので、ＳＱＬ Serverも入れ直し、データベースをリストアしようとしましたが、うまくできません。 具体的には、データベースを右クリックして「タスク」→「復元」→「データベース」として、デバイスを選ぼうとすると、バックアップファイルの拡張子がbakとtrnとなっており、USBメモリに記録されているmdfとｌｄｆではありません。 すべてのファイルを表示させ、それらを選択しても、データベースの復元ダイアログのOKボタンがグレーアウトのままです。 「タスク」→「復元」→「ファイルおよびファイルグループ」なのかな？と思って、やってみてもやはり、拡張子が違います。 同じようにmdfとldfを選択してみると、 「デバイス'データベース名.mdf'のメディアファミリが正しい形式ではありません」 「RESTORE HEADERONLYが異常終了しています。(エラー：3241)」 とのダイアログが出て復元できません。 私はバックアップを失敗したのでしょうか？ 何とか、一部のデータでも復元できないでしょうか？ よろしくお願いいたします。
C#とSQL Server2005との連携でConnectionStringに connection timeout=60 を設定していますが、 ３０秒程度でタイムアウトしてしまいます。 タイムアウトの設定はソースコード上以外に、 SQL Server上でも設定が必要なのでしょうか？
お世話になります。 これまで、社内ネットワークで SQL Server + Access ADPでプログラムを作成していましたが、データだけをレンタルサーバなどに移行し、インターネット経由でデスクトップのPCとやり取りするにはどうしたらいいのでしょうか。（クライアントは、ASP.NETなどを経由してWEBブラウザを利用するのではなく、直接AccessやVBで通信して利用したいと考えています） サーバの設定や接続文字列の書き方など、必要な情報（必要な資料がのっているサイトなど）をご教示いただければ助かります。 よろしくお願いいたします。
こんにちは。 あるテーブル"T_A"が有り、 そのテーブルにカラム"C1"、"C2"が有ります。 テーブル"T_A"にレコードが以下の用に登録されていると仮定します。 C1|C2 ----- AA|S AA|P BB|R BB|S CC|S ※C2に登録されている値は抽出する優先順位が有り、 R:1 P:2 S:3 Rが一番優先順位が高く、Sが優先順位が最も低いです。 この条件から、C1の値が同じレコードに対して、C2の優先順位が 最も高いレコードを抽出したいです。 欲しい結果↓ C1|C2 ----- AA|P BB|R CC|S
SQLで文字列を時刻に型変換する方法を教えていただきたいです。 char型のAというカラムに'090000'が格納されています。 この値を time型のBというカラムに型変換して登録したいのですが、 cast(A as time)　としてもエラーが出てしまうので、現在は cast(SubString(A,1,2)+':'+SubString(A,3,2)+':'+SubString(A,5,2) as time)　と変換しています。 もっと簡単に変換する方法はありますでしょうか？ ご教示頂けましたら、助かります。 宜しくお願い致します。
SQL SERVERの BULK INSERTについて。 TESTというテーブルにtest.csvをBULK INSERTによりデータをインポートしようとしているのですが変数を使わずに下記のように書くと正常に動くのですが、 BULK INSERT TEST FROM 'C:\data\test.csv' WITH ( FIELDTERMINATOR = ',', ROWTERMINATOR = '\n' ) 変数を使って下記のようにすると「不適切な構文があります。」とエラーとなってしまいます。 DECLARE @data varchar(100) SET @data = 'C:\data\test.csv' BULK INSERT TEST FROM @data WITH ( FIELDTERMINATOR = ',', ROWTERMINATOR = '\n' ) 解決策を教えてください。
SSIS初心者です。 SSISで異なるサーバーのテーブルを結合する方法を教えて頂きたいです。 環境のイメージとしては サーバー１のテーブルAと サーバー２のテーブルBを結合して サーバー２のテーブルCに登録処理を行いたいです。 二つのDBはスキーマ名、ログインID、パスワードが全て異なります。 ご教示頂けましたら、助かります。 宜しくお願い致します。
受注T ---------------- 製品CD　　得意先CD　　数量　　単価　　受注日 0001　　2001　　500　　3000　　2013/7/5 0002　　2002　　1000　　NULL　　2013/9/25 0003　　2003　　1800　　NULL　　2013/9/25 単価M ---------------- 製品CD　　得意先CD　　数量FROM　　数量TO　　単価　　適用日 0001　　2001　　0　　99999　　3000　　2013/5/1 0002　　2002　　0　　　　500　　　800　　2013/5/1 0002　　2002　　501　　999999　　500　　2013/5/1 0003　　2003　　0　　　500　　　　2000　　2013/1/1 0003　　2003　　501　　999999　　1800　　　2013/1/1 0003　　2003　　0　　　500　　　　2500　　2013/9/20 というデータがあります。 受注Tの単価部分にデータがあるものとないものがあります。 受注時に単価Mから照合して単価を入れるのですが、受注時にまだ単価Mにない場合はNULLが 入っています。 そこで後日VIEWとして単価照合Vを作りたいです。 単価照合Vを作ったときにも単価MになければNULLのままでOKです。 て単価照合V ---------------- 製品CD　　得意先CD　　数量　　単価　　受注日 0001　　2001　　500　　3000　　2013/9/27 0002　　2002　　1000　　500　　2013/9/25 0003　　2003　　2000　　1800　　2013/9/25 ※2013/9/20に単価更新がありますが条件数量は0-500なので2013/1/1が適用 こんな感じです。 わからないのは受注数量、受注日と単価Mの照合です。 サブクエリを使えばSQLで１行に書けるのでしょうか？ お願いします。
教えてください。 SQL Server2005 Express EditionはWindows7に対応していますでしょうか？ ServicePackは？？以上ということはありますでしょうか？ 対応表等あれば教えていただけますでしょうか？ もし対応していたとしても新しいExpress Editionに変えた方が良いでしょうか？ (現在WindowsXP上で使用しています。) よろしくお願い致します。
Accessで書かれたクエリをSqlサーバーのクエリに変換したいと考えているのですが そのクエリは膨大な行数ある上にIIF関数やSwitch関数がそこら中に含まれており、一つ一つ置換していられません。 もしどなたかIIF関数などのAccessのクエリをSqlサーバーのクエリへ変換してくれるソフトをご存知の方いらっしゃいましたら教えていただければ幸いです。 よろしくお願いいたします。 ◆バージョン SQL Server:SQL Server 2008 R2 ACCESS:ACCESS2000 OS:Windows7
お世話になります。 Where句のCase文でお尋ねしたいことがあります。 ----------------------------------------------------- WHERE (A = @A) AND (B = @B) AND (C = @C) AND CASE WHEN @D = 0 THEN (dbo.TEST.D = dbo.TEST.D) '全データを WHEN @D = 1 THEN (dbo.TEST.D = 1) '値が1のデータを WHEN @D = 2 THEN (dbo.TEST.D = Is Null) 'データがNull のものを END AND (E = @E) AND (F = @F) AND (G = @G) AND (H = @H) AND CASE WHEN @I = 0 THEN (dbo.TEST.I = dbo.TEST.I) WHEN @I = 1 THEN (dbo.TEST.I = 1) WHEN @I = 2 THEN (dbo.TEST.I = Is Null) END AND (J = @J) ........ ........ ----------------------------------------------------- 上記のように CASE 文で　パラメータの値により条件を変えたいのですが、なかなかうまくいきません。こんな記述の仕方ではダメということは薄々わかっているのですが、このようなCASE文をうまく動作させるにはどのように記述すればいいでしょうか？ よろしくお願いいたします。
こんにちは。 テーブル"TABLE_A"、"TABLE_B"があり、 各々のテーブルにカラム"COL"があります。 カラム"COL"にインデックスを作成しています。 テーブル"TABLE_A"、"TABLE_B"をカラム"COL"で結合 する際の演算子にLIKE文を用いています。"TABLE_B"の カラム"COL"に"%"を付加していますが、これが原因で "COL"のインデックスが効きません。どのようにすれば LIKE検索でインデックスを有効にすることができるの でしょうか？ SELECT * FROM TABLE_A INNER JOIN TABLE_B ON TABLE_A.COL LIKE TABLE_B.COL+'%'
SQL Server 2005 を使っております。 WHERE句の分岐といいますか、記述の方法がわからないのですが、下記がその部分になります。 下記のコードを実行すると、都道府県、血液型、両方に何かしらのデータが入っているものしか抽出してきません。都道府県、血液型、どちらかの値がNullの場合でも、どちらかの条件が合致していれば、抽出したいのですが、どう記述すればよろしいでしょうか？ 下記のコードが　Null = Null を認識していれば　このコードでも抽出してくるんでしょうが、 Null = Null だと抽出しないんですね。 何卒よろしくお願いいたします。 WHERE (IsNull(@A,dbo.テスト.都道府県) = dbo.テスト.都道府県) AND (IsNull(@B,dbo.テスト.血液型) = dbo.テスト.血液型
SQLのSelect文である期間を日別に出力したいのですが、どのようにすればいいのでしょうか テーブルのデータは期間全部が入っているのではなく。 データが存在しない日もあります。 データが存在しない日は日にちをのぞいて空白になるようにしたいです。 例として、 テーブル上のデータ 2013-08-01　　ああああ 2013-08-03　　いいいい 2013-08-06　　うううう 出力したいデータ　期間2013-08-01～2013-08-10 2013-08-01　　ああああ 2013-08-02 2013-08-03　　いいいい 2013-08-04 2013-08-05 2013-08-06　　うううう 2013-08-07 2013-08-08 2013-08-09 2013-08-10 上記のような形で出力したいのですが、 どのようにすればいいのでしょうか http://bitstar.jp/blog/?p=2468 のように別のテーブルを用意する以外のやり方でお願いします。 よろしくお願いいたします。
宜しくお願い致します。 本社（大阪：50名）、拠点（兵庫：30名）、拠点（東京：20名）で ベストエフォート１００ＭのＩＰ－ＶＰＮを使用しております。 受注管理システムはSQL Server2005とVB.NETの構成で SQL Serverは本社（大阪）にあります。 パッケージではなく自社向けに委託開発したものです。 この状態で業務システムを利用するにあたり 各拠点（兵庫、東京）での受注管理システムのレスポンスが本社（大阪）とを比較するとかなり遅いという不具合報告が挙がりました。 処理によって違いはありますが 本社で数秒の処理が拠点では数十秒（倍以上）かかるとのことでした。 （顧客検索や受注登録に本社で処理するより時間がかかる） このため、対策としてネットワークを太く安定するようにしようという案が出ました。 ＶＰＮをベストエフォートではなくギャランティ（本社１００Ｍ、拠点５０Ｍ）に変更する改善案です。 しかしながら打合せが進むにつれ、 ＶＰＮの改善だけでは期待する効果（本社並のレスポンス）は約束できないという話になってきました。 効果は出ると思うがLANで使用するレスポンスは保障できない。 理由としてSQLがWAN越えに対応していないためとＶＰＮの業者さんは言っています。 （SQLは、WAN越えの場合に遅延し易いとのこと。やってみないとわからないとＶＰＮ業者さん） そんな中、現状のシステムのレスポンスを改善するにはＶＰＮの変更と併せて 下記1～4の改善候補が挙がっています。 1.業務システムをターミナルサーバーにより運用する （良いと思いますが費用が高そうです。また現状の業務システムをそのまま使用できるかが気になります。業務システムに手を加えなくても対応可能だとうれしい。効果が確実なら候補として検討したい） 2.Ｗｅｂ系のシステムに業務システムをリプレースする （良いと思いますが、VB.netのシステムをASP.net等で開発し直さないといけなくなる。効果が確実なら候補として検討したい） 3.メタフレーム 1と同じようなシステムでしょうか？ 4.SQL Serverを各拠点に立て、ミラーリングする （マスタや採番は一元化管理が必要です。データの整合性を保つのが困難な印象で、 4より1か2か3の方が良いシステム構成かと思います） 1～3はたくさんのデータにアクセスするよりも、 データを持っているサーバーで処理させて画面を飛ばした方が効果的という考え方かと思います。 大きな企業さんは1～3が多いと思いますが、お付き合いが無くわかりません。 （現状システムを２年前に開発してくれた委託開発先のベンダーさんも相談しましたが、今回のような課題解決の実績は無く、目標とするレスポンスを実現する提案をいただくことは難しいとのこと。 現状システム構築時はWAN越えでの拠点使用もできるようにはしていたがレスポンスまでは深く考えられていなかったようです。ＤＢ一元化の効果はあるので統合前に戻すことは考えていません） 長くなりすみません。 質問ですが、弊社のようなＶＰＮ越しの拠点間の運用で 各拠点のレスポンスを本社と同等に早くしたい場合には どのような課題解決が良いでしょうか？ 弊社にマッチする具体的な改善案とそれにかかるおおまかな費用感、難易度も併せて教えて頂けるとありがたいです。 宜しくお願い致します。
SQL初心者です。 教えてください。 A表とB表があります。 A表の伝票Noの列の値とB表の伝票Noの列の値はイコールです。 判定はB表のある別のカラム(sample)と変数Zに格納されている値がイコールという 条件で合致するA表のデータを抽出したいです。 LEFT JOINもしくはINNER JOINなどを使って書けば良いのでしょうか？ 例えば SELECT * from A表 INNERJOIN B表 on A表.伝票No = B表.伝票No where B表.sample = 変数Z などと書けば良いのでしょうか？
SQLサーバ初心者です。 わからないことがあり、ご存知の方いらっしゃいましたらご教示ください。 SQLサーバ2008 を使用しています。 SQLサーバのデータベース名の一覧を取得する方法として、 sys.databasesをselectしたり、sp_databasesを使用してDB名を取得できることは確認できたのですが、 master/msdbなどのシステムデータベース以外の自分で作成したユーザーデータベースのみリストする方法があればご教示いただけないでしょうか？
現在、一人でAccessを使用しデータを管理しておりますが 今後複数の人でデータを共有する事となるため、SQLのサーバーへの移行を考えております。 そこで知識の乏しい私ではなく、詳しい方へお伺いしたく思い投稿しました。 よろしくお願いいたします。 現在の環境は Windows7 64bit Access2010 でして、この環境から レンタルしてあるサーバー（お名前.com）へAccess2010でDBにリンクさせ Access2010で通常通り操作 したく思っております。 いろいろ調べたところ、 SQL Azure と言うのが一般的には良い方法と記事を読みましたが （http://www.publickey1.jp/blog/10/access_2010odbcsql_azure.html　等） 現在レンタルしてあるサーバーでもMySQLが利用できるため、新しく契約するのも経費の無駄かと思いますし、一体に出来るのであればしたいと思います。 出来るかどうかがまずわかりませんので 出来るのであれば一から教えていただく形ではなく、情報サイトへでも ご誘導いただければと思っております。 出来ない若しくは不具合等が多い様でしたら 別の方法をご教授いただければ幸いです。 どうぞよろしくお願いいたします。
お世話になります。 SQL Server 2005 SQL Server 2008 両方のデータを見たいのですが、１台のサーバーに両方のSQL Server をインストールした際に、 クライアントからの接続文字列というのはどのようになるのでしょうか？ 同じサーバーですし、インスタンス作る云々という記事を見たのですが、実際どのようにすればいいのか、どのように接続文字列を作成するのかがわかりません。 簡単でかまいませんので、この辺りをご説明していただけますよう、 よろしくお願い申し上げます。
自社開発の販売管理システムを客先の既存のPCへインストールしようとしています。SQL SERVER2008 WORKGROUP + ACCESS2010のシステムですが、客先のPCには、既にSQL SERVER2008がインストール済でした。自社のベータベースをアタッチして使わせてもらえば、何の問題もないと思うのですが、もしダメと言われたら、別途インストールは可能でしょうか？ 既にインストール済は、会計ソフトです。開発元に確認してないですが、既存のデータベースを使わせてもらうとデータの中身まで見れてしまうので、たぶんダメで言われそうなので出来れば別途インストールするのが良いと思います。 よろしくお願いします。
仕事でSQLをかじることになりました。 ずっとAccessで完結するくらいのデータ量の仕事しかしたことがなく、SQLは全くの初心者です。 そもそもオラクルとMySQLとかSQLサーバーとかの違いも、ウロっとしかわからないくらいです。 環境は SQLサーバー、WIN7、使っているのはmicrosoft sql server 2008 management studio　と　黒猫。 （他にこっちの方がお勧めです、と言うのがあれば教えてください！） 自分のスペックは タグ打ちHTMLから始め、スタイルシートが出てきたあたりで挫折 Javaスクリプトは画面に時刻表示するだけに1日を費やし（もちろん途中放棄） PHPはフリーのを持ってきて、表示をちょっと変えてHTMLに乗せれる程度 パールとルビーは「ポケモンですか？」と聞いて、ややウケしました！ CとC+って一緒？名前は似てるよねぇ。 ってかAccess VBAなら・・・いや、レコードセットあたりから先はちょっと・・・うーん。 くらいです。 書き換え出来ちゃうのが危ないからか、そもそもデータ量が多すぎて×なのか、 一番得意なAccessはダメとの事でSQLからデータを取り出してExcelで統計出す為のものです。 （office　は　2010です） 見よう見まねでselectするものの ・なんで数量倍になってるの？もしかして2回読んでる？　（ ಠωಠ） ・selectの中にfromが入れ子構造とかもう分からん　(ヽ´ω`) ・なんでオーバーフロー？！　もしかして、0で割ったからですか？　(-"-) ・int型はキライ～　then '○'　とか　then　'×'　とか付けさせて　(+_+) ・ってか、リレーションがビジュアルで見れないのはなぜ？　( ；´Д｀) ・ワイルドカードが何故入らない？！と思ったら、ずっと*にしてたよ・・・%だったね　(・ω・｀) ・inner　と　left　と、こっちは何joinだっけ？って、ドコまでやったっけ？？？　(@_@) ・そしていたるところに散らばる　/* */と--で区切られた自分メモの嵐・・・ という状態です。 初心者すぎて、お手上げとは言わず、なんとか学習出来そうなお勧め本あるでしょうか。 本屋さんで探してみたのですが、まったくチンプンカンプンなものすごく高度なものか、 簡単だけど3行くらいのコードしか乗ってないものしか見つかりませんでした。 今、使っているのは　『現場で使えるSQL 』　という本です。 分かりやすいですが、もうちょっと複雑になるときは？というので、そこまで高度じゃないよ。というくらいのを探しています。 そもそもサーバーとかDBとかの仕組み、分かってるの？そっから始めろよ！ と、お叱りを受けそうですが、業務で切羽詰まってるので、とりあえず ちゃんとデータ抽出できるようになりたい！！！です。 よろしくお願いします。
教えてください。 MSSQLサーバーのテーブルで最新でInsertした直後に、そのレコードを削除して、 再度Insertした時のIDENTITY列の値はその前にInsertした時に使用された値が 再度使われるのでしょうか？ それとも、一度使われた値は次回以降使わないのでしょうか？ SQLサーバの管理画面にどちらかを選択できる設定があるのでしょうか？ よろしくお願いします。
win764bitです。 SQLサーバー２００８をインストールしようとすると、 **************************************************** アプリケーションのコンポーネントで、 ハンドルされていない例外が発生しました。 続行をクリックすると、アプリケーションはこのエラーを無視し、 続行しようとします。 終了をクリックすると、アプリケーションは直ちに終了します。 ************** 例外テキスト ************** System.Configuration.ConfigurationErrorsException: userSettings/Microsoft.SqlServer.Configuration.LandingPage.Properties.Settings のための構成セクション ハンドラを作成中にエラーが発生しました。: ファイルまたはアセンブリ 'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'、またはその依存関係の 1 つが読み込めませんでした。指定されたファイルが見つかりません。 (C:\Users\1\AppData\Local\Microsoft_Corporation\LandingPage.exe_StrongName_ryspccglaxmt4nhllj5z3thycltsvyyx\10.0.0.0\user.config line 5) ---> System.IO.FileNotFoundException: ファイルまたはアセンブリ 'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'、またはその依存関係の 1 つが読み込めませんでした。指定されたファイルが見つかりません。 ファイル名 'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' です。 場所 System.Configuration.TypeUtil.GetTypeWithReflectionPermission(IInternalConfigHost host, String typeString, Boolean throwOnError) 場所 System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.Init(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord) 場所 System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.InitWithRestrictedPermissions(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord) 場所 System.Configuration.RuntimeConfigurationRecord.CreateSectionFactory(FactoryRecord factoryRecord) 場所 System.Configuration.BaseConfigurationRecord.FindAndEnsureFactoryRecord(String configKey, Boolean& isRootDeclaredHere) 警告: アセンブリ バインドのログ記録がオフにされています。 アセンブリ バインドのエラー ログを有効にするには、レジストリ値 [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) を 1 に設定してください。 注意: アセンブリ バインドのエラー ログに関連するパフォーマンス ペナルティがあります。 この機能をオフにするには、レジストリ値 [HKLM\Software\Microsoft\Fusion!EnableLog] を削除します。 --- 内部例外スタック トレースの終わり --- 場所 System.Configuration.BaseConfigurationRecord.FindAndEnsureFactoryRecord(String configKey, Boolean& isRootDeclaredHere) 場所 System.Configuration.BaseConfigurationRecord.GetSectionRecursive(String configKey, Boolean getLkg, Boolean checkPermission, Boolean getRuntimeObject, Boolean requestIsHere, Object& result, Object& resultRuntimeObject) 場所 System.Configuration.BaseConfigurationRecord.GetSection(String configKey) 場所 System.Configuration.ClientConfigurationSystem.System.Configuration.Internal.IInternalConfigSystem.GetSection(String sectionName) 場所 System.Configuration.ConfigurationManager.GetSection(String sectionName) 場所 System.Configuration.ClientSettingsStore.ReadSettings(String sectionName, Boolean isUserScoped) 場所 System.Configuration.LocalFileSettingsProvider.GetPropertyValues(SettingsContext context, SettingsPropertyCollection properties) 場所 System.Configuration.SettingsBase.GetPropertiesFromProvider(SettingsProvider provider) 場所 System.Configuration.SettingsBase.GetPropertyValueByName(String propertyName) 場所 System.Configuration.SettingsBase.get_Item(String propertyName) 場所 System.Configuration.ApplicationSettingsBase.GetPropertyValue(String propertyName) 場所 System.Configuration.ApplicationSettingsBase.get_Item(String propertyName) 場所 Microsoft.SqlServer.Configuration.LandingPage.LandingPageForm.OnLoad(EventArgs e) 場所 System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible) 場所 System.Windows.Forms.Control.CreateControl() 場所 System.Windows.Forms.Control.WmShowWindow(Message& m) 場所 System.Windows.Forms.Control.WndProc(Message& m) 場所 System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) 場所 System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) **************************************************** と言うエラーが表示されます。 続行してインストールしようとすると、最終的にエラーになり インストールできません。 Microsoft.NET　Frameworkは4と4.5しかインストールされてない状態です。 SQLServer2008SP1-KB968369-IA64-JPN.exe SQLManagementStudio_x64_JPN.exe SQLEXPR_x64_JPN.exe これら全部同じエラーが出ます。
win764bitにMicrosoft SQL Server 2008をインストールしたいです。 現在は SQL Server インストール センター (64 ビット) がインストールされている状態です。 SQL Server インストール センター (64 ビット)をクリックし、 インストール センターを開き、 「SQL Server の新規スタンドアロン インストールまたは既存のインストールへの機能の追加」をクリックしたのですが 「SQL Server 2008インストールメディアの参照」と出て、 ローカルディスク（C）のまま、OKを押すと 無効なインストールフォルダです。 となってしまうのですが、 どのフォルダならインストールできるのでしょうか？ それとも何かＣＤ－Ｒが必要なのでしょうか？
ASP.NETからSQLServerにアクセスしようとすると、ログイン画面が表示されてしまいます。 今まで、問題なく運用出来ていましたが、新たにデータベースにテーブルを追加し、それにアクセスする処理を実行したところ、ログイン画面が表示されてしまいました。実施した手順は、以下の通りです。 ノートPC（開発機）のMicrosoft Visual Web Developer 2005でデータベースのテーブルを新規追加し、プログラムを検証したところ問題なかったので、プログラムを本番機(サーバ）にコピーし検証しようと思い、サーバ側でSQL Server Management Express 2005を用いてテーブルを新規追加して検証したところ、ログイン画面が表示されてしまいました。 実施した手順 １．ASP.NETのプログラム内で、新しいテーブルを参照する処理を追加。 ２．ノートPC（開発機）内のMicrosoft Visual Web Developer 2005でテーブルを新規追加し、プログラムを検証。問題なくアクセスできた。 ３．ノートPC（開発機）から本番機サーバにプログラムをコピー。 ４．本番機サーバのSQL Server Management Express 2005でテーブルを新規追加。 ５．本番機でプログラムを実行したところ、ログイン画面が表示されてしまった。 補足：従来のテーブルはsa認証なので、同様にsa認証でテーブルを追加。 データベース：SQLServer2005 OS：WindowsServer2003 SD SP2 このような場合は、どのように対応したら良いのでしょうか？ ご存知の方いらっしゃいましたら、ご教授願います。 よろしくお願いいたします。
SELECT のWHEREに別のSELECTの結果を当てはめることは可能でしょうか？ ただし、引用テーブルは同じテーブルとします。（DDD） 例 SELECT * FROM DDD WHERE B = (SELECT B FROM DDD WHERE C=1) 再起SQLとはまた違うのでしょうか？
SQL Server 2008 R2 Enterpriseのキーを持っています。 サーバ機(x64)にインストールして、Win7のクライアント10台から利用する事を前提にしています。 1.メディアが無いのですが、評価版を利用して製品化できるそうです。 　クライアント機へもインストールできるのでしょうか？ 2.CALが無いと、サーバー機だけでも使用することができませんか？ （製品版化すると幾つかCALが付いているとか） 3.デバイスCALを用意しようと思いますが、CAL数は10個を購入すれば良いのですか？
こんにちは！ PC環境は、Windows XP SP3です。SQL Server 2008 R Expressが入っています。 「ひと目で分かる Visual C#アプリケーション開発入門」という本を買ってきて勉強をしようと思っています。 サーバーエクスプローラーから新しいSQL Serverデータベースの作成を選択したら添付のような画面が出てきました。 ここに「サーバー名」という項目があります。この中に、「ABC\SQLEXPRESS」や「S120」などがあります。 質問１： サーバー名とは何でしょうか？サーバー名というからには、SQL Serverを実行しているホスト名だと思うのですが、サーバー名を見ると４つくらいサーバー名が最初から登録されています。これは何でしょうか？また削除することはできるのでしょうか？ 質問２： １年くらい前に同じ勉強をしてデータベースまで既に作っています。その時つくったのが、「「ABC\SQLEXPRESS」、データベース名「TaskManage」でした。同じ名前のデータベースを作ろうとすると、既にデータベースがあるので作れませんと表示されてしまいます。 勉強の為に、再度データベースをつくりなおしたいのですが、過去に作ったデータベースはどのように削除すればよいでしょうか？ 以上、宜しくお願い致します！！
こんにちは。昔、yayoi会計というソフトウェア体験版をインストールしたことがあります。その時に、SQL Server 2008もインストールされました。 Windows XPのサービスを見ると、「SQL Server(YAYOI)」、「SQL Server Agent(YAYOI)」なるものが残っています。現在は弥生会計は削除されていてサービスも停止しています。 不要なので、サービル(ローカル)から削除したいと思っていますが、どのようにすればサービスが削除できるでしょうか？
windows7 64bit sql server 2012 expressをつかっています。 select YEAR("日付") as yere,MONTH("日付") as month,収支名,sum("金額")as kin from 収支 group by YEAR("日付"),MONTH("日付"),収支名 を実行して、 yeremonth　収支名　ｋin 20136支出13011 20136収入33500 20137支出20000 20137収入70000 と、なりましたが、同じ年、月の収支と支出を求める表を得るにはどうしたらよいでしょうか？ yeremonth　差 2013 6 -24089 2013 7 50000 のような感じです。 （もとのテーブルはこれです） id日付収支名項目金額 12013-06-16収入給料15000 22013-06-16支出ガス代555 ．．．．．． 宜しくお願いします。
テーブルのおインデックス項目はSELECTすると検索が早いのですが、 インデックスではない項目をWHEREすると時間がかかります。 そこでテーブルカラム全部をインデックス化することでの メリット、デメリットは何でしょうか？
SQL Server 2005 Express Edition Service Pack 4をWindows8(64bit)が入ったPCにインストールしようとしています。 32bitと64bitの両方がサポートされたSQLEXPR_JPN.EXEをダウンロードし、インストールを実行すると、64bitマシンなのに、なぜかデータベースサービス等全てProgram Files (x86)配下にインストールされます。 以前、同じくWindows8(64bit)が入っている別マシンにSQL Server 2005 Expressをインストールしたことがありますが、その時はProgram Files配下にインストールされ、64bitとして認識されたようです。 ちなみに、SQL Serve 2008、2008 R2、2012等は、きちんと64bitとしてインストールされております。 64bitのみのインストーラーや、64bitとしてインストールというインストールオプションがあれば良いのですが・・・ 同じ64bitのWindows8にインストールしようとしているのに、なぜ、このような違いがあるのかわかりません。 どなたか、正常に64bitとしてインストールできる方法をご存知であれば教えてください。
delete from table1 where id = 1; delete from table1 where id = 2; delete from table1 where id = 3; もしくは、 delete from table1 where (id = 1) or (id = 2) or (id = 1) という具合のSQLを実行します。 条件は大体20万件程度です。 こちらを実行するとかなり遅いので、 なんとか一括で早く実行する方法はないものでしょうか？ 今のところ、プログラムの都合上、プロシージャの中で行なってます。 PROCEDURE UPDATE(@DELSQL nvarchar(max)) EXEC (@DELSQL) @DELSQLに上記SQLが入ります。 大量のINSERTの時は、BULK INSERTのようなやり方があり、 回避できたのですが、困ってます。 どうかよろしくお願いします。
DB初心者です。 ODBCからSQLサーバーへのアクセスを設定したく、奮闘しておりますが うまくいかず困っております。 先方から支給されたのは、 DB名、ID、パスワード、ホスト名、ポート番号、MySQLのバージョン5.0.90で、 その通り設定したつもりが、以下のようなエラーが出てソース作成できません。 --- 接続できませんでした。： SQLState: '01000' SQL Server エラー: 11001 [Microsoft][ODBC SQL Server Driver][TCP/IP Sockets]ConnectionOpen(Connect()). 接続できませんでした。： SQLState: '08001' SQL Server エラー: 6 [Microsoft][ODBC SQL Server Driver][TCP/IPSockets]指定された SQL Server が見つかりません。 --- エラー番号で検索してみても原因がわからず・・・ 詳しい方いらっしゃいましたらお願いいたしますm(__)m
@jouken int @sql varchar(MAX) @select varchar(MAX) @where varchar(MAX) set @select = 'select * from table1' set @where = ' where case when @jouken = 0 then 'field1 = 1' when @jouken = 1 then 'field1 = 1 or field2 = 1' when @jouken = 2 then 'field1 = 1 or field2 = 1 or field3 = 1' end ' set @sql=@select+@where exec(@sql) 上記のような文字列の組み合わせでの作成でやりたいことはできたのですが、 こちらを直接SQLの中でやりたいのです。 以下の文は機能しません。 select * from table1 where case when @jouken = 0 then field1 = 1 when @jouken = 1 then field1 = 1 or field2 = 1 when @jouken = 2 then field1 = 1 or field2 = 1 or field3 = 1 end ご教授の程、よろしくお願い致します
自宅のパソコンでSQLServerをインストールし、 それにデータベース・テーブルなどを作成し、VisuualStudioでC#/ASP.NETのアプリを開発しています。 今回、データベースのマスタをメンテナンスするツールをAccessで作成したいので ODBC接続の設定を行い、 Access側からリンクテーブルでSQLServerのテーブルを参照したいのですが SQLServverで作成したテーブルが一覧に一切表示できず、何かシステムテーブルのようなものだけが表示されます。 会社では上記のことが問題なく行えました。 会社で違うのは、SQLServerは別のサーバーマシン内にある点です。 自宅の場合、データベースサーバーも同じパソコンのため上手くいかないのでしょうか。 自宅でも効率よく作業したいので同じように環境構築したいのです。 何か、原因等わかる方がおられましたら ご教授願います。
SQLで テーブルAとテーブルBがあり、 AとBの構造はほぼ同じとします。 Selectで引用する際に、 seelct * from (A + B) みたいなAとBをくっつけて、 あるカラムをOrderByしたいと思っております。 いったんTempテーブルなどに落とし込むなども考えましたが、 スマートではなく、時間もかかることなので、 １クエリで取得することは可能でしょうか？
お忙しいところ恐れ入ります。どう抜けばよいのか分からずご質問させていただきます。 環境：Windows 2008 server & SQL2008Server std sp2 以下のtblがあるとします。id(var), product(var), price(int)とします。 id, product, price A, オレンジ, 1000 A, レモン, 2000 A, レモン, -2000 B, バナナ, 1500 B, バナナ, -1500 B, りんご, 3000 B, グレープ, 2000 C, 梅干し, 1000 C, 抹茶, 2000 以下のようなtblを作りたいと思います。 id, product, price A, オレンジ, 1000 B, りんご, 3000 B, グレープ, 2000 C, 梅干し, 1000 C, 抹茶, 2000 以下のようにマイナスとなっているIDごとのペアを削除したいのです。 A, レモン, 2000 A, レモン, -2000 B, バナナ, 1500 B, バナナ, -1500 条件：上記の例で示しますとマイナスのついたレコードがあった場合、その上は必ず同じ id, product, プラスの金額であります。 なるべくdeleteを用いずにselectでしたいと考えてましたが、力不足でわかりません。 何卒、よろしくお願い申し上げます。
ＳＱＬ Serverを勉強中です。 以下のようなテーブルに、同一の日付に複数の名称・値のセットが存在します。 Date(日付)　 Name（名称） Value(値) 20130101　　　　　 a 　　　　　10 20130101 　　　　　b 　　　　　20 20130101 　　　　　c 　　　　　30 20130202 　　　　　a 　　　　　5 20130202 　　　　　b 　　　　　10 20130202 　　　　　c 　　　　　15 このデータを、ＳＱＬのＳＥＬＥＣＴ文で取得し、以下のような表を作りたいと考えています。 a b c 20130101102030 2013020251015 行が日付、列が名称になっています。 このように取得できるSQL文を教えてください。よろしくお願いします。
SQLServer2008でpublicというデータベースロールに権限を与えたいのですが、下記を一個一個実行するといけるのですが、連続して実行はできません。 USE master; GRANT CREATE TABLE TO public; GRANT CREATE VIEW TO public; 権限もDBもたくさんあるので、これを一々一個一個実行していくのは得策ではありません。ほかのSQLは連続実行できるのに、なぜこれだけできないでしょうか。方法教えてください。お願いします。
Winows 7 Homeで SQL SERVER 2012 EXPRESS EDITIONを使用しています。 フィールド数は60程度のテーブルに 30,000件程度のInsert文を発行したところ、 「このクエリを実行するには、リソース プール 'internal' のシステム メモリが不足しています。」 というメッセージが出力され、処理が完了しませんでした。 どれくらいだったら、いけるか計測したところ、16,000件までは完了するのですが、 以降は同様のメッセージが出力されます。 クエリは下の文のような具合です。 INSERT INTO table1 (aa,bb,cc..) VALUES('あいう','かくく','さしす'); こちらのURLのように http://www.junmt.info/article.php/20100926164914963 INSERT INTO table1 (aa,bb,cc..) VALUES('あいう','かくく','さしす') ; とやってみましたが、ダメでした。 最大90,000件程度あるので、すごく困っています。 おわかりになる方どうか解決法を教えて下さい。
SQL server 2012のライセンスとEditionに関する質問です。 Windows7のマシンをデータベースサーバとし、Windows7のマシン2台を クライアントとして使用する小規模なシステムを構築しようとしています。 Windows7マシンはCPUがCoreTM i5-3470程度の今時の法人用モデルの ＰＣを3台とも使用します。 また、SQL server 2012はStandard Editionの使用を予定しております。 そこで質問ですが、 ・この場合、どの製品を購入するのが安価で済ませられるのでしょうか？ サーバーライセンス×1とＣＡＬ×2でいいのでしょうか？ ・稼動後、もし、データベースサーバが、Windows server 2008R2(2CPU)と なった場合、Windows7のサーバライセンスをアンインストールし、新しい サーバにインストールし直せば使用できるのでしょうか？ それとも、サーバライセンスの追加購入かコアパックの購入が必要でしょうか？ ・データベースをSQL server 2008R2で使用したい場合、購入するディスクキットを SQL server 2008R2用を購入すれば、SQL server 2008R2 Standard Edition として、使用できるのですか？ 以上、よろしくお願い致します。
お世話になります。 下記、置換前のSELECT結果を 置換後のようにしたいですが、 方法が考え付きません。 できればSQL(ストアド）のみで実行したいのですが スキル不足です。 お手数ですが、ご教授頂きたく宜しくお願い致します。 条件は、B_NOの”N002"が同一のバッチでハイフン以降が 枝番で、その数は、固定では、なくNです。 "N002"のグループ内に"N"が存在したら"P"に置換したいです。 OS:WIN 2003SERVER DB:SQL SERVER2000 SP4 置換前 REC_NO,B_NO,TYPE R001,N001-1,P R002,N001-2,P R003,N002-1,N R004,N002-2,N R005,N002-3,P R006,N003-1,N R007,N003-2,P R008,N004-1,N R009,N004-1,N 置換後 REC_NO,B_NO,TYPE R001,N001-1,P R002,N001-2,P R003,N002-1,P R004,N002-2,P R005,N002-3,P R006,N003-1,P R007,N003-2,P R008,N004-1,N R009,N004-1,N
SQL Server(すみませんバージョンが分かりません) をVBから使っています。select やupdateのSQLアクセス を指定時間でタイムアウトさせ、できれば指定回数試行 した上でリターンさせる方法はないでしょうか？ 自前のリトライ機構を実装するのは今さらかなりインパ クト大な状況でして。。 宜しくお願いいたします。
来月の基本情報技術者を受けるためにデーターベースの勉強をしています。 SQLを理解しようとしているのですがなかなか上手くいきません、 最初のほうでFROMに書いてある列を結合しているのはわかるのですがその後にもう一回SELECTとかがもう一回出てくるともう理解できない感じになってしまいます なんかコツとかありませんか？ あとANDだったら「～かつ」みたいな感じで解釈すると思うんですけど、GROUP BYとその後にHAVINGとか書いてあったらなんて解釈すれば上手く理解できますか？
ADO.NETでsdfファイルからmdbファイルへテーブル（TBL1)を移行させたいと思っています。 以下のようなコードでDataSetをコピーできないか試しましたが、移行できません。 sdf、mdbともテーブルのカラムの構造は同一です。 mdbの方にはレコードが空のテーブルが用意してあります。 何が間違っているのでしょうか？お教えいただけると助かります。 SDF Dim con As SqlCeConnection = DBUtility.GetConnection() con.Open() Dim strSQL As String strSQL = "select * from TBL1" Dim adapter As SqlCeDataAdapter = _ New SqlCeDataAdapter(New SqlCeCommand(strSQL, con)) con.Close() Dim ds1 As DataSet = New DataSet() adapter.Fill(ds1, "TBL1") Dim con2 As OleDbConnection = DBUtility.GetOLEConnection() con2.Open() 'MDB Dim strSQL2 As String strSQL2 = "select * from TBL1" Dim adapter2 As OleDbDataAdapter = _ New OleDbDataAdapter(New OleDbCommand(strSQL2, con2)) Dim ds2 As DataSet = New DataSet() ds2 = ds1.Copy Dim cb As OleDbCommandBuilder = New OleDbCommandBuilder(adapter2) adapter2.Update(ds2, "TBL1")
一人でアクセスを使っているのですが SQLサーバーに移行するメリットはありますか？ レコード数は５万件くらいです。
SQLServer2008 R2　をメンテナンスプランでバックアップする方法について、ご教授ください。 やりたいこと １）毎日完全バックアップを取得 ２）バックアップはすべて別ファイルにしたい ３）数日後たったバックアップファイルは削除したい ３）については、メンテナンスのクリーンアップタスクでできそうですが、 ２）がどのように設定するのかがよくわかりません。 データベースのバックアップタスク　により、 　(1)バックアップの種類：完全 　(2)データベース：特定のデータベース（とりたいDBを選択） 　(3)バックアップの有効期限（設定しなくてよい？） 　(4)バックアップ先：ディスク 　(5)すべてのデータベースにバクアップファイルを作成する。 　　　にチェックを入れると、勝手にファイル名が日付で作成されるようです。 上記のまま「OK」をすると、デザイン画面には「既存データに追加」と表示されています。 この設定で、毎日別のファイルができるでしょうか。 有効期限を設定しておいたほうがよいのでしょうか。 いろいろ調べてみたのですが、どうもやりたいこととぴったりマッチするものがなく、こちらに質問させていただきました。 有効期限、追加・上書き　あたりの関係がよくわかっておりません。 やってみればいいのですが、あまり時間がなく「数日」の確認を数パターンとることができないので、よろしくお願いします。
いつもお世話になっております。 早速ですが、 TableA ID 時間 1 10 3 20 TableB ID 名称 1 TEST1 2 TEST2 3 TEST3 上記の２つのテーブルを組み合わせて Table3 ID 名称　　時間 1 TEST1　　10 2 TEST2 3 TEST3　　20 と表示させていと思っております。 ID 名称　　時間 1 TEST1　　10 3 TEST3　　20 とは表示させることが出来るのですが、時間が入力されていない項目を表示させることが出来ません。 どのようなＳＱＬ文を書けば思い通りの表示をさせることが出来るのでしょうか？ 使用ソフトは SqlServer2008R2です。 宜しくお願いいたします。
今年の春にある基本情報技術者を受けようと思っています。 前回落ちた経験があるので今回は比較的点数がとりやすいと勧められたデータベースの問題を解いてみよと思いました。 しかしいざやってみると結構難しいです。選択肢の中の2つぐらいには絞れるのですがそっからミスるような感じです。 データベースのSELECT文やその他の文を読む際のコツなどがありましたら教えてください。
Visual Studio2010の勉強をし始めました。データソースの変更についてお教え願います。 データソースの変更に、 ■Microsoft SQL Server ■Microsoft SQL Serverデータベースファイル 二つあります。この二つは何が違うのでしょうか？ 説明も書いてありますが、イマイチわかりません。 ネット検索もしましたが、見つけることができませんでした。 平たく、簡単に言うとどういったことでしょうか？ 宜しくお願い致します。
添付画像のようなデータがあって、赤字のところだけ出力したいと 思っています。 グループIDごとに、一番個数が大きいもの（同じ個数の場合、個別IDが 若いもの）を出したいのです。 （順位はグループごとにふられているので、グループごと同じです） 個数が同じデータがあるもので、単純にMAXのものを…とするのも 難しそうで困っています。 ご教授いただけないでしょうか。
SQL Serverのデータ格納場所 Visual Studioを勉強しだしました。データベースのところで、mdfファイル、ndfファイルという言葉が出てきました。 ネットで色々調べていますが、いまいちわからないのでお教えください。 参考にしたURL: http://itpro.nikkeibp.co.jp/article/COLUMN/20070201/260338/ ■mdfファイルとはSQL Server Express Editionのデータベースデータファイルとあります。 Express Editionではない、SQL Server 2012 Standardなどのデータベースは違う拡張子のデータベースファイルになるのでしょうか？ もしそうなら、何故Express Edtionと有料バージョンではデータの持ち方が違うのでしょうか？ ■mdfファイルを違うパソコンで開きたいとします。Accessみたいに、ファイルをコピーして別PCに持って行けばファイルはひらけるものなのでしょうか？ ■mdfファイルのデータをAccessにインポートできるのもなのでしょうか？ 当方、Accessがわかる程度で、その他のデータベース関連のソフトウェアはさわったこともありません・・・ 宜しくお願い致します。
サーバのSqlServerのデータをCSVにエクスポートしたいのですが、うまくいきません。 管理者権限だと動きますが、一般ユーザーでEXEC xp_cmdshell"bcp・・・"だとセキュリティでひっかかり動作しません、セキュリティの設定に関する資料も少なく、どなたかご教授願えませんか。 またほかの方法でもいいんです、クライアントはC#とVBのみです。sqlcmdやbcpなどは一切ありません。ですので、すべてをできればサーバ側で行いたいのです。お願いします。
SQLServer2005について。 データベースの中にハイフンつきの電話番号（0123-456-789）があります。 その電話番号を検索するときに、ハイフンなしの電話番号（0123456789）から 検索することは可能でしょうか？ つまり、データベース中のハイフンを無視する検索です。
初歩的な質問ですみません。 教えて頂けますでしょうか。 データベースでビューテーブルというものがありますが、 登録データが実テーブルではなく、ビューテーブルの方で保存（保持）されているということはあるのでしょうか？ テーブルのデータとデータベースの構造調査をしなければならないのですが、 実テーブルのみ調査をすれば良いのでしょうか？ ビューテーブルにもデータがありました。 宜しくお願い致します。
以下縦長に延々とある出勤テーブルをシフトテーブルのようにまとめたいのですが 方法が分かりません。ご教授願います。 出勤テーブル 山田,月 佐藤,木 山田,水 鈴木,火 佐藤,金 ・・・ ・・・ シフトテーブル 名前,月,火,水,木,金,土,日 山田, 1, , 1, , , , 佐藤, , , , 1, 1, , 鈴木, , 1, , , , , ・・・ ・・・
皆様、お知恵を拝借させてください。 現在、SQLServer + VB.netで開発を行っていますが、どうしてもうまくいかないので悩んでいます。 ロジックを組めば解決できるのは、わかっているのですが、SQL文だけで解決したいのです。 よろしくお願いします。 やりたいことは、複数テーブルからの同一IDの抽出です。 IDで単一化 テーブル【現在】を優先して抽出 テーブル【履歴】のみ存在する場合、履歴NOの大きい方を抽出 テーブル【現在】 　ID　名前　趣味 ------------------ 　10　太郎　釣り 　20　次郎　ゴルフ テーブル【履歴】 　ID　名前　趣味　履歴NO ------------------------- 　10　太郎　将棋　01 　10　太郎　囲碁　02 　30　花子　園芸　01 　30　花子　料理　02 求めたい結果は 10　太郎　釣り 20　次郎　ゴルフ 30　花子　料理 です。よろしくお願いします。
はじめまして。 ken7761227と申します。 SQL Server2008R2でデッドロックが発生しまして、本来であれば、テーブルの 参照、更新順を正しくする修正をすべきなのですが、今からその修正を行うのは 困難なために、更新する側が、使うテーブルをまずTABLOCKXでロックしておく という対策をとることになりました。 ここで、A,B二つのテーブルがあったとし、 SELECT XXX FROM dbo.TableA WITH( TABLOCKX ) UNION SELECT YYY FROM dbo.TableB WITH( TABLOCKX ) というSQLでロックしようとしています。 UNIONを用いたのは、2つのセレクトの間に違うプロセスからの割り込を 防止したかったためです。 （このSQLの実行時にトランザクションをかけて、更新後のコミットまで、 排他ロックをかけようとしています。） TableA,TableBを更新しようとしているプロセス1が、上記SQLを実行しオーナーになります。 プロセス2がTableBをSELECTしようとすると、排他ロックで待たされるはずですよね？ 実際ここは待たされていました。 また、プロセス2も更新を行おうとし、上記のSQLを実行すれば、プロセス1のコミット までは、処理が待たされるはずだと思っていたのですが、ここでデッドロックしてしまいます。 原因が全く分からずに困っております。 最終的に、やりたいことは、テーブルの参照、更新の順番を変えずに、デッドロックを 回避することです。テーブルロックをかけかたが、間違っていますでしょうか？ また、それ以外に何か良い回避方法がありますでしょうか？ どなたか、有識者の方々のご助言頂けないでしょうか。 よろしくお願いいたします。
はじめまして。 現在、私は仕事で統計を表示するためのレポートを作成中ですが、 データ取得SQLのよいアイデアが浮かびません。 わかる方がいらっしゃいましたら、お知恵を貸してください。 booking_id　　販売支店　　出身国　　　　値段　　　　車種 ---------------------------------------------- 01　　　　　　　東日本　　　ブラジル　　　100,000　　　A 02　　　　　　　東日本　　　ブラジル　　　200,000　　　A 03　　　　　　　東日本　　　ブラジル　　　300,000　　　B 04　　　　　　　東日本　　　ブラジル　　　400,000　　　C 05　　　　　　　東日本　　　日本　　　　　500,000　　　A 06　　　　　　　東日本　　　日本　　　　　600,000　　　B 07　　　　　　　西日本　　　ロシア　　　　700,000　　　B 08　　　　　　　西日本　　　ロシア　　　　800,000　　　B 09　　　　　　　西日本　　　ロシア　　　　900,000　　　B 10　　　　　　　西日本　　　韓国　　　　　100,000　　　A 11　　　　　　　西日本　　　韓国　　　　　200,000　　　B 12　　　　　　　西日本　　　韓国　　　　　300,000　　　C 13　　　　　　　西日本　　　韓国　　　　　400,000　　　C 上記のようなテーブルがある場合、販売支店と出身国でグループ化して、 それぞれの値段の合計値を出します。 その際、車種はもっとも頻出した値を表示したいのですが、 どのようにしたら実現できますでしょうか。 （最頻値が２つ以上の場合は、その中のどれかを表示する。） 期待結果は以下のようになります。 販売支店　　　出身国　　　　値段　　　車種 --------------------------------------- 　　東日本　　　ブラジル　　1000,000　　　A 　　東日本　　　日本　　　　1100,000　　　A 　　西日本　　　ロシア　　　2400,000　　　B 　　西日本　　　韓国　　　　1000,000　　　C SQL Server は、2008R2を使用しております。 以上、よろしくお願いいたします。
　こんにちは。 今、SQLの勉強をしている初心者です。 データの1～30までの件数に、NUMBER1～30を入れたいのですがどうすればいいでしょうか？ 例えば、 　　　　　　X　　　　　Y　　　　　　　NUMBER 　　　　　GHU　　　　KJI　　　　　　　　0 　　　　　HUG　　　　EER　　　　　　　0 　　　　　HUU　　　　OPI　　　　　　　　0 上記にあるNUMBERを下記のようにしたいです。 　　　　　　X　　　　　Y　　　　　　　NUMBER 　　　　　GHU　　　KJI　　　　　　　　1 　　　　　HUG　　　EER　　　　　　　　2 　　　　　HUU　　　OPI　　　　　　　　3 UPDATE文だと一列全部変わってしまいます。 どのような文を作ればいいのかよく分からないでいます。 よろしくお願いします。
お世話になります。 SQL Server での T-SQLのWhere句のパラメータがNullであった場合に これをWhere句から除外したいのですが・・・ 今まで、こういう場合には、SQL文をプログラム上で作成してそのSQL文を ソースにしてきたのですが、動作速度や汎用性を考えてストアドプロシジャーを使用するのが今後の為と思いこちらで質問させていただきました。 例えば・・・条件のところから WHERE 　　　　IF @パラメータ１ Is Not Null 　　　　　　　　(dbo.TEST.A =< @パラメータ１) AND 　　　　IF @パラメータ２ Is Not Null 　　　　　　　　(dbo.TEST.B =< @パラメータ２) AND このように記述してみたのですが、ＷＨＥＲＥが記述された後ではダメなようで・・・次に WHERE 　　　　CASE 　　　　　　　　WHEN @パラメータ１Is Not Null THEN (dbo.TEST.A = @パラメータ１) AND 　　　　　　　　WHEN @パラメータ２Is Not Null THEN (dbo.TEST.Ｂ = @パラメータ２) AND 　　　　END 上記にように記述してもやはりエラーが。 ＷＨＥＲＥ句の後にパラメータを評価し、ＷＨＥＲＥ句に含めるか、 含めないか記述するにはどうすればいいでしょうか？ 初歩的な事かもしれませんが、何卒よろしくお願いいたします。
教えてください。SQLSever初心者です。SQLサーバがインストールされているサーバのコンピュータ名を変更します。変更によって何か影響することがありますでしょうか？
2名で共有する場合もSQLServerに移行した方がよいでしょうか？ ひとつのMDBテーブルをテーブルとその他に分けて使用しています。 テーブル部分を共有フォルダに入れて使っていますが 現在は一人が使ってる時はもう一人は使わないようにしています。 今のタイミングならSQLServerに移行できる時間があるのですが2名でも移行した方が良いですか？ アクセスは複数でファイルの共有をすると壊れやすいと聞いたのですが2名でもそうでしょうか？ 今後は2名が同時にテーブルの更新などを行う予定なのですが その場合はやはりSQLServerに移行した方が良いでしょうか？ アクセスのままでもイケますか？
SQL文で Aテーブル 1 a 2 b Bテーブル 1 a null 2 a aa 3 b null 4 b bb があり、 AとBをJOINして取得したいのですが、 最終的にAテーブル一覧と、Bテーブルのaaがある項目だけをSelectしてきたいと思っております。 Select結果： 1 a 1（←aaのcountのみ） 2 b 0（←bbやnullなら０） しかし、普通にOUTER JOINして、Whereすると、 bの項目が取得できなかったり、します。 上記のようなデータを取得することは可能でしょうか？
こんにちは。 DB未経験で勉強中です！ どなたか教えてください。。 OracleのTO_DATE関数のようなことはSQL Serverでは実現可能でしょうか？ 数値型から日付型への変換です。 たとえば20121109を2012/11/09と変換、 もしくは201211を2012/11に変換するなどです。 是非、ご教授願いします。
あるテーブルで |カラム1|カラム2|カラム3| ------------------------- |AAAAAAA|1111111|CCCCCC| |AAAAAAA|2222222|BBBBBBB| |AAAAAAA|3333333|DDDDDDD| あった場合、下記のように 2～3レコード目のカラム1の 値のみを空白で取得したい 場合、どうすればよいのでしょうか？ |カラム1|カラム2|カラム3| ------------------------- |AAAAAAA|1111111|CCCCCCC| | |2222222|BBBBBBB| | |3333333|DDDDDDD|
現在このクエリを作成したのですがデータが削除されなくて、データ全件が抽出されてしまいます。 以下の構文で試したのですが・・・・もし、ご指摘、アドバイス等ございましたらよろしくお願いします。 select * from テーブル名 delete from テーブル名 where 日付 < = (select DATEADD(year,(-1),(日付))) ちなみに、日付はDATETIMEです　　 バージョン：SQL management studio 10.50.25.000
accessのテーブルのデータをSQLサーバーにテーブルリンクさせたいのですが どうやればいいでしょう？ 新しいデータベースを作って右クリックしましたがそのようなメニューは探せません。
現在SQLserver上で、、ＣＳＶを一時テーブルに保管し、ある条件に合致する行のみＴＢＬに追加するというストアドを書いています。そのＴＢＬには「datetime型」の列があります。 この作業で、２点問題が発生しています。 (1)ＣＳＶファイルから一時テーブルにデータを入れようとすると、datetime列がＮＵＬＬの場合、型の不一致でエラーが発生します。 (2)上記において、一時テーブルの型をとりあえずvarcharにしておくと入れれるのですが、ＴＢＬに追加しようとする際、「convert(datetime,変数)」としているのですが、上手くキャストしてくれません。（「文字列から日付への変換に失敗しました」のような文がでます） どのようにすれば、ＮＵＬＬでもdatetimeに入れられるのでしょうか？教えてください。
お世話になっております。 表題のテーマについて、理解いただける方にアドバイスお願いします。 会員を表すMembersというテーブル、 種別を表すTypesというテーブル、 会員と種別を結び付けるMemberTypeBindsというテーブルがあって、会員・種別がn対nで定義されています。 Membersの件数は200件ほど、Typeは20件程度。だいたいMembersは1～5くらいのTypeに紐づいています。 Table Members int ID(主キー, autoIncrement) varchar(20) MemberName Table Types int ID(主キー, autoIncrement) varchar(20) TypeName Table MemberTypeBinds int memberID(外部キー, MembersのID) int typeID(外部キー, TypesのID) これを、LINQで下記のクラスオブジェクトに抽出したいと思っています。 今は全件表示でもいいですが、そのうちページングで表示する必要がでてくると思います。 public class MemberTypes { 　public Member　member{ get; set; } 　public List<Type> types　{ get; set; } } どうやるかがわかりません。LINQはこんな感じだと思うのですが、 public List<MemberTypes> GetMemberTypes(){ 　using (var dc = new DataContext()){ 　　var result = dc.MemTypeBinds 　　　.GroupBy(mt=>mt.Member) 　　　// このあと、どうやったらいいかがわかりません。 　　　// DBから階層化オブジェクトを生成するのは 　　　// けっこう頻出のテーマだと思うので、しっかりマスターしたいです。 　　}).ToList(); 　　return result; 　} } LINQに詳しい方、お助けください。
ＳｑｌＳｅｒｖｅｒにおける、ビューとクエリについて、その違いというか、概念を教えてください。 私は、最初にＡｃｃｅｓｓと「標準ＳＱＬ」という本で、データベースを学びました。 本を読んでＡｃｃｅｓｓに向かったときに、クエリってビューのことなのかな？と思って、ずっとやってきました。 ところが、ＳｑｌＳｅｒｖｅｒには、両方の言葉が出てきます。で、とりあえず、クエリをデザイナで作ってみて、クエリにクエリを内包するようなものを作る段になって、クエリが追加できなことに気づきました。Ａｃｃｅｓｓでクエリのタブがあるところに、ビューというタブがあるので、クエリの代わりに、ビューを作りました。まったく同じ手順で作れましたが、保存するときに、「ＯｒｄｅｒＢｙ句は、ビュー定義のＴＯＰ句によって返される行を決定するためだけに使用されます。したがってクエリ自体でもＯｒｄｅｒＢｙが指定されていないと、ビューでクエリを実行したときに結果が並べ替えられ宇保証はありません。」 などと、表示されます。 ビューでクエリを実行するとは、どういう事なのでしょうか？クエリを実行するのと、ビューを実行(？)するのは、何か違うのでしょうか？
SQLserverにデータを入れる際、現在存在しているテーブルとは型があっていない列があります。 このとき、キャストをしながらインサートを同時に行いたいのですが、どのようなクエリを書けばいいかわかりません。教えてください。
access2007・Microsoft SQL Server 2012です。 アクセスからアップサイズしようとすると、 「アップサイジング ウィザードは Accessプロジェクトの接続先であるMicrosoft SQL Server のバージョンでは使用できません。 最新情報とダウンロードについては、Microsoft office　UpdateのWebサイトを参照してください。」 http://support.microsoft.com/kb/967913/ja を見たのですが、この場合は、SQL Server 2008でした。 当方は2012です。 なんでできないのでしょうか？
初心者です。 SQL SERVER 2012です。 「売上明細」テーブルに、新規行を挿入した時に、「得意先単価マスタ」を更新・または追加したい CREATE TRIGGER [dbo].[INSTEAD_OF_INSERT_ON_T_D売上明細] ON [dbo].[T_D売上明細] INSTEAD OF INSERT <<省略>> /* 得意先別単価マスタの更新 */ IF (@column_new_value$19 <> 0) BEGIN /* 得意先別単価マスタを参照する */ SET @CURSOR_PARAM_CRSTS_CRSTS_得意先コード = @column_new_value$9 SET @CURSOR_PARAM_CRSTS_CRSTS_納品先コード = @column_new_value$10 SET @CURSOR_PARAM_CRSTS_CRSTS_商品コード = @column_new_value$16 DECLARE crsTS CURSOR LOCAL SCROLL_LOCKS FOR SELECT dbo.T_M得意先別単価.作成日付, dbo.T_M得意先別単価.更新日付, dbo.T_M得意先別単価.得意先コード, dbo.T_M得意先別単価.納品先コード, dbo.T_M得意先別単価.商品コード, dbo.T_M得意先別単価.単価区分, dbo.T_M得意先別単価.売上単価1, dbo.T_M得意先別単価.売上単価2, FROM dbo.T_M得意先別単価 WHERE ((dbo.T_M得意先別単価.得意先コード = @CURSOR_PARAM_CRSTS_CRSTS_得意先コード) AND (dbo.T_M得意先別単価.納品先コード = @CURSOR_PARAM_CRSTS_CRSTS_納品先コード) AND (dbo.T_M得意先別単価.商品コード = @CURSOR_PARAM_CRSTS_CRSTS_商品コード)) OPEN crsTS FETCH NEXT FROM crsTS INTO @recTS$作成日付, @recTS$更新日付, @recTS$得意先コード, @recTS$納品先コード, @recTS$商品コード, @recTS$単価区分, @recTS$売上単価1, @recTS$売上単価2 /* 該当が有った場合は更新する */ IF (@@FETCH_STATUS = 0) IF (@column_new_value$19 = 1) UPDATE dbo.T_M得意先別単価 SET dbo.T_M得意先別単価.単価区分 = @column_new_value$19, dbo.T_M得意先別単価.売上単価1 = @column_new_value$22 WHERE CURRENT OF crsTS ELSE IF (@column_new_value$19 = 2) UPDATE dbo.T_M得意先別単価 SET dbo.T_M得意先別単価.単価区分 = @column_new_value$19, dbo.T_M得意先別単価.売上単価2 = @column_new_value$22 WHERE CURRENT OF crsTS ELSE IF (@column_new_value$19 = 1) INSERT INTO dbo.T_M得意先別単価 ( dbo.T_M得意先別単価.得意先コード, dbo.T_M得意先別単価.納品先コード, dbo.T_M得意先別単価.商品コード, dbo.T_M得意先別単価.単価区分, dbo.T_M得意先別単価.売上単価1 ) VALUES ( @column_new_value$9, @column_new_value$10, @column_new_value$16, @column_new_value$19, @column_new_value$22 ); ELSE IF (@column_new_value$19 = 2) INSERT INTO dbo.T_M得意先別単価 ( dbo.T_M得意先別単価.得意先コード, dbo.T_M得意先別単価.納品先コード, dbo.T_M得意先別単価.商品コード, dbo.T_M得意先別単価.単価区分, dbo.T_M得意先別単価.売上単価2 ) VALUES ( @column_new_value$9, @column_new_value$10, @column_new_value$16, @column_new_value$19, @column_new_value$22 ); CLOSE crsTS DEALLOCATE crsTS <<省略>> 上記のように作成してあるのですが、 すでに同一得意先・納品先・商品のマスタが存在する場合は、更新されます。 ですが、存在しない場合、新規に追加したいのですが、そこがうまく動きません。 何が原因でしょうか？
Microsoft SQL Server 2012 をインストールしたいのですが、 既定のインスタンスと名前付きインスタンスのどちらを選べばいいのでしょうか？ ＳＱＬサーバーは初心者です。
Microsoft® SQL Server® 2012 Express をインストールしたいのですが http://www.microsoft.com/ja-jp/download/details.aspx?id=29062 のどれをインストールすればいいのでしょうか？ 当方ｗｉｎ７、６４bitです。 JPN\x64\SQLEXPR_x64_JPN.exe JPN\x64\SQLEXPRADV_x64_JPN.exe JPN\x64\SQLEXPRWT_x64_JPN.exe のどれかと思うのですがわかりません。 ちなみにプログラムの一覧をみると、 画像のようにSQL Serverの一部？みたいなのが入っています。
ユーザー側で、Microsoft SQL Server2000を使用しています。 計算結果がおかしいので、仕事場で、SQL2008環境で互換モードでも、以下の現象が出てこまって おります。テストで、確認しました。 23.0 - 22.1 の計算結果を0.9と出したいのですが、 　0.899999999999999 と結果が返ってきます。 どこが間違っているのでしょうか？ SELECT [Field01] AS 'Field01' ,[Field02] AS 'Field02' ,[Field01]-[Field02] AS 'Field01-02' ,(CAST(23 AS FLOAT) - cast(22.1 AS FLOAT) ) AS 'test1' ,(CAST(23 AS REAL ) - cast(22.1 AS REAL ) ) AS 'test2' FROM [dbo].[Table01]
お世話になります。 下記ような３個のテーブルから、下記画面表示内容のようにするには、 どのようなSQLを書けばよろしいでしょうか ご教示願います。 所有者テーブル 所有者ID,所有者名 1,田中 2,鈴木 3,前田 土地テーブル 所有者ID,取得日,面積 1,11/22,100 1,11/24,30 1,11/26,150 2,4/2,45 2,12/4,120 家屋テーブル 所有者ID,取得日,延床面積 1,11/25,30 1,11/30,12 画面表示内容 所有者ID,名前,土地取得日,面積,家屋取得日,延床面積 1,田中,11/26,150,11/30,12 1,田中,11/24,30,11/25,30 1,田中,11/22,100,空白,空白 2,鈴木,12/4,120,空白,空白 2,鈴木,4/2,45,空白,空白 3,前田,空白,空白,空白,空白 よろしくお願いします。
今まで SQL Server2000 を使用していました。 OSはWinXp Proです。 今日アンインストールして、SQLServer2008 Express (SP3)をインストールしたのですが、 起動していないようなのです。 というのも SQLServer2000 の場合、ＯＳ起動すると右下に SQLServer のアイコンが表示されクリックすると起動しているのがわかったのですが、インストールした後、一度もこのアイコンが表示されません。 起動するには何か設定でも必要なのでしょうか？
現在SQLServer2000で運用しているサービスがありますが、 SQLServerでは8000バイト制限があるため、 2005か2008に変更しようと予定しています。 しかし2000→2005や 20005→2008 移行で難航したという意見が結構ききます。 コーディングを結構変更しないといけないのであれば 2000で8000バイトずつに区切ってExecuteしようと思いますが、 どれくらい移行は大変なのでしょうか？
お世話になります。 クエリAとクエリBがあり、ユニオンクエリにて両クエリを結合させたいと思っております。 しかし、クエリBにしかないフィールド（test）がある為、「列数が一致しません」となってしまいます。 このような場合、一般的にはどのようにして対処するのでしょうか。 恐らくクエリAにtestというフィールドを仮想的に？追加するのだと思いますが、やり方がわかりません。 ご教授の程、宜しくお願い致します。
C#からデータベースsql server 2008にデータセット、データリードする簡単なアプリを作りました sqlのクエリについて質問です リードしたデータのTOP行と最終行の２つのレコードを取得する場合どうすればいいでしょうか？ select TOP A,B,C From test WHERE なら　TOP行のみになってしまいます 最終行のレコードの取得方法は、いい方法が思い浮かびません。 欲しいのは、TOP行と最終行の２行のみなので、困ってしまいました。 知恵をお借り願えればと思います。 よろしくお願いいたします。
使用環境は　DB SQL Server2008 Express 使用ツールは　Microsoft SQL Server Management Studio です SQLserver2000からSQLserver2008DBへ移行しようとしているのですが ストアドプロシージャのところでうまくいきません 具体的には、処理を走らせると下記メッセージが出てきます floatをデータ型numericに変換中に、算術オーバーフローエラーが発生しました プロシージャ"○○"は、許可されていないステータスNULLを返そうとしました。 代わりにステータス0を返します 調べると　 小数点以下があるフィールド同士を掛けて、その結果の小数点以下をROUNDで切り 捨てた値を小数点のないフィールドに追加しようとするとエラーになる　 とありました。 下記　2行あたりが怪しいと思うのですが対処方法がわかりません。 ご教授願えないでしょうか？ SET @GetRand = CAST(RAND()*10 AS numeric(1,0)) … SET @GetRand = CAST(RIGHT(CONVERT(varchar,CAST(RAND()*100 AS numeric(2,0))+100),2) As numeric(2,0)) またストアドプロシージャは、VBのようにデバッグで1行単位で処理を確認してい くことはできないのでしょうか？
こんにちは。 あるテーブル"T_TABLE"に項目がC1（主キー）、C2が有り、データが以下のように登録されていた場合、 |C1|C2| ------| |BB|XX| ------| |AA|XY| ------| |DD|XZ| ------| とあった場合、 カラムC2に"XY"の値を含む行を第一に優先し、同カラムに"XZ"を含む行を第2に優先し、同カラムに"XX"を含む行を第3に優先して抽出するにはどのようにすればよいのでしょうか？ 抽出するイメージは XY XZ XZ の順です。
C#２０１０で作ったアプリ から ｓｑｌ サーバー２００８のデータベースにselect文を発行する際に困っています 検索キーワードが３つあるのですが、３つのキーワードの組み合わせでselect文を発行したいのですが、種類がたくさんできてしまい 困っています 例えば、検索キーワード A、B、Cの３つとすると、以下の組み合わせで７種類ものselect文を作るのが煩わしいです GetData(A) GetData(B) GetData(C) GetData(A,B) GetData(A,C) GetData(B,C) GetData(A,B,C) これらを１つのselect文でさばくには、どうすれば良いでしょうか？ ご指導よろしくお願いいたします
SQLServer2000とAccess2000（adpファイル）でシステムを組んでいます。 データベースとの接続は、アプリケーションの「データリンクプロパティ」内で設定してあり、初期立ち上げフォームに次のコードを記述して接続しています。 Option Compare Database Option Explicit Public cn As ADODB.Connection Sub p_接続開始() 　‘データベースとの接続を行うプロシージャ Set cn = Application.CurrentProject.Connection cn.CursorLocation = adUseClient ‘カーソルをユーザークライアントにする End Sub その後、フォームを開いた状態で一定時間経過すると、ＰＣが「システムスタンバイ」状態になり、スタンバイを解除すると次のエラーが出て接続できません。 「[DBNETLIB][ConnectionWrite(send()).]一般的なネットワークエラーです」 しかしいろいろ試した結果、フォームのクリックイベント時に、次のコードを記述したところ、一時的に接続できるようになり、入力フォーム上のデータがSQLServerに保存出来るようになりました。 Set cn = New ADODB.Connection cn.ConnectionString = Application.CurrentProject.Connection cn.Open しかしその後、このフォームを閉じたり、他のフォームに移動したりすると、「[DBNETLIB][ConnectionWrite(send()).]一般的なネットワークエラーです」が出てエラーとなります。 データベースを終了し、再度開き直すと、完全に元通りに復活しますが、上記でフォームを閉じたり、移動したときに、エラーが出ないようにするにはどうしたらいいでしょうか？ Set cn = New ADODB.Connection cn.ConnectionString = Application.CurrentProject.Connection cn.Open この記述は、試行錯誤の末、出来たものであり、これが本当に正しいかどうかわかりません。 どなたかわかる方教えてください。
Microsoft SQL Server Management Studioを使っています。 テーブル追加時にIDENTITYの設定方法は 載っていたのですが、すでにあるカラムに対して はありませんでした。 すでにあるカラムにIDENTITYの設定方法を教えて下さい。
使用環境は　DB　SQL Server2008 Express 使用ツールは　Microsoft SQL Server Management Studio です サーバーは 64bit です インストールファイルは　SQLEXPRWT_x64_JPN.exe　です 現在、同じネットワーク上には　SQLServer 2000のDBを使ったサーバーはあるので すがSQLServer2008は1台だけです 今回　SQL2008のDBを 2000の方にバックアップ用としてコピーしたいと思います ファイルの保存だけであれば可能かと思いますが　万が一の時に 接続先を変更して使えるようにしたいと思います。 認識として、 ・データファイルやログファイルは上位DBから下位DBへアタッチ操作はで きない (上位DBのファイルを下位DBがアタッチ操作できない） ・データベースコピーはできない そこで　データコピー　をしたいと思っています。 下記　HPを参考にフリーソフト(DBCopyTool.exe)を使ってみたのですが http://www.atmarkit.co.jp/fdotnet/dotnettips/859dbcopytool/dbcopytool.html サーバーの登録はうまくいくのですが、対象DBの登録について SQLServer2008express や　SQLServer2005express　はうまくいくのですが SQL2000のサーバーでは、下記メッセージが出てきます Fehler:Error getting the database.オブジェクト名'sys.database'は無効です 確認したいのは　上記フリーソフトを使われたことがある方、同じような現象には ならないかどうか 何か設定、確認不足なのでしょうか？ また当初の希望内容を実現するため、他の方法があれば　ご教授願いたいと思いま す。 同HP内の文末に、SQLServer 2000とSQL Server 2008との間でコピーが正しく行え た　とあり決して依存するわけではないのですが、もしやと思い試しているのですがうまくい きません。 仮に　2000のDBを2008にコピーできるとしても、該当DBの選択のところでエラーが 出てしまうのはクリアする必要があると思うのですが… 以上　宜しくお願い致します。
現在SQLServer2005 の WorkGroup を使用しています。 現在のPCでは処理が遅い為、新たにPCを新調し、更にSQLServer2012 Standardも購入する予定です ここで質問なのですが、 SQL2005で作成したテーブルのファイル「○○.mdf」と「○○.ldf」は SQL2012でも読み込むことは出来るのでしょうか？ もっと単純に言うと SQL2005で使ってたHDを抜いてSQL2012をインストールした新PCに繋げて アタッチすればそのままSQL2012で使うことはできるのでしょうか？
Microsoft SQL Server Management Studioを使っています。 下記のクエリを実行するとエラーが出ます。 クエリ alter table Test_table modify name nchar(20) エラー メッセージ 102、レベル 15、状態 1、行 1 'modify' 付近に不適切な構文があります。 今の状況はnchar(10)なのですが、 nchar(20)に変更したいのですが、 どうすればよろしいでしょうか？ 参考にしたURL http://www.syboos.jp/database/doc/alter-table-modify.html
使用環境は　DB　SQL Server2008 Express 使用ツールは　Microsoft SQL Server Management Studio です サーバーは 64bit です インストールファイルは　SQLEXPRWT_x64_JPN.exe　です インストール時に　既定のインスタンス名　を選択し Management Studio ツールを使って接続しようとしたのですが サーバー名￥SQLEXPRESS になってしまいます 希望する内容は　サーバー名のみ　で接続したいのです 正確には　最初、名前付きインスタンス名(SQLEXPRESS)を選択して インストールしてしまい　あとでアンインストールし　 既定のインスタンス名で再インストールしているのですが 上記内容になります。 アンインストール後　関係フォルダを削除(一時　別フォルダに保管)しました 具体的には　C:\Program Files\Microsoft SQL Server　のフォルダを 一時別のフォルダにして、再インストールしてみたのですが結果は同じでした。 ちなみに、SQLServer2005Express　では　上記フォルダを削除(移動)することで インスタンス名は付かなくて　サーバー名だけになりました。 何か不要な設定が残っているように思いますが… 確認したいのは　SQL Server2008 Express　では　インスタンス名を無しにするこ とができるのかどうか 再インストール時、削除するフォルダが足りないのかどうか 以上　宜しくお願い致します。
任意の時刻にデータをモニタリングしているシステムがあり、データがMS SQL Serverに保存されています。 int ID int DeviceID 端末番号 int DeviceValue 計測値 smalldatetime DeviceTime 日時 これを、任意の日時範囲を指定し、一日単位で集計された、端末ID、計測値の最大値という形式で取得したく思います。 計測日　端末番号　計測最大値 2012/01/01 10002 34543 2012/01/01 10003 33211 2012/01/02 10002 23450 ... ... DBが得意でないため、困っています。 どなたかお助けいただけないでしょうか？
SQL Server Compact 3.5 SP2について教えてください。 現在、SQL Server 2008R2で運用されているWebアプリケーションシステムがあります。 ASP.NETで作られており、データアクセスはLINQ for SQLで動作しています。 今回、ちょっとしたサーバ移転があり、データアクセスの頻度がさほど高くない理由から、SQL Server Compact 3.5での稼働を計画しています。 （Compact 4.0だとLINQが動作しないらしいので） で、開発環境（VS2012）にてSQL CE3.5のファイルを作ろうとしたところ、サーバエクスプローラのプロバイダ選択画面で、CE3.5も4も出てきません。 （通常のSQL Serverや、mdf形式のSQL Serverプロバイダは正しく出てきます） そこで質問なのですが、 ・SQL Server CE3.5はVisual Studio 2012に対応しているのでしょうか？ ・皆さんのVisual Studio 2012では、SQL Server CEをデータプロバイダとして、サーバエクスプローラを動作させることができますか？ よろしくお願いします。
以下のようなデータがあります。 管理番号　ステータス　受付日 502035 　　50　　　　　2012/09/28 502035 　　30　　　　　2012/09/25 502035 　　40　　　　　2012/09/30 502036 　　10　　　　　2012/09/28 502036 　　20　　　　　2012/09/30 502037 　　10　　　　　2012/09/29 上記のテーブルを管理番号でグループ化し、 ステータスの一番小さい番号の受付日を抽出したいと 考えています。 管理番号　ステータス　受付日 502035 　　30　　　　　2012/09/25 502036 　　10　　　　　2012/09/28 502037 　　10　　　　　2012/09/29 ↑求めたいSQL内容 SELECT 管理番号, Min(ステータス), 受付日 FROM ステータステーブル GROUP BY 管理番号 で行うと、受付日が異なるステータスだと 複数抽出されてしまいます。 First(受付日)　Last（受付日）にすると受付日が うまく抽出されません。 受付日をステータスが一番小さな管理番号 でグループ化し、表示することはできますでしょうか？ よろしくおねがいいたします。
SQL Server 2012 の環境でカンマ区切りでN個の要素を引数としてストアドプロシージャを実行したいのですが、可能でしょうか？（CONCAT関数のような指定方法をイメージしています。） 【呼出イメージ】 EXECUTE StoredTest N'10001', N'10002', N'10003', N'10004' ...N すみませんが、どなたかご教示いただけないでしょうか？
をしたいのですが、画像のように型変換でエラーがおきます。 変換先（DB）の型はintなのに、変換元(Excel)の型はダブルになっています。 どうすればよいかご存知のかた、ご教授よろしくお願いします。
質問させていただきます。 SQLSerever2000でSELECTの結果を返すだけのストアドプロシージャがあるのですが、複数のユーザーが同時に実行すると、単独で実行した場合に比べて処理速度が低下するという現象が起こっています。 このSELECT(のみ)同士で処理が遅くなることについて原因がわからずに困っています。 今わかっていることは (1)SQL文が非常に複雑(サブクエリの結合も多い)で対象データの件数も多い。 (2)実行時はUPDATEなどの更新処理は一切入っていない(トランザクションも張っていない)。 (3)SELECT時にWITH(NOLOCK)を使用しても結果は変わらない。 (4)分離レベルをUNCOMMITEDにしてみたが結果は変わらない。 (5)プロファイラ上で実行時デッドロックが発生していないことは確認済み (6)ほぼ同時に実行するとやたら遅く、少しタイミングをずらして実行すると、あまり影響し合わない。 (7)処理速度の遅延は同時実行ユーザーのお互いについて発生する(※片方だけが待つわけではなく、ほぼ同時に開始した処理は単独の場合と比べて長い時間をかけて同時に終了する) 以上の事から、ストアドプロシージャの実行処理そのものは並列処理となっているが、SELECT内でのサブクエリ単位の情報取得→結果を返す・・・の処理まわりは並列実行できず、サブクエリごとにお互いを邪魔しあうような状態が発生しているように見えます。 このような想定はそもそも見当違いなのでしょうか？ 実際にSELECTのみのSQL同士を複数ユーザーで実行するだけでお互いの処理に影響しあうようなことはあるのでしょうか？ また、SELECT時の『共有ロック』について複数ユーザーの同時実行には何の影響もない（更新ロックではないので、ロックの取得は可能）の認識ですが、認識誤りはないでしょうか？ DBにはあまり詳しくないのでおかしな事を質問しているかもしれませんが、宜しくお願いいたします。
SQL2000サーバーから、SQL2005expressへ SQL Server Management Studio Express を使って移行しています その中で、テーブルレイアウトの初期設定について 日付やPC名は、SQL2000と同じ　getdate()　や　host_name()で 設定できたのですが、サーバー名が　@@servername では 「文字列データまたはバイナリデータが切り捨てられます 　ステートメントは終了されました」 とメッセージが出てきて処理できません。 SQLserver2005expressで、サーバー名の規定値についてアドバイスをお願いします
SQLサーバーで、INSERT INTO・・・selectで抽出した列の値を入れたいのですが、主キーのところで下記のエラーが出ます。 テーブル ・・・の列 '・・・' に値 NULL を挿入できません。この列では NULL 値が許可されていません。INSERT は失敗します。 ステートメントは終了されました。 selectで抽出するテーブルの該当列を確認しても値はあるはずですが・・。 原因は何が考えられますか？ お願いします・・・。
「INSERT ステートメントは FOREIGN KEY 制約 "○○" と競合しています。競合が発生したのは、データベース "△△"、テーブル "dbo.□□", column '◎◎' です。」 SQLサーバーマネジメントスタジオでインサートのクエリを流したところ、下記のエラーが発生したのですが、解決するにはどういった観点を調査すればよろしいでしょうか？ ご存知の方、お願いします。
こんにちは。ご存知の方いらしたら、お教えくださいませんか？ SQLServer2000で、 次のような顧客マスタテーブル「Tab」があったとして、 Cd列をキーにして、 Sys列がS2のCustName列の値を、 S1のものに書き換えたいと考えております。 Sys Cd CustName --- -- --------- S1 aa Corp123 S2 aa Corporation123 S1 bb 456 K.K. ... これをこのようにしたい Sys Cd CustName --- -- --------- S1 aa Corp123 S2 aa Corp123 S1 bb 456 K.K. 下記のようにしてみたのですが、 「テーブル 'Tab'があいまいです」となります。 UPDATE [Tab] SET [CustName]=T2.[CustName] FROM [Tab] T1 INNER JOIN Tab T2 ON T1.[Cd]=T2.[Cd] WHERE T1.[Sys]='S2' AND T2.[Sys]='S1' どのようなSQL文にすれば、更新できるものでしょうか？
データ取得時に列番号を組み込みたい場合 ROW_NUMBER() OVER (ORDER BY ソートキー) で実現できますが、これは実際ソートも行ってくれるのでしょうか？ 例えば １） select dt1,dt2, dt3,ROW_NUMBER() OVER (ORDER BY dt1,dt2,dt3) as dt4 from table_1 2) select dt1,dt2, dt3 from table_1 ORDER BY dt1,dt2,dt3 では同じ順序でデータが取得されるのでしょうか？ 簡単にデータを作ってみたところ、同じようなんですが・・・・
Ｃ＃で作成するとき、string 変数にどんどんと長いクエリを書いてしまいがちです。 こういったクエリ文字をデバッグなどで、カットするととんでもなく長い１行の文字列になってしまいます。 それをSQLServer のクエリとして貼り付けると、１行なので何がなんだかわからない状態になります。 それで適当な部分でエンターキーで改行してようやくどんなクエリかわかる状態で辟易しています。 何か適当なプログラムで適当な部分で改行（折り返す？）して全体がわかるように表示する（またはテキストを変換）ようなものってないでしょうか？
項目名：コード varchar (3) を "ALTER TABLE テーブル名 ALTER COLUMN コード varchar (4);"を実行し 項目名：コード varchar (4)へ変更したいと思っています。 そこで質問なんですが現在コード の内容が"001"のような３桁なのですがそれを"0001"のように4桁に変更したいのです。(頭に"0"を追加する。) (一見づつ読んで更新していく方法はわかりますがもう少しスマートに処理がしたいので) どういったSQL文を発行すれば良いのでしょうか？ よろしくお願いします。
SQL SERVER 2012のダウングレード権に関して教えていただきたく。 6コア1CPUのサーバに対し、SQL SERVER 2012を SQL SERVER 2008 R2にダウングレードして使用する場合、 ライセンス形態はどのようになりますでしょうか？ 6コア分のコアライセンスが必要？ SQL SERVER 2008 R2の1CPUライセンスと同等価格の4コアライセンスが必要？
OS　XP　SP3、ACCESS２００３　DBはSQLserver2005express　です SQL　Server Management Studio Express　を使って 新しいDB、テーブル、項目は作成できました。 また同じツールを使って手入力でデータを追記することもできます 質問はこのテーブルを　ACCESSからODBC接続して 追加クエリーを実行したいのですが リンクしてテーブルを開いた時点で新規レコードが追加できない状態です。 サーバーの更新をしたく、少ないデータであれば手入力でも 大量のデータでは…ACCESSのクエリーを使いたいと思っております。 ODBC接続の設定が読み取り専用になっているのか そうであれば　その設定はどこにあるのか　教えてもらえないでしょうか？ 宜しくお願いいたします
いつも大変お世話になっております。 よく分かっていなくて申し訳ありません。 SELECT … FROM Ａ Right Outer Join Ｂ Ｂ on Ｂ.c =Ａ.d 　というようなSQL文で Ｂ.cはvarcharでＡ.dはintです。 Ｂ.cは大多数の場合は数値なので動くのですが、稀に文字列が入ったときにエラーになってしまいます。 ここでエラーにならずに、そこで呼ぼうとしたものがなければNullになるようなよい方法がありましたら、ご教示いただけますと幸いです。 以下の添付画像のような結果を得られると幸いです。
【データベース：SQLServer2005】 SQLのアドバイスを頂きたいです。 【テーブル】 テーブル名：Table1 フィールド名：種類、キー1、キー2 テーブル名：Table2 フィールド名：種類、キー1、キー2 テーブル名：Table3 フィールド名：種類、キー1、キー2 【データ】 Table1 種類、キー1、キー2 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD Table2 種類、キー1、キー2 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD Table3 種類、キー1、キー2 NULL　 AAA　　BBB NULL　 AAA　　CCC NULL　 AAA　　DDD これをUNIONで取得します。 種類、キー1、キー2 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD NULL　 AAA　　BBB NULL　 AAA　　CCC 実現したいのは、 １）同種類、キー1、キー2のデータで、 種類にNULLが含まれていたら、NULLのデータは取得しない ２）同種類、キー1、キー2のデータで、 種類にNULLしかないデータは、取得する 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD　→いる NULL　 AAA　　BBB　→いらない NULL　 AAA　　CCC　→いらない ↓結果 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD 上記を実現する為、UNION後のSQLでも構わないので、 一発のSQLで取得する事は可能でしょうか？ 有識者の方にご享受頂ければ幸いです。 どうぞ宜しくお願い申し上げます。
SQL Server 2000のマシンリプレースを予定しております。 OS：Windows 2000→Windows 2003 DBMS：SQL Server 2000 →SQL Server 2000 サポート期間の問題は百も承知ですがこのような構成でのリプレースとなってしまいました。 リプレースにあたり旧サーバ・新サーバでIPアドレス・ホスト名は異なるものを割り当てます。 そこでDB移行の手順についてお聞きします。 移行にはSQL Server 2000の自習書(バックアップ)を参考に行う予定です。 http://download.microsoft.com/download/F/4/B/F4B18D97-C4ED-4E01-B7DC-5023F195B512/SQL2000DBA-06.doc 過去の質問も活用させていただきました。 http://okwave.jp/qa/q864802.html ■完全バックアップ 1.複製元となるデータベースを右クリックし、[全てのタスク] - [データベースのバックアップ]を選択する。 2.バックアップファイルの出力先とファイル名を指定し、「OK」を押下する。 3.バックアップ完了 ■単純復旧 4.複製先となるデータベースに空のデータベースを作成する。※複製元のデータベースと同じ名前 5.作成したデータベースを右クリックし、[全てのタスク] - [データベースの復元]を選択する。 6.「デバイスから」を選択し、「デバイス選択」を押下する。 7.「追加」を押下して先ほどバックアップしたファイルを指定する。 8.「ファイル名」を選択し、先ほど取ったバックアップファイルを選択し、「OK」を押下する。 9.「オプション」タブを選択し、「既存のデータベース上に強制的に復元」をチェックし、「OK」を押下する。 10.バックアップ完了 ■調整作業 以降は現行サーバを見ながら環境を合わせていきます。 11.[セキュリティ] - [ログイン]を選択し、ログインユーザを作成 　　「SQLServer認証を選択し、パスワードを入力してください（規定値に目的のデータベースを選択してください）。 12.パスワードの確認画面が表示されますので、パスワードを再入力してください。 13.「データベースアクセス」タブを選択し、権限を与えるデータベースにチェックをつけます。 ----------------- ＜質問＞ ●作業に漏れはないか？ ●システムデータベースのバックアップ・復元は必要でしょうか？ ●トランザクションログのバックアップ・復元は必要でしょうか？ ●インデックス・View・ストアドプロシジャも復元できますでしょうか？ ●その他漏れや注意点などありますでしょうか？ ●バックアップ取得時にサービス提供は継続できますでしょうか？ 　※参照のみであり更新処理は発生しない SQL Serve初心者のため初歩的な質問ですが宜しくお願いします。
いつも楽しく勉強させていただいております。 Win7でSQLServer2008R2の環境です。 CSV形式のファイルをSQLServerにインポートした後で集計を行います。 問題はキーとなる列に前ゼロが入っている行と入っていない行があることです。 つまり、100と000100と0100は同じキー（100）として集計したい。 これを実現するにはどうしたらよいでしょうか。 SQL文で対処できますか。 それともデータベースに取り込む前のCSV形式のファイルの段階でVBなどのプログラムによって書き換えてしまったほうがいいですか。 trim関数はスペースなら削除できるようですが、0には使えないですよね。 キーとなる値の桁数の最長は不明なので、0埋めは使えません。 また間にハイフン（-）を含むことがあるので、数値型に変換するというのもできません。 もう一つ質問です。 データベースを使う際、データの加工はデータベース内で行うのとデータベース取り込み前に行うのと２通りあると思います。 どんな時はデータベース内で行い、どんな時は取り込み前に行うべきでしょう。 ちょっと質問の内容が漠然としていて申し訳ありません。 たとえばデータの内容が全角半角が混在しているのを半角に統一するというのは、どちらでやってもできますよね。 基本的にはCSVファイルのイメージをそのままデータベースに取り込み、加工はデータベースの機能を使いたいのです。 集計前のデータの加工において、 「こういうことはデータベースではできないよ」という例を幾つでも教えてください。 逆に「こういうことはデータベースでないとできないよ」というのも。
SQLServerでOracleのGREATEST関数のような事がしたいです。 具体的に書きますと、 ID | 列1 | 列2 | 列3 | 列4 | 列5 ------------------------------ 01 | 700 | 200 | 300 | 400 | 100 02 | 100 | 800 | 200 | 300 | 200 03 | 100 | 300 | 900 | 100 | 100 という表があった場合に ID | 最大値 ------------------------------ 01 | 700 02 | 800 03 | 900 といった結果を求めたいです。 CASE等を利用するしか方法はないのでしょうか。
質問させていただきます。 例えば、RAID1が組んであるHDDにSQL Server をインストールして データベースを運用している際、片方のドライブが壊れた場合 復旧するにはSQL Server の再インストールから行うのでしょうか？ それとも、SQL Server そのものもミラーリングされていて、 データベースを操作するアプリケーション側で接続先を変更すれば すぐに復旧できるのでしょうか？ その場合、データベースは壊れる直前まで情報は更新されているのでしょうか？ 宜しくお願い致します。
DB初心者です。宜しくお願いします。 sql server のミラーリングについて質問です。 サーバ2台でミラーリングを行うのと、 RAIDが組んであるサーバ1台でDBを構築するのでは どのような違いがあるのでしょうか？ 初歩的な質問で恐縮ですが、 素人なのでわかりやすくご説明いただけますと幸いです。 宜しくお願いします。
お世話になります。Windows Server管理初心者です。 クエリ上でxp_cmdshellを用いて、ネットワークドライブ上のテキストを参照しようとしているのですが、「ログオン失敗：ユーザー名を認識できないか、またはパスワードが間違っています。」と表示され、実行されません。 実際のコードは以下の通りです。 master..xp_cmdshell 'DIR \\AASV01\BB\CC.TXT' テキストのあるネットワークドライブには、サーバーをユーザー登録しています。（パスワードは無） サーバー上でコマンドプロンプトから直接入力すると問題なく実行されます。 どこの設定がおかしいのでしょうか？ いろいろと設定を変えてみたのですが、うまくいかず、質問させて頂きました。 ご教示の程、よろしくお願い致します。 サーバーはWindowsServer2008 R2です。
同じデータベース内にA、Bという、ほとんど同じテーブルがあります。 異なるのは、２つの列に限り名前は同じですが、型が異なります。 その場合、その２列以外のデータはそのままコピーし、その２列には「1」という数値を設定したいです。 SQL serverでしたら、どのようなクエリになりますでしょうか？ よろしくお願いします。
Select文のパフォーマンスについて質問です。 (1)select * from table1 where col1='00001' and kbn in (1,2,3,4) (2)select * from table1 where col1='00001' and (kbn = 1 or kbn = 2 or kbn = 3 or kbn = 4) (1)と(2)ではどちらがパフォーマンスがよいのでしょうか？ SQLServer2008
項目名の後ろに連番を持たせています。金額０１～金額５０ CONVERTを使って、ＷＨＩＬＥで処理したいのですがうまくいきません。教えてください WHILE @ix<=50 金額+CONVERT(varchar(2),@ix)= こんなように記述して、１０以下の時に、金額１、金額２になり、金額０１、金額０２になってくれません。 宜しくお願いします
ＤＢのテーブル定義書に ＰＫの欄があり 名称　　　　　　PK ＸＸＸＸＸＸＸ P1 ＹＹＹＹＹＹＹ P2 ＺＺＺＺＺＺＺ という感じで書かれている場合、 ＸＸＸＸＸＸＸは複数同じ値で存在可能で、 ＸＸＸＸＸＸＸ　＋　ＹＹＹＹＹＹＹ　のフィールドの値が、両方同じデータは存在しないという意味 であっていますか？ つまり １　１ １　２ １　３ ２　１ ２　２ は存在できるが、 １　１ が更に存在できないということですか？
お力をお貸しください。 職場の業務で利用する単純なデータベースを、学習を兼ねて作ってみようと思うのですが、初心者なものでまず実現可能かがわかりません。 環境は ・windowsXP,windows7端末が数台（microsoft SQL server 2008がプリイン済） ・DELLのPower edge T-310がサーバーとして１台（ファイルシステムはNTFS） ・サーバーのフルコントロールは（たぶん）上司に連絡すれば可能。 ・それぞれの端末からサーバーが共有できるが、端末同士で互いに繋がることは出来ない。 ・スタンドアロンでのアプリ作成経験は有り。VBかC#．NETで作成予定。 ・SQLは勉強中…Accessは使えます。 構想では、毎日出し入れするデータをサーバーにおいて、アプリを入れたどの端末からでも修正、更新が可能なようにしたいのです。データは小規模で、同時に何人も使用することはありません。 このような場合、まずはSQLserverをサーバーにインストールするのでしょうか？そもそもNTFSにインストールって…？ それとも端末のSQLserver2008があれば、データ保存先でサーバーを選択して、他のPCから同じデータを操作できるものなのでしょうか？ 書籍も読みましたがこの辺がよくわからず（というか基本的すぎて載ってないんでしょうね）馬鹿に解るよう解説してくださるとありがたいです。
SQL Server2005 で開発しています。 Order by で並び替えてレコードをSelectする際に、 Order by の対象列データが同じ場合は、 どういった順番でレコードが取得できるのでしょうか？ TableA No　| Data1 | Data2 　　1| AAA | 100 　　2| AAA | 200 　　3| AAA | 300 　　4| ABC | 400 　　5| BBB | 500 (Noはクラスタ化PK) 例えば、上のようなテーブルから次のSQLを実行すると 　(1)Select * From TableA ; 　(2)Select * From TableA Order by Data1 Asc; 　(3)Select * From TableA Order by Data1 Asc, No Asc; 　(1)(2)(3)全て、次の順で返ってきました。 　　1| AAA | 100 　　2| AAA | 200 　　3| AAA | 300 　　4| ABC | 400 　　5| BBB | 500 　しかし、(2)のSQLは、データによって 　次の順で返ってくることがありました。 　　3| AAA | 300 　　1| AAA | 100 　　2| AAA | 200 　　4| ABC | 400 　　5| BBB | 500 　 　1～3レコード目までは全てData1がAAAのレコードですが 　特に指定していなくても、No（PK）の順になるのかと思っていました。 　 　なお、レコードができた（Insert順）でもなさそうです。 　この、順番は何で決まっているのでしょうか？ 　
SqlServerの「インポートおよびエクスポート」ウィザードで エクセルのデータをインポートする時に起こりました。 nvarchar(8) のフィールドに Double型のデータのインポートはうまくいきました。 nvarchar(8) のフィールドに VarChar型のデータのインポートはうまくいきました。 ですが、VarChar型とDouble型が混在しているとタイトルにあるエラーが起こりました。 エクセルで数値データが入っているとインポートウィザードでは勝手にDoubleにするらしく 回避する方法がわかりません。 どうすればいいでしょうか？
知り合いの事務所に頼まれ、不具合を見ることになりました。 現象としては、 　AccessADPファイルにてSQLServerにアクセスしていたのが、 　6/29（土）朝から、特定のPCのみ急にアクセスできなくなった。 というものです。以下に詳細を記します。 -------　動作PCの詳細 ------------ ・稼働PC5台（内、WinXP SP3（homeとPro混在)が4台、Win7が1台）の共通設定 　 　同じワークグループに設定。それぞれのPCに同じユーザーアカウントとパスワード設定 　IPアドレスはルーターのDHCP機能で自動割り当て 　すべてウィルスバスタービジネスセキュリティーがインストール済み ・SQLServer2005 Express が稼働しているPC 　Win XP SP3 Pro(32bit) 　「簡易ファイルの共有」機能はOFF 　共有ファイルは共有の有効化、アクセス許可、セキュリティー許可をそれぞれ登録 　 SQLServer は　Windows認証方式 　TCP/IPおよび名前付きパイプを使用する構成。 ネットワークアクセス許可 　（TCP/IPは1433固定）SQL Browserも自動起動設定。 WindowsのファイヤーウォールにSQLSrver、TCP1433　UDP1434　例外登録　 　SQLServer ManagementStudio Expressで 　ログインユーザーとデータベースアクセス許可を、ビルトイングループ単位で与えてある Hostsファイルの値は 「127.0.0.1」 ・問題のPC Win7 SP1 Pro(64bit) Office 2010Pro(32bit版をインストール） ワークグループ設定。ホームワークの設定はせず、社内ネットワークプロファイルで構成 　共有の有効化。 Hostsファイルの値が　 　　＃ 127.0.0.1 になっていたので、＃を取り除き上書き保存。 ---------------------　 調べてみたところ、問題のPC以外からは問題なくつながり、読み込み書き込み共にOKでした。 Administoratorでなくても、User権限の人でも問題なくつながります。 しかし、Win７マシンからだけなぜか急につながらなくなったとの事です。　 特定のユーザーではなく、特定のPCだけの現象です。ユーザーを変えてみても、 問題のPCからだけ、なぜかつながりません。 ADPファイルを新規作成し、サーバーに接続する段階ではサーバー名が出るものの、 　「信頼関係が…」うんぬん言われてつながりませんでした。 各PCのファイヤーウォールやWindowsDefenderをOFFにしてもダメでした。 そこで管理ツールのODBCでやってみたところ、次のようなメッセージが出ました。 　（ODBCは32bit版、64bit版共に試しました。） ---------------------------------------------- 接続できませんでした。 ; SQLState: '28000' SQL Server エラー: 18452 [Microsoft][ODBC SQL Server Driver][SQL Server]ユーザー '' は ログインできませんでした。このユーザーは SQL Srver の信頼関係 接続と関連付けられていません。 ----------------------------------------------- 不思議なのは、表示のユーザーのところが ''　になっている事です。 通常ここのところには 'マシン名\ユーザー名'　のような形で表示されると思うのですが…。 また、違うユーザーで同じ事をしてみたところ、今度は、ユーザー名のところに 意味不明な数字の羅列が表示されていました。 　（あとから思えば、SIDを表示してたのかもしれません。） そこで、そもそもファイルの共有事自体は出来るのか、試してみました。 結果、こちらにも問題がありました。 他のPCから問題のPCの共有フォルダへのアクセスはOKなのですが、 問題のPCから他のPCの共有フォルダを開こうとすると、 　「ユーザー名」「パスワード」 を聞いてくるダイアログが表示され、入力しても入れないPCがありました。 因みに、入れないPCの「簡易ファイルの共有」をONにすると問題なく入れますが、 これは単にGuest扱いを受けているだけだと思います。 　　　 以上からの推測ですが、SQLServerの稼働しているPCが問題のPCを正しく評価できない為に、 ユーザーが'(null)'のような形になっているのではないかとおもいました。 それで、ユーザー認証周りを見直し、グル―プだけでなく、ユーザー単位でもアクセス許可を設定 したり、新たにユーザーを作成したりして見たのですが、やはり問題のPCのみつながりません。 ファイルの共有に関しても、新たに共有設定をしてみたのですが、やはり問題のPCのみつながりません。 SQLServerの問題というよりも、PC自体の問題のように見えます。 正直なところ、Windows7はあまり使ったことがない為、行き詰まってしまいました。 素人考えでは、問題のマシン名とユーザー名が正しく正しく伝わっていない事が原因だと思うのです。 そもそも、なぜそのような事態になったのかがわからず、困っています。 「昨日までは問題なく使えていた」との事で、思い当たる節がありません。 担当していた人が退職された為、代わりに見ているのですが、 正直再インストールの方が早いのではとすら思ってしまいます。 ほかに何か見落としているところがないでしょうか。 また、対処法のヒントとなる事がありましたら教えて頂きたいと思います。 よろしくお願いします。
間違えて削除してしまったので再投稿します。 このたび、SQLServer2005SP2でレプリケーションを実装しようと思っています。 構成はこのように考えています。 Server１（プライマリサーバ）：パブリッシャ SQLServer2005 SP2 Server２（セカンダリサーバ）：ディストリビュータ＆サブスクライバ 間違えて削除してしまったので再度投稿します。 SQLServer2005 SP2 Server1とServer２のＤＢ、TABLE構成は同じです。 設定方法についていろいろ調べているのですが、どうもこれでよいかと確信がもてません。 どなたか設定方法をご教授お願い致します。 今回の構成に近い設定方法が載ったページなどがあれば合わせて教えてください。 また、Server1は更新用アプリが使用、Server２は参照用アプリが使用などといったことはできるのでしょうか？
お世話になってます。 あるサーバー（サーバーA）上のSQLServer7.0で作成したバックアップファイルを 復元先のサーバー（サーバーB）に復元したところ、MDFファイルが3GBに対し、 LDFファイルが100GBありました。 LDFファイルのサイズを圧縮しようと、SQLServer7.0のメニューで、 　 　1. フルバックアップ 　2. トランザクションログの切り捨て 　3. 圧縮 　※以下「1.」、「2.」、「3.」を何度か繰り返し。 を行ってみましたが、300MB程度減っただけで、それ以上は小さくなりませんでした。 　SHRINKDATABASE 　や 　TRUNCATE も試してみましたが、サイズ、変わりませんでした。 他に試すことはありますでしょうか？
SQL Server 2005で、 db内のストアドプロシージャ一覧を取得したいと思っています。 select o.* from syscomments c , sysobjects o where c.id = o.id and o.type='P' order by o.name といったように記述すれば一覧は取得できるようですが、 これだとシステムストアドプロシージャも表示されてしまいます。 ユーザーで定義したストアドプロシージャのみ取得したいのですが、可能でしょうか？ 何か良い手段をご存じの方がいらっしゃいましたらアドバイス頂けますと嬉しいです。 どうぞよろしくお願いいたします。
いつも参考にさせていただいています。 よろしくお願いします。 クライアント：Windows7 サーバ：WindowsServer2008R2、SQL Server 2008 R2 ACCESS2007で、SQL Server 2008 R2(以下SQLSv)にリンクテーブルを張りたいので、 ODBC接続でSQLSvに接続をしようとしました。 SQLSvは、認証は混在モードでインストールをしました。規定のインスタンスです。 クライアントから、サーバへの共有フォルダを参照できています。 ということは、Windows認証できるはず、と思っていたのですが、 ODBCの設定でWindows認証にすると、エラーになってしまいます。 ↓エラー内容です。 ---------------------------------------- 接続できませんでした。 SQLState:'28000' SQL Server エラー：28456 [Microsoft][ODBC SQLServer Driver][SQL Server]ユーザー'XXXXX\AAA'はログインできませんでした。 ---------------------------------------- XXXXXはサーバのコンピュータ名、AAAはクライアントのアカウントで、サーバにユーザー登録してあります。このユーザーで、サーバの共有フォルダは問題なく参照できています。 Windows認証ができなかったので、SQLSVのIDパスワード認証で行ったところ、エラーにならず、テストも無事に行えたのですが、 ACCESSでリンクテーブルをはる時にもパスワード要求され、 リンクテーブルをはった後にテーブルの内容を見るときにもパスワード要求され、という状態です。 下記の設定を確認しましたが、現象は変わりませんでした。 ・サーバのSQLSｖの設定で、 　プロパティー内の「接続」で、「このサーバーへのリモート接続を許可する」 　が「許可」になっていることを確認。 ・「SQL構成マネージャ」にてクライアントプロトコルのTCP/IPが有効になっていることを確認。 ・「SQL Server Browser」サービスを有効に。 ・サーバ側のファイアウォールの設定で、1433の接続が許可になっていることを確認。 また、ODBCのドライバは、「SQL Server」を使いました。 Native Clientというものもあるようですが、初期状態のWin7には入っておらず、複雑なこともしませんので、普通の「SQL Server」を使いたいと思っています。 できればWindows認証で接続したいのですが、上記の他には何を確認したらよいでしょうか？ Windows認証ができなく、SQLSVのIDパスワード認証で行う場合、パスワードを要求されない方法はありますでしょうか？ お手数をおかけいたしますが、よろしくお願いいたします。
SQL Server 2008 R2のINNER JOINについて質問させて下さい。 ------------------------------ SELECT * FROM [Customer] 　　　INNER JOIN Pref 　　　　　　ON Customer.CustomerPref1 = Pref.PrefId 　　　　　　ON Customer.CustomerPref2 = Pref.PrefId 　　　　　　ON Customer.CustomerPref3 = Pref.PrefId WHERE ([CustomerId] = 123) ------------------------------ 3つもONがあって変なSQL文となっております。 (当然SQLエラーとなります。) やりたい事は、 顧客フォーム[Customer]の中に、都道府県をプルダウン選択する項目が3つあります。 3つとも都道府県マスタテーブルをリレーション(FK)しております。 3つの都道府県項目で「都道府県名」をそれぞれSELECTするには、 どうしたらよいでしょうか? ご教授頂けますようお願い申し上げます。 ------------------ ▼DB情報 顧客情報テーブル：Customer 顧客ID：CustomerId 都道府県カラム1：CustomerPref1(1,2,3,～などの値が格納) 都道府県カラム2：CustomerPref2(1,2,3,～などの値が格納) 都道府県カラム3：CustomerPref3(1,2,3,～などの値が格納) 都道府県マスタテーブル：Pref 都道府県ID：PrefId(1, 2, 3,～などの値が格納) 都道府県名：PrefName(1:北海道, 2:青森県, 3:岩手県～などの値が格納)
皆様にはいつもお世話になっており、誠に感謝しております。 一発で結果が分かるSQL文があれば、ご享受願いたいのです。 下記の様なテーブルがあります。 F_No　F_Kaisu　F_Memo 001　　1　　　　メモ 001　　2 001　　2　　　　ああ 001　　4　　　　いい 001　　4　　　　 002　　1　　　　かか 002　　2　　　　きき 002　　3　　　　くく 003　　1　　　　AA 003　　2 003　　2　　　　BB 003　　3　　　　CC F_Memoに値が入っているレコードが対象であり、 F_Kaisuが数字の順番になっていないF_Noを抜き出したいのです。 上記で云えば、 F_Noの001は、 F_No　F_Kaisu　F_Memo 001　　1　　　　メモ 001　　2　　　　ああ 001　　4　　　　いい であり、F_Kaisuが数字の順番にはなっていないので、 001をヒット！ F_Noの002は、 F_No　F_Kaisu　F_Memo 002　　1　　　　かか 002　　2　　　　きき 002　　3　　　　くく であり、F_Kaisuが順番なので、 002はスルー！ F_Noの003は、 F_No　F_Kaisu　F_Memo 003　　1　　　　AA 003　　2　　　　BB 003　　3CC であり、F_Kaisuが順番なので、 003はスルー！ 結果、F_Noの001を取得したいのです。 SQL一発で実行する事は可能でしょうか？ もし可能ならば、SQL文のご享受をどうぞ宜しくお願い申し上げます。
いつもお世話になります。 下記内容のクエリを作成したのですが、「エラー：列名’支給割合’が無効です」と表示されてしまいます。 SELECT CASE WHEN 種別 = 'A' THEN 0.5 ELSE 0.3 END AS 支給割合, CASE WHEN 進捗 = '完了' THEN ISNULL(粗利, 0) * 支給割合 ELSE NULL END AS 支給分 FROM dbo.取引マスタ 種別より、CASE式で支給割合を作成し、進捗より粗利に対して支給割合を掛ける関数を作成しようと思ったのですが、上記の通りエラーになってしまいます。 Accessと同様に同一のクエリ内で式に別名を指定して参照は出来ないのでしょうか？（表現が下手で申し訳ありません） ここからさらにCASE式を足して最終粗利益等を作成したいのですが・・・・ 使用DB:SQL Server 2008 R2 express edition 検索でも目当ての回答が見つけられず、こちらで質問をさせて頂きました。 ご教授を宜しくお願いいたします。
SQLserverにもCOMMITという概念はあるのでしょうか？ Management Studio というツールでDML文を実行すると自動コミットされます。 sqlcmdやストアドなどで実行した場合でも自動コミットされるのでしょうか？ （やってみれば一発なのですが、本番環境しか無いんです） ORACLEでオブジェクトブラウザをよく使ってましたが、あちらはコミットは手動でしたので。
お世話になります。 下記のテーブルから下記の条件で データを出力するSQL文を作成したいのです。 アドバイスお願い致します。 条件１：NAMEはAを抽出 条件２：ICHIはグループ集計 条件３：ITEMはD2とD3を抽出 TESTテーブル NAME ICHI ITEM DATA ----- ---- ---- ---- A A1 D1 1 A A1 D2 2 A A1 D3 3 A A1 D4 4 A A2 D1 10 A A2 D2 20 A A2 D3 30 A A2 D4 40 B A3 D1 100 B A3 D2 200 B A3 D3 300 B A3 D4 400 データ出力結果 NAME ICHI DATA DATA ----- ---- ---- ---- A A1 2 3 A A2 20 30
ID、name、seibetuという列を持つ、membersというテーブルがあり、INSERT文を実行してテーブルに値を入れたいと考えています。 IDがIs IDENTITYの値がTRUEになっている列で、NOT NULLです。 以下のクエリを実行したところ、IDにNULLが入るといったエラーが起きます。 SET IDENTITY_INSERT members ON INSERT INTO members (seibetu, name, ID) VALUES ('男', 'すずき', @@IDENTITY) 何か問題があるのでしょうか？ お分かりの方いらっしゃいましたらよろしくお願いします。
言語：C# DB：SQLServer2008 １．トランザクション開始 ２．テーブルAをUPDATE ３．色々な処理(省略) ４．テーブルＡのUPDATE前の情報を参照 ５．参照したテーブルをもとにテーブルBをUPDATE ６．すべての処理が正常だったら全テーブルコミット、１つでも失敗したら全テーブルロールバック 問題となっているのは ４．テーブルＡのUPDATE前の情報を参照する際に、テーブルAがロックされていて参照出来ないことです。 トランザクション開始時に分離レベルを設定してみましたが同じ結果でした。 ｔran = con.BeginTransaction(分離レベル); お分かりになる方ご教授お願いします。
いつもありがとうございます。 質問させて下さい。 以下のテーブルより、S1が同値で、Codeに1と0が混じっている場合、SQLでS1を取得したいのです。 NoS1Code 13001 23011 33000 43010 53021 63020 73021 83030 93041 103050 113050 （Noはキー） 望む結果 S1 300 301 302 どういうSQLを組めば実現可能なのでしょうか？ 有識者の方、ご享受宜しくお願い申し上げます。 ※VBA等プログラミングが入っても問題ありません
SQLで調和平均（もどき）を計算したいのですが、下のようなSQL文で計算した結果が正しく出ないのです。 select ID, 3 / ((1 / (A1 + 1) + 1 / (B1 + 1)) + 1 / (C1 + 1)) as HARMEAN from TABLE （各項に１を足しているのは、ゼロ除算を避けるための苦肉の策です） たとえば、A1=20, B1=10, C1=50 の場合、上記の結果が27.14と出ます。 （正しい計算結果は18.97のはずです） ちなみに、上とまったく同じ式をExcelに入れて計算させると、ちゃんと正しい結果が出ます。 何が原因なのでしょうか？
最近には、SQLのデータベースもが、 オブジェクト志向のプログラミングで作成されているのでしょうか？
１つのテーブルの１つのレコード内に、以下のような複数のBooleanデータがあって、trueがいくつあるかを数えたいのですが、１つのSQLで記述できるでしょうか？ ID　data1　data2　data3　data4　... 1　　true　　false　　true　　false　...
いつも助けてもらってます。 皆様ありがとうございます。 以下の内容で１つのテーブルを更新するクエリを作りたいのですが、どうしたら良いでしょうか？ 本見て自力で考えれば良いんでしょうが、、、、よろしくお願いします。 １つのテーブル、「A」があるとしまして、その中には会員Noや、SEQ、Point、Point2といった 列があります。 １つの会員Noに、３つの行、SEQ１～３が必ずあります。 更新したい行はSEQ１だけです。 Pointは整数で、Point2は小数点第一位までの表記です。 テーブルＡ 会員Ｎｏ　　SEQ　　　Point 　 Point2 1001　　　　　1　　　　　20 　　 99.0 1001　　　　　2　　　　　30 　　 99.0 1001　　　　　3　　　　　50 　　 15.5 1002　　　　　1　　　　　99 　　 10.2 1002　　　　　2　　　　　99 　　 21.6 1002　　　　　3　　　　　99　 　　 10.0 やりたい事は、 SEQ1の中で、 Pointが99以外でPoint2が99.0なら、Point2へPointの数値を移したい。 Pointが99でPoint2が99.0以外なら、PointへPoint2の四捨五入した数値を移したい。 要するに、SEQ１のPoint,Point2、片方だけ99、という現状がマズイので直したい。 という内容です。 会員Ｎｏ　　SEQ　　　Point 　 Point2 1001　　　　　1　　　　　20 　　 20.0 ←更新 1001　　　　　2　　　　　30 　　 99.0 1001　　　　　3　　　　　50 　　 15.5 1002　　　　　1　　　　　10 　　 10.2　　←更新 1002　　　　　2　　　　　99 　　 21.6 1002　　　　　3　　　　　99　 　　 10.0 上記の様になれば、、と思います。 何卒ご指南くださいませ。
こんにちは。SQL Server2003を使っています。 といっても、私はselect文を使ってデータを引っ張ってくるくらいしか使えません。 毎回同じSQL文を流して結果をCSVで保存しています。 そこで、自動でSQL文を流してCSVファイルを特定のフォルダに保存するといったことができないかと思っています。 どのような技術を使って、そのような事をすればよいのでしょうか？よろしくお願いします。
TRY CATCHをネストさせた状態で、 テーブルがドロップされていることを検知するにはどうすればよいでしょうか？ BEGIN TRY 　　★ 　　BEGIN TRY 　　　　▲ 　　END TRY 　　BEGIN CATCH 　　END CATCH CATCH END CATCH としているときに、 ★の位置だとテーブルのドロップはCATCH できるのですが ▲の位置だとテーブルのドロップはCATCH できないようですが、 テーブルがドロップされていることを検知するにはどうすればよいでしょうか？
いつも皆様に助けていただいてます。 過去に色々聞いているものの、なかなか応用が利かず・・・今回もご支援下さい。 ＳＱＬ2008に、１つのＤＢを作っていて、その中にテーブルＡとテーブルＢがあります。 テーブルAには、１つの会員Noにつき3つのSEQ１～３の行があって、それぞれにポイント数が入ってます。 テーブルＡ 会員Ｎｏ　　SEQ　　　Point 1001　　　　　1　　　　　20 1001　　　　　2　　　　　30 1001　　　　　3　　　　　50 1002　　　　　1　　　　　15 1002　　　　　2　　　　　10 1002　　　　　3　　　　　 0　 テーブルBには、１つの会員につき最大10個のSEQが付きますが、今は殆どカラッポです。 テーブルB 会員No　　SEQ　　Rank 1001　　　　1　　　　5 1002　　　　1　　　　5 やりたいことは、テーブルAのSEQ１のポイント数が99以外なら、テーブルBに テーブルAの「会員NO」、SEQ「7」、Rank「1」　の行を挿入したいです。 クエリ実行後のテーブルB 会員No　　SEQ　　Rank 1001　　　　1　　　　5 1001　　　　7　　　　1 1002　　　　1　　　　5 1002　　　　7　　　　1 テーブルAのSEQ１のPointが99以外なら、テーブルBに「会員No」とSEQ「7」　とRank「1」を挿入、という概要です。 クエリで可能でしょうか？ 先ずは自力である程度やってみるのが筋なんでしょうが、時間が無いので聞いてしまいます。 何卒よろしくお願いします。
WHERE句にて「30日前から今日まで」の設定方法 今まで、下記の通り記述していました。 WHERE M_DATE >= '2012-03-21 00:00:00.000' AND M_DATE <= '2012-04-20 23:59:59.000' 日付部分を毎回変更するのが面倒なので、エクセルのTODAY関数のようなものがないかと探したところ、GETDATE関数を見つけ、下記の通り変更してみました。 WHERE M_DATE >= dateadd(d,-30, getdate()) AND M_DATE <= getdate() しかし、時間部分が現在の時間になってしまうのですね。「今日まで」部分は、現在時刻で問題ないのですが、「30日前から」の部分は、0時0分0秒としたいのです。 どうしたらいいでしょうか？ よろしくお願いします。
今まで、下記の通り記述していました。 WHERE M_DATE >= '2012-03-21 00:00:00.000' AND M_DATE <= '2012-04-20 23:59:59.000' 日付部分を毎回変更するのが面倒なので、エクセルのTODAY関数のようなものがないかと探したところ、GETDATE関数を見つけ、下記の通り変更してみました。 WHERE M_DATE >= dateadd(d,-30, getdate()) AND M_DATE <= getdate() しかし、時間部分が現在の時間になってしまうのですね。「今日まで」部分は、現在時刻で問題ないのですが、「30日前から」の部分は、0時0分0秒としたいのです。 どうしたらいいでしょうか？ よろしくお願いします。
xp_fileexistsを使わずにファイルの存在チェックはできないでしょうか？
ｎ件のデータを (1)SELECT INSERTで処理するのと、 (2)SELECT文をカーソルループにして１件ずつINSERTするのでは 処理時間は結構違うのでしょうか？ 手元に実行環境がないためご存知の方がいらっしゃったらご教授下さい。 （SQLSERVERかORACLEかなどは問いませんので）
弱小企業でAccessを利用していましたが、Accessは限界に近づいてきました。 そこで、SQL Serverを購入したいと思うのですが、ネットで見てもどこで購入すればいいかわかりません。 大きい家電屋も近くにないので、どうやれば購入できるのか知りたいと思います。使いたいのはsql server 2008 R2 standardで3人のユーザーが使う事を想定しています。 VBでアプリをつくり、アプリを3台のPCに入れて、そこからsql serverに接続したいと思っています。 どこで購入できるのか御教えて下さい。よろしくおねがいします。
システムの改修をしています。 新規テーブル、SERVER_CHECK を作成しました。 このテーブルにアクセスすると、下記エラーが発生します。 ===== Microsoft OLE DB Provider for ODBC Drivers エラー '80040e37' [Microsoft][ODBC SQL Server Driver][SQL Server]オブジェクト名 'SERVER_CHECK' が無効です。 ===== 既存のテーブルにはちゃんとアクセスできます。 'SERVER_CHECK' の名前も管理ツールからコピー&ペーストしたので、間違っていません。 SQL Server Management Studio からは結果を出力できます。 プログラムからアクセスするとエラーになります。 ===== Set conServer = ConnectDB() SQL = "SELECT * FROM SERVER_CHECK" 'SQL = "SELECT * FROM PLAN_DB" こちらは正しく出力を得られます。 Set dbServer = conServer.Execute(SQL) ===== どこかの設定が間違っていると思うのですが、見当がつきません。 どなたかご教示よろしくお願いします。
ORACLEでいうCREATE TABLE SPACE のようなものはないでしょうか？ １．CREATE TABLE SPACEを知りたいです ２．CREATE TABLE文で、デタレコードにはどの表領域を使って、インデックスにはどの表領域を使うか？を指定する構文を知りたいです。
「SELECT文の件数」と、 「同じSELECT文を使ったDELETE文の件数」が一致しない現象が起き、困っています。 【SELECT文】※２件返ってきます。 SELECT 　　a.部署コード, 　　a.社員コード FROM 　　社員マスタ a， 　　組織マスタ b WHERE 　　a.部署コード = b.部署コード 【DELETE文】※５０件 DELETEされます。 DELETE TABLE 　　社員マスタ WHERE 　　EXISTS 　　( 　　SELECT 　　　　a.部署コード, 　　　　a.社員コード 　　FROM 　　　　社員マスタ a， 　　　　組織マスタ b 　　WHERE 　　　　a.部署コード = b.部署コード 　　) 環境はSQLSERVER2005です。 件数はSQLSERVER2005のカウントオプションで表示されているものなので間違いないです。 宜しくお願いします。
Window7にSQLServer2008R2をインストールしたのですが、インストール最中にエラーがでてしまったので、アンインストールを行っています。 プログラムの機能で"microsoft sql server 2008 r2 setup (english) "が削除出来ません。 これが削除できないと、再インストールが出来ないみたいです。 どうにか削除したいので、やり方をご存じの方がいらっしゃいましたら、ご回答のほどよろしくお願いします。
SQL Server 2008を使用したシステムがあるのですが、複数の端末からアクセスする為、処理が遅くなったりして困っています。 そこで、高速化を図る為、色々と調べていたら、tempdbファイルのサイズを増やす、及びtempdbファイルをCPUのコア数分に増やすと良いというのを見付けました。 が、tempdbの適切なサイズを調べる方法が、いまいちよく分かりません。 どなたか、分かり易く助言して頂けると助かります。 OS：Windows 2008 Server DB：SQL Server 2008 Workgroup 　　　よければ、SQL Server 2008 Expressの場合も 以上、よろしくお願い致します。
ManagementStudioでストアドプロシージャの開発をしています 開発中、デバッグのためにプロシージャをコールすると、ＳＱＬの発行の度に 「何件処理されました。」 「何件処理されました。」 「何件処理されました。」 「何件処理されました。」 「何件処理されました。」 ・・・ と処理件数が表示され、確認の際に邪魔で困っています。 処理件数を非表示にするにはどうすれば良いでしょうか？ また同様に、SELECT文の発行ごとにSELECT結果がグリッドに表示されるのを非表示にできないでしょうか？
約５年ほど前に開発されたＤＢを使用したシステムがあるのですが、サーバＰＣが故障し、ＰＣとＤＢを更新しました。それから「タイムアウト」や「デッドロックエラー」が発生するようになりました。 【更新前】 １．サーバ 　・ＯＳ：Windows2000Server 　・DB：MSDE2000 SP3 ２．クライアント 　・ＯＳ：Windows XP SP3（導入当初は、Windows2000） 　・アプリケーション：VC++6.0にて開発 　・７クライアント 　・ODBCにて接続 【更新後】 １．サーバ 　・ＯＳ：Windows Server 2008 　・DB：SQL Server 2008 Express Edition ２．クライアント 　・ＯＳ：Windows XP SP3（導入当初は、Windows2000） 　・アプリケーション：VC++6.0にて開発 　・７クライアント 　・ODBCにて接続 　※クライアント側は何も変わっていません。 発生するエラーは、以下の２つです。 (1)タイムアウトしました。 (2)トランザクション(プロセスID○○)が、ロック 個のリソースで他のプロセスとデッドロックして、このトランザクションの対象となりました。トランザクションを再実行して下さい。 サーバＰＣが故障した際、蓄積されていたデータをかなり削除した為、早くなる事はあっても、遅くなる？とは夢にも思いませんでした。当然、更新後のＰＣも５年前よりかなり早くなっているハズですし．．．。 営業からは、早くなんとかして欲しいと言われますが、未だに解決の糸口が見付かりません。 どなたか助言をお願い致します。
いつもお世話になります。 以下のデータ構造において、以下の条件にあてはまるレコードを 取得するにはどのようなSQLになりますでしょうか。 (1)同一のコード、区分において、有効期間開始日が最新のもの (2)同一のコード、区分、有効期間開始日において、有効期間終了日が最新のもの 【テーブル】 ※主キー：コード、区分、有効期間開始日、有効期間終了日 コード　区分　有効期間開始日　有効期間終了日　名前 10000　A01　19800101　99991231　名称１ 10000　A01　20000101　99991231　名称２ 20000　A01　19800101　19991231　名称３ 30000　C01　19800101　19991231　名称４ 30000　C01　19800101　99991231　名称５ 30000　B01　20000101　99991231　名称６ 40000　D01　19800101　99991231　名称７ 40000　D01　20000101　20201231　名称８ ↓ 【取得結果】 10000　A01　20000101　99991231　名称２ 20000　A01　19800101　19991231　名称３ 30000　C01　19800101　99991231　名称５ 30000　B01　20000101　99991231　名称６ 40000　D01　20000101　20201231　名称８ ようするに、最新データの名前のデータを取得したいのですが、その最新の 定義が上記にあげたものになります。 連続投稿になってしまい申し訳ないのですが、どうしてもスマートな SQLを思いつかず、皆様のお知恵をお借りしたいと思った次第です。 宜しくお願いします。
いつもお世話になります。 以下のデータ構成で、区分に「A01」「D01」のいづれかが含まれているコードは 取得しないようにしたいのですが、これを、SQLのみで実現するためにはどのように すればよいでしょうか。 【テーブル】 コード　区分 10000　　A01 10000　　B01 10000　　C01 20000　　C01 20000　　D01 30000　　B01 30000　　E01 40000　　B01 40000　　E01 40000　　F01 ↓ 【結果】 30000 40000 ※コード10000はA01が含まれており、20000はD01が含まれているため対象外 普通のプログラムならば、全て取得してきて、ループしながら該当する区分の場合は continueするなりしてはじけばい、というように想像できるのですが、SQLのみでやるということで、 ループ処理は行えないためどうしてもスマートな方法が思いつきません。 何かよい方法はないでしょうか。 宜しくお願いします。
SQLServer2008を使っています。 レセプトを入れた大きなテーブル(1000万行以上)から、何年何月にどの保険者（たとえば国保）に何件請求があったかを取り出したいと思います。 保険者は保険者番号（10桁前後の数値）、診療年月は200904のような形で入っています。 主キーになる項目はないので主キーは設定していません。 ManagementStudioにて保険者番号、診療年月に下記のコマンドでインデックスを設定しました。 CREATE NONCLUSTERED INDEX IDX_レセプト1 ON dbo.レセプト(保険者番号) CREATE NONCLUSTERED INDEX IDX_レセプト2 ON dbo.レセプト(診療年月) その後、目的の集計を行うべくManagementStudioで下記のSelectコマンドを実行しました。 SELECT 保険者番号, 診療年月, COUNT(保険者番号) AS Expr1 FROM dbo.レセプト GROUP BY 保険者番号, 診療年月 ところがタイムアウトになってしまうのです。 オブジェクトエクスプローラーで一番上のアイコンを右クリックし、プロパティで接続のタイムアウトを0に設定してみましたが改善しません。 どうしたらいいでしょうか。
Left　Joinについて select * From shohin left join meisho on sh03 = me02 and me01 = 1 where **** select * From shohin left join meisho on sh03 = me02 where me01 = 1 left joinの中に me01 = 1があるパターンとwhere句に　me01 = 1 があるパターンで検索結果が変わってくる具体的にどう変わるのでしょうか 良く理解ができていないので教えてください
TRANSACT-SQLで下記のような処理を記述したとき、 (1)～(3)で起きたシステムエラーの検知はCATCHで共通的に行えますか？ TRY 　SELECT処理 　↓ 　エラー発生(1) 　↓ 　INSERT処理 　↓ 　エラー発生(2) 　↓ 　UPDATE処理 　↓ 　エラー発生(3) CATCH 　GOTO 異常終了処理 END COMMIT ：異常終了定義 ログ出力（エラーメッセージ） ロールバック ※エラー処理は、テーブルがDROPされていた、ディスクが破損したなどの通常は発生しないエラーが起きた場合を想定しています。 ※エラーメッセージはステートメントが最終の処理の結果を持ってくれていて、その取得方法があると思っています。 もし実現できなかったり、実現出来たとしても問題があるようであればご指摘頂きたく存じます。
いつも楽しく勉強させていただいております。 用語の間違いなどありましたら、ご指摘ください。 WinXpのPCにSqlServer2008Expressをインストールしたのですが、管理ツールがうまく入らなかったようです。 管理ツールという呼び方は間違っているかもしれません。 以前のバージョンのSqlServerでGUIでテーブルやビューを作成できるものがありました。 あれのことです。 今現在[スタート]-[すべてのプログラム]-[microsoftSqlServer2008 R2]と選択すると、その先に表示されるのは[構成ツール]と[データのインポートおよびエクスポート]だけです。 そこで管理ツールを追加インストールしたいのですがうまくいきません。 インストールを実行すると[インストールの種類]のウィンドウで[インストール済みのインスタンス]の２行目に表示されるEnterprizemanagerとは管理ツールのことでしょうか（添付画像参照）。 もしかしてすでに管理ツールはインストールされており、なぜか使用できない状態にあるということなのでしょうか。 インスタンスIDに「不明」と表示されるのも気になります。 ちなみにExpress版のインストールですが、ダウンロードしたものではなく有償のメディアから入れております。 どうしたら管理ツールが使えるようになるのでしょうか。
Microsoft　SQL Server Management Studio 2008 にて、SQLを作成しています。 入金テーブルに下記の2項目が入力されています。 1．通貨　2．額　 通貨は円とドルしか存在しません。 そして10万円相当以降の通貨と額だけを抜きとりたいのです。 私が作成したSQLは、 SELECT CASE WHEN 入金テーブル.通貨 = 'ドル' THEN 入金テーブル.額 * 80 (為替レート1ドル80円の場合) 　　ELSE 入金テーブル.額　END As 入金額 FROM 入金テーブル WHERE 入金額 > 100000 別名の入金額が値として認められないのが、問題だと思いますが、 どうしたらいいのでしょうか？ よろしくお願いします。
一ヶ月分のカレンダーがあり 営業日には１がたっているテーブルがあります 営業日営業日フラグ実営業経過日数 2012/02/0111 2012/02/0212 2012/02/0302 2012/02/0402 2012/02/0513 2012/02/0614 2012/02/0715 2012/02/0805 上記のように実営業経過日数をクエリで抽出したいのですが どのようにサブクエリを作成したらいいのか教えてください
LOCK_ESCALATIONオプションが設定されているか否かが わかるＳＱＬを教えてください。 SQL Server 2008になってから、ロックのエスカレーションの無効化を テーブル単位に行えるようになった事を知りました。 具体的には以下のＳＱＬにてできるようです。 ALTER TABLE ＴＢＬ01 SET ( LOCK_ESCALATION = DISABLE ) セットの方法はわかったのですが、「今どうなっているか」を知る方法は ないものでしょうか？ どなたかご存知の方いらっしゃいましたら教えてください。
SQLServer2005 Workgroup を使っています。 500万行ぐらいあるテーブルがあるのですが update テーブル名 set 列=～～ where ～～～ update テーブル名 set 列=～～ where ～～～ update テーブル名 set 列=～～ where ～～～ update テーブル名 set 列=～～ where ～～～ というプログラムを実行したところ、10時間経っても計算結果が終わらない為、 一旦キャンセルをしました。 ところが「クエリをキャンセルしてます」というメッセージが流れたまま キャンセル後、10時間経過しても終了してくれません。 この状態で新たにクエリを作ってプログラムを実行してもものすごく処理が重いです。 キャンセルによってデータを元に戻そうとしているのかどうか分りませんが 元に戻さなくていいので強制的に終了する方法はないでしょうか？
大量のデータ（数十万行のテーブルが１０個ほど）を扱うことになり、SQLServerの使用を考えています。 PCのOSはWindows7です。 将来的には解析などのプログラムを作成するためにVisual Studio2010も必要になりそうです。 ・質問その１ Visual StudioとSQLServerは別に買うもの？ Visual Studioを買うとSQLServerも入っているそうなのですが、 それはたしかSQLServerExpressという無償版ですよね。 ということは、それと別に無償版でないSQLServerを買う必要があるということですね。 ・質問その２　インストールが失敗します ちょっと心配なのは、インストールがうまくいくかということです。 実は昨日SQLServerExpressをインストールしてみたのですが、なぜかエラーになります。 PCにVisual Studioが入っているとエラーになることがあるらしいのです（以前のバージョンの無償版が入っていました）。 アンインストールしたのですが、うまくいきません。 さらにVisual Studio2010Expressもインストールしてみたのですが、 SQLServerExpressのみ失敗してしまいました。 ・無償版でなく正規版なら問題なくのインストールできるしょうか。 ・その際、インストールの順序など気を付けるべきことはありますか。 ・これらの環境を整えてくれるサービスを行っている業者はありますか。 早く作業に入りたいのにインストールでつまずいて不安にかられています。
SQLServer2008ExpressをWindows7にダウンロードしようとしています。 http://www.microsoft.com/downloads/ja-jp/details.aspx?FamilyID=e08766ce-fc9d-448f-9e98-fe84ad61f135&displaylang=ja 上記サイトでダウンロードするらしいのですが、SQLEXPRADV_x64_JPN.exeとSQLEXPRADV_x86_JPN.exeの二つがあり、 どちらをダウンロードすればいいか教えていただけませんか。 私が使用しているPCは、DellのOPTPLEX980でCPUは32ビットのマシンです。
お世話になります。 MOSS 2010 で必要な SQL Server製品バージョンについて、 具体的な情報を拾えず困っております。 最小要件 64ビット版Microsoft SQL Server 2008 R2として 説明がありますので、通常であれば、複数明示されている ものと考えてしまうのですが。具体的に対応する SQL Server製品バージョンは何になりますでしょうか？ ・ 64ビット版Microsoft SQL Server 2008 R2 ・ 32ビット版Microsoft SQL Server 2008 。。。 参照済みURL SharePoint Server 2010 システム要件 http://technet.microsoft.com/ja-jp/library/cc262485.aspx#section4 参照済みURL Windows Server 2008 R2 と SharePoint Server 2010: よりよい統合 (ホワイト ペーパー) http://go.microsoft.com/fwlink/?linkid=187264&clcid=0x411 ご教示頂けますと、幸甚です。
初歩的な質問で大変恐縮ですが、ご教授願います。 以下の二つのテーブルがある場合、１回のSQLで削除する方法を教えてください。 ＜Aテーブル＞ --------------- ID 削除フラグ A 0 B 1 C 0 D 1 E 0 E 0 E 0 F 1 F 0 F 1 G 1 G 1 G 1 ＜Bテーブル＞ ID ----- A B E F G ＜削除後のAテーブル＞ --------------- ID 削除フラグ A 0 C 0 D 1 E 0 E 0 E 0 F 1 F 0 F 1 ※Aは削除フラグが0のため削除されない。 ※C,DはIDが一致しないため削除されない。 ※E,Fは削除フラグが全て1でないため削除されない。 IDが一致していて、削除フラグが全て「1」である場合、Aテーブルを削除する。 としたいのですが、半日悩んでもうまくいきません。 どうかお願い致します。
sqlserver2005 文字列のカラム（ただし数字のみ）と、画面から文字列としてきた 数字の大小を比較したいと思っています。 たとえば、WHERE ～ 【対象カラム】 > CONVERT(NUMERIC,'1')のように しようと思っていたのですが、この場合、【対象カラム】の中に 空白があるとこけてしまいます。 文字列なので、空がNULLとは限らないため困っています。 そもそもINT型のカラムならば良いのですが、都合により文字列の カラムにするしかなく。 妙案ありましたらアドバイスいただけないでしょうか。
WS 2008 R2 に MSSQL 2008 R2 （x64版） をインストールして運用しています。 開発環境 WIN7 ＰＣ（x86）に MSSQL 2008 R2 Developer （x86版）をインストールしたのですが、 このＰＣから サーバーの MSSQL （x64版） を操作しても問題はないのでしょうか？ 実際に試してみれば良いのでしょうが、もし事前に分かったらと思いまして。 どなたかご教授いただけるとありがたいです。
SQL初心者です。初歩的な質問だと思いますが、ご教授願います。 以下のような２つのテーブルがあります。 【テーブルA】 グループ 社員番号 A 1 A 2 A 3 B 4 B 5 B 6 C 7 C 8 D 9 D 1 【テーブルB】 社員番号 1 9 テーブルBの社員番号と一致する場合、テーブルAをグループ単位で抽出しないようにしたいです。 　・グループAは社員番号1が一致するため抽出しない。 　・グループDは社員番号1と9が一致するため抽出しない。 【取得結果】 グループ 社員番号 B 4 B 5 B 6 C 7 C 8 説明が分かりづらくて申し訳ありませんが、よろしくお願い致します。
OracleでテーブルのNot Null制約や、カラムのバイト数、PKかどうかなどが取れるように、 SQL Server でも取れますでしょうか？ Googleにて「SQLServer、 データディクショナリ」のキーワードで検索をしてみましたが、 出てくるのはOracleばかりでした。 （SQL Serverで使う言葉がデータディクショナリという言葉ではないのかも？） SQL Server での取得方法、もしくはGoogle検索用のワードを知りたいです。
初心者です。 稼働中のデータベースのカラムの順を変えると 問題がありますでしょうか？ どうかよろしくお願いします。
早速ですみません。 マスタを別々に分けた方がいいのか、それとも各マスタを1つにまとめた方がいいのかで悩んでいます。 ■マスタを別々に分けた場合 ・○×マスタ ・○○マスタ ・××マスタ 　　　・ 　　　・ 　　　・ ■各マスタを1つにまとめた場合(※テーブルの項目に種別フィールドで判別するようにする。) ・アイテムマスタ どちらがいいと思いますか？ 個人的な意見でも何でも構いませんので皆さん、アドバイス下さい。 宜しくお願いします。
お世話になります。 現在SQLSERVER 2008R2 とvisualbasic2010を使用し、データベースの勉強をしています。 教科書は、visualbasic2005による[実践]データベースプログラミング　谷尻かおり氏著を 使用しています。 テキストボックスに抽出条件を入れると特定のレコードを抽出したいのですが SQL Serverの抽出条件のパラメータについて分からないのでご教示願います。 教科書P47ではSQLServerの場合は「@GoodsID」とする事で、テキストボックスの 値をいれられると私は認識したのですが、うまくレコードを抽出することができません。 アクセスでは LIKE ? & '%' SQLserverでできるかなと思った私の考え LIKE @GoodsID & '%' どうすればレコードが抽出できるでしょうか？ 以上よろしくお願いします。
Windows Server 2003 に SQL Server 2005 Express で使っている環境の バックアップ目的で サーバ機とWindows Server 2008 R2 Standard (64ビット版)を 購入し、SQL Server 2008 Express をインストールしました。 OSとSQL Server 2008 Expressのインストールはここ数日何度もトライしましたが、 解決に至りません。 Windows Server 2003 に SQL Server 2005 Express上のデータベースに 対して、クライアントは、Windows XP + Office Pro 2003でAccess より リンクテーブル→ODBCデータベース→SQL Server で進めていって テーブルが出てきますが、新しく構築したサーバ機でテストすると。 作成したデータベースが表示されません。 全く表示されないのではなく、デフォルトで入っている、master等は表示されます。 2005から2008へデータベースファイルを持ってきたことが原因と思い、 2008側で作りましたが、やはり、それも表示されません。 OSとの相性が問題かと思い、別のWindows 7 へ入れてみましたが、同じ現象です。 SQL Server 2008 Express　接続でネットで検索をかけると、全く繋がらないと いった質問だけで、ポートを空けるとか言った回等で解決に至ったか分からない まま、締め切られています。 自分の場合は、全く症状が違っていて、繋がるのですが、作成したのが見れないんです。 このような症状あると思うんですが、質問自体見つかりません。 Microsoft に問合せしましたが、所詮無償のものですので、テクネットやこちらを 紹介され、そちらで解決して下さいとのことで困っています。
実は、会社でWebSiteと連携したDBを構築できるようなソフトを探してます。 たとえば求人サイトとように、クライアントがアクセスして求人を探し、応募できるとか、自分自身をクライアントが登録してDBになるとか。 ずっとネットを見ていて、 (1) Perl/CGI+namazu (2) Filemaker (3) サイボウズデヂエ (4) ASP+MSDE2000 (5) ASP.NET+MSDE2000 (6) JSP+mySQL/Postgre/Oracle (7) PHP+mySQL/Postgre こんな感じの開発が必要なようですが、出来合いのMSのソフトで可能でしょうか？ 可能でしたら、そのソフトの名前と構成をお教え願えますでしょうか？ 上司から探せといわれましたので、助けてください。。。
access２００７　VBAでSQLのUPDATEの使い方の質問です 下のような顧客テーブルがあり ID　　　担当者　　会社名　　　　　電話番号　　 １　　　　山田　　　XX産業　　　　　１２３４ ２　　　　　　　　　　株式会社XX　　２４４３４３ ３　　　　山本　　　YY会社　　　　　４３２０５４ ４　　　　田中　　　XX商事　　　　　５９６８０ ５　　　　　　　　　　TT工業　　　　　５４９３ ６　　　　佐藤　　　ｊｊ加工　　　　　　５４３５４ ７　　　　　　　　　　XX工務店　　　４３２０２ ８　　　　湯浅　　　Xx工業 担当者列が空白の行を見つけ、上から２行目までの担当者列に中村と入力したいのですが 以下のようにしても上手くいきません。 ("UPDATE 顧客テーブル SET 担当者 = '中村' WHERE 担当者 IN (SELECT TOP 2 担当者 FROM 顧客テーブル)") 上記テーブルですと、ID２、５の担当者名が中村になるようにしたいのです。 どなたかお知恵をお貸しください。
SQLSERVER(2008)に関して質問です 既存のサーバのバックアップから別のpcにデータベースを復元した場合 SQL CLRのDLLはどこに復元されるのでしょうか 元のサーバと同じパスには復元されていないようですが・・・ そのくせ実行できるし・・・
現在、会社でSQLServer2008 WorkGroup を購入し WinXPのPCにインストールして利用しています。 最近PCの処理能力に限界を感じ、新たにPCを購入することが決まりました。 現在のPCのSQL2008はアンインストールし 新PCにSQL2008をインストールする予定です。 そこで新PCのOSについて悩んでいます。 Windows7　Proの64bit版のOSを購入しようと予定していますが SQL2008は対応しているのでしょうか？ またSQL2008がwin7にインストール出来たとして クライアントPCがXPの場合、SQL Server Management Studioは win7のサーバーに接続できるのでしょうか？ アマゾンでは http://www.amazon.co.jp/Server-2008-Workgroup-%E6%97%A5%E6%9C%AC%E8%AA%9E%E7%89%88-5CAL/dp/B001DFV3IY/ref=sr_1_5?ie=UTF8&qid=1326974939&sr=8-5 対応OS: Windows XP Pro(SP2以降)/Server 2003(SP2以降)/Vista/Server 2008以降 とあり、windows7は書いていません。　 ただVistaは載っているのでこの情報が古いのか？どうかが分かりません。 質問は2点です。 ・Win7（PRO　64bit)にSQL2008はインストール可能か？ ・クライアントPC（XP)でMSSMSを起動し、サーバー（win7)のDBへの接続は可能か？ 宜しくお願いします。
SQLサーバ超初心者です。 A支店用のテーブルを作成（dbo.data_A）したのですが B支店（dbo.data_B）、C支店用（dbo.data_C）のテーブルを作成したいです。 Accessなどのように、コピーペーストなどはできないのですよね？ ご教授お願いいたします！
お世話になります。 先日、システムエンジニアの人が、「データベースのスレッド云々」と 口にしていたのですが、どういう意味か解りませんでした。 その後、インターネットで調べてみたのですが、もともとは「糸」や「繊維」 という意味らしいですが、それ以上のことが理解できませんでした。 SQLでいうと、どういった処理内容に該当するのでしょうか？ 宜しくお願いします。
SQLServer Expressを自動インストールするバッチファイルを作成しました。 処理の流れは (1)インストール (2)MDFのアタッチ となっています。 ところが(2)が失敗します。 sqlcmd を使ってアタッチをしているのですが、 「操作可能なプログラムまたはバッチ ファイルとして認識されていません。」 となります。 ところが再度(2)の処理だけを実行すると成功します。 つまりインストールは成功しており、sqlcmdは使えるはずなのです。 処理が連続しているのが問題化と考え、コマンドを別ウインドウを立ち上げたり しましたが無理でした。コマンドでスリープも出来ないようです。 解決法をご教授願います。 環境 WindowsServer2008Standerd SQLserverExpressR2SP1 with Tools
T-SQL　初心者です。 下のようなcolumn（fruits　year）があって、右の年度（2011）を削除して左側の果物の名前だけ表示したいのですがどのようにやったらいいでしょうか。 SUBSTRINGやLEFTを使うと左から始まって何桁目までという指示ができますが、果物の名前のみは桁数が違うので使えません。　よろしくお願いします。 Column: fruits year APPLE 2011 LEMON 2011 STRAWBERRY 2011 ORANGE 2011 結果： APPLE LEMON STRAWBERRY ORANGE
いつもお世話になっております。 一応30分ほど自力で考えましたが、断念しました。 どなたかご教授下さい。 テーブルAの中に、以下の様なデータがあるわけですが、 KAINo SEQ　 0001 　　 1 0001 　　 2 0001 　　 3 0001 　　 5 0002 1 0002 5 １つのKAINoに対して、存在するSEQがバラバラなので、全てのKAINoにSEQ１～７を 作るクエリを流したいのです。 （↑をこんな感じに↓） KAINo SEQ　 0001 1 0001 2 0001 3 0001 4 0001 5 0001 6 0001 7 0002 1 (略)　 0002 7 どの様なクエリになるのでしょうか？ そもそもクエリで可能なのでしょうか？ どうぞ、よろしくお願い申し上げます。
テーブルAには、年月、単価と言うカラムを持っており、 データとしては、下記のように保持しております。 2011/01/01 100 2011/02/01 200 2011/03/01 300 2011/04/01 400 データを取得する際にWHERE句に「2011/02/01」と指定した場合に 「2011/02/01」を当月とし、 「2011/01/01」を前月として取得、 「2011/02/01」の単価と「2011/01/01」の単価を差分として取得したいのですが、 サブクエリだと複数のデータがあるため、エラーで落ちてしまいます。 何か良い取得方法があればご教授頂けないでしょうか。 SELECT 単価 as 当月,　（例：200) 単価 as 前月, (例：100) 単価 as 差分 (例：100) FROM テーブルA WHERE 年月='2011/02/01' 以上、よろしくお願い致します。
いつもお助け頂いております。 簡単な方には簡単な内容なのでしょうが、行き詰まりました。 お助け下さい。 現在、「テーブルA」の中に、「会員NO」という列があります。 現在は、「00001001」といった8桁の数値と、「000000001010」といった12桁の数値 が混在しております。 これを12桁に統一したいのですが、なかなか検索してもHITせず・・・ ほとんどが8桁なので、先頭に「0000」を追加して12桁の分は手作業で修正すればいいか、 と思い社内のSQL2005でテストOKだったクエリが、現地のSQL2008ではエラーに。。 ちなみに下記の内容です。 UPDATE テーブルA SET　会員NO　=　'0000' + 会員NO できれば12桁に統一、というクエリが欲しいのですが・・よろしくお願いします。
自宅でSQLServer2008ExpressEditionをインストールしてDBの勉強をしているのですが 保守や運用について勉強したいと思っているのですが何から勉強していいのかわかりません 現在は １．インストール ２．DB作成、テーブル作成 ３．データ挿入 などをSQL文を使わずにSQL Management Studioの画面から行っています。 これから １．データベースのバックアップ ２．検索速度をあげる作業（すみませんよくわかっていません） ３．ミラーリング？（故障時に切り替えるやつ※よくわかっていませんすみません） 等の保守、運用で必要になる知識を学びたいのですが 保守の日常業務や作業項目がわかっていないため何から勉強していいのか わかりません。 そこで、質問なのですが 保守の日業務や作業項目を教えてください 作業項目というのは例えば １．バックアップ ２．ミラーリング 等のこんな感じです 参考書籍やホームページもあれば追記願います。
お世話になります。 テーブル1：STAFF（社員テーブル） StaffRec、StaffCode テーブル2：ATT（異動履歴テーブル） AttRec、AttStaffRec、AttSecRec テーブル3：SEC（部署テーブル） SecRec、SecCode 求めたい結果：最大（最新）の異動履歴レコードNo.に関連する以下の項目です。 異動履歴レコードNo.、社員コード、部署コード 類似の質問、回答を見て「GROUP BY」というのを利用するのかと思いましたが、 以下のコードで試していましたが求める結果になりませんでした。 ********************************************************************** SELECT Max(ATT.AttRec), STAFF.StaffCode, SEC.SecCode FROM PJK0001.dbo.ATT ATT, PJK0001.dbo.SEC SEC, PJK0001.dbo.STAFF STAFF WHERE ATT.AttStaffRec = STAFF.StaffRec AND ATT.AttSecRec = SEC.SecRec GROUP BY STAFF.StaffCode, SEC.SecCode ********************************************************************** 部署コードまでグループ化しているのが問題だと思ったのですが、 どうすれば良いかが分からず質問させて頂きました。 よろしくお願いします。
データベースはSQLServer2008R2を使って開発を行っています。 トリガを作成する事になったのですが、ストアドは初心者です。 なにかと足りない内容などがあると思いますが、ご了承下さい。 あるリンクテーブル（ODBC経由）でInsertの処理があった場合にSQLServerのテーブルにInsert処理を行いたいと思っています（履歴を作成する為）。 しかしリンクテーブルの定義が分からず、現在調べている最中です。 ちなみにリンクテーブルは下記の内容になります。 select * from openQuery (Host39Kelfjk, 'select * from TblAkDfoe') リンク：「Host39Kelfjk」.「DB1」.「Host39Kelfjk」 リンクサーバ：Host39Kelfjk カタログ：DB1 テーブル名：TblAkDfoe 参考になるような、サイトなどありましたら教えて下さい。 宜しくお願いします。
SQLServer2008R2で、ＤＢとログに自動拡張の設定をした場合の パフォーマンス劣化について、質問いたします。 自動拡張すると、元の領域と拡張した領域がディスクの別々の場所に作成され、 ファイルが断片化した状態になると思うのですが、 これはデフラグを行うことで解消する、と考えてよいでしょうか。 また、データの追加・削除を繰り返すと、ＤＢの中に 無駄な領域が増えると思いますが、これはSHRINKFILEを実行することで 解消しますか？ 下記のような認識で、合っているでしょうか。 (1)データの追加・削除を繰り返し、ＤＢ領域が不足すると 自動拡張が行われる。 (2)自動拡張されたＤＢは、ファイルが断片化している。 また、ＤＢをしばらく使うと、ＤＢ領域内でデータがまばらに入った状態になり、 パフォーマンスが劣化する。 (3)SHRINKFILEを実行することで、まばらになったデータを ＤＢ内の１箇所に集めて、無駄な領域を開放する。 (4)さらに、ＤＢの物理ファイルがディスク上で断片化しているのを、 デフラグで解消する。 初心者のため、用語の使い方がおかしいかもしれず、申し訳ありませんが、 よろしくお願いいたします。
専門家の方、宜しくお願い致します。 SQLSERVER2008 R8のインストールについて質問させてください。 私は、下記のようなＰＣを保有しています。 (1)ＳＳＤとＨＤＤのどちらにSQLSERVER2008 R8をインストールすべきでしょうか？ WINDOWS７　ＰＲＯ SSD １２０Ｇ ＨＤＤ１ＴＢ (2)SQLSERVER2008 R8をＳＳＤにインストールする場合の手順を教えて頂けませんでしょうか。 通常だと「Ｃ」は、ＨＤＤを指しているイメージなのですが、間違っていますか？ 以上、宜しくお願い致します。
テーブル名を[]でくくらないとエラーになってしまいます sqlserver 2008 express edition を利用しているのですが テーブル名　やカラム名に[]でくくってSQL文を実行しないと エラーが出てしまいます 例えば select * from [table]　　の様にしないといけません これを select * from table で実行できるようにしたいのです どうしたらいいのでしょうか 会社ではsqlserver2005を利用しているので 2008からは[]でくくる必要になったのでしょうか それとも初期設定で何かしないといけないのでしょうか 設定方法を教えて下さい sqlserver management studio2008もインストール済みです
現在「Microsoft SQL server 2008」をグラフィカルに操作するために、SDKを探しているのですがみつかりません。 2005は「SQL Server Management Studio Express」（ダウンロードファイル名はSQLServer2005_SSMSEE_x64.msi）というものを見つけたのですが、残念ながら2008には対応していませんでした。 もしかして2008は有料なのでしょうか？ ご回答いただけると幸いです。
SQLserverについてです。 SQLサーバーは、マイクロソフト社から販売されているデータベースソフトですが、 実際のところORACLEと比べて、処理速度は速いのでしょうか？ 専門家からみるとSQLサーバーは、処理速度の観点だけをみるといかがですか？ データベースソフトを全体的にみると、処理速度についてSQLサーバーだけ記載が少ないので、 極端に処理が遅いソフトなのではないかと考えています。
あるマシン(Windows XP Pro)には SQL Server が入っています。 ただ何年も放置していたマシンなので 2000 なのか　2005　なのかわかりません。 プログラムの追加と削除で調べると添付のように 2000 と 2005 の両方が表示されてしまいます。 （添付画像がプログラムの追加と削除で表示されている内容です） 実際このマシンにインストールされているバージョンはどちらなのでしょうか？ また SQL Server 2000 のバックアップデータはそのまま復元可能なのでしょうか？ VB６ からアクセスするように組まれていますので、そのまま使いたいと思っています。
SQL SERVERを使用してGROUP CONCATと同等の結果を取得したいと考えています。 以下のcolumn1のテーブル名の値を条件を指定して、カンマ区切りの文字列で取得したいです。 column1 ----------- test1 test2 test3 求める出力結果 test1,test2,test3 調べたところ下記のように行うと近い結果を得ることができました。 SELECT my_column AS [text()] FROM my_table FOR XML PATH('') しかしこれだと区切り文字が指定できません。 カンマ区切りに指定をするにはどうすればよいでしょうか？ よろしくお願いします。
お世話になります。 以下のテーブルから、次のアウトプットを行うためのSQLをご教授ください。 【インプット】 大連番　小連番　… 000001　000001　… 000001　000002　… 000001　000003　… 000001　000004　… 000002　000001　… 000002 000002　… 000002 000003　… 000003 000001　… 000003 000002　… 【アウトプット】 大連番　小連番　… 000001　000001　… 000001　000002　… 000001　000003　… 000002　000001　… 000002 000002　… 000003 000001　… ※大連番毎に小連番の最大値のデータを除いている。 どうか、お力添えをお願い致します。。。
VBExpress2010をDLしSQLServercompactをいじろうと思ったのですが、接続がそもそも出来ず詰まってしまいました。 適当にフォームを作ってボタンを配置し、 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Dim St As String Dim Cn As New System.Data.SqlClient.SqlConnection Dim SQL As System.Data.SqlClient.SqlCommand Dim ServerName As String = "C:\Program Files\Microsoft SQL Server Compact Edition\v3.5\Samples\Northwind.sdf" 　　　 Dim DatabaseName As String = "Northwind" 'データベース St = "Server=""C:\Program Files\Microsoft SQL Server Compact Edition\v3.5\Samples\Northwind.sdf"";" St &= "integrated security=SSPI;" St &= "initial catalog = Northwind" Cn.ConnectionString = St SQL = Cn.CreateCommand SQL.CommandText = "SELECT FirstName FROM Employees" Cn.Open() MsgBox(SQL.ExecuteScalar) Cn.Close() SQL.Dispose() Cn.Dispose() End Sub としました。結構単純な流れだと思うのですがCn.Open()の部分で「sqlexpressionはハンドルされませんでした」とエラーが出ます。 SQL Network Interfaces, error: 26 だそうです。資格情報の有無もなにもデータベースエクスプローラで内部の閲覧は出来るし、パスワードフリーなのでどのセッションが不可なのか見当がつきません。アドバイスよろしくお願い致します。
Windows Vista Home PremiumにてSQL Server2008R2をインストール中なのですが、「サーバーの構成」にて次のエラーが出て、検証に失敗してしまいます。 「このページで検証エラーが発生しました。[OK] をクリックして、ダイアログ ボックスを閉じてください。セットアップ ページの下部に表示されるエラーを確認した後、有効なパラメーターを入力してください。詳細については、[ヘルプ] をクリックしてください。」 下欄には「～～で指定した資格情報が無効です。続行するには～～に有効なアカウントとパスワードを入力してください」 となります。アカウントには、Vistaのコンピュータ名、パスワードには同じく左記のログインパスワードを設定しています。なぜエラーになるのでしょう、入力規則に反してる部分があるのでしょうか。
sqlserver 2008 express with advanced servicesをインストールしているのですが powershellがインストールされていないためインストールが行えまませ そこで、質問なのですが powershellのバージョンは何をインストールするべきなのでしょうか 自宅でアプリケーションをインストールする場合は大抵最新バージョンを インストールしていますが。 　 環境 SQLServer :sqlserver 2008 express with advanced servicesをインストールしたい OS：windows xp proffesional .net Framework :.net framework3.5 sp1 windows インストーラ　4.5 質問 インストールするべきpowershellのバージョン
会議室予約システムを例とさせていただきます。 開始時刻／終了時刻／予約者 10:00／11:00／鈴木 15:00／17:00／山田 このテーブルに以下のデータを追加する時、【追加データ１】はINSERT可能で、【追加データ２】はINSERT不可能にするチェック方法を考えます。 【追加データ１】14:00／15:00／佐藤 【追加データ２】16:00／18:00／高橋 一般にはプログラム内でSELECTによるチェックを行い判定結果によりINSERTを行うと思いますが、今回は既存プログラムに手を加えることができないとして、以下のどれかのやり方の可能性と方法を教えていただきたいです。 【方法Ａ】check制約のようなDB依存しない方法で、テーブルにあらかじめチェックを加える。 【方法Ｂ】SQLServer特有の方法を使用し、テーブルにあらかじめチェックを加える。 【方法Ｃ】INSERTのSQLにチェック機能を入れる（入力不可時にはエラー等を返す） プログラム言語：java 1.5 以上, iBATIS SQLServer：2008 R2 Express または Standard なるべく【方法Ａ】のようなものがあるといいのですが。。 以上です。よろしくお願いいたします。
SQLServer2008を使用しています。 下記のように一つの売上データが伝票番号をキーとして一つのテーブルに複数レコードに分けて登録されています。 伝票番号　分類　区分　データ 1　　　　　　　1　　　1　　　2500 1　　　　　　　2　　　1　　　　　0 1　　　　　　　3　　　1　　　A123 2　　　　　　　1　　　1　　　9800 2　　　　　　　2　　　2　　　　　0 2　　　　　　　3　　　1　　　　　0 分類が1だと売上金額、2だと区分が1なら現金、2ならカード支払いなどとフィールド内の値によって意味分けされています。 上記例ですと伝票番号1は顧客ID A123の客が現金で2500円、 伝票番号2は顧客ID 0（フリー客）客がカードで9800円支払ったデータということになります。 上記のようなデータ構造で現金の売上のみ、カード売上のみの集計などを行いたいのですが、 同一テーブル内の別レコードの値を条件に検索集計をSQL文だけで行うことは可能でしょうか？ 可能でしたらどのようなSQLを使用すれば良いのか教えていただけると幸いです。 よろしくお願い致します。
先日、オークションでPCを購入しました。 色々なソフトがインストールされていて、 そのなかにSQL server standard等がインストールされていました。 （ネットで調べると３０万円以上するもののようです） ここで質問なのですが、 （1）アカデミックバージョンと通常版を見分ける方法はありますか？ （ソフトがインストールされておりわかりません。買った相手もわからなくなりました。） （2）仮にバージョンアップする場合、いまインストールされているのが アカデミックバージョンでそれを通常バージョンに変更することは可能ですか？ （3）このインストールされているソフトは利用して問題ないでしょうか？ （4）なにか追加的に（定期的に3年に1度等）発生する追加費用はありますか？ 以上、DBやライセンスに詳しい方からの回答をお待ちしています。 お手数をおかけいたしますが、宜しくお願い致します。
知人のプログラマーとの会話の中で「オラクルやSQLサーバなどのデータデース技術は人類が創り出した英知の結晶の１つだ」と言われました。その意味がよくわかりませんので教えていただければ幸いです。その２つはデータベースを管理する機能を持った主要なソフトだというのはわかるのですが、英知の結晶と言うに値する理由をお願いします。
下記のような構成で構築したWebシステムがあります。 OS：Windows Server 2008 Standard 言語：VB.NET DB：SQL server 2008 それを下記の構成の環境へ移植しようと思いました。 OS：Windows Server 2008 Standard 言語：VB.NET DB：SQL server 2008 ExpressEdition 移植したところSQLserverへの接続がうまくいかず、試行錯誤した末にSqlConnectionの接続文字列のsourceの部分をサーバ名のみに変更したところ、接続することが出来るようになりました。 【変更前】 workstation id=xxx;packet size=4096;user id=user;data source="servername\instance";persist security info=True;initial catalog=xxxdb;password=xxxxx 【変更後】 workstation id=xxx;packet size=4096;user id=user;data source="servername";persist security info=True;initial catalog=xxxdb;password=xxxxx 上記のsourceの部分は「サーバ名\インスタンス名」でよいと思うのですが（現に移植元の環境では接続できているので）、ExpressEditionの環境だとインスタンス名まで含めるとなぜか接続できません。 環境によっていちいち接続文字列を変更したくないのですが、ExpressEditionの場合は変更が必要なものなのでしょうか？それとも、何か設定が不足している等の原因でしょうか？ご存知の方がいらっしゃいましたら、ご教授いただけると幸いです。
現在、仕事で複数のSQL Server2008 R2 がある環境で開発を行っているのですが、 何故か、sqlcmdを実行した際の結果メッセージ表示されないDBがあります。 （「(10件処理されました)」等のメッセージです。） メッセージの出るDBと出ないDBで、サーバーのプロパティやDBのプロパティを比較したりしたのですが、何が違うのかわかりませんでした・・・。 どなたか心当たりがある方はご教授願えませんでしょうか。
SQLで複数レコードにある値を合計したときに値が正しいか検査をして、整合性が取れないものを抽出したいのですが・・・ 例えば、イラストのようにテーブルがあるとします。 実験管理番号、バージョンがキーになっております。 変化履歴というのは分数を文字列型で入れているものです。 AAA001で行けば、２０回の検査をしています。 まず、５回目に変化、その後 １１回後の１６回目、その後 ２回後の１８回目、その後 ２回後の２０回目とレコードを作成しています。 つまり分母と分子の合計が一致しなくてはいけません。 ただ、その中でも BBB001のV1 と TTT005のV7データが 分母と分子の数が一致しません。 こういったデータを抽出させたいのですが、文字列データでもあるためどのように不適切データを検索したらいいのか悩んでいます。 詳しい方いらっしゃいましたらご教示いただけませんでしょうか？
ユーザが指定したブログエントリに最初に記載されたコメントと、そのコメントに追加されたコメントの一覧を表示するSQLを作成したいです。 ユーザはコンボボックスでエントリ番号一覧から特定のブログエントリを指定します。そのブログエントリに最初に投稿されたコメントが表示されます。 また、そのコメントにレスするコメントがあれば、それらのコメントも表示されます。 関連テーブル ●ブログエントリ エントリ番号（主キー） ●コメント コメント番号（主キー） エントリ番号（外部キー） コメント内容 投稿日（例：2011/10/01） 元コメント番号 ユーザが指定したブログエントリに複数のコメントがあった場合、最初に投稿されたコメントと、そのコメントにレスされたコメント（「元コメント番号」が一致するもの）のみを表示したいです。下記の画像がイメージです。 この場合、どういったSQLを書けばいいでしょうか？ ご教示よろしくお願いいたします。
SQL serverにてデータの管理をしてます。SELECT文について質問なのですが、 例えば、取引先データが入っているテーブルを「A_取引先」とします。 また、ここ何年かの売上データが入っているテーブルを「B_売上」とします。 今回、取引先整理のため売上データ(B_売上)にない取引先を取引先データ(A_取引先)から抽出したいのですが、どのように書けばよいでしょうか not inを使っても「B_売上」にまったくない取引先は抽出されません。 分かりにくい文章かもしれませんが、ご教授の程よろしくお願い致します。
SQLserver2005を使っています。 Management Studioで クエリの結果のコピー時に列のヘッダーを含める場合 クエリ→クエリオプション→結果→グリッドの 「結果のコピーまは保存時に列のヘッダーを含める」 にチェックを入れれば可能ですが これをデフォルトにすることは可能でしょうか？ 新しいクエリを立ち上げる度にこのチェックを入れるのは面倒です。 宜しくお願いします。
NO　科目 ------- 　1 国語 　2 英語 　3 算数 　4 国語 　5 国語 　6 算数 の様なテーブルがあった場合、科目でグループ化した時のグループ数を取得したい。 上の例だと、科目は、「国語、英語、算数」なので 　３ のカウントを返したい この場合の、SQL文が分かりません。 分かる方、よろしくお願いします。
MySQLからWindowAzureに移行しています。 1.identityが設定されている値の変更 auto_incrementが使えないようなので、identityを使用して下記のテーブルを作成しました。 ですが、identityだと更新ができないので困っています。 CREATE TABLE test ( id int NOT NULL identity, text nvarchar(255) NOT NULL, PRIMARY KEY (id), ); データの追加に関しては、IDENTITY_INSERTをONにすることでできますが、更新時はどうすればよいでしょうか？ データの追加の場合は、使用の際上記のように、毎回ONにする必要がありますか？（DB接続時にONにしてしまえばよい/テーブル作成時に記述で可能ではない？） 複数個所から更新をするので、すべての箇所に記述するのは可能な限りしたくありません。 2.データの自動更新 テーブルを更新した際に、データを自動で更新したいのですが、mysqlでは on update で可能ですが、 SQLAzureでは、下記のSQLをどのように記述すればよいでしょうか？ create table time( id int not null, time1 datetime NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP, PRIMARY KEY(id) ); よろしくお願いします。
　　SQLServer2005の一般的な容量管理について教えて下さい。 ・テーブルは通常は自動拡張されるものなのでしょうか？ ・テーブル容量の上限値を設定しておいて、たとえばしきい値として80%超えとなったら 　イベントログのほうに警告を出すなど可能でしょうか？
oracleからSQL Serverへ移行することになったのですが、副問い合わせで定義したテーブル同士を外部結合するSQL構文が、うまく実現できず、ご教授して頂きたくよろしくお願いします。 下記、oracle 構文をSQL Server構文へ書き換えたい。 select * from (select cal1,cal2,cal3 from tbl1,tbl2 where cal1 >100) aaa, (select cal1,cal2,cal3 from tbl1,tbl2 where cal1 <=100) bbb, tbl3 where aaa.cal1 = bbb.cal1(+) and aaa.cal2 = bbb.cal2(+) and aaa.cal3 = bbb.cal3(+) and aaa.cal1 = tbl3.cal1 よろしくお願いします。
下記のスペックで処理を行っていますがメモリ不足になり 処理が止まってしまいます。 対応方法を考えましたが・・知識が少ないので以下の程度しか 思いつきません。 １．メモリの増設 ２．SQLServerの設定　AWEを有効にする。（現在は未設定） ご存知の方がいらっしゃればご教示願います。 よろしくお願いいたします。 OS:Windows2008Server SQLServer：SQLServer2008R2 メモリ：２GB
以下のようなテーブルがあり、 区分に金額1、金額2、金額3、金額4どれかに金額があれば抽出するという SQL文を教えていただければと思います。 (SQLSERVER2008を使用しています) 名称 　| 日付 | 金額1 | 金額2 | 金額3 | 金額4 テストa |　　1　　| 50000 | 金額2 | 金額3 | 金額4 テストb |　　1　 | 金額1 | 50000 | 50000 | 金額4 テストc |　　2 | 金額1 | 金額2 | 50000 | 金額4 テストd |　　1 | 金額1 | 金額2 | 金額3 | 金額4 テストe |　　1 | 金額1 | 金額2 | 金額3 | 50000 テストf |　　1 | 50000 | 金額2 | 50000 | 金額4 テストg |　　2 | 50000 | 金額2 | 金額3 | 金額4 テストh |　　3 | 金額1 | 金額2 | 金額3 | 金額4 テストy |　　4 | 金額1 | 50000 | 金額3 | 金額4 テストj |　　5 | 金額1 | 50000 | 金額3 | 金額4 テストk |　　1 | 金額1 | 金額2 | 金額3 | 50000 テストl |　　1 | 50000 | 50000 | 50000 | 金額4 テストm |　　5 | 金額1 | 金額2 | 50000 | 金額4 テストd |　　5 | 金額1 | 金額2 | 金額3 | 金額4 テストd |　　5 | 金額1 | 金額2 | 金額3 | 50000 例でいくとテストdとテストhの金額1、2、3、4には金額が はいっていないので結果はそれ以外ということです。 また、結果はすべての項目を表示させたいと思っております。 （テストdとテストh以外のレコードの名称 日付 金額1 金額2 金額3 金額4 を表示する） SQL初心者のため、 どうかご教授いただきたいと思います。 よろしくお願いします！！
お願いします。 SQLSERVERで、テーブル項目の指定文字列を削除したいのですが その削除したい文字列が複数あります。 例えば、商品マスタ 商品コード　|　商品名 | 0001 | black-001.a 0002 | black/001 a とある時、商品名からピリオド、カンマ、ハイフン、スペース、スラッシュ を一度に削除したいです。 そしてその項目をビューで使用したいです。 Replace関数だと一度に一つしか削除できないようなので何か方法がないかと 思案しております。 ふと、関数を作成してできないのかと考えたのですがどうなのでしょうか？ ※作成した事がないので・・・・ また他によい方法があればご教授お願いいたします。
Microsoft SQL SERVER 2005でデータ更新/追加時に起動するトリガーを 作成したいのですが記述方法がわかりません。 テーブル:TBL_SHOHIN SHOHIN_NAME NVARCHAR(50) /* 商品名 */ SAKUSEI_DATE datetime /* 作成日付 */ KOSHIN_DATE datetime /* 更新日付 */ このTBL_SHOHINテーブルに追加があった時は、作成日付(SAKUSEI_DATE)にシステム日付をセット このTBL_SHOHINテーブルに更新があった時は、更新日付(KOSHIN_DATE)にシステム日付をセット 更新時は下記の記述でうまくいったのですが、追加時をどう記述すればいいの でしょうか？ create TRIGGER trgSHOHIN ON TBL_SHOHIN FOR INSERT, UPDATE AS BEGIN UPDATE TBL_SHOHIN SET KOSHIN_DATE = GETDATE() END RETURN
CSVをバルクインサートでitemテーブルにBULK INSERTする際に、 下記のようなSQL文を使っているのですが、CSV内のブランク文字は 実行後にNULLになってしまいます。 やりたいことはNULLではなく空白文字（""）にしたいのですが、 下記のSQL文をどのように変えればよいのでしょうか。 または、CSVを変更する方法でもよいです。 BULK INSERT item FROM 'c:\test.txt' WITH ( FIELDTERMINATOR = ',', ROWTERMINATOR = '\n' ); 大変お手数ですが、 わかる方がいらっしゃいましたらよろしくお願いいたします。
Visual C# 2010 Expressをインストールして、 ついでにMicrosoft SQL Server 2008 Express Service Pack 1(x86)をダウンロードしたのですが、 こちらでいわゆるSQL Serverは使えないものなのでしょうか？ 自宅用のパソコンにVisual StudioとSQL Serverを使って、いわゆるWebアプリケーションを作りたいと思っております。 宜しくお願いいたします。
SQL server 2000で接続セッションのIPアドレスをトリガーでテーブル登録する方法を教えてください。あるテーブルの「更新IPアドレス」という文字列項目に、そのレコードが固定編集された時にクライアント端末のIPアドレスをトリガーで、登録したいのですが、方法を教えてください
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- ストアド内でカラム名一覧を取得、カンマで繋げてひとつの変数にまとめたい。 =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 現在開発でストアドを使用する機会があり、そこで不明点が発生し悩んでおります。 以下、現状と質問です。 ■SQL SERVER 2000 ■テーブル(※)のカラム名一覧を取得し、 　カラム名をカンマで繋げてひとつの変数に格納したいと思っています。 　※先の処理でカラムを取得したいテーブルをSELECTしており、 　対象のテーブル名を変数に代入しています。 　カラム一覧を取得するにあたり、以下のようにカーソルで習得し、 　FETCHでカラム名を変数に格納しようと考えていましたが、 　「'対象テーブル名'」には変数がいれられないので、どうしようかと悩んでいます。 　DECLARE CURS_test CURSOR FOR 　 SELECT name FROM dbo.syscolumns 　 WHERE id IN 　 (SELECT id FROM dbo.sysobjects WHERE name = '対象テーブル名') 　 ORDER BY id, colid; 　「sp_executesql」を使用してselect文を流そうとしたのですが、 　複数ある列名を取得して、上記で記載しましたように 　カラム名をカンマで繋げてひとつの変数に格納する方法がわかりませんでした。 　こういった場合、どのように考えて、どのように書けばよいのでしょうか。 　まだ触り始めたばかりで、わからないことがわかっていない部分もあり、 　質問内容でわかりにくい部分がありましたらご指摘いただければと思います。 　どうぞよろしくお願いいたします。
SQLServerのSQL文です。 dbo_TblAには以下のようなデータが2行入っています。（重複している） SYAINCD XXXXX StartDT 2011/1/1 EndDT 2011/12/31 YuukouDT 2011/1/2 以下のSQL文を発行すると、1行だけの結果を返してくるのですが 理由が分かりません。 まったく見たことのないSQL文の書き方なのでどう解釈してよいか分からず 困っています。 解釈いただけると大変助かります。 SELECT H.DT_Date, H.DT_EndDate FROM dbo_TblA AS H WHERE (((H.SYAINCD)="XXXXX") AND ((H.StartDT)=(SELECT MAX( K.StartDT) FROM dbo_TblA K, dbo_TblA L WHERE K.SYAINCD = H.SYAINCD AND L.SYAINCD = K.SYAINCD AND L.StartDT = K.StartDT AND L.YuukouDT = K.YuukouDT AND L.StartDT <= #2011/04/20#)) AND ((H.YuukouDT)=(SELECT MAX(H_ED.YuukouDT) FROM dbo_TblA H_ED WHERE H.SYAINCD = H_ED.SYAINCD AND H.StartDT = H_ED.StartDT AND H_ED.YuukouDT <= #2011/04/20#)));
sqlserverでデータを削除した件数を知りたいのですが 何か簡単な方法はありませんか sqlserverでデータを削除してvb.net上でその件数を知りたいので
マイクロソフト アクセス '９７をかなり前に作成した分を今回久しぶりに使用しおうと思いましたが、リンクさせているエクセル表がどこに存在しているのか？の確認方法を教えてください
SQL serverの勉強始めたいのですが 1番重要なところを 教えてください
下記Ａテーブルのレコード統合して、統合後のようにしたいと思っています。 似たようなものをネットや本で探し、構文を装飾して色々試してみてますが なかなかうまくいきません。SQLで実行したいのですが、お分かりになる方が いらっしゃいましたら構文を教えていただきたいです。何卒、よろしくお願いいたします。 ◆Ａテーブル：統合前 （実際は"ポータルサイト"レコードは数千件、"かな"フィールドは1～200まである） -------------------------------------------------------------------- ポータルサイト名　　　　　　かな１　　　　　　　　　かな２　　　　　かな３　　　　　かな４ ｇｏｏ　　　　　　　　　　　　　　 ぐー　　　　　　　　　　 ぐう　　　　　　 ごー ＹＡＨＯＯ！　　　　　　　　　 やっふー　　　　　　　やっほー　　　ヤフー　　　　　 Ｇｏｏｇｌｅ　　　　　　　　　　　　グーグル　　　　　　　ぐぐる　　　　　ぐーぐる ＭＳＮ　　　　　　　　　　　　　 えむえすえぬ　　　 ＹＡＨＯＯ！　　　　　　　　　　やっふー　　　　　　　やっほー　　　ヤホウ ｇｏｏ　　　　　　　　　　　　　　 ぐー　　　　　　　　　　 GOOO ◆Ａテーブル：統合後 ※※ポータルサイト名でかなを統合（重複しているかなは削除） -------------------------------------------------------------------- ポータルサイト名　　　　　　かな１　　　　　　　　　かな２　　　　　かな３　　　　　かな４ ｇｏｏ　　　　　　　　　　　　　　 ぐー　　　　　　　　　　 ぐう　　　　　　 ごー　　　　　　GOOO ＹＡＨＯＯ！　　　　　　　　　 やっふー　　　　　　　やっほー　　　ヤフー　　　　　ヤホウ Ｇｏｏｇｌｅ　　　　　　　　　　　　グーグル　　　　　　　ぐぐる　　　　　ぐーぐる ＭＳＮ　　　　　　　　　　　　　 えむえすえぬ　　　 　　　　　　　　　　
Access2003でSQLクエリを用い、カレンダーリスト（テーブル名：T_カレンダー）の作成をしております。 カレンダーには、年月日、売上金、前日売上金、などの項目があります。 Tカレンダテーブルの内容 年月日 売上金 ■目的 「前日売上金」 に、 １レコード前、もしくは前日以前のレコード（※）の 「売上金」 のデータを格納したい。 ※前日以前のレコードとしたいのは 　カレンダーですので、年月日も営業日などの関係で、 　土日のデータなどは0円になることがあります。 （ちなみにデータ値がない場合は0を既定値でセット） その為、前日の売上金が0円だった場合、 最後の営業日の売上金データがあったもの（0円以外のもの）を持って来たいと考えています（※２）。 基本、+（プラス）値となりますが、-（マイナス）値も抽出したいと考えています。 ■ためしに SELECT t1.年月日, t1.売上金, t2.年月日, t2.売上金 AS 前日売上金 FROM Tカレンダ AS t1 LEFT JOIN Tカレンダ AS t2 ON t2.年月日 = DateAdd("d",-1, t1.年月日) ORDER BY t1.年月日; こんなSQLを組んでみました。1日前のデータは抽出できたのですが ※２の内容がどう組んでよいか、わかりません。 どうか、ご教授願います。 宜しくお願いいたします。
プログラム、proseeingでの >=←などの意味を教えてください。 他にも=< ←とかいろいろあったんですけど 覚えてません 参考になるサイトがあったらそちらもお願いします
テーブルがＡ・Ｂの２つあり、どちらも「ＩＤ」と「名前」が入っています。ＩＤをキーとして まずテーブルＡで検索して見つからなかった場合ばテーブルＢから検索するような Ｓｅｌｅｃｔ文は、どのような記述になるのでしょうか？また、ビューとして定義する場合には どのような方法になるのでしょうか？よろしくお願い致します。
Access2007とSqlServer2008を使用しています。 Accessで作成したテーブルを「データベースツール」-「データの移動」でSqlServerに移行してリンクする際、 (1)SqlServerに新規にデータベースを作成すると、リンクテーブルマネージャから見てもリンク先DBが正しく表示されますが、 (2)その後、その既存DBに同じAccess内の別のテーブルを、「データベースツール」-「データの移動」してリンクしたものは、リンクテーブルマネージャから見てもリンク先DBが　()となっており表示されていません。 ツールとしてSqlServer Management Studioを使っていますが、そこからでも(1)のテーブルは表示されていますが、(2)のテーブルは表示されません。 でもリンクはできているようなのです。 また、SqlServer Management Studioを使って、SqlServer内に新規テーブルを作成し、 それをAccessからリンクしようとしても、テーブルリンク一覧内に表示されない状態です。 （「外部データ」-「ODBCデータベース」…）にて　SqlServerのファイルデータソースを表示しています） (2)のテーブルはSqlServer Management Studioから見ることができないため、更新・削除もできず困っています。 DB、テーブル、リンク方法等、何か問題があるのでしょうか？ よろしくお願いします。
以下のようなテーブルがあり、 区分に2、3、4があれば抽出しないという SQL文を教えていただければと思います。 (SQLSERVER2000を使用しています) 名称 　　　| 区分 テストa |　　1 テストa |　　1　 テストa |　　2 テストb |　　1 テストb |　　1 テストc |　　1 テストc |　　2 テストc |　　3 テストc |　　4 テストc |　　5 テストd |　　1 テストd |　　1 テストd |　　5 テストd |　　5 テストd |　　5 例でいくとテストaは区分が1、1、2で 2がはいっているので抽出しない。 テストbは1、1なので抽出する。 テストcは1、2、3、4、5で2、3、4がはいっている ので抽出しない。 テストdは1、1、5、5、5なので抽出する。 つまり結果としては テストaとテストdが抽出されるということです。 質問もままならないほどSQL初心者のため、 どうかご回答いただきたいと思います。 よろしくお願いします！！
SQL server2008 R2で作成したデータベースをSQL server2005で使用したいと考えてます。事情があり、SQL server2005にはSSISがインストールされておらず、追加する事も出来ません このためデータベースのアタッチか、リストアにより、上位バージョンである SQL server2008 R2で作成されたデータベースを、会バージョンである SQL server2005で使用したいのですが エラーとなってしまいます。 もし何らかの方法でダウングレードできるようであれば 方法を教えてください
＜環境＞sqlserver SQLでパラメータが空白であれば全件取得、パラメータに値が設定されている場合には 条件にHITするデータを抽出したいのですが、一本のクエリで抽出することができるのでしょうか？ 空白時パラメータは以下のとおり入ってきます。 @no＝""…完全一致 @name＝"%%"…部分一致 例） SELECT * FROM テーブル WHERE (NO = @no) and ((@name IS NULL) OR (@name IS NOT NULL) AND (NAME LIKE @name)) NAMEは上記クエリにて取得できています。 NOのところはどのようにすればよいでしょうか？
SQLserver2005環境です。 テーブルA (年月とIDでユニーク) 年月　　　　　　ID　　　体重 --------------------------- 2011年01月　　1　　　50 2011年02月　　1　　　51 2011年02月　　2　　　40 2010年12月　　3　　　59 2011年01月　　3　　　60 2011年02月　　3　　　61 2011年01月　　4　　　70 のようになっていた場合、年月を2011年02月で抽出をかけた際に 今月体重を2011年02月、前月体重を2010年01月とし 年月　　　　　　ID　　今月体重　　前月体重 --------------------------------------------- 2011年02月　　1　　　　51　　　　　　50 2011年02月　　2　　　　40　　　　　　Null 2011年02月　　3　　　　61　　　　　　60 ↑の様な結果を得られるSQLを書きたいのですが、うまく作れず困っています。 ご教授いただけないでしょうか？ よろしくお願いします。
現在、職場で2008R2の環境でSPを書いているのですが、エラーメッセージの取得方法がわかりません。 「@@error」でエラー番号は取得できますが、同じような感じでメッセージは取得できないでしょうか？ error_messageが使えれば楽なのですが、開発ルール上TRY～CATCHが使えないので・・・。 どなたか、ご教授願います。
いつもご参考にさせて頂いております。 今回VB2005ProfessionalとSQLServer 2005Developer Editionでシステムを開発しようと考えております。PCはWin7Pro64bitです。 VB2005は少し経験があるのですが、SQL Serverを使用するのが初めてです。 以前はSQLServerの代わりにAccessをデータベースとして使用していました。 そこでご質問です。 SQLServerもAccessと同様にOracle10gと接続し、 出来たデータベースをサーバー又は端末にセットし、 数人が使用できるシステムを構築することは可能でしょうか？ 実際プログラムを使用するPCはVista32bit or Win7 32bitです。 ※システムはデータの取込、出力、新規作成、更新、削除等一通りの動作をします。 又、この様な構築に関して詳しく解説している本など参考（勉強）になるものがございましたら、是非教えてください。 SQLServerに関して素人なので、どなたかご教授宜しくお願い致します。
SQL Server（バージョン不明）について、2つのフィールドからデータを検索したいのですが、できません。 1つのフィールドならできるのですが、どのような構文にすればいいのでしょうか？ 自分が実際に、SQL Serverを使う事ができず、現在どのような構文になっているか、バージョンは何か、申し訳ないのですがわかりません。 ご回答の程、どうぞよろしくお願い致します。
テーブル結合に関するSQL文について質問させてもらいます。 DBはSQLServer2005です。 下記のような二つのテーブルがあります。 テーブルA コード A111 A111B A222 A333 テーブルB コード　　　　数量　 A111　　　　　1 A111B　　　　2 A222　　　　　3 A222B　　　　4 上記２つのテーブルから下記の結果を表示させたいのです。 コード　　　　数量　 A111　　　　　1 A111B　　　　2 A222　　　　　7 A333　　　　　0 テーブルBのコードがテーブルAにある場合、そのまま数量を表示。 ない場合、コードの4桁目まででサマリした合計値を表示させたい。 LEFT JOIN等をいろいろためしてみたのですがうまくいきません。 おわかりの方、方教えてください。 　 　
先日にこちらの掲示板でご親切な方からアドバイスをいただき 試した結果、以下の通り若干の不具合が発生し、再度ご質問する次第です。 恐縮ながら以下にご教授いただければ幸いです。 テーブルは以下で仮定します。 ・注文テーブル 購入日　レジコード　顧客コード　顧客種別　商品NO購入金額　購入個数　年代 2011/01/01　111111　123456　通常　100　¥100　1　20代 2011/01/02　111112　129999　通常　100　¥300　3　50代 2011/01/02　111112　129999　通常　200　¥200　1　50代 2011/01/02　111112　129999　通常　500　¥500　2　50代 2011/02/01　111113　122222　新規　100　¥100　1　90代 2011/02/05　111114　133333　新規　400　¥400　1　10代 2011/02/11　111115　144444　通常　1000　¥1,000　1　30代 2011/02/11　111115　144444　通常　100　¥100　1　30代 2011/03/01　111116　155555　新規　100　¥300　3　20代 2011/03/01　111116　155555　新規　200　¥400　2　20代 2011/03/05　111117　166666　通常　500　¥250　1　30代 2011/03/15　111118　177777　通常　400　¥800　2　40代 2011/03/16　111119　188888　通常　100　¥100　1　50代 2011/03/16　120000　123456　通常　100　¥1,000　10　20代 2011/03/16　120000　123456　通常　400　¥400　1　20代 2011/03/16　120000　123456　通常　200　¥400　2　20代 2011/03/30　121000　144444　通常　100　¥300　3　30代 2011/03/30　121000　144444　通常　1000　¥3,000　3　30代 2011/03/30　121000　144444　通常　500　¥750　3　30代 ・割引テーブル 商品NO　商品名開始日終了日 100 ごはん 2011/03/01 2011/03/30 100 ごはん 2011/01/01 2011/01/31 抽出したい内容 (1)注文テーブルにある購入日で日付を指定の上、（betweenで2010/06/01-2011/05/31までなど） 商品NOを特定の1品目、もしくは複数選択をした上で、その商品に対する期間内の購入数・購入金額を求めたい。 ただし、"割引テーブル"に差し掛かる期間のみ、別の列で分けて表示させたい。 （つまり割引期間と通常期間を列で分けることで売上の差を見極めたいのです。） これを以下の構文で試してみました。 SELECT t.購入日, t.商品NO, Sum(iif(t.購入日<w.開始日 or t.購入日>w.終了日,t.購入個数,0)) AS 通常購入, Sum(Switch(t.購入日<w.開始日 Or t.購入日>w.終了日,0,True,t.購入個数)) AS 割引購入, Sum(Switch(t.購入日<w.開始日 Or t.購入日>w.終了日,t.購入金額,True,0)) AS 通常購入金額, Sum(Switch(t.購入日<w.開始日 Or t.購入日>w.終了日,0,True,t.購入金額)) AS 割引購入金額 FROM 注文テーブル AS t INNER JOIN 割引テーブル AS w ON t.商品NO = w.商品NO WHERE (((t.商品NO)=100) AND ((t.購入日) Between #1/1/2011# And #3/30/2011#)) GROUP BY t.購入日, t.商品NO; 実行結果 購入日　商品NO　通常購入　割引購入　通常購入金額　割引購入金額 2011/01/01　100　1　1　¥100　¥100　　　　　 2011/01/02　100　3　3　¥300　¥300　　　　　 2011/02/01　100　2　0　¥200　¥0 2011/02/11　100　2　0　¥200　¥0 2011/03/01　100　3　3　¥300　¥300 2011/03/16　100　11　11　¥1,100　¥1,100 2011/03/30　100　3　3　¥300　¥300 上記のようになりました。 上記の割引テーブルで仮定すると、1月と3月の売り上げは”割引購入"と"割引購入金額"に記載され、2月の分は"通常購入"と"通常購入数"にその時の売り上げを出したいと考えております。 現在の結果の場合、割引テーブルで設定された割引期間内の"通常購入"と"通常購入数"にも数字が入ってしまっています、、。 理想の抽出結果は以下の通りです。 購入日　商品NO　通常購入　割引購入　通常購入金額　割引購入金額 2011/01/01　100　0　1　¥0　¥100　　　　　 2011/01/02　100　0　3　¥0　¥300　　　　　 2011/02/01　100　2　0　¥200　¥0 2011/02/11　100　2　0　¥200　¥0 2011/03/01　100　0　3　¥0　¥300 2011/03/16　100　0　11　¥0　¥1,100 2011/03/30　100　0　3　¥0　¥300 （2)注文テーブルにある購入日で日付を指定の上、（上記(1)と同様）商品NOを特定の1品目、もしくは複数選択をした上で、年代別で顧客種別ごとの客数を知りたい場合 ※上の客数は顧客種別かレジコードをカウントすれば良いと思いますが、一人のお客様が一回の会計で5品目買ったらレコードは5つになるため、重複を防ぐ必要があります。（対象の品物を何回購入したことがあるか表示したいので、、） また、"顧客種別"は通常・新規・フリーの三種類の言葉で分類分けされて登録されてますが、通常のみ、設定した抽出対象期間前にも1回でも購入があれば"リピート"としてカウント、過去に購入なく抽出対象期間内で初めて購入があった場合は"初めて"にカウントしたいです。 これを以下構文で試してみました。 SELECT t.商品NO , t.年代 , sum(switch(t.顧客種別='通常' and k.顧客コード is not null, 1 , true ,0)) as リピート , sum(switch(t.顧客種別='通常' and k.顧客コード is not null, 0 , true ,1)) as 初めて , sum(switch(t.顧客種別='新規' , 1 , true ,0)) as 新規 , sum(switch(t.顧客種別='フリー', 1 , true ,0)) as フリー FROM 注文テーブル t LEFT JOIN (SELECT 顧客コード FROM 注文テーブル WHERE 購入日<#2011/02/28#) k ON t.顧客コード = k.顧客コード WHERE t.購入日 between #2011/03/01# and #2011/03/31# and t.商品NO = １00 GROUP BY t.商品NO, t.年代 抽出結果 商品NO　年代　リピート　初めて　新規　フリー 100　20代　1　1　1　0 100　30代　2　0　0　0 100　50代　0　1　0　0 たとえば、3月1日～3月31日までの期間で抽出をすると 商品NO100の商品を買った30代のリピートの方は1名（顧客NO144444）だけに なると思いますが、抽出結果では2名になってしまいます。 ・対象の商品"100"を設定した対象期間内（上記の構文でいうと2011/03/01-2011/03/31) でしか購入がなかった場合は"初めて"としてカウント ・対象の商品"100"を設定した対象期間内（上記の構文でいうと2011/03/01-2011/03/31) で購入があり、且つその設定日付以前にも同じ商品の購入があった場合は"リピート"として カウント（設定日以前に同じリピート客が同じ商品を100回買ったとしても、100カウントではなく１カウント）リピートのお客様が"何回買ったか？"ではなく、"リピートしてる人が何人いるか？"を表したいのです。 これがが出来ないか頑張っています、、。 一番上のテーブルを仮定して理想の抽出結果は 商品NO　年代　リピート　初めて　新規　フリー 100　20代　1　0　1　0 100　30代　1　0　0　0 100　50代　0　1　0　0 お手数をおかけしますが、なにとぞご教授をお願いいたします。
【至急で知りたいです】アクセス ＳＱＬ文について アクセス・クエリについて初心者であり、恐縮ではございます。 以下を求めたい時にどのようなＳＱＬで注文をすればよいかご指導いただきたいです。 内容： ・注文テーブル： 列は購入日・顧客コード・顧客種別・年代・レジコード・商品ＮＯ・商品名・購入数・購入金額 2011/05/01 11111 通常 30代 12345 9999 お菓子 1 500 2011/05/01 11111 通常 30代 12345 9998 ご飯 2 1000 2011/05/01 11112 新規 10代 12346 9999 お菓子 1 500 ・期間限定割引テーブル 列は商品NO・開始日・終了日 9999 2011/04/10 2011/04/20 9998 2011/05/01 2011/05/10 抽出したい内容 (1)注文テーブルにある購入日で日付を指定の上、（betweenで2010/06/01-2011/05/31までなど） 商品NOを特定の1品目、もしくは複数選択をした上で、その商品に対する期間内の購入数・購入金額を求めたい。 ただし、"期間限定割引テーブル"に差し掛かる期間のみ、別の列で分けて表示させたい。 （つまり割引期間と通常期間を列で分けることで売上の差を見極めたいのです。） 例えば、商品NOを9998で指定した場合の希望内容 購入日 商品No 商品名 通常購入数 割引購入数 通常購入金額 割引購入金額 2011/05/01 9998 ご飯 0 100 0 50000 2011/05/11 9998 ご飯 30 0 24000 0 (2)注文テーブルにある購入日で日付を指定の上、（上記(1)と同様）商品NOを特定の1品目、もしくは複数選択をした上で、 年代別で顧客種別ごとの客数を知りたい場合 例えば、商品NOを9998で指定した場合の希望内容 商品NO年代 リピート 初めて 新規 フリー 9998 10代 2000 500 100 30 9998 20代 3000 1000 200 50 9998 30代 5000 1050 400 100 ← 客数です。 ※上の客数は顧客種別かレジコードをカウントすれば良いと思いますが、一人のお客様が一回の会計で5品目買ったらレコードは5つになるため、重複を防ぐ必要があります。（対象の品物を何回購入したことがあるか表示したいので、、） また、"顧客種別"は通常・新規・フリーの三種類の言葉で分類分けされて登録されてますが、通常のみ、設定した抽出対象期間前にも1回でも購入があれば"リピート"としてカウント、過去に購入なく抽出対象期間内で初めて購入があった場合は"初めて"にカウントしたいです。 複雑かもしれませんが、どなたかご指導をよろしくお願いします
SQL2000環境からSQL2008環境へ変更予定です。 このお客様の環境がSQL2000のDTSを利用してbatやらvbsやらexeが多数動いており しかもDTSでスケジューリングされています。 SQL2008ではDTSは推奨していないとのことから、何か手段はないか模索しています。 Windowsのタスクでも良いのですが、DTSのようなログ出力ができないことと DTSのような一連の流れにならないので困っています。 SQL2008でジョブ管理のような機能がありますが、DTSのようにbatなどを登録する方法が 分かりません。 質問があやふやで申し訳ありませんが、何でも良いので知識を持ち合わせの方 教えて頂けると助かります。
アクセスのファイルが２個あります。 １つはAAA.mdb。もう１つはAAADB.mdbです。 AAAを開くと、AAADBが連動するシステムになっています。 今、両方が入っているServerの状況が悪くなっているので、それらを自分のPCにコピーしました。 Serverを停止し、AAAを開くと、かつてAAADBが存在していたパスに接続できないエラーが発生します。 そこで、実在するAAADBのパスを設定したいと思っていますが、その方法が解りません。 是非ともお教え下さい。 この２個のファイルは、私だけが使用しているので、他人との共用は考える必要ありません。
初めてSQLSERVER2008を使用します。 現行Sqlserver2000を使用していて、接続するのにＯＤＢＣ（V2000.85.1132.00)を使用しています。このＯＤＢＣでＳｑｌｓｅｒｖｅｒ２００８に接続するＯＤＢＣを作成しようとしていますが、sqlserverエラー17（sqlserverが存在しないかアクセスが拒否されました）というエラーが出てしまいます。 また、sqlserver ｎａｔｉｖｅ　client10.0でもsqlserverエラー121で接続出来ません。 サーバー側に何か設定が必要なのでしょうか。 アドバイス何卒宜しくお願い致します。」
下記の様なWHERE句を使っていますが、注釈の部分を生かす 極端に時間がかかるようになってしまいます。 (注釈は他の行でも大丈夫です、2～3行殺せば早くなります) なにか制限でもあるのでしょうか? WHEREu.締日コード=@締日コード ANDu.入庫日付<=@終了日付 ANDu.部門コード=isnull(@部門コード,u.部門コード) ANDu.分類in('輸入','輸出') ANDu.分類=isnull(@分類,u.分類) ANDu.仕訳コード=isnull(@仕訳コード,u.仕訳コード) ANDu.商社=isnull(@商社,u.商社) --下記を復活すると遅くなる(4秒→38秒) --ANDu.保管河岸コード =isnull(@保管河岸コード,u.保管河岸コード) --ANDu.品名コード=isnull(@品名コード,u.品名コード) AND(u.在庫員数<>0 orISNULL(a.当期出庫員数,0) <>0 orISNULL(b.出庫員数,0)<>0 oru.在庫重量<>0 orISNULL(a.当期出庫重量,0) <>0 orISNULL(b.出庫重量,0)<>0)
「Access」で下記のように記述するものを「SQL Server」に置き換えた場合、 どのように記述する事になるのでしょうか。 SELECT Max(CLng(mid(TestId,4,10))) AS MAX_pti_patient_id FROM patient_info WHERE TestCd1 = 1 and TestFlg = 1 どなたか分かる方がいましたら教えて下さい。 よろしくお願い致します。
sql whereの質問なのですが、 社員マスタに退職日があり、退職日が入っているデータのみ抽出しようとしています 退職日には、日付orNullが入っています。 where 退職日 is date はエラーになったのですが どう書けば良いですか？ 宜しくお願いします。
以下の様なデータがあります。 　　　　　　氏名　　科目　得点 １行目　　Ａさん 　国語 100 ２行目　　Ｂさん 　国語 90 ３行目　　Ａさん　 英語 80 これを以下の様な表にしようと思い、 氏名　国語　英語 Ａさん 100 80 Ｂさん 90 - 以下のＳＱＬ分を書きましたが、Ａさんの得点が２倍になってしまいます。 SELECT SL.氏名 ,SUM(KT.得点) AS '国語' ,SUM(ET.得点) AS '英語' FROM [test_db].[dbo].[得点データ] SL LEFT OUTER JOIN ( SELECT * FROM [test_db].[dbo].[得点データ] WHERE 科目='国語' ) KT ON ( KT.氏名 = SL.氏名 ) LEFT OUTER JOIN ( SELECT * FROM [test_db].[dbo].[得点データ] WHERE 科目='英語' ) ET ON ( ET.氏名 = SL.氏名 ) GROUP BY SL.氏名 原因として、グループ化が結合の後にしているのだと考えています。 どの様に修正したら、いいでしょうか？
いつもありがとう御座います（ご回答いただいた皆様）。 ちょっと悩んでおりますので何かヒントを頂けたら・・・よろしくお願いします。 テーブルAに「会員No」と「来店ポイント」、という列があったとします。 テーブルBにも「会員No」と「来店ポイント」があったとします。 AB両方の会員Noは＝です。 テーブルAの「来店ポイント」が間違っているので、テーブルBの「来店ポイント」と 差し替えたいのですが、どの様なクエリになるのでしょうか？ 自力で何とかなるかな、、と思い2時間ほど粘りましたが、上手くいかないので・・・ （中堅外食チェーンの板前をしてますが、何故かサーバ管理者までしてます。 若いというだけで・・・そんな環境なので聞ける人も居らず、いつもここが頼りになってます。 すみません） 何卒、よろしくお願いします。
初めてSQL Server 2008 Expressを入れて使用しているのですが、 作成したテーブルに同一データをいれて、 SQL Server Management Studio から上位２００行編集を選択し その入れたデータを削除すると、エラーが発生して削除できません。 エラー内容は、 エラーメッセージ：行の値が更新または削除された為、行が一意になりません。または複数の行が更新されます。 特にプライマリキーの設定やインデックスなどは使用していないのですが、何か設定が必要なのでしょうか。 初歩的な質問で申し訳ありませんが、よろしくお願い致します。
SQL server 2005に接続可能な環境は、どのようなものがあるでしょうか？ SQL server 2005に接続する検索システムをC#２００５で構築しました。 C#の他にどのような開発環境、開発言語でSQL server2005に接続可能でしょうか？ PHPは、接続可能なようなことをWEBで見ました。 今はやりのAndroid端末やiPod,iPadからSQL serverに接続可能でしょうか？ もし、可能ならば開発環境、開発言語を教えていただければ幸いです。
Microsoft SQL Server 2005 Developer Editionを使用しています。 SQL Server Management Studio ＞ オブジェクトエクスプローラ ＞ データベース に使用中のDB一覧が表示されています。 エクスプローラでmdfファイルが保存されているフォルダを確認すると 上記にないデータベース名のmdfファイルがあります。 以前、作成して削除したDBのmdfファイルです。 質問です。 （1）オブジェクトエクスプローラに表示されず、mdfファイルが残っているのはどういう状況でしょうか。 私はいつもSQL Server Management Studioで削除したいDBを選択して、右クリック＞削除でDBを削除していますが、 mdfファイルが残ることもあるのでしょうか。 （2）ファイルサイズが非常に大きいため、上記状態のmdfファイルを削除したいのですが、 エクスプローラ上から削除しても問題ないのでしょうか。 削除前に「このmdfファイルは現在使用されていない」ことを確認したいのですが、 どのような方法があるのでしょうか。 前任者からDB管理を引き継いだのですが、上記状態で困っています。 既に前任者はいないため、聞くことが出来ません。 よろしくお願いします。
SQL Server2008のクエリの書式に関する質問です。 異なるテーブルを結合をする際の列名は、以下のようにピリオドを使って表現します。 ＜テーブル名＞．＜列名＞ これは、皆さん当然のように使われていると思います。 ここから質問ですが・・・。 異なるデータベースのテーブルを結合させる場合は、どうすればよいですか？ ＜データベース名＞．＜テーブル名＞．＜列名＞とするのでしょうか？（やってみたが、うまくいかなかったような気が・・・。） そもそも、異なるデータベース間では、テーブル結合できないのでしょうか？ ご指導よろしくお願いいたします。
社員のシフト管理表を作成しています。 visual web developer2008とSQL Server2005にて社内で利用するWEBアプリを作成しています。 CSVにてエクスポートしたいという要件が出てきており、その抽出条件が私には難しくお知恵をお借りしたいと思い投稿いたしました。 予定テーブル(tbl_yotei)には日付と必要人数と場所が入っており、社員予定テーブル(tbl_shain_yotei)には予定IDと社員名が入っています。 ■予定テーブル(tbl_yotei) yotei_id　　jishi_day　　　ninzu　　　shiten 1　　　　　　2011/7/1　　　2　　　　　支店A 2　　　　　　2011/7/2　　　1　　　　　支店A 3　　　　　　2011/7/3　　　3　　　　　支店A 4　　　　　　2011/7/2　　　1　　　　　支店B 5　　　　　　2011/7/3　　　2　　　　　支店B 6　　　　　　2011/7/4　　　3　　　　　支店A ------ ■社員予定テーブル(tbl_shain_yotei) shain_yotei_id　　　yotei_id　　　shain_nam 1　　　　　　　　　　　1　　　　　　　　田中 2　　　　　　　　　　　1　　　　　　　　山根 3　　　　　　　　　　　2　　　　　　　　杉下 4　　　　　　　　　　　3　　　　　　　　田中 5　　　　　　　　　　　3　　　　　　　　一条 6　　　　　　　　　　　4　　　　　　　　魚島 これを予定テーブルの人数分の行を表示し、その行にアサインされている社員が表示される表を作成したくご質問いたしました。 まだアサインされていない予定については社員はnullで人数分の行を作成したいと思います。 入力時の制限として予定テーブルに入力されている「人数」よりも多い数の社員は割り当てていません。予定テーブルのある行の人数が2なら社員予定テーブルの行数は0～2行までです。 ストアドプロシージャで予定テーブルに入っている人数分の行を出力する事は出来たのですが、そこから社員予定テーブルを参照して下記のような表になるようにする方法がわかりません。 例えば tbl_yoeti.yotei_idが3のレコードは3行表示し、shain_yotei_id.yotei_idが3のレコードは2行あるので2行はshain_namに社員の氏名が入り、1行はshain_namがnullのレコードを表示させたいです。 yotei_id　　jishi_day　　ninzu　　shiten　　shain_yotei_id　　shain_nam 1　　　　　　2011/7/1　　2　　　　支店A　　　　1　　　　　　　　田中 1　　　　　　2011/7/1　　2　　　　支店A　　　　2　　　　　　　　山根 2　　　　　　2011/7/2　　1　　　　支店A　　　　3　　　　　　　　杉下 3　　　　　　2011/7/3　　3　　　　支店A　　　　4　　　　　　　　田中 3　　　　　　2011/7/3　　3　　　　支店A　　　　5　　　　　　　　一条 3　　　　　　2011/7/3　　3　　　　支店A　　　　Null　　　　　　Null 4　　　　　　2011/7/4　　1　　　　支店B　　　　6　　　　　　　　魚島 5　　　　　　2011/7/5　　2　　　　支店B　　　　Null　　　　　　Null 5　　　　　　2011/7/5　　2　　　　支店B　　　　Null　　　　　　Null 6　　　　　　2011/7/6　　3　　　　支店A　　　　Null　　　　　　Null 6　　　　　　2011/7/6　　3　　　　支店A　　　　Null　　　　　　Null 6　　　　　　2011/7/6　　3　　　　支店A　　　　Null　　　　　　Null ---- 出来ているストアドプロシージャ CREATE PROCEDURE dbo.StoredProcedure2 DECLARE @yotei_id int DECLARE @jishiday datetime DECLARE @ninzu int DECLARE @shiten nvarchar(50) DECLARE c_yotei cursor FOR SELECT yotei_id,ninzu,jishiday,shiten FROM tbl_yotei CREATE TABLE #TMP ( yotei_id int,ninzu int, jishiday datetime, shiten nvarchar(50) ) OPEN c_yotei FETCH NEXT FROM c_yotei INTO @yotei_id, @ninzu, @jishiday, @shiten WHILE @@FETCH_STATUS = 0 BEGIN DECLARE @kaisu int SET @kaisu = 1 WHILE @kaisu <= @ninzu BEGIN INSERT INTO #TMP ( yotei_id,ninzu,jishiday,shiten ) VALUES ( @yotei_id,@ninzu,@jishiday,@shiten ) SET @kaisu = @kaisu + 1 END FETCH NEXT FROM c_yotei INTO @yotei_id, @ninzu, @jishiday, @shiten END CLOSE c_yotei DEALLOCATE c_yotei /* ここからどのようにしたらよいでしょうか。。 */ SELECT * FROM #TMP RETURN ---- 上記のストアドからでも全く新しいアイデアでもかまいませんので皆様お知恵をお貸しください。 どうかよろしくお願いいたします。
検索したいデータに空白がある時空白のない検索文字列でlike検索して データがヒットするようにしたいです col1 NTTデ　ー　タ NTTデ　－　タ　シ　ス　テ　ム　ズ NTTデ　ー　タ　ク　オ　リ　テ　ィ 日立製作所 IBM このようなカラムのデータが入っているとします ※空白を含むデータや空白を含まないデータがあるとします これを　select * from table1 where col1 like '%NTTデータシス%' とするとNTTデ　ー　タ　シ　ス　テ　ム　ズが検索されるようにしたいと思っています。 replace関数を使って実現しようと思ったのですが SELECT REPLACE(col1,' ','') as col1 From table1 where col1 like '%システムズ%' これだとデータがヒットせず単純に表示するときに空白が削除されるだけです どうすれば空白を含むデータを検索することができるでしょうか できれば全角・半角両方を含む文字のデータでも検索できるようにしたいです SQLServer 2005を利用しています。
いつもお世話になります。 VisualStudio2005とSQLserver2008を利用しています。 現在、クライアント毎に宅配便の利用履歴を表示する機能を作成しています。 メインとなる宅配便マスタに複数のマスタを結合して表示しているのですが、処理が非常に遅くて困っています。 主要な原因は結合の多用だと考えているのですが、どう削減していいものかわかりません。 以下は実際のSQL文です。かなり長いので結合部分だけ抜き出しています。 Dim strSelect As String = "" strSelect &= " select CM.クライアント名 as クライアント," strSelect &= " CO13.汎用名称 as ターミナル," strSelect &= " CO2.汎用名称 as 内容," strSelect &= " CO6.汎用名称 as 便種," strSelect &= " CO7.汎用名称 as 運送業者," strSelect &= " AM1.エリア as 仕入エリア," strSelect &= " AM2.エリア as 請求エリア," For i As Integer = 1 To 8 strSelect &= " CO89_" & i & ".汎用名称 as サイズ" & i & ", " strSelect &= " CAST(FLOOR(TTm" & i & ".単価) as int) as 仕入単価" & i & ", " strSelect &= " CAST(FLOOR(TT" & i & ".単価) as int) as 請求単価" & i & ", " strSelect &= " TM.個数" & i & ", " strSelect &= " CAST(FLOOR(TTm" & i & ".単価 * TM.個数" & i & ") as int) as 仕入金額" & i & ", " strSelect &= " CAST(FLOOR(TT" & i & ".単価 * TM.個数" & i & ") as int) as 請求金額" & i & ", " Next strSelect &= " SM.社員名 as 担当" strSelect &= " from 宅配便マスタ as TM " strSelect &= " inner join (select * from クライアントマスタ union select * from 関連会社マスタ) as CM on TM.ClientNO = CM.ClientNO " strSelect &= " left outer join (select * from コードマスタ where 識別コード=00002) as CO2 on TM.内容NO = CO2.汎用コード" strSelect &= " left outer join (select * from コードマスタ where 識別コード=00006) as CO6 on TM.便種 = CO6.汎用コード" strSelect &= " left outer join (select * from コードマスタ where 識別コード=00007) as CO7 on TM.運送業者 = CO7.汎用コード" strSelect &= " left outer join (select * from コードマスタ where 識別コード=00013) as CO13 on TM.ターミナル = CO13.汎用コード" For i As Integer = 1 To 8 strSelect &= " left outer join (select * from コードマスタ where 識別コード=00008 or 識別コード=00009)" strSelect &= " as CO89_" & i & " on TM.サイズ" & i & " = CO89_" & i & ".汎用コード" Next For i As Integer = 1 To 8 strSelect &= " left outer join (select * from 宅配便タリフ where ClientNO = '" & FlexI & "') as TTm" & i & "" strSelect &= " on TM.仕入エリア = TTm" & i & ".エリア and TM.便種 = TTm" & i & ".便種 " strSelect &= " and TM.運送業者 = TTm" & i & ".運送業者 and TM.サイズ" & i & " = TTm" & i & ".サイズ" strSelect &= " and TM.出荷日 >= TTm" & i & ".適用開始 and TM.出荷日 <= TTm" & i & ".適用終了" Next For i As Integer = 1 To 8 strSelect &= " left outer join 宅配便タリフ as TT" & i & " on TM.ClientNO = TT" & i & ".ClientNO and TM.請求エリア = TT" & i & ".エリア" strSelect &= " and TM.便種 = TT" & i & ".便種 and TM.運送業者 = TT" & i & ".運送業者 and TM.サイズ" & i & " = TT" & i & ".サイズ" strSelect &= " and TM.出荷日 >= TT" & i & ".適用開始 and TM.出荷日 <= TT" & i & ".適用終了" Next strSelect &= " left outer join エリアマスタ as AM1 on TM.仕入エリア = AM1.コード" strSelect &= " left outer join エリアマスタ as AM2 on TM.請求エリア = AM2.コード" strSelect &= " inner join 社員マスタ as SM on TM.社員ID = SM.社員ID" strSelect &= " left outer join 都道府県マスタ as TDM on TM.都道府県 = TDM.コード " strSelect &= " where " & strWhere strSelect &= " order by TM.ClientNO, TM.出荷NO, TM.出荷日" Return strSelect 明らかに無駄と思える箇所としては、佐川急便が一つの伝票で８種類までの重量区分を一度に処理できる形態を取っているため、 サイズ1~8、仕入単価1~8、請求単価1~8を求めるために同じマスタを８つずつ結合する羽目に陥っているところが挙げられますが……。 よい方法がありましたら、是非お知恵を拝借したいと思います。 お手数をおかけしますが、よろしくお願いします。
SQL Server Mangement Studioを使って開発をしているのですが データの新規登録や編集をinsert文やupdate文を使わずに GUIでデータを入力して追加登録や編集を行う方法はないでしょうか insert文やupdate文をいちいち作ってデータを挿入していたのでは 時間がかかります。 SQL Server Mangement Studioの機能でそういった事をする方法を 具体的に教えてください。 仕様しているソフトは下記になります sql Server management studio 9.0.0 SQL server 2005
仕入データから、最後に仕入した商品毎の単価をテーブルにINSERTしたい 仕入日　　商品コード　　　単価　　数量　　金額 5/1　　　　　 001　　　　　　150　　　 1　　　150 5/2　　　　　 002　　　　　　160　　　 1　　　160 5/3　　　　　 001　　　　　　145　　　 1　　　145 5/4　　　　　 001　　　　　　146　　　 1　　　146 5/20　　　　　002　　　　　　170　　　1　　　 170 上記のような仕入データから商品コード単位の最終＠の テーブルを作成したと思います 商品コード　　　最終仕入＠ 001　　　　　　　　146 002　　　　　　　　170 宜しくお願い致します
＜環境＞SQLSERVER 一時ワークテーブルのフィールドに指定した番号以降の連番を更新したいのですが、 クエリーで更新する方法はありますか？ 例） ＜更新前のテーブル＞ コード　名前　　連番　 001 　AAA 　null 002 　BBB 　null 003 　CCC 　null ＜更新後のテーブル＞ 15以降の連番を更新する コード　名前　　連番　 001 　AAA　　　15 002 　BBB　　　16 003 　CCC　　　17
SQLのORDER BYについてご教授いただけますでしょうか。 例えば、１０件のデータのうち、５件を指定のORDERBYで抽出し、 残り５件をORDERBYで抽出するということは可能でしょうか。 ID名前 システムフラグ 1 AAA 1 2 BBB 1 3 CCC 1 4 DDD 1 5 EEE 1 6 FFF 2 7 GGG 2 8 HHH 1 9 III 1 10 JJJ 1 上記のようなデータがあった場合、 以下のように抽出されるようにしたいと思っています。 ID名前 システムフラグ 1 AAA 1 2 BBB 1 3 CCC 1 6 FFF 2 7 GGG 2 4 DDD 1 5 EEE 1 8 HHH 1 9 III 1 10 JJJ 1 システムフラグが2が入っているものは、 ５件からの4,5件目に表示されるようにして、 それ以降はIDの昇順で表示されるようにしたいと思っております。 ５件というのは、決め打ち５件ではなく、条件によっては変わるのですが、 ５件が７件となった場合は、6,7件目がシステムフラグ2のものがくるようにしたいです。 指定した件数から下２つ目がシステムフラグのものが取得したいということです。 わかりにくいと思いますが、どのようなSQLを書けば抽出できるか ご教授いただけますでしょうか。 どうぞ宜しくお願い致します。
Microsoft SQL Server 2008 R2 RTM - Express with Management Tools (SQLEXPRWT_x86_JPN.exe)を実行すると下記のエラーが出てしまいます。 SQL Server のセットアップで次のエラーが発生しました: 要素 名前空間 'http://www.microsoft.com/sql/slp/Package.xsd' の 'Package' には無効な子要素 名前空間 'http://www.microsoft.com/sql/slp/Package.xsd' の 'Rules' が含まれています。必要とされる要素は 名前空間 'http://www.microsoft.com/sql/slp/Package.xsd' の 'Properties, Datastore, Extensions, MsiPatches, RuleGroups, Sequences' および 名前空間 '##other' のすべての要素 です。 エラー コード 0x84B10001。 どなたか解決方法がわかる方いらっしゃいますか？
【理想】 既にSQLServerExpress2005以降（以下SQL)が入っているPCに対して、 SQLの管理者権限がないユーザーがインストーラーを実行した際、 ・このユーザーは管理権限がないこと ・管理権限があるユーザーは○○というユーザーなので、○○というユーザーで ログインし直してからインストールして欲しい というメッセージを出したい 【現状】 SQLをデータベースとして開発したソフトウェアがあり、 インストーラーを実行すると、SQLと開発したソフトウェアが自動インストールされるようになっています。（既にSQLがインストールされている場合はSQLはインストールしない） インストーラーは、Inno Setupを利用しています。 ここで問題になっているのが、 既にSQLがインストールされているPCにインストールしてもらった際に、 SQLの管理者ではないユーザーでインストールしようとするとエラーになることです。 ユーザーに上記を伝えて、権限のあるユーザーでやり直してもらって（もしくは一旦SQLをアンインストールして）、再度上記インストーラーを実行してもらう必要があるのですが、権限のあるユーザーが誰か答えられるユーザーがほどんどいません。 今は、インストーラーを実行した際、既にインストールされていれば、 仮のデータベースを作るテストをしてみて、出来ればOK、出来なければ、「インストール出来ないから管理権限のあるユーザーでログインしてほしい」のようなメッセージを出してセットアップを中止するようにしています。 インストーラーを実行した際、管理権限のあるユーザーが誰なのかが分かる方法はないでしょうか。色々試してみたのですが、「管理者権限がない」という応答しか返って来ません。 同様の悩み（対応）は他のソフトでも同様だと思いますが、 どのように解決しているのかを教えて頂ければ助かります。 分かる方ご教授お願い致します。
お世話になります。 SQL Server 2005のプロシージャにて テーブルの削除→CSVファイルの取り込み→CSVファイルの削除を行いたいと思っております。 ALTER PROCEDURE [dbo].[テーブル削除＋インポート＋ファイル削除] AS begin DELETE FROM dbo.テーブル BULK INSERT テーブル FROM 'テキストファイル' WITH (DATAFILETYPE='char', FIELDTERMINATOR=',',ROWTERMINATOR='\n') end ここで、テーブル削除とCSVファイルのインポートはできたのですが、ファイルの削除が未だにできません。 このあとテキストファイルをこのプロシージャ内で削除するにはどうすればよいでしょうか。
SQL SERVER 2005を利用し、ストアドプロシージャを作成しております。 あるストアドでwk_hizukeというテーブル(下記の構成)から、tokuisakicode tokuisakicode int, denpyouhizuke smalldatetime を変数@tokucdへ送り、別のストアドを呼び出し@hizuke1を戻り値として メインのストアドへ戻し、@hizuke1を上記テーブルのdenpyouhizukeへ格 納したいというのが行ないたいことです。 wk_hizukeというテーブルには複数のレコードが入っており、そのレコード を一件ずつ読みながら、上記の処理を行ないたいと考えております。 select tokuisakicode set @tokucd = tokuisakicode exec sp_hizukesanshutu @tokucd , @hizuke1output , from wk_hizuke このような構文を記述してみたのですが、エラーとなってしまいました。 根本的に考え違いをしているのかと思い、いろいろ調べてみたのです が、妥当と思われる構文を見出すことができずにおる次第です。 アドバイスいただければ幸いです。宜しくお願い致します。
＜環境＞ Sqlserver2005 フィールドにある特定文字列が何文字存在するか抽出できる方法はありますか？ 例えばこんな感じです。 郵便番号フィールドから文字列"-"が何文字存在するか 郵便番号　　　　　　結果 09099999999　　　　 0 090-99999999　　　　1 090-9999-9999　　　2 090-99-99-999　　　3
SQLサーバーをミラーリングして管理したいと思っています。 OSはWin2008、SQLは2005SP4です 現在、Developerで勉強中です まず、同じPC内でHDDを分けてSQLをインストールする場合 プライマリ用、セカンダリ用、監視用と 別々にライセンスが必要ですか？ 次に別々のPCに分けてインストール→ミラーリングする場合 どうなりますか？ 接続ユーザーのCALはプライマリへの接続分で よいのでしょうか？ よろしくお願いします
こんにちは、 （SQL server2005環境） ストアドのwhere文なのですが、 codeの条件でtypeが77,88,99のいずれかを検索させたい場合 下記の文になると思いますが、もう少し簡略することは出来ますでしょうか？ WHERE TABLE2.[Code] LIKE COALESCE(@Code, TABLE2.[Code], '') and TABLE2.[TYPE] = '77' or TABLE2.[Code] LIKE COALESCE(@Code, TABLE2.[Code], '') and TABLE2.[TYPE] = '88' or TABLE2.[Code] LIKE COALESCE(@Code, TABLE2.[Code], '') and TABLE2.[TYPE] = '99'
データベースを勉強中の者です。ロックの種類についてどなたかご教示いただけますでしょうか。 ロックの種類は、次の三種類ですよね。 ・共有ロック ・排他ロック ・更新ロック 共有ロックの意味は理解できていると思うのですが、更新ロックがよくわかりません。 更新ロックにすると次のように動作するそうですね。 １．更新を前提にして共有ロックをかける。 ２．更新する前に排他ロックに切り替わる。 排他ロックも更新時に使うロックですが、排他ロックと更新ロックの違いというか、使い分けがよくわかりません。 データを更新するためには排他ロックをかけないといけないのはわかりますが、その前に共有ロックをかける意味は？ http://f29.aaa.livedoor.jp/~snaka/PukiWiki/PukiWiki.php?SQLServer%2F%A5%ED%A5%C3%A5%AF#na5d5d64 上のサイトを読んで「デッドロックを回避するため」といったんは理解したのですが、上司は「更新ロックとデッドロックは関係ない」と言います。 私の解釈が間違っているのでしょうか。それとも上司？
ＤＢはSQLSERVER2005です。 メールアドレスの入力チェックをしたいと思っています。 みなさんはどのようなチェックを行うのでしょうか？ 私は、フィールドに@マークが何個あるか確認しようと考えています。 これを確認できる関数はあるのでしょうか？ ご教授お願いします。
SQL Server Profilerでのトレースを、exec sp_trace_createを用いてトレース定義をし、 トレースログを取得することを考えているのですが、 sp_trace_createで作成したトレース定義が、 SQLSERVERのインスタンスを再起動すると削除されてしまいます。 トレース定義というのは、このように再起動すると削除されてしまうものなのでしょうか。 希望としては、再起動をしても削除されることなく、インスタンス起動停止のたびに、 トレースも同様に、以下のコマンドで停止・開始を行っていきたいと考えています。 開始：exec sp_trace_status @TRACEID, 1 停止：exec sp_trace_status @TRACEID, 0 ※仕様上、削除されてしまうものかどうかをいくつかのサイトを検索しましたが、 見つからず、ここで質問させていただいております。 また、@TRACEID=1に（インストール時から登録されている既定の？）トレース定義は 再起動しても削除されないため、トレース定義を永続化させることができるのでは、とも思っています。 何卒よろしくお願いいたします。 【環境】 Windows Server 2008 R2 x64 Standard Edition SQL Server 2008 SP2 Enterprise Edition (x64)
C#＋SqlServerでC/Sアプリを作りました。 しかし、現在下記の問題があります。 ご存知の方いらっしゃいましたら、教えてください。 クライアント側はデータをサーバー側に送信します。 サーバー側はデータを受信しながらSqlServerに保存します。 軽量のデータでやるなら、問題は出ません。 しかし、8GBのデータでやると、その途中、いつも下記のエラーが出ます。 Class:11 Index #0 Message: タイムアウトに達しました。操作が完了する前にタイムアウト期間が過ぎたか、またはサーバーが応答していません。 LineNumber: 0 Source: .Net SqlClient Data Provider Procedure: System.Data.SqlClient.SqlException: タイムアウトに達しました。操作が完了する前にタイムアウト期間が過ぎたか、またはサーバーが応答していません。 場所 System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) 場所 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) 場所 System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error) 場所 System.Data.SqlClient.TdsParserStateObject.ReadSni(DbAsyncResult asyncResult, TdsParserStateObject stateObj) 場所 System.Data.SqlClient.TdsParserStateObject.ReadNetworkPacket() 場所 System.Data.SqlClient.TdsParserStateObject.ReadBuffer() 場所 System.Data.SqlClient.TdsParserStateObject.ReadByte() 場所 System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) 場所 System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) 場所 System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async) 場所 System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) 場所 System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe) 場所 System.Data.SqlClient.SqlCommand.ExecuteNonQuery() 場所 System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult) 場所 System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries) 場所 System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query) 場所 System.Data.Linq.ChangeDirector.StandardChangeDirector.DynamicInsert(TrackedObject item) 場所 System.Data.Linq.ChangeDirector.StandardChangeDirector.Insert(TrackedObject item) 場所 System.Data.Linq.ChangeProcessor.SubmitChanges(ConflictMode failureMode) 場所 System.Data.Linq.DataContext.SubmitChanges(ConflictMode failureMode) 場所 System.Data.Linq.DataContext.SubmitChanges() その他： 　SqlServer2008 R2 　C# .Net3.5 WindowsServer2008 R2
ＡTBLからＢTBLへのINSERT時発番を行いたい ＜環境＞ SQLSERVER 2008 ＜ＡTBL＞ CDvarchar(3)KEY NOintKEY NAMEvarchar(10) ＜ＢTBL＞ CDvarchar(3)KEY NOintKEY NAMEvarchar(10) ＜ＢTBLのデータ＞ CD　　 NO　　NAME 0011太郎 0013次郎 0015三郎 ＢTBLをＡTBLへINSERTしたいのですが、この時、NOを１から再付番したいのです。 INSERTクエリで一発で更新できますでしょうか？ ご教授お願いします。
SQL server 2008 R2 と VB2010 で開発を行っています。 いま、月別の合計金額を計算するSQLがわからなくて困っています。 【売上明細テーブル】 ・明細ID ・年月日 ・得意先ID ・売上金額 出力したい内容は以下のような月別売上合計の推移です。 具体的にはこんな感じです。 得意先ID　３月売上　４月売上　５月売上 --------------------------------------- 0001　　　　　1,111　　　2,222　　　3,333 0002　　　　　2,222　　　3,333　　　4,444 0003　　　　　5,555　　　　　0　　　　6,666 得意先の中には売上の無い月もあります（0003の４月）が、 この場合も一覧に出したいと考えています。 １つのロウの中に異なる条件の値がある場合のSQLの組み立てがわかりません。 どうぞ宜しくお願いします。
MSのライセンスに関してお教え下さい。 階層化されたWebシステムで、DBはAPからのみリクエストを受ける場合、SQLServerのCALの考え方をお教え下さい。 (実利用者分必要orAPのデバイス数分必要)
いつもご回答ありがとう御座います。 UPDATE文だと思うのですが、以下の内容でデータを更新する場合はどうしたら良いでしょうか？ご指南よろしくお願いします。 今回SQL２０００の中に、AとBの２つのデータベースがあり、ＡとＢ両方に顧客マスタというテーブルがあります。　 Ａには顧客番号１、顧客番号２、顧客番号３、と３つの列があります。 Ｂには顧客番号という列しかありません。 （ＡとＢ両方に共通する識別番号があります。（登録Ｎｏ的な）　） データ的には、Ｂには「ＡＡＡ１２３ＤＤ」といった顧客番号があります。 Ａは空です。 このＢの顧客番号「ＡＡＡ１２３ＤＤ」を、 Ａの顧客番号１に「ＡＡＡ」、顧客番号２に「１２３」、顧客番号３に「ＤＤ」、といった形で振り分けてコピーしたいです。 桁数は決まっているので、顧客番号１は左から何桁、といった指定は出来ます。 聞ける人が居ないので、何卒・・・・宜しくお願いいたします。 　　
T-SQLで、テーブルを参照せず、１から30までの雨に連続する値のをもつ30行を取得するには、どのようなクエリになりますでしょうか？ やりたいことは、今日から過去30日間の集計データを表にするということで、そのために、今日から過去30日の日付の行をもつ日付列を用意して、Left Joinしようとしています。 よろしくお願いします。
GWで暇なので　WebからSQL　Server2008　Expressをダウンロードしてインストールして試している所です。 インストールは無事終了して、SQL　Sever　Managementを使って 新しいデータベースやテーブルも作成できました。 元々あったAccessのテーブルをインポートもできました。 しかし、エクセルのVBAで　Recodsetを試みようとしているところですが Sub ボタン1_Click() Set cnnSql = New ADODB.Connection With cnnSql .Provider = "SQLOLEDB" .Properties("Data Source").Value = "PC\SQLEXPRESS" 'サーバー名 .Properties("User ID").Value = "sa" 'ユーザー名 .Properties("Password").Value = "" 'パスワード '.Properties("Initial Catalog").Value = "master" 'サーバー上のデータベース名 .Open End With cnnSql.Close Set cnnSql = Nothing End Sub という簡単なコードで ユーザー　"sa"にログインできませんでした のメッセージで　先に進めません。 SQL　Server management のログイン　sa　のプロパティをみると SQLServer認証　ですが　１５ケタのパスワードが　●●・・・●と出ています。 ●をすべて削除してOKでいても次に開くと元の通りなのですが これが原因かどうかわかりませんが VBA　Recodesetを使って　SQLServerのテーブルに接続して操作したいのです。 どこの設定を見ればよいのかご存知の方、教えてください。 PCは　Windows7　Office2010です。
基本情報技術者試験の問題にＳＱＬの問題があります。 しかし、SQLのプログラムを行ったことがなく、問題がなかなか解けません。 そこで、実際にSQLを操作してみたいのですが、 どのようにすれば利用可能なのでしょうか？ 教えていただけないでしょうか？よろしくおねがいします。
SQL-Server2010を使用しています。 レコードを追加する際にキー項目が存在する場合は追加しないようなSQL文を作成しました。 追加するテーブルにレコードが１件以上あれば思ったとおりの処理となりますが、 １件も存在しない場合は追加できません。 下記がそのSQL文です。 原因と対策方法を教えて頂けませんでしょうか？ INSERT INTO foo(商品コード, 商品名) SELECT DISTINCT 'ABC123' , 'りんご' FROM foo WHERE NOT EXISTS( SELECT * FROM foo WHERE 商品コード = 'ABC123' ) 以上です。 宜しくお願い致します。
この春プログラミング業界に就職しました新入社員です。 皆様のお知恵を拝借したく、質問させていただきました。 先日、以下のような処理を任されました。 ・顧客ID,注文NO,商品NO,処理日時からなる注文テーブルに、 ・同一商品の送付対象となる顧客のIDリスト（csvファイル）を元に、 ・新しい注文を追加する 注文テーブルの主キーは顧客IDと注文IDを連結したものであり、 顧客001が過去に３回注文しているとすると、 今回追加すべきレコードは001,4,商品NO,処理日時となります。 急ぎの仕事でしたので格好良さは度外視し、 注文テーブルの注文NOの最大値を求め、 select文で顧客のIDリストと注文テーブルを連結して注文NOを1から最大値まで順に指定して表示し、 顧客IDごとに今回入力すべき注文NOを把握して、 IDリストのcsvファイルをエクセルで編集して顧客ID,注文NO,商品NOからなる テーブルを作って注文テーブルに流し込み、 注文テーブルの処理日時がNULLになっているレコードを指定してgetdate()で現在時刻を放り込みました。 今回は幸いにして注文NOの最大値が3と小さく、 対象の顧客も1000人ほどと少なかったためにごり押しできましたが、 今後も同じような処理をする必要があるときに同じ手が通じるかどうか、 というかミスが怖くて二度と使いたくありません。 もっとスマートな方法があるのではないかと調べてはみたのですが、 顧客IDごとに注文IDの最大値+1を求めてinsertする辺りの処理が探し当てられず、 ここで質問させていただいた次第です。 よい方法をご存知の方がおられましたら、ご教授いただけましたら幸いです。
ＳＱＬＳｅｒｖｅｒにおいてプロファイラを実行するとリアルタイムでトレースが出力されます。 しかし、Ｗｉｎｄｏｗｓをログオフすると停止されてしまいます。 ログオフしてもトレースをファイルに出力し続ける方法を教えていただけないでしょうか？
SQL Server 2008 Standard Edition使用です。 Windows2003 Serverのアップデート後、再起動を行ってから、SQLエージェントが 開始できなくなっています。 AdministratorでSQL Management Studioにログインして、SQL Server Agentを右クリックしても 「開始」「停止」「再起動」の文字がアクティブにならず、選択できません。 よろしくお願いいたします。
サーバー（ＸＰ　ＳＰ３／ＩＩＳ５．１／ＳＱＬ　ＳＥＶＲＥＲ２００６Ｒ２）へクライアントから ＤＢ（ＳＱＬ　ＳＥＲＶＥＲ）へデータを登録しようとしたところ 「基礎になる接続が閉じられました。受信時に予期しないエラーが発生しました。」 と出てしまいます。 何が原因で発生するのですか ＳＱＬ　ＳＥＲＶＥＲの設定？ ＩＩＳの設定？ ＸＰの設定？ よろしくお願いします。
SQL Server2008を使用しているのですが、どうのようにデータを取得すれば良いか わからず困っております。 例えば、 名前は違うが全く同じテーブルが２つあるとします。 テーブルAには6レコード、テーブルBには3レコードのデータが存在するとします。 この時、単純に6レコード＋3レコードの 9レコード分をひとつのテーブルとしてデータを 取得するにはどのようなSQL文を書けばよいでしょうか？ SELECT * FROM テーブルA, テーブルBでは18レコードもデータを取得してしまい、且つ フィールド数も増加してしまいます。 宜しくお願いいたします。
（別のCategoryに載せてしまいましたがみつかりませんので、正しいCategoryで再掲載しています。） T-SQL： Order By の使い方について　(初心者です） 下のような順番で結果を求めています。 Item NO　QTY P001 　　　10 P002 　 　　 8 P003 　　　20 N001 　　　13 N002 　　　50 Q001 　　　5 Q002 　　　33 Q003 　 　　6 Table内のItemNOはA001から alphabetと3桁番号の順番でY005まであるものとして、上記のP,N,QのItemNoのものだけをこの順番で求めたいのです。 もちろん、WHERE-clauseにはこの8件のItemNOの指定はしてあります。 Order by　left(ItemNO, 1) DESC　(またはASCE）, substring(ItemNo, 2,4) ASC これでは、P,N,Qの順番にはなりません。 最初にP Number、次にN　Number、最後にQ Numberを出すにはどうしたらいいのでしょうか。 Order Byの次に8個のItemNOを上記の順番に書いて指定することはできるのでしょうか。 Order Byには "Case When" が使えるとあるinternetで見たのですが、もし使えるとしたらこの順番をだすのに使えるのでしょうか。 ご指導お願いいたします。
SQLServer2000上のデータ抽出方法について教えて下さい。 例えばデータとして・・・ 　カラム名：　品番 販売開始日 販売終了日 　データ１　：　A01 2011/01/01 2011/03/31 　データ２　： A02 2011/02/01 2011/05/31 　データ３　： A03 2011/04/01 2011/06/30 とします。 今、期間の入力として、 開始日：2011/03/01 終了日：2011/03/31 とした場合、この期間内にあるデータを抽出したいです。 答えは、A01 と A02 が指定期間内にあるので抽出されるＳＱＬを教えて下さい。 （言いかえれば、指定期間内に掛っている情報の抽出です） どなたか、ご教授お願いします。
初心者ですが、よろしくお願いします。 Access 同様のクエリ操作が出来るのでしょうか？ 例)グループ化、抽出設定、関数の使用、更新・テーブルクエリ 等
いつもこちらで大変お世話になってます。 SQL2005です。　現在、「商品マスタ」というテーブルに、「単価」という列があり、ここには商品の単価が入っているのですが、「1663.2」　という様に小数点が入っているデータがあります。 これを切り捨てて「1663」という整数にしたいのですが、どの様なクエリ文になるのでしょうか？ 先ほど、こちらでご指南頂き、データを1.05倍する、という更新は無事上手くいったのですが、小数点が出てしまいました。 どなたかご教授くださいませ。よろしくお願いします。
どなたか教えて下さい。 SQL2005ですが、「商品マスタ」というテーブルに、「単価」という列があるのですが、この「単価」の数値を1.05倍したいです。　300⇒315のように。 どのようなクエリになるのでしょうか？ 検索掛けたのですが、同様の質問が見付かりませんでした。よろしくお願いします。
こんにちは、 元テーブル⇒取引先テーブル⇒取引先名称テーブル構成から最終的に 結果SQLのように取引先名称１、取引先名称２を 出力したいと思っているのですが、二つを一緒に抽出させることが なかなか出来ません。 多分、複数のSELECT文をどうにかしないといけないのかとは 思うのですが、情報ありましたらお願い致します。 元テーブル ID l 売先コード l 需要家コード 1 l A l B 2 l C l B 3 l A l C 取引先テーブル ID l 売先、需要家コード l 取引先名刺ID 1 l A l A1 2 l B l B1 取引先名称テーブル ID l 取引先名刺ID l 取引先名称 1 l A1 l 売り先名称 2 l B1 l 需要家名称 結果SQL 売先コード l 需要家コード l 取引先名称１ l 取引先名称２ A l B l 売り先名称 l 需要家名称 C l B l (空白) l 需要家名称 A l C l 売り先名称 l (空白)
INSERTの質問ですが、 ２つのテーブル カレンダーマスタ、出勤データがあります。 出勤実績表を作成するのに、出勤していない日も帳票に 出したいので、空白の日付分は埋めれないかと思っています。 １．カレンダー 2011/3/1 2011/3/2 ↓ 2011/3/31 ２．出勤データ 　　 社員コード　日付　　　　　出勤　　退社 0001　　 　2011/3/2　　 0900　　1800 0001　 　 2011/3/4 0900 1900 0002 2011/3/2 0900 1800 0002 2011/3/4 0900 2000 これから、 社員コード　日付　　　 出勤　　　退勤 0001　 　 　2011/3/1 0001 2011/3/2 0900 1800 0001 2011/3/3 0001 2011/3/4 0900 1900 0001 2011/3/5 ↓ 0001 2011/3/31 0002 2011/3/1 0002 2011/3/2 0900 1800 0002 2011/3/3 0002 2011/3/4 0900 2000 　　　　　　　　　↓ 0002 2011/3/31 出勤データのない日も、カレンダーの日付と、社員コードを 落としたいのですが、LEFT OUTER JOINなどで試してみるのでが うまくいきません。 どなたか、わかる方教えてください。 宜しくお願いします。
VB2008 で開発をしています。 SQL ServerからDB名の一覧を取得する処理で、うまく行かず悩んでいます。 ロジックは以下の通りです。 Dim cnString As String Dim Scn As ADODB.Connection Dim Srs As ADODB.Recordset Scn = CreateObject("ADODB.Connection") cnString = "Driver={SQL Server};" cnString = cnString & "Server=" & strServerNM & ";" cnString = cnString & "UID=" & strServerUID & "; Pwd=" & strServerPassWD & ";" Scn.Open(cnString) Srs = Scn.Execute("SELECT NAME FROM sysdatabases　ORDER BY NAME ;") If Srs.RecordCount = 0 Then 　　MsgBox("データベースが存在しません。") Else 　　Do Until Srs.EOF = True 　　　　MsgBox(Srs.Fields("Name").ToString) 　　　　Srs.MoveNext() 　　Loop End If 　　実行すると、DB名ではなく、"System._ComObject"という文字が複数回（おそらくDBの数）表示されます。 　　どなたかおわかりになる方、おられましたらよろしくお願い致します。
お世話になってます。 sqlについて質問です。 ddlを発行するとトランザクションは暗黙的にコミットされると思いますが、 select into #temptable ・・・ のように、select into 句で一時テーブルを作成した場合、トランザクションはどうなるのでしょうか？ また、以下のように一時テーブルと普通のテーブルで挙動は変わりますか？ begin transaction select into #temptable from A　←　ここでコミットされてしまう？　…(1) select into temptable from A　←　ここでコミットされてしまう？　…(2) rollback transaction 以上、よろしくお願いいたします。
asp記載は ｓｔｒSql = "Select * From dbo.テスト（テスト） Where 日付='20110324'" objSr.Open str.Sql,objCon.3 ※上記構文前にConnecting.StringやOPENは定義済みです。また、objSrはレコードセットで定義済みです。 質問内容は、このまま実装すると SQLServerエラー（80040ｅ14） '（'付近に不適切な構文があります。 と表示されます。 自分が調べたところ、テーブル名が「dbo.テスト（テスト）」で一部全角カッコがあるるので、 エラーになったのだと思われます。 ちなみに全角カッコではないテーブル名の参照は可能でした。 全角カッコを認識させるにはどうしたらよいでしょうか？ [dbo.テスト（テスト）]は試しましたが（[　]で囲む） オブジェクト名dbo.テスト（テスト）が無効ですと表示され、エラーとなりました。 ご教授をお願いいたします。
SQLServer2005にて実行したクエリを取得したいと考えています。 条件としては、実行したクエリとそれを実行したSPIDを取得できればと考えております。 接続が切れた時点で実行したクエリが消えてしまうので、別テーブルを用意して登録しておければ最高です。 理想としては、クエリが実行されたら用意したテーブルに実行したクエリとSPIDを書き込むといったかんじです。 しかし、システムテーブル、システムビューにトリガは付けられないようで困っています。 どなたかわかる方がいらっしゃったらよろしくお願いいたします。
SQL Server 2008上に作成している大量のテーブル名を変更したいのですがSQL Server Management Studioで1個ずつ変更するには結構大変です。 具体的に良い方法はないでしょうか。SQL Serverについては初心者です。 よろしくご教示願います。
データセンターにてIIS7+SQLServer2008にて会員制サイトを構築しています。 管理者側の機能を開発するのに、ASP.NETでのWEBベースかWinフォームか悩んでいます。 Winフォームの方が得意なので、開発時間の短縮には繋がりますが 直接Winフォームからデータセンター内のSQLサーバーにアクセス出来るようにするのは安全性に欠けるのでしょうか。 この点がわからず、開発に踏み切れずにいます。 どなたかご存知でしょうか。 ご教授よろしくお願いいたします。
SQL Server 2008 Workgroup Editonをインストールしている、パソコンのコンピュータ名を 変更しても大丈夫でしょうか？というか変更する必要があります。 ほかの業者が導入したアプリがあり、再導入となると金額や日程がなかなかに調整が難しいです。 従来（2000とか）は、変更の手順があるようですが、2008になって、変更しても普通に SQLが起動していると聞いているのですが、不安で．．． SQL2008で変更する手順などがわかるサイトなどあれば教えていただけると嬉しいです。 よろしくお願いします。 NEC　Mate OS　WindowsXP-Pro SP3 SQLはこのパソコンのみで使用
SQLサーバの勉強を始めたばかりの者です。 Accessのテーブルを、SQLサーバに移行したいと考えています。 Acessのサイズアップして SQLサーバにデータを移行することはなんとかできた様子なんですが 今度はそのSQLサーバのデータをAccessにリンクする方法がわかりません。 ネットで検索したのですが Accessのバージョンが違っていたりしてどうもわかりません。 わかりやすく手順など掲載されているサイトがあったら 教えてください！ Access：2007 SQL Server：2008 を使用しています。
Access 2003 VBA で、ADOを使用してSQL Server 2008 R2 Express のテーブルを参照しています。 Seekメソッドを使いたいのですが、Indexプロパティーを設定すると、 「現在のプロバイダーは Index 機能に必要なインターフェイスをサポートしてません。」 のエラーが発生してしまいます。 SQL Server は初心者です。よろしくお願いいたします。 -以下ソースプログラムです- Dim con As New ADODB.Connection Dim rst As New ADODB.Recordset con.Open "Provider=SQLOLEDB;SERVER=xxxxx;DATABASE=xxxxxx;UID=sa;PWD=xxxxxx;" 'SQL-Serverへ接続 rst.Open "testdata", con, adOpenKeyset, adLockOptimistic, adCmdTableDirect Debug.Print rst.Supports(adSeek), rst.Supports(adIndex) ’----結果、　false false rst.Index = "index1" ' ---- 「現在のプロバイダーは Index 機能に必要なインターフェイスをサポートしてません。」のメッセージ rst.Seek 0, adSeekAfter
ID（キー）と、分類コードを持つテーブル（A、B）があるとします。 分類コード単位で更新をしたくて、以下のようなストアドを書きました。 ALTER PROCEDURE XXX @BunruiCD CHAR(10) AS BEGIN DECLARE @TBL_A_ID CHAR(5) DECLARE TBL_A_DATA CURSOR FOR SELECT A.ID FROM TBL_A WHERE BUNRUI_CD = @BunruiCD BEGIN OPEN TBL_A_DATA FETCH NEXT FROM TBL_A_DATA INTO @TBL_A_ID WHILE @@FETCH_STATS = 0 BEGIN IFNOT EXISTS(SELECT * FROM TBL_B WHERE ID = @TBL_A_ID) BEGIN --Bテーブルにデータが存在した場合は削除する DELETE FROM TBL_A WHERE TBL_A_ID = @TBL_A_ID END ELSE BEGIN --特に処理なし（UPDATE等する予定） END END END 以上です。 やりたいこととしては、Aテーブルを分類コード（起動引数）単位でループさせて、 Bテーブルにも同じIDのデータがあったら、Aテーブルから削除させたいです。 しかし、Aテーブルをカーソルループさせているので、それを削除しながら回すと おかしくなるでしょうか。 事情により、1行ずつ読み込んで削除していきたいので、ループさせたいのですが…。 ループのやり方がまずいのか、他の原因があるのか、SQLManagementStudioから 上のSPを実行しても、うまくいきませんでした。 （見よう見まねで作っているので、他にもおかしいところがあると思いますが） 修正すべき点等、ご指摘いただけないでしょうか。
SQLServer2005環境です。 同じ構造のテーブルA、Bがあり、AのデータをBにコピーしたいと思っています。 Aのデータは最新のデータ、Bの中にあるのは古いデータなので、もしキーが かぶるレコードがあれば、Updateをかけ、なければInsertをするような仕組みに したいと思っています。 更に可能であれば、Aに存在しないデータがBにあった場合は、Deleteしたいです。 一度BをDeleteしてInsertすれば話が早いのですが、そうもいかず、UpdateとInsertを 交え、小出しに更新するような形にしたいのです。 2008であれば、Merge文という便利なものがあるのですが、2005では上のような 動作をストアドで実現するのは難しいでしょうか。 サンプルコードですとか、解説しているサイトなどがありましたら、教えていただけますと 大変助かります。 宜しくお願いします。
SQL Serverのトリガの中で、DMLの種類（INSERT/UPDATE/DELETE）を取る方法ってありますか？ こんにちは。アべです。 下記のようなトリガを作成して、操作（INSERT/UPDATE/DELETE）の履歴を 残したいのですが、トリガを３本に分けるのもあれなので、 操作の種類（INSERT/UPDATE/DELETE）を履歴用のテーブルに入れたいのですが、 書き方がわかりません。 取得方法のやり方を教えてもらえないでしょか？ CREATE TRIGGER [mst].[TriggerUserActionHistory] ON [mst].[User] AFTER INSERT, UPDATE, DELETE NOT FOR REPLICATION AS BEGIN SET NOCOUNT ON; --ACTION TYPE未設定 ↓今はINSERT固定しかできない。 insert into [history].[User] select 'INSERT',getdate(),* from inserted; END GO
・SQL Server セットアップ（SmartPhoto） ・SmartPhoto 上記の2つをアンインストールしたいと思うのですが、アンインストールしてしまうとどのような問題が生じるのでしょうか？ また、友人から聞いた情報によるとデジカメなどを使う時に不便になるからやめた方がいいと言われました。 しかし、最近新しいデジカメを買ってしまったのですがホントに不便になるのでしょうか？ 一応買ったデジカメ http://cweb.canon.jp/camera/ixyd/10s/index.html 優しい回答お待ちしています！ よろしくお願いします。
SQL Server 2008 R2 に関してご質問がございます。 Windows Server 2008 R2、メモリ 8GB環境で SQL Server 2008 R2 Standard Edition を使用しています。データベースは 12GBが1つ、4GBが1つ、2GBが1つあります。 SQL Server が物理メモリを 8GB近く消費しているのですが、Total Server Memoryの値が搭載している物理メモリと同じ値（8.192GB）に達すると月に2,3度CPU負荷が100％に達しデータベースへ接続できない現象が発生しています。SQL Server ログにはこのようなメッセージが残っています。 ソース spid23s メッセージ Memory Manage（以下省略） ソース サーバー メッセージ Error: 17887, Severity: 10, State: 1. (Params:). The error is printed in terse mode because there was error during formatting. Tracing, ETW, notifications etc are skipped. ソース ログオン メッセージ エラー: 17803、重大度: 20、状態: 13。 ソース ログオン メッセージ There was a memory allocation failure during connection establishment. Reduce nonessential memory load, or increase system memory. The connection has been closed. （以下省略） これをうけて、max server memory の設定変更を検討しております。 SQL Server のプロパティはこのようになっています。 min server memory 0 max server memory 2,147,483,647 max server memory の値を7168MBへ変更し、その後Total Server Memoryの値が7168MBへ達した場合、CPU負荷が100％になる可能性はありますでしょうか？ よろしくお願いします。
初歩的な質問ですが、よろしくお願い致します。 あるテーブルで、更新フラグが0のものを検索して ループで処理を行うプログラムを作りました。 その際、更新フラグは1でUPDATEをします。 データは日々増えていきます。 また、既存のデータも変更があった場合には、 （別プログラムから）更新フラグが0戻されます。 このままだと検索スピードがだんだん遅くなると思われますが、 検索スピードが遅くならないような方法を教えて下さい。 よろしくお願い致します。
SQLServer2005でメモリ不足エラーが発生しました。 WindowsServer2003　SP1　Xeon　メモリ4GB SQLServer2005　WorkGroup　SP2 クライアントからのアクセスは最大で80ほど という環境です。 SQLのログでは、 02/19/2011 10:10:24,spid51,不明,There is insufficient system memory to run this query. 02/19/2011 10:10:24,spid51,不明,エラー: 701、重大度: 17、状態: 123。 といったエラーが頻発しています。 クエリが集中し、メモリが不足したと考えています。 対応策などがあれば教えてください。 いろいろ調べて気になるところは自動終了がTrueであるところです。 よろしくお願いします。
次のようなテーブルがあったとして、一回のSQLで商品名称とその売上件数の一覧を作成することは可能なのでしょうか？ 【売上テーブル】 ID 販売日 商品ID 0001 2011/01/01 1 0002 2011/01/01 2 0003 2011/01/03 1 0004 2011/01/10 1 0005 2011/01/12 2 ・・・ 【商品マスタ】 ID 商品名 1 りんご 2 みかん 3 いちご 【最終的に作成したい一覧】 商品名 件数 りんご 3 みかん 2 いちご 0 ※売上テーブルに存在しない商品についても、件数が0件として一覧に出力出来るようにしたいです。 select 商品ID from 売上テーブル group by 商品ID にて商品ID毎の件数を算出し、それとは別に select ID,商品名 from 商品マスタ として、商品IDと名称のリストを取得後、アプリにてこれらの情報を突き合わせれば実現できるのは分かるのですが、これらの処理を一回のSQLにまとめることは可能なのでしょうか？ よろしくお願いします。
Oracle暦8年です。 しかし未だかつてSQL Serverを使ったことがないのです。 開発で必要なスキル／知識の差分を知りたいです。 DML、DDLなどSQL的な差は気にする必要はないという認識ですが、 ・DBA関係（Oracleでいうデータディクショナリのようなものからの情報取得） ・バックアップの方法、リストアの方法、 などで困ると思っています。 １●開発で必要なスキル／知識の差分 ２●何か良いサイトや、良い学習方法 を教えて頂けませんでしょうか？
SQL SERVER2005(9.00.3042.00)を使用していますが、 Excel VBAからのINSERT文やUPDATE文をたまに実行してくれないときがあります。 毎回だったらExcel VBA側のバグだと思うのですが、 たまにしか発生しないのでSQL SERVER側の不具合ではないかと疑っています。 SQL SERVER2005の不具合情報、パッチ情報が掲載されているサイト等がありましたら教えてください。 同様の経験がある方がいらっしゃいましたら情報を下さい。 よろしくお願いします。
SQL2008を使用しております。 2つのDBを統合したいのですがユニークIDがかぶっているデータが あるのでIDを変更したいのですが フリーソフトでINSERT文をTab区切りで出力してIDを変更してINSERT文を 作成するといらない箇所に「"」ダブルクォーテーションが入ってしまします。 もちろんその状態ではクエリ実行できないので困っています。 順序はINSERT文をTab区切りで出力→出力されたTab区切りのcsvのIDを変更→テキストで保存（csvでも保存）→拡張子をsqlに変更するといらない箇所に「"」ダブルクォーテーションが入ってしまします。 変更保存の問題でしょうか？ どうしたら「"」ダブルクォーテーションが入らない方法はありませんか？ 以上、わかるかた教えてください。 よろしくお願いします。
SQLサーバー2005＋マネジメントスタジオでビューを作っています。 以下のデータが存在するときに●のついたデータだけを抽出したいです。 明細IDはユニークとし、明細IDの中で一番日付が新しいものだけを取得したいです。 T-SQLでどのように書けばよいか教えてください。 ＜データ＞ 明細ID 日付 111 2010/10/01 111 2010/11/01 111 2010/12/01 ● 222 2010/11/01 ● 333 2010/09/01 333 2010/10/01 ● 444 2010/10/01 444 2010/11/01 444 2010/12/01 ● 555 2010/09/01 ● ＜出力＞ 明細ID 日付 111 2010/12/01 ● 222 2010/11/01 ● 333 2010/10/01 ● 444 2010/12/01 ● 555 2010/09/01 ●
データ出力プログラム(CSV)において、データ増加のため処理時間が長くなり、パフォーマンス改善を図らなければなりません。 そこで質問です。 以下の条件でパフォーマンス改善を図れる方法は御座いますでしょうか。 条件1：プログラムの変更は不可　（select分の改修などは不可ということです） 条件2：サーバスペックの見直しは不可 条件3：キー項目の見直しは不可 以前にオラクルでアナライズにより飛躍的に処理速度が向上した経験があります。 何かのコマンド、またはパラメータの値変更にて処理速度向上が図れる 手段をお教えください。 （SQLではアナライズは自動との認識は御座います。また、SQLServerのパラメータの類は 初期値のままです）
SQL2008 EXPRESSで作成したバックアップをSQL2008 R2 EXPRESSにデータベースの復元で問題なかったのですが、SQL2008 R2で修正があったので修正したあと、2008Ｒ２でバックアップを取ってSQL2008に復元しようとしたらエラーになります。 データベースはバージョン10.50.1600を実行中のサーバーにバックアップされました。このバージョン（バージョン10.00.1600を実行）とは互換性がありません。 と言うメッセージが出ます。 両方をSQL2008R2にすれば問題ないのでしょうが、ＳＱＬ　2008Ｒ２のバックアップをSQL2008に復元する方法をご存知の方は教えてください。 宜しくお願い致します。
Windows7端末に、SQL Server 2005 Expressのインストールを行いました。 システム構成チェックにおいては、全て成功となっておりますが、セットアップの進行状況において、以下のメッセージが表示され、インストールができません。 SQL セットアップ サポート ファイル　　　　　セットアップが完了しました SQL Nativve Client　　　　　　　　　　　　　　　セットアップに失敗しました SQL VSS Writer　　　　　　　　　　　　　　　　　セットアップに失敗しました SQL Server データベース サービス　　　　　セットアップに失敗しました なお、同じ”SQLEXPR_JPN.EXE”を使用して、ＸP端末、Ｖista端末にもインストールを行っておりますが、どちらもインストールは成功しており、目的どおり使用できています。 ※SQLEXPR_JPN.EXEのファイルバージョンは、「9.0.4035.0」でございます。 Windows7端末に、SQL Server 2005 Expressをインストール経験のある方、是非ともご教授ください。
SQLServer２００５ExpressEditionとVB.NETで、ひとつのDBに対して、コネクションを２つ持つことは可能ですか？または、問題などおこりませんか？ 以下のような感じでやってみたところ、両方ともに接続はできましたが、何か問題をはらんでいないかお気づきの方いらっしゃいましたらご教示いただけると助かります。 ' 接続文字列を生成する Dim stConnectionString As String = "接続情報" ' SqlConnection の新しいインスタンスを生成する (接続文字列を指定) Dim cSqlConnection As New System.Data.SqlClient.SqlConnection(stConnectionString) 　　Dim cSqlConnection1 As New System.Data.SqlClient.SqlConnection(stConnectionString) ' データベース接続を開く cSqlConnection.Open() cSqlConnection1.Open() ' 実処理 　　・ 　　・ 　　・ ' データベース接続を閉じる cSqlConnection.Close() cSqlConnection.Dispose() cSqlConnection1.Close() cSqlConnection1.Dispose()
SQL Server 2008 Management Studio についての質問です。 オブジェクトエクスプローラに各データベースのテーブル名一覧が出せますが、 現在テーブル数が非常に多く、目当てのテーブルを探すのに苦労しています。 テーブル名でフィルタリングする方法は無いでしょうか。 オブジェクトエクスプローラに「フィルタ」のアイコンがあるので、 これがそうではないかと思っているのですが、 　名前　　次の内容を含む　　[テーブル名を入力] 　(スキーマ以下　空欄) という設定でOKを押しても、以下のエラーが出て抽出できません。 　この要求のデータを取得できませんでした。（Microsoft.SqlServer.Management.Sdk.Sfc） 　追加情報： 　　　不明なプロパティ　名前　（Microsoft.SqlServer.Management.Sdk.Sfc） エラーメッセージを見ると　名前　というプロパティ指定がダメみたいですが、 このプロパティは固定になっていて変更できません。 （名前、スキーマ、所有者、作成日付　の４つがあります） 何が問題になっているのでしょうか。 そもそもこの「フィルタ」が目当ての機能なのでしょうか。 よろしくお願い致します。
現在Access（DB用mdbと,そのmdbにリンクテーブルしているクライアント用mdb）で稼動しているDBをAccess＋SQLServer2008 R2 EXPRESSという環境に移行しようとしています。 以下の質問を参考に http://okwave.jp/qa/q4935022.html?rel=innerHtml&p=bottom&l=1 SSMSを使ってAccessからのテーブルデータの移行を行いました。 そうしたところ スキーマ（？）として必ずdbo.テーブル名となってしまい、Accessからリンクテーブルするとdbo_テーブル名とデフォルト名がなってしまいました。 Accessのテーブルの名前の変更でリンクテーブルしたものからdbo_を取ることで解消すると言うことはわかっていますが、テーブルの数が100を超えるのでできればAccessからリンクをしに行った時点でdbo無しの状態にしたいと思っています。 SQLサーバーでテーブル名からdbo.と言うのをはずす方法はないのでしょうか？ インポートの設定（マッピングのあたり）から無理やりはずしたりもしてみましたが勝手にdbo付属してしまいました。 よろしくお願いいたします。
SQLServer2008かじり始めの素人です。ご教授願います。 MicrosoftSQLManagementStudioにて、「新しいクエリ」で以下のクエリ実行で 以下のエラーが出ます。対応ご存知な方がいらっしゃいましたら 教えてください。 【環境】Windows2003Server 　　　　SQLSERVER　2008 【テーブル構成】 　データベース：BUHIN_SEA 　　　　　　　　　　　　　　　　　列 親：　部品テーブル（ID,工号,納入先,形式） 　　　　　　　　　　　↓　　　　　　列 子：　納入先テーブル（NOUNYU_ID,納入先) 　 子： 形式テーブル（KEISIKI_ID形式) ＊ NOUNYU_ID,KEISIKI_ID　は主キー　設定 【クエリ】 　　INSERT INTO 納入先 ( 納入先) SELECT DISTINCT LTrim(部品テーブル.納入先) FROM 部品テーブル LEFT JOIN 納入先 ON 部品テーブル.納入先 = 納入先.納入先 WHERE (((LTrim(部品テーブル.納入先)) Is Not Null) AND ((納入先.納入先) Is Null)) ORDER BY LTrim(部品テーブル.納入先); 【実行結果】 メッセージ 515、レベル 16、状態 2、行 1 テーブル 'BUHIN_SEA.dbo.納入先' の列 'NONYU_ID' に値 NULL を挿入できません。この列では NULL 値が許可されていません。INSERT は失敗します。 ステートメントは終了されました。 ＊　'NONYU_ID' は、主キーのため、NULLを許容できません。
IF文で何もしないことを明示に書きたいのですが、 書き方を教えて下さい。
以下のようなテーブルがあります。 実際には毎日レコードが追加され全体で５００万レコードです。 num　name year point flag 101　yamada 1972 10 0 102　nakanishi 1978 20 1 103　sasaki 1980 40 0 104　nakai 1985 10 1 105　oda 1988 50 0 106　harada 1995 20 0 107　ishikawa 1999 10 0 基本的にはflagという列には「0」が入りますが、 稀に（数日に数行程度）「1」が入ることがあります。 毎晩１度だけSQLを実行し、「1」の行の行数（上の例の場合は２）、num、pointを 取得する必要があります。 そのためのSQLを教えて下さい。 またそのSQLの性能面を重視する必要があります。 よろしくお願いします。
SQL Server 2005のT-SQLで、SELECTの結果を カンマ区切りのCSVに出力できますか？ SELECTの結果は１行の場合のあれば、２行以上になることもあります。 やり方、ヒント、参考サイト等を教えて下さい。
みなさんこんにちは。 SQLServer2008R2を稼動しているシステムがあるのですが、ディスクの詳細な使用率について1日に1回、ファイルに出力していきたいと考えています。 具体的には、当該データベースにおける以下の6項目の値が必要です。 ・総使用領域 ・データファイルの使用領域 　└インデックス 　└未割り当て 　└データ 　└未使用 要するに、毎月1回、その月の使用増の状況を記録、把握していきたいという意図です。 当該システムの運用を引き継いだばかりで、SQLServerについてど素人なため、見当違いな質問でしたらご指摘頂ければ幸いです。 宜しくお願い致します。
Transact-SQLからbatやvbsを起動したいです。 引数を付けて起動できますか？ やり方、参考サイトを教えて下さい。 ヒントだけでも良いです。 環境は Windows 2008 R2 SQL Server 2005 です。 SQL Server 2008と違いがあるなら、 後学のために、SQL Server 2008でのやり方も 教えていただけると助かります。
バッチ処理で、bcpを使ってSQLの実行を行っています。この実行結果(データ抽出)をエクセルに保存させることは出来ませんでしょうか。 ネットでエクセルに保存させる方法がないかいろいろ探してみましたが、探し方が悪いのか方法を探し出すことが出来ませんでした。 最終的には、毎日エクセルファイルにデータを吐き出すことが出来るようにしたいです。
いつもお世話になります。 OS：Windows XP SQL Server2005 ExpressEditionです。 テーブル名：testTable 列 ：(1)number(intで主キーで自動採番）(2)name（nvarchar(50)) ストアドプロシージャを以下のSQL文で作成しました。 insert into testTable (name) values(''); update testTable set name = ltrim(str(SCOPE_IDENTITY())) + '_table' where ｎumber=SCOPE_IDENTITY(); （説明） インサート文；（セミコロンを打っています） アップデート文；（セミコロンを打っています） なぜこんなことをするかと言いますと、 自動採番で取得した番号を列：nameの内容の一部にしたいためです。 つまり、列：numberが１２で採番されたとすると列：nameは 12_table　と したいためです。 ltrimをかけていますのは、str(SCOPE_IDENTITY())の結果、数値の左 に空白が入ってしまうためです。（intのバイト数ほどでしょうか） 想定どおりの値がnameに入っております。 しかしこれは邪道ではないかと危惧しております。 よろしくご教授をお願いいたします。
先日よりデッドロックが発生するようになり、確認の為にトレースログを 抽出するように設定かけたのですが、UPDATE文とSELECT文がぶつかり デッドロックが発生している事がわかりました。 しかし、UPDATE文にはトランザクションをかけていますが SELECT文には特にロックかけていない為、どうして起こっているのか わかっていません。 SELECT文を読んでいる時にUPDATE文によって レコードに変更があった為、デッドロックが発生したのでしょうか? SELECT文にはUNLOCKをつけた方がいいのでしょうか？ プログラムはDELPHI DBはSQLSERVER2000になります。 お忙しい所申し訳ありません。 宜しくお願い致します。
以前同内容で質問させていただきましたが、 再度依頼させていただきたく投稿しました。 下記図を参照願います。 1件の依頼No.にぶらさがる配送先が3か所あります。 この中で一番新しい（＝若い）日付の 配送日&到着日をとりたいです。 配送日と到着日はワンセットと考えて、 新しい日付の配送日がとれたら、自動的に隣の到着日もとれるイメージです。 （例でいけば上から2つ目の配送日:20110106 到着日:20110107） どういう風にSQL文を書いたらいいかわかりません。 どなたか教えて頂けませんか？ ＜テーブルA＞ 依頼No.　 ＜テーブルB＞ 依頼No.　 枝番 配送日 到着日 依頼No.　　枝番　 　　 配送日　 到着日 1111 　　　 1 　　　　 20110107 　 20110108 1111 　　　 2 　　　　 20110106 　 20110107 1111 　　　 3 　　　　 20110108 　 20110109
下記図を参照願います。 1件の依頼No.にぶらさがる配送先が3か所あります。 この中で一番新しい（＝若い）日付の 配送日&到着日をとりたいです。 配送日と到着日はワンセットと考えて、 新しい日付の配送日がとれたら、自動的に隣の到着日もとれるイメージです。 （例でいけば上から2つ目の配送日:20110106 到着日:20110107） どういう風にSQL文を書いたらいいかわかりません。 どなたか教えて頂けませんか？ 依頼No.　　枝番　 　　 配送日　 到着日 1111 　　　 1 　　　　 20110107 　 20110108 1111 　　　 2 　　　　 20110106 　 20110107 1111 　　　 3 　　　　 20110108 　 20110109
SQL勉強中です。下記の様なデータを書き換えたいのですが、どの様なSQL文になるのでしょうか？ ご教授下さいませ。 １つのテーブルに「会員NO」と「会員種別」という列がありまして、 会員氏名　　　会員No　　　会員種別　・・・ --------------------------------- 田中一郎 1-0001 0001　　　　・・・ 鈴木二郎 2-0003 0001　　　　・・・ 会員Noの左端の数値が１なら会員種別を0001、２なら0002といった 形に振り分けたいのですが、どの様なSQL文になるのでしょうか？ 自力ではなんとも上手くいきませんでした。 どうか、お助け下さいませ。
CSV形式（カンマ区切り）のファイルがあります。4項目あり、各項目は以下になります。 ID,名前,説明,性別 このCSVをAccess 2003でインポートしたいと思っています。ただ、以下のようなデータが入っていた場合はエラーを起こします。 "001","近藤","性格は,普通","男" といったように、説明にカンマが混じってしまっている時です。これでは正しく読み込めません。 こういった形式のデータをインポートしたい時、何か良い手はないでしょうか？よろしくお願い致します。
こんにちは！ 現在、SQL Server2005のインストールに失敗して困っています。 自分でも色々調べてみたのですが、 自己解決が難しく、皆様のお力をお貸しください。 【インストール環境】 PC：WindowsXP SP2 SqlServer：SQL Server 2005 Express with SP3 【現象】 事前にインストールされていたSQL Server 2008をアンインストール後、 SQL Server 2005 をインストールしたところ、以下のエラーメッセージが表示されました。 「your sql server installation is either corrupt or has been tampered with (sqlboot.dll missing entry query valueW2). plase uninstall then re-run to correct this problem.　　　　　　　　　　　　　　　」 その後、再度インストールを試みたり、別バージョンのSQL Serverを試してみたりしたのですが、 同じとろこでエラーになってしまいます。 コンパネからサービスを確認したところ、 インストール自体は成功しているようですが、SQL Serverの起動がうまくいかないようです。 あまり詳しくないもので、 見ているエラーログが正しいのかわかりませんが、以下の内容を確認しました。 【 Error Code:1067 MSI (S) (A0!7C) [17:05:12:656] 製品:Microsoft SQL Server 2005 Express Edition -- エラー 29503。 　 SQL Server サービスを開始できませんでした。　　　　　　　　　　】 OSの再インストール等が禁止されているPCですので、 なんとかして解決するしかないのが現状です。 もし上記の現象で情報をお持ちの方がおられましたら、 何卒ご助力をお願いします。
DB SQLSERVER　2005に対して 地点A PC１：リモート接続　 OS：windows XP クライアントソフト：「SQL Server 2005 Management Studio」 SQLSERVER認証、接続OK 地点B PC２：リモート接続　 OS：windows XP クライアントソフト：「SQL Server 2005 Management Studio」 SQLSERVER認証、接続OK 地点B PC３：リモート接続　 OS：windows 7 クライアントソフト：「SQL Server 2005 Management Studio」 SQLSERVER認証、接続NG PC3で 「SQL Server 2005 Management Studio」 で接続（SQLSERVER認証）すると、下記のエラーがでます。 SQL Serverへの接続を確立しているときにネットワーク関連または インスタンス固有のエラーが発生しました．サーバーが見つからないか アクセスできません．インスタンス名が正しいこと，およびSQL Sever がリモート接続を許可するように構成されていることを確認してください． (provider: 名前付きパイプ プロバイダ，error: 40 - SQL Server への接続を開けませんでした）（Microsoft SQL Server, エラー:2） 解決策はありますか？ 同サーバーの同DBにPC１、PC２、PC３からはつないでいるので、SQLSERVER側のリモート設定 等は設定はOKだと思うのですが、 クライアントの方、片っぱしから、要因をつぶしていこうとした場合何が考えられますかね。 ご提案いただけますと幸いです。 参照 http://social.msdn.microsoft.com/Forums/ja-JP/sqlserverja/thread/6c2efe94-2290-45c3-a5fe-49f679db17a9 http://www.atmarkit.co.jp/bbs/phpBB/viewtopic.php?topic=40652&forum=7
こんにちは。Access 2003を使用しています。Accessのテーブルには１０万件程度のデータがはいっています。 Excelを開き、１行目から順に読み取って、テーブルにインサート・アップデートをしていきます。 例えば、Excel A列にIDがあったとします。AccessのテーブルにそのIDがなければ、インサート、あればアップデートという仕組みにしています。 データ件数が増えてきて、今は１０万件に対し、８万件がアップデートの対象です。処理が終わるのに物凄く時間がかかります。 何かよいアイディアはないでしょうか？例えば、こういった技術を使えばいいとか、こっちの技術を勉強して乗り換えたほうがいいよとかです。よろしくお願いします。
商品テーブル 　商品コード 　商品名 棚卸履歴テーブル 　商品コード 　棚卸日 棚卸履歴テーブルより当年データのみを抽出したテーブルと商品テーブルとを突き合わせを行う。 　(1)棚卸テーブルよりいつ実施しても当年の４月１日以降を抽出する記述方法がわかりません。 　(2)多段クエリの記述方法がわかりません。 上記テーブルを例をもとに記述方法を教えて頂けないでしょうか？ 宜しくお願いします。
ある米国のJavaで作られたWebアプリケーションパッケージソフトウェアをインストールしました。環境はSQLServer2005 + Tomcat 6.0で、その上にこのパッケージがインストールされて動作しています。基本的に米国の製品なので英語を前提としていますが、今回は日本語のOS、日本語SQLServer上にインストールしました。このパッケージソフトウェアがパッチを提供しているので、それを適用しようと思いました。そこでインストラクションを読んでいるのですが、その中に「UTF-8ベースのデータベースを使っている場合は」というような記述があります。そこで初めて文字コードというものを意識し、自分の構築したSQLServer2005の文字コードを調べたいと思いました。私の知識は古くはUNIX系がEUC、Windows系がShift-JISで最近はUnicode（UTF-8方式）が主流？、という程度です。ウェブで調べたところどうもUTF-8にするには？テーブルの型をnvarcharなど「N」を付して作成しなければならないというようなことがわかりました。このアプリが使用するテーブル群はすべてパッケージが提供するSQLのスクリプトで作成したものですが、nvarcharでなくvarcharになっていました。ということは、UTF-8ではないということでしょうか？そもそも文字コードというのはテーブルのコラム単位なのでしょうか、それともデータベースとかもっと上位の単位なのでしょうか？SQLServer Management Studio Express上でデータベースなどいろいろな個所を右クリックしてプロパティを見ていますが特にUTF-8とかUnicodeといった記述は見つかりませんでした。このデータベースは何という文字コードなのでしょうか？調べ方をご存じの方、ご教示願います。よろしくお願いします。
SQL Server 2008 を使用しています。 SELECT～with(UPDLOCK)～ などでレコードをロックした状態でクライアントプログラムが 異常終了した場合に、ロックが自然に解除されるかどうかについて調べているのですが、 ネットで検索しても答えは見つかりませんでした。 実験ではクライアント側のLANケーブルを抜けばロックが解除されたので、「自然に解除 される」が結論だとは思うのですが、文書のエビデンスが欲しいです。 検索の過程で得た印象では、「Oracleではロックが残ってしまうが、MySQLやSQL Serverでは そうでもない」という感じなのですが、 　(1)Oracleではそうなる、という根拠 　(2)SQL Serverではそうならない、という根拠 　(3)またはその印象が間違っているという指摘 があったら教えてください。 よろしくお願いします。 自然に解除されないのであれば対策を作らなければならないので、調べています。
sql2008製品版と無償版との違いについて教えてほしいのですが、これまはずっと仕事でsql2008EXPRESS(無償版)で販売管理などのシステムを作成しています。 新しい仕事のユーザーが店舗数10店舗で今ままでの無償版でやったところより店舗数が多く、データ容量やスピードの問題で製品版を考えています。そのあたりで製品版・無償版どちらがお勧めかを教えてください。 現在、無償版で稼動中のユーザーは５店舗でマシンは2008server R2 メモリー2G １年間のデータで mdfは350MBです。まだ1年間の稼動ですが帳票を見たりするのが遅いとは言われていません。 新しいユーザーもマシンは同等で、10店舗なので1年間のmdfは約700MBになります。 最低５年は同じmdfで管理します。ちなみにプログラムはAccess2003でSQLのデータを見ています。 新しいユーザーでデータ容量・スピードの観点から製品版・無償版どちらが良いか、またなぜ、それが良いかの理由などを教えてください。 宜しくお願いします。
主題の件について教えて下さい。 現在Excel2003のVBAを使用して、SQLServerにODBC接続し、 DBのテーブルデータを取得し、Excelに表示出来ないかを考えているの ですが、VBAの知識がほとんど皆無なので一向に進みません。 何か参考になるページなどありましたら教えてください。 理想はExcelのボタン一つでデータが取得出来れば良いのですが・・・。 よろしくお願いいたします。
sqlservar2005です sysobjectsと sys.objectsって 何が違うんでしょうか？
近々顧客管理ソフトの導入を予定しています。 このソフトはSQLサーバー2000を使用して動くそうなのですが、インストールするマシンには「SMILE BS 会計」という大塚商会の会計ソフトが既にインストールされており、このソフトはSQLサーバー2008を使用しています。 OSがXPのPCに、この二つのソフトを共存させる事は可能でしょうか？ 一応、web上の情報では可能らしいのですが...（2005と2008ですが） http://msdn.microsoft.com/ja-jp/library/ms143719(SQL.90).aspx
ドットネットで作成されたアプリケーションを SQLサーバーを用いてクラサバ形式で業務を行います。 本番実施前に、ノートPCにSQLサーバー2005エクスプレスを入れて テスト環境として1台のみで使用していた際は問題ありませんでした。 本番では、WIN2008サーバーにSQLサーバー2008を入れて使用したのですが、 サーバーに対して、クライアント1台しか接続していない状態でも処理負荷が高く、 動作が非常に遅くなり、ノートPCよりレスポンスが3倍ほどかかるようになりました。 データ件数は同じ状態です。（15万件ほど） 一部のやや複雑な条件抽出処理では、本番サーバー環境側は処理が停止してしまいます。 （ノートPCではやや時間がかかるもののきちんと結果が戻ってきますが、 　本番側は数時間待っても結果が戻らず停止と同じ状態です） 本番サーバーの状況として、メモリ、ネットワークは殆ど使用しておらず、 CPUのみ25%を占有し続けている状態で、処理負荷がかかっているようです。 当然ながらノートPCのCPUよるは遥かに高性能です。 本番環境のSQLサーバ2008で初期データを作成する際、 2005エクスプレスで作成した初期データ（MDFファイル）を 2008側でアタッチしただけです。 テスト環境のノートPCの方が性能が良く、 高額な本番環境のサーバーが使いものにならない状態です。 直すべき点等があればご教授お願いします。
初めて質問させて頂きます。 現在テーブルの中に「時間の長さ」を管理している項目があります。 具体的には ・１時間30分ですと「130」 ・10時間15分ですと「1015」 のように管理してあります。 この項目を10進数で表現し、更に時間を単位として算出したい状態です。 例 1時間30分ですと「130」なので「1.5(h)」として算出したいのです。 このように変換できるファンクションを作成しようとしているのですが、なかなかうまくいきません。 今試している方法としては "時間"と"分"に分けて考えて、"分"は60で除算しようとしています。 それを足しこむ事で、上の例ですと「1 + 0.5 = 0.5」と算出しているのですが "分"がうまく割り切れない場合の端数処理や例外の場合を考えると どのようにファンクションを作ればよいか分からなくなってきました。 どなたか良い例を教えて頂けませんでしょうか。 よろしくおねがいします。
ＳＱＬで集計をしたいです。 ＳＱＬを始めたばかりの者です。 下記、よろしくお願いします。 説明不足がありましたら、ご指摘をお願いします。 ＭＳ－ＳＱＬＳｅｒｖｅｒ２００５環境です。 下記の売上テーブルが存在します。 テーブル：UriageTBL 年月日 受注番号 商品コード 商品名 個数　　単価　　金額 20101001　100　　　300　　　　　リンゴ　　　1　　　100　　　100 20101001　110　　　400　　　　　バナナ　　 1　　　150　　　150 20101001　110　　　400　　　　　バナナ　　-1　　　150　　-150 20101001　120　　　500　　　　　キャベツ　　1　　　120　　　120 20101002　130　　　500　　　　　キャベツ　　1　　　120　　　120 20101002　140　　　600　　　　　レタス　　　1　　　110　　　110 20101002　140　　　600　　　　　レタス　　　1　　　110　　　110 20101002　150　　　400　　　　　バナナ　　 1　　　150　　　150 －－－－－－－－－－－－－－－－－－－－－－－－－－－－－ 商品コードに対応する商品グループ（テーブルは存在しません） 商品コード　商品グループ 300　　　　　果物 400　　　　　果物 500　　　　　野菜 600　　　　　野菜 －－－－－－－－－－－－－－－－－－－－－－－－－－－－ 【結果】 年月日 商品グループ 受注件数 個数合計 金額合計 2010/10/01 果物 　　　　　 1　　　　　1　　　　　100 2010/01/01 野菜 　　　　　 1　　　　　1　　　　　100 2010/10/02 果物 　　　　　 1　　　　　1　　　　　150 2010/10/02 野菜　 　　　　 2　　　　　3　　　　　340 売上テーブル（UriageTBL)を、年月日別、商品グループ別に集計し、受注件数、個数合計、金額合計を取得したいです。 また、商品コードに商品グループテーブルが存在しない為、ＳＱＬ内で設定します。 ただし、受注合計金額が０円の時は集計から外します。（受注番号１１０は集計から外します。） （受注件数は、受注番号の件数です。） 上記の場合、どのようなSQLの組み方をすればよいのか見当もつかず悩んでおります。 どなたかご教授頂ける方がいらっしゃいましたら、よろしくお願い致します。
初めて質問させて頂きます。 VB内でSQL文を作成し、それをSqlServerに送り実行させているのですが、 VB内でSQL文を作成する時に、Whereの条件を入れたり入れなかったりします。 その時、都度、WhereをつけるのかAndをつけるのか判断してプログラムを書くのが億劫なので Dim SqlString as string SqlString = "SELECT * FROM テーブルA WHERE 0 = 0" IF txtA.text <> "" then SqlString = SqlString & " AND 項目A = " & txtA.text END IF IF txtB.text <> "" then SqlString = SqlString & " AND 項目B = " & txtB.text END IF こういうズボラをしてるのですが、これってSqlの実行スピードに影響したりしますか？ 思うようにインデックス使ってくれなかったりしますか？ ご存知の方がご教授下さい。 よろしくお願いします。
固定長テキストの中身（50件）を区切りながら、SQL2008に取込たいのですが、 どうすればよいでしょうか？ 【要件】 ・固定長テキスト（中身：50件）を区切りながらテーブルへ件数分取り込みたい。 ・1件ごとに、固定幅（2桁、4桁）で16項目に区切り挿入先テーブルへ格納 ・挿入先テーブルの項目数は18項目。1番目に自動採番、18番目にデフォルトで0を追加 【状況】 ・固定長テキストを一時表(temptable)に取込 ・一時表を変数(@vlalue）に代入 ・変数から取込先テーブルへ区切りつつ、挿入 【質問】 ・テキストの中身が1件のときは、取込先テーブルに区切られながら挿入されますが、 50件のときには50番目の値を50回とりこんでしまい、１～４９件目が挿入されていない状態です どうやれば、１～５０件目がきちんと取込されますでしょうか？ 【ソース】 CREATE TABLE #TempTable (value char(64)) INSERT INTO #TempTable EXEC master..xp_cmdshell 'type C:\Users\owner\Desktop\取込.TXT' DECLARE @value char(64); SELECT @value = value FROM #TempTable WHERE value IS NOT NULL DECLARE @count char(100); SELECT @count = count(*) FROM #TempTable DECLARE @i char(1); SET @i = 1; while @i<= @count BEGIN INSERT INTO [DB名].[dbo].[Table_1] ([項目1]～[項目1６]) VALUES (SUBSTRING(@value,1,2),～SUBSTRING(@value,61,4) ) SET @count = @count - 1 END
SQLServer2005のバックアップ・リストアコマンドについて教えてください。 自動でSQLServer2005のバックアップ取得・復元を行うバッチを作成することになりました。 バッチの知識はそこそこあるのですが、 SQLServerは触ったことが無いのでどんなコマンドがあるか全然知りません。 ヘルプを見てもうまく見つかりませんでした・・・。 GUIではいつも、 ■バックアップ ・対象DBを右クリック － 「タスク」 － 「バックアップ」を選択 ・バックアップ先を指定 それ以外はデフォルトのまま ■復元 ・対象DBを右クリック － 「タスク」 － 「復元」 － 「データベース」 ・復元用ソースに「デバイスから」を指定 ・「ファイル」でバックアップしたファイルを指定 ・「復元するバックアップセットの選択」にて「完全～」にチェック ・オプションタブにて、「既存のデータベースを上書きする」にチェック ・それ以外はデフォルトのまま といった操作で実行しています。 これと同じことをコマンドで実現したいのです。 どんなコマンドがあるのか？ オプションにどんな指定をしてやればいいのか？ 例を交えて詳しく教えていただけないでしょうか？ 知識をお持ちの方、どうかアドバイスお願いします。
SQLServer2008のトランザクションログ書き込みエラーについて 以下のエラーログが出力された後、自動フェールオーバーが発生しました。 ↓ 11/08/2010 13:49:17,spid4s,不明,SQL Server has encountered 1 occurrence(s) of I/O requests taking longer than 15 seconds to complete on file [C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\MSDBLog.ldf] in database [msdb] (4). The OS file handle is 0x00000608. The offset of the latest long I/O is: 0x00000000703000 ↑ このエラーログを調べていくと、ハードの問題である可能性がある事がわかり、ハードの診断チェック を行ったのですが、特にエラーは無く、何が原因で発生したのか分からず、どんずまり状態です。。。 原因を追及するにあたって、何か手立てはありますでしょうか？
VB2010 とSQL Server2008 R2 で開発をしています。 担当者テーブル（table_tanto）と売上明細テーブル（table_uriage_meisai）があります。 各テーブルのカラムは以下です。 table_tanto ・tanto_id ・tanto_name table_uriage_meisai ・meisai_id ・tanto_id ・kingaku ・date ある期間の担当者別の売上実績を一覧で出力したいと考えています。 「table_uriage_meisai」の「date」で範囲指定したいと思います。 結果はこんな形を望んでいます。 担当者ID　担当者名　売上合計 0001　　　○○○　　　****** 0002　　　□□□　　　 　　0 0003　　　△△△　　　****** 0004　　　●●●　　　****** ２点質問があります。 売上の無かった担当者も含めてすべての担当者の一覧を出したいと考えています。 そのSQｌがわからないのと、売上がなかった担当者はその列がNullになってしまうと思うんですが、後の計算で困ります。 Nullのときゼロを返すようにするにはどうしたらよいでしょうか。 以上２点について教えて下さい。 よろしくお願いします。
オラクル初心者です。ご教授ください。 Windows2003でoracle9iを使用しています。 oracleのアーカイブログ（アーカイブREDOログ？？）でディスク領域が圧迫されている ため、アーカイブログを移動したいのですが、どうすれば いいでしょうか？ 普通にＯSでアーカイブログを選択し右クリックしながら ドラッグして移動で大丈夫なのでしょうか？ お分かりの方がいらっしゃいましたら教えてください。 以上、よろしくお願いいたします。
SQL server 2005・メンテナンスプランに関する質問です。 SQL server 2005において、メンテナンスプランで毎日データベースの圧縮と バックアップ、不要データの削除を行っています。 不要データ削除により、バックアップファイルは日に日に小さくなって おり、 メンテナンスプラン開始日より約7ＧＢ小さくなっているのですが、 肝心の データベース本体（mdfファイル）は全く小さくなっていません。 データベースを右クリックし、タスク－圧縮を選ぶと、使用可能な空き領域が 7GBと表示されるので、不要データの削除により空き領域は増えているもの の、メンテナンスプランの圧縮時にその空き領域の解放が行われていない ようです。 そこで、質問ですが、メンテナンスプランの圧縮タスクで空き領域を解放する には下記の設定以外に何か特別な設定が必要なのでしょうか？ 圧縮後に残す空き領域は10％、解放された領域はオペレーティングシステム に返すよう設定しています。 ※SQLのログで気になるのは、圧縮のメンテナンスプランは毎日実行され、 正常に実行されましたと記述されているのですが、実行時間が数十秒しか かかっていないのです。 20GBのデータベースの圧縮で数十秒しかかかっていないというのは実際には 正常に実行されていないのでしょうか？ よろしくお願いします。
DBサーバを再起動したらSQLServerのサービスは自動で起動？ どなたか御教授ください。 WindowsServer2003　に　SQLServer2008をインストールしています。 サーバを再起動すると、SQLServerに対して何もせずにクライアントからDBへ接続できるのですが、 これが仕様なのでしょうか？ サービスなど手動で起動する必要がないのでしょうか？
スペース区切りによるAND検索をSQL文だけで実現したい いわゆるWeb検索等で利用するスペース区切りでのAND検索を SQL Serverでも実現可能かどうかを調べています。 結合に使用するため、プログラムからSQLを組み立てる事が出来ません。 なお、検索したい対象は一時テーブル内の小数データなので、パフォーマンスは特に問題は有りません。 ただし、一時テーブルなのでCONTAINS等を使用する事が出来ません。 せめて一時テーブルに対するフルテキスト検索が出来れば問題ないのですが、、、 以上、よろしくお願いします。
ハングル文字が入らない。 DBを「SQLServer2005」を使って、 ハングル文字を使うシステムを開発しております。 ハングル文字を格納するフィールド（カラム）の型を nvercharで設定しました。 Accessのリンクで直接貼り付けた場合はハングル文字が格納されますが、 insertやupdateでは??が格納されてしまいます。 どうすれば、SQL文でハングル文字が格納できますでしょうか？ 韓国版のSQLServerでないと駄目なのでしょうか？ どなたか教えて下さい。 よろしくお願い致します。
SQLserver2005 テーブル一覧の取得 知っている方には、基礎すぎて申し訳ないのですが、 添付画像のテーブルを選択して、SQLペインを表示させて そこに、 　EXEC sp_tables と記述して、テーブル一覧を取得しようとして「！」マークを 押して、sp_tablesを実行させようとした所、下記のようなエラーメッセージが 出てしまいます。 EXEC SQL コンストラクトまたはステートメントはサポートされていません。 書き方が悪いのか、ストアドプロシージャの実行場所が悪いのかよく分かりませんが うまく行きません。 sp_tablesを使用して、テーブル一覧を取得する方法をどなたか教えて下さい。 よろしくお願いします。
SQLServer2000のバックアップファイルをmsdeにインポート方法 お世話になります。ご存知の方がいましたら以下について教えてください。 【目的】 客先から取得したSQLServer2000のバックアップファイルを、自社の環境にimportしたい。 【問題】 自社マシンのOSは、XPとWindows Server 2008しかなく、SQLServer2000をインストールできません。 仕方なく、現在はXPにMSDNをインストールしました。 このMSDNに客先取得バックアップファイルをimportするにはどうすればよいでしょうか。 【備考】 できれば、コマンドラインよりもフリーのGUIツールを紹介いただきたいのですが。 なければコマンドラインの方法でも構いませんので、何卒よろしくお願い致します。
sqlserverのバックアップを定期的に取りたいと考えています。 バージョンは2005です。 やり方は下記のページを見つけました。 http://oshiete.goo.ne.jp/qa/4798230.html 上記のスクリプトファイルなのですが、固定の名前ではなく日付をつけくわえたbakファイルを作りたいと考えています。 例　testdb_2010xxxx.bak しかし、下記のようなスクリプトを書いてもうまく動きませんでした。 backup database testdb to disk = N'c:\Backup\testdb_'+DATEPART(yyyy, GETDATE())+DATEPART(m, GETDATE())+DATEPART(d, GETDATE())+'.bak' 文字列の連結のやり方がおかしいのだと思いますが、どこが間違っているのでしょうか。
SQL Server 2008 を使用しています。bcpコマンドでクエリー結果をエクスポートする際に、1行目に列名を含めるにはどうしたらよいでしょうか？ >bcp "select * from [db1].[dbo].[table1]" queryout output.txt -c -t"," -r"\n" -T などとしてクエリー結果をテキスト出力する際、上記のコマンドを実行すると1行目からいきなり条件に一致したデータで始まってしまうのですが、1行目に列名を含めるにはどうしたらよいでしょうか？
SQL SERVER2005とアクセス2007でデータベースを作成しています。 データベース自体はできまして、自分のパソコンではACCESSからSQLSERVERへデータを書き込んだり、読み込んだりはできます。 次の段階として、社内LANにデータベースをおいて、ほかのパソコンからもデータの書き込み及び読み込みをしたいのですが、うまくいきません。 ほかのパソコンからデータベースを開くと、接続を拒否されてしまいます。 SQLSERVER MANAGEMENT STUDIO EXPRESSで何か設定が必要なのでしょうか? よろしくご教授お願い致します。
accessからsqlserverにアップサイジングしましたが,テーブルにデータを入力出来なくなってしまいました。 Dim rs As DAO.Recordset Dim db As DAO.Database Set db = CurrentDb() Set rs = db.OpenRecordset("確認用", dbOpenDynaset) rs.AddNew rs!品番 = Me.品番 rs.Update 上記のようにDAOを介してテーブルにデータを入れていました。 アップサイジングする前は、問題なかったのですが、どういったことが原因になりますでしょうか?
SQL2005での操作についてご相談です。 初心者に毛が生えたか生えないか程度の知識しかないので、質問に矛盾がありましたらご容赦ください。 ２つのデータベース、AとBがありまして、AとBは同じテーブルが作られています。（BはAをバックアップしたものです） 何かの操作で、Aのデータの一部（会員番号の様な物）が消えてしまったので、BのデータからAへ上書きしたいのですが、そのやり方がわかりません。AのデータはBの時点から更新されてきているので、完全にBに置き換えることが出来ません。 　もし　Aの氏名＝Bの氏名　なら　Aの会員番号　に　Bの会員番号　を上書きする、というイメージなのですが・・・　 ちがうデータベース間でもこの様なことは可能でしょうか？よろしくお願いいたします。
SQL文に関して教えてください。 SQLServer2005を利用し、マイクロソフトアクセスでadpを利用して構築を初めて行っています。 そこで、SQLServerのビューこのような事は可能でしょうか？ (ビューをネストすれば出来るのですが、1つのSQL内で完結させたい） 色々探し、近い物はあったのですが、若干異なります。 フィールドがID1、ID2、ID3、date、txtと存在するとします。 ID1 ID2 date txt 1 1 20100801 test 2 1 20100901 Null 3 3 20100928 Null txtフィールドがNullのレコードを対象とし、dateが一番古い日付のレコード、nullのレコード数を 取り出す。結果としては以下が出れば正解です。 （グループ化が必要かと思います） ID1 ID2 date レコード数 2 1 20100901 2 やはり難しいでしょうか？ 御教授願います。
テーブル設計で、項目名の付け方について迷っています。 いつもお世話になっております。 仕事で初めてテーブル設計を任されました。 今はマスタの設計をしています。 そこで、一つ質問があります。 得意先マスタと会員マスタがあって、両方のテーブルに 住所、電話番号があるのですが、この場合は普通、 S_TOKUI_ADDとS_KAIIN_ADD C_TOKUI_TELとC_KAIIN_TEL といった具合に、名前を変えるのが一般的でしょうか。 それとも、テーブルが違うんだから気にせずに S_ADDRESS、C_TELと同じ名前を付けるのが一般的でしょうか。 よろしくお願い致します。
データベースに接続できません java初心者です eclipseで開発を行っているのですが、どうもエラーがでてきて接続できません よろしくおねがいします エラー内容 Exception in thread "main" java.lang.NoClassDefFoundError: DataBase Caused by: java.lang.ClassNotFoundException: DataBase at java.net.URLClassLoader$1.run(URLClassLoader.java:200) at java.security.AccessController.doPrivileged(Native Method) at java.net.URLClassLoader.findClass(URLClassLoader.java:188) at java.lang.ClassLoader.loadClass(ClassLoader.java:315) at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:330) at java.lang.ClassLoader.loadClass(ClassLoader.java:250) at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:398)
ＰＬ／ＳＱＬの質問 お世話になっております。 下記の様なテーブル「試験項目マスタ」と「クラスマスタ」が二つ有り、 オラクルのＰＬ／ＳＱＬ（ストアドプロシージャ）で、 「試験項目マスタ」の登録ＩＤと「クラスマスタ」の登録ＩＤが同じ場合、 ２Ａ列以降に丸印を付けていきたいのですが（説明が難しく、省略してい ますが、つまり下記の「結果」様にしたいのです。）、 どの様な記述をすれば良いのか分からず困っています。 どなたかご親切な方、ご教授頂きたく宜しくお願い致します。 　　　　　　記 「試験項目マスタ」 登録ID大項目中項目小項目 2A　 2B　 2C　 2D　 2E　 2F　　2G　　2H　　2I　　2J　2L 0001学科試験　国語　　　古文 0002学科試験　数学I 0003学科試験　数学 0004学科試験　化学 0005学科試験　世界史 0006学科試験　日本史 0007学科試験　英語　　　英会話 0008学科試験　体育　　　サッカー 0009学科試験　音楽　　　合唱 0010学科試験　技術 「クラスマスタ」 登録IDクラス 00012A 00012C 00012D 00012F 00012H 00012J 00022B 00022E 00022G 00022I 00022L 　・　　　・ 　・　　　・ 　・　　　・ 　↓ 結果 登録ID　　大項目　中項目　小項目　2A　　2B　　2C　　2D　　2E　　2F　　2G　　2H　　2I　　2J 0001　　学科試験　国語　　　古文　　○　　　　　 ○　　　○　　　　　　○　　　　　　○　　　　　○ 0002　　学科試験　数学I　　　　　　　　　　　　○　　　　　　　　　○　　 　　　　○　　　　　　○ 0003　　学科試験　数学 ・　　　　・　　　 ・ ・　　　　・　　　 ・ ・　　　　・　　　 ・ ・　　　　・　　　 ・
SQL Server 2005 EXPRESS Developer Editionの機能について 現在、開発用パソコンと本番サーバー用パソコン間で、データのインポート・エクスポートの為だけにDeveloper Edition を使っています。 Developer Editionは開発・テスト用途と言う事ですが、本番環境との違いとは何ですか？ 本番環境で使うと、どういった制限が有るのですか？ ご存知の方、よろしくお願いします。
ＳＱＬ初心者です。 ３項目が一致した重複データを省きたい。 テーブルＡには　誕生年　名前　年齢　が　入っていて 誕生年、名前、年齢が同じレコードははぶきたいのですが、 どのように書いたらいいでしょうか。 Windos XP 言語：vbs DB Micosoft Sql server 2008
SQLの書き方 SQL初心者なのですが、わからないことがあるので教えてください。 表Employees (EmployeeID,EmployeeName) 表Salary (PayDate,Amount,EmployeeID) という2つの表があるときに、次の問題があります。 問題：表Employeesから各EmployeeIDについて、SalaryのAmountの最高が300,000以上のデータを取り出し、EmployeeID,EmployeeName,Amountの最高額を表示しなさい。 答えが SELECT EmployeeID ,EmployeeName ,( SELECT MAX(Amount) FROM Salary WHERE EmployeeID=Employees.EmployeeID /*GROUP BY EmployeeID*/ ) FROM Employees WHERE EmployeeID IN ( SELECT EmployeeID FROM Salary GROUP BY EmployeeID HAVING MAX(Amount)>=300,000 ) ; となるのですが、/*と*/の間の文がいらないのはなぜですか？選択リストの中の副問い合わせで、MAX(Amount)というのがあるのでグループ化しなければならないと思うのですが、よくわかりません。
SQLサーバーのジョブでのexeファイル実行について教えてください。 FTP転送を行うバッチ(拡張子bat)を作成しexeファイルに変換してから SQLサーバーのジョブから実行しようと思っています。 batファイルからexeファイルへの変換は WindowsのIExpressとBat_To_Exe_Converterというツールを使用しました。 SQLサーバーにジョブを作成してバッチを実行させようとしたんですが batファイルのままであれば実行できるのに、exeファイルで実行させようとすると ジョブが実行中のままになり止まってしまします。 exeファイルは直接実行させると想定の処理が実行させるので 壊れていることは無いと思います。 原因の検討がつかず困っています。 些細なことでもいいので何か教えて頂ければと思います。 宜しくお願いします。 尚、exeに変換するのはバッチファイルの中身を見せないようにする為です。
複数フィールドを返すストアドからある1フィールドの値を取得するにはどのようにすればいいのでしょうか。 SP_Aというストアドがあります。 SP_Aストアドではパラメータ値を指定して該当するレコードをSELECTで取得しています。 ----------------------------- SELECT TOP 1 　field1, 　field2, 　field3 WHERE 　field2 = @パラメータ値;, ----------------------------- 新たにSP_Bというストアドを作成してその中でこの上記のストアドを実行してfield3フィールドの値のみ取得したいと思っていますがどのようにすればいいのかわかりません。 このSP_Aストアドは既に色々な箇所で使用されている為、修正したくありません。 SP_Aストアドを修正しないでfield3フィールドの値のみ取得する事は可能でしょうか。 説明が下手ですみませんがうまく伝わりましたでしょうか。 ご存じの方がいましたらアドバイスいただけませんでしょうか。 些細な事でも何でも構いませんので宜しくお願いします。
アクセスについて質問です。緊急です。 発注のシステムに、私が触ったせいで不具合がおきてしまいました。まず、しくみは、ヘッダー入力フォームでオーダーナンバーと仕入先を記入します。そしてそのあと詳細を書きこむフォーにうつり、商品番号などの詳細を入力するようになっています。 このとき、以前は、詳細を書きこむフォームの端にオーダーナンバーの欄があり、ここには、さきほどヘッダーで入力したオーダーナンバーが自動で入っていました。 そのため、その詳細フォームのテーブルには、オーダーナンバーも詳細も、すべて一緒のデータとして入っていたのです。しかし、私がその（テキストボックスだったか、何ボックスかわかりませんが）オーダーナンバーの入ったボックスを消してしまい、それ以降、詳細フォームを入力しても、詳細がテーブルに入るのみで、オーダーナンバーとは連結しなくなってしまったのです（テーブルにオーダーナンバーが入っていない） この、元のように、詳細フォームの画面に詳細テーブルのオーダーナンバーにつながるボックスを置き、（ここまではできます）　そこに、オーダーナンバーが自動で入力されるようにする（これができない）にはどうしたらよいのでしょうか？ どなたか、本当にお願いいたします。
『SQL』の勉強の仕方。 SQLの勉強方法として、何かオススメはありますか？ あれば教えてください。
Windows Server 2008 EXPRESSのテーブル別のユーザー権限設定方法を教えてください Windows Server 2008の初心者です。 Windows Server 2008 EXPRESS上でテーブル別、ユーザ別に SELECTやINSERT、UPDATEの権限設定はできるのでしょうか 設定方法が分からなくて困っています。
SQLServerのテーブルはdbOpenTableで取得できない？ いつもお世話になっております。 VB6.0、Access2003で開発されたシステムのデータベースを SQLServer(2008Express)に置き換えています。 接続方法は、現行通りのDAOを使用したいと考えております。 レコードセットをオープンするときに、 Set RS = DB.OpenRecordset("テーブル名", dbOpenTable) としたら、「引数が無効です」というエラーが発生しました。 dbOpenTableの所をdbOpenDynasetに変更したらエラーは発生しなくなりました。 SQLServerへの接続の場合、dbOpenTableは使用できないのでしょうか？ dbOpenTableが使用できないとなると、IndexやSeekも使用できないということでしょうか？ 以上です。よろしくお願い致します。
accessからsqlserverへの移行について！ 現在accessでシステム運用しています。 処理に時間がかかるのでDBのみsqlserverへの移行を検討しています。 時間がかかる原因は計算項目が多く計算の為に必要な定義項目と参照項目で計算項目を含めると約300項目となります。 この為、クエリーをNo.1とNo.2の2個のクエリーに分けて対処しています。 クエリーNo.2はNo.1の式の値を使用し更に式で計算しています。 クエリーで定義している計算式も条件が複雑なものもありさらに計算結果⇒計算結果⇒・・・・となっています。 この様な内容なので入力画面はレスポンスが遅く印刷は5～10分位かかるものがあります。 とりあえず印刷処理を早くしたいと思い一旦ワークテーブルに必要項目を出力する等をやって見ましたがやはり抽出に時間がかかりあまり改善しません。 データ件数は約3万件なのでデータ件数は問題ないと思っています。 accessの処理はそのままでDBをsqlserverからODBCでリンクしようと思います。 DBをsqlserverに移行することで処理速度の改善はどの程度見込めるのでしょうか。 計算項目数が多いのであまり見込めないのではと思っています。 accessからsqlserverへの移行された方でどの位改善されたのか教えて下さい。 現在の運用環境はサーバは使用せずファイル共有で4台のPCで運用しています。OSはWinXPです。 今回も専用サーバは使用せず現在のWinXPのPCにSQLServer2005無料を使用しようと思っています。 又、accessの処理で他に早くする方法がありましたら教えて下さい。 よろしくお願いします。
列を行に変換したいです。 SQLServer2008初心者です。 テーブル関数のFETCH内で以下のような図の列１～２１を行に変換したいのですが、 うまくいきません。 CODE１ CODE２ CODE３ … CODE21 ----------+----------+----------+----------+---------- AAA BBB CCC … UUU ↓ 列１ ------ AAA BBB CCC … UUU 自分で調べたところ、SQLServer2005ではUNPIVOTを使えるということで 同じように書いたのですが、「'UNPIVOT'の近くに無効な構文があります」というエラーが出てきてしまいます。 ちなみに、以下のように書きました。 SELECT CODE FROM( SELECT CODE1, CODE2, …, CODE21 FROM 商品マスタ 　　　WHERE SYCODE = @SYCODE ) AS TBL UNPIVOT (CODE for ColName in (CODE1, CODE2, …, CODE21)) AS CD UNPIVOTの使い方が間違っているようでしたらご指摘をお願いします。 また、UNPIVOTが使えない場合、 SELECT CODE1 FROM 商品マスタ WHERE SYCODE = 11111 UNION ALL SELECT CODE2 FROM 商品マスタ WHERE SYCODE = 11111 UNION ALL … という風に列21までのSELECT文をずらずらと統合することになるのかなぁ、と考えているのですが、 もっと簡潔な方法がありましたらご指導頂きたいです。 よろしくお願いします。
SQLserver 2005 の評価版を利用したいのですが・・・ 自己学習用に2005の評価版を利用としたところ、すでに提供がおわっていました。 2008でもよいのですが、2008からは64bitのみ対応の様子です。 64bitマシンを購入する以外に手軽にスグに実行出来る良案は何かありますか？ ###### 以下の方法があればよいのですが・・・ ●2005　エンタープライズ　の製品版を格安で入手 ●2008を32bitOS上にインストールして使う方法 ●提供終了2005評価版を入手する方法 等
ストアドの一時テーブル格納について SQLServer2000を使用しています。 sp_help_jobの結果セットを一時テーブルにいれたく、 以下のようなスクリプトを作成しています。 -------------- create table #tbl ( 　列名 　・ 　・ 　・ ) Insert into #tbl msdb.dbo.sp_help_job -------------- スクリプトを実行すると、以下のエラーでInsertに失敗します。 「メッセージ 8164、レベル 16、状態 1、プロシージャ sp_get_composite_job_info、行 72 INSERT EXEC ステートメントは入れ子にはできません。」 上記の改善策についてアドバイス頂けないでしょうか。 よろしくお願いします。
SQL Server 2005 Expressのインストール時のMSXML構成不能によるインストール失敗について。 この質問は色々なところで出ていると思うのですが、以前はMicrosoft自身が提供していた、Windows Installer Cleanup ユーティリティで解決可能だったのですが、現在このツールは提供されていません。 （同じKB番号でOfficeに関してのアンインストールツールの提供となっています） どなたか、他の方法でSQL Server 2005 ExpressインストールにMSXML6の構成ができないためインストール出来ない事象について、解決なされた方はおられませんでしょうか？
SQLで違うテーブルの集計結果を比較することは可能でしょうか？ 例えばAテーブルがこんな感じです A1＿ A2＿ A3＿＿＿ A4 ＿＿＿＿A5 XX＿ YY ＿5 ＿＿2010/8/13 ＿10：00：59 Bテーブルはこんな感じです。 B1＿ B2＿ B3＿＿＿ B4 ＿＿＿＿B5 XX＿ YY＿ 米 ＿＿2008/5/20＿ 00：00：00 XX＿ YY＿ 味噌 ＿2009/8/22＿ 01：02：33 XX＿ YY＿ 卵＿＿ 2007/8/21＿ 23：35：55 XX＿ YY＿ 醤油 ＿2010/7/16＿ 15：30：35 XX＿ YY＿ 胡麻＿ 2010/8/13＿ 02：02：02 です。 見つけたい条件はBテーブルに指定した日付が含まれてる（例えば今日8/13だとか）レコードがあればそのXXとYYが何件あるかカウントをしてその値がAテーブルのA3の値と同一か調べたいのですがこういうことは出来ますでしょうか？ SQL Server2005です
サーバーへの接続 サーバーへの接続 [Server Name]に接続できません． 追加情報： SQL Serverへの接続を確立しているときにネットワーク関連または インスタンス固有のエラーが発生しました．サーバーが見つからないか アクセスできません．インスタンス名が正しいこと，およびSQL Sever がリモート接続を許可するように構成されていることを確認してください． (provider: 名前付きパイプ プロバイダ，error: 40 - SQL Server への接続を開けませんでした）（Microsoft SQL Server, エラー:2） SQL Server Management studioでローカル接続をすると 上記エラーが表示され舞す。 そこで、SQL Server構成マネージャを確認すると 「SQL Server(SQLEXPRESS)」の状態が「停止」になっていました。 そこで開始にしようとすると、今度は下記のエラーが出て開始する ことができませんでした。 ”要求が失敗したか、サービスが適切な時間内に応答しませんでした。 詳細については、イベントログまたは他の適切なエラーログを参照してください。” またSQL Serverセキュリティ構成から開始しようとしたのですが 今度は、下記のエラーが出て開始することができませんでした。 ”サービスは適切な時間内に開始要求または制御要求に応答しませんでした。 このサービスを開始または停止するには、管理者特権が必要です。” 以上、何か解決策があれば幸いです。 SQL Server 2005　 OS：XPです。
SQLServer(2005)でビューの作成がうまくいきません。 インデックス を作成できません。ビューでは別のビュー 'View1' が参照されています。インデックス付きビューの定義で参照されるビューの定義を手作業で拡張することを検討してください。 というエラーが出ます。（参照しているビュー’View1’にもインデックスが設定されています） このエラーの回避策をご存知であれば、教えていただきたいと思います。 よろしくお願いいたします。
transact-sqlからoracle DBを参照したい。 sql-server 2005 window server 2003 R2での環境です。transact-sqlを使用して、他のマシン上にあるoracle データベース上のテーブルのデータを取得し、そのデータを自身のマシン上のsql serverのテーブルに格納したいのですが、そのようなことはできますでしょうか。 もし、できるとすれば、どのような方法（手順）になるのでしょうか。
サーバーへの接続 [Server Name]に接続できません． 追加情報： SQL Serverへの接続を確立しているときにネットワーク関連または インスタンス固有のエラーが発生しました．サーバーが見つからないか アクセスできません．インスタンス名が正しいこと，およびSQL Sever がリモート接続を許可するように構成されていることを確認してください． (provider: 名前付きパイプ プロバイダ，error: 40 - SQL Server への接続を開けませんでした）（Microsoft SQL Server, エラー:2） 「SQL Server 2005 Management Studio」 で接続（Windows認証）すると、上記のエラーがでます。 解決策はありますか？ もう一度インストールし直した方がよいのですか？
他のＤＢのテーブルと内部結合が可能でしょうか sql sever 2005 を使用します。このたび、データベースＡのテーブルａを定期的に検索するsqlを作成することになりました。このsql文は、ストアードプロシージャとして登録予定です。 その際、テーブルｂを内部結合で参照します。例として、テーブルａは社員番号があり、テーブルｂは社員番号、社員名があります。（テーブルｂは社員マスター） テーブルａを参照し、その社員名を内部結合（INNER JOIN）で取り出します。 ここで、テーブルａ，ｂが共に、同じデータベース内にある場合は、問題ないのですが、 テーブルｂは、別のマシンのsql sever 上にあります。（したがって、データベース名も異なります） このような状態で、内部結合による参照は可能でしょうか？ また、内部結合ができないまでも、ストアードプロシージャで、データベースＡのテーブルａを参照しながら、別のマシンのデータベースＢのテーブルｂを参照することは、原理的に可能でしょうか。 なお、データベースは共にsql server 2005を使用します。
論理名と物理名の違いについて SQLServer2005を使ってDBの設計をしている者です。 SQLServerではカラム物理名を論理名と同じように 日本語の名称で作成できるようなのですが 論理名と物理名を両方とも日本語でこのまま設計して大丈夫でしょうか。 物理名を英語表記にしておかないと パフォーマンスが低下するなどの弊害があるのでしょうか？
SQL SEREVER で選択した固定値との結合について質問です。 日付と紐付けたデータを1ヶ月分出力するSQLを作成しています。 紐付け対象となるデータに、1ヶ月毎日のデータが存在するわけではありません。 そこで、固定値として2010年7月であれば、 2010-07-01～2010-07-31 までの日付を全て固定値として取得 （対象データは行で取得したいのでUnionで繋いでいく）して、 その日付と紐づく対象データを外部結合しようと考えました。 SqlServerの場合、固定値のみを取得した場合 ダミーテーブルを使用するということができないようなので、 取得した固定値との紐付け時に下記???のところの指定がわかりません。 Select '2010-07-01' 日付 Left Join 結合対象テーブル On 結合対象テーブル.日付 = ???.日付 他のやり方で実現可能なのかもしれませんが、調べてもわかりませんでした お解りになる方いらっしゃいましたら、教えていただければと思います。
EXCEL2003 VBA でSQLServerに接続。その時カラム名を表示したい。 いつもお世話になっております。 EXCEL2003のVBAでSQLServerに接続しています。 VBAの中でセレクト分を作って、実行した結果をエクセルシートに返しています。 エクセルシートには、SQLServerから検索した結果が正しく返されますが、 各カラムの名称が表示されません。 できれば、SELECT 文の AS を使って、カラムの名称も変更したいのですが、 VBA経由では、カラム名は表示されないものでしょうか。 何か方法がありましたら、ご教授ください。 以上、よろしくお願いいたします。
Xampp上で、sql server 2005を動かすには？ 開発環境で、ひとつのＰＣ上でサーバー側「sql server 2005」と、クライアント側のアプリを構築しなければなりません。 この場合、Xamppを使って「sql server 2005」を構築すればいいと思いますが、何せこの辺の知識を持ち合わせておりません。 動作環境は、Windows XP(SP3)です。 参考になりそうなＷｅｂサイトなどを、教えていただけませんか。 以上、よろしくお願いします。
T-SQLで10万件程度のInsert処理を記述したい。 カーソルを利用したループ処理の中で、 Insert失敗時（エラー時）のみ、そのデータだけスキップし、 次のデータ登録処理に進みたい場合、 どのように記述すればよいのでしょうか。
WHERE条件の最終桁のスペースについて質問です。 あるテーブルのカラム(colA)に"1234"というデータがあるときに、 (1)SELECT .... WHERE colA='1234' (2)SELECT .... WHERE colA='1234 '　　(1234の後に半角スペース) (3)SELECT .... WHERE colA='1234　' (1234の後に全角スペース) (4)SELECT .... WHERE colA='12345' を、実行すると、(1)だけＯＫで、他はＮＧとなると思い込んでいましたが、 実際は、(2)と(3)も同じように検索されてしまいます。 WHERE条件の最終桁のスペースは無視される？ こういうものなのでしょうか？ オンラインヘルプ等からは、それらしい情報が見つけられなかったのですが、もしこの辺の情報がわかるサイト等ご存知でしたら教えてください。 ちなみに、 SQL-SERVER2005(照合順序:Japanese_CI_AS) colAは、varchar(20) です。 p.s. 基本中の基本かもしれませんが、いままでずっと勘違いしていたので、過去の納品してきたお客様の件数を考えて恐ろしくなっています。(T.T)
別のテーブルの値を抽出条件としたい。 環境は SQL Server2005、Access2003（Accesプロジェクト adb）です。 テーブル「社員台帳」で、年度ごとに社員の情報を管理しています。 イメージはこんな感じです。 　　　　年度　　社員　　　基本給 　　　　2009 aaa \1,000 2009 bbb \1,050 　　　　 ・ 2010 aaa \1,020 2010 bbb \1,080 これとは別に年度を管理するテーブル「年度辞書」があります。 これは、1レコード(件）のみデータがあり、毎年書き換えています。 イメージは・・・ 　　　　　 　　　　　年度　　開始日　　 終了日 　　　　　2009 2009/04/01 2010/03/31 2010年度では上記データを変更します。 そこでお聞きしたいのは、テーブル「社員台帳」からデータを抽出する処理を作りたいのですが、 Accessでは クエリの抽出条件(年度）に、　Dlookup("年度","年度辞書"）　としていました。 これと同じことがしたいのですが、その方法がわかりません。 どうすればよろしいでしょうか？ よろしくお願いします。
SQL文で質問 いつもお世話になっております。 ＳＱＬ文について質問です。 仮にですが、商品マスタというテーブルと、対応テーブルという二つのテーブルがあります。 対応テーブルには、商品コードが親コード、子コードといった形で構成されています。 対応テーブルのいくつかの親のコードを条件に、親コードと子コードを検索して、それぞれの商品名を検索したいと思っています。 現在、ＳＱＬ文で、親コードに対応した商品名だけを取得しているのですが、子コードに対応する商品名も検索したいと思っています。 現在のＳＱＬ分としては、 SELECT 対応テーブル．親コード、商品マスタ．商品名、対応テーブル．子コード FROM 対応テーブル,商品マスタ WHERE 対応テーブル.親コード = 商品マスタ．商品コード AND 対応テーブル．親コード = 1000,1002,1004 このＳＱＬ文で検索した子コードで、商品マスタの商品名を検索したいのですが、どのようなＳＱＬを書いたらよいのでしょうか。 ご教授願います。
エクセルでのデータベース作成ってどうですか？ 仮に飲食店の顧客データをデータベースを作って管理するとします。 その際ふつうは ＳＱＬサーバなどで管理しますよね？（一般的にどうしているのかよく知りませんが・・・） ＳＱＬなどの代わりにエクセルでデータベースを作ることに関して メリット、デメリットを教えてください。。 また、飲食店の顧客データベースを作成する際 一般的にどのように行っているのか、もしわかるようでしたら 合わせて教えてください！！
SQL Server 2005 EXPRESSでログが出力されない。 テスト用として動かしているSQL Server 2005 Developer EDITIONのManagement Studioを起動させてログフォルダをクリックするとログデータは表示される。 しかし、別のパソコンで本番用に稼動させているEXPRESS EDITIONのManagement Studioからオブジェクトエクスプローラ - 管理 - SQL Serverログ - 現在をクリックするとログデータが表示されません（ログファイルの表示画面が開かない）。 ここには現在 ,アーカイブ#1～#6の計７つのフォルダは有りますが、どれをクリックしてもログが表示されません。 EXPRESS EDITIONではログを出力する為の設定とかが必要ですか？ 本当にログが出力されていないのか、それともログ画面表示の部分がまずいのか、ご教授お願いします。
AccessのクエリをSQL Server2005で書き直したい。 誕生日の翌日を雇用契約の開始日（契約開始日）とするAccessのクエリがあります。 契約開始日: DateSerial(Year(Now()),Mid([生年月日],6,2),Right([生年月日],2)+1) （AccessのSQL文は：SELECT 給与台帳.生年月日, DateSerial(Year(Now()),Mid([生年月日],6,2),Right([生年月日],2)+1) AS 契約開始日 FROM 給与台帳;） これを SQL Server2005 に書き直したいのですが、その方法がわかりません。 どう書き直せばよろしいですか？ よろしくお願いします。
SQL Server(MSDE2000) ： ALTER TABLE した項目に対し、直後に UPDATE で値をセットできない 既存のテーブルを仕様変更するため、列を追加し、初期値で埋める SQL 文を書こうとしていますが、うまく動かず、エラーとなってしまい、原因が判らず困っています。 サンプル SQL 文： ------ CREATE TABLE TEST_TABLE ( TEST_FIELD1 SMALLINT, TEST_FIELD2 SMALLINT) INSERT INTO TEST_TABLE VALUES( 1, 2 ) ALTER TABLE TEST_TABLE ADD TEST_FIELD3 SMALLINT UPDATE TEST_TABLE SET TEST_FIELD3 = 3 ------ ※テスト毎に、必ず DROP TABLE TEST_TABLE されている事が前提です。 上記 SQL 文のうち、１行目～３行目までを抜粋して実行すると、ちゃんと CREATE TABLE され、INSERT され、ALTER TABLE される事を確認しました。 ところが、４行目までを一気に実行しようとすると、 ------ SQL実行中に以下のエラーが発生しました。 エラーコード：207 [Microsoft][ODBC SQL Server Driver][SQL Server]列名 'TEST_FIELD3' は無効です。 SQLステータス：S0022 ------ となってしまい、UPDATE で初期値を埋める事ができません。 しかも、UPDATE に失敗するどころか、２行目の INSERT から以降が結果に反映されなくなるという状況に陥ってしまいます。 また、既存のテーブルの仕様変更が目的なので、その状況に近づけるために、まず、 ------ CREATE TABLE TEST_TABLE ( TEST_FIELD1 SMALLINT, TEST_FIELD2 SMALLINT) INSERT INTO TEST_TABLE VALUES( 1, 2 ) ------ を実行し、既存のテーブル（とレコード内容）が存在する状態を作り出された事を、ツール等で確認してから、 ------ ALTER TABLE TEST_TABLE ADD TEST_FIELD3 SMALLINT UPDATE TEST_TABLE SET TEST_FIELD3 = 3 ------ の２行を実行してみると、やはり UPDATE は失敗し、前述と同じエラーが発生します。 またこの場合、ALTER TABLE の実行結果も反映されていません。（つまり、TEST_FIELD3 が列追加されていない） もちろん、ALTER TABLE だけを実行した場合には、ちゃんと列は追加されます。 その後に、UPDATE を実行すれば、ちゃんと追加列に初期値がセットされます。 どうやら、「一回の SQL 文の実行の中で、ALTER TABLE によって新設した列に対しては、UPDATE などでのアクセスはすぐにはできない」のではないか？という状況のようなのです。一回の SQL 文の実行の中において、何らかのトランザクション動作っぽい挙動を感じます。 つまり、ALTER TABLE で追加された列は、その時点ではまだ完全にシステムに認知されていないため、直後の UPDATE 文で認識できずに失敗するのではないか？と。そして、そこでのエラー発生が、ロールバック的に実行した処理をキャンセルしてしまうため、結果として、ALTER TABLE が実行されなかった事になったり、INSERT が実行されなかった事になったりしているのではないか？と思う次第です。 考えられる回避策としては、SQL 文を別々に作成し、個別に実行すれば良いだけの事なのですが、できれば、SQL 文一つにまとめたいと考えています。 どなたか、こういった現象に対する原因・理由の説明、或いは回避策など、何か情報をお持ちの方はいらっしゃいませんでしょうか？ 宜しくお願いします。
ビュー定義をプログラムで動的に扱う方法 SQLServer2008+VB6(ExcelVBA)構成のシステムで、日付フィールドを含むテーブルのビューを作成しておき、ＶＢプログラムからＳＱＬ文でビューを呼び出す時、日付範囲を指定して絞り込まれた結果をビューで返したいのですが、ストアドを使わずにビューだけで実現することはできないでしょうか？
SQLServer2000のselect文で select count(*) from Table を実行するのに３０秒以上かかってしまいます。 データ数は１００万件もありません。 全件数を取得するのになぜこんなにかかってしまうのでしょうか？ 主キーはVarcharの５０バイトです。 こんな単純な文でこれだけかかってしまうのは、 DBの設定が悪いのでしょうか？ それともPCの性能が悪いのでしょうか？
”パラメータ値を TextBox から String に変換できませんでした” のエラーメッセージ2日間調べても分かりません。何卒ご教示ください。 １・状況：VB画面のTextBoxの値をSQLのString型フィールドにパラメータ変数をSETしUPDATE 　　するのですが、上記メッセージが出力されます。 ●SQL文 　　UPDATE A22_kensyu SET 　　　　　cyumon_kin = @cyumon_kin, 途中略 nyukin_yotei_ymd = @nyukin_yotei_ymd,　-----(1) nyukin_kanryo_ymd = @nyukin_kanryo_ymd,-----(2) torihiki_cd = @torihiki_cd, torikeshi_kbn = @torikeshi_kbn 　　WHERE mitumorino = @mitumorino AND mitumori_eda = @mitumori_eda AND bunkatuno = @bunkatuno 　●パラメータセット Dim paraNyukinYoteiYmd As IDbDataParameter = command.CreateParameter() paraNyukinYoteiYmd.ParameterName = "nyukin_yotei_ymd" paraNyukinYoteiYmd.DbType = DbType.String If TxtNyukinYoteiYmd.Text = "" Then paraNyukinYoteiYmd.Value = DBNull.Value Else paraNyukinYoteiYmd.Value = TxtNyukinYoteiYmd End If command.Parameters.Add(CType(paraNyukinYoteiYmd, TeLib.CmnDataParameter).GetParameter()) 　　●VB６からVB2008を始めたばかりでまた、SQLのパラメータ変数を使用するのも初めてです。 　　●もともと動いていたプログラムを改造が必要になり(1)、(2)を付加しました 2.環境 OS：WindowsXp 言語：VB2008 DB：SQLserver2000
SQLServer2000でデータ数が10万くらいあるテーブルから、 OrderByやTopなどのSQL文を使用すると、 SELECTに数秒かかってしまいます。 該当のカラムを主キーにはできないですが、 インデックス化？みたいなことをして、 SELECTを短時間化できないでしょうか？
データベースシステムについて (1)データベース管理システムの役割 a データベースのデータの定義や検索・更新を行う。 b データベースのデータを分析して、たとえば顧客のニーズなどを探る。 c データベースのデータを不正なアクセスから守る。 d データベースのデータの重複や誤りなどをチェックする。 答え C ? (2)データベースシステムを導入することによって期待できる効果 a データの様々な分析手法を中に組み込むことができる。 b データの精度が向上する。 c データ項目が変更されても、プログラムの修正が最小にできる。 d データの転送が高速化できる。 答え C ? なんか、どれも正解のように思えるんですが 答えってCであってますか？ どなたか、詳しく解説できる方がいらっしゃいましたら、よろしくお願いいたします！
SQLServer2000で.NETからクエリを実行していますが、 実行したクエリ文と実行時間のログを取得したいのですが、 どのように取得したらいいのでしょうか？ EnterpriseManagerなどで簡単に取得できたらいいのですが。
SQLServerにおける、排他制御に関して質問です。 環境： 　ＳＱＬサーバ 　・Windows 2003 Server SP2 　・SQL Server 2005 Standard Edition SP3 　ＳＱＬクライアント 　・WindowsXP SP3 　・.NET Framework 3.5 SP1 VB.NET アプリ 　DBアクセサ 　・ADO.NETを利用 ---------------------------------------------------------------------- １．DBとのコネクションを確立 　　　　　　　・ 　　　　　　　・ 　　　　　　　・ ２．データベーストランザクションを開始（レベルはSerializable） ３．テーブルＡに対してINSERTを実行 　　（テーブルＡの主キーはオートインクリメント設定されている。） ４．３の結果、追加された主キーを取得するため、MAX()関数にて主キーの最大値（つまり、３で追加した行のはず）を取得 ５．テーブルＡを外部参照しているテーブルに対して、４で取得したテーブルＡのキーを利用して、行を追加・更新などを行う。 ６．コミットを行う。 　　（コネクションは、アプリケーションが終了するまで保持する・・・） ---------------------------------------------------------------------- この処理フローで実行していたシステムですが、 二つのクライアント（Ｘ，Ｙ）から、同時に２からの処理が行われた際に排他されず、 Ｘが、Ｙが作成したレコードの主キー値を元に、５の更新を行ってしまいました。 ログを見ると、 ２→成功 ３→成功（別のレコードが作成された） ４→ＸがＭＡＸ関数にて、Ｙが作成したレコードの主キーを取得 　　※処理そのものは成功しているが、論理的におかしい となっています。 論理的には、トランザクションをかけているので、３からの処理が同時に行われるはずはなく、 ４で取得される番号も、それぞれが作成した行の主キー番号になるはずなのですが・・・。 論理的に見落としている点や、環境的な要因などで、考えられる原因はありますでしょうか・・・？
ストアドから特定のキーワードを含むストアドを探したい 沢山のストアドの中から「union」を使っているストアドをだけを 検索する方法はありますか? (名称ではなく、ストアドの中身(コード)を検索したい)
学校でSQLについて学んでいます。とあるデータベースに関する問題なのですが 2 データベース又はデーターウェアハウスに蓄えられているデータを 分析する手法としてどのようなものがありますか？ 知っているものを一つあげ、実例を挙げて説明してください 蓄えられているデータを分析する手法というのが、皆目検討がつきません・・・>_< 普通にコンピュータを使う、ということじゃないですよね？ 済みませんが、何方か宜しくお願い致します
SQL文に関するとある問題について (3) 次の出庫記録の表に対して、以下のSQL文を実行したときに得られる値が 最も大きな数が得られるものは何ですか？ 該当する記号を書いてください。 --------------------------------------------------------------- 商品番号 数量 日付 PRT145420090610 DP255220090610 DP266320090611 PRT255220090611 a SELECT MAX(数量) FROM 出庫記録 b SELECT AVG(数量) FROM 出庫記録 WHERE 日付='20090610' c SELECT COUNT(*) FROM 出庫記録 d SELECT SUM(数量) FROM 出庫記録 WHERE 日付='20090611' ------------------------------------------------------------ この場合、それぞれの選択肢が出す数字は a=1 b=3 c=4 d=5 なので、正解はdでいいんでしょうか？ aのMAXって、最大なのはPRT145の数量4ですが、a=に4をいれるべきか、それともMAXなのはPRT145一つだけなので1にすべきか、まずそこで躓きました。 bのAVGは4+2=6なので、それの半分の3かな？ cはそのまんま4にして dはSUMなんで、3+2=5．にしちゃいましたが、間違ってるでしょうか？ 　 宜しくお願い致します。
SQL文について <と>の意味 とある問題で。 問(1) 次のSQL文によって、以下の学生名簿の表から抽出されるものはなんですか。 該当する記号を書いてください。 -------------------------------------------------------------------- SELECT 氏名 FROM 学生名簿 WHERE 学科='産業経営' AND 年齢>20 氏名 学科 年齢 上田 泰 経済 22 太田 裕子 公共金融経済 18 鍵谷 俊文 産業経営 19 佐藤 由理子 産業経営 21 山本 貞真 経済 20 a 上田 泰 b 鍵谷 俊文,佐藤 由理子 c 佐藤 由理子 d 上田 泰 e 上田 泰,佐藤 由理子 ---------------------------------------------------------------------- (2)： (1)の問題の学生名簿の表から、 下のSQL文を実行したときに得られる表を書いて下さい。 SELECT 氏名,学科 FROM 学生名簿 WHERE 年齢<20 ---------------------------------------------------------------------- それぞれに 1)年齢>20 2)年齢<20 と書いてありますが 1)の場合は、20歳以上という意味なのか、それとも「20歳」は含まず「21歳から」。 2)の場合は、20歳以下という意味なのか、それとも「20歳」は含まず「19歳から」。なのかが分かりません。 この場合だと(1)の答えはc 佐藤 由理子で合っているのでしょうか？ それと(2)の答えは 太田 裕子 公共金融経済 18 鍵谷 俊文 産業経営 19 山本 貞真 経済 20 と書き表せばいいのでしょうか？ 宜しくお願い致します。
SQLServer2005での復元の自動化について悩んでいます。 下記の構成でシステムを運用しています。 サーバー１(本番) OS:WindowsSvr2003R2 DB:SQLServer2005 サーバー２(障害用サブ) OS:WindowsSvr2003R2 DB:SQLServer2005 通常は本番用を使用してシステムの運用を行っているのですが、 H/Wの障害などが発生した際には、サーバー２で運用します。 ですので、システムが休止している際にサーバー１のDBをサーバー２ に移行する必要があります。 バッチやSPで自動的に行いたいのですが、何か良い方法はないでしょうか。 アドバイスをお願いします。
業務工程に入力業務があり、 入力ミスをなくすため入力後、内容を印刷し、 目視検査を実施しています。 が、入力ミス率が高いため、 ２次入力（２度打ち）工程を設けようと検討しております。 SQLで２度打ち機能を作成することはできるのでしょうか。 できるのであれば、具体的にどうすればよろしいでしょうか。 全くの初心者ですが宜しくお願いいたします。
SQLServerのselect文でデータ数１万くらいのDBから top n と order by つきで取得したときに、 １０秒以上かかってしまいます。 top n　だけや order byだけであれば、そんなにかかりませんが、 同時に扱う場合、なぜこんなに時間がかかってしまうのでしょうか？
お世話になります。 VB6.0、SQLServer2005WorkGroupEditionでアプリケーションを作成しております。 アプリケーションでログを出力しているのですが、ログ上で以下のエラーメッセージが出力されます。 ”DB OPENエラーこのログインで要求されたデータベース "****" を開けません。ログインに失敗しました。” この現象が起きる場合と、起きない場合が発生しており、原因が掴めずにいます。 SQLServerのログを調査しましたが、 06/11/2010 03:02:17,ログオン,不明,Login failed for user 'sa'. [クライアント: 192.168.2.10] 06/11/2010 03:02:17,ログオン,不明,エラー: 18456、重大度: 14、状態: 16。 のメッセージが出力されておりますが、原因がつかめない状態です。 何か調査の方法はございますでしょうか。 お手数ですが、ご教授いただきたく宜しくお願い申し上げます。
SQLで日付を条件に削除したい update の列にdatetime　型で更新日が入っています。 2010年の６月以降を削除したいのですが どうにもうまくいきません。（一応以下のようなことをやってみたりしました） どのように書いたらいいでしょうか？？ DELETE FROM SYS WHERE update >#2010/06#
SQLで特定の文字を含むものを削除 パソコン初心者です。 SQLでデータベースからたとえば（’）シングルコートを 含むもののみ削除することはできますか？
SQL Server を使っています。SQLの質問です。 得意先テーブルと商品テーブルと売上明細テーブルがあります。 一つの商品に関して得意先ごとに最新の売上明細データの一覧を作成したいと考えて います。 ■売上明細データ 明細ID　（meisai_id） 得意先ID　(tokuisaki_id） 商品ID　　(syohin_id） 売上金額（uriage_kingaku） 売上日　（uriage_date） ■売上明細データ(table_uri_maisai) meisai_id　tokuisaki_id　syohin_id　uriage_kingaku　uriage_date ================================================================= 　　1　　　　　aaa　　　　　001　　　　　100　　　　　2010/01/01 　　2　　　　　aaa　　　　　002　　　　　200　　　　　2010/01/01 　　3　　　　　bbb　　　　　001　　　　　105　　　　　2010/01/02 　　4　　　　　bbb　　　　　002　　　　　205　　　　　2010/01/02 　　5　　　　　ccc　　　　　001　　　　　110　　　　　2010/01/03 　　6　　　　　ccc　　　　　002　　　　　210　　　　　2010/01/03 　　7　　　　　aaa　　　　　001　　　　　100　　　　　2010/01/04 　　8　　　　　aaa　　　　　002　　　　　200　　　　　2010/01/04 　　9　　　　　bbb　　　　　001　　　　　105　　　　　2010/01/05 　　10　　　　　bbb　　　　　002　　　　　205　　　　　2010/01/05 　　11　　　　　ccc　　　　　001　　　　　110　　　　　2010/01/06 　　12　　　　　ccc　　　　　002　　　　　210　　　　　2010/01/06 上のような明細があり、「syohin_id」が「001」のデータに関して、 得意先ごとの最新のデータだけを抽出したいと考えています。 この場合ですと、以下の３件のデータが抽出できればよいわけです。 　　7　　　　　aaa　　　　　001　　　　　100　　　　　2010/01/04 　　9　　　　　bbb　　　　　001　　　　　105　　　　　2010/01/05 　　11　　　　　ccc　　　　　001　　　　　110　　　　　2010/01/06 tokuisaki_id と syohin_id の２つを特定して１件のデータを抽出するには 以下のSQLで実現できましたが、syohin_id だけを指定して複数のデータを 出すことがどうしてもできません。 SELECT * FROM table_uri_meisai WHERE uriage_date = (select max(uriage_date) FROM table_uri_meisai WHERE tokuisaki_id = 1 AND syohin_id = 1) AND tokuisaki_id = 1 AND syohin_id = 1 どなたかご指導ください。 よろしくお願いします。
SQLServer2008StandardEditionを利用しています。 データバックアップリストアについて教えてください。 TableAに商品管理情報を日次で追加しています。 TableAを含むデータベースを深夜に日次でフルバックアップを取得しています。 ある日、管理者が間違えてTableAのレコードのうち１行を削除してしまいました。 この時に、現状では、TableAのレコードを復元するには以下の方法を利用しています。 １．データベースフルバックアップデータを別名でリストアする ２．リストアデータベースから削除したTableAのレコードを手動でコピーする。 ３．リストアしたデータベースを削除する。 もう少し簡単に削除した行だけをリストアするような方法は無いでしょうか？
'（シングルクォーテーション）の検索 SQL Server 2005 Express Edition を使っています。 '（シングルクォーテーション）を含む文字列を検索したいのですが できずに困っています。 どのようなクエリを組むべきでしょうか？　教えてください。 よろしくお願いします。 現在は select * from テーブル名 where 列名 like '%\'%' としていますがエラーになります。
SQL Server2005のクエリで「今週のデータ」を抽出したいのですがうまく出来ません。 between datename (weekday, getdate()) on datename(weekday, getdate() +6 ) 「今週の」という条件は、本日の日付から週始めの月曜日を算出して、その値にプラス6をした日曜日までのデータを取得、という感じで行いたいのですが、 肝心の月曜日の求め方が分かりません。 参考書やネットを調べても分からなかったため、この場をお借りして質問させていただきました。 何卒ご教授お願いいたします。
【SQL Server 2005】データベース・ミラーリング ■質問１ 監視サーバ、プリンシパルサーバ、ミラーサーバの三台構成で、 プリンシパルサーバがどういう状態になったら、ミラーサーバに処理を引き継ぐのですか？ ハートビート監視でしょうか？それともインスタンスの状態を監視している？ ■質問２ 監視サーバ、プリンシパルサーバ、ミラーサーバの三台構成で、 プリンシパルサーバとミラーサーバに、それぞれIIS上で動作する同一の動的Webサイトを作成し、 NLBで負荷分散することはできますか？
batからOSQLを起動してデータを落としたのですが・・・ 出力されたTXTデータのスペース箇所（SELECTで引き抜いた時にはそう見えていました。）にNULLという文字が入っています。 単純にテーブルのその項目にNULLが入っているという事は分かるのですが・・・ 今回の質問はそのNULLと言う文字をスペースに置き換えてTXT出力する方法を教えて欲しいです。 BATで置換を提案したのですが、処理に時間がかかりすぎるという事で却下されました。 OSQLをBATから起動する時にパラメータを使ってそういう事が出来るのか、 SQL発行する記述にUPDATE文を付ければいいのかどうやれば良いのかが分かりませんので 是非ともご教授宜しくお願い致します。
SQL2005 INSERTの質問なのですが、 顧客マスタより、年代別の人数を集計するINSERTを教えてください。 顧客マスタ．．．顧客コード、顧客名、年齢(15、25、35などの年齢が入っています。） 年代別人数．．．10代、20代、30代←（年代別にレコード件数を集計） INSERT INTO 年代別人数(10代,20代,30代) SELECT ？ FROM 顧客マスタ SELECT でCASE WHEN等でやるのかと思いますが、よくわかりません。 一度のINSERTで集計できる方法を教えてください。 宜しくお願いします。
Sqlserver2005でテーブルを作成してい分からなかったので質問します。 [テーブルＡ] 　{フィールド１}主キー 　　(データ1000) 　　(データ1001) 　　(データ1002) これを親とするテーブルＢを作成して [テーブルＢ] 　{フィールド1}主キー{フィールド2}主キー 　(データ1000）　　　(データ1001） 　(データ1001）　　　(データ1002） 　(データ1002）　　　(データ1003） [テーブルB]の｛フィールド１と２｝を[テーブルA]の {フィールド１}にリーレーションを張って [テーブルＡ]の{フィールド１}のデータが消した時に[テーブルＢ]の｛フィールド１，２｝ のデータ、どちらかに該当するデータがあった場合に行ごと削除したいので ｛フィールド１，２｝のリレーションシップの設定の「DeleteRule」を2つとも「重ねて表示」としたいのですが 「パスが循環するか、複数のパスに連鎖する可能性があります。ON DELETE NO ACTION、ON UPDATE NO ACTION、を指定するか、他の FOREIGN KEY 制約を変更してください。 制約を作成できませんでした。以前のエラーを調べてください。」 と表示されて出来ませんこの場合フィールド１，２どちらか1つのフィールドしか DeleteRule「重ねて表示」に設定できないのでしょうか？ こういう風に分岐する道筋を明記するテーブルを作りたいのですが １━┳２ 　　 ┗３　　 自分の作ったテーブルの構造が良くないかもしれないので上に書いてあるような テーブルでは駄目だという方もどういったテーブル構造が良いのか教えて欲しいです
ご教授お願い致します。 MicrosoftSQL2008で テーブルに在庫データと受払データの２種類があります。 在庫データは受払データを１行にまとめた情報で 年月で管理しています。 また、受払データはその詳細で年月日で管理しています。 質問は、この二つのテーブルをビューで１つに結合したいのですが 結合に在庫データの年月と受払データの年月日だと特定の日付のみしか 結合されません。 よって、方法を教えて頂ければ幸いです。 尚、例を下に記述します。 ■在庫データ 年月　　　　品番　入庫数　出庫数 2010/06/01　A 　　3 　　　1 2010/07/01 A 0 1 ■受払データ 伝票No.　日付　 品番　入出庫区分　数量 1 2010/06/02 A 入庫　　　　1 2 2010/06/03 A 入庫　　　　2 3 2010/06/04 A 出庫　　　　1 4 2010/07/02 A 出庫　　　　1　　 　結合は在庫データの2010/06/01だと受払データの 　伝票No.が１から3まで 　2010/07/01だと伝票No.4です。
ODBC SQLサーバーでSQLを実行したい・・・ 昨日から入り浸っている初心者PGです。 昨日は、実行日から直近の金曜日の日付を抽出するというSQLを質問させて頂きました。 今回は前月の月初第一金曜日に当たる日付を出力するSQLについての質問となります。 下記のSQLは先輩が作成したSQLになります。 もっと簡単に書けないか悩んでいます。 補足として日付は8桁で出力をしたいです。（例：20100507） 宜しければご教授賜りたいです。（原文そのままコピーしてますｗ） /* いけてるｓｑｌ */ SELECT case (6 - (datepart(Dw,cast(datename(year,dateadd(mm, -1, getdate())) + '-' + datename(month,dateadd(mm, -1, getdate())) + '-' + '01' as datetime)))) when '-1' then datename(year,cast(datename(year,dateadd(mm, -1, getdate())) + '-' + datename(month,dateadd(mm, -1, getdate())) + '-' + '01' as datetime) + 6) + datename(month,cast(datename(year,dateadd(mm, -1, getdate())) + '-' + datename(month,dateadd(mm, -1, getdate())) + '-' + '01' as datetime) + 6) + RIGHT('00'+CONVERT(varchar,datename(day,cast(datename(year,dateadd(mm, -1, getdate())) + '-' + datename(month,dateadd(mm, -1, getdate())) + '-' + '01' as datetime) + 6) ),2) else datename(year,cast(datename(year,dateadd(mm, -1, getdate())) + '-' + datename(month,dateadd(mm, -1, getdate())) + '-' + '01' as datetime) + (6 - (datepart(Dw,cast(datename(year,dateadd(mm, -1, getdate())) + '-' + datename(month,dateadd(mm, -1, getdate())) + '-' + '01' as datetime))))) + datename(month,cast(datename(year,dateadd(mm, -1, getdate())) + '-' + datename(month,dateadd(mm, -1, getdate())) + '-' + '01' as datetime) + (6 - (datepart(Dw,cast(datename(year,dateadd(mm, -1, getdate())) + '-' + datename(month,dateadd(mm, -1, getdate())) + '-' + '01' as datetime))))) + RIGHT('00'+CONVERT(varchar,datename(day,cast(datename(year,dateadd(mm, -1, getdate())) + '-' + datename(month,dateadd(mm, -1, getdate())) + '-' + '01' as datetime) + (6 - (datepart(Dw,cast(datename(year,dateadd(mm, -1, getdate())) + '-' + datename(month,dateadd(mm, -1, getdate())) + '-' + '01' as datetime))))) ),2) end
ODBC SQLサーバーでSQLを使いたい・・・ SET NOCOUNT ON DECLARE @EDATE DATETIME DECLARE @CUNT INT SET @COUNT = 0 WHILE ( @I <> -7 ) BEGIN IF ( DATANAME( WEEKDAY, DATEADD( DD, -1, GETDATE()))) = "金曜" BREAK ELSE SELECT @CUNT = @CUNT + 1 END SET @EDATE = CONVERT( CHAR, CONVERT( VARCHAR, DATEADD(DD, @COUNT, GETDATE()), 112) SELECT @EDATE 実行日からさかのぼり、金曜日の日付を表示したいSQLを作成しています。 なぜか"金曜"がおかしいとエラーが出てしまいます。 どなたかわかる方いましたらご教授お願い致します。
ODBC SQL ServerでSQLを発行したいのですが・・・ IDがそのまま表示されてしまっていたので、再度登録しなおしました＞＜ ・実行SQL DECLARE @DATE DATETIME DECLARE @STARTDATE DATETIME SET @DATE = GETDATE() SET @STARTDATE = DATEADD(DAY,-7,@DATE) SELECT * FROM teble WHERE 配達開始日 >= @DATE AND 配達開始日 <= @STARTDATE 上記のようなSQLを発行しデータを取得したいのですが、実行結果に表示がされません。 どうしていいかわからず困っています。 頭のDECLARE文しか動いていないのではないんだろうかと思っています。 実行ツールはCommon SQL Envieron mentを使用しています。
sql2005 UPDATEの質問なのですが、先日jamshid6さんに 顧客毎の累計金額を顧客マスタへupdateの方法を教えて もらったのですが、期間の日付がnullの場合が発生すること があり、nullの場合は、全データ対象となる書き方を教えて 下さい。 (1) update 顧客マスタ set 累計金額=B.累計金額 from 顧客マスタ as A inner join (select 顧客コード,sum(売上金額) as 累計金額 from 売上データ where 売上日付 between '2010/03/01' and '2010/06/30' group by 顧客コード) as B on A.顧客コード=B.顧客コード (2) あと、顧客マスタには、生年月日があり、本日日付より年齢を求めて 顧客マスタの年齢にupdateすることは可能ですか? これも、生年月日がnullの時もあるので、その場合は、年齢を０にした いと思います。 顧客マスタ．．．顧客コード、生年月日(datetime)、年齢(int) 宜しくお願いします。
ACCESS2007のRuntimeを使用して社内アプリを展開したい。 現在ACCESS2003を使用し、会社内サーバー上のデータの抽出や集計を行うためのクエリや レポートを作成し、それらをフォームに登録し自分用のメニューを使用しています。 ACCESS2007は以前有償であったDeveloper ExtensionsやRuntimeが無償で手に入れる事が できるとの情報を得たので、ぜひ試してみたいと思っています。 ACCESS2003で設定しているテーブルは2通りあり、1つは社内SQLサーバーにリンクしている もの、もう1つはACCESS2003で作成した固有のテーブルです。 現在使用しているフォームを社内アプリとしてRuntimeやDeveloper Extensionsを使用して 社内アプリとして配布する事は可能でしょうか？ 何度か試してはいるのですが、Runtimeではメニューも何も表示されません。どこか間違いが あると思うのですが、初心者にほぼ近い私では何が悪いのかよくわかりません。 どうか、ご指導の程、よろしくお願い致します。
SQL2005　ストアドUPDATEについて教えてください。 顧客マスタと、売上データがあり、顧客毎の売上データの売上金額の合計を 顧客マスタの累計金額にUPDATEする方法を教えてください。 顧客マスタ・・顧客コード、累計金額 売上データ・・売上日、顧客コード、売上金額 update 顧客マスタ set 累計金額=(select sum(B.売上金額) from 売データ as B where 売上日付>='2010/03/01' and 売上日付<='2010/06/30' group by B.顧客コード) from 顧客マスタ as A,売上データ as B where A.顧客コード=B.顧客コード サブクエリは複数の値を返しました。サブクエリが =、!=、<、<=、>、>= の後に続く場合や のエラーが出たり、期間中のすべての顧客の売上合計がセットされたり思うようになりません。 どなたか教えてください。 宜しくお願いします。
こんにちは。 最近、社内システムの運用を担当することとなりました。 サーバに保存しているでデータのバックアップについて1点お聞きしたいことがあります。 社内で勘定奉行IVを利用しています。 サーバ内に保存されているデータのバックアップをしたいのですが 「ほかの人またはプログラムによって使用されています」と表示されてしまい、コピーすることが出来ません。 サービスを停止すればコピーできるかと思ったのですが肝心のサービス名が不明でした。。。 下記に構成を記載しておきますのでご存知の方がいらっしゃいましたらご教授ください。 【構成】 WindowsServer2003 MicrosoftSQL　2003 勘定奉行LANPAKC（勘定奉行IV） 保存したいフォルダ：D:\OBCWIN\OBCZLMS5\DATA ファイルの拡張子：*.ldf、*.mdf バックアップを取る目的 batファイルを作成してタスクスケジューラでサーバ内のデータを自動保存したいです。 バックアップ奉行は購入していません。 ※低予算で実施したいので。。。 【補足】 個人的にはファイルを使用しているSQLサービスを停止後、コピーすればバックアップ可能だと 思ったのですがどのサービスを停止すればよいのか不明でした。。。 尚、SQLのサービスは下記のものがあります。 ※念のため、停止してコピーしましたが変化なしでした SQL Server(OBCINSTANCE2) SQL Server Browser SQL Server FullText Search(OBCINSTANCE2) SQL Server Integration Services 以上、よろしくお願いいたします。
SQL SERVER 2005 にて全テーブルの文字列を置換する方法を探しています。 ものすごく基礎的なことでしたら申し訳ございません。 SQL SERVER 2005で作成したDBがあるのですが、この中の全てのテーブル内を検索し、 「ＡＡＡ」という文字列を「ＢＢＢ」に置換したいと考えています。 上記は例えですが、とにかく全てのテーブル内の全ての文字列を検索し、置換できる方法は無いでしょうか。 どうかご教示のほど、よろしくお願いいたします。
.sdfファイル自体の作成方法 SQLSERVER2008 にて、Compact Edition用の.sdfファイル自体の作成をしたいのですが、.sdfファイルへのデータの書き込みはどのようにしたらいいのでしょうか？10台分(10種類）のSDFファイルを夜間にサーバで作って、日中それを配布するみたいなことをしたいと思ってます。
SQL Server 2000 を使用しています。 土日を除いた日数を取得したいと思っていますがわからなくて困っています。 ご助言ください。 あるテーブル（T_Test）に日付列が2つあります。 code｜dateA　　 ｜dateB ──┼─────┼────── 1　 ｜2010-05-10｜2010-05-14 2　 ｜2010-05-14｜2010-05-17 3　 ｜2010-05-10｜2010-05-28 ここから code｜dateA　　 ｜dateB　　 ｜日数 ──┼─────┼─────┼── 1　 ｜2010-05-10｜2010-05-14｜4 2　 ｜2010-05-14｜2010-05-17｜1 3　 ｜2010-05-10｜2010-05-28｜10 というように土日を除いた datediff のような値を取得したいのです。 datediff で日数を取得でき、datepart で曜日を取得することができるようには なったのですが、土日を除いた日数を取得（もしくは期間内の土日の日数でも可）を 取得する方法がわかりません。 どうぞ宜しくお願いいたします。
SQLサーバー2005とVisual Studio 2008 Express Edition を使用して、データベースにアクセスしたいのですが、Visual Studioで新しい項目の追加→「サービス ベースのデータ アクセス用の空の SQL Server データベース」→追加として、Database1.mdfを新規作成しようとすると、以下のエラーが出てしまいます。 エラー:ファイルまたはアセンブリ 'Microsoft.SqlServer.Management.Sdk.Sfc, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91'、またはその依存関係の 1 つが読み込めませんでした。指定されたファイルが見つかりません。 解決方法が分からなくて困っております。ご存知の方、お手数ですがご指導いただけないでしょうか。 よろしくお願い致します。 <環境> Os: Win Xp SQLサーバー2005 Visual Studio 2008 Express Edition
SQL Server2008 テーブルの権限について質問です。 現在SQL Server 2000 から2008へ移行を検討しています。事前にExpressEdithionをインストールしていろいろ確認していますが、判らない点がありますのでお教え下さい。 問題はユーザー別にテーブルの権限を変えたいのですが、2008のManagementStdioを見てもそのように設定する手段が見つかりません。 user1は、全てのテーブルのread/writeが可能。 user2は、1部のテーブルはread/writeのみ可能、1部はreadのみ、他のテーブルはread/writeとも不可。 user3は、1部のテーブルのreadのみ可能、他のテーブルはread/writeとも不可。 このように設定をManagementStdioで行う方法はないのでしょうか？ 以上、よろしくお願いします。
SQLServer ストアド レスポンス いつもお世話になります。 約100万件のテーブルから20行程度抽出するストアドがあります。 問合せ画面で使用していますが、通常は問題なくサクサク動くのですが、突然遅くなる時があります。 インデックスは付いてます。 そんな時、クエリアナライザで、直接ストアドを起動した後、再度画面から問い合わせると通常のスピードに戻ります。 ストアド直接起動時も最初は遅く、2回目以降は通常スピードです。 偶然なのかどうか調査中ですが、どなたかこんな経験＆対処された方おりましたら、ご教授頂けないでしょうか。 SQLServer2000＋VB.NETで開発してます。
SQL server 2008 management studio でテーブル内を1000件以上表示させ、編集したい。 いつもお世話になっております。 今回、DBにSQL server 2008を使用しており、 DBの中身を、management studioで確認しておりました。 テーブル内のデータが1000件以上になり、 1000件以上のデータを表示したくても、 できません・・・。 management studioでは1000件以上のデータ表示はできないのでしょうか？ management studioでの1000件以上の表示方法、 もしくは、それ以外の初心者でも使えるツールで、 1000件以上のデータの表示と編集・削除ができる方法を、 教えていただけましたら幸いです。 すみませんが、よろしくお願いいたします。
SQLサーバの使い方について。 起動させた際に、Windows認証やSQLサーバ認証などが出てくるのはなぜでしょうか。 また、上手く起動した後にも細かな設定などがあり、どのように使用していくのかがいまいち分かりませんでした。まずは、簡単な正規化などから取り組んでみたいのですが・・・。 単に、データベースを用いるだけならばACCESSなどでも可能でしょうが、会社側からはSQLサーバを使用して欲しいと言われています。 SQLサーバを使用されている方がいましたらお願い致します。
VBとsql serverを使ってデータベースを操作したいと思って、 sql server management studioをインストールしたんですが、 Accessと違って何が何やら分からず、テーブルの作成すらできません。 最初に登録済みサーバを見ると、 自分のコンピュータ名\sqlexpless という名前のサーバらしきものがあり、 こんなサーバ作った覚えないぞ、デフォルトで作られるのかな？ と思って右クリックから削除したんですが、 そのあと「オブジェクトエクスプローラを接続」を選択すると、さっきの名前のサーバが入力されてて、 接続を押したらなぜか復活していました。 意味が分からなかったので削除は諦め、新しくサーバを作ろうと「新規サーバの登録」から、適当に名前をつけてテストボタンを押したんですが、画像のようなエラーが出てきました。 見ても解決できなかったので諦めて、最初もともとあったサーバを使って新しくデータベースを作成しようとすると今度は、 CREATE DATABASE 権限が拒否された とのエラーが発生します。もう何もできなくなってしまいました。 お時間がよろしければ、インストールした直後からオリジナルのサーバとデータベースを作成して、テーブルの作成あたりまでを解説していただけないでしょうか。
SQL Server Management studioで 新しくデータベース(MyDatabase)、テーブル(NameTable)を作成してみたんですが、 Visual Web developer 2010 Express のデータベースエクスプローラから MyDatabase.mdfを開こうとしても「このファイルは使用されています。…」 というような文言が出てきて、呼び出せません。 Vista,SQL Server 2008,Visual Web developer 2010 Expressの環境です。 どなたか教えて下さい。
SQLserver2005より、SQLにて各データベースのプロパティにあるサイズと使用可能領域の値を取得したいのですが、そのようなSQLはありますでしょうか。
SQL serverの１つのデータベース内にある全てのテーブルを一気にcsv化したいと思っています。 が、テーブルを1個ずつcsv化する方法しか見つからず、困っています。 テーブルの数が100ほどあるので、できれば一気に行いたいのです。 ※見つけた方法 （１）SQL Server Enterprise Maganerで、データベースを右クリック→「すべてのタスク」の「エクスポート」→変換対象にFlat Fileを選ぶ これだとテーブル1個ずつしか変換できません。 （２）bcpコマンドを使う こちらもテーブル名を指定していますので、やはりテーブル1個ずつしか変換できません。 何かいい方法はないでしょうか。 あるいは、上記の方法を少し変えることで一気に変換できるのでしょうか。
SQLServer 2008のインスタンス間DBコピーの方法を探しています。 インスタンス１とインスタンス２に同じテーブル構造（名称も同じ）のDBを用意しています。 インスタンス１のDB（以下、DB1）をインスタンス２のDB（以下、DB2）に コピーする方法を模索しています。 SQLServerのバージョンは2008で、Standardです。 できればDB1を止めることなく、DB2にコピーできるよう考えています。 ご存じの情報がありましたら、教えていただければと思います。 よろしくお願いします。
ＳＱＬで以下のような構文でコンパイルエラーがでます。 QSQL = QSQL & ",TMTNM,TO_CHAR(TMSPC,'000') AS TMSPC,HMHNM" ＴＭＳＰＣというフィールドを数値から文字へ変えたいのですが、 ＴＯ＿ＣＨＡＲの引数が正しくないとでます。 どこが間違っているか教えていただけますでしょうか？ ＴＯ＿ＣＨＡＲ（ＴＭＳＰＣ、’０００’）にしても、 ＡＳ　ＴＭＳＰＣをつけなくてもダメでした。
MSDE2000のパフォーマンス低下 MSDE2000を使ったシステムがあるのですが、２，３ヶ月すると、目に見えてパフォーマンスが低下してしまいます。サービスを再起動すると、元のパーフォーマンスに戻るのですが、何か対処はあるのでしょうか？それとも、MSDE2000が開発用という事で、再起動するしかないのでしょうか？ 環境 ・２４時間連続稼動 ・４クライアントから読み書きしています。 ・OSは、MSDE2000がインストールされているPCも含め、５台ともWindows2000Server ・ソフトウェアの開発言語は、Visual C++6.0 こうしたら、という対処がありましたら、助言をお願いします。 以上、よろしくお願いします。
多くの選択項目を処理(SELECT)するストアド とあるデータ検索において、選択項目が10項目以上あり各項目の値をパラメータとして受取り、 該当データを返すストアドを検討しています。 項目が省略された場合は　Null値がパラメータとして入ってきて、その項目は条件から除外します。 （全ての項目が省略されたら、全てのレコードが返される）下記の様な方法を考えています・・・ ----------------------------------------------------------------- if @para1 is null 　if @para2 is null 　　if @para3 is null 　　　select * from TBL 　　else 　　　select * from TBL where koumoku3 = @para3 　else 　　if @para3 is null 　　　select * from TBL where koumoku2 = @para2 　　else 　　　select * from TBL where koumoku2 = @para2 and koumoku3 = @para3 else 　if @para2 is null 　　if @para3 is null 　　　select * from TBL where koumoku1 = @para1 　　else 　　　select * from TBL where koumoku1 = @para1 and koumoku3 = @para3 　else 　　if @para3 is null 　　　select * from TBL where koumoku1 = @para1 and koumoku2 = @para2 　　else 　　　select * from TBL where koumoku1 = @para1 and koumoku2 = @para2 and koumoku3 = @para3 ------------------------------------------------------ 三つでも面倒なのに10項目以上では考えられません。 こんな時どのように作り込めばいいのでしょうか 動的ストアドにして where文自体を編集した物を渡す事も考えましたが、 エクセル出力時のパラメーター長の制限(?)で断念しました。 省略されなかった項目だけでデータを選択したいような事は多々あると思うのですが、 そんな時のオーソドックスは方法はどんな方法なんでしょうか? よろしくお願いします。
システムデータベースについての質問です。 msdbデータベースの「ms」というのは何の略でしょうか？ 他のシステムデータベースについては、何となくわかるのですが。 わかる方、よろしくお願いします。
SQLで二つのデータベースをUNIONでつないだあとに異なる入力形式のフィールドでソートをかけたいのですが。 AのデータベースではNOが文字列で"001","002","003"...で、 Bの方ではNOが文字列で" 01"," 02"," 03"...と左１ケタ目がブランクとなっています。 これを"001"," 01","002"," 02"...というふうに下2けたのみでソートをかけたいのですが、 普通にORDER BYするとBを読んだあとにAがきてしまいます。 SUBSTRINGはUNIONでは使えなかったのですが、何かよい方法教えていただけませんでしょうか？
階層データのあるテーブルで親から最下層の子までのパスを列挙するクエリ すでに存在するシステムより親子関係のデータが自動的に作成されるのですが、 それをSQLクエリで並び替えることに苦労しています。 やりたいこと： 最上位の親から最下層の子までのパスを列挙するクエリを作成したい。 テーブル構造： 直属の親と子を１レコードで保存しています。 (ID=０は最上位の為、１が最上位の親) TableName：Department ID　ParentID　ChildID　Order　ChildName --　--------　-------　-----　--------- 0　　　　0　　　　1　　　1　　　xx 1　　　　0　　　　2　　　1　　　aa 2　　　　1　　　　3　　　1　　　bb 3　　　　1　　　　4　　　2　　　cc 4　　　　2　　　　5　　　1　　　dd 5　　　　2　　　　6　　　2　　　ee 6　　　　3　　　　7　　　1　　　ff 7　　　　3　　　　8　　　2　　　gg 8　　　　6　　　　9　　　1　　　hh 9　　　　6　　　　10　　　2　　　ii 10　　　　8　　　　11　　　1　　　jj クエリで以下のように表示したい。 Level1　Level2　Level3　Level4　Level5　NodeName ------　------　------　------　------　-------- 　　1　　　　　　　　　　　　　　　　　　　xx 　　1　　　　3　　　　　　　　　　　　　　bb 　　1　　　　4　　　　　　　　　　　　　　cc 　　1　　　　3　　　　7　　　　　　　　　　ff 　　1　　　　3　　　　8　　　　　　　　　　gg 　　1　　　　3　　　　11　　　　　　　　　jj 　　2　　　　　　　　　　　　　　　　　　aa 　　2　　　　5　　　　　　　　　　　　　　dd 　　2　　　　6　　　　　　　　　　　　　　ee 　　2　　　　6　　　　9　　　　　　　　　　hh 　　2　　　　6　　　　10　　　　　　　　　ii 私が試したSQLクエリは以下となります。 select lev3.Level1,lev3.Level2,Level3,Level4,Node5.ChildID as Level5,ChildName from Department as Node5 Right Join(select lev2.Level1,lev2.Level2,lev2.Level3,Node4.ChildID as Level4,ChildName from Department as Node4 Right Join(select level.Level1, level.Level2,Node3.ChildID as Level3,ChildName from Department as Node3 Right Join(select Node1.ChildID as Level1,Node2.ChildID as Level2,ChildName from Department as Node2 Right Join(select ChildID,NodeName.ChildName from Department as Node0 inner Join tbDepartment as NodeName on Node0.ChildID=NodeName.ID Right Join(select ChildID as N0 from Department where ParentID=0) as Node00 on Node00.N0=Node0.ParentID) as Node1 on Node1.ChildID=Node2.ParentID) as level on level.N2=Node3.ParentID) as lev2 on lev2.N3=Node4.ParentID) as lev3 on lev3.N4=Node5.ParentID これだと、パスの列挙はできるのですが、名前が最上位の親だけしかわからず、 あたまが混乱しています。 有効な列挙方法を教えてください。 よろしくお願いします。
SQLServer2000からSQLServer2005へのデータ移行方法 Microsoft SQL Server ManagementStadio Expressで SQLServer2000のバックアップファイルから、 ローカルの開発環境(SQL Server2005 Express)でデータベースを復元しようと試みましたところ、 復元が正常に出来ませんでした。 復元はエラーが発生せず完了しデータベースは作成されているのですが、 データベースを右クリックで削除やプロパティを見ることもできず、 どのようなテーブルが存在するのか中身の参照も追加も何もできない状態です。 http://qanda.rakuten.ne.jp/qa4183273.html 上記URLなどでSQL Server2000のバックアップから2005で復元しているような発言がされているので 可能だと思うのですが、何か特別な処理が必要なのでしょうか？ ご存じのかた、教えていただけますようお願いいたします。
1テーブル＆複数レコードの更新に対して1度のupdate文での処理方法 Delphi2010+SQL SERVER 2005で開発しています。 update文で、 現在下のようにwhileで複数レコードに対して、 1回、1回、sqlを発行して、更新しています。 これを、一度のSQLの発行で処理できないものでしょうか？ 更新テーブルは1つで、更新する項目も同じです。 更新するデータと、where句の条件が異なります。 もし可能なようでしたら、どうかご教授お願いします。 update table set A=1,B=2 where id=1 update table set A=2,B=3 where id=5 update table set A=9,B=99 where id=7 update table set A=5,B=10 where id=15 update table set A=1,B=10 where id=75
初めまして。 Windows環境にて、IIS、ASP、MSSQLにてシステム構築をしていますが、たまにIISエラーにて [Microsoft][ODBC SQL Server Driver][TCP/IP Sockets]一般的なネットワーク エラーです。 と出てきます。 毎回決まった処理でエラーとなる訳ではなく、不定期に発生している状態です。 もし問題解決の糸口を頂けたら幸いです。
sql2005ストアド計算式で金額1*数量1,金額2*数量2などの時に、金額・数量の後ろを変数にして繰り返し処理する方法を教えてください。
あるテーブルに対して、任意の日付を指定して、その日付より以前の 最新日付のデータのみを取得したいと考えているのですが、 可能でしょうか？ どなたかご存知の方、ご教授願います。 （例）テーブル 登録日付　　　Data1　　Data2 2008/12/01 ねこ　　哺乳類　　 2008/12/03　　たぬき　哺乳類 2008/12/05　　きつね　哺乳類 2008/12/05　　くじら　哺乳類 2008/12/09　　たこ　　軟体動物 2008/12/10　　いか　　軟体動物 2008/12/10　　まぐろ　魚類 2008/12/12　　いぬ　　哺乳類 というテーブルにおいて日付を2008/12/08と指定した場合 それ以前の最新日付のデータとして 2008/12/05　きつね　哺乳類 2008/12/05　くじら　哺乳類 が取得できるようにしたいと思っています。 どなたか、ご教示お願いいたします。
Windows7でSQLServer2005 Windows7でSQLServer2005 Standerdはインストール及び正常動作しますか？ また、その記事が載っているサイトはありますか？ よろしくお願い致します。
windows7 にSQL SerVer 2008 Express インストールしようとしています。 ３種類のダウンロードボタンがあるのですが、どれを選択してよいがわかりません。 違いを教えていただけないでしょうか？ (1)　SQLEXPR_x64_JPN.exe (2)　SQLEXPR_x86_JPN.exe (3)　SQLEXPR32_x86_JPN.exe
SELCTを使って違うテーブルのデータを２度使って表示させたいのですが どのようにしたらいいのか教えてください。 ---------------------- ■テーブルの構成 ・FoodList NO(主キー) Food ・MyList NO(主キー) fist second ---------------------- ■テーブルの内容 ・FoodList NOFood 1りんご 2みかん 3ぶどう ・MyList NOfistsecond 123 212 321 ---------------------- これで 1みかんぶどう 2りんごみかん 3みかんりんご というように表示させたいのですが どのようにしたらいいのでしょうか？ --------------------------------------------------------- SELECTMyLike.NO AS Expr1,FoodList.food,MyLike.Second FROMFoodList INNER JOIN MyLike ON FoodList.NO = MyLike.first --------------------------------------------------------- とすると 1みかん3 2りんご2 3みかん1 となってしまいますし --------------------------------------------------------- SELECTMyLike.NO AS Expr1,FoodList.food,MyLike.Second FROMFoodList INNER JOIN MyLike ON FoodList.NO = MyLike.first AND FoodList.NO=MyLike.Second --------------------------------------------------------- とすると表示されないですし どのようにしたら実現できるでしょうか？ 教えてください。よろしくお願いします。
SQLServer2005にてVIEWを作成したいのですが、どの様に結合して良いのか分からないので教えて下さい。 下記「テーブルに登録されているデータ」で登録されているデータを下記「この様にVIEWで表示したい」の様にVIEWで出力する事は出来ますでしょうか？ 出来るのであれば、結合方法の詳細かSQL文を教えて頂きたいと思います。 各SubNoは1～5と決まっています。 5に満たない場合は残りの項目はNULLとしたいです。 ▽テーブル詳細 MainNo Numeric(6,0) SubNo Numeric(1,0) Name Nvarchar(20) ▽テーブルに登録されているデータ MainNo, SubNo, Name 1, 1, 'TEST-A' 1, 2, 'TEST-B' 1, 3, 'TEST-C' 2, 1, 'CLASS-A' 2, 2, 'CLASS-B' 3, 1, 'OBJECT-A' 3, 2, 'OBJECT-B' 3, 3, 'OBJECT-C' 3, 4, 'OBJECT-D' 3, 5, 'OBJECT-E' ▽この様にVIEWで表示したい MainNo, SubNo1, Name1, SubNo2, Name2, SubNo3, Name3, SubNo4, Name4, SubNo5, Name5 1, 1, 'TEST-A', 2, 'TEST-B', 3, 'TEST-C', NULL, NULL, NULL, NULL 2, 1, 'CLASS-A', 2, 'CLASS-B', NULL, NULL, NULL, NULL, NULL, NULL 3, 1, 'OBJECT-A', 2, 'OBJECT-B', 3, 'OBJECT-C', 4, 'OBJECT-D', 5, 'OBJECT-E' 説明不足かも知れませんが、どなたか分かる方いらっしゃいましたらよろしくお願い致します。
visual web developer で貸し出し表を作成しています。 sqlサーバーの予定テーブルに下記のようなデータが入っています。 ID　　貸し出し日　　返却予定日　　貸し出した物 1　　　2010/03/31　　2010/04/03　　本 2　　　2010/04/02　　2010/04/02　　DVD 3　　　2010/04/02　　2010/04/03　　CD 上記のデータで4月に貸し出しを行っている毎日の状況を抽出するにはどのようなsql文を書けばよろしいでしょうか。 下記のような結果を期待しています。 日付　　　　　　ID　　　　貸出日　　　返却予定日　　　貸し出した物 2010/04/01　　1　　　　2010/03/31　2010/04/03　　　本 2010/04/02　　1　　　　2010/03/31　2010/04/03　　　本 2010/04/02　　2　　　　2010/04/02　2010/04/02　　　DVD 2010/04/03　　1　　　　2010/03/31　2010/04/03　　　本 2010/04/03　　3　　　　2010/04/02　2010/04/03　　　CD 2010/04/04 2010/04/05 2010/04/06 2010/04/07 ..... 2010/04/30 予定テーブルに対して「貸出日が2010/04/30以下」 or 「返却予定日が2010/04/01以上」のwhere条件で 4月の予定を抽出する事は出来ますが、複数貸し出しがある日を複数行で返し、無い日についてもNULLを返すやり方が思いつきません。 どのようなsql文を書けばよろしいでしょうか。 宜しくお願いいたします。
MS SQL EXPRESSのbit型のチェックマーク表示 ACCESSのMDBをMS SQL EXPRESS にSQL SERVER MANAGERを使ってインポートしました その結果以前のyes/no型データはbit型に変更されACCESSをフロントエンドにしてテーブルを 観てみると0か1の表示になっています。 以前の様にチェックボックス形式で表示する方法は無いものでしょうか？ と言いますのも、ACCESSのレポート機能を使って印刷をする際yes/noのデータを チェックマークのレ点をそのまま印刷していましたので困っております。 どなたか何かよい方法があればご教受くださいますようお願い申しあげます。
SQLで時間の比較 DBの情報tbltimeとソース内で取得したdTimeNowを比較したいのですがうまく実行されません。 SQLで現在時間を取得する{fn Now}を使用するとうまくいきますが、今回はソースのプロパティを使用したいです。 "Select * FROM tblA WHERE tbltime < " & dTimeNow tbltimeはDate型で2010/01/01 11:11:11のように設定されています。 スペースがあるからうまくいかないのかなとも思うのですが、どうしたらうまく比較できるのでしょうか？ ご教授よろしくお願い致します。 環境 SQL Server 2005 VB.net
Microsoft SQL Server Express Edition をインストールしようと思うのですが 「Microsoft SQL Server Express」で ググルと2005が最初に出てきて詳しいホームページが1番目に出てきて 2008が次に表示され見てみるといきなりダウンロードページで 2005のようなその製品に対する詳しい情報が見当たりません。 これは今のところマイクロソフトが2005を推奨していて 2008はまだまだといったところなのでしょうか？ 無難に2005をインストールしたほうがいいですか？ それとも2008でも別に問題ないでしょうか？
テーブル内のカラム情報を取得するにはどのようなSQLを作ればよいのでしょうか？ 欲しい情報は「カラム名・主キーかどうか・データ型・桁数・NULLを許容かどうか」の５つとなります。 SQL Server は2005と2008を使用していて、どちらでも扱えるSQLがあると助かります。 どうぞ宜しくお願いいたします。
エクセルからSQLServerのデータを操作したいのですが 下記コードをエクセルに入力して実行すると conn.Open connstrの部分にて 実行時エラー"-2147217887(80040e21)' 複数ステップの OLE DB の操作エラーが発生しました。各OLE DBの状態の値を確認してください。 作業は終了しませんでした。 とでてしまいます。 どのようにしたらいいのでしょうか？ 教えてください。 Const connstr ="Data Source=●●●\SWLEXPRESS;Initial Catalog = DBweb;Integrated Security=True" は　Web.configで接続されている <add name ="webConnectionString" connectionString="Data Source=●●●\SWLEXPRESS;Initial Catalog = DBweb;Integrated Security=True"_ providerName = "System.Data SqlClient"/>からproviderNameを抜かしてとったのですがいいのでしょうか？ ------------------------------------------- Sub SQL() Const connstr ="Data Source=●●●\SWLEXPRESS;Initial Catalog = DBweb;Integrated Security=True" Dim conn As New ADODB.Connection Dim rs As New ADODB.Recordset Dim strSQL As String strSQL = "SELECT * FROM DBtable" conn.Open connstr rs.Open strSQL, conn Range("A2").CopyFromRecordset rs rs.Close conn.Close Set rs = Nothing Set conn = Nothing End Sub
SQL Server 2008 Analysis Services (SSAS) の集計について、教えてください。 現在、以下のメジャーテーブルとディメンションを保持しています。 (1)メジャーテーブル（売上） 　顧客：A企業 売上：100億 (2)ディメンション（担当部署） 　顧客：A企業 担当部署：α部 　顧客：A企業 担当部署：β部 【課題】 　(1)が部署ごとの売上を保持していればよいのですが、顧客単位の売上しか 　ありません。 【実現したいこと】 　以下のイメージで、部署に紐付けて売上を表示させたいと考えています。 (A) 部署ごとの売上（顧客単位の売上を部署の売上として表示） 　顧客：A企業 担当部署：α部 売上：100億 　顧客：A企業 担当部署：β部 売上：100億 (B) 顧客ごとの売上（本来の顧客単位の売上） 　顧客：A企業 売上：100億 データ粒度が異なっても、同じ売上額を表示させる方法はあるのでしょうか。 判り辛い説明かもしれませんが、よろしくお願いします。
SSIS 行ロックとなり処理が止まる現象について御解答をお願い致します。 はじめまして。SSISをスケジュールで１分間隔で更新処理をしています。 内容はSELCTでWITH(ROWLOCK,XLOCK,NOWAIT)指定で読み、読み込んだ項目をカウントアップしUPDATEする処理を実行しています。　 すると１日に数回ですがロック状態（Resource が同一？）になり処理が止まる現象が発生しています、SSISではROWLOCKが効いてないようにも思えるのですが、御教示頂きたくお願い致します。 スナップショット分離レベルは１となっています。
ACCESSからODBC接続での書き込みや更新 環境 OS:WindowsXP home SQL Server Express 2008 SQL server manegement studio 2008 パソコンネーム:pc01に SQL Server Express 2008をインストールしてあり そのパソコンからマイクロソフトACCESSからODBC経由で SQLにアクセス(全て同一パソコン) SQL server manegement studioで 以下のようにデータベースを作成しました データベース名：DB01 テーブル名：tbl_01 所有者：pc01\user1 ODBC接続の設定 以下3点以外は規定値 接続するSQLサーバーの名前：pc01\SQLEXPRESS ネットワークへのログインIDでWindows NTの認証メカニズムを使う 規定のデータベースを以下のものに変更する:DB01 この状態でACCESSからODBC経由でDB01のtbl_01に接続しても 新規書き込みや更新が出来ません、 書き込みや更新をしたい場合何を設定すれば良いのでしょうか？ SQL server manegement studioで ユーザー、ロール、マップなどを 色々触って見たのですがテーブルの閲覧は出来ますが 更新や新規書き込みが出来ません。 確認すべき項目など御座いましたら具体的にお教え願えれば 幸いです、よろしくお願い致します。
.LDFファイルが30GBになってしまいました。 SQL Server 2005でSharePointServer 2007を運用中です。 気がついたら、STS_Config_log.LDFというファイルのサイズが35GBになっていました。 100MB程度にサイズを小さくしたいのですが、方法が分かりません。 お分かりの方よろしくお願いいたします。
SQLの更新方法について 環境 OS:windows XP home sql server express2008 Microsoft SQL Server Management Studio10.0.1600.22 現象 MS ACCESSからODBCを通してsql server express2008の中に作ったテーブル”TB01”にアクセスしていました。 あるときSQL Server Management StudioでTB01を削除しました。 ところがACCESSからODBCを通して接続すると削除したはずのテーブル”TB01”が見えていて リンクを張るとデータも出てきます、 ためしに新しくデータベースを作ってテーブルを作成してもODBCからは昔のままのテーブルしかありません。 SQL SERVERを再起動しても変わりません、どのようにすればＳＱＬの内容を更新できるのでしょうか？ どなたかお知恵を拝借願います。
FileStreamデータ型はEXE形式のファイルを格納することも可能でしょうか？ また、ファイルをテーブルに格納したあとに、実ファイルをHDDから削除しても問題ないですか？ よろしくお願いいたします。
アクセスログに下記のようなクエリ文字列が残っていました。 （本来のアドレス）+AND+1=2+UNION+SELECT+0x6461726b3063306465,0x6461726b3163306465, 0x6461726b3263306465,0x6461726b3363306465,0x6461726b3463306465, 0x6461726b3563306465,0x6461726b3663306465,0x6461726b3763306465, 0x6461726b3863306465,0x6461726b3963306465,0x6461726b313063306465, 0x6461726b313163306465-- ※本来は一行ですが、適当に改行しています。 これはSQLインジェクション攻撃だと思いますが、解読して具体的に何がしたかったのか知りたいです。 しかし、0xで始まる部分をどう解読すればいいのかわかりません。 http://hogehoge.tk/tool/ このページで色々試してみましたが、できませんでした。 よろしくお願いします。
SQLサーバで社内のWEBシステムの構築を考えています。 現在考えている構成は A拠点　WEB＋SQL B拠点　なし C拠点　なし です。 もしもの為を考えて、DBをクラスタリングして、WEBをもう１台 B拠点に設置しようと考えているのです、 ＝＝＝＝ A拠点　WEB＋SQL（B拠点とクラスタリング） B拠点　WEB+SQL（A拠点とクラスタリング） C拠点　なし ＝＝＝＝ こんな方法って実現可能なんでしょうか。 そもそもクラスタリングの使い方としてこれは正しいのでしょうか。 SQLで実現可能なのであれば、どこかで実績がかいてあるWEBサイトが あればおしえてもらえませんか。
YYYYMMDDhhmmss形式の文字列を日付時刻に変換・計算する方法 お世話になっております。 今回の質問内容なのですが、 あるテーブルにYYYYMMDDhhmmss形式(varchar(14))の列がありまして、 この値の時刻計算を行いたいと思っております。 YYYY/MM/DD hh:mm:ss形式であれば、DATEADD関数で 計算が可能なのですが、やり方がわからず苦戦しております。 例えば1秒加算させたいと思い、以下のSQL文を実行してみたのですが、 SELECT DATEADD(second,1,(CONVERT(DATETIME,'20100312111111'))) 「文字列から日付/時刻に変換できませんでした。」というエラーが 発生してダメでした。 時刻部分だけ取り出して、それに時分秒を分ける「:」をつけて変換し 計算するという方法は極力避けたいと思っています。 何かいい方法がありましたら、ご教示のほどよろしくお願い致します。
C# VisualStaudio2008とSQLServer2005です。 質問なのですが、SQLServer2005に定義したストアドプロシージャーtestStoredに引数0001を渡すにはどうすればいいのでしょうか？ DBOpenはすでにできるようになっています。 VisualStaudio2008からSQLServer2005のtestStoredの呼び出し方法が全くわかりません。 お手数ではございますが、詳しい方アドバイスをお願いできないでしょうか？ できればサンプルソースを知りたいです。
データベースサーバの環境 OS:Windows server 2000 SP4 DB:Microsoft SQL Server 8 イベントビューアのアプリケーションログを見ていると、「使用できるメモリが足りません」というエラーが出ていました。 このエラーが出た原因と、なぜ回復したのかを調べたいと思います。 エラーが出た時間、SQLに与えられた命令を調べるには、どうすればいいのでしょうか。 SQLプロファイラを使えばいいのかと思い、下記ページを参考に実行してみましたが、出てきたデータをどう判断すればいいのか、よくわかりません。 http://d.hatena.ne.jp/kahze/20090315/1237117908
二つのテーブルをjoinして比較したいときに 比較対象の項目がA,Bとあったとします。AはキーですがBはキーではありません。 このとき、ON句でTABLE1.A=TABLE2.A and TABLE1.B=TABLE2.B とかくのと ON句でTABLE1.A=TABLE2.A WHERE TABLE1.B=TABLE2.B と書くのとで結果に違いはあるのでしょうか？ 違いが見つけられずに困っています。 違っていない場合、どちらが一般的でしょうか？ どうぞよろしくお願い致します。
SQLServer2008Exを使用してます。 MSSMSでクエリ（SELECT文）を実行するとタイムアウトになってしまします。 データの量はそれなりにあるのですが、実行タイムアウトは０（ゼロ）無限の待ち時間に設定してあるのに何故なんでしょうか？
いつもお世話になっています。 SQLServer2005で複数テーブルを結合したビューを作成したいのですが フィールドの中にデータを演算した結果をセットしたいと思っています。 ここまでは問題なくできたのですが 演算した結果のデータ型が元のデータ型に依存しているのか floatになっていました。 実際には有効数字の観点から、intが適切なので データ型を指定したいのですが、その方法がよくわかりません。 ビューを作成する時に、データ型を指定する方法を教えていただきたいと思います。 よろしくお願いします。
DTSにて、テーブルDROP後、CREATEし、同レアイウトのテーブルからデータコピー(BULK INSERT）をしています。 テーブルCREATEしたのでsysdependsの従属関係はリセットされてしまいますが、復帰させる手段はありますか。
SQLServer2008Exを使用してます。 テーブルを作成した後キーを設定しようとしたら 「変更の保存が許可されてません」とメッセージが出ました。 どうすれば変更の保存ができるのでしょうか？
ソートについて、どの様なSQLを発行すれば良いのでしょうか。 初めての質問になります。 下記ソートしたいのですが、どの様なSQLを発行すれば良いのでしょうか。 またそのそもこの様な事は可能でしょうか。 ・SQLserver2005 商品DB -------------------------------- 単価｜在庫｜フラグ -------------------------------- 100｜1｜0 300｜3｜1 500｜5｜0 -------------------------------- フラグが立つレコードのみ2倍の在庫として扱い、 ソートしたいと思っています。 -------------------------------- 100｜1｜0 500｜5｜0 300｜3｜1 # フラグにより在庫を6換算してソート スミマセン。 どなたかご教授ください。
