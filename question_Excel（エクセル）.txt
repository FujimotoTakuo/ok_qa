Ｃ１５に="田中"&TEXT(A15,"ｍ.d") Ｃ１５に田中8.31と表示されてます 別のシート作成し　田中8.31　と名前を付けておきます Ｃ１５を押した時に飛ぶように設定しようとしたのですが うまくいかないのですが どうしたらいいでしょうか？ Private Sub Worksheet_SelectionChange(ByVal Target As Range) If Target.Address = "$C$14" Or Target.Address = "$C$15" Then Worksheets(Target.Value).Visible = True Worksheets(Target.Value).Select Else End If End Sub Worksheets(Target.Value).Visible = True　ここの部分でうまくいかなくなります
エクセルで表を作成しました。 必要な部分は数値などは打ち込めます それ以外はシートで保護しています （メニューバー、シートの表示するところは編集できないように消しています） シートの一部分に編集ボタンを作りマクロを乗せたいのですがわからなく 困っています助けてください やりたいこと ボタンを押すとPWを要求され合っていればシートで保護しているところを 解除して内容を変更できる 再度押すとPWがあるシート保護状態に戻る PWが間違っている場合は「違います」で終了するマクロを作りたいです 似たようなのがあり頑張りましたができませんでした・・・ http://oshiete.goo.ne.jp/qa/1251170.html
印刷のボタンを作成しました。 原本シートに書き込んで終了した時に保存ボタンを押したら シート名を記載して保存するＶＢＡが一個あります それとは別に印刷ボタンを作成したいのですが 原本シートの表には未記入の場所には条件式でセルに色を つける条件を付けてます。 印刷ボタンを押した時 全部のセルの色を白色に戻し指定した範囲の部分を印刷するボタンを作れないでしょうか？ 例　Ａ１：Ｋ７３まで印刷するなど
エクセルのsheet1の1行目にタイトルがあります。 ボタンのクリックイベントで、テキストファイル2つをインポートしたいのですが。 ・テキストファイルの名前は、固定ではありません ・テキストファイルの保存先は、デスクトップで、ファイルの選択は自分でしたい ・テキストファイルの一行目は、タイトル行なので、二行目以降をインポートしたい 行数は固定ではありません ・タブ区切りです 複数選択はできなく、1ファイルでタイトル行も含めるのであれば下記コードできたのですが。 どなたか、ご教示いただけますでしょうか・・・・ よろしくお願いいたします。 ----------------------------------------------------- Sub ReadTextFile() 'タブ区切りファイルを全て文字列として読み込む Dim FileName As String Dim i As Long Dim Cnt As Long Dim Buf As Variant Dim FileNo As Integer Dim SplitString As Variant 'ファイルダイアログを表示 FileName = Application.GetOpenFilename("テキストファイル,*.txt") If FileName <> "False" Then '全セル選択して書式を文字列にセットする Cells.Select Selection.NumberFormatLocal = "@" Cells(1, 6).Select '空いているファイル番号を取得 FileNo = FreeFile() Buf = Space(FileLen(FileName)) 'ファイルを開いてbufに1行読み込み ' → タブで配列に分割 ' → セルに書き出し Open FileName For Input As #FileNo Do Until EOF(FileNo) Line Input #FileNo, Buf Cnt = Cnt + 1 SplitString = Split(Buf, vbTab) For i = 0 To UBound(SplitString) Cells(Cnt, i + 1) = SplitString(i) Next i Loop Close #FileNo Else End If End Sub -----------------------------------------------------
いつもお世話になっております。 　Excel VBAにて困っております。ご存知の方、お力添えお願い致します。 質問は、ExcelのVBAにてヘッダー内に改行を含む文字列を代入しています。 更新後開いてみると、改行が上手く反映されず文字が重なっている状態となります。 尚、クリックし一度修正モードにすると改行します。 また、ヘッダーを更新したいExcelは、マクロが起動しているExcelとは別のExcelとなります。 何か更新の仕方を誤っているのでしょうか。 ご教示お願い致します。 具体的な内容は以下の通りです。 OS Windows7、Excel2010 シートの回数ループしヘッダーを更新しております。 With wb.Sheets(i).PageSetup .RightHeader = "&R" & fild1 & fild2 & vbCr & "&R" & filename1 & "&A" End With それではどうぞ宜しくお願い致します。
原本のシートがあり AX1にボタン（保存）を作りました。 原本シートに記載していき 記載終わった時に作成したボタンを押すと 記載されたシートをコピーして新たな名前を付け自動的にシートを追加する ことは可能でしょうか? その際原本シートは元の記載されてない状態に戻したいのですが・・ （シートの名前は○○様○月○日みたいな感じにしたい）
長文失礼します。 自分でも色々と調べたのですが分からない事だらけでかなり滅入っているので詳しい方に助けていただきたく、分かる点だけでも回答をいただければ非常に助かります。 これまで種類毎にシート分けしていた注文一覧表ファイルに全注文分を集約した新たなシートを追加し、その情報の項目諸々を他のファイル（作業時間ファイル）にも展開したくと思い、下記のようなフォーマットを作成しました。 ＜（1）注文一覧ファイル＞ シート(1)…集約表（注文番号、金額、品名などを入力） シート(2)…種類Ａの一覧表（(1)の注文番号をキーにしてVLOOKUPで参照。ただし、金額には算式（ROUNDDOWN(SUM(X/Y,2)を含む）が入っているので、それを「集約表」に値はりつけした） シート(3)…種類Ｂの一覧表（同上） シート(4)…売上合計表（(2)(3)を別の基準でSUIMIF集計） ＜（2）作業時間ファイル＞ シート(1)…集約表（（1）(1)をまるごとコピー） シート(2)…作業時間集計表（(1)の注文番号をキーにして金額などをVLOOKUPで参照、(3)を別の基準でSUMIF集計） シート(3)…作業時間明細表 ※ファイル（1）と（2）をまたぐ算式は入れていません。 実際に算式を入れて正しく集計されるか確認したところ、いくつか合わない箇所がありました。 【合わない点】 その１：（1）(2)から(1)シートへの金額はりつけ時、端数処理のせいか金額が若干上がっているのがまれにある。 →★質問１ 値はりつけしただけなのに正しく集計されないのですがなぜでしょうか？式が誤っているのでしょうか？ その２：（1）(4)シートのSUMIFで金額が一部集計されないもの（端数ではない）がまれにある。 →★質問２ 例えば(1)シートの入力の際に手入力でなくて一部他データより値はりつけしたから（文字列になっている？）というのは考えられますか？ 対処方法や見つけ方はありますか？ ★質問３ VLOOKUPの式はそのまま残しておく（値はりつけせずに算式のまま）と正しく集計されないとか不便な点はありますか？注文番号を次々に追加して式は残しておきたいんですが…。 ★質問４ （2）ファイルの(1)、(2)ファイルの全体の金額合計は見た目上検算（SUM）でも合っていたのですが、文字列はりつけ分があると、その金額を用いた他の時間集計とかで正しく集計されないとかあり得ますでしょうか？ ★質問５ VLOOKUPを使う以外に同様の作業（注文番号だけ入力したら、他の情報を自動で出てくる）ができる単純な方法などがあれば教えてください。 長々とすみませんが、分かるものがあれば教えていただきたくよろしくお願いします。
A1に2016年、B1に8月などと入力した時 A２～A15に日付を自動出力 B２～B15に曜日を自動出力 C２～C15に文字列＆日付で自動表示するファイルを作成しました A1　2016年　B2　8月 A列　　B列　　C列 1日　月曜日　名前8月1日 2日　火曜日　名前8月2日 3日　水曜日　名前8月3日 ・ ・ C列のC2～C15の名前でシートを自動的に作成出るようにしたいのですが たとえばボタンを作成しボタンを押したときにシートが自動的に作成される または年と月を入れた際に自動的にシート作成されるようにしたいのですが さらにシートは原本を作っているのでそれをもとにコピーされるように したいのですが？ どうすればいいでしょうか？ お手数ですが宜しくお願いします。
シート1の締日が　”ＡＡ3”　～　表記されていく表があります。 　　　　”ＡＡ4”以下は、各顧客の合計金額が記録されています。（月毎に　列、行、共に増えます。） 同じシート内で、”Ｋ1”に表記した日付の列を、金額のみ”ｋ4”以下に表記したいのですが、 いろいろ方法を考えてもどうしてもできません。 よろしくお願いします。
シート1に各月の売上一覧が毎月更新されていきます。 シート2のC1に　○月売上を指定し、B列に表記したいと考えています。 よろしくお願いします。
お世話になります。 A.xlsというブックがあります。 その中に[集計]というシートがあります。 このシートに[ボタン]を配置してクリックしたら以下の動作を実現させたいのです。 (1)[集計]シートのA2に位置セット (2)[東京]、[大阪],[名古屋]という名称のシートの列=A2～A62、行=A2～データ最下行にある全データを[集計]シートにどんどんコピー貼り付けして追加していきたいのです。 上記動作を実現するVBAのロジックをどなたかご教授いただけますでしょうか。 よろしくお願い致します。
表示するコードを教えてもらい画像のように作成できることが できたのですが A２ =IFERROR(INDEX(($A$1&$B$1&"1日")*1+ROW($A$1:$A$31)-1, SMALL(INDEX(MOD(WEEKDAY(($A$1&$B$1&"1日")*1+ROW ($A$1:$A$31)-1,1),2)*50+ROW($A$1:$A$31),0),ROW(A1))),"") B２＝A2で作成しています 2月の時だけ次の月の最初の部分が出ることがあります どうにかならないでしょうか？
EXCEL2013 で罫線の形（太線・細線）をそのままにして、色だけ変更したいのですができますか。 調べてやってみたのですが、 http://oshiete.goo.ne.jp/qa/5577382 画面左上の○印（Ｏｆｆｉｃｅボタン）を押してとありますが、どこにもありません。 他の方法はうまく行きませんでした。 マクロでなければできないのであれば情報だけお願いします。マクロを作っていただく必要はありません。
いつもお世話になります。 A、Bのファイルのシートからデーターをコピーして、別ファイルsheet2にC列以降貼り付けします。 そのデーターの数だけ、そのシート名（担当者名）をB列に貼り付けしたいのですが、1行目だけしか貼り付けできません。 コードを教えていただけないでしょうか？ よろしくお願いいたします。 Sub コピー() Dim ws2 As Worksheet Dim FP As Variant Dim i As Long, j As Long, t As Long, n As Long, m As Long Dim wb As Workbook '選択したフォルダのパス名を取得 FP = Application.GetOpenFilename("Excel ファイル (*.xlsm),*.xlsm", MultiSelect:=True) For i = LBound(FP) To UBound(FP) Set ws2 = ThisWorkbook.Worksheets("Sheet2") '書きだすシート Set wb = Workbooks.Open(FP(i)) 'データーファイル t = ws2.Range("D" & Rows.Count).End(xlUp).Row j = wb.Worksheets(1).Range("D" & Rows.Count).End(xlUp).Row n = ws2.Range("B" & Rows.Count).End(xlUp).Row wb.Worksheets(1).Activate wb.Worksheets(1).Range(Cells(7, 2), Cells(j, 35)).Copy ws2.Activate ws2.Range("C" & t + 1).PasteSpecial Paste:=xlValues ws2.Range(Cells(n + 1, 2), Cells(t, 2)).Value = wb.Worksheets(1).Name　←この列 Next i End Sub A、Bのファイルデーター 　　　A　　　B 　　　C　　　D　　　　　E 1　　NO　　業種　物件名　目標種別区分 2　　　1 あ　　　　あい　　かえ　　　　A 3　　　2 い　　　　いい　　きえ　　　　A 4　　　3 う　　　　うい　　くえ　　　　A 5　　　4 え　　　　えい　　けえ　　　　A 6　　　5 お　　　　おい　　こえ　　　　A コピーするファイルのシート（最終出来上がり希望） 　　　A　　　B 　　　C　　　D　　　　　E　　　　D 1　　NO　　担当者　業種　物件名　目標種別区分 2　　　1 　　 鈴木　 あ　　　　あい　　かえ　　　　A 3　　　2 　　 鈴木　 い　　　　いい　　きえ　　　　A 4　　　3 　　 鈴木　 う　　　　うい　　くえ　　　　A 5　　　4 　　 鈴木　 え　　　　えい　　けえ　　　　A 6　　　5 　　 鈴木　 お　　　　おい　　こえ　　　　A 2　　　1 　　 田中　 あ　　　　あい　　かえ　　　　A 3　　　2 　　 田中　 い　　　　いい　　きえ　　　　A 4　　　3 　　 田中　 う　　　　うい　　くえ　　　　A 5　　　4 　　 田中　 え　　　　えい　　けえ　　　　A 6　　　5 　　 田中　 お　　　　おい　　こえ　　　　A コピーするファイルのシート（現在） 　　　A　　　B 　　　C　　　D　　　　　E　　　　D 1　　NO　　担当者　業種　物件名　目標種別区分 2　　　1 　　 鈴木　 あ　　　　あい　　かえ　　　　A 3　　　2 　　 田中　 い　　　　いい　　きえ　　　　A 4　　　3 　　 田中　 う　　　　うい　　くえ　　　　A 5　　　4 　　 田中　 え　　　　えい　　けえ　　　　A 6　　　5 　　 田中　 お　　　　おい　　こえ　　　　A 2　　　1 　　 田中　 あ　　　　あい　　かえ　　　　A 3　　　2 　　 　　　 い　　　　いい　　きえ　　　　A 4　　　3 　　 　　　 う　　　　うい　　くえ　　　　A 5　　　4 　　 　　　 え　　　　えい　　けえ　　　　A 6　　　5 　　 　　　 お　　　　おい　　こえ　　　　A
エクセルで添付した図のような表を作りました。 合計の行にIFとSUM関数を使いました。 B2のセルをドラッグでC2に移動させると、合計のC3の式がエラーになってしまいます。 なぜでしょうか？ ドラッグでセルを移動させてもエラーにならないようにするにはどうしたらいいですか？ よろしくお願いいたします。
エクセルでアンカーを引かずにハイパーリンクを付けることは可能でしょうか？ 「見た目は普通の文字だけど実はリンク」と言うのを作りたいです。 画像の様にリンクを付ける方法しかわかりません。
下記のコードがうまくいかないのですが間違っているところ教えてください。 標準モジュールです。 Sub color_change() ActiveSheet.Range("b1").Select If ActiveSheet.Range("B1") = "B" Then Selection.Font.ColorIndex = 3 End If End Sub
シート１の表－１にA~C列に文字とD,E列に数値が入力されておりシート２の表－２にA,B,C列の文字が同一行であれば１行とし違えば行を追加し同一行はD,E列の数値を加算していきたいのですがどなたかVBAコードか関数の解る方宜しくお願いします。
Excel 2013 を使い始めて半年以上になりますが、今まで気付かなかったことがあります。 [名前を付けて保存]のダイアログメニューに、添付図に示す 縮小版を保存、タグの追加、フォルダーの非表示 添付図では見えないけど、「タグの追加」の右側に、タイトルの追加 なるものが鎮座しております。 これ等は何のためにあるのか、教えてください。 Excelヘルプに記載されていますか？
ご覧いただきありがとうございます。 写真の添付が1枚しか出来ない為、質問を2つに分けて、1枚ずつ添付します。 ◯[Sheet1]に図のようなデータがあった場合なのですが、そのままだと見辛いので、それぞれ別のシートで検索出来るようにしたいなぁと思っております。 【A列】→Ｎｏ． 【B列】→高校名 【C列】→学科 【D列】→郵便番号 【E列】→住所 【F列】から、添付写真のように内容が入力されていて、県ごとに表が分かれています。(表全体を載せたいのですが、画像が粗い為、抜粋しました。分かりづらくてすみません。) ◯[sheet2]では、県名(プルダウンで選択)→高校名(県名に連動して、プルダウンで選択)→内容(H26年度 入塾生・H27年度 入塾生・H28年度入塾生・H27年度 体験授業参加人数…などをプルダウンで選択)→人数(クラス毎)で検索したいです。 (『エクセルのデータ検索について(2)』に添付の上の図) ◯[sheet3]では、内容(プルダウンで選択)→高校名一覧＋人数(sheet1の表で、人数が0の場合は表示しない)で検索したいです。 (『エクセルのデータ検索について(2)』に添付の下の図) 色々調べてみて、VLOOKUP・INDEX・MATCH関数を組み合わせると出来そうなのですが、どのように組み合わせて良いか分かりませんでした。 こんな感じの複雑な検索は可能でしょうか？ ご回答宜しくお願い致します。
ランダムに数値が入っていて、1行ごとに＋－4.0の範囲に入る数値について色を塗るか、関数で追加列に該当する個数を示すとか、分かるようにしたいです。 添付のような感じです。
エクセルのグラフを画像として保存する方法は無いのでしょうか？ 右クリックをしてもこれしか出ません。 2010です。
度々、お世話になります。 添付のような元データを入力します。それをもとに ピボットテーブルで、部、クラスの実働人数を数えたいのですが・・・。 データ個数でも、数値の個数でも同一氏名のデータが２つ以上あると、２人となってしまいます。データが3つだと３人に・・・。 同じ氏名は、あくまでも『1人』とカウントしたピボットテーブルをエクセル2010で作る事はできますか？ やはりアクセスでないと無理でしょうか？ よろしくお願い致します。
Excelで我が家の本棚の蔵書リストを作成中です。一通り書名・著者・出版社・出版年などを入力したあと、含まれている著者や出版社を一覧して、別表に書き出したいと思っています。 一覧するだけならデータタブ内のフィルタ機能をかけて、見出し部分にできるプルダウンから見られるチェックボックス付きリストでできますが、これと同じような、そのコラム内に含まれる全項目を列挙したリストを作成するには、どのようにすればよいでしょうか？それを可能にする関数などはありますでしょうか？
Sheet1に月毎のの売上一覧があります。 Sheet2にSheet1の顧客別に合計したものを指定の位置へ転記したいのですが、 月によって売上セル領域が変動するため、いい方法がわかりません。 よろしくおねがいします。 Sheet1 　　　Ａ　　　Ｂ　　　C　　　D 1　　　日付　　顧客　　商品　　　売上 2　　2月1日　　　あ　コーヒー　100 3　　2月5日　　　え　　卵　　　200 4　　2月6日　　　い　パン　　　300 5　　2月10日　　　い　リンゴ　　　100 6　　2月18日　　　あ　　バナナ　200 7　　2月20日　　　え　　みかん　100 8 9 Sheet2 Ａ　　Ｂ 1顧客　売上合計 2あ 3い 4う 5え 6お 7か 8き 9
グループ化した図は画像のような画面は出ないのでしょうか？
こちらの識者の方々にはいつもお世話になっています。 VBAの質問です。 環境は下記になります。 OS=windows7 pro 64bit Office=Excel2010(14.0.7128.5000) ・やりたいこと 下図の左側のようなリストがあります。 荷物を一つずつ記載したリストなのですが、番号、コンテナが一致している荷物については右側の図のようにカンマ区切りで1行に纏めたいです。 この場合、どのようなコードが適していますでしょうか？ 質問に不備不足等ございましたらご指摘ください。 ご面倒お掛けしますがよろしくお願いします。
添付図は Excel の古典バージョン 2002 ワークシートの右下部を示しています。 キーボードの ScrollLockボタンや NumLockボタンを押すと、当該部分にNUM、SCRL なる文字が表示されます。 さて、Excel 2013 では左下部に SCROLLLOCK は表示されますが、その付近に NUMLOCK が表示されることはありません。懐メロの題名じゃないけれど、「ナムロックは何処へ行った？」のでしょうか？
「データの入力規則」で作るリストにて、数値入力の際にカンマを使うことはできないのでしょうか？ たとえば「1,000円」と「2,000円」の場合、「元の値」に入力したときにカンマを使うと、このタスク上では区切りとして扱われてしまうようで実際にリスト化したときに 1 000円 2 000円 というリストになってしまいます。 カンマが入った数値のリスト化の方法はあるのでしょうか？ Excel2007利用です。
目次　→　情報（非表示中）→目次ボタン　→　目次に戻る をVBAのコード表示を教えて頂きできたのですが 開いた情報　→　目次に戻る際に情報の項目が自動的に非表示にできません VBA初心者なのでコードがわからないです ご迷惑ですが やりかたを教えて頂きたいのですが 宜しくお願いします。
お世話になっています。 Excelで A列欄にタイトル B列欄に開始日 C列欄に開始時 D列欄に終了日 E列欄に終了時 のデータが有ります。 F列欄に合計を求めたいです。 今回は、 For～Next間のコードを教えて下さい 前回質問分 http://okwave.jp/qa/q9213232.html Option Explicit Public i As Long Public num As Integer Sub newmacro() Range("F1").Value = "合計" Columns("F").Select Selection.NumberFormatLocal = "[h]:mm" For num = 2 To Range("a1").End(xlDown).Row Cells("F", num).Value = Cells("D", num).Value + Cells("E", num).Value - Cells("B", num).Value + Cells("C", num).Value Next num End Sub よろしくお願い致します
お世話になります。 Windows7下のExcel2010です。 他ではありえない とは、思うのですが 機能確認願います。 内容は参照です。 OFFSET構文を使って 様々な機能を実現して 自宅で遊んでたのですが 次第に、INDEX(OFFSET(…),,) と、いう風に INDEX文をかけないと 値を通常確定では 読み込まなくなりました 其れどころか 他シート参照すらも ＝sheet1!a1+sheet1!a2 を、 =INDEX(sheet1!a1,,)+INDEX(sheet1!a2,,) 等と、しないと 読み込まなくなりました 普通ではありえない とは、思うのですよ ですが もしかして他の環境でも こうなのですか？ 回復法はあるのですか？ シートマクロでも 潜り込んでいる ので、しょうか？ お教えください
お世話になります。 あるアンケートをエクセルで集計しています。 300人ほど、設問数は40です。 まずは一人ずつの回答をベタ打ちで入力してからCOUNTIFで集計しようと思っています。 【例】(1)あなたは〇〇を使ったことがありますか？ 　　　１、よく使う　　２、たまに使う　　３、使ったことはない 　　　(2)今後、購入を考えている製品候補はどれですか？（複数回答可） 　　　１、A　　２、B　　３、C　　４、D　　５、E 　※この例はほんとに例えです。 　　実際は全然違う内容であり、会社の仕事などではないです(^^;) 設問の中には複数回答可で選択肢が５～９個というものが何問かあります。 この入力方法に悩んでいます。最初は「13568」と連続で入力して、COUNTIFで「1」を指定すればいいかと思ったら、ダメでした。セルの設定を文字列にしてもダメなのですね。 入力画面をスクロールしないでも入力できるとベストなので、なるべくスペースをとらない形で入力したいのですが、何かいい方法はないでしょうか？ （列を１選択肢ごとに割り振って、選ばれた項目だけに〇を付ける方法は最後の手段にしたい）
windows7を使っています。 エクセルVBAで Sub Sample1() Dim i As Long Dim myRow As Long For i = -32768 To 32767 myRow = myRow + 1 Cells(myRow, 1) = Chr(i) Next i End Sub のコードで文字コードをすべて書き出してみたのですが 空白や「」だけ等がいくつもあります。 これはどうしてでしょうか? 文字コードに対応する文字が振られていないのでしょうか? -32768 To 32767の理由は Asc 関数のヘルプを見たら 「DBCS を使用しているシステムでは、 -32768 ~ 32767 の範囲の値が返されます。」 となっていた為です。
こちらの識者の方々にはいつもお世話になっています。 VBAの質問です。 環境は下記になります。 OS=windows7 pro 64bit Office=Excel2010(14.0.7128.5000) ・やりたいこと C:\AAA\BBB\CCC.xlsmファイルにマクロを記述し、 「BBB」という文字列を取り出したいです。 （フルパスではない） この場合、どのようなコードが適していますでしょうか？ 質問に不備不足等ございましたらご指摘ください。 ご面倒お掛けしますがよろしくお願いします。
excel2013(会社) とexcel2010(自宅)を使用しています。 当初はフィルタ結果を無条件に複製していたのですが、 該当行が存在しない場合、転記がおかしくなった為、 該当行が無い(見出し行のみ)場合は転記しないように 修正しようとしているのですが、うまくいきません… やろうとしているのは下記の流れの作業なのですが、 下記Bの段階でエラーが出たり想定外の巨大数(全行でも44なのに 1048544)が出たりと想定している「現在の表示行数の取得」まで たどり着けません 処理 A WS1シートの18列目に*委託*、15列目に0のフィルタをかけて B 5列目(伝票番号列)の可視セル数=行数を数えて C 行数が2以上なら別シートに追記複製 ' 明細区分0(摘要)を担仕整2へ複写 WS1.Rows("1:1").AutoFilter Field:=18, Criteria1:="=*委託*", Operator:=xlAnd WS1.Rows("1:1").AutoFilter Field:=15, Criteria1:="=0", Operator:=xlAnd cnt = WS1.Rows("1:1").Columns(5).SpecialCells(xlCellTypeVisible).Cells.Count ' If WS1.Rows("1:1").AutoFilter.Range.Columns(5).SpecialCells(xlCellTypeVisible).Count > 1 Then If cnt > 1 Then WS1.Rows("1:" & lr).Cells.Copy WS2.Cells End If WS1.Rows("1:1").AutoFilter またフィルタ結果の行数を取得するのに可視セルのVBA指定を見ましたが、 サイトを巡ると、xlVisible表記の所と xlCellTypeVisible 表記の所が 有るようです。この二つはどう違うのでしょうか？ よろしくお願いします。
Excel2007利用です。 「セルの書式設定」＞「表示形式」＞「ユーザー定義」で、以下のように数値を入力するとその単位も同時に自動で表記するための式を教えてください。 ・「100」と入力➡自動で「No.100」と表示 ・「1」と入力➡自動で「1回」と表示 ・「才」と入力➡自動で「1才」と表示 ・「kg」と入力➡自動で「1kg」と表示
文字列で10桁まではオートフィルで連続データを選択できますが 11桁以上は連続データが選択肢にありません。 11桁以上でも使えるようにならないのでしょうか？
いつもお世話になります。 http://oshiete.goo.ne.jp/qa/7073912.html これの逆に近いことができる関数がわかる方いらっしゃいますか？ 図にすると、下記のような状態です。 A１　B１　C１　D１　E１　F１ A２　B２　C２　D２　E２　F２ ・・・・・・ A１００　B１００　C１００　D１００　E１００　F１００ のようにデータを入力していくと G1＝A１ G2＝B１ G3～ G4 G5 G6＝F１ G7＝A２ ： ： G１００００ というような感じで、自動的にデータがコピーされていくような感じです。 入力済みのデータではなく、 入力していくと、データがコピーされて反映されていくような感じです。 この状態にできるG列の数式がわかる方がいらっしゃいましたら、 お知恵をお貸し頂けましたら幸いです。 よろしくお願い致します。
お世話になります。 Excelでワークシート関数をVBAで使用したいのですが、うまくいきませんでした。 関数ですと「ISERROR(FIND(V$10,R$11))=FALSE」のような式をVBA上で使用したいと思い、以下のようにコードを書いてみましたが If Application.WorksheetFunction.IsError(Application.WorksheetFunction.Find(Cells(i, j), Cells(i, 18))) = False Then Cells(i, j).Select End If 「実行時エラー'1004' WorksheetFunction クラスのFindプロパティを取得できません」となります。 入れ子が問題なのでしょうか。 よろしくお願いします。
Excel2016で、A2から始まり、下へ計算していく計算式があります。 その計算式では、異常値の場合「異常値」として表示されます。 その中で異常値がある場合、同シートに何行目にあるか表示させたいのですが複数ある場合もあり、また、途中で正常値の場合もあります。 そのような場合、最も下の異常値が表示されている行数目を表示させたいのですが、計算式を教えてください。 異常がない場合は「異常なし」とかでいいです。 例： A2：異常値 A3：異常値 A4：1 A5：異常値 A6：異常値 A7：8 A8：異常値 A9：10 A10：15 A11：20 以降正常値の場合、「8行目」と表示する。 回答よろしくお願いします。
請求金額から支払手数料を引いた振込金額を計算する支払一覧表をEXCELで作成しました。後から一部の支払先には、当方が手数料を負担しなければならないことがわかりました。そこで顧客名から当方負担であるかどうかを判別したいのですが、良い方法を教えてください。 よろしくお願いします。 表はおおざっぱにいうと以下のような構成です。 ・顧客名 ・振込銀行 ・請求金額 ・振込金額（請求金額－銀行手数料） ・銀行手数料 ・手数料判定（判定用：口座や金額から手数料を決定。）
エクセルＶＢＡがパソコンによってコマンドが実行されないことがあります。 プログラムの目的はIEを開いてソース中のテキストを取得するのですが、 その途中過程で、リンクをクリックして画面の一部の情報を更新し、その部分からテキストを取得します。 しかし、画面が更新されアドレスも末尾が変化したにもかかわらず、”～Document.URL” でアドレスを取得すると、更新前のアドレスのままなのです。 画面もアドレスもソースも変わっているのに、ＶＢＡで情報を取得すると更新前の情報です。 おそらくエクセルの設定かバージョンの違いかと思っています。 正常に実行できる方はExｃel2013で、他方は2010です。 正常に実行されない方はマクロ自体が使えないわけではなく、上記の一部のコードが正常に実行されないだけです。 設定でしょうか？
いつもお世話になっています。 アンケートの集計方法についての質問です。 問6の部分（F～T）が複数回答になっています。 このアンケートの集計で問2が「2以下」で問6に「1」のある数を集計したいのですが COUNTIFS関数で=COUNTIFS(C:C,"<=2",F:T,1)としてもエラーになってしまいます。 何か上手くいく方法は無いでしょうか？
お世話になります。 よろしくお願いいたします。 Sheet1に集計表、Sheet2にデーターがあります。 氏名とコードが合致するデーターの個数を出したいのですが、コードの書き方がわかりません。 ご教示をお願いいたします。 Sheet1のB列の最後に小計や合計が入っているため、A列使用。 COUNTIFS関数でコンパイルエラーがでます。 Sheet1 A　　　　B　　　C　　　　D 氏名　氏名　コード　合致する個数 Sheet2 B　　　　J　　　　　N 氏名　　コード　　　数値 Sub test1() Dim i As Long, t As Long Dim wS1 As Worksheet, wS2 As Worksheet Set wS1 = Worksheets("Sheet1") Set wS2 = Worksheets("Sheet2") i = wS1.Range("A" & Rows.Count).End(xlUp).Row t = wS2.Range("B" & Rows.Count).End(xlUp).Row Application.ScreenUpdating = False For i = 5 To i Range(wS1.Cells(5, "D"), wS1.Cells(i, "D")).Formula = _ "=COUNTIFS(wS2.Range("B7:B"&t),B5,wS2.Range("J5:J"&t),C5)" Next i Application.ScreenUpdating = True End Sub
SUBSTITUTE関数を教えてください。 この関数を使って、ある3つの文字を削除したいです。 例：仕事はサービス業（12350）　→　　仕事は12350 このように「仕事は12350」と表示させたいです。 宜しくお願いします。
iPhone を使ってます。アプリで表を作りたいです。MacのナンバーズNumbersとマイクロソフトのエクセルではどっちがオススメですか？罫線を入れたい時、ナンバーズはできません。本当にただ表に文字入れてくだけしか出来ません。文字の大きさや色、表の色付とかNumbersじゃできませんよね？ という事はマイクロソフトエクセルの方がいいのか、、、ここでiPhone やiPad からマイクロソフトエクセルを使う場合どんなデメリットがありますか？最新バージョンです。 乗り換え作業に苦労してます。
エクセルのReplaceで使える「?」(ハテナ)は、 ワイルドカードとして藻文字列としても機能するのでしょうか? Sub Sample() Range("a1").Value = "aaa" Range("a1").Replace What:="a?a", Replacement:="aba" Range("a1").Value = "aaa" Range("a1").Replace What:="a?a", Replacement:="aba?" End Sub を実行すると 「?」は、文字1文字のワイルドカードとして機能しつつ、 最後に「?」が付く事から、文字列として?が置換されていますが この区別ってないのでしょうか?
Excelのデータを印刷した際、貼り付けた図のサイズが印刷した際に変わります。 指定サイズで印刷したいので困っています。 「書式」でサイズを10cm×10cmと指定したとすると、実際のサイズは9.5cm×9.5cmくらいになります。 印刷の際には「拡大縮小なし」としています。 何が原因なのでしょうか？ご存知のかた、ご教示くださいませ。
「(1)商品番号の上2桁を読み取り合計を出す（例：ET，AK） 　(2)その合計金額が多い順に並べる」 というマクロを作成したいです。 ・・・・・・・・・・・・・・・・・・・・・・ No商品番号商品名販売数販売金額 1ET1010りんご21331382184 2AK8000みかん164106272 3GK2010キウイ8253136 4GN1020たまご7951192 ・・・・・・・・・・・・・・・・・・・・・・ ↑原本の表 ※商品番号の上2桁はET、AK、GKなどがあり、 　今後もその種類は増える予定。 イメージとしては、 マクロを実行した際に、添付画像の赤線で囲んだ部分が出てくる マクロを作りたいと考えています。 お教えいただけたらと思います。
お世話になります。 Excel2010 マクロ付きファイル(xlsm)を、設定変更等によってマクロを残したまま xlsxで保存する方法はありますでしょうか。
知恵をお借りしたく質問です。 Excel2013でシフトを作成しております。 同じ日付の列に同じ名前の人が重複する間違いが出てしまいます。 身体は一つだけですから、同じ日に記入されたら気づくようにしたいのです。 同じファイル内で数店舗のシフトを作成しているので 日付が店舗ごとに書いてあるので 同じ数字が列に出てきますがそれを回避して 記入した名前だけ重複があったら反応してほしい…。 このような都合のよい関数はあるものでしょうか？ よろしくお願いいたします！
毎週月曜日と木曜日に行っている、あるイベントの予約表を作成しています。 予約表のイメージですが、A4用紙の片面に次の項目が入ります。 (1)年月日 (2)曜日 (3)担当者名（担当者は月曜日・木曜日別の人） (4)予約表 １枚／日で、8～9枚／月必要になるので、同じ書式のものを9枚分作り、 毎月末に、二月先の分を１か月分プリントしようと考えています。 (1)については、 1枚目の年月日用のセルに二月先の第一月曜日の年月日を入力。 2枚目の年月日用のセルに、「1枚目の年月日＋3」と設定して→次の木曜日を自動表示。 3枚目の年月日用のセルに、「2枚目の年月日＋4」と設定して→翌週の月曜日を自動表示。 4枚目の年月日用のセルに、「3枚目の年月日＋3」と設定して→翌週の木曜日を自動表示。 5枚目の年月日用のセルに、「4枚目の年月日＋4」と設定して→翌々週の月曜日を自動表示・・・。 という方法で、一枚目の第一月曜日を入力すれば、2～9枚目までは自動的に表示されるというやり方にしました。 (2)については、曜日用のセルにWEEKDAY関数を使いました。 9枚とも曜日用のセルにWEEKDAY関数を入れて、表示されるやり方にしました。 (4)については、毎回変更することはないので、9枚とも同じ表を入れました。 問題は(3)です。 (2)の曜日に対応して、担当者を表示するためにはどうすればよいのでしょうか。 宜しくお願致します。 上記でお分かりかと思いますが、エクセルは素人です。 もし、(1)、(2)についてももっとスマートな方法がありましたら、教えてください。
エクセルの住所録をお客様から預かりました。 住所１の列には、「京都市～」 住所２の列には、「2003/1/10」 住所３の列には、「１－２－３」 のようになっていました。 この、「2003/1/10」の部分（表示形式は「標準」）、元が何だったか、直す方法はあるでしょうか？ 複数ありますので、また、これからのこともありますので、「2003/1/10」だけでなく、直し方を教えて頂きたいのですが・・・
こんにちは！Excelのことでお聞きしたいです。 文章を打ち込んで、修正しようと打ち直すと文字がセル内に入ってしまい次のセルに入力できません。セルを広げれば入力されているのですが、下手にセルを広げると下の行 に変な空間が開いてしまうし、そのまま次のセルまたいで修正して入力するにはどうしたらよいのでしょう？ 初歩的なことですみません。わかりやすく教えていただけると助かります。どうぞよろしくお願いいたします！
Windows10、Excel2016を使用しています。 自治会の祭りでくじ引きがあり、その管理をすることになりました。 Excelで当選くじを一覧表にし、引換券を持ってきた人を待たせないように、 添付図のような「当選者検索」画面を作ろうと思っています。 【仕様】 １．当選者一覧表は既に出来上がっている ２．[当選者検索]の街区に、引換券の街区を入力して［検索実行］をクリック ３．当選者の当該シート（5等～特等）を表示し、フォーカスを当てる しかしExcelについては詳しくなく、皆様のお知恵を借りるしかありません。 どうかよろしくお願いいたします。
エクセルのＶＬＯＯＫＵＰ関数で、通常は検索値は一意のものを指定しますが、範囲指定しているケースがありびっくりしてしまいました。これはどのようなことなのでしょうか？ 　　Ａ　　　Ｂ １　品名　　単価 ２　もも　　２００ ３　りんご　１５０ ４　みかん　１００ ５　なし　　　８０ とあり、 　　Ｃ　　　Ｄ　 １　品名　　単価 ２　なし ３　もも ４　みかん Ｃ列に入れた検索値で、上の表から単価を検索する場合、 通常　＝VLOOKUP（Ｃ２，＄Ａ＄２：＄Ｂ＄５，２，ＦＡＬＳＥ）といった感じで Ｄ２のセルに打ち込み、Ｄ２のセルの場合は、「検索値はＣ２」と固定している思うのですが、 ＝VLOOKUP（＄Ｃ＄２：＄Ｃ＄４，Ａ２：Ｂ５，２，ＦＡＬＳＥ）でも 同じ結果になっています。もちろんこれをそのままＤ４までコピーしても求める通りの結果が出てきます。 検索値は、式においては必ずしも一意で指定する必要はないのでしょうか？
あるセルに記入された文字と記号を組み合わせ、セルの値の合計を表示しようとしています。 データの入ったセルには「営業所h」と言う名前が付けられており、A1とA2には以下が記入されています。 A1 営業所h A2 営業所 〇 =Sum(営業所h)=13 〇 =Sum(indirect(A1))=13 × =SUM(INDIRECT(A2)&"h")=#REF! エラーが出た三つ目はどうすれば正しい式になりますか。 よろしくお願いします。
お世話になります。 同じような質問が今までもあったかもしれないのですが、 何と検索していいか分からず思ったような検索結果が 得られなかったので質問させていただきます。 エクセル2016を使用しています。 A列に商品コード B列に商品コードに対するカテゴリー（レディース服やスカート、カジュアルといったカテゴリーです）が一つの商品コードに対して複数入力されています。 （1つ～5つでバラバラです） それをA列に商品コード、B以降の列にカテゴリーが入力されている表にしたいのですが 可能でしょうか？（商品コードに対してのカテゴリーを横並びにしたいです） A列　　　　　　　B列　　　　　C列　　　D列 商品コード1234　レディース服　スカート　カジュアル 可能な場合どのようにしたらいいかお教えいただけないでしょうか？ よろしくお願いいたします。
IF関数を用いて以下のように場合、どのようにすればよいでしょうか。 条件は5つです。 ご教授をお願いします。 (1)A1のセルの値が300,000以上、400,000未満の場合、B1に5,000と表示 (2)A1のセルの値が400,000以上、600,000未満の場合、B1に7,500と表示 (3)A1のセルの値が600,000以上、800,000未満の場合、B1に10,000と表示 (4)A1のセルの値が800,000以上、1,000,000未満の場合、B1に12,500と表示 (5)A1のセルの値が1,000,000以上の場合、B1に15,000と表示
こちらの識者の方々にはいつもお世話になっています。 VBAの質問です。 環境は下記になります。 OS=windows7 pro 64bit Office=Excel2010(14.0.7128.5000) ・やりたいこと 下記コードにてF6:F35の範囲の文字列を全角に変換することができるようになりましたが、 別の範囲で別の処理を追加したい場合はどのように記述すればよいのでしょうか？ F6:F35=半角を全角にする H6:J35＝全角を半角にする という処理をしたいです。 Private Sub Worksheet_Change(ByVal Target As Range) 　Dim r As Range 　If Intersect(Target, Range("F6:F35")) Is Nothing Then Exit Sub 　Application.EnableEvents = False 　For Each r In Target 　　r.Value = StrConv(r.Value, vbWide) 　Next r 　Application.EnableEvents = True End Sub 質問に不備不足等ございましたらご指摘ください。 ご面倒お掛けしますがよろしくお願いします。
お世話になります Windows7、エクセル2016です。 概ね100000件には 到底達しない範囲の 件数不定で B列の3行目から下方に 店名●〇　、価格　157円、日付　2014/3/14。 店名×〇　、価格　305円、日付　2014/5/1。 店名●〇　、価格　156円、日付　2014/5/3。 等と、いったデータが 文字列で入力されています。 故あって 最安価格を読み出す必要がでた と、します 其処で =MIN(IFERROR(VALUE(MID($B$1:$B$100000,FIND ("単",$B$1:$B$100000)+2,FIND ("数",$B$1:$B$100000)-FIND ("円",$B$1:$B$100000)-2)),999999999999999)) と、してみました。 が、 上手く行きませんでした。 此の時 結果が何故か 999999999999999 と、なりました。 PF9で確認しても 同じでした 其処で 色々な場所に INDEX文を挟んで見ました ですが、だめでした =VALUE(MID($B$3:$B$10,FIND ("単",$B$3:$B$10)+2,FIND ("数",$B$3:$B$10)-FIND ("円",$B$3:$B$10)-2)) 此れをPF9で見ると ちゃんと値が出ていました また、 上記式を Ctrl+alt.+Enterで確定すると ちゃんと最小値が出ました にも、関わらず です。 何故でしょうか？ また、 C3に 日付形式で記載された 特定日以降の 直近最初の売買単価 其れを読み出そう と、 =VALUE(MID(OFFSET($B$0,MATCH(C3,INDEX(IFERROR(DATEVALUE(MID($B$3:$B$100000,FIND ("日",$B$3:$B$100000)+2,FIND ("。",$B$3:$B$100000)-FIND ("円",$B$3:$B$100000)-2)),0),,),-1)-1,0,1,1),FIND ("単",$B$3:$B$100000)+2,FIND ("数",$B$3:$B$100000)-FIND ("円",$B$3:$B$100000)-2)) と、してみました。 此の時、 MATCH文の最終項を1 と、すると 直近直前のデータが読み出されました が、同様に MATCH文の最終項を-1 と、すると データ候補が 目視確認できる にも関わらず 確かエラーが出ました 何故、こんな事に なるのでしょうか？ 以上2点、お教えください
添付した画像では、「エージェント名」である「CLIENT124」、「CLIENT127」が重複していますが、重複しているエージェント名をEXCELの関数を使用して抽出したいと考えていますが、 どのような方法で抽出することができるかご教示を頂けますでしょうか。 EXCELの関数を使用しなくてもできる方法があれば、そちらでも大丈夫です。 仮に、「エージェント名」の「CLIENT124」で重複が5個あった場合、、「エージェント名」のる「CLIENT124」を5個を出力するのではなく、「CLIENT124」を1個抽出したいと考えています。 重複しない「CLIENT119」などはもちろん抽出しません。
こんにちは。 エクセル2013で、印刷タイトルを使用しました。 印刷プレビューを確認すると、 印刷時に必要なページが印刷されるのは良いのですが、 添付画像のような印刷タイトルのみ表示された(データは空白)ページが1万ページほどあります。 空白のページに何かデータが入っていないか探しましたが、なさそうです。 とりあえずは印刷範囲を指定すればよいのですが…。 エクセルで印刷タイトルを使用すると、 データの終わりで自動的に残りをカットしてくれないのでしょうか？ 原因がわからないのですっきりしません。 OSはWindows10、Windows7両方で試しています。 どなたかアドバイスよろしくお願いします。
MicrosoftマイクロソフトのエクセルでマクロVBAをやりたいです。 プログラムがちょっとわかりません。 sheet1、sheet2、sheet3を参照します。各sheetの中は写真のようなデータが入ってます。 sheet1から始めます。 列Aの3行から23行までをみます。 ◯が書いてあったら、その行をsheet4に貼り付けます。 順次、23行まで繰り返します。 次のsheet2も同じ事を繰り返します。 次のsheet3も同じ事を繰り返します。 sheet4に◯が書かれた行の一覧が出来れば成功です。 可能でしょうか？ 出来れば、モジュールmoduleに貼り付けるだけで終わるようにプログラム教えてもらえますか？
グーグルスプレットシートを使用しております。 その中で下記のような場合、重複したセルを自動で色づけできる様にしたいです。 　　【A】　　　　　　　【B】 １　A株式会社　　　　　　Aさん ２　A株式会社　　　　　　Bさん ３　B株式会社　　　　　　Aさん ４　A株式会社　　　　　　Aさん 上記の図の「A1」「B1」：「A４」「B4」２つのセルの情報が他の行で一致した場合、重複がわかるように「行-1」と「行ー4」が指定の色で表示させたいです。 初歩的な質問になってしまいますが、教えて頂けますと幸いです。 宜しくお願い致します。
いつもお世話になります。 標記の件ですが、エクセルを共有で調査をしていますが、いつも、多数、入ると固まって見れなくなります。 共有者数は、100名程です。 最低限、バックアップはしようと考えています。 お知恵のある方、ご教授お願いします。 宜しくお願いします。
お世話になっております。 Excelの条件付き書式について質問です。 A1に『○』と入力されている場合、G1～R1に色をつける。 という書式をA2以降にも自動的に設定したい場合、一度に設定する方法はありますでしょうか。 A2に『○』と入力されている場合、G2～R2に色をつける。 A3に『○』と入力されている場合、G3～R3に色をつける。 ・ ・ ・ としたいです。 また、できれば行ごとコピー・ペーストした際に、自動で書式が入るようにしたいです。 （1行目をコピーして4行目に挿入した場合、同じく然るべき書式設定が入る） よろしくお願いいたします。
使用環境：OS　Win１０、IE11 Q1:データファイル名　＊．xlsxをクリックしてもOffice 2013 Excellが起動しない。word,Power pointは起動します。 Q2:同様に、FUJITSUのF-Linkのメニューバーに登録してあるExcellをくりっくしてもExcellが起動しない。Word,Powerpointは起動します。 Q3：コントロールパネル内の既定のプログラムで:>xlsxは、excell(デスクトップ）と表示され、設定されています。 果て、どの様に設定すれば良いでしょうか？
給与所得控除額の計算で以下の関数式を作成しましたが1千万円以上の金額を入力すると違う数字が計算されてしまうので教えてください。 =IF(C3=0,"",IF(C3<=1625000,C3-650000,IF(C3<=1800000,ROUNDDOWN(C3/4,-3)*4*0.6,IF(C3<=3600000,ROUNDDOWN(C3/4,-3)*4*0.7-180000,IF(C3<6600000,ROUNDDOWN(C3/4,-3)*4*0.8-540000,IF(C3<=10000000,ROUNDDOWN(C3*0.9-1200000,0),IF(C3<=15000000,ROUNDDOWN(C3*0.95-1700000,0)*C3-2450000)))))
得意先サブマスタ作成.xlsmというブック名でマクロを作成しています。 その中でCSVファイルを読み込んでエクセルへ変えて保存をしています。 With ActiveSheet.QueryTables.Add(Connection:= _ "TEXT;C:\Users\*******\Desktop\得意先変換マスタ.csv", Destination:=Range("$A$1")) '.CommandType = 0 .Name = "得意先変換マスタ" .FieldNames = True .RowNumbers = False .FillAdjacentFormulas = False .PreserveFormatting = True .RefreshOnFileOpen = False .RefreshStyle = xlInsertDeleteCells .SavePassword = False .SaveData = True .AdjustColumnWidth = True .RefreshPeriod = 0 .TextFilePromptOnRefresh = False .TextFilePlatform = 932 .TextFileStartRow = 1 .TextFileParseType = xlDelimited .TextFileTextQualifier = xlTextQualifierDoubleQuote .TextFileConsecutiveDelimiter = False .TextFileTabDelimiter = True .TextFileSemicolonDelimiter = False .TextFileCommaDelimiter = True .TextFileSpaceDelimiter = False .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1) .TextFileTrailingMinusNumbers = True .Refresh BackgroundQuery:=False End With Application.DisplayAlerts = False ActiveWorkbook.SaveAs Filename:="C:\Users\honb014\Desktop\得意先変換マスタ.xlsx", _ FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False Application.DisplayAlerts = True このコードで行っているのですが、実行すると当然ですがアクティヴなブック名は得意先 変換マスタ.xlsxになっています。 これを元の得意先サブマスタ作成.xlsmに戻す方法はありますか？ マクロでこの後に続く箇所で上記の得意先変換マスタ.xlsxを使用する際にエラーが出て しまい、このような質問をさせていただきました。 宜しくお願い致します。
銀行の振込金額が50,000円未満で100円　50,000円以上で150円だとします。 請求額を入れたときに、金額が50,000以上か未満か、手数料が先方もちなのか当方もちなのか 判断し振込金額（図のピンクのところ）が自動計算で出てくる式がありましたら 宜しくお願いします。
Excelでカレンダーを作る方は多くおられると思います。 なので祝日を入れる方法は「祝日を指定する範囲を作り、カレンダーの 日付とVLookUpでマッチングして判定する」と一般化されていますが、 祝日ではなく、ランダムに発生する休暇、それも「必ずしも昇順にソート されていない範囲」を参照して判定する方法はないでしょうか？ 具体的には、例えば「A1セルにある任意の日付（日付シリアルで設定） に対して、その日付がB1～B20にある任意の日付（昇順／降順でない ランダムな日付で、空欄もランダムに発生する）」と合致するかどうか を判定する関数式はないでしょうか？ IF文を20個入れ子にすれば出来ることは分かっているんですが、もっと スマートな方法があれば・・・。 識者の回答お待ちしています。
2007利用です。 IF関数で計算されたマイナス表記をゼロ表記にするやり方を教えてください。 例えば =IF(E4=“ “, “ ”,E4*0.0458) の計算結果がマイナス100になるとします。 この表記すなわち、マイナスになる結果はゼロに自動的に表記されるのが目的です。
エクセル2007をwindows7で使っています。 簡単なマクロを作ってクイックアクセスツールバーにビックリマークを選び、それにマクロを割り当てました。 それは良いのですが、同じパソコンにおいてある別のブックにもそのビックリマークが現れていて,おまけにちゃんと動作します。 二つはいらないのですがどうして目的外のブックにマクロが登録されてしまうのでしょうか。
エクセルのマクロでCSVファイルを読み込み、その行の得意先サブコードをキー項目として別のCSVファイルを検索し電話番号とFAX番号を取得するという作業を下記のようなコードで作成しました。 Dim Obj As Object Dim Path As String Dim FName As String Dim i As Long Dim buf As String Dim tmp As Variant Dim WSH As Variant Dim CN As ADODB.Connection Dim RS As ADODB.Recordset '自分のPCのデスクトップをPathとして設定します。 Set WSH = CreateObject("Wscript.Shell") Path = WSH.SpecialFolders("Desktop") & "\" '得意先マスタ.csvをOPENする際の準備処理 '3行目のPropertiesがCSVファイルの定義(excelをOPENする時とは異なります) Set CN = New ADODB.Connection CN.Provider = "Microsoft.Jet.OLEDB.4.0" CN.Properties("Extended Properties") = "Text;HDR=YES;FMT=Delimited" CN.Open Path '得意先サブマスタ.CSVを開きます。 Open Path & "得意先サブマスタ.csv" For Input As #1 i = 1 Do Until EOF(1) Line Input #1, buf tmp = Split(buf, ",") If i = 1 Then Else Cells(j, 1).Value = Left(tmp(3), 4) '会社コード Cells(j, 2).Value = Right(tmp(3), 4) '店舗コード Cells(j, 3).Value = tmp(3) '会社＠店舗 Cells(j, 4).Value = tmp(4) '得意先コード Cells(j, 5).Value = tmp(5) '店舗名 Set RS = New ADODB.Recordset RS.Open "SELECT * FROM 得意先マスタ.csv WHERE 得意先コード = " & tmp(4) & " ", CN If RS.EOF Then Cells(j, 6).Value = "???" Cells(j, 7).Value = "???" Else Cells(j, 6) = RS.Fields("電話番号") Cells(j, 7) = RS.Fields("FAX番号") End If End If i = i + 1 Loop このコードで動作確認すると途中で動作が止まってしまい応答なし状態になってしまいます。どこで止まるかは一定ではありません。CSVファイルの内容も確認したのですが、特におかしいような箇所はありませんでした。 OSはWINDOWS７、EXCELは2016です。 コード自体に修正した方がいいような箇所があればアドバイスいただきたいと思っております。宜しくお願い致します。
エクセルVBAについて。 ワークシートの印刷をVBAで行っています。　worksheets("○○○").printout ワークシートを複数印刷する際に、逐一　そのワークシートに画面遷移しないようにするには、どうすればよいでしょうか？ よろしくお願いします。 Excel2010以上
現在マイクロソフトのオフィス2007を使っています。中にエクセル2007、ワード2007、アウトルック2007、パワーポイント2007が入っているのですが、エクセル以外は使っていません。パック毎買い替えるのは結構高く、年金生活の私には勿体無いので、古くなったエクセルだけ2016にグレードアップしたいのですが、インストールの際、何か問題などが発生するようなことはありませんか？出来れば安く買えるところなども教えていただければ幸いです。
新規にエクセルのアプリケーションを立ち上げたら 「メモリ不足です。完全に表示できません。」と表示されました。 これは全てのエクセルを閉じたほうが良いのでしょうか？ またタスクマネージャーをみるとこんな感じなのですが これはエクセルがメモリを使い過ぎなのでしょうか？
「台帳」というExcelのブックに「リスト」「印刷用１」「印刷用２」「印刷用３」…というように複数のシートがあります。「印刷用１」…はVLOOKUP関数を用いて「リスト」に入力したデータを参照しています。 現在ユーザーフォームを用いてチェックを入れたシートを出力できるようになっているのですが、このユーザーフォームを利用してチェックを入れたシートをリンクを外した状態で１つのブックとして保存させる方法はないでしょうか？ 詳しく言うと、例えば「印刷用１」「印刷用３」をコピーして新しいブック（ファイル）を作成し、シート名はそのまま維持してファイル名は「A1」セル（全シート共通です）の内容に、加えてVLOOKUP関数で取得しているデータはリンクを外してテキストに変換し、現在のフォルダに保存するという作業をVBAを使用して自動化させたいのです。（上司の要望です） もともとあるユーザーフォームは前任者が作成したもので、当方はVBAは用語もろくにわからない全くの初心者ですので、詳しい解説も添えていただけると勉強にもなり非常に助かります。 よろしくお願いいたします。
A列に同じ文字が続くときに、該当するB列の数字を合計する関数をご教示お願い致します。 （例ではB4、B8、B9の合計で600）
いつもお世話になております。 エクセルでグラフの作成練習をしています。 積み重ね横棒は（どの棒グラフでもですが）上下のグラフの入れ替えはできますか？ 因みに　Windows１０で、Office　２０１３です。 宜しくお願いします。　
いつもこの掲示板でお世話になっています。前にアップした同名の質問のバリエーションです。 添付の画像にあるエクセル表で、縦軸は生徒の名前、横軸は6回行ったテストの各自の得点とします。前回の質問で、1回でも50点以上をとった生徒の合計を求めるのに =SUMPRODUCT((MMULT((B2:G6>=50)*1,ROW(A1:A6)/ROW(A1:A6))>0)*1) という方法を教わりましたが、このように作業列や配列数式を使わない方法で、「最初に50点に到達した回の全員の平均値」を求められないでしょうか。添付の画像の例だと、A君4回目、B君5回目、C君5回目、D君6回目、E君2回目なので、平均は4.4回となります。簡単にするために皆必ず50点以上はどこかでとっているとして構いません。 他の人の質問での回答で、最初に50点に到達した回数というのはA君の場合だと =INDEX(B1:G6,MATCH(0,INDEX(0/(B2:G2>=50),0),0)) または =MIN(INDEX((B2:G2<50)*10^5+B1:G6,0)) とすると個々には求められるのはわかっているのですが、作業列を使わずに1つの関数で全員分の演算をしたいのです。よろしくお願いします。
初歩的な質問ですいません下記のようなVBAを作成したいのですが、下記A列ですが、可変にしたい場合どうしたらいいかわかりません。ActiveCellでやるのでしょうか？よろしくお願いします。 　A 　　 1　りんご　　 2　みかん　　　　　 3　あんず　　　　　 4　あんず　　 5　みかん　　　　　 6　めろん　　 　↓ 　A 　　　 1　りんご　　 2　みかん　　　　　 3　あんず　　　　　 4　めろん　　　　　 通報する
初歩的な質問ですいません下記のようなVBAを作成したいのですが、下記A列ですが、は可変にしたい場合どうしたらいいかわかりません。ActiveCellでやるのでしょうか？よろしくお願いします。 　A 　　 1　りんご　　 2　みかん　　　　　 3　あんず　　　　　 4　あんず　　 5　みかん　　　　　 6　めろん　　 　↓ 　A 　　　 1　りんご　　 2　みかん　　　　　 3　あんず　　　　　 4　めろん　　　　　
エクセル関数でちょっと悩んでます。 sheet1にセルB4、C4、D4、B5、C5、D5(グループ1)とI4、J4、K4、I5、J5、K5(グループ2)にデータが入っているとします。 sheet2のB3、C3、D3、E3、F3、G3にグループ1のデータを記入します。 B4、C4、D4、E4、F4、G4にはグループ2を入れたいのですが、sheet1からみて列7つ移動したものとして記入したいです。どうやればいいですか？ 例えば、sheet2のB3には、=Sheet1!B4を入れれば反映されます。 sheet2のB4にはsheet1のI4を入れたいのですが、sheet1からみて列7つ移動した形でエクセル関数を使って表現したいのです。どうやればいいですか？ =Sheet1!B4＋？
エクセルで、セルの値に「virus」の文字列がある場合、「virus」と書く関数をFINDとMID関数で作ってみました。 =MID(C3,FIND("virus",C3),FIND("virus",C3)+4) この式だけだと、FINDの結果が無いときに、「#VALUE!」の文字が出てきます。この「#VALUE!」の文字を非表示にしたいと思い、IF文や条件付書式を試すのですが、「#VALUE!」は、長さ0の文字列””でもNULLでもないため、数式になりません。 良い方法をご存知の方教えてください。 よろしくお願いします。
Excel2007でExcel ADOによるCSVファイル処理をしています 対象はあるアプリからエクスポートした販売データで、月締め処理後の集計が主な内容です。 その際に、10年分以上ある全期間を対象にエクスポートすると時間がかかるので、 せめて前年度以前の分は年度締め時に一度程度、月締め時は当会計年度分に絞り時短を狙いたいのです そのようにして作った2つの販売データファイルから、全データを対象にした処理をするにはどうしたらよいでしょうか？ 一つのファイルに対して SELECT * FROM 全データ.csv AS 元帳 WHERE 諸条件 として動いている状態で、 SELECT * FROM ((SELECT * FROM 当年度データ.csv) UNION (SELECT * FROM 前年度以前データ.csv)) AS 元帳 WHERE 諸条件 のような形でいけないかと思ったのですが、「JOIN操作の構文エラーです」となりました (SELECT * FROM 当年度データ.csv AS 元帳 WHERE 諸条件) UNION (SELECT * FROM 前年度以前データ.csv AS 元帳 WHERE 諸条件) とすると一応は動くのですが、実際はもっと複雑なSQL文となっていることもあり、 対象データ（DB）をまず結合した上で、絞り込みや並べ替え等をやれたらと思っています 何かよい方法があれば教えてください
判定してセルを塗りつぶすマクロについて教えて下さい。 現在下記のようなマクロがあります。 Sub オニオン判定() Dim i As Integer, j As Integer, r As Integer Dim k As Double Range(Cells(17, 9), Cells(26, 14)).Interior.ColorIndex = 0 Range(Cells(30, 9), Cells(39, 14)).Interior.ColorIndex = 0 k = Cells(5, 2) 'B5セルの値 For j = 9 To 14 For i = 17 To 26 For r = 30 To 39 If Abs(Cells(i, j).Value - Cells(r, j).Value) <= 0.05 Then Cells(r, j).Interior.Color = vbYellow Cells(i, j).Interior.Color = vbYellow End If Next  Next   Next End Sub 対象のIf Abs(Cells(i, j).Value - Cells(r, j).Value) <= 0.05 Then で、それぞれ見比べて、0.05以上のずれがあるとセルが塗りつぶされないというマクロなのですが これを、If Abs(Cells(i, j).Value - Cells(r, j).Value) = 0 Thenという条件も追加して その時はセルを青に塗りつぶし、逆に0.05以上のずれがあるセルは赤に塗りつぶす。 みたいなマクロを書きたいです。 If Abs(Cells(i, j).Value - Cells(r, j).Value) = 0 Thenは一度追加してみましたが 上手く機能しませんでした。 やりたい事 ・数値が動いているけど、0.05以内の時は黄色 ・数値変動が0の場合は青 ・数値変動が0.05以上の場合は赤 です。 宜しくお願いします。
2007のエクセルを使っています。 「短い日付の設定」と「長い日付の設定」が同じYY/MM/DDとなっています。 この設定を変えたいのですが、どうすればいいかご存知のかたお教えください。
お世話になります。 Excel処理について質問です。 今、サーバで常にマクロが動き続けているExcelファイル(ファイルAとします)があります。 今回はそのファイルを閉じ、マクロにてシートの更新をしたのち、また開きなおしてマクロを実行させたいです。 方法としては、 1.C#から閉じて更新して開く処理を行う。 2.別のブックにファイルAを閉じる処理を行うマクロを仕込んでおき、 C#からはそのファイルを開くだけ。 が考えられると思っています。 どちらの方法でも良いので、コードの例を書いていただけないでしょうか。 ちなみに、自分の現状のコードは以下です。 (アラート非表示) for each wb in Workbooks if wb.Name <> ThisWorkbook.Name then wb.Close SaveChanges:=false end if next Application ThisWorkbook.Close SaveChanges:=false これでは、異なるブックのExcelファイルであっても、ウィンドウが分かれ てしまっていては、削除の対象になりません。 どなたか、宜しくお願いします。
エクセルでオートフィルタをされているデータを 昇順で並べ替えするコードを取得したのですが ActiveWorkbook.Worksheets("置換").AutoFilter.Sort.SortFields.Clear ActiveWorkbook.Worksheets("置換").AutoFilter.Sort.SortFields.Add Key:=Range("A1:A5203"), _ SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal With ActiveWorkbook.Worksheets("置換").AutoFilter.Sort .Header = xlYes .MatchCase = False .Orientation = xlTopToBottom .SortMethod = xlPinYin .Apply End With なのですが どれが並べ替えのコードなのでしょうか？ ActiveWorkbook.Worksheets("置換").AutoFilter.Sort.SortFields.Clear これはオートフィルタの並べ替えを解除するコードだと思いますが ActiveWorkbook.Worksheets("置換").AutoFilter.Sort.SortFields.Add Key:=Range("A1:A5203"), _ SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal これは何のコードでしょう？
Windows 8.1　Excel 2013で各月の出勤簿から賃金計算をしておりました。 これまでごOKWAVEで指導を頂きながら順調に出来ましたが、問題が発生致しました。 ここからが質問ですが、ご指導をお願い致します。 只今、作業中のExcelの表を掲載し説明を受けるのが筋ですが、Excelの表の掲載方法が判らないため長文になりますが文書にて質問させて頂きます。 Excelの表の各列・各行・セルの状況は下記の通りで、計算式(関数)が入っています。 ７行目は項目が入っており、 A列は月日・B列は曜日・C列は始業時刻・D列は終業時刻・E列は休憩時間・F列は勤務時間 ・G列は時間内勤務時間・H列は時間外勤務時間・I列は時間内支給額・J列は時間外支給額となっています。 ８行目から5月１日～３８行目が５月３１日となっています。 B列の曜日には、関数(=TEXT(A8,"aaa")(以下関数を示します)が入っており、A列に2016/5/1と入力すれば、自動的にB列に日曜日と表示されます。 C列・D列・E列の各セルの勤務時間は、手動で入力します。 F列の勤務時間には、5:00と入力し、=IF(COUNT(C9:D9)=2,D9-C9-E9,0) G列の時間内勤務時間には、12:00と入力し、=IF(B9="日",0,MIN($F$45,F9))保護あり H列の時間外勤務時間には、=F9-G9保護あり I列の時間内支給額には、=G9*24*$E$42保護あり J列の時間外支給額には、=IF(B9="日",H9*24*$E$43,H9*24*$E$44) 保護あり A列・B列は入力後、保護する。 C列・D列・E列は保護せず、手入力のみです。 それ以外は、関数が入っているので保護あり ４０行以降は、セルごとに関数が入っています。 C41セルに全勤務労働時間として、=SUM($F$8:$F$38) F41セルに全勤務労働時間として、=SUM($F$8:$F$38) C42セルに定時労働時間として、=SUM($G$8:$G$38) G４２セルに定時労働時間として、=SUM($G$8:$G$38) I４２セルに時間内支給額として、=SUM($I$8:$I$38) C43セルに休日労働時間として、 H４３セルに時間外勤務時間として、=$C$43 J43セルに時間外支給額として、=SUMIF($B$8:$B$38,$D$43,$J$8:$J$38) C４４セルに早出労働時間として、=SUM($H$8:$H$38)-$C$43 H４４セルに時間外勤務時間として、=SUM($H$8:$H$38)-H43 J44セルに時間外支給額として、=SUM($J$8:$J$38)-$J$43 C45セルに勤労日数として、=COUNT($C$8:$C$38) F45セルに契約時間として、固定で08:00 J45セルに定時労働時間支給額として、=I42 J４６セルに休日労働時間支給額として、=J43 J４７セルに早出労働時間支給額として、=J44 J４８セルに総支給額合計として、=SUM(J45:J47) D4３セルに休日労働時間検索のための、日 時給関係は、 　E４２セルに定時労働時間時給として、769円(変更があるので、保護せず) 　E４３セルに休日労働時間時給として、1,039円(変更があるので、保護せず) 　E４４セルに早出労働時間時給として、962円(変更があるので、保護せず) 現在、入力されている関数等は上記の通りです。 参考事項ですが、 日曜日以外は、平日の時給と同額で自動的に計算するように公式を入れていましたが、この度、祝日も日曜日と同額で計算するように関数を入れたいのですが、良い方法があればご指導をお願い致します。 勝手を申しますが、よろしくお願い致します。 説明不足で理解し難いかもしれませんが、よろしくお願い致します。 長文になりましたがご容赦下さい。 よろしくお願い致します。
ピクセルをセルと考えれば、 VBAマクロでできそうにふと思ったのですが、 教えて下さい
excelで検索用のボタンを作りたいのですがよくわからいのでご教授願えないでしょうか？ 内容は 検索ボタンをクリックしたら検索場所がsheet、検索対象が値に設定された状態でCtrl+Fの検索ボックスを開きたいと思っています。 若しくは上記の条件で検索できる検索窓とボタンがあればそちらでも構いません。 苦手分野なのでなかなかうまくいかず質問させていただきました。宜しくお願いします。
たくさん仕事をさせられなくて、すみますか？
こちらの識者の方々にはいつもお世話になっています。 VBAの質問です。 環境は下記になります。 OS=windows7 pro 64bit Office=Excel2010(14.0.7128.5000) ・やりたいこと "aaa、bbb、ccc","2016/07/01","2016/07/01" 上記文字列を変数tmpに取り込む場合どのように記述すればよいでしょうか？ ダブルクォートを含む場合はさらにダブルクォートを二つ並べてエスケープする。とあったので、 tmp="""aaa、bbb、ccc","2016/07/01","2016/07/01""" としたのですが通りませんでした。 このような場合の例文を教えていただけますでしょうか。 変数tmpはstring型で宣言しています。 質問に不備不足等ございましたらご指摘ください。 ご面倒お掛けしますがよろしくお願いします。
どのような表現でネット検索したらよいかわからないので、教えてください。 エクセルで担当者毎の報酬の支払額明細を作成しています。 ある１つのシートＡで各案件に対する共同担当者それぞれの報酬額を算出していて、 別のシートＢで支払額明細を作成するときに、 例えば支払額明細を担当者ごとに出す必要があるのですが、 担当者セルで氏名を選択すれば、シートＢの明細で示す各報酬額欄に シートＡにある各報酬額欄から引っ張ってくるのはどのようにすればよいのでしょうか？ 担当者が２人ならIF関数を使おうかと思ったのですが、３人以上になることも あるので、関数であれば何をどう使えばよいかわかりません。 よろしくお願いします。
Excelで重回帰分析をする時、切片を固定する事ってできませんか？ Excel2013を使っています。 x1,x2,yのデータがいくつかあって、 y=Ax1+Bx2+1 と1にするみたいに、x1,x2が0の時の切片をあらかじめ指定しておきたいのです。 切片の固定法が分かりません。 もし分かる方がいれば、教えて下さい。お願いします。 重回帰分析の仕方は Excelで、データ→データ分析→回帰分析 とやり方はわかっているのですが・・・
EXCELでA2からE6の5X5のテーブルに数値が入っていた時に、50以上の数が１つでも含まれる行の数カウントするという質問（実際にはもう少し複雑な質問でしたが本質だけに絞りました）を以前にした時に、「=SUM(IF(COUNTIF(OFFSET(A1:E1,{1,2,3,4,5},0),">=50")>0,1,0)) 」　という回答をいただきました。ここでOFFSET(A1:E1,{1,2,3,4,5},0)という表記がありますが、これはテーブルが5行の時には良いのですが、テーブルを縦方向に増やしていった時に対応ができません。例えばテーブルの行数（可変）がF1セルに入っていたとして、{}部分を置き換える表記はあるのでしょうか。 また、色々Webで探したのですが、そもそもOFFSET関数の中でで{}で複数行を指定（というか順番に演算していく？）するというものが見当りませんでした。どこか参考にするサイトはありますでしょうか。
COUNTIFSの複数条件で 男　または　女　の年齢層別の人数を検索するとき 検索条件の設定で ・10歳未満 ・10歳以上20歳未満 ・20歳以上30歳未満 ・30歳以上40歳未満 ・40歳以上50歳未満 ・50歳以上60歳未満 ・60歳以上70歳未満 ・70歳以上80歳未満 ・80歳以上90歳未満 ・90歳以上100歳未満 ・100歳以上 のすべてを条件としてドロップダウンリストにして設定するにはどのようにすればいいのでしょうか？ 例えば、画像のC19でドロップダウンリストで、30歳以上40歳未満を選択したときの人数をC21に表示させるということです。
COUNTIFSの複数条件で 男　または　女　の年齢層別の人数を検索するとき 検索条件の設定で ・10未満 ・10以上20未満 ・20以上30未満 ・30以上40未満 ・40以上50未満 ・50以上60未満 ・60以上70未満 ・70以上80未満 ・80以上90未満 ・90以上100未満 ・100以上 のすべてを条件として設定するにはどのようにすればいいのでしょうか？
Ａ列に名前が入っており、 Ｂ列に数字が入っております。 このＢ列の値が0より大きい場合に、 Ａ列のセルに色を付けたいのですが、 どうすればよいでしょうか？ Excel2013使用です。 よろしくお願いいたします。
エクセルで三角関数、数学関数、エンジニアリング関数、 複素数、フーリエ変換、ドモアブルの定理などに数値を 入力してその結果をグラフにしたいと思っています。 技術関係の参考書がいろいろ出版されていますが、どれが よいのかよくわかりません。 おすすめの参考書があれば教えていただけないでしょうか。 よろしくお願いします。
Excel(2013)を使っての、2次までの回帰分析の方法を教えて下さい。 x,yの値がいくつかあって y=1+ax+bx^2 という、2次までの回帰式を作りたいです。 図としては、下のような感じです。 方法が分からず困っています、お願いします
logn!がn logn-nで近似できると教科書に書いてあります。 Excelで、nはV78に1を入力し、オートフィルで、V127に50を入力しました。 W78からLN(FACT(V78))を、オートフィルで、W127まで計算し、 X78にV78*(LN(V78))-V78を、オートフィルで、X81まで計算したところ、 W78からW81と、X78からX81で、計算結果がちがいます。 自分の入力した数式に誤りがあると思います。どなたか御指摘お願いします。
エクセルのワークシート関数を勉強中です。よろしくお願いいたします。 Book1でBook2のデータを参照しています。Book2の参照範囲は名前の定義で「第X番」という名前で定義されています。Xは１－１０までの番号であり、第１番から第１０番までそれぞれ違う範囲を指しています。Book1のSheet1のA1セルに１－１０までの番号を入れ替えるだけでその番号の名前の範囲を自動的に参照する方法はありますか？
VLOOK関数はまったく無知ですので教えてください。 =if(E4="","",E4*0.2772) の場合、ifは何を、""は何を意味するのでしょうか？ たとえばＥ9セルにＥ8に2を掛ける式を表示させたい場合（通常計算では「＝Ｅ8＊2」の式）は =IF(E8="","",E8*2) で正しいのでしょうか？
Exel２００７についてです。　PCは新品で買ってから５年ほどたつTOSHBAサテライトを使用しています。Win７からWin10にアップしました。 １　アイコンをクリックするとPC画面の左上に写真１のような画面が出てきます。真ん中の四角を押すとやっとExelが画面に出てきます。 ２　Exelをしようするのですが、例えばA1のセルを選ぶと、画面の上の方に打ち込む画面が出ていたはずですが出てきません。 ３　Exel画面の大小も大（全画面）小（見えない）しかできません。 使用していて、すごく不便です。 ・打ち込み画面が出るようにしたい ・画面の大きさを任意の大きさにできるようにしたい。　　 以上２点教えてください。よろしくお願いします。
Excel 2003で同種の複数の表を作成してますが、特定の１表だけ下記のエラーが出て計算不能となります。 全てのセルを空白にしてもエラーが出てしまいます。 別のワークシートにシート単位のコピーをするとトラブルもコピーされてしまいます。 シ－ト全体を空白にしてもエラーが出ます。 対策も表示されますが処理が面倒で解決出来ません。 何かよい方法ないでしょうか。 ******************************************************************************************** （エラーの内容） 数式を計算できません。数式のセル参照は計算結果を参照 (循環参照) しています。次のいずれかを実行してください。 ? 循環参照を解決する場合は [OK] をクリックします。[循環参照] ツールが表示されるので、ツールを使用して数式を修正します。 ? 循環参照の詳細については、[ヘルプ] ボタンをクリックします。 ? 数式をそのまま使用する場合は、[キャンセル] をクリックします。
Excel(2010)で次の語句の入った列（ーは長音） あ ああ あー あああ あーー あい を昇順で並べ替えをすると、上記の順になります。長音は他の仮名とどういう序列（コード順？）になるのでしょうか？並べ替えは語句の字数にも依存するようにも見えるのですが、どうなのでしょうか。 また、Excelでの並べ替えのルールは他のいろいろのソート（たとえば図書館での本の並べ順）などにも適用されるのでしょうか。
桁区切りをマクロで追加したい。マクロ式の作り方が分かりません。宜しくお願いします。
Excel VBA 配列について質問させてください。 画像のようなコードですと、ケース1では問題なく動くのですが、 ケース2になると「インデックスが有効範囲にありません」 ケース3になると「型が一致しません」 となります。 セル範囲を配列に入れ、取り出す方法（ケース2） カンマ区切りの数字を配列に入れ、取り出す方法（ケース3） を教えてください。 よろしくお願いします。
EXCEL2007を使用しています。 下図のような表がありA3:F4の範囲の内、H3～H4の間に入る数値の個数を求めたいのです。 COUNTIFS関数でいろいろやってみたのですがうまくいきませんでした。 どなたかご教授いただければ幸いです。
よろしくお願いいたします。Excelプロダクトキーのカードを手に入れたのですが、 (1)意味が違ったのならすいません。2台のパソコンまでインストールできる？もしこれが本当なら、兄弟もパソコンもってるので、2人ともExcel使えるのでしょうか？一つのプロダクトキーで使う2人の人が使えることの弊害とかはないのでしょうか？ (2)インストール方法なのですが、 プロダクトキーをどの画面で入力すればいいのでしょうか？カードの裏に書いてあるURLにアクセスすると、ネットからのダウンロードで15000円ぐらいの値段が書いてあるサイトで持ってるのに怖くて先に進めません。手順を教えてください。よろしくお願いいたします。
お世話になります。 Excelマクロについて質問です。 バージョンは2010です。 Excelのあるシートにshapeオブジェクトがいくつも配置されており、そのある一つのshapeをダブルクリックしたときに、ある関数を動かす、といったイベントを設定したいのですが、やり方がわかりません。 BeforeDoubleClick等はありますが、それらはすべてアクティブシートのセルに対するイベントなため、私のやりたいことが満たされません。 私のやりたいこと… shapeをダブルクリックし、ユーザーが任意で名前を変えたり削除できるようにしたい。 また、右クリックによるコンテキストメニューの項目追加という方法でも問題ないのですが、excel2010での独自メニュー追加が不可能になったという記事を見ましたので、方法に困っています。 上記2つの方法で、わかる方、または他に良い方法がわかる方、ご返信お願いいたします…（；＿；）
フォルダをコピーして、名前を変更するマクロを教えて下さい P:\工程管理\AF UG というアドレスの中に KBB45033#○○○作業データ（原紙） というフォルダの名前があります。 またこのKBB45033#○○○作業データ（原紙）のフォルダ内には KBB45033#○○○加工データ KBB45033＃○○○進捗表 KBB45033＃○○○調整データ KBB45033#○○○面検データ という名前の4つのフォルダと KBB45033#○○○ばね厚.xls という名前の1つのファイルがあります。 さらに KBB45033#○○○加工データ のファルダ内には KBB45033計算シート_受光部用_#000-2_Ver1.02.xls という名前のファイルがあります。 エクセルシートのB3セルに105と入力し、マクロを実行した際に P:\工程管理\AF UGのフォルダに 上記に書いたフォルダ名や、ファイル名の○○○の所が105となって フォルダがコピーできるマクロを教えて下さい。 現在はネットで調べてKBB45033#○○○作業データ（原紙）のフォルダ名だけは 出来るようになりました。 サブフォルダや、その中にあるファイル名の変え方がわかりません。 Sub test_fs034_02()    Dim fso         As Object   'ファイルシステムオブジェクト    Dim strSrc     As String   'コピー元    Dim strDst     As String   'コピー先    'メインオブジェクトの生成    Set fso = CreateObject("Scripting.FileSystemObject")    'コピー元フォルダパスの設定    strSrc = "P:\工程管理\AF UG\KBB45033#○○○作業データ（原紙）"    'コピー先フォルダパスの設定（フォルダ名変更）    strDst = "P:\工程管理\AF UG\KBB45033#" & Range("B3").Value & "作業データ"    'フォルダのコピー（上書き）    fso.CopyFolder strSrc, strDst    'オブジェクト変数のクリア    Set fso = Nothing
セルに「2016年6月30日」と入力したいのに、表示はどうしても「2016/6/30」となってしまいます。 まず操作手順ですが・・・ 【書式】→【セルの書式設定】をクリック。 左側の「分類」は【日付】を選択しました。 右側上段には【サンプル】があり、下段には【種類】が表示されます。 下段の【種類】は上から3段目の「2012年3月14日」を選択し、 「OK」ボタンを押しましたが、表示は選択した形式に変更されません。 通常　書式設定の画面で上から3段目の「2012年3月14日」を選択すれば 【サンプル】の枠内も「2012年3月14日」と表示されるのでは？ 何かソフト（Excel）のトラブルなのでしょうか？ 解決策をご指導ください。
例えばC16:H16の数式の中で下位から2番めのセルの色を変えたい場合C16からH16を選択した状態で条件付き書式設定→新しいルール→数式を使用して、書式設定するセルを決定で =small(C16:H16,2) とやって書式を設定してOKをクリックしても変わらないのですがどのようにやったらできるのでしょうか
適切なタイトルでなくてすみません。添付の画像にあるエクセルの表があるとします。表１は、縦軸は生徒の名前、横軸は複数回行ったテストの各自の得点とします。　表２は、表１を検索して点数毎の人数を得るものです。（例では、1回でも20点以上とった人は5人、30点以上とった人は3人、40点以上とった人は1人を示しています）。表２のB12～B15の各セルに答えを入れます。 さて、B12～B15に入れる関数を知りたいのですが、作業列を作ってしまえば簡単にできてしまいますが、今回は作業列を使わないでこれを求めたいのです。いくら考えても良いアイデアが浮かびません。配列数式を使う場合と使わない場合と両方ともに解があるならば、両方とも教えてもらえないでしょうか。
関数である表の中から特定の列の数値を検索したいのですがどうしてもうまく行かず困っています。 うまく説明できないので画像添付しますのでご助力お願いします。
A列の数値が、たとえば、 A1セルが、10000～5000のときは、B1セルの数値を返す(5000)。 A2セルが、5000～3000のときは、B2セルの数値を返す(3000)。 A3セルが、3000～1000のときは、B3セルの数値を返す(1500)。 ・・・ とするには、どうすればいいでしょうか?
　質問させていただきます。どうぞよろしくお願いいたします。 環境：Excel2010でございます。 　If InStr(.Cells(line, 10), "test1") > 0 And InStr(.Cells(line, 10), "test2") > 0 Then'(1) だとIf文の中に入ってきてくれる状況でございます。 　If InStr(.Cells(line, 10), "test1") Then'(2) 　If InStr(.Cells(line, 10), "test2") Then'(3) の場合は両者ともIf文の中に入ってくるのに、何故 　If InStr(.Cells(line, 10), "test1") And InStr(.Cells(line, 10), "test2") Then'(4) だとIf文の中に入ってきてくれないのでしょうか？ 自分の考えでは、おそらく(2)も(3)もTrueを返してくれているので (4)の場合は　True and Trueで条件に合致するのでは、と思うのでございますが 条件を複数にすると(1)のように数字の比較にしてやらねばいけなくなるのかがよく分かっておりません。 （時々これに気づかずに(4)のようにコーディングしてしまってデバッグしなければいけなくなり手間がかかりますので、できれば理解しておきたい次第でございます。） 　もしお詳しい方がいらっしゃいましたら、どうぞよろしくお願いいたします。
シート1　A列（チェック欄）B列（会社名）C列（商品名） シート2　A列（チェック欄）B列（会社名）C列（商品名） というエクセルの表があります。 A列（チェック欄）は、 シート1のA列は「B列C列の内容がシート2と重複するもの」にチェック、 シート2のA列は「B列C列の内容がシート1と重複するもの」にチェック、 をいれています。 いずれも、B列C列がそろって重複している場合にのみチェックをしています。 B列のみ、C列のみの場合はチェックをいれません。 シート1 ☆　い社　りんご 　　い社　みかん 　　ろ社　みかん ☆　は社　ぶどう 　　に社　すいか 　　に社　りんご シート2 ☆　い社　りんご 　　ろ社　いちご 　　ろ社　すいか 　　ろ社　もも ☆　は社　ぶどう 　　に社　いちご というようなかんじです。 このA欄のチェックを自動でできるように関数を入力したいのですが、 どうすればよいでしょうか？
エクセルマクロ勉強中です。 いつも皆様のご回答をもとに勉強させて頂いております。 下記を行いたいのですが、うまくいきません。 AA列を検索（AA1から最終セルまでは空白セル無し）し、AA1からAEまでをコピー したいです。AEの最終行はAAで検索した最終行となります。 AA10が最終行であったならば、コピー範囲はRange("AA1：AE10")。 　　AA　　　　AD　AE 1　　1　　　　　0　空白 2　　1.5　　　　2　空白 3　　2　　　　　4　　0.0 4　　2.5　　　　6　　0.0 ・　　・　　　　　・　　・ ・　　・　　　　　・　　・ 11　　空白 Range("AA1", Range("AA1").End(xlDown).End(xlToRight)).Select Selection.Copy 上記ですとAD列までは選択されますが、AEまで列までを選択するには どうしたらよいのでしょうか？ ご教示頂きたく宜しくお願い致します。
king　soft　２０１６は office２０１３　Excel作成の　関数式まで 互換性があるのでしょうか？
添付のように、１２ヶ月分の売上高を表す表を作らないといけないのですが、 配色について全くどのようにしたら見やすくなるのか分かりません。 数字の部分は色を無しにしたほうが見やすいでしょうか？ もし色をつけるなら、どのような組み合わせなら見やすいでしょうか。。。 デザインに詳しい方教えて頂けませんでしょうか？ １月 ２月 ３月
エクセルで 　　A　　B　　　C　　　D 1　10　　223　　30 2　　　　15　　　20 3　　　　550　　　2 4　15　　56　　　33 5　　　　88　　　45 6　　　　11　　　5 7　　　　125　　　23 A2、A3、A5、A6、A7が空白の場合D2に１、D3に2、D6に1、D7に2、D8に3 番号を入れたいのですが、方法がわかりません、とても困っております。 最適な方法を教えてください。 　
エクセルの達人たちに質問したいのですが、 皆さんはどのようにショートカットキーを覚えたのでしょうか？ ショートカットキーでパパっと仕事ができるようになるための 近道があれば教えて下さい・・・
各セルにVLOOKUPの式が入力され文字の値がマッチしていたら文字値が反映されマッチしなかったら空白になる。文字が表示されているセルの個数を合計する関数がお解りになる方よろしくお願いします。 （A1~A5にVLOOKUPの計算式がありA3,A5に文字値が表示されほかの表示が空白の場合、文字値の合計２をA6に表示する）
新規にエクセルのアプリケーションを立ち上げたら 「メモリ不足です。完全に表示できません。」と表示されたのですが カラのファイルを立ち上げたのになぜこのようなエラーが出るのでしょうか？
以前質問した内容↓で、一旦解決したかに思えたのですが http://okwave.jp/qa/q9185441.html Set CN = New ADODB.Connection CN.Open "Provider=Microsoft.Jet.OLEDB.4.0;" & _ "Data Source=" & ThisWorkbook.FullName & ";" & _ "Extended Properties='Excel 8.0;HDR=YES'" CN.CursorLocation = adUseClient Sql = "SELECT * FROM T_訪問者 WHERE NOT EXISTS " & _ "( SELECT * FROM T_名簿 WHERE T_名簿.登録者名 = T_訪問者.訪問者名 )" Set RS = CN.Execute(Sql) Debug.Print RS.RecordCount 以上のようなコード（疑似です）で、 未登録データがないにもかかわらず、RS.RecordCountが1を返す場合があります Sql = "SELECT COUNT(*) FROM T_訪問者 WHERE NOT EXISTS " & _ "( SELECT * FROM T_名簿 WHERE T_名簿.登録者名 = T_訪問者.訪問者名 )" として、件数を出した場合も同様です。 RS.fields(0)などはNULLのままで何も入っていません 未登録データがある場合の抽出は全く問題ないのですが、 抽出数が0（登録済みデータだけ）なら通常処理、といきたいのに うまくいかず困っています。 何が悪いのでしょうか。
宜しくお願いします。IF関数なのですが、 例えば、A1～X1まで数字が記載されてるセルもあれば、記載されてないセルもあります。それかランダムに200行ぐらいまであるとします。そこで (1)例えばI列とP列、V列の数字の比較をするとして、I列を基準に考えるとします。 (2)I列に入力がなければ空白 (3)P列とV列両方共記載がなければ空白 (4)P列とV列どちらかに記載があればIと比較してI列の方が小さければ〇大きければ空白とします どのような式をつくればいいでしょうか？お力お貸し下さい。 (4)
別セルを参照している場合、縦に123と連続データの作成をすることはできますが、横に123と増やすことができません。 どうすればできますか？ 数字だけの連続データ作成はできるんですけど＝A1のように数値が入ってると横にスライドしても=A2、=A3と増えてくれません…
PIVOTで、計算枠外の「フィルター」（添付図での”TYPE"）を変更すると（ｂとしていたものをｄへ変更）、「値」（合計/金額、合計/個数）のB列、Ｃ列の幅が変わってしまいます。 この幅を動かないように、例えば１０ピクセルなり１５ピクセルなりに固定してしまうことは可能でしょうか。 どなたか御教示お願い致します。
エクセル2010です。 シート1とシート2は 同じフォーマットのデータが入ってるのですが シートで右クリックをし 「全てのシートを選択」し A列とC列を入力規則掛ける事は不可能ですか? リボンのデータを押すと入力規則が選択できません。 同じフォーマットのシートが30枚あるのですが 手作業で一つ一つやるしかないでしょうか?
よろしくお願いいたします。写真のように表のなかに数字が記載されてる所と空白の所があるのですが、I列とP列とV列の比較を、したいのです。その比較とは、 1番小さい数字を、抜き出したいのです。計算結果を求めるところは、表の終わった列でかまわないのですが、空白セルもあるのと、数字が入ってる人セルと無いセルがあるのでどのようにしたらいいのでしょうか？よろしくお願いいたします
【VBA】On Error をつけても「Matchプロパティを取得できません」を回避できません。 　今晩は、質問させていただきます。どうぞよろしくお願いいたします。 環境：エクセル2010でございます。 　下のようにコーディングしておりますが、「Matchプロパティを取得できません」が出てコード実行が中断されてしまいます。 取得できなかった場合の対処は既に（更にその下に）コーディングしておりますので、Matchのエラーをスルーさせたいのですが。。。 On Error GoTo error1 line1 = (Application.WorksheetFunction.Match(strTime, WS_data.Range("G:G"), 0)) 　　　　　　　　　'↑この行でエラーになります。 error1: On Error GoTo 0 　On Error GoTo error1をOn Error Resume Nextに変えても同じ症状になってしまいます。 もしお詳しい方がいらっしゃいましたらアドバイスいただけないでしょうか。 　どうぞよろしくお願いいたします。
マクロ初心者です。 今、下記の処理を行う事を考えていますが、Forでまわす事位しか浮かびません。 　　A　 B 1　20　 5 と入っていた時、A1/B1で4となります。 その解をループさせる回数とみなし、E1から順にE2以下 　　　 E 1 　　 0 2 　　 5 3 　　 10 4 　　 15 となるように、０から始まりセルB1の数を増分とした割り算で得られた解のだけ 下にシフトするような処理をしたいです。 　　A　 B 1　30　 6 と入っていた場合には、A1/B1で5となりますので 　　　 E 1 　　 0 2 　　 6 3 　　 12 4 　　 18 5 　　 24 となります。 何卒ご教示下さい。 宜しくお願い申し上げます。
自社の見積書は一行ずつ作っています。客先の書式にコピーしようとしていますが客先書式は１品目３行使っています（追加変更や原価などに対応するため）。 １．２.３行をオートフィルで下行にコピーすると行が飛んでしまってうめくできませんがよい方法はないものでしょうか。 エクセル2010です。
エクセル２０１０でやってみました。 A：2015/5/7 B：=MONTH(A2)、結果→1900/1/5 「５月」という値を出したいのですが・・。 どうすればよいでしょうか？
Win8.1からWin10にUpGしたところ、office2013のWord／outlookは正常に動くのですが、EXCELが起動できなくなりました。 Excelを起動させようとすると、全面白色画面となり数十秒(→で表示します)かかり、 １．”アドインK:\ExcelDT\ファイル名.xlsに関する問題が発生しました。解決には「このアドインを無効にして、更新プログラムが無いか確認しろ」今すぐこのアドインを無効にする？”で、 ２．「はい」をクリック ３．再びディスプレイ全面白色となり→→(警告音が聞こえた)→→”情報を回復する”とのメッセージ→→”Excel動作停止します”→ ４．Excelが自動で再起動→再び3項内容となり→ ５．「Excelは動作を停止した」のダイアログ、下段に「プログラムの終了」ボタンが表示される ６．プログラム終了ボタン↓でExcel起動前の画面となる。この間約2～3分。 表示されたExcelファイル種は「Excel97-2003」の旧タイプですが、Win10UPG前は全て正常に動作（読込み修正保存など）していました。 また、この度の異常動作はExcelアイコンからの起動、Excelファイルからの起動でも発生し、全くExcelの使用ができません。 更に、エクスプローラでExcelファイルを見ますと、ExcelDataフォルダー内の同ファイル他、ほとんどの更新日付が今日の日付に変更（更新）となって居ます。 （→→と時間が掛かっているのは、フォルダーにあるExcelファイル（約400本）を次々と読み込み、日付を更新しているためなのか？と思われます。ループ？)。 このExcelにアドインしているのは「郵便番号変換ウイザード」だけだったと思います。 K:\ExcelDT\はData専用ドライブ\Excel専用ファイルフォルダーとしております。 Excelが使えなくて困っています。至急お助けを！！。
B1:G6まで各セルに色塗りつぶしがあります。 I1:L1の各色と行ごとにのセル色がマッチしたら合計個数を表示したいのですが。 どなたかVBAでも関数でもお分かりなる方よろしく願います。
複数の項目・条件のある表を一つのグラフで 見やすく比較できるグラフの作り方をお教えいただけませんでしょうか。 例えば、添付の表のような場合、店舗・品名も区別がつきつつ、 売上金額の比較が分かり易い表を作りたいと思っています。 棒グラフ、折れ線グラフ、分布表、などなどグラフの種類が複数ある事は 存じておりますが、これらをどのようにグラフ化すれば良いのか分かりません。 それぞれのグラフ種類の使い方で、表現方法が変わることと思いますので、 いくつかの方法をお教えいただけましたら幸いです。
EXCEL２０１３で二つのファイルを上下または左右に並列して比較及び作業をしたいのです。 EXCELの以前のバージョンでは、一つのEXCEL枠内にシートだけを並列させることができたかと思います。 ところが、2013ではコマンドのヘッダー（リボン）部分まで含んだ、まったく二つのEXCELプログラムを起ち上げなければならないのでしょうか。これではスペースの無駄使いであると同時に、上のシートを作業するときは上のリボン、下の時は下、で、面倒でありまたしばしば混同してしまいます。 以前の様に、ひとつのEXCELの枠内に二つのシートを並列させて、ヘッダー部分もひとつで共有することはできないのでしょうか。
ExcelのA列に半角英数字のIDが入っています。 このA列のIDにダブりがあるかどうかをチェックし、 ダブりがあった場合にダブりがなくなるように削除するマクロを作成したのですが どのようにマクロを作成すればよいかわからず手詰まっております。 なお「0001」と「1」は別のIDとして処理をしたいです。 大文字小文字は区別しません。 ※できれば関数にしたいのですが、関数では削除ができないと思いましたので 　マクロで実現できればと思っています。 ぜひ教えていただければと思います。
メンバーが90人います。 アットランダムに３人ずつ選んで30チーム作りたいのですがどのような式が考えられるでしょうか。 今までは３０人ずつ３つのグループに分けROUND関数を使い30チーム作っていました。90人まとめてアットランダムに3人ずつ抽出して30チーム作りたいです。 EXCELのバージョンは 2010 SP2です。
エクセルマクロでワードへの差し込み印刷を行っています。 時々、ワード様式ファイルを二重起動してしまい、その結果読み取り専用で開くかとのメッセージで出て処理がストップすることがあります。 そこで 差し込み印刷を行う前に、ワード様式ファイルが開いているかどうか確認し、開いていれば一旦ワード様式ファイルを閉じてから、差込印刷を開始するように改良しました。 ところが、今度は、ワード様式ファイルを閉じる段階で 「〇〇.docに対する変更を保存しますか？ 保存　保存しない　キャンセル」のメッセージが表示され、処理がストップしてしまいます。 メッセージが出ない方法について数日、いろいろ試みましたがいまだできません。どなたかご教示のほどよろしくお願いいたします。 ★印の箇所が最後に試みたcordです。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Option Explicit Dim myxls, mydoc As String '---------------------- Sub 差込印刷() '---------------------- myxls = ThisWorkbook.Path & "\VBA差込元data.xls" mydoc = ThisWorkbook.Path & "\差込先ワード様式.doc" '↓Word差込印刷時の二重起動による休止を避けるためのcode On Error GoTo ErrorHandler '↓差込先ワード様式.docが既に開いていると次行でerror75が発生、ErrorHandlerに飛んで注意を促す。 Name mydoc As mydoc '-------- Word差込 '-------- Exit Sub ErrorHandler: '↓★ここで差込先ワード様式.docを「保存」「保存しない」「キャンセル」の確認ウィンドウが表示されてしまう。★ Let Application.DisplayAlerts = False '★←これを書いても無駄だった★ GetObject(mydoc).Application.Quit Let Application.DisplayAlerts = True '★ Resume End Sub '----------------- Sub Word差込() '----------------- Dim objword, wddoc As Object Set objword = CreateObject("Word.Application") '←Wordオブジェクトを作成 With objword .Visible = True '↓Wordドキュメントオブジェクトを作成→指定ワード文書が読み込まれた。 Set wddoc = .Documents.Open(Filename:=mydoc) End With '---------------------------------- With wddoc.MailMerge '↓フルパスでよろしくね！ .MainDocumentType = wdFormLetters .OpenDataSource Name:=myxls, _ Connection:= _ "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & _ myxls & ";Mode=Read;Jet OLEDB:Engine Type=35" _ , SQLSTATEMENT:="SELECT * FROM [sheet1$]" '----------------------- Dim rc As Integer rc = MsgBox("人数分のワードのページを作成しますか？" & vbCr & _ "【は　い】・・人数分のページを作ります。" & vbCr & _ "【いいえ】・・ページをつくりません。(Word様式原本のみ作成)", vbYesNo + vbQuestion, "確認") If rc = vbYes Then '----------------------- '下記3行により[個々の文書の編集]まで一気に .ViewMailMergeFieldCodes = False .Destination = wdSendToNewDocument .Execute '----------------------- wddoc.Close '←word原本・Wordドキュメントオブジェクトを閉じる。 Set objword = Nothing Set wddoc = Nothing End If '----------------------- End With '---------------------------------- End Sub
エクセルでデータを20秒ごとに区切りたいのですが、どうすればよいでしょうか 経過時間 0 0時00分04秒 0時00分20秒 0時00分33秒 0時00分43秒 0時01分01秒 経過時間 0 0時00分04秒　00-20 0時00分20秒　00-20 0時00分33秒　20-40 0時00分43秒　40-60 0時01分01秒　60-80
コマンドプロンプトからエクセルを起動させられるのでしょうか？ であれば、コードを教えていただけますか？
添付の表のように、左の列の番号が続く部分に、 オートシェイプでカッコをつけたいのです。 実際の表は700～800行くらいあり、 番号が続く箇所が複数点在し、大きさもまちまちなため、 手動で図形を入れていくのが大変です。 よい方法がありましたら教えてください。 よろしくお願いします。
excel2010 (ブック名A.xlsx)にシート名SA、シート名SBがあります。 シート名SAのC列に検索対象(C1～C50位)があり シート名SBのB列が検索範囲(流動的ですがB1～B100位の範囲)です。 検索対象は文字列で、これが検索範囲のセルにに含まれていた場合 検索範囲の隣のセルCxxに検索対象文字列をコピー＆ペーストしたいです また、検索範囲の行数に値があるまで、順次処理をしていきたいです
エクセルマクロ初心者です。 今、下記を行いたいのですがうまくできず困っています。 sheet2のA列に 　A 1 1603 2 1605 3 1609 4 1604 5 1609 6 1604 7 1606 ・ 　 ・ ・ 　 ・ と年月が数千行入力されています。 各年月の数をカウントし、sheet1の年月が入力されているセルの下に sheet2でカウントした数を入力していきたいです。 　　　C　　　D　　　E　　　F　　　G　　　H　　　I　　　　J　　　K・・・　　 6　1603　1604　1605　1606　1607　1608　1609　1610　1611・・・ 7　　30　　 65　 　52　　　68　　36　　105 　48　　　98　　87・・・ 目的はsheet1への入力結果をもとに、月別グラフを作成する事です。 sheet1にカウントした数さえ入力できれば、あとはなんとかなりそうです。 何卒宜しくお願い致します。
ExcelでVBAで設定値を書いたシートを参照する際に、 Shell Worksheets("設定").Range("B1") と、書くのが見にくいので、名前付き参照で見やすくできないかと試してみたのですが うまくいきません。 ※名前付きセル範囲は手動で作って、"ブック"という範囲扱いになっているようです。 標準モジュールのテスト関数で Public Sub test() MsgBox Range("起動Path").Value End Sub とすると正しく文字列が表示できるのですが、 同じ事をSheet1モジュールのダブルクリックイベントに入れたらエラーとなります。 ※上記のMsgBox文をイベントの途中にコピペしてみました。 ちょっと理由がよくわからないので、どなたかお助けくださいませんでしょうか…
データの対象列内に数式で出された値1と手動で入力した値1がある場合 集計されたら、下記のように1が2つになってしまいました。 1　12345円 1　6789円 これを2つではなく1つにまとめたい場合、どのようにすれば解決しますでしょうか。 どうかよろしくお願い致します。
A列にある契約先にある特定の文字列が含まれていた場合、B列に1か2の値を返したいです。 A列に契約先　(株)○○、(有)○○、（同）○○、（独）○○、（財）○○、○○大学、（同）○○ B列に契約先の種類を1と2で区別して、1か2の値を返したいです。 調べた結果、IF　COUNTIFだと文字列の条件は一つに限るとの事で、文字列を複数にしたい場合どのような数式で値が返せますでしょうか。 下記のような数式ではだめでした。 =IF(COUNTIF(A1,"*(株)*",A1,"*(有)*",A1,"(同)"),"1","2") ちなみにCOUNTIFSというのもだめでした。 ほかにIF関数で文字列の複数条件で1か2を返せる数式がありましたら教えてください。 よろしくお願い致します。
Windows10 です。満８０歳の後期高齢者です。幼稚なことですがお教えください。 　エクセルで、何とか統計資料の最小値を求めることができました。 　式は；　　=MIN(C8,C13,C18,C23,C28,C33,C38)です。　実際の式はもっと長いです。 　しかし、当然かもしれませんが、セルに「０」があるとき、「０」が求められます。 　そこで、「０」を求めなくしたいのですが、いろいろ調べましたができません。 　「０以外の最小値」を求める関数式をお教えください。
エクセルで次のような表のデータが１ヶ月分、31日分あり ます。すなわち31枚のシートに同じ表で中の○× の内容が違うデータがあります。 ア イ ウ エ オ (1) ○ × × ○ ○ (2) ○ ○ ○ × × (3) × × ○ ○ ○ (4) ○ × × ○ ○ そして○をゼロ、×を1と数えて、 31枚のシートの○と×を集計して 32枚目のシートに結果を示したい のです。 例えばこんな感じ32枚目のシート に計算結果を表示したいです。 ア イ ウ エ オ (1) 7 4 5 0 0 (2) 8 5 0 2 2 (3) 1 1 0 1 0 (4) 0 0 4 6 8 31枚のシートの○と×を数値に 変換し、それを串刺し集計した いのです。countifは串刺し集計 で使えないようですし、上手い やり方があれば、教えて戴き たいです。 宜しくお願い致します。
EXCELで数列の中から上位１０件と下位１０件を除いて平均値を出す方法があるでしょうか。
添付の様な100人の元データSheet1（氏名、年齢、性別）から、Sheet2の30歳代～90歳代の年齢層別の男女の人数をExcelの計算式で求めたいのですが、残念ながら私の能力ではどんな式を使ったら良いのかわかりません。 識者の皆さん、教えてくださいませんか？
マクロで線の色を指定したいのですが、上手くいかず困っています .ForeColor.RGB = Worksheets("sheet1").Range("F2").Interior.ColorIndex 赤色を指定したいのですがBにどういうコードを入れれば良いですか？ FはVlookupで列Bより色を指定するようにしています。 マクロは始めたばかりで良く分からないので、他に必要な情報もわかりません 必要な情報なども併せて教えてください。 よろしくお願いします。 Dim rngStart As Range Dim rngEnd As Range Dim BX As Single, BY As Single, EX As Single, EY As Single Set rngStart = Worksheets("sheet2").Cells.Find(What:=Worksheets("sheet1").Range("D2"), LookIn:=xlValues, LookAt:=xlWhole) Set rngEnd = Worksheets("sheet2").Cells.Find(What:=Worksheets("sheet1").Range("E2"), LookIn:=xlValues, LookAt:=xlWhole) BX = rngStart.Left BY = rngStart.Top EX = rngEnd.Left + rngEnd.Width EY = rngEnd.Top With Worksheets("sheet2").Shapes.AddLine(BX, BY + 10, EX, EY + 10).line .ForeColor.RGB = Worksheets("sheet1").Range("F2").Interior.ColorIndex .Weight = 3 .EndArrowheadStyle = msoArrowheadTriangle End With
EXCEL2010を使用しています。 添付画像の「重複行削除　前」の表を、RemoveDuplicatesで下の様にコードを組んで A列で重複する行を見て重複する行を削除しています。 Public Sub 重複行削除() 　With WorkSheets(1) 　　.Range(.Cells(1, 1), .Cells(8, 3)).RemoveDuplicates _ 　　　　　Columns:=1, Header:=xlYes 　End With End Sub すると、日付の新しいデータが削除され、古いデータが残ってしまいます。 （添付画像の「重複行削除　後」） ReniveDuplicates Columns:=Array(1,3) とした場合は、すべてのデータが残ってしまいます。 添付画像の「欲しいデータ」の表の様に、 日付の新しいものを残すように重複行削除は出来ないでしょうか？ 詳しい方、どうか教えてください。 よろしくお願いします。
Excel 2013のセルにハイパーリンクでJPEG画像を設定したとき、ブラウザのIE11で開いてしまいます。 しばらく前まではWindowsフォト ビューアーが開いていました。 JPEG画像の関連づけは拡張子を(JPG)に指定してあります。 どうしてもWindowsフォト ビューアーで開くようにしたいのですが。 Windowsフォト ビューアーでないと←→ボタンで前後の画像を表示できません。 どうすればいいのでしょうか？ ちなみにJPG画像をダブルクリックすれば「Windowsフォト ビューアー」で開きます。 OSはWindows7、32ビット、ブラウザはIE11、Excel 2013です。 よろしくお願い致します。
Windows Vista Office2007　です。 Sheet　1　で計算した結果のみをコピーして、 Sheet 2 の任意セルへ貼り付けたいと思います。 計算結果のセルを右クリックして、「形式を選択して貼り付け」を クリックしたいのですが、「形式を選択して貼り付け」が活きていません。 どのようにすれば宜しいのでしょうか。 よろしくお願いいたします。
Excelで文字の表示で例えば、Aなら関数で組むならAと認識され、表示上はA君というように君をつけたいのですが、そういったことってできますか？宜しくお願いします。
Excel2010です。 ヘッダーの右側に文字を入れるのですが、1文字左にずらしたいのです。Excelのヘッダーの右側はもともと配置が「文字列を右にそろえる」に設定されているようで、位置を変えられません。左側は「文字列を左にそろえる」に設定されているようですが、スペースキーで右にずらすことができます。ヘッダーの右側は、左に位置をずらすことはできないのでしょうか。サイトで調べたのですが、それについての記載はありませんでした。 よろしくお願いいたします。
お世話になります。 面談.xlsというブックがあります。 このブックの中には一番左に[集計]というシートがあり、右隣から[個人別面談 田中],[個人別面談 山本],[個人別面談 高橋],という個人別のシートが複数あります。(可変です) やりたいこと (1)[集計]シートに[集計開始]というボタンを設置してクリック (2)右隣の[個人別面談 田中]シートを読み込む (3)[集計]シートのB1に[個人別面談 田中]のA1を挿入 [集計]シートのB2に[個人別面談 田中]のB1を挿入 [集計]シートのB3に[個人別面談 田中]のC1を挿入 (4)次の[個人別面談 山本]シートを読み込む (5)[集計]シートのC1に[個人別面談 山本]のA1を挿入 [集計]シートのC2に[個人別面談 山本]のB1を挿入 [集計]シートのC3に[個人別面談 山本]のC1を挿入 (6)次の[個人別面談 高橋]シートを読み込む (7)[集計]シートのD1に[個人別面談 高橋]のA1を挿入 [集計]シートのD2に[個人別面談 高橋]のB1を挿入 [集計]シートのD3に[個人別面談 高橋]のC1を挿入 (8)完了! ※[集計開始]ボタンをクリックすると[集計]シートB1～D3の値は毎回クリアする仕様にしたいです 環境 Excel2013 会社でこのような仕組みをVBAで作れと言われましたが当方初心者で困っています。 どなたかお知恵をお借りできませんでしょうか？ よろしくお願い致します。
こちらの識者の方々にはいつもお世話になっています。 関数の質問です。 環境は下記になります。 OS=windows7 pro 64bit Office=Excel2010(14.0.7128.5000) ■やりたいこと 図のような元リスト(A1:F13)があり、それを人ごとのリスト(H1:L13)で集計したい。 I2:L13に関数を入力し集計したいのですが、どのような関数を入れればいいか教えていただきたい。 ■定義と条件 ・A列の日付とB列の項目を結合した値はユニークです（5月1日のりんごは1行しかないことは担保されています） ・同様にC1:F1の値もユニークです ・元リストの条件指定の引数で(C2:C13)は使いたくない 　（人ごとにシートがあるので、H1の値によって取得する値を変えたい） このような場合どのような関数を使えばよいでしょうか？ 質問に不備不足等ございましたらご指摘ください。 ご面倒お掛けしますがよろしくお願いします。
宜しくお願いします。Month関数で、例えば2016年3月1(木)を関数で曜日を無くす最善の方法はなんでしょうか？マクロ組みたいので編集せずに、する方法はありますか？又、取り出して、Month関数でやってみたのですが、2016年3月1日が1月3日になってしまいます。どうしたらいいでしょうか？よろしくお願いします。
エクセル初心者です。極々初歩的質問でお恥ずかしい限りですが、何方かご教授宜しくお願い致します。 Exsel2013の「Sheet1」に「連絡先一覧」を、「ページレイアウト」→「サイズ」→「A5」に設定、「余白」→「最後に適用したユーザー設定」に設定しました。「Sheet1」には「破線」でページサイズが表示されていましたので、その範囲内に入力し「余白」も「印刷」ページで確認問題なかったので、「Sheet1」に10件ほど、入力し「名前を付けて保存」しました。 後日保存した「ページ」を開くと、「ページレイアウト」→「サイズ」が「ユーザー定義用紙」になっており、「A5」サイズでは開けなくなっていました。 私の、使い方のミスでしょうか？「A5」サイズで開くにはどのようにすれば良いでしょうか？ ご指導宜しくお願い致します。
Excel 2013 において、ブックの読み書きをするフォルダの既定値(カレントフォルダ？)を、例えば、添付図に示すものにする場合は、何処でどのように設定するのでしょうか？教えてください。 キーボードからシコシコ文字をタイプするより、マウスでツンツンとフォルダを辿って行く方法を期待しています。 コンピュータ－ ▶ ローカルディスク(D) ▶ Users ▶ Mike ▶ My Documents ▶ NewsGroup
よろしくお願いします。 アンケート集計で未記入の空白セルをカウントしたいと思っています。 アンケート結果をどんどん足していく形なので、countbrankでやろうとすると範囲指定がうまくいかず困っています。 例 記入シート 行列　A　B　 １　aaa bbb ２ ccc ３　ddd　eee ４　fff　　 ５　ggg　bbb ６　 7 　※6以降は今後追加していく※ 集計シート bbb　2 eee　1 未記入　２ 記入してある者についてはcountifで作れました。 記入行のみの空白セルの集計方法のご教授お願いします！！！
ピボットテーブルの総計は通常合計になります。これを差にすることは出来ますでしょうか。 列ラベルの差を総計に表示することは出来ますか。 イメージを添付します。
=ROUNDDOWN(ROUNDDOWN(AI3,-3)*0.0545,0)の関数があり、AI3のセルには745,583の数字があり、この関数では40,602となるが、この数字に0.4を乗算して小数点切捨てで16,240の数字になる関数式を教えてください。よろしくお願いいたします。
請求書のような物を印刷用フォームに転記して印刷したいのでお知恵をお貸し下さい。 添付画像の上部が一覧表で、それを下の帳票（帳票は実際には別シートにあります） に転記して印刷したいです。 振込金額以外の項目は、仕入先コードを元にvlookupのみで簡単に出来ますが、 画像のように5月・6月・7月…と連続データになっているため、金額だけが上手く 転記できません。 「仕入先コード1」の「5月」の金額…という風に指定したいのですが、方法が わかりません。 vlookupの列番号を、金額の所だけ変えればよいのは分かっていますが、 私以外の人も使えるように、もう少しスマートな方法がないものか？と思います。 理想は、帳票のセル「J4」辺りに「○月」と入れる項目を作り、それとB5の コードを元に金額を自動転記できたらいいなと思います。 目的さえ達成できれば、全く違う手段を提案いただいても構いません。 よろしくお願いいたします。
=ROUNDDOWN(AI5,-3)＊0.109/5の関数があるのですが、小数点以下を切捨てにしたいので教えてください。 AI5のセルには896,958の数字がありこれで計算すると19,533になってしまいますので、19,532にしたいので、よろしくお願いいたします。
Excelに関して質問です。 複数の列に入力されている文字を一つの列にまとめる方法が知りたいです。 その際、文字が入力されていない箇所は詰めて並べたいと思います。 範囲はB4～AD８３の間です。 ただ、状況として範囲内の空白には書式（関数）が入っている状態です。 例 　A　　　B　　　C　　　　　D　　　E １文字１　空白　文字２　　文字３　　空白 ２空白　文字４　文字５　　空白　　　空白 F 文字１ 文字２ 文字３ 文字４ 文字５ 何卒、ご教授よろしくお願いします。
http://okwave.jp/qa/q9176289.html の続編ですが… ファイルを開く過程で何やらサインインを求められたので、私の Microsoftアカウントとパスワードを入力したところ、添付図のようなメッセージに見舞われました。 Office 365 とは？サブスクリプションとは？何のことかサッパリです。 インストールを手伝ってくれた MS Answer Desk のお姉さんは、作業中に類似の言葉を発せられなかったのですが・・・ 私はどうしたらよろしいのでしょうか？ ひょっとして、インストールしたのが「Excel 365」というバージョン？！ 【自戒】我慢、我慢、・・・
パソコン上の Excel 2013 で作成したブックを、最近 MS Answer Desk のお姉さんのご指導でインストールしたスマホ上の Excel (バージョン不明←無料のもの)で[開く]を試みたところ、添付図のメッセージが出て開くのに失敗しました。 当該ブックは50枚以上のシートからなりますが、「カメラツール」を使った覚えがありません。Excel さんがどの部分のことを“仰っている”のかを見極める方法を教えてください。 【参考】 MS Answer Desk にバージョンと操作マニュアルを問い合わせたところ、電話に出た担当者は「分からない」、「MSコミュニティか、有料の技術サポートへどうぞ」と言い、MSコミュニティに先の対応も含めて質問したら「無料のものにそんなものはない。答えてくれただけたマシ、難しいということであれば使わない方がよい」との回答でした。(ションボリ)
sheet1の内容 A列　　　　　　　B列　　　　　　電話 名前１　　　　　メルアド１　　電話１ 名前２　　　　　メルアド２　　電話２ 名前３　　　　　メルアド３　　電話３ これを sheet2の内容 A列 名前１ メルアド１ 電話１ 名前２ メルアド２ 電話２ 名前３ メルアド３ 電話３ ・・・というように　 sheet1のメールアドレスリストを sheet2のA列に　名前　メルアド　電話　の 順で縦に並べたいのですが　関数だとどうなりますか？ メールアドレスリストは　200件以上あります。 =Sheet1!A1 =Sheet1!B1 =Sheet1!C1 を２００個以上も手打ちでしょうか。
excel2013を使用しています 表現が難しいので、添付図を介してご説明いたします。 シート２に添付図のようなデータがあります、全部で1000行位のデータがあります、シート１：C2（入力規則を使用しています）種類を選択時シート１、B6を起点に、該当した種類のデータのみシート１図のように表示させたいです教えてください。 （例）、シート１C2＝机, C6:D19には、シート２B2:C15のデータを表示 　　　　シート１C2=テーブル、C6:D12には、シート２B16:C21のデータを表示
ＭＳアンサーデスクへの電話が繋がらないので、ここで質問させていただきます。 Win7 Pro SP-1 の私のパソコンに Excel 2013 をインストールして使用しています。 当該パソコンには、家族のために、複数のユーザーアカウント(ゲストおよび私を含む家族３名)を設定しています。ゲスト以外は各自でログインパスワード設定。 さて、私自身は難なく Excel 使用できておりますが、私がログオフしている状態で、私以外の家族が各自のアカウントでログインして Excel を操作(使用)することは可能(許されるの)でしょうか？ ＹＥＳなら、そのための設定方法等を教えてください。
Office 2016のEXCELについて質問いたします。 別のファイル（先月のシフト表）のセルを、今月のシフト表のセルにコピーしたさい、 セルの中の名前は正しく貼り付けできましたが、　先月のセルについていたドロップダウンリストがコピー・貼付けできていませんでした。 どこの設定を確認して、再設定するとドロップダウンリストの内容もコピー・貼付けできるのでしょうか、御指導をお願いいたします。 　パソコンはWindows 8.1・　Office 2016を活用中です。
今日の朝方に質問した内容を再度、上げさせていただきます。 内容の説明が上手く出来ていなかったため、異なる回答をいただいてしまったためです。 現在、添付した画像のような表を作っています。 E列はリスト名（項目名）、I列からO列は曜日になっていて、 ○が付いている日はその項目を処理する日になります。 例：リストAは月・火・水・木に処理/リストBは水のみ処理 ここはリストの基本情報的な部分です。 AC列以降は管理部分で、横軸カレンダーになっています。 ここで該当する曜日にステータスが立つ仕組みにしたいのですが、 何を組んでよいのか全く分からないので、ご教授願いたいと思います。 ※例として1をステータスに見立てています） ※4/29の先は4/30（木）,5/1（金）,5/2（土）と進んでいくかたちになっています。 完成形はリストAはこの先4/27,4/28,4/29にステータス1、 リストBは4/29にステータス1が自動的に付くような形になります。
EXCELのActiveXのチェックボックスを使用して、下記のようなことができるのか。 また、できるのであれば、方法を教えていただければと思います。 他の方法でこちらのほうが最適などあれば、教えていただければと思います。 表の入力をする際 添付のようにチェックボックスにチェックを入れるとabdfの項目の下に◯が入力されるということをしたいです。 直接入力することが有りますので、関数を入れることが出来ません。 ご回答の程よろしくお願い致します。
お読みくださり、ありがとうございます。 エクセル初心者でございます。 エクセルのマクロなのですが、 お詳しい方、是非教えて欲しいです！汗 調子に乗って入力フォームなるものを作りました。 入力フォームの中にて、チェックボックスで「ある」「なし」の項目を入れてみたのですが、チェックしていないのに、値が入る現象が起きています汗 以下、素人が書いたコードを恥を承知で記載させていただきます。 Private Sub CheckBox1_Click() If CheckBox1.Value = True Then OK = "○" End If End Sub Private Sub CheckBox2_Click() If CheckBox2.Value = True Then NO = "×" End If End Sub Private Sub UserForm_Click() End Sub '以下のコードは、登録ボタンがクリックされたときの処理！ Private Sub 登録ボタン_Click() If TextBox1.Text = "" Then MsgBox "グッズ名を入力してください。" Exit Sub End If If TextBox2.Text = "" Then MsgBox "アプローチ先を入力してください。" Exit Sub End If With Worksheets("協賛グッズ") With Cells(Rows.Count, 2).End(xlUp) .Offset(1, 0).Value = TextBox1.Text .Offset(1, 1).Value = mori .Offset(1, 2).Value = mori2 .Offset(1, 3).Value = TextBox2.Text .Offset(1, 5).Value = TextBox3.Text .Offset(1, 6).Value = TextBox4.Text .Offset(1, 7).Value = TextBox5.Text .Offset(1, 8).Value = TextBox6.Text End With End With TextBox1.Text = "" TextBox2.Text = "" TextBox3.Text = "" TextBox4.Text = "" TextBox5.Text = "" TextBox6.Text = "" CheckBox1.Value = False CheckBox2.Value = False End Sub 以上です。 おかしなところ満載かと思いますが、 チェックを入れた項目だけ値を入れたいと考えております。 おわかりになるかたおりましたら何卒お助けください汗 よろしくお願いいたします。
添付画像のように 横軸の範囲が違う線を１つのグラフの中にまとめて入れたいです。 線の縦、横の単位は全て同じです。 （添付画像で言うと 　一番左の線の横軸範囲は70～110、真ん中が110～170、右が170～290） どのように作れば良いのでしょうか？ （使用excel：2007）
標準形式のセルに、例えば「2+3」や「15*64」、「34/5」などのように先頭に＝(イコール)のない四則計算が入力されています。 その計算結果を表示させたいのですが、何か方法はありますか？ 計算結果は別のセルに表示させるのでも構いません。 少なければ手入力で＝を付けても良いのですがセルの数が100前後あるので、なんらかの方法がないかお尋ねしてみました。 よろしくご教授ください。
下記のCSVデータから、希望の表形式にしたいです。 ご教授ください。 【CSVデータ】 A列　　　　B列　　　　　C列　　　　　D列　　　 　E列 タイトル　　(1)　　　　　(2)　　　　　(3)　　　　　 (4) 1　　　　　　0 　 100 　 150 　 0　 2　　　　　100 　 0 　 150 　 0　 3　　　　　　0 　100 　 0 　 100　 4　　　　　　0 　 100 　 150 　 0　 5　　　　　100 　 100 　 150 　 0　 【希望の表形式】 A列　　B列　　C列 1 　　 (2)　　100 　　　　(3)　　150 ２　　　(1)　　100 　　　　(3)　　150 ３　　　(2)　　100 　　　　(4)　　100 【希望の表形式】は多少違う形でも構いません。 作成方法は関数やピポット、なければ（マクロ）で教えてください。 宜しくお願い致します。
セルＡに１７と入力すると、セルＢに２９７と表示させたいのですが、どのような数式を使用すれば宜しいですか。これはガス料金でセルＡは使用した数でセルＢは料金です。 分かりにくい質問で申し訳ございませんが、宜しくお願いします。
Excelで名簿を作っております。（添付画像参照） 顧客表のようなもので、「氏名・来店日・購入金額」の一覧です。 このなかで、３回以上来店された方の氏名（セル）に色を付けたいと思います。 方法を教えていただけますでしょうか。 Excel2013を使用しています。 よろしくお願いいたします。
Office 2016のEXCELの関数の修整方法が判りません。 膨大なEXCELのソフトの入力を引き受けましたが、 入力したシートのどこを間違ったのか、 結果を表示するシート：結果の複数のセルに　 #REF!　と表示されます。 結果を表示するシートの夫々の関数は、 O84セルは　='調整'!I11 086セルには 　#REF　と表示されています。 o88セルは　='調整'!I21　 o90セルは　='調整'!I26　 近くのセルは M84セルは　='調整'!I10 M86セルは　='調整'!I15 M88セルは　='調整'!I20 M90セルは　='調整'!I25 という関数が設定されています。 O104セル・O122セル・O144セル・O162・O180セルにも　#REFと表示されます。 O86セルカーソルを置いて、 = 次に　シート名：調整の!I16セルにカーソルを置いてから、 I26セルに戻りますと '='調整'!I16　と　　'　が前について　セルに表示し、1行目の上の関数を表示する欄は空白です。 =の前の　'　を削除・消す方法が判りません。 気づいたのは、　 #REF!　と表示するのは、 シート名　調整 の 16行に関係する　シート：表示の O列に共通しています。 御指導をお願いいたします。
Excel2013です。 文字列から"(1234)"というIDを切り出してセルに文字として書き込みたいのですが、 警告(数値が文字列として書かれている)が出てしまいます。 処理は問題ないのですが、全体に挙動が重たくなってしまいます。 ' をつけたり" ～ " でくくったりと試してみましたがうまくいきません。 今は"ID(1234)"と接頭語をつけて回避しています。 できればExcel自体の設定はそのままに、このセル内容は明示的に文字列とする (警告を出さない)方法は有りますでしょうか？
EXCELのTEXT関数でマイナスのときの記号は「-」ではなく「▲」をつけるようにしたいのですが、TEXT関数で以下のように記述するとエラーになってしまいできません。 いま入力しているセル値は下記です。B1の値をTEXT関数で▲100と表示させたいです。TEXT関数の表示形式には、セルの書式設定を参考にユーザー定義に記載のある「0;"▲ "0」を入力しています。以上、よろしくお願いします。 　A1の値は-100 　B1は=TEXT(A1,0;"▲ "0)
Excel2010 を使用しています。 設定した範囲（1～10行）のセルを右クリックしたときに出るショートカットメニューを表示しない様な設定にしたく、 　Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean) 　　Dim myRowTop As Long , myRowBottom As Long 　　myRowTop = 1 　　myRowBottom = 10 　　If ActiveCell.Row >= myRowTop And ActiveCell.Row <= myRowBottom Then 　　　Application.CommandBars("Cell").Enabled = False 　　Else 　　　Application.CommandBars("Cell").Enabled = True 　　End If 　End Sub としました。 これで通常問題ないと思いますが、 A1 : F10 を「テーブルとして書式設定」し、この範囲のセルを右クリックしたとき、 ショートカットメニューが表示されてしまいます。 CommandBars([Index]) の Index が違うのかと思い、試してみましたが、直りませんでした。 どなたか詳しい方、どうか教えてください。 よろしくお願いします。
Excel のバージョンは問わず、 [セルの書式設定]→[配置]→[横位置]→[両端揃え]の使い方が分かりません。 どういう場合に、どうしたいときに使えば、その効果がナルホドと納得できるような、 正しい使い方および結果をスクリーンショット付きでお知らせください。
A列に日付、B列に曜日、C列に記号が入力されている表から 曜日後との記号の個数を出したい時にSUMPRODUCTを使っていますが、 曜日の表現の仕方が悪いのか、しっかりカウントされません。 解消方法が分からないので、教えていただきたいです。 A列　B列　C列 4/1　金　　a 4/1　金　　a 4/2　土　　p 4/3　日　　a 4/3　日　　a 4/8　金　　e 【作りたい状態】 　　a　e　p 金　2　1　0 土　0　0　1 日　2　0　0 ※元の表の曜日はA列の日付に依存して、aaaで表記しています。
Access2002を使っていて、印刷ボタンを押したら、下記のような見たことのない画面になり、 「コンパイルエラー　end function が必要です。」というメッセージが出てきました。 どなたか詳しい方、修復の方法を教えて下さい。よろしくお願いします。 Private Function PfDataMake() As Boolean 'On Error GoTo Err_PfDataMake Dim St_Sql As String Dim Ln_Cnt As Long Dim Rs_Cnt As Recordset Dim Rs_Cnt2 As Recordset Dim In_Cnt As Long Dim End_Flg As Boolean Dim Code1 As Long Dim Gokei As Long Dim Gohan As Long Dim Okayu As Long Dim Josyoku As Long Dim Kizami As Long Dim ChoKizami As Long Dim GenEn As Long Dim Kome As String Dim Okazu As String Dim Enbun As String Dim Hiduke As Date Dim Youbi As String 'W_発注食数合計の初期化 St_Sql = "Delete From W_発注食数合計 ;" DoCmd.RunSQL (St_Sql) 'W_発注食数明細の初期化 St_Sql = "Delete From W_発注食数明細 ;" DoCmd.RunSQL (St_Sql) '///// 対象データを抽出 ///// St_Sql = "SELECT * " St_Sql = St_Sql & "FROM W_配食入力 " '/// 20060423追加 出力対象「前日キャンセル」追加 start /// 'St_Sql = St_Sql & "WHERE W_配食入力.キャンセル = 0" 'St_Sql = St_Sql & "WHERE (W_配食入力.キャンセル = 0) or (W_配食入力.キャンセル = 2)" St_Sql = St_Sql & "WHERE (W_配食入力.配達 <> 3) and (W_配食入力.配達 <> 4)" '/// 20060423追加 end /// St_Sql = St_Sql & " ORDER BY W_配食入力.利用者コード ;" '件数を取得 Set Rs_Cnt = CurrentDb.OpenRecordset(St_Sql) Ln_Cnt = Rs_Cnt.RecordCount End_Flg = False 'レコード無し判定 If Rs_Cnt.EOF = True Or Rs_Cnt.BOF = True Then End_Flg = True End If Gokei = 0 Gohan = 0 Okayu = 0 Josyoku = 0 Kizami = 0 ChoKizami = 0 GenEn = 0 'ループ処理 Rs_Cnt.MoveFirst Hiduke = Rs_Cnt("日付") Youbi = Rs_Cnt("曜日") Do Until Rs_Cnt.EOF = True Gokei = Gokei + 1 Select Case Rs_Cnt("米") Case 1 Gohan = Gohan + 1 Kome = " " Case Else Okayu = Okayu + 1 Kome = "おかゆ" End Select Select Case Rs_Cnt("おかず") Case 1 Josyoku = Josyoku + 1 Okazu = " " Case 2 Kizami = Kizami + 1 Okazu = "刻み" Case Else ChoKizami = ChoKizami + 1 Okazu = "超刻み" End Select Select Case Rs_Cnt("減塩") Case 1 Enbun = " " Case 2 GenEn = GenEn + 1 Enbun = "減塩" End Select Code1 = Rs_Cnt("利用者コード") St_Sql = "SELECT D_利用者.シメイ " St_Sql = St_Sql & "FROM D_利用者 " St_Sql = St_Sql & "WHERE D_利用者.利用者コード = " & Code1 St_Sql = St_Sql & " ORDER BY D_利用者.利用者コード ;" '件数を取得 Set Rs_Cnt2 = CurrentDb.OpenRecordset(St_Sql) Ln_Cnt = Rs_Cnt2.RecordCount St_Sql = "INSERT INTO W_発注食数明細 VALUES (" & Code1 & "," St_Sql = St_Sql & "'" & Rs_Cnt("利用者氏名") & "','" & Rs_Cnt2("シメイ") & "'," St_Sql = St_Sql & "'" & Rs_Cnt("主食") & "','" & Rs_Cnt("副食") & "'," St_Sql = St_Sql & "'" & Kome & "','" & Okazu & "','" & Enbun & "'" St_Sql = St_Sql & ") ;" DoCmd.RunSQL (St_Sql) Rs_Cnt.MoveNext Loop St_Sql = "INSERT INTO W_発注食数合計 VALUES ('" & Hiduke & "'," St_Sql = St_Sql & "'" & Youbi & "'," & Gokei & "," & Gohan & "," & Okayu & "," St_Sql = St_Sql & Josyoku & "," & Kizami & "," & ChoKizami & "," & GenEn St_Sql = St_Sql & ") ;" DoCmd.RunSQL (St_Sql) 'レコードセットの終了 Rs_Cnt.Close Rs_Cnt2.Close Exit Function Err_PfDataMake: Resume Next
Access2002を使っていて、印刷ボタンを押したら、下記のような見たことのない画面になり、 「コンパイルエラー　end function が必要です。」というメッセージが出てきました。 どなたか詳しい方、修復の方法を教えて下さい。 Private Function PfDataMake() As Boolean 'On Error GoTo Err_PfDataMake Dim St_Sql As String Dim Ln_Cnt As Long Dim Rs_Cnt As Recordset Dim Rs_Cnt2 As Recordset Dim In_Cnt As Long Dim End_Flg As Boolean Dim Code1 As Long Dim Gokei As Long Dim Gohan As Long Dim Okayu As Long Dim Josyoku As Long Dim Kizami As Long Dim ChoKizami As Long Dim GenEn As Long Dim Kome As String Dim Okazu As String Dim Enbun As String Dim Hiduke As Date Dim Youbi As String 'W_発注食数合計の初期化 St_Sql = "Delete From W_発注食数合計 ;" DoCmd.RunSQL (St_Sql) 'W_発注食数明細の初期化 St_Sql = "Delete From W_発注食数明細 ;" DoCmd.RunSQL (St_Sql) '///// 対象データを抽出 ///// St_Sql = "SELECT * " St_Sql = St_Sql & "FROM W_配食入力 " '/// 20060423追加 出力対象「前日キャンセル」追加 start /// 'St_Sql = St_Sql & "WHERE W_配食入力.キャンセル = 0" 'St_Sql = St_Sql & "WHERE (W_配食入力.キャンセル = 0) or (W_配食入力.キャンセル = 2)" St_Sql = St_Sql & "WHERE (W_配食入力.配達 <> 3) and (W_配食入力.配達 <> 4)" '/// 20060423追加 end /// St_Sql = St_Sql & " ORDER BY W_配食入力.利用者コード ;" '件数を取得 Set Rs_Cnt = CurrentDb.OpenRecordset(St_Sql) Ln_Cnt = Rs_Cnt.RecordCount End_Flg = False 'レコード無し判定 If Rs_Cnt.EOF = True Or Rs_Cnt.BOF = True Then End_Flg = True End If Gokei = 0 Gohan = 0 Okayu = 0 Josyoku = 0 Kizami = 0 ChoKizami = 0 GenEn = 0 'ループ処理 Rs_Cnt.MoveFirst Hiduke = Rs_Cnt("日付") Youbi = Rs_Cnt("曜日") Do Until Rs_Cnt.EOF = True Gokei = Gokei + 1 Select Case Rs_Cnt("米") Case 1 Gohan = Gohan + 1 Kome = " " Case Else Okayu = Okayu + 1 Kome = "おかゆ" End Select Select Case Rs_Cnt("おかず") Case 1 Josyoku = Josyoku + 1 Okazu = " " Case 2 Kizami = Kizami + 1 Okazu = "刻み" Case Else ChoKizami = ChoKizami + 1 Okazu = "超刻み" End Select Select Case Rs_Cnt("減塩") Case 1 Enbun = " " Case 2 GenEn = GenEn + 1 Enbun = "減塩" End Select Code1 = Rs_Cnt("利用者コード") St_Sql = "SELECT D_利用者.シメイ " St_Sql = St_Sql & "FROM D_利用者 " St_Sql = St_Sql & "WHERE D_利用者.利用者コード = " & Code1 St_Sql = St_Sql & " ORDER BY D_利用者.利用者コード ;" '件数を取得 Set Rs_Cnt2 = CurrentDb.OpenRecordset(St_Sql) Ln_Cnt = Rs_Cnt2.RecordCount St_Sql = "INSERT INTO W_発注食数明細 VALUES (" & Code1 & "," St_Sql = St_Sql & "'" & Rs_Cnt("利用者氏名") & "','" & Rs_Cnt2("シメイ") & "'," St_Sql = St_Sql & "'" & Rs_Cnt("主食") & "','" & Rs_Cnt("副食") & "'," St_Sql = St_Sql & "'" & Kome & "','" & Okazu & "','" & Enbun & "'" St_Sql = St_Sql & ") ;" DoCmd.RunSQL (St_Sql) Rs_Cnt.MoveNext Loop St_Sql = "INSERT INTO W_発注食数合計 VALUES ('" & Hiduke & "'," St_Sql = St_Sql & "'" & Youbi & "'," & Gokei & "," & Gohan & "," & Okayu & "," St_Sql = St_Sql & Josyoku & "," & Kizami & "," & ChoKizami & "," & GenEn St_Sql = St_Sql & ") ;" DoCmd.RunSQL (St_Sql) 'レコードセットの終了 Rs_Cnt.Close Rs_Cnt2.Close Exit Function Err_PfDataMake: Resume Next
エクセルのSAMIFで、0入力をした場合、そのゼロを表示させたいのですが、どうしたらいいでしょうか？ 現状は、例として挙げると、１０の項目があり、そのうち７個に０を含めた数字が入力されており、別シートにてifを使って、””の時は表示しないようにしてSUMIFを使用しています。しかし、この方法だと０入力をしてももちろん参照先には表示されません。 しかし、この０入力をしたところを0と表示したいのです。しかし、入力されていないところは空白のままにしたいのです。 そして、sumifは、１０の項目がよく順番や名前が変わるので、SUMIFは外せません。（一覧から自動で検索して、計算してくれるので） この場合はどうしたらいいでしょうか？ 自分が今入力している内容はこちらです。 =IF(SUMIF(火!$C$2:$G$86,$B6,火!$E$2:$E$86)=0,"",SUMIF(火!$C$2:$G$86,$B6,火!$E$2:$E$86)) 申し訳ありませんが、ご回答のほど、よろしくお願いします。
Excel2002を使っています。 設定方法を教えてください。 セルA1には『東京都』と予め文字が入力されています。 セルA2　 　 セルA3 セルA4 セルA5 セルA6 には、その日のデータを入力するのですが、人名が入ります。 そして、セルA7には関数　=COUNTA(A2:A6）が入っています。 例えば、該当者が二人居る場合は、 セルA2　中村　　 　 セルA3　佐藤 セルA4 セルA5 セルA6 セルA7　2　が入ります。 もし、該当者が居ない場合、 セルA2　NIL　 　 セルA3 セルA4 セルA5 セルA6 セルA7　0　が入って欲しいのです。 セルA2には、該当者が居ないと言う意味で『NIL』と入力します。 セルA3～A6は空白のままにします。 当然、セルA7には、1　が入りますが、そこを0にしたいのです。 要は、NILはカウントしたくないのです。 NIL以外はカウントしたいです。 うまいやり方があったら教えてください。 どうぞよろしくお願いします。
Excel2002を使っています。 セルB1に、数式　=A1　を設定しています。 さらに、セルB1には、セルの書式設定で、ユーザー定義　"*** " @ " ***" を設定しています。 セルB2は、数式 =A2 セルB3は、数式 =A3 ・ ・ ・ （上記のユーザー定義は B列に設定されています。） セルA1に『チョコレート』と入力したら、 セルB1には、『*** チョコレート ***』と表示されます。 もし、セルA1が空白の場合『*** ***』が表示されます。 でも、セルA1が空白なら、セルB1も空白にしたいのですが、その方法はありますでしょうか？ よろしくお願いします。
添付画像より Ｅ６：ｄ6×a6　と設定しています。 手計算なら１６１８０になります。 １６１７６は計算過程の問題だとおもいますが、どのように設定すればいいのでしょうか？ ツール→オプションをみてもよくわかりません。 お詳しい方、宜しく願います。
エクセルのIF関数で、以下のようなことを教えてください。 A1=1の場合はりんご。 A1=2の場合はみかん。 A1=3の場合はいちご。 上記以外の場合は空白。 できれば、具体的に操作がわかるようなサイトも教えてください。 よろしくお願いします。
Excelの散布図を使い、株価やFXのローソク足を作成しました しかし、クライアントの要望で、X軸の幅を５ｍｍ Ｙ軸の最小単位の高さを1mmにしてほしいという要望あり X軸の方は時間軸なのでできたのですが Y軸の方は一つのパターンで実現できても、日足や月足または 別の通貨にしたり、株価に転用すると価格帯も変わるために 自動的に範囲が決まり、たとえば1円＝1mmに常になるようには どうしても実現方法が思いつきません そもそも実現できるのでしょうか？
エクセル２００７ですが、あるセルに数値を入力するのですが、その数値が０、または、空欄だった場合、そのセルの右隣の２セルに右上りの斜線を自動的に引かれる設定にしたいのですが、条件付き書式だと斜線が選べず困っております。　マクロやVBEでも結構ですが、何かいい方法があれば教えて頂けますか？
Excel(2010)で、Ａ列に縦に　山田　鈴木　田中　山田　鈴木　山田 というように氏名の並べてある表があるとします。この表で氏名の頻度が 山田　3 鈴木　2 田中　1 というように表示できる関数または方法があるでしょうか。 この表のように項目が少なければ 山田 鈴木 田中 というセルを作っておいて、VLOOKUP関数で求められますが、実際には約500行ありその中の氏名をすべて手作業で入力するのは大変ですので、重複なくすべての氏名を抜き出すのは実際的ではありません。 以上よろしくお願いします。
以下の事象に困っています。 1．エクセル10を使用しております。職場の先輩が代々受け継いで使用してきたエクセルシートをいつもと違う他のＰＣで展開したところ、ファイルを展開する前に以下の表示が出てマクロが止まり展開できません。 「コンパイルエラー：プロジェクトまたはライブラリがみつかりません」 2．マクロの内容 ↓この一行目のところで停止し、何回も同じエラーが出ます。 Function XVLOOKUP(検索値, 範囲, 列番号, エラー時の表示値) On Error Resume Next With WorksheetFunction 戻り値 = .VLookup(検索値, 範囲, 列番号, False) End With If Err <> 0 Then 戻り値 = エラー時の表示値 End If XVLOOKUP = 戻り値 End Function 3．このマクロを削除してシートを展開し、あるセル1列全部が=Xvlookupという関数を参照し、Ｎ／Ａになっています。新たに＝Vlookuｐ関数を入れてもうまく作動しません。 4．正常にファイル展開、Vlookupを参照できる方法をお教えください。 以上
例えばセル A1 を[コピー]して、セル A3 に[貼り付け]操作を実行すると、セル A3 のフィルハンドルの傍に添付図の赤矢印で示す(私に取っては)邪魔なアイコンが表示されます。 其処で質問です。 １．このアイコンが表示される目的は何ですか？ ＿＿ついでながら、「此れ便利！」と思われる方はいらっしゃいますか？ ２．常に表示されないようにする設定法は？
こちらの識者の方々にはいつもお世話になっています。 関数の質問です。 環境は下記になります。 OS=windows7 pro 64bit Office=Excel2010(14.0.7128.5000) ・やりたいこと 図のようなリスト(A3:G7)があり、りんごやバナナなどの項目ごとに誰がいくつか集計したい（A11:C14） B12:C14の範囲に関数を入力して数字を導き出したいのですが、 その際の関数の範囲はA4:G7を指定したいのです。 （りんごの列の関数の範囲はA4:G5、ばななの列の関数の範囲はA6:G7という風に分けたくない） Aに1列追加して A4=りんご担当 A5=りんご個数 というような集計用の列を作成することは可能です。 このような場合どのような関数を使えばよいでしょうか？ もし可能であれば集計用の列を追加した場合としない場合、両方の関数を教えていただければ幸甚です。 （集計用の列をどのような値にするかも併せて教えていただけますでしょうか） 質問に不備不足等ございましたらご指摘ください。 ご面倒お掛けしますがよろしくお願いします。
Excel2013使用です。 ※私はマクロの記録は出来ますが、VBAに関しては無知です。 【質問内容】 A4用紙に帳票を2枚作っています。（同じ物） 印刷時、帳票に連番を自動で振りたいです。 連番を振りたいセルは「D1」と「D16」です。 つまり、1枚目の紙には「1」「2」 　　　　　2枚目の紙には「3」「4」 …と印刷されるようにしたいです。 （因みに、最後のページ数は都度変わります） ネットで見つけたVBAを利用して Sub Sample() Dim i As Long, myCnt As Long myCnt = Application.InputBox("印刷部数は?") On Error Resume Next Select Case myCnt Case False MsgBox "キャンセルされました" Case Else For i = 1 To myCnt * 2 Step 2 Range("D1") = i Range("D16") = i + 1 ActiveSheet.PrintPreview '<<--プレビュー画面が不要ならこの行を削除。 'ActiveSheet.PrintOut '<<--直接印刷するなら「'」を消去。 Next i End Select End Sub を実行してみましたが、上手く行きません。 （出てきたウィンドウに部数を入力しても、その通り印刷されません。 例えば「2部」と入力して、印刷画面のプロパティでは部数を指定せずに 印刷すると、最初の1頁だけが印刷されます。 試に印刷画面で2部にすると、今度は同じ紙（連番1と2）が2部印刷される だけです） どこを改良したらよいでしょうか…？
マイクロソフトのエクセルですが、 10年くらい前には時々使ってたのですが、最近はまったく使う必要が無く、ほぼ触っておりませんでした。 このたび、ある「売上」を管理してみようと思って、個人的に久々に触ってみたのですが、 操作でよく分からない部分があるので、教えて頂けないでしょうか。 セルのA2、A3・・・に販売した古い物（販売順）から記入していき、B1、C1・・・に売上月を書き、 売上金額を書いて売り上げ月ごとに小計をするという表を作ったのですが、 今後売る商品が増えた場合、下に項目を追加すると、オートSUMが上手く働かない事を知りました。 空欄を設ければ解決する話のようなのですが、 よく考えたら、販売したものを最近の物から順に記載すれば、常に上に商品を追加するだけで済むので、それが良いなぁと思ったのですが、 行の順序を入れ替えるのは、行を選択してシフトキーを押して、移動させたい場所に持って行くという事みたいで・・・凄く手間だなぁ、と思ってます。 さすがのエクセル程のソフトなら、こういうのは一括で並べ替えできるのではないかと思うのでうが、ネットの検索も下手なせいか、方法がわかりません。 たぶん、質問自体も妙な書き方になっているとは存じますが・・・ 昇順降順というのが正しいのかどうか分かりませんが、 一括で昇順を降順に変えたいと思っております、その方法を教えて下さい、 どうぞよろしくお願いします。
2007利用です。 減算の式は「=100-50」と入力しますが、たとえばA1セル上でこの式を入力し、マイナスした数値50を別のセル（B1）に反映させる方法を教えてください。
ユーザーフォームにある画像を、 クリックしたら、クリップボードにコピーするにはどうしたらいいですか？ コピーのメソッドはないようで、 下記はエラーになります。 Private Sub Image1_Click() Me.Image1.Picture.Copy End Sub
エクセルで時間の平均を出したいです。 例えば4分50秒と4分94秒の平均を出そうとして0"04"50と0"04"94でaverage関数を使うとエラーになります。打ち込み方がいけないのかと思い0:04:50と0:04:94に直そうとしたら、0:04:94の方だけ何故か少数で0.003857....となってしまいます。どうすればいいのでしょうか！
マクロでvlookupを使用したいのですが、　動かした結果が　#N/A　になります。 どこが間違っているのでしょうか？ マクロはこれ Sub macro1() Worksheets("訪問予定").Select Cells(3, 2).Value = Application.VLookup(Cells(1, 2).Value, Worksheets("担当").Range("A1:C5"), 2) End Sub 日本語で次のように私は認識してます。 「サブマクロ 訪問予定シートを選択 3行2列目の値は担当シートの日付と一致する行の２列目の値 エンドサブ」 やりたいことは 担当シートをもとに　訪問予定シートの担当蘭を埋めることです。 上記のマクロでは　ループさせてないので　一か所しか埋められませんが ループを使ってひと月の担当予定を埋める方法を考えてます。
病院勤務です。 EXCEL2010で入退院台帳を作成しています。 B列に入院年月日 C列に退院年月日 D列に入院日数 が入ります。 で、入院日数は　　=IF(B174=0,"",DATEDIF(B174,C174,"Ｄ")+1)　　という関数を入れて計算しています。 C列には　 =totay()　という関数が入っていて入院日数を計算しています。 （ちなみにC列を参照してG列で年齢も計算しています） 今現在のC列は見栄えの問題でフォント色を白にして見かけ上見えないようにしています。 ただ、実際に退院した場合、ここに退院年月日を入れると白いフォントのために見えないので、フォントの色を手動で変えなければなりません。 ここで質問ですが、C列に退院年月日を入力すると自動でフォントの色が変わるようにできないものでしょうか？ ちなみに、C列に=today()関数を入れず、表以外の別なセルに入れてそこを参照すると文字の問題は解決するのですが、退院日を入れても入院日数が動き続けるという不具合が発生してしまいました。 表の作り方そのものに問題があるかもしれませんので、他に良い方法があれば教えていただければうれしいです。 下手な説明でわかり辛いかもしれませんがよろしくお願いします。
Excel2013で複数のブックを開いている時、フォームのボタンで表示するブックを切り替えたいのですが・・・。 Excel2013で複数のブック１~５を開いているときにVBA（ブック５.Activate）を使って、ブック5を前面に持ってきたいのですがうまく行きません。 詳細は、ブック１~５が既に開いている状態で、「ブック1の作業を終了しますか？」というフォームの「終了」ボタンを押すと新しいフォーム（ブック５で行う作業内容や手順の書かれたもの）を最前面に表示し、その背面にブック５を表示したいのですが、現状は、新しいフォームは最前面に表示されるのですが、ブック５は、ちゃんと新しいフォームの背面に表示されるときもあれば、ブック１~４のさらに背面に表示されたり、ブック１の背面に表示されたりとランダムな位置に表示されてしまいます。何か良い方法がございましたら教えて頂きますようお願い致します。
こんにちは、　エクセルマクロの質問です。 イミディエイトウィンドウにて 現在のセルの４個上の値を表示しようと以下の文を入力したところエラーになりました。 ?cells(activecell.row-4,activecell.colum).value で　「実行時エラー　４３８ オブジェクトはこのプロパティまたまメソッドをサポートしてません。」 なぜでしょう？ ?activecell.Row-4　 ?activecell.colum はそれぞれ　正しく表示されます。
1列に空白行が無い状態で○と×の連続するデータがあるとします。 以下のような状態の時、○と×それぞれの平均連続回数を関数で求める事は可能でしょうか？ 1度、別列にて整理した方がやり易いでしょうか？ お力をお貸しくださいませ。宜しくお願いします。 例）○＝4連と5連がそれぞれ1回なので平均4.5。×＝3連と2連がそれぞれ1回なので平均2.5。 ○ × × × ○ ○ ○ ○ × × ○ ○ ○ ○ ○
シート１とシート2の内容を 1枚のＡ４用紙に両面で印刷する事は可能ですか？ それぞれのシートは片面のＡ４用紙には収まる内容です。 これはプリンターの設定でするのか エクセルの機能で可能なのか教えてください。 エクセル２０１０です。
人事部で業務を行っております。 パートタイマーの離職時にこれまでの契約更新回数を離職票に記入しなければなりませんが 今は頭で数えて記入しているような状態です。 そこで契約更新回数を算出できる関数をぜひご教示いただきたく・・・。 契約更新は年に2回あり、6月1日～11月30日、12月1日～5月30日が それぞれの契約期間です。 例えば2014年3月1日に契約開始したパートタイマーの場合、 2014年6月1日に1回目の契約更新を行い、2014年12月1日に2回目の契約更新を行います。 氏名　　　　契約日　　　　　　更新回数 Aさん　　　2014年3月1日　　　 〇回 Bさん　　　2014年4月21日　　　×回 Cさん　　　2015年8月25日　　　△回 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 人別に契約日が入力されたデータはありますので、 あるセルに退職日を入力するとこれまでの契約更新回数が 表示されるような関数を組みたいです。 ぜひ教えてください！
エクセルのマクロで（エクセル2010を使用） Range("A1:A900").Select Range("A" & Rows.Count).End(xlUp).Select i = Selection.Row 上記の900がセルの最終行で最終行数を取得し、iを利用して　 Range("A1:A & i ").Select といった感じで使用したいのですが記述がわかりません。 申し訳ございませんが（）内の書き方を教えてください。
=IF(ISBLANK(VLOOKUP($H$1,データ,10,0)),"",VLOOKUP($H$1,データ,10,0)) 上記の関数ですが、 Enterを押した後、まったくの空欄になります。 なぜでしょう？ Vlookupのデータは選択して名前を付けています。 実は、もともと使用していたページをコピーして、別のデータを使用したら空欄になるのです。 名前は新たにつけなおして訂正しています。 本来なら100と出るはずなのに、空欄になります。
ある帳票があって、複数の項目(列)と行があります。Excelでその帳票と同じ列幅の項目と行高のフォーマットを作り、印刷をするときはその帳票にしたいと思っています。その場合、帳票の列幅（単位cmまたはｍｍ）はExcelの列幅と行高に置き換える場合、何か目安になるものはあるのでしょうか。またExcelのそれらの数字の単位は何なんでしょうか。 また、印刷するときの余白の数字の単位は何でしょうか。mmかなと思いますが、ピッタリではないように思います。上下・左右の余白を「0」に設定しても、少し余白があります。「0」に設定したときにある余白のサイズはどのくらいなのでしょうか。 よろしくお願いいたします。
エクセルシート上の複数の任意のセルを選択し，マクロボタンを押すと，その選択した左上から右したまで赤の斜線を引きたいです。 どなたかマクロの記述を教えてくださいませんか？ 図々しいお願いとは十分承知の上のお願いです。 具体的には 写真を参考にしていただけるとありがたいです。
現在は給与一覧1月～12月まで12のシートがあります。 L2のセルには＝TODAY() J4のセルに氏名 J8のセルに通勤手当＝IF(ISERROR(VLOOKUP(J4,給与一覧1月！A1：Q26,6,FALSE)),””,VLOOKUP(J4,給与一覧1月！A1：Q26,6,FALSE))) 他ありますがL2の月が変わると参照するシートも自動で当月に替わる関数を教えてください。
毎日100枚の写真が、ある特定のフォルダーに保存されます。 これらは、一日経つと、自動で削除されます（バッチファイルで） これらの写真を、エクセルに取り込んで、 簡単に閲覧できるようにしたいのです。 写真を１０0枚挿入するマクロは書けるのですが、 その挿入した写真をどのように集め、スライドショーにするか、という 方法について悩んでいます。 コードは自分で調べるので、 どのような仕組みにしたらいいか、知恵をお貸し頂けますでしょうか？ 例えば： (1)ユーザーフォームを使う (2)フォトビューアーをエクセルで立ち上げる (3)スピンボタンを使う (4)スライドショーにしないで、ワークシートに順番に表示 ※できれば、この方法は避けたい。写真の数が多いので・・・ よろしくお願いします・・・
Excel2010で、画像のようなテーブルを作成したところ、 列1へドロップダウンリストから、金額(外税)　を選ぶと画像のようなエラーが表示されます。キーボードから、=[金額(外税)]を入力しても同じエラーです。 金額(外税)の見出しには、スペースは含まれていないようです。 正しい名前にして、ドロップダウンリストやキーボードから入力する方法どなたか教えてください。
会社のPCがオフィス2010から2016になり、今まで使用していたエクセルのシステムにエラーが出て困っています。 実行時エラーは1004 WindowクラスのTopプロパティを設定できません←と、出てデバックを開くと Sub 入力表() Set KA = Workbooks("データ.xls").Sheets("駐車場") Set NT = Workbooks("システム.xls").Sheets("入力シート") Application.ScreenUpdating = False '画面固定 ActiveWorkbook.Unprotect ActiveSheet.Unprotect '画面設定 With ActiveWindow .WindowState = xlNormal 'シート縮小 .Top = 1 .Left = 1 .Width = 1020 .Height = 400 .Zoom = 120 .DisplayHeadings = False '列行非表示 .DisplayHorizontalScrollBar = False 'スクロールバー非表示 .DisplayVerticalScrollBar = False 'スクロールバー非表示 .DisplayWorkbookTabs = False '見出し非表示 End With Application.DisplayFormulaBar = False ActiveSheet.Protect '入力画面のクリア クリア '駐車サブデータの抽出 Windows("データ.xls").Activate KA.Select N = 2: KY = NT.Range("住居コード") サブシート表示 N, KY ' Windows("システム.xls").Activate Sheets("入力シート").Range("住居コード").Select ' 保護されたセルは選択不可にする ActiveSheet.Protect UserInterfaceOnly:=True ActiveSheet.EnableSelection = xlUnlockedCells ' ←※ ActiveWorkbook.Protect Structure:=True, Windows:=True 'キーオン KEYON End Sub この画面の .Top = 1の場所に黄色いマーカーがひかれています。 縮小サイズの問題でしょうか？ 開発者の方はご高齢でもう2016は分らないと仰られて、とっても困っています。 宜しくお願いします。
いつもお世話になっております。 (1)エクセル２０１６で作成したシートに、入力規則を設定していたのですが、突然プルダウンリストマーク（▼）が表示されたままになるセルが現れました。（画像：左上の図） (2)そのプルダウンリストマーク（▼）にカーソルを当て、クリックしても、設定した入力規則は表示されず、空白のリストが表示されるだけです。（画像：右上の図） (3)他の正常なセルは、セル選択して表れる（▼）をクリックすると、予め設定した入力規則が表示されます。（画像：左下の図） (4)(2)で説明したセルも、該当セルをアクティブにして表れる（▼）【※(1)で説明した（▼）よりも少しいろが薄め】を選択すると、予め設定した入力規則が表示されます。（画像：右下の図） 印刷プレビューで確認すると、(1)で説明した（▼）は確認できないのですが、他人に渡すデータなので、なんとか(1)(2)の現象を改善できないかと思っています。 いろいろ調べたのですが、解決に至っていません。 どなたかご教授いただけますと幸いです。 画像が見にくいと思いますが、どうぞよろしくお願いします。
Excel2010で画像のような、テーブル名、”お買い物”　のテーブルを作成後、 セルに　=SUM(お買い物[数量2])を入力しようとすると、 入力した数式は正しくありません ・「ヘルプ」をクリックすると、数式を修正するための情報が表示されます。 ・関数の作成方法のヘルプを表示するには「数式」タブの「関数ライブラリ」にある 「関数ウィザード」をクリックします。 ・数式を入力していない場合は、等号(=)やマイナス(-)を使用しないか、または入力した値の先頭に単一引用符(')を入力します。 というエラーが表示されます。 どなたか、数量の合計をテーブル外に計算する方法を教えてください。
添付図をご覧ください。 範囲 A1:B6 に英語の人名が入力されています、。 セル A7 に式 =SUBSTITUTE(A1," ","") を入力して、此れを右および下方にオートフィルしたものを範囲 A7:B12 に示しています。 此処で質問ですが、最初に下表に示すスペースなしの文字列データがあった場合、此れを上表に示すデータに変換する数式を教えてください。 マクロ音痴の私のために、どうか数式でお願いします。 数式が短くなるなら、配列数式でも構いませんが、補助列(行)等を使用しないことを希望いたします。
お世話になります。 Excel 2016を使用して、A列のセルに郵便番号を入力すると、B列のセルにその住所を表示するようにしたいと思います。Webから検索した次のようなVBAをSheet1のシートモジュールとして貼り付けました。 Private Sub Worksheet_Change(ByVal Target As Range) '範囲は、A2～A100 に郵便番号を入力する場合 If Intersect(Target, Range("A2:A100")) Is Nothing Then Exit Sub If Target.Count > 1 Then Exit Sub Application.ScreenUpdating = False Application.EnableEvents = False With Target.Offset(0, 1).Validation .Delete .Add Type:=xlValidateInputOnly .IMEMode = xlIMEModeHiragana End With If Target Like "###-####" Then Target.Offset(0, 1).Select SendKeys Target.Value SendKeys "{ }" SendKeys "{ENTER}{ENTER}" SendKeys "{Left}" End If Application.EnableEvents = True Application.ScreenUpdating = True End Sub この結果自分の住所の郵便番号の場合はうまく表示されました。そのほかの番号の場合は、 瞬間的に何か表示されたような気はしますが、結果的には列に入力した番号が表示されます。 またうまく表示されないB列の郵便番号を変換キーで住所に変換する作業を3～4回繰り返した後にこの番号をA列に入力するとB列にこの住所が表示されます。「学習した番号については、うまくいく」ような感じです。 何か解決する方法はないでしょうか。 よろしく願いします。
現在，マクロを勉強中です。 ユーザーフォームに，３つのラベルを設定し，それぞれのラベルをクリックすると，「初期設定」または「４月」または「５月」のシートを表示し，ユーザーフォームは消すというものを試みています。 シート名は，「初期設定」「４月」「５月」です。 １つめのラベルをクリックしたときに実行されるコードは Sub Label1_Click() Sheets("初期設定").Activate Unload Me End Sub で設定したのですが，ユーザーフォームが消えるのですが，何のシートも表示されません。 実行したいことだけを考えると，ハイパーリンクでも可能なのですが，勉強もかねて質問させていただきたいと思います。 どこか修正すべきコードがありましたらご教授くださるとありがたいです。
宜しくお願いします。 1枚のファイルシートに14ブロックのデータが貼り付けてあります。各ブロック行の長さは違く、ランダムに貼り付けてあります。例えば、データ 何百行の空白 データ…と繰り返されており、約3万5千行ぐらいあります。 空白行削除で多分半分近くまで上に詰められれば良いのですが、たくさんあるのでマクロで教えていただければと思います。ネットでころがってるデータ試してみたのですが(1部) ENDLESSに実行されて、出来てるのかどうかも確認はとれてません。ちなみに自分のシートに貼ってあるデータはA列からAS列まであり数字、文字混在です。また各ブロックの終わりは集計行となっており、空白セルがまじってます。宜しくお願いします。
エクセルのいくつかのセルのデータをパワーポイントへマクロを使用して転記したいと考えています。 例＞ エクセルの A1：名前 B1:ふりがな C1：番号 この３つをパワーポイントの表紙と各スライドのフッターのあたりに転記したい。 条件として パワーポイントファイルはエクセルと同じディレクトリにある。 パワーポイントのページ数は、そP都度変わる。 このため、 パワーポイントファイルを相対パスで指定する。 パワーポイントのページ数を取得する。 表紙にデータを転記する 各スライドにデータを転記する。 こういった作業をエクセルのマクロで実現したいのです。 宜しくお願いします。
エクセルでセル参照をする際に添付画像のようにA１からA１２の値が入力されたセルがあり、A１の値がA２からA１２の中にいくつあるのかをカウントしたいです。それをオートフィルして、A２がA1からA１２のなかにいくつあるのか、A３がA１からA１２の中にいくつあるのかという風にセル参照させたいのですが、選択セルだけセル範囲の中で除外できるものでしょうか。 詳しい方よろしくお願いします。
この場を借りましてご質問させていただきます。 要件：指定した期間に含まれる土日祝（日本の暦）を除外した日数を算出 　　　両端入れ 例）　セルA1：2016年5月2日 　　　セルB1：2016年5月9日 がはいってたとして、上記2つの期間の日数は　8日 ですが　土日祝　を除外すると（5/3,4,5,7,8） 3日 です。 このような日数計算を関数で実現することができましたら ご教示いただくと幸いに存じます。 よろしくお願いいたします。　
セルに以下の文字列が入っています。 A1=10(451 A2=452 そしてVBAにて、以下のプログラムを実行すると、「実行時エラー’13’ 型が一致しません」というエラーになってしまいました。 原因はA1に「（ 」があるので文字列だからだと思うのですが、「IF　条件文」が成立しないことは満たすのでElse以下を実行されるのを期待していたのですが。 アドバイスをお願いします。 また、そもそも変数を宣言してないので「型が一致しない」というエラーの意味がわからないのですが。 If Cells(1, 1) - Cells(2, 1) = 1 Then Cells(3, 1) = 1 Else Cells(3, 1)="c" End If
Windows7でexcel2010を使用しています。 曜日を入力した行とその下の行に曜日に応じてセルの背景色が変わるように条件付き書式設定をしています。曜日の行とその下の行は同じ色になる設定です。 曜日の下の行には文字を入力します。 条件付き書式設定で変更されたセルの背景色で特定の色かつ特定の文字列が入力されたセルの個数を数えたいのですが何か方法はありますでしょうか？ たとえば、A1～AE1に曜日を入力していて、平日は背景色なし、土曜日は背景色青、日曜日は背景色赤になるように条件付き書式設定をします。 A2~AE2には色々な文字を入力しますが、上のセルと同じ色になるようにしています。 A2~AE2に〇と入力されていて、且つ背景色なしのセルの個数を数えたい場合はどうすれば良いでしょうか？〇と入力されていて背景が青の場合、赤の場合のセルの個数も数えたいです。 本当は背景色ではなく文字色を条件付き書式設定で変更してその個数を数えたいのですが、色々検索したところ文字色では難しそうなので背景色を変更することにしました。 説明が下手で申し訳ありませんが、どなたかご教授しただけますと幸いです。
10店舗、飲食店を経営している会社で働いているものです。 店舗別の売上げを表した、エクセルの棒グラフがあります。 それを過去１２ヶ月分作って持ってこい、と上司に言われました。 １２個グラフを作ったのですが、 左から右に並べるのと、 上から下に並べるの、 どちらがグラフを、比べ易いか迷っています。 皆さんが上司なら、 上から下のほうが、グラフを比べやすいですか？ それとも、左から右のほうが良いですか？
Windows Vista Office2007です。 excelにある情報を貼り付けました。不要部分を削除しようとしたのですが、 一回で削除できた部分と、一回では削除できない部分があります。 できない部分というのは7mm角ぐらいの四角の枠の中に絵(アイコンということにします)が 表示されているものです。 右クリックして「切り取り」をすると絵が変わります。もう一度「切り取り.」をすると削除されます。 数が多いので削除するのが大変です。 これらのアイコンを一回で全数削除する方法を教えてください。 よろしくお願いいたします。
以前より仕事で使ってるExcel の表で、関数を入れたセルがあったんですが、その関数がある日当然その内容の一部が変わってた。それも一箇所だけでなく、同じ関数を入れてた全てのセルで‥ 。こういう事は一体どういった状況で起こるものでしょうか。ほんのの少しの可能性でも結構です。それともそんな事はありえませんか。
経理の仕事をしています。 ピボットテーブルの勉強をしたいのですが、親切に説明している、わかりやすいホームページがあれば教えてください。
情報の授業でやるのでしょうか？
スマホでエクセルオンラインを使っていて、アプリを切り替えると、 さっきまでエクセルのシートの画面だったのに、 この画面に戻ってしまう時があります。 毎回ではないです。 エクセル以外にアプリにしている時間が長いほど、なる確率が高い気がします。 エクセル→Googleマップ→エクセルみたいにアプリを切り替えるを起こります。 これを回避するにはどうすれば良いですか？ いちいち、毎回さっきまで開いていたファイルを開くのは若干時間がかかるしめんどくさいです。
お世話になります。 当方、初めてエクセルのVBAを扱います。 エクセルのバージョンは2010を使用しています。 商品群が多く、コンボボックスもしくは入力規則のドロップダウンリストを 使用して規格と商品種類1－商品種類3を選択しオートフィルターを掛けて 必要な情報を抜き出したいと考えています。 No,　物質名　規格1・・・規格10　商品名1-1・・・商品名1-50　商品名2-1・・・商品2-50・・　 1　　　鉄　　　　1　　　　　　　　　　　　　　1　　 2　　　鉛　　　　　　　　　1　　　　　　　　　　　　　　　　　1 3　　　銅 4　　アルミ　　　1　　　　　　　　　　　　　　1 ・　　　・ ・　　　・ ・　　　・ このような表が有ります。 物質名と規格または商品が一致する場所に「1」を掛けています。 また、シートは 入力シート⇒上記表が有る場所 作業シート⇒データ処理上必要な作業をする場所 　　　　　　　※コンボボックスの選択肢を作るうえで入力シートの横並びの状態では難しかったので 　　　　　　　　縦並びに該当データをリンクして並べました。 検索シート⇒検索結果を表示する場所 の3つを製作済みです。 現在、コンボボックスを使い、 　コンボボックス1⇒商品種類(商品種類1～3を選択し、コンボボックス2に連動) 　コンボボックス2⇒商品名 　コンボボックス3⇒規格群 　ここまで準備はできており、 VBAで　 Sub 検索() Application.ScreenUpdating = False '入力シートのオートフィルター表示 Worksheets("入力シート").Range("$A$1:$FM$1").AutoFilter field:=1 '検索シート「商品名」及び「規格」の設定内容でオートフィルターソート '検索シートに検索結果をコピー Sheets("入力シート").Range("$A$1").CurrentRegion.Copy Sheets("検索シート").Range("$B$8") '入力シートのオートフィルター解除 Worksheets("入力シート").AutoFilterMode = False まで作成しましたが、商品群と規格群のコンボボックスとオートフィルタの連動がどうやっても解かりません。 どなたか、ご指導して頂けないでしょうか。 よろしくお願いいたします。　
excel 2010です。 ワードアートの文字の輪郭を消すマクロを作りたいのですが、 マクロの記憶で、作られた以下のコードでは、消えません。 どうすれば、消せますか。 よろしくお願いします。 Sub Macro() ActiveSheet.Shapes.AddTextEffect(msoTextEffect1,"ABC","Times New Roman",128,False,False,0,0).Select Selection.ShapeRange.TextFrame2.TextRange.Font.Line.Visible = msoFalse End Sub
Excelの関数についてお聞きします。 セルに色付き／色なしを判断する関数はありますか？
よろしくお願いします。 EXCEL給与計算で国税庁の月額表を貼り付け、IF関数・VLOOKUP関数で所得税を自動計算しています。課税対象額が1,010,000円未満は問題なく計算できるのですが、1,010,000以上になるとうまくできません。以下の式を使っています。（B9が課税対象額、B14が扶養家族数、所得税が国税庁税額票のシート） =ROUNDDOWN( IF(B9<88000,0, IF(B9>1740000,VLOOKUP(1740000,所得税!$B:$L,B14+3)+(B9-1740000)*40.84%, IF(B9>1250000,VLOOKUP(1250000,所得税!$B:$L,B14+3)+(B9-1250000)*33.693%, IF(B9>1010000,VLOOKUP(1010000,所得税!$B:$L,B14+3)+(B9-1010000)*32.1615%, VLOOKUP(B9,所得税!$B:$L,B14+3))))),0) ただ、これだと例えば課税対象額が1,304,531円、扶養家族1名のとき、自動計算では141,413円となってしまいます。正しい税額は219,083円だと思います。 どこが間違っているのでしょうか？
Excel2013 使用です ※私はVBAは使えませんが、マクロの記録は出来ます。 　 記録したマクロに、ネットで見つけたコードを加えたりします。 　 今回は、それで上手く行かなかった所についての質問です。 画像を元に説明します。 【目的】 元々はU列までしか無いデータに、マクロを使ってW列以降に集計を出したい。 【作ったマクロ】 Q列とR列の重複を削除した物をX列とY列に表示 SUM IF関数を使って、W列を元にS列を集計した数をY2セルに表示 セル「AA2」に、「Z2」-「Y2」列の数式を入れる …ここまでは上手く行きました。 問題は、Y2に入れたSUMIF関数と、AA2に入れた引き算を 「W列の最終行と同じ行」までコピーしたい」という所です。 （元になるU列までのデータの行数は、つど増減があるため） そこで、ネットで見つけた以下のコードを使ってみました。 Range("Y2").Select ActiveCell.FormulaR1C1="=SUMIF(C17:C19,R23,C19)" Range("Y2").Select With Cells(Rows.Count,"X").End (xlUp) Selection.AutoFill Destination:=Range(Selection,Cells(.Row,"Y")),Type:=xlFillCopy 上のコードを使うと、画像で言うと6行目までは正しい数が表示されます。 が、何故かその下に0000・・・と続き、更に下の方によく分からない表示が 出てしまいます。 恐らく、Y列はS列を元に集計しているせいだと思うのですが、VBA自体の意味は さっぱり分からないのでどう直したら良いのか分かりません。 （ちなみに、R列の商品名はQ列の商品コードを元にvlookupで出していますが、 R列は上記のコードを使って正常にQ列と同じところまでコピー出来ています） どなたかご教示いただけたら助かります。
エクセル2013を使っています。 B30からL30までの最小数を求めるときにM30に　=MIN(B30:L30)としますが結果が「0」の時に M30に「{0」を表示しないで「空白」にしたいのですが、何か良い方法がありますか。 よろしくお願いします。
-質問内容-VBA作成2つ- ActiveCell.Offset(RowOffset:=[O1991], Columnoffset:=0).Activate アクティブセルを指定した段階で オフセット(縦下方向にO1991のセルに入れた数値分下に、ヨコに0) 移動しアクティブセルにする ------------------------------------------------------ ------------------------------------------------------ 別々のVBAでやりたいこと (1)これを、アクティブセルを指定した段階で セルの値をコピーして オフセット縦下にO1991.ヨコ0分下にペースト(貼り付け) したい 例)　　 　　A　　　 1　成功　　←アクティブセルをコピー　　 3　成功　　←　ActiveCell.Offset(RowOffset:=[O1991], Columnoffset:=0).Activate　 アクティブセル～オフセットしたセルまでを最初にアクティブセルからコピーし →アクティブセル～オフセットしたセルまでペーストする ----------------------------------------- (2)これを、アクティブセルを指定した段階で セルの値をコピーして オフセット縦下にO1991.ヨコ0分下に アクティブセル～オフセットされたセル位置まで フィルダウンさせたい 例)　　 　　A　　　 1　1　←アクティブセルをコピー　　 5　 ←オフセットセル 2つのVBAのやり方/プログラムの表記/組み合わせ方を 無知で愚かな私ですが どうかご教授のほど 宜しくお願い致します (>_<)謝↓ペコッ --------------------------------------- --------------------------------------- 変数を使うのでしょうか? セル範囲を指定するとして Range("ActiveCell:ActiveCell.Offset(RowOffset:=[O1991], Columnoffset:=0).Active") となるのでしょうか? 又変数の使い方として Dim a As Range 又は Dim a As Objectになるのでしょうか この際代入として使うには a = ActiveCell b = ActiveCell.Offset(RowOffset:=[O1991], Columnoffset:=0).Activate になるのでしょうか 本当に度々申し訳ないのですが 宜しくお願いします (:>_<:)ペコリ Range(ActiveCell).copy ActiveCell.Offset(RowOffset:=[O1991], Columnoffset:=0)ActiveCell.PasteSpecial End Sub
最近PCの調子が悪く、再セットアップをしました。 その前にプロダクトキーを控えておくのを忘れました。 PCの裏にプロダクトキーのシールが貼ってあるようなのですが、すでに文字がかすれて見えません。 再度excelなどを使用する際は、再購入しか手がないでしょうか？
添付した画像を参考にした場合、粗利益（Ｄ２）の計算式を教えてください 行　　　Ａ列　　　 ｜　Ｂ列　　　　 ｜　Ｃ列　　　　 ｜ Ｄ列 １　　　金額（円）｜販売価格（円）｜原価率（％）　｜粗利益（円） ２　　　10,764,000｜59,800　　　　｜0.75
VBAにおいて「グローバル変数」と言うのは パブリックで宣言された変数を言うのでしょうか？
添付のような案内図がエクセル2010で作られています。 これを、右に90度回転させたいのですが、回転後、説明の文字を入力したりしたいのです。 どうすればよろしいでしょうか。
条件付き書式設定で行毎に上位1位は緑色で表示するよう設定してあります。 この書式Ｃ3：Ｈ３を行4以降にコピーしたいのですが範囲をマウスで指定してコピーするとＣ 3：H14とかの範囲になってしまいます。 行毎にコピーする方法を教えてください。 条件付き書式ルールの管理の適用先に＄マークが付いているので削除してＯＫを押しても消えないので行毎のコピーができない。 画像も添付します。 よろしくお願いします。
列に時間帯別の使用量、行に日付毎の表から日付別に最小値と最大値が発生した時間帯を別表に抽出する方法を教えてください。 参考に表を添付します。 よろしくお願いします。
・A１セルにハイパーリンクが貼ってあります ・B1セルに１と記入してあります ・C1セルに数式があります　=IF(B1=1,A1,"") この場合C1セルにハイパーリンクはついて来ません。 どうすればハイパーリンクが付いたままA1セルをC1にコピーできるのでしょうか？
いつもお世話になっております。 エクセルで、オラクルＤＢから、特定の商品の販売数を取得するＶＢＡを作ったのですが、集計したい商品がまれに変更になります。 出来れば、エクセルシート「抽出リスト（仮名）」のリストの値を抽出できるようにするにはどういったＳＱＬを書けばよいでしょうか？ 【テーブル構成（FRT_ITEM）】 ITM000：取消フラグ ITM050：販売日 ITM150：科目CD ITM160：科目名（商品名） ITM200：販売数量 現在のＳＱＬ文 stSQL = "SELECT " & vbCrLf stSQL = stSQL & "ITM050 AS 販売日," & vbCrLf stSQL = stSQL & "ITM150 AS 科目CD," & vbCrLf stSQL = stSQL & "ITM160 AS 科目名," & vbCrLf stSQL = stSQL & "SUM(ITM200)AS 個数" & vbCrLf stSQL = stSQL & "FROM FRT_ITEM" & vbCrLf 　’キャンセルフラグ除外 stSQL = stSQL & "WHERE ITM000 = 0" & vbCrLf ↓ここから科目CDによって商品抽出 '商品Ａグループ stSQL = stSQL & "AND ITM050 = '" & DT & "'" & vbCrLf stSQL = stSQL & "AND ITM150 BETWEEN '1600' AND '1610'" & vbCrLf '商品Ｂ stSQL = stSQL & "OR ITM050 = '" & DT & "'" & vbCrLf ↑ ここまで stSQL = stSQL & "AND ITM150 BETWEEN '1521' AND '1521'" & vbCrLf stSQL = stSQL & "GROUP BY ITM050,ITM150,ITM160" & vbCrLf stSQL = stSQL & "ORDER BY ITM050,ITM150,ITM160" ※変数ＤＴ：販売日 この状態だと、抽出する商品が変わるごとに、ＳＱＬ文を修正する必要があるため、別シート「抽出リスト（仮名）」に抽出する商品CD一覧を記載し抽出出来ないかと考えております。 多分、IN句を使い、抽出リストシートを呼べれば良いのではと考えておりますが、書き方が分かりません。 ※商品の数は、最大３０種類程度となります。 また、テーブル（FRT_ITEM）は５００万レコード以上あるため、IN句をつかってのテーブル総なめ抽出はＤＢへの負荷が心配です。 アドバイスを頂けましたら幸いです。
お世話になります。 各商品の実績を年月毎に表した"表A"があります。 この表Aをもとに商品を行、年月を列にして各商品を年月でずらっと見れるような表Bにしたいのです。(へたな説明で申し訳ありません) 上記のやりたいことを画像にしてみましたので、どなたかご教授いただけませんでしょうか？ 明日までに仕上げないといけなくて困っています・・・・ Excel2013
エクセルで行と列が表示されていなかったので右クリックで表示を選択しましたが表示されません。全選択して、書式から表示をしたのですが何も表示されません。行と列を表示しないようにする方法はどのようなものがありますか？
Ｂ１をコピー⇒ブラウザの検索窓に貼り付け→エクセルに戻る Ｂ２をコピー⇒ブラウザの検索窓に貼り付け→エクセルに戻る Ｂ３を・・・という作業を自動化したいです。 Ｂ１～Ｂ？までを一括で選択してコピーという作業をマクロで自動化する方法はわかるのですが 上記の作業を簡単にする方法がわかりません。 Ｂ１→ブラウザ→Ｂ２を選択してマクロの表示ボタンをクリックして、右上にあるマクロの表示ボタンからポップアップウィンドウのマクロ画面の実行ボタンを押して～ というのをやっていたら、普通に「Ｃｔｒｌ＋Ｃ」でコピーしたほうが早いと思います。 同じ操作を複数のセルに別々に実行したい場合、その別々を１個１個実行しているのは アホらしいです。 なにか方法はないでしょうか
WIN10・エクセル（2016）で住所録を作っています。 データは数百人分、すでに入力済みです。 シートが何枚かあって、A業務用、B写真仲間、C友人、D家庭用などに分類していますが、BとDにダブる場合やCとDに重なっているデータもあります。 これらをまとめてダブリを無くし基本台帳にする（これは出来ます） 問題は必要時にその都度「基本台帳」から、Aだけ、あるいはB＋Cなどを抜き出して別シートにするといった使い方をしたいのです。「基本台帳」で対応しておかなければならないのでしょうが、どのようにしたらいいのか、ご教示頂けないでしょうか。よろしくお願い致します。
お世話になります。町内会のお仕事なんですが、教えていただけるでしょうか。 月曜始まりで１週間で次の人に代わる名前表を作りたいのです。 火曜から日曜までのセルは「捺印スペース」になります。 完成品は印刷して、ゴミ当番の回覧板に挟んで使います。 もう３年も手書きで作っているので、なんとか自動化できないものかと思いご相談いたしました。 ・年度を書き換えるとその年のカレンダーに書き換わる。 ・同時に「新年度スタート」の氏名から順に当番氏名を月曜日に落とし込む。 ・「新年度スタート」の位置は手動入力。 ・当番氏名欄にある16軒を順にカレンダーに割り振りたい。 ・当番氏名は年度をまたいで続きますが、カレンダーとしては３末で打ち切りの１年分１枚だけです。 ・2016年４月４日（月曜日）から８月１日まで手動で見本を記入しました。 ・当番氏名が減った場合は書き直せばいいかと思いますが、増えた場合にも対応できるようにしたい。 すべての月曜日セルに「新年度スタート」の位置を読み取る関数を書くのかと想像していますが、まったくわかりません。 年度を変えたとき、難しいようでしたら「すべての関数を手書きで書き直す」ということでも構いません。書き換え方を教えてください。 よろしくお願いいたします。
Excel2003版でVBAを使い　 検索と参照プログラムを組みたい ----------------------------------------- Sub Sample1() Dim FoundCell As Range Set FoundCell = Range("B55:B63").Find("1") If Not FoundCell Is Nothing Then MsgBox FoundCell.Offset(0, -1) End If End Sub ------------------------------------------- ↑VBAプログラム参照↑ ・B55～B63セル内の中から(1)の 数字があるセルを探し更に検索してヒット したセルの左セルの内容を メッセージボックスに表示させると ゆうやり方です。 この内容を あるセル 例えば"E17"セルに代入させたい場合 やりたいこととしまして、 ○----------------------------------------------------------○ E17セルの内容を空白にした後 Calculateを使い ランダムシャッフルし、 B55～B63セル内の中から(1)の 数字があるセルを探し更に検索してヒット したセルの左セルの内容をE17に入力(代入又は参照でも可)させたい ○---------------------------------------------------------○ 場合はどのようにプログラムを組めばよろしいですか? 無知で愚かな私ですが 恥を忍んでご教授頂けませんか よろしくお願いします(人>д<*ペコ謝)
エクセルの編集をしています。 表1.のような日付と商品の組み合わせごとのレコードからなる表を、表2.のように日付ごとに合算したいと思っています。 表1. 日付　商品A　商品B　商品C 1/2 　 2F 1/2 　　　　　3F 1/3　　　　　6G 1/3　5G 1/3 　　　　　　　　　-3F 　　　　　　↓ 表2. 日付　商品A　商品B　商品C 1/2　　2F　　 3F 1/3　　5G　　6G　　 -3F 表1.の条件は、 ・同じ日付で同じ商品の組み合わせはありません ・項目は「F」「G」の記号とマイナスの存在する数字の組み合わせです ・空欄になっているセルは空欄です データベース関数、小計などを使ったのですがうまくいきませんでした。 何かアイデアをおねがいします。
過去の質問で似たような内容はあったのですが、印象が違ったのでここで改めて質問させていただきます。 複数シートが３０枚程度あります。 例えば、売上表４月…売上表１２月，売り上げ内容４月…売り上げ内容１２月，関連業者１…関連業者１２といった具合です。 これらのシートを全て表示させておくと，選択するために時間がかかり，また，選択すべきシートを間違えて入力する人も多いので，なんとか簡素化したいと考えています。 表紙のシートを作成し，ハイパーリンクを貼ることも考えたのですが，各シートはすでにいろいろ作り込んで完成しており，表紙に戻るハイパーリンクを各シートに貼る共通セルのスペースもない状態です。 例えば，シートの「売り上げ表」を選んだら，売り上げ表４月～１２月までのシートだけを表示させたり，「売り上げ内容」を選んだら，売り上げ内容４月～１２月までのシートだけを表示させたりすることなどは可能でしょうか？ イメージとしては，「売り上げ表」「売り上げ内容」「関連業者」のメインシートの３枚のみが表示されてあり，それらのシートを選択すると，「売り上げ表４月～１２月」が表示されたり，「売り上げ内容４月～１２月」が表示されたりし，他のシート（メインシートと表示されているシート）以外は非表示になっている…といったようなものです。 ご教授いただけると嬉しいです。
一行ごとに飛ばして参照したく調べたのですが行き詰ってしまいお力をお借りしたいです。 =INDEX($A$1:$A$20,(ROW()*2-1),1) の式でA列のデータをB1やC1に貼り付けオートフィルで簡単にA1、A3、A5と参照できるようになったのですが 開始するセルがB1やC1の行頭からではなくB350やC487などの途中からの場合どのように書けばいいのでしょうか？参照したいデータはA1～入っております。 例えばB350もA1、B351にA3の、B352にA5データを参照させたいです。 宜しくお願いいたします。
セルA1に「入居日」 セルB1に「退去日」 セルC1にA1とB1から関数を入れて、「入居日と退去日の間の期間」を表示させています。 （ちなみにC1には現在「=DATEDIF(A1,B1,"YM")&"ヶ月"&DATEDIF(A1,B1,"MD")&"日"」が入っています。） ここで解決したいのが、セルC1には現在「7か月15日」と出ています。 これを「7.5（か月）」と表示させたいのですが、どうしたらいいのでしょうか？ なお、セルの書式設定で表示形式をさわる必要はありますか？ 出来る限り簡単に教えていただけますと幸いです。 宜しくお願い致します。
エクセルにて従業員のシフト表を参照にして指定して日付に置いて【休】の方だけを別ファイルの特定の場所に打ち込まれるというように出来ますか？ 説明が分かりづらくで申し訳御座いません。 最終的には日毎の配置表を作成したく、名前の打ち忘れが内容に条件付き書式にて打ち込まれた名前は色が変わるようにしております。この配置表の定休と設けた箇所に自動的にシフト表を参照して定休者の名前を打ち込まれるようにしたいです。 シフト表において３月３０日が休となっている方を３月３０日の配置表の定休と設けた箇所に順番に名前が打ち込まれるような感じです
質問No.9150010の続きです。 上記の質問で下記のようなご回答を頂きました。 E列の数値に対してB４セルに入力されている公差の数値に H列とK列の数値が入っているか調べるマクロです。 下記のマクロで完璧に行えるようになりましたが もしE列の数値に対して、公差内に入っていない数値がH列とK列にあった場合 その公差内に入っていないセルのみを赤く塗りつぶすには下記のマクロにどうのように追加すればよいでしょうか？ パターンとしてはH列もしくはK列のどちらかのみが公差内に入っていない時もあれば 両方とも公差内に入っていない場合もあります。 Sub 判定仮本物() Dim i As Integer, j As Integer Dim k As Double Range(Cells(3, "L"), Cells(32, "L")).ClearContents Range(Cells(3, "E"), Cells(32, "K")).Interior.ColorIndex = 0 k = Cells(4, 2) 'B4セルの値 For i = 3 To 32 If Abs(Cells(i, "E") - Cells(i, "H")) <= k And Abs(Cells(i, "E") - Cells(i, "K")) <= k Then If i Mod 2 = 1 Then Union(Cells(i, "E"), Cells(i, "H"), Cells(i, "K")).Interior.ColorIndex = 6 Cells(i, "L") = "OK" Else Union(Cells(i, "E"), Cells(i, "H"), Cells(i, "K")).Interior.ColorIndex = 40 Cells(i, "L") = "OK" End If End If Next If WorksheetFunction.CountIf(Range("L3:L32"), "OK") > 29 Then MsgBox "データチェックOK(^O^)b" End If End Sub
セルA1に「7か月15日」と表示されています。（これは他のセルから計算で出されているものになります） これを、7か月15日ではなく、「7.5」（ヶ月）と表示させたいのですが、 どうしたらいいのでしょうか？ ご存知の方宜しくお願い致します。
エクセルを使っていて思ったのですが、保存する時のアイコンはいまだフロッピーディスクですよね。 記号どおりフロッピーディスクに保存している人はまずいないと思うのですが、なぜまだその記号なのでしょうか？
エクセルにて従業員のシフト表を参照にして指定して日付に置いて【休】の方だけを別ファイルの特定の場所に打ち込まれるというように出来ますか？ 説明が分かりづらくで申し訳御座いません。 最終的には日毎の配置表を作成したく、名前の打ち忘れが内容に条件付き書式にて打ち込まれた名前は色が変わるようにしております。この配置表の定休と設けた箇所に自動的にシフト表を参照して定休者の名前を打ち込まれるようにしたいです。 シフト表において３月３０日が休となっている方を３月３０日の配置表の定休と設けた箇所に順番に名前が打ち込まれるような感じです。
検索の方法を教えてください。 Sheet1にある複数の文字列（500個くらいの1文字で1マスに1字入っています）が、Sheet2の文字列に含まれるか（氏名が1マスに1つ入っており、1列に列んでいます）、 含まれる場合どこに含まれているか（あるいはどの列に含まれているか）を検索する方法はありますでしょうか。 特定の1つの文字列を検索する方法や、検索式に検索したい文字列を入れる方法までは調べたのですが、500個くらいあるため、1つずつ検索するのは困難です。 アドバイスよろしくお願いします。
VBA(EXCEL2007)-Win7Proで下記コードを実行すると、 　コンパイルエラー：型が一致しません。 が、発生します。 Option Explicit '呼ばれる側 Public Sub sub1(ie As InternetExplorer) End Sub '呼び出し側 Public Sub Test() Dim ie As InternetExplorer sub1 (ie) End Sub VAB初心者です。 netで紹介されていたソースをコピペしてみたのですが、コンパイルエラーとなってしまいました。問題点絞り込みのために、削ぎ落とした結果が、先のソースです。 下記が参考のソースの場所になります。 http://www.macrogirls.net/iesamplecode/vbaie_day4_4.html 画面遷移待受サブルーチン が問題のソースです。
エクセル2010で、列に入った数値（時系列データー）の1つ前から直近５０個分のデーターの平均や標準偏差を出したいのですが。 データーが毎日増えるので入力された値を直近の5０個分のデーターの統計値と比較したいのですが直近５０個のデーター範囲を指定する方法を教えてください。 毎日列の一番のセルに数値が入力されていく表が有って、最後の数値を除く、直近5０個のデーターの平均値と比較したいのですが。 最新（一番下）の数値が大きく外れた場合、その「外れ値」を含めて、単に入力範囲全部のデーターの統計値と比較するのは不都合が有る為です。
規格を設けて判定するマクロについて教えてください。 下記のようなマクロがあるとき、現在はE列、H列、K列が同じ数値の場合は 塗りつぶしが行われるようになっています。 これを少し改造して、B4セルに公差の数値を入力した時 E列の数値を基準とし、H列、K列がE列からB4セルに入力した公差内なら色を付けるような マクロを組みたいです。 例えばB4セルに2と入力してあるとします。 E列の数値が4.2だとした場合 H列は2.2、K列は6.2ならE列の数値の±2なので塗りつぶしされる。 E列の数値にB4セルの入力した数値の±をH列、K列を超える場合は 塗りつぶしは行わない、という感じです。 わかりずらい説明で申し訳ありませんが、宜しくお願いします。 Sub 判定仮() Dim i As Integer, j As Integer Range(Cells(3, "L"), Cells(32, "L")).ClearContents Range(Cells(3, "E"), Cells(32, "K")).Interior.ColorIndex = 0 For i = 3 To 32 If WorksheetFunction.CountIf(Rows(i), Cells(i, "E")) > 2 Then If Cells(i, "E").Row Mod 2 = 1 Then Union(Cells(i, "E"), Cells(i, "H"), Cells(i, "K")).Interior.ColorIndex = 6 Cells(i, "L") = "OK" Else If Cells(i, "E").Row Mod 2 = 0 Then Union(Cells(i, "E"), Cells(i, "H"), Cells(i, "K")).Interior.ColorIndex = 40 Cells(i, "L") = "OK" End If End If End If Next If WorksheetFunction.CountIf(Range("L3:L32"), "OK") > 29 Then MsgBox "データチェックOK(^O^)b" End If End Sub
EXCEL２０１３を使用しています。 勤務表を作成するとき、 データを連続挿入するのですが、 「ALT」+「↓」で一覧を表示 →カーソルで選択 →ENTER →カーソルで隣のセルに移動 ・・・という手順を何十回も繰り返すのですが、 もう少し簡単にできる方法はありますでしょうか？ できたら、カーソルを乗せたら、一覧が表示される 選択してEnterを押したら、次のセルに自動で移動する ALTを押さなくても、一覧が表示される ・・・などができたらとても助かります。 　毎月の勤務表の作成が効率化できるので・・・。
PC人生で初めてのトラブルで、びっくりしております。 いつものように、エクセルファイルをマイドキュメントから利用しています。 もちろんバックアップの為、外付HDに保存していますが、重要ファイルだったので 　直接マイドキュメントから、右クリックで切り抜いて、直接外付HDのマイドキュメント を開いて貼り付けをしたのですが、見当たりません。 是非ともファイルをみたいのですが、普及策はあるのでしょうか？ OSは、WIN7で、エクセル2007です。一様、ブンバックアップも付いていますが利用方法が 分かりません。終了時ブンバックアップ終了をしています。 初歩的な件でお恥ずかしいですが、皆様アドバイスお願い致します。
すみません、どうしてもわからないので教えて下さい。 エクセルで開始日から終了日までが何日かを関数を使用して計算したいのです。例えば開始日1/1、終了日1/17だとしたら、答えが17日という具合です。 ただし、予め作成してある休日リストにある日付が開始日と終了日の間に含まれていた場合、それを除外した日数を出したいのですが、どのような計算式にしたらよいでしょうか？ 会社の定休日などが決っていれば、NETWORKDAYS.INTL関数を使用してできるのはわかったのですが、曜日指定がない場合の関数がどうしても見つけられませんでした。 どなたかお力を貸していただければ嬉しいです。よろしくお願いします。
Excellで、ある日の翌日から起算して1ヶ月後の翌日を返すユーザー定義関数を作成しようとしています。VBAで、ある日を　dt　として引数を定義し、下記のとおりfunctionプロシージャを作成しましたが、「コンパイルエラー subまたはfunctionが定義されていません」のエラーとなってしまい困っています。どのように改善すればよろしいか、どなたか教えてください。 なお、期間計算については、民法第１４３条のとおりに計算するようにします。 引用開始 第１４３条 　週、月又は年によって期間を定めたときは、その期間は、暦に従って計算する。 ２ 週、月又は年の初めから期間を起算しないときは、その期間は、最後の週、月又は年においてその起算日に応当する日の前日に満了する。ただし、月又は年によって期間を定めた場合において、最後の月に応当する日がないときは、その月の末日に満了する。 引用終了 記 Function singlem(dt As Date) As Date Dim kekka As Date If dt <> EoMonth(dt, 0) Then If Day(dt) + 1 <= Day(EoMonth(dt, 1)) Then kekka = callDate(Year(dt), Month(dt) + 1, Day(dt) + 1) Else kekka = callDate(Year(dt), Month(dt) + 2, 1) End If Else kekka = callDate(Year(dt), Month(dt) + 2, 1) End If singlem = kekka End Function
各セルに カレー　500円 かつ丼　600円 うどん　400円（通常450円） きつねうどん　500円 ナポリタン　600円 と入っています。ここから値段だけ抜き出したいと思っています。 データの形式は、順に文字・１スペース・金額・円は決まっていて、 円の後ろに追加で文字・数値が入る場合があります。 最初の三つだけであればmid関数・find関数でどうにかできましたが、 「きつねうどん」以降では処理ができません。 どのようは方法がありますでしょうか。 宜しくお願いします。
　　　　A　　　　B　　　　C　　　　D　　　　E　　　　　　F　　　　G １　　　◎　　　　　　　　◎　　　　◎　　　　△　　　　　 ２　　メロン　　　　　　メロン　　すいか　　　なし　　　　 と入力されている場合，F1に「メロン２」（あるいはF1・G1それぞれに「メロン」「メロン」の反映でも可）のように反映させることができる方法がありましたら，ぜひご教授いただきたいと思います。どうぞよろしくお願いいたします。
行ごとに判定するマクロについて教えて下さい。 下記のようなマクロで、添付ファイルのように、行ごとで E列からN列で違った数値がないか、入力されていないセルがないかを調べ ４つすべてのセルが同じ数値でない場合は塗りつぶしはされず O列にOKを表示しないようなマクロを組みたいのですが 現在のマクロだと、行ごとではなく、E3～N102セルまでの中で 同じ数値がないかを判断してしまっているため K11セルやK15セルのように数値が入力されていないにも関わらずO列の部分にOKが出てしまいます。 他の行に同じ数値が入っているのは関係なしにして 11行目なら11行目だけで 15行目なら15行目だけで、というように行ごに判定していくには どのようにすればいいでしょうか？ Sub 判定マクロ回転() Dim i As Integer, j As Integer Range(Cells(3, 15), Cells(102, 15)).ClearContents For i = 3 To 102 For j = 5 To 14 Cells(i, j).Interior.ColorIndex = 0 If WorksheetFunction.CountIf(Range("E3:N102"), Cells(i, j)) > 3 Then If Cells(i, j).Row Mod 2 = 1 Then Cells(i, j).Interior.ColorIndex = 6 Cells(i, 15) = "OK" Else If Cells(i, j).Row Mod 2 = 0 Then Cells(i, j).Interior.ColorIndex = 40 Cells(i, 15) = "OK" End If End If End If Next j Next i If WorksheetFunction.CountIf(Range("O3:O102"), "OK") > 99 Then MsgBox "データチェックOK(^O^)b" End If End Sub
　　　　　A　　　　　　B　　　　　　　 １　　　　２　　　　りんご２ ２　　　　４　　　　りんご１,メロン３ ３　　　　３　　　　メロン１,みかん１ 上記のように，A列セルには数字が入っていて，B列セルには文字列と数字が入っています。 A１セルの値と，B1の文字列に含まれている数字は合致しているので，セルの色はそのままです。A2セルの値とB2の文字列に含まれている数字の合計が合致しているので，ここもセルの色はそのままです。しかし，A3セルとB3の文字列に含まれている数字の合計は合致していないので，B3セルに色を付けたいのです。 B列のセルは，１つのセル内に文字列と数字を入力することを前提に考えていますが，こうしたことは可能でしょうか？可能であれば教えていただけたら幸いです。
添付図のように、日付が入っている行に対して 上から番号を自動で打ちたいです。 条件 ・ この日付が入っている行は空欄行を超えて頻繁に上下入れ替わります。 ・ 入れ替わった後は、番号も入れ替わり後の位置に準ずる値になります。 今は手作業でやっているのですが、関数でどうにかできないでしょうか。 （マクロは使用しない方向でお願い致します）
宜しくお願いいたします。エクセルでY列に商品名があります。そして、N列からX列までその商品のコードが書かれてます。何故1個のコードのものと、10個近くあるものがあるかというと、画像では書いてませんが、実は、味違いの各種があるということです。コードは抜き取りましたが、名前は一つにしてあるのです。これを、帳票からこのコードを使い各データをブイルックや、インデックス、match関数でデータを抜き取りたいのですが、横にコードを、記載したので、空白行を入れて各コードを縦書きに独立させたいのですが、手作業だと、行がいっぱいあるので、時間のロスが出てしまいます。何かいい方法あるでしょうか？お力お貸しください。
Excel2010で図のように、隣のセルから移動させて、1行にしたいのですが、 簡単にできる方法はありますでしょうか？ よろしくお願いいたします。
特定のセルでダブルクリックすると「〇」が入り，再度ダブルクリックすると「〇」が消えるコードを調べ，以下のものです。 Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) Const rng As String = "A1:B3" '処理対象のセル範囲 If Not Application.Intersect(Target, Range(rng)) Is Nothing Then If Target.Value = "" Then Target.Value = "○" Else Target.ClearContents End If End If End Sub 試してみましたが，「実行時エラー13　型が一致しません」というものが出て，デバックというところをクリックすると，If Target.Value = "" Thenのところが黄色くなり矢印が出ていたのでここが問題かなと思うのですが，どのように修正すればいいのか分かりません。教えていただけると助かります。
例えば あるブックのシート上に 　　　　A　　　　　B　　　　 　C　　　 　　D １　　４月　　　　５月　　　　６月　　　　７月 ２　　１６　　　　 ５　　　　　９　　　　　２３ ３　４月２８日　５月３１日　６月２９日　７月２７日 というデータが入っているとして，A2の「１６」，B2の「５」，C２の「９」，D2の「２３」の数字が，当該月末日（それぞれ４月，５月，６月，７月）に近い当該月内の最終平日を迎えたら表示されるように，条件付き書式で設定できないかどうか？と考えています。 あるいは，ある日にちを別セル（例A3に４／２８，B3に５／３１，C3に６／２９，D3に７／２７）を入力し，その日にちが来たらA2の「１６」，B2の「５」，C２の「９」，D2の「２３」の数字が表示されるようにできないかと… 条件付き書式，関数，マクロ…どのような方法でも構いませんので，ご教授頂けましたらありがたいです。どうぞよろしくお願いいたします。
エクセルのブック内にある複数のシートを分割して保存するとき ブック名+シート名．xlsx とファイル名を付けて保存する方法があれば教えていただけないでしょうか。 よろしくお願いします。
毎日毎日エクセルで同じ作業をしているのに マクロやVBAを学ぼうと思わない人って どういう思考回路なのでしょうか？ 少しでも効率良くしようとか 時間短縮しよう 楽しよう と思わないのでしょうか？ マクロを知らなくても少しエクセルの事を調べれば 関連して知れると思うのですが。 時間をかけて仕事をすればするほど 頑張ってると思ってるのでしょうか？
最初に、「検索するセルの範囲内から文字を表示する方法」の質問で回答をいただいた方々には大変ご迷惑をおかけしまして申し訳ありませんでした。 それでは本題ですが、A行とD行には次のような文字が入力されています。 A15：USDJPY A16：EURUSD A17：GBPUSD A18：AUDUSD A19：USDCHF A20：USDCAD A21：NZDUSD D5：USDJPY D6：EURUSD D7：GBPUSD D8：AUDUSD D9：USDCHF D10：USDCAD D11：NZDUSD D12：EURJPY D13：GBPJPY D14：AUDJPY D15：CHFJPY D16：CADJPY D17：NZDJPY D18：EURGBP D19：EURAUD D20：EURCHF D21：EURCAD D22：EURNZD D23：GBPAUD D24：GBPCHF D25：GBPCAD D26：GBPNZD D27：AUDCHF D28：AUDCAD D29：AUDNZD D30：CADCHF D31：NZDCHF D32：NZDCAD 次に、関数式の条件は以下の通りです。 1.　D行で「JPY」の文字が含まれている場合は、全て「USDJPY」と表示します。 2.　D行で「USD」の文字が4文字目以降の場合は、全て「不要」と表示します。 3.　D行で「USD」の文字が1文字目からの場合は、D行を表示します。ただし、「USDJPY」の場合は除きます。 4.　D行で「JPY」も「USD」も含まれない場合は、D行の右側の3文字に当てはまる文字列をA15からA21の範囲から検索し、部分一致する文字を表示します。 「4」の意味は、 例えば、D18の「EURGBP」であれば、右側の3文字が「GBP」なのでA15からA21の範囲で「GBP」が含まれるA17の「GBPUSD」を表示します。 また、D21の「EURCAD」であれば、右側の3文字が「CAD」なのでA15からA21の範囲で「CAD」が含まれるA20の「USDCAD」を表示します。 関数はI5からI行に表示するようにしており、I5の式は次の通りです。 =IF(OR(NOT(ISNUMBER($B$7)),NOT(ISNUMBER($J5))),"",IF(NOT(ISERROR(SEARCH("JPY",$D5,1))),"USDJPY",IF(SEARCH("USD",$D5,1)=4,"不要",IF(SEARCH("USD",$D5,1)=1,$D5,VLOOKUP("*" & RIGHT($D5,3) & "*",A$15:A$21,1,FALSE))))) しかし「4」のD行で「JPY」も「USD」も含まれない場合、「#VALUE!」のエラーが表示されてしまいます。 それを「4」のように表示したいのですが、どのような関数式にすればよいのでしょうか？ Excel2016です。 回答よろしくお願いします。
wifiでエクセルオンラインを使うと サーバーに保存できないときがあります。 でもインターネットは繋がっているので wifiは使えています。 エクセルオンラインは wifi環境では使えないのでしょうか
Excel2016で、検索する文字の一部が一致する場合、検索するセルの範囲内から文字を表示する関数を教えてください。 例えば次のような文字列があるとします。 A1：EURUSD A2：GBPUSD A3：AUDUSD A4：USDCHF A5：USDCAD A6：NZDUSD B1：EURGBP B2：EURAUD B3：EURCHF B4：EURCAD そこで、A1からA6の範囲からB行の右側の3文字に当てはまる文字列をC行に表示させたいのですがどうすればよいでしょうか？ 例えば、B1の「EURGBP」の右側の3文字は「GBP」のため、A1からA6の範囲でA2が当てはまるため、C1は「GBPUSD」となります。 B4は「EURCAD」で右側の3文字は「CAD」のため、A1からA6の範囲でA5が当てはまるため、C4は「USDCAD」となります。 回答よろしくお願いします。
エクセルのある列に数値を入力すると、自動的に隣の列に結果（消費税の金額や、対応する勘定科目など）が表示されるようにしたいです。 例えば、B列、あるいは、1行目をタイトル行にすれば、B2より下のB列に数値を入力していくと、隣のC列に結果が表示されます。 もう少し具体的に例示すると、B2セルに100と入力すると、C2セルに、消費税の金額、8が表示されます。 あるいは、B2に100と入力すると、C3に100に対応する勘定科目が表示されます。 もちろん、C２に＝B2＊8％という式を入力していてもいいのですが、その場合、事前に式を入力する必要があります。 しかし、B列の何行目まで入力するのかわからないので、事前に式を入力せずに、このようなマクロを記入したいと思います。 また、勘定科目名が表示される場合も、通常であれば、vlookup式をC列に代入し、隣のシートの勘定科目とコードの対応表を参照させますが、同様の理由で、式を事前に入力しないようにしたいと思っています。 イベントプロシージャーでするようですが、どのような変数を使って表示するのかよくわかりません。 宜しくお願いします。
エクセルシートに 2016/12/28 など 2015/12/28 に置換したいです。 要するに年度のみ変えたいです。 でも一つのセルに 「今日は2016/12/28です。」 のように、日付以外の文字も入ってる時は対象外としたいです。 なので画像の様に ******************************************* 検索する文字列→2016/??/?? 検索後の文字列→2015/??/?? セル内容が完全に同一であるものを検索する ******************************************* という条件にしました。 「?」はワイルドカードで、一文字と言う意味として使っています。 この条件だと 「2016/??/??」は、2016/12/28に該当するので置換対象となりますが 置換後に 2015/??/?? になってしまいます。 「2016/」 から 「2015/」は別の条件もヒットしてしまうので考えてません。 ちなみに ******************************************* 検索する文字列→2016/##/## 検索後の文字列→2015/##/## セル内容が完全に同一であるものを検索する ******************************************* にした場合は、検索にも引っかかりませんでした。 「#」はワイルドカードで、数値と言う意味だと思っていました。
エクセル２０１３使用しています。 シート４、A列に（１～１０）グループ番号がついたデータがランダム入っています。 シート１、Ｈ３にグループ番号１を選択時、シート４の該当するグループ、　I列の最終データのみを、シート１　I3に抽出したい。 シート１、Ｈ３グループ番号は選択できるようにしています。 関数を用いてする、方法を 教えてください 添付写真；シート４ グループ番号１の最終データはAAA110となり、シート１　I3セルにAAA110を表示させたい 説明不足で申し訳ありません!!
win8.1　エクセル２０１０です。 下のバーからエクセルの「最近使ったもの」から該当のファイルを開くと シフトキーを押しながらそのファイルを起動しても Workbook_Openイベントが起動してしまいます。 しかしエクセルのアプリケーションを開き 最近使用したファイルから同じファイルを開く時に シフトキーを押しながら開くと Workbook_Openイベントは起動しません。 下のタスクバー（画像）からだとシフトキーを押してもマクロは実行されてしまうのでしょうか？
A1に入れた年月表示をB1に表示しています Ｂ１=RIGHT(TEXT(A1,"ym"),2) 1月から９月までは数字表示ですが、10月＝A 11月＝B 12月=Cと表示したいです。 （例）2016/9 = 69 , 2016/10 =6A ご教授ください
マクロに詳しい方、教えて下さい (1)下記のような、データベースとつながった。 エクセルの表があります。 　在庫の到着日・・・・・営業マンの名前・・・・・営業マンのメルアド １ ２ ３ (2)更新ボタンを押すと、 上からどんどん最新の情報が追加されていきます。 (3)更新ボタンは、一時間に一回押します。 (4)新しい情報が一番上に追加された時、（複数のときもあります） 営業マンのメルアドに、メールを飛ばす、という仕組みです。 【質問】 皆さんならどのようにこの問題にアプローチしますか？ ＜アイデア１＞ ある指定のセルが変更したら、 メールを飛ばすマクロを実行すること考えました。 問題点は、 複数のデータが追加される場合には、これはできません。 ＜アイデア２＞ 前回の更新時の表を記録しておいて、 次の更新との違いがわかるようにする。 問題点は、 そのようなマクロをどのように書いたらいいのか今の私では分かりません。 ありがとうございます。
Excel2003で下記のようなことがしたいのですが インターネット等を見たりしていますが どうしても分からないので質問します。 ------------------------------------- 　　　　　　 B列　　　 C列　 　D列 1行目　　0.978205321 成功　97 2行目　　0.886081752 成功　　 87 3行目　　0.553482324 失敗　 56 4行目　　0.05331816 失敗　　 　6 5行目　　0.562187845 失敗 　1 ------------------------------------- 上記表にて IF関数でD列、1～5行目の中に1がある場合、 1のあるセルの隣(左側) 左列のC列の"失敗"と表示させたい場合 「IF関数とレフト関数を組み合わせてネストすれば 良いのでしょうか？ その場合入れ子のやり方はどうしたら良いのでしょうか？ =IF(D5:D9=1,LEFT(C:C,2))だと計算式自体意味不明となってしまうので、 関数もしくはVBAを使うとどのようなネスト関数/プログラムになるのか 教えていただけませんか？ なにとぞ説明不足なこんな愚かで無知な私どもに ご教授宜しくお願いします。
ある数値のあん分割合を出しているのですが、小数点以下３位まで表示させ、Ａ(0.332) Ｂ(0.668)と出たとします。この数値を別のセルに、Ａの小数点以下３位の２を９に(0.339)、Ｂの小数点以下３位の８を１に(0.661)変換して表示するにはどうすればよいでしょうか。繰り上げ下げではなく、小数点以下３位の値に何が出てもＡは９、Ｂは１にしたいのです。　よろしくお願いします。
エクセルのIF関数で A　B　C　D　E　F 4月5月6月7月8月9月 　　　　　　　　田中 たとえばF列に名前が入っていれば、その列の月を表示させたいのですが、 =IF(A3<>"","4月","")+IF(B3<>"","5月","")+IF(…+IF(F3<>"""9月","") というような式を入れると#VALUE!と出てきてしまいます！ 何か良い方法はないでしょうか？ よろしくお願いいたします。
他のソフトを使用せずExcelの「名前を付けて保存」で形式をPDFにして変換した場合、他の不要なシートは元に戻せますか？ Excelで作成したデータをPDFにして相手方に送るのですが、Excelの他のシートには不要なシート、見られてはマズイシートも含まれています。 もちろん送るときは必要なシートだけを表示してPDF化しているのでそのPDFには他の不要なシートは含まれていません。 相手方がこのPDFデータを何らかのソフトを使ったりもしくは使わなくても、他の不要なシートまで表示させることは可能ですか？　
Excel 2010です。 ワークシートをコピーするたびに、 「あるセル範囲に名前がついています。同じ名前を使用しますか。」 というようなメッセージがでます。 セルのある範囲に名前が付いているようですが、現在は使用しておらず、どこに付いているのかわかりません。 その名前が付いているセルの範囲を探して削除したいのですが、どうやって探せばいいのでしょうか。
現在、セル内の文字を抜き出す作業を行いたいと考えております。 A１セル内に以下の文字が記載されております。 Aさん - 東京 Bさん - 神奈川 XYZさん - 沖縄 ↑ 詳細は 「Aさん(半角スペース)-(半角スペース)東京(改行) Bさん(半角スペース)-(半角スペース)神奈川(改行) XYZさん(半角スペース)-(半角スペース)沖縄」 これを関数で、 B1セル：　Aさん B2セル：　Bさん B3セル：　XYZさん という形でを抜き出す事は出来るのでしょうか。 セルによっては、以下の様に入力されております。 セル内に入力されている人の数に限りはありません。(最大で20名位) A2セル：　 　　Bさん - 神奈川 A3セル：　 　　XYZさん - 北海道 　　CDさん - 静岡 A4セル： 　　DDDDDDさん - 山梨 　　AEさん - 千葉 　　CCCさん - 大阪 　　Oさん - 高知 ・・・ という形で続いております。 ご教示いただけると大変助かります。 よろしくお願い申し上げます。
現在、セル内の文字を抜き出す作業を行いたいと考えております。 A１セル内に以下の文字が記載されております。 Aさん - 東京 ↑ 詳細は「Aさん(半角スペース)-(半角スペース)東京」 これを関数で、 Aさん のみを抜き出す事は出来るのでしょうか。 これが、 A2セル：　Bさん - 神奈川 A3セル：　XYZさん - 北海道 ・・・ という形で続いております。 ご回答いただけると大変助かります。 よろしくお願い申し上げます。
【エクセル】1度チャックを付けると、そのチャックを削除出来ないようにするにはどうすればいいですか？ マクロ？編集固定？ 1回チャックを付けると、誤って消してしまう誤りを無くしたいです。 マクロ？VBA？の知識がないので0から教えてください。 チェックボックスの出し方も分かりません。 ワードでも良いです。
現在、Excelを使用し、集計を行っております。 皆様のお知恵をお借りできれば幸甚です。 【実現したいこと】 添付「画面.JPG」にある＜Sheet 2＞の様に情報を纏めております。 (セル内では改行をしております。) ↓ ＜Sheet 1＞の様な形で、 「対象」を一番左にして、それぞれの対象に該当する情報がB列より右に入る様にしたいと考えております。 関数のみで対応できると非常に助かります。 そもそも関数では対応できない等のアドバイスもいただけると、他の方法を考える一歩となりますので、ありがたいです。 何卒、よろしくお願い申し上げます。
お世話になります。 エクセルで作業していたのですが、いつのまにかA1列が非表示になっていました。 再表示にしたいのですがどうすればいいのかがわかりません。 以下のURLに書いてあることをやってみましたが、すべてだめでした。 http://www.moug.net/tech/exopr/0030088.html 何か有効な方法はありますでしょうか。 よろしくお願いたします。
縦軸ののみのベクトル合成の計算を関数で行いたいです。 例えば、A点: +14.33、B点: +2.07、C点: -10.02　のとき、あるソフトでは+8.56という結果になるようですが、これを関数で計算するにはどういう数式で表せますか？
お世話になります。 以前、下記質問をし、締め切ったのですが、もう一点、教えていただきたい点がありました。 質問 エクセルマクロで、sheet1のE列の6～30行に指定する文字が入力された際、 B列のその同じ行にある文字を取得し、その取得した文字をsheet3のC6から K6まで書き出していきたいのですが、どのようにしたらよいでしょうか？ ご回答 Private Sub Worksheet_Change(ByVal Target As Range) 　　Dim i As Long 　　Dim r As Range 　　Const 指定文字 As String = "X" 　　Set r = Range("E6:E30") 　　If Target.Count > 1 Then Exit Sub 　　If Intersect(r, Target) Is Nothing Then 　　　　Exit Sub 　　End If 　　If Target.Value <> 指定文字 Then 　　　　Exit Sub 　　Else 　　　　'大文字小文字を区別する場合 　　　　i = ActiveSheet.Evaluate( _ 　　　　　　"SumProduct(EXACT(" & r.Address & ",""" & 指定文字 & """)*1)") 　　　　'大文字小文字を区別しない場合 　　　　i = WorksheetFunction.CountIf(r, 指定文字) 　　　　 　　　　Application.EnableEvents = False 　　　　Worksheets("Sheet3").Cells(6, i + 2) = _ 　　　　　　Target.Offset(, -3) 　　　　Application.EnableEvents = True 　　End If End Sub このご回答を、 取得した文字をsheet3のC6からK6までに4列毎に書き出して いく場合にはコードをどのようにしていけば良いのでしょうか。 C6→H6→M6→・・・ すみません、再度お願い致します。
Excel2010で、任意のセルのフォントの色が「赤」だったら、その列の空のセルに「赤」等のフラグを立てて、条件付きで列に色を付けたい。 ＶＢＡ等マクロは使えません。 なんとか関数で対応したいと思っています。 ご教示方、よろしくおねがいします。
ベクトル合成というのかどうか分かりませんが、360度の円の3点をベクトル合成した点の度数は何度か、という計算がしたいです。エクセルの関数でできませんでしょうか？　例えば、0度、50度、120度、のベクトル合成点は何度か？という計算式です。
エクセル2013です。他のエクセルブックからリンクを張っているとき、以下のマクロで調べることがわかりましたけど、そこでわかるのは、ブック名どまりであって、シートやセル番地はわかりません。わかりたいのは、こっちのブックのどのシートのどのセルが、あっちのブックのどのシートのどのセルとつながっているかです。 わかる方法はないものでしょうか。なお、このマクロは、以下のホームページに書いてあったものです。 https://www.moug.net/tech/exvba/0060039.html Sub GetLinkInfromation() Dim Var As Variant Dim Msg As String Dim i As Integer Var = ActiveWorkbook.LinkSources(xlExcelLinks) For i = 1 To UBound(Var) Msg = Msg & Var(i) & vbCrLf Next i MsgBox Msg End Sub
２の２乗を 2^2 と書けば、excel のセルに書き込めますね。 でも 2 肩に 2 と書きたいのです。別に、自動計算をするわけではありませんから、 図形として張り附けられればよいのです。
あるセルの計算結果次第で音を鳴らすという事をやりたいです。 Private Sub Worksheet_Change(ByVal Target As Range) If Target.Address(False, False) = "B1" Then If Range("B1") > Range("A1") Then Shell "C:\Program Files\Windows Media Player\wmplayer.exe C:\音楽ファイル.wav", 0 End If End If End Sub この内容で、B1とA1に直接、数値を入れて条件を満たすと音が鳴るのですが、B1とA1がそれぞれ別のセルの値を参照している式にすると音が鳴らないのですが、そのような場合はどうすればいいでしょうか。 現在、B1セルは=B10を参照して、A1は=A10を参照する式になっています。 また、あるセルに =IF(H34<G34,"",IF(H34=G34,"同","★")) という式を入れて、このセルが★になった場合に上記と同様に音を鳴らしたいのですが、その場合はどのような記述にすればよいのでしょうか。
Excel2013をWindows10で使用しています。 現在、グラフを変更させたいと思い、プロットする範囲を移動させることをやっています。 ですが、全部のデータがきれいに移動してくれないので、困っています。添付の画像の紫色の部分が横軸になるのですが、この紫色のセルの選択範囲の移動が上下のみで、左右に移動してくれないので、困っています。どうすれば可能になるのでしょうか。 作ったグラフはモノクロでも分かりやすく表示させるため、書式を細かく変更しています。一から新しいグラフを作るのは、大変な手間になります。もし、一からやり直さなければいけないなら、グラフの書式の保存方法も教えてもらえると、助かります。
エクセルの勤務表から、日付別に出勤者とその出勤者の勤務を抜き出すマクロを作りたいのですが、途中で分からなくなってしまい困っています。 初めまして。私はマクロを初めてまだ、２ヶ月の初心者でございます。 質問内容に、不手際がありましたら、ご容赦ください。 勤務表マスタには勤務表があり、それ以外にsheet1 からsheet30まで、３０枚のシートを用意しておき、日付別にsheet1に４月１日の勤務者とその出勤者の勤務を（早番はB3から下に表示し、遅番はB8下に表示するようにします。）抜き出し、同じようにしてsheet2には、４月２日の勤務者とその出勤者の勤務を、同じように、それぞれB３とB８に抜き出し…というように、３０日分抜きだしたいのです。休みの人は表示しません（画像写真を参照願います。見にくい写真で恐縮でございます。） ＜勤務表マスタ＞ 名前4月1日4月2日4月3日4月4日… 坂本遅番早番遅番休み… 井端早番休み早番遅番… 長野遅番早番早番早番… 阿部遅番遅番遅番早番… 村田休み早番遅番遅番… 高橋早番遅番休み遅番… ＜sheet1=４月１日＞ （B3、C3から下に） 井端早番 高橋早番 （B8、C8から下に） 坂本遅番 長野遅番 まずは、勤務表から４月１日だけをとりあえず抜き出そうと、マクロを作って、勤務表マスタから、sheet1である、４月１日には、転記できたのですが、同じように、sheet2(４月2日)、 sheet3(４月3日)…と勤務表マスタから、各シートに転記するには、どうすれば良いのか？分からなくなってしまいました。 力技で、このマクロの「Sheet1」の部分を「Sheet2」にするようにしてといった感じで、あと３０個書けば、できるような気もしますが、膨大な行数になりますし、何か他の方法をと考えたのですが、まだまだ、初心者で、どうすれば良いのか全く思いつきません。ここまで、インターネットで調べたりして、何とか作ったもので、全く幼稚なマクロかと思いますが、なにとぞ、ご鞭撻のほど、よろしくお願い致します。 Public Sub test() Dim strSerch1 As String Dim strSerch2 As String Dim LastRow As Long Dim i As Long, j As Long, k As Long '検索する文字を以下の二つの変数に代入 strSerch1 = "早番" strSerch2 = "遅番" 'Sheet1に「早番」の人をリスト化するための変数を設定 '最初に入れるのが3行目なのでjに3を代入 j = 3 With Worksheets("勤務表マスタ") '.Cells(.Rows.Count, 1).End(xlUp).Rowで最後の行がどこなのか調べて 'LastRow変数に代入する。 LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row For i = 2 To LastRow 'ここで2列目を検索して、「早番」の人がいたら、Sheet1の３行目から、リスト化する。 If .Cells(i, 2).Value = strSerch1 Then Worksheets("Sheet1").Cells(j, 2).Value = .Cells(i, 1).Value Worksheets("Sheet1").Cells(j, 3).Value = .Cells(i, 2).Value j = j + 1 End If Next i End With 'Sheet1に「遅番」の人をリスト化するための変数を設定 '最初に入れるのが8行目なのでkに8を代入 k = 8 With Worksheets("勤務表マスタ") LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row For i = 2 To LastRow 'ここで2列目を検索して、「遅番」の人がいたら、Sheet1の８行目から、リスト化する。 If .Cells(i, 2).Value = strSerch2 Then Worksheets("Sheet1").Cells(k, 2).Value = .Cells(i, 1).Value Worksheets("Sheet1").Cells(k, 3).Value = .Cells(i, 2).Value k = k + 1 End If Next i End With End Sub
エクセルＶＢＡで ループして長時間のマクロを実行しているのですが そうするとタスクマネージャーの アプリケーションタブで見ると 該当のファイルの状態が「応答なし」になります。 でも実際はマクロは動いていて 結果は得られています。 応答なしでも実は動いているのでしょうか？ win7、エクセル２０１０です。
以下のような表があって、その中から条件に一致する行を削除したいのですが、 よくわからず困っています。 　　　A　　　　B　　　　C　　　　D　　　　E 1　　No,　　伝票種類　管理No,　　日付　　部署 2　　　1　　A伝票　　 16-001　　15/8/29　営業課 3　　　2　　B伝票　　 16-021 15/10/11 販促課 4　　　3　　A伝票　　 16-009 15/9/10 広報課 この表で、 F1セルに「削除する伝票種類」、 F2セルに「管理No,」を入力した後、 シート上に作成したコマンドボタンをクリックすると該当するナンバーの伝票種類、管理No,、部署を削除するようにしたいのです。 For i = 2 To cells(Rows.count, 1 ).End(xlUp).Row IF cells(i, 2) = Range("F1").value And cells(i,3) = Range("F2").value Then Range(cells(i , 2) , cells( i , 3) , cells(i , 5)).Select Selection.Clear End If Next i にすればいいのかなと思ってやってみたのですが、 削除されないのです。VBAに関しては初心者なのでよくわからず困っています。 どなたか助けていただけると嬉しいです。 よろしくお願いいたします。　　　　
こちらの識者の方々にはいつもお世話になっています。 VBAの質問です。 環境は下記になります。 OS=windows7 pro 64bit Office=Excel2010(14.0.7128.5000) ・やりたいこと ファイルサーバー内にある50個ほどのフォルダにそれぞれファイルを保存するコードを書いているのですが、 フォルダの存在チェックと、そのフォルダに書き込み権限があるかどうかのチェックを実際にやりたい処理の前にしようと思っています。 フォルダの存在チェックはDir関数でやるとして、書き込み権限があるかどうかは、.xlsxファイルを作成せずに、txtファイルを作る（作ろうとする）ような方法があった気がします。 とにかく軽ければやり方については特に頓着していないのですが、\\FileServer\直下にフォルダ名が1～50のフォルダがあると仮定し、例文を教えていただけますでしょうか。 質問に不備不足等ございましたらご指摘ください。 ご面倒お掛けしますがよろしくお願いします。
お世話になります。 エクセルマクロで、sheet1のE列の6～30行に指定する文字が入力された際、 B列のその同じ行にある文字を取得し、その取得した文字をsheet3のC6から K6まで書き出していきたいのですが、どのようにしたらよいでしょうか？ if関数も考えましたが、条件の設定に困ってしまいます。 マクロで良い方法があれば教えていただけると助かります。
媒体発行日と締切の一覧をエクセルで作成しています。 発行日の曜日で締切日が違うのですが、曜日に関連づけて締切日を自動で表示させるにはどのような関数を使えばいいでしょうか。 発行日は木・日の固定です。これが1か月を通して複数エリアあり、全体で数百となるので効率化を図りたいと思います。 例： 3月17日(木)→3月11日(金)　6日前 3月20日(日)→3月16日(水)　4日前 よろしくお願いいたします。
媒体発行日と締切の一覧をエクセルで作成しています。発行日の曜日で締切日が違うのですが、曜日に関連づけて締切日を自動で表示させるにはどのような関数を使えばいいでしょうか。 例：3月17日(木)→3月11日(金)、3月20日(日)→3月16日(水) よろしくお願いいたします。
以下のマクロを記録しました。 「Sheet１」でA1：B20を選択して、昇順の並べ替えを実行して終了です。 VBEで中身を確認すると、途中にシート名の"Sheet１"が記述されています。 この内容だと、シート名を変更したり、別のシートで実行する場合は、マクロのシート名の記述を変更しないと実行できません。 これだと不便なので、シート名にかかわらず実行できる昇順マクロを作りたいのですが、何か方法はありますか。
エクセル2010使用です。 A1列に入っている文字列に対して B1列にルールを設け、表示させたいです。 （例） もし、A1列に「りんご」と入っている場合、B1列は「果物」と表示 もし、A1列に「レタス」と入っている場合、B1列は「野菜」と表示 つたない説明で申し訳ございません。 初心者ですので、なるべく簡単な方法を希望します。 お願い致します。
添付ファイルの通り、A列、B列、C列にデータがあります。 以下の条件すべてを満たす件数を表示したいと考えております。 ・A列　2016/2/15 ・B列　重複するデータを一件とする ・C列　X この表で言うと４件という結果になる計算式を作成したいところです。 シンプルな計算式をご教授いただきたいと存じます。 どうぞよろしくお願いします。
添付図は Excel 2013 に私が設定した[クイックアクセルツールバー]の一部を示しています(赤枠部分)。 右端は[連続データ]、その左は[文字の割付]だけど、アイコンが同じ●座布団なのでチト困っています。 この２つのアイコンを別々の形状にする方法を教えてください。 右の●座布団を「連続データ」や「連デ」等の文字にしても構いません。
エクセルVBAで次の内容でプログラムしたいと思っていますが、どうもうまくいきません。 1.BOOK1のsheet1のセルC10・セルE10に文字入力 2.1のセルE10に文字入力し確定後、BOOK2が自動的に開く 3.BOOK2・sheet1・セルC4にBOOK1・セルC10の文字を取得 4.BOOK2・sheet1・セルH4にBOOK1・セルE10の文字を取得 5.BOOK2に「（秘）セルC10の文字+（セルE10の文字）・ｘｌｓｘ」で名前を付けて保存 6.BOOK1のsheet1のセルC11・セルE11に文字入力 7.6のセルE11に文字入力し確定後、BOOK2が自動的に開く 8.BOOK2・sheet1・セルC4にBOOK1・セルC11の文字を取得 9.BOOK2・sheet1・セルH4にBOOK1・セルE11の文字を取得 10.BOOK2に「（秘）セルC11の文字+（セルE11の文字）.ｘｌｓｘ」で名前を付けて保存 　以降BOOK1　セルC12~C29、セルE12~E29まで上記を繰り返す 　※セルC、Eの文字入力は29行まで入力されないこともある という感じでBOOK1の決められたセルに入力された文字を BOOK2へ独立した形で振り分け、それぞれ名前をつけて保存していきたいです。 1～4までは何とかできたのですが、ファイル名をつけて保存と、以降の繰り返しが いろいろ参考にしたのですが、うまくいきません。 初歩的な内容で申し訳ありませんが、ご教授お願い致します。
エクセルを互換モードで使用しています。 ページダウンを押して、その後にページアップを押すと、今まで空白セルだったところに突然数字が勝手に入力されてしまいます。 このような症状を経験され修復された方がいましたらご教授のほどよろしくお願いいたします。 ＰＣのスペック等は以下の通りです。 本体：lenovoのノートパソコン OS：ウィンドウズ7（32bit) CPU：Core-i7 オフィス：2010 尚、オフィスについては再インストールを行いましたが改善されませんでした。
数式に間違いがあったので、前回の質問をいったん締め切って、再度投稿いたします。 シートが(1)「値表示」と(2)「データ」の２種類があります。 (2)にはB1:D4、B5:D8、B9:D12というように、セル１２個分にそれぞれ独立したデータ表があり、このデータが全部で１０個あります。 そして、このデータから任意の値を(1)「値表示」シートに表示したいので、(1)のセルA1に「＝VLOOKUP（B1,データ!,B1:D4,2,FALSE）という式を入れます。 これで、(1)のA1(2)のシートのデータ表から任意の値が表示されるのですが、このA1に入力した式をコピーして、A10までそれぞれの表に対応したVLOOKUPの数式を入れたいのですが、普通にコピーするとA2以降に入力される式はデータの参照範囲がA1の範囲から１セル分だけずれたB2：D5となっています。A2が参照する範囲は本来はB5:D8にしたいので、一つずつデータの参照範囲を修正しないとならないのですが、このような場合は、やはり一つずつ修正するしか方法がないのでしょうか。 もっと、素早く参照先を変更できる方法がありましたら教えてください。
縦列に月日が入っています。たとえば、３月1日が黒字で１２ポイントです。『すぐ下のセルに自動で５日後の月日、３月６日を赤字で９ポイントで入れたいのです』 月日のセルは一つ置きではありません。一つ置きの時もあれば、三つ、五つ置きととまちまちです。 どうかよろしくお願いいたします。
「=(D35+D36+D37+D38+D39+D40+D41+D42)/8」と言う平均を求める計算式があります。 Ｄ３５～Ｄ４２の数値が特定の数値以下の場合は平均の計算に加えない計算式はどの様にすれば良いのでしょうか？ 例えばＤ３５～Ｄ４２の範囲の数値が５．０以下の場合は平均を求める計算に加えないと言う感じです。
いつもお世話になります。 A2のセルに4桁の数値が600程あって、数値の最初の数は15から10までの6種類です。 10なら「6年」11なら「5年」、、「2年」「1年」としたいのですが IFとLEFTを組み合わせてもうまくいきません。 良い方法があれば、ご教示ください。
お世話になります。 エクセルVBAで質問です。 下記のような表をエクセルで作り、Ａ列の名称が元フォルダのパス、 そのフォルダの中にエクセルとパワポやワードのファイル名が入っているとします。 その中の全てのファイルをコピーで同じ行のＢ列のフルパスのフォルダ内にコピーしたいのですが、マクロなどでの作成方法を教えてくだい。 Ａ列　Ｂ列 C:\a1　Z:\test1 C:\a2　Z:\test2 C:\a3　Z:\test3 ・ ・ ・ バッチファイルであれば簡単なことですが、エクセルの表で管理したい次第です。 コピー先フォルダ内に同じファイルがあれば上書きしても構いません。(何回実行して同じファイルが上書きされてもOK) 出来ればxcopyで実行したいのですが、VBやVBAで使えるコマンドなのか、また繰り返し処理や応用に慣れてないため、詳しい方ご教授いただけると幸いです。 例えばC列以降に元のコピー対象ファイルを全て書き出してから、それらの一つ一つのファイルを読み込んでB列のフォルダ内にコピーするような動きでも問題ありません。 リスト作成する行の数は毎回決まっていなく、最大で50くらいあります。 ぜひ、ご教授お願いします。
宜しく、お願い致します。 Excel2007を使用しているのですが（Office）、途中で”異常が見つかりました”などとゆうメッセージが表示され、強制終了（ソフトのみ）せれてしまいます。この原因は何でしょうか？セキュリティ・ウイルスソフトを起動しチェックしても、特に異常はありません。 （Word2007には、その様なことはありません）。 アドバイス、宜しく、お願い申し上げます。
エディタなどのテキスト文字をクリップボードにおさめて、エクセルやoutlookなどのoffice2013に貼り付けようとするとビットマップになっておりテキスト文字として貼り付けられません。 先にエクセル等を起動しておいてから、クリップボードにおさめると文字として貼り付けられます。先にクリップボードにおさめることが多いため不便でしかたありません。 以前のバージョンではこのような問題はおきませんでした。2013特有の問題なのでしょうか。 検索等で色々と調べても類するコメントがみつからないということはマシン固有の問題なのかもしれませんが、officeを再インストールしてもなおりませんでした。 なにかいいヒントがあったら教えてください。 なお、クリップボードに納めたものをエクセルの右クリックで「形式で貼り付け」をしようとすると「テキストで貼り付け」はなく「ビットマップ」のみしかありません。 (Windows7)
[15]と入力し、別セルに範囲を作ります。（[10]~[30]） 10～30の間で、入力した数字がいくらかぶるか。15は[5]という返しが欲しいです。（10から数えていくつか） 範囲が10～30なので、 [1] は [0] [20] は [10] [30] は [20] [40] は [20]
添付のような表が作りたいです。 A群とB群にそれぞれ０~６までの数字が入っています。 行ごとで１~６のうち数字の種類が3種類以上だったら〇、3種類未満だったら×と入力します （0はすべて無視します）。 どちらの群にも1種類以上の数字が入っていなくてはいけません（片方の群に3種類ではNG）。 私には難解すぎるのでお助けください。
エクセル２００３です。 セルＺ１に現在の時刻を表記させて（２０○○年○月○日○○時○○分○○秒）何もしなくても１０秒ごとにＺ１に自動で最新の時刻（２０○○年○月○日○○時○○分○○秒）に表記させる方法はありますか？ 計算式やＶＢＡなど方法は何でも良いです。 宜しくお願いします。
[印刷プレビュー]の画面は、添付図の赤点線で示したように、左側にある[部数] の右横を上端として表示されるはずですが、どうしたことかそこは真っ白で、右 端のスクロールバーをずーっと下に下げなければ見ることが出来なくなりました 。 対処法を教えてください。 プリンターからの印刷は正常です。 ちなみに、Win7 Pro SP-1 のパソコンを使用しております。
キングソフトSpreadsheets 2013 での質問です。 作成した表のブランク部分だけを集計する方法はありますか？ 例えば１ヶ月分のカレンダー内で月曜日の出席者の集計をしたい場合、 「休み」のマークが記入されていないブランクの欄だけを目視で数えて いけばいいのですが、人数が多いと時間が掛かるわりに数え間違えが出てしまいます。 自動的に集計できる関数や他に良い方法がありましたら教えてください。
Excel 2013を使っています。 いくつか色わけをしたセルを、色ごとに集計をしたいのですがセルに色をつけるだけで自動集計みたいな設定はないでしょうか。 添付ファイルを添付します。
現在、アンケート結果をエクセルにて集計しようと試みております。 ご教示いただけると非常に助かります。 【実現したいこと】 添付ファイル内の<Sheet2>が求めたい表になります。 具体的にご説明すると、 A1を第一希望にする人は誰でその人の地域はどこか。 A2を第一希望～・・・ という集計をしたいと考えております。 その際、セル内に、 --------------------------- Aさん - 東京 Bさん - 神奈川 --------------------------- という形で表示したいのですが、その際、人の名前と地域の間に ■「半角スペース」「-」「半角スペース」 と複数の人が存在する場合は ■地域の後で「改行」 を入れたいと考えております。 【データ】 <Sheet2>に反映させるデータは<Sheet1>の様に集めます。 マクロを使わずに関数で対応出来る方法があれば大変助かります。 Sheet1からSheet2に直接集計する事が難しい場合は別途シートを用意し、 そのシートにてセルをCONCATENATE(式の中で、改行の為にCHAR(10)も使う)等を利用する事も検討いたしました。 皆様のお知恵をお借り出来れば幸甚です。 何卒、よろしくお願い申し上げます。
例えば、 A1セル「平成28年1月5日」（シリアル値で入力） A2セル「H28.1.5」（シリアル値で入力） A3セル「12345」（数値） と入っている場合に、 関数を使って、 B1セル「平成28年1月5日」（文字列） B2セル「H28.1.5」（文字列） B3セル「12345」（文字列） と表示させることはできるでしょうか？ 形式を選択して貼り付け、とか、VBAでできるのはわかるのですが、 関数だけで（しかも、できれば汎用的な形の関数で） 実現できるのかが知りたいです。
下記のような表があります。 売上げで、昇順に並び替えてます。 Aさんがベスト営業マンということになります。 名前/////////////////////売上げ/////////////////////顧客満足度アンケート得点 A　/////////////////////　100　///////////////////// 80 B　/////////////////////　90 ///////////////////// 90 C　/////////////////////　80　 ///////////////////// 100 でも、Aさんは、顧客満足度が悪い。 Bさんがベスト営業マン、として、一番上に表示させたいと思っています。 そのようにするには、どのような計算式が必要ですか？ 皆さまの知恵をお貸しください。
Excel2013 で作業を始めると、タスクマネジャーのプロセスのMicrosoftExselのCPU使用率が98%台になってしまい、入力が進みません。 表に簡単な数値を入力しているだけです。 入力をスムーズにする方法を教えて下さい。 ハードウェアグラフィックアクセレーターを無効にしています。 Windows7から10にアップグレードして使っています。 また、OneDriveと同期していないのに、エクスプローラーにOneDriveがあり、ファイル名が数字とアルフベットからなるものができています。サイズは0 KBです。 宜しくお願いします。
お世話になります。 初歩的な質問で恥ずかしいのですが教えて下さい。 もし解りにくいようでしたらすみません。 因みに、Excel 2003を使用しています。 A列に各行異なる数字（金額）を入れていきます。 例えば、A1に200、A2に500、A3に300・・・というふうに。 そして、B列には、一行ずらして、それらの累計が表示されるようにしたいのです。 上記の数字で言えば、B2に200、B3に700、B4に1000・・・となるように。 なお、A列にもB列にも、イレギュラーで空白のセルができることがあります。 上記の例を取ると、A1に200、A2に500、A5に300・・・というふうに。 それでもB列には、正しく累計を表示させていきたいのですが、 A列とB列の空白のセルが同じ間隔とも限りません。 A1に200、A2に500、A5に300・・・という場合であっても、 B列はB2に200、B5に700、B9に1000・・・という風に、 正しく累計を表示させていきたいのですが、 そんなことはできますでしょうか。
下に2つのコードを示していますが、パターン1は、配列ｃに一発で一気に速く入れることが出来る雰囲気が表れています。実際に速いそうです。 しかしながら、どちらのコードも、最終的には配列ｃに一つずつデータが入るわけですよね。 なぜ、パターン１だと速いのでしょうか？ 専門的でむずかしいようでしたら、イメージだけでも教えていただけたらと思います。 パターン１ Dim r as Range Dim c() As Variant Set r=Selection c = r.Value パターン２ redim c(r.rows.count,r.columns.count) for i=1 to r.rows.count for j=1 to r.columns.count c(i,j)=r(i,j).value next j next i
添付のような表を作りたいです。 A群の数字とB群の数字があって、行ごとで重複しない値がある場合は〇、ない場合は×をB群の隣に入力できるようにしたいです。 ・A群に１があり、かつB群に２又は３がある ・A群に2があり、かつB群に１又は３がある ・A群に３があり、かつB群に１か２がある ・0はすべて無視する 以上の条件にあてはまるとき〇、該当しないとき×、という感じです。 お助けくださいませ。
VBAを始めたばかりの初心者です。 VBAにて受注データの重複チェックを行い、別シートへ住所録を作りたく奮闘しております。 他のシステムへインポートするため関数を使用するとなぜかエラーが出てしまうのでVBAのみで対応したいです。 Excelはバージョン2016です。 ▼受注データはおおむね下記の状態です。 シート1 A　　　　　　B　　　C　　　D　　　E　　F　　G　　　　H　　　I 受注日　　　電話1　電話2　電話3　名前　住所　商品　　数量　　受注ID 2016/2/5　　11　　　111　　1111　山田　東京　りんご　　5　　123-11111 2016/2/5　　11　　　111　　1111　山田　東京　いちご　　2　　123-11111 2016/2/5　　11　　　111　　1111　山田　東京　バナナ　　6　　123-11111 2016/2/5　　80　　　8888　8888　鈴木　福岡　メロン　　1　　123-22222 2016/2/8　　44　　　444　　4444　加藤　奈良　りんご　　3　　123-33333 2016/2/8　　44　　　444　　4444　加藤　奈良　すいか　　1　　123-33333 2016/2/8　　44　　　444　　4444　加藤　奈良　ぶどう　　5　　123-33333 2016/2/8　　44　　　444　　4444　加藤　奈良　レモン　　6　　123-33333 2016/2/8　　44　　　444　　4444　加藤　奈良　いちご　　2　　123-33333 ▼やりたいこと シート2に受注IDを基に重複しないよう抽出して住所録を作りたいです。 (1)　I列で重複をチェック (2)　B列の電話1ですが先頭にOが削除されて表示されるのでシート2では0を付与してリスト化 (3)　B列～D列の電話番号をシート2のリスト化の際には1つのセルに(ハイフンなしで)まとめる (4)　(3)とは別のセルにB列～D列の電話番号をハイフンを付与してまとめる 　　※電話番号は固定電話と携帯電話の番号が混ざっています。 (5)　住所録はシート2に作成 補足 (3)の情報は別システムのID(コード)として使用します。 (4)はそのまま電話番号として使用します。 ▼理想的な状態 A　　　　　　　B　　　　C　　　　D ID　　　　　　名前　　　住所　　　電話　 0111111111　　山田　　　東京　　　011-111-1111 08088888888　鈴木　　　福岡　　　080-8888-8888 0444444444　　加藤　　　奈良　　　044-444-4444 ▼難しそうなら最悪 A　　　　　　B　　　C　　　D　　　E　　F　　G　　　　H　　　I 受注日　　　電話1　電話2　電話3　名前　住所　商品　　数量　　受注ID 2016/2/5　　11　　　111　　1111　山田　東京　りんご　　5　　123-11111 2016/2/5　　80　　　8888　8888　鈴木　福岡　メロン　　1　　123-22222 2016/2/8　　44　　　444　　4444　加藤　奈良　りんご　　3　　123-33333 までの状態にはもっていきたいです。 Webにて有志のかたの参考情報を基に 受注IDから重複チェックを行い特定のセルのみを抽出することは出来たのですが 行全体を抽出する方法がわかりませんでした…。 よろしくお願いいたします。
Excelで、日本語の住所データを英語に変換しようとしています。 ASC関数などで数字を半角にするところまではしたのですが、 その後、セルの書式で「文字列」にしているにも関わらず 「丁目」「番地」などを置換すると「1-1-1」という感じのデータは、 強制的にに日付データになってしまいます。 対応方法などご存知の方いらっしゃいましたらご教示いただけましたら幸いです。 VBAで対処する方法でも大丈夫です。
以下のコードはどう書いたら良いかお教えください。 ・セルA1からA5に対して（ユーザーが任意に選んだ範囲で、その都度変わります） ・各セルの文字に”あ”が含まれていたら、削除します（”いあう”⇒”いう”） ・各セルに対して処理した結果をC（1,1）～C（5,1）の配列に入れたい
エクセルVBAにて ・”花”という文字を検索します。 ・見つかったセルを切り取り、どこか別のセルに貼り付けます。 ・そして、元々”花”があったセルに”海”と書き込みます。 このような場合、元々”花”があったセルを覚えておくには、どうすればよいのでしょうか？
現在スプレッドシートでC欄に書いてある文字を何バイトか調べて、それを16進法に変換して表示するようにしたのですが（入力する文字は全て1バイト文字なので文字数から計算） その数値の後ろに0を6桁挿入する方法が分かりません。後ろに桁数を足す方法を教えてください。 例 C列50行にstartと言う単語があったらその文字数を数えて、その値に１を加算し有効桁数4桁で16進法変換しました。 =DEC2HEX(LEN(C50)+1,4) すると0006と表示されました。しかし本来は0006000000と表示したいのです。 スプレッドシートで使える関数もエクセルよりある程度減ってると思いますので難しいかもしれませんが、どうにかなりませんでしょうか？
Excelの入門者です。 複数つくらなければならないグラフにおいて、 頑張ってある１つのグラフに色をつけたりして見やすく加工しても、 そのグラフの書式設定などを他のグラフに適用できずに困っています。 同様のデザインにするためには、グラフを作るたびに、 また最初から設定を編集し直さなければならないのでしょうか？ それとも、一度作ったグラフのデザインを保存して他のグラフで読み込むことはできますか？
下図のようなシートがあります。A列：部署名、B列：役職名、C列：部署番号、D列：基幹職No、E列：氏名、F列：基幹職人数、G列：一般職人数、H列：合計人数　と配置されています。ここで各部署ごとの基幹職人数・一般職人数・合計人数をそれぞれ求めたいのです。 基幹職人数(図の黄色のセル)を求めるには基幹職No.の入っている個所をカウントするので、以下の通りとなると思うのですが Sub macro4() ' ' Macro 4 Macro ' Dim Gyo As Integer Application.DisplayAlerts = False Sheets("WORK").Select Gyo = 2 Do While Cells(Gyo, 3) <> "" If Cells(Gyo, 3) <> "" Then If Cells(Gyo, 4) <> "" Then Cells(Gyo, 6).Select ActiveCell.Formula = "=counta(""D"" & Gyo & "":"" & ""D"" & Gyo)" End If End If Gyo = Gyo + 1 Loop Range("A1").Select End Sub 一般職人数及び合計人数を求める場合のコーディングが分かりません。 因みに一般職はD列：基幹職Noが空白となっている個所であり、一般職人数のセルは部署番号が変わる1つ前の行のG列（図の水色のセル)、合計人数も部署番号が変わる1つ前の行のH列（図の橙色のセル)に出力するものとしたいのです。このようなことが出来ますでしょうか。 なお条件として、 （１）組織変更が発生する都度、部署番号・基幹職No・人数も変わる （２）合計人数は部署番号ごとの基幹職人数＋一般職人数とする であります。どうかご教授の程宜しくお願い致します。
エクセル用語での「スプレッドシート」とはどういう意味でしょうか？ ブックの中にシートが入っていますが そのシートとスプレッドシートは違いますよね？
Excelの関数で、 0<E33<19のときB33-E33の値を、 E33がそれ以外のときはB33+24-E33の値を返したいので、 関数を =IF (0<E33<19,B33-E33,B33+24-E33) としたのですがエラーになりました。 どこが間違っているのでしょうか？
excelで、 ｘ≦４のときはX＋２４に、 19≦ｘ≦２４のときはXそのままの値を入力するには 関数をどのようにすればよいでしょうか？ ここでは便宜上、X＝E１０というセルとします。 複数条件？というものなのでしょうか。AND、OR、何を使えばよいのか分かりません。 ≦　←この記号をどう入力すればよいのかも分かりません。
初心者です。よろしくお願いします。 エクセル2007　bookはxsl（互換表示で開いています） ２００シートくらいある請求書です。全シートの同じ場所に角印を押したいです。 自分で考えたコードは１シート目の名前を"FACE"に変え印（"Picture 4"）を貼りつけておきます。 これだとSheets("FACE")に２個目の印が押されてしまいます。 印押しBook.xslのシート１に請求書の雛形と印を用意しておいて マクロを動かすと請求書Book.xslの全シートに印が押されるものが作れますか？ Sub 印押しマクロ2() Dim myTop As Single, myLeft As Single myTop = Sheets("FACE").Shapes("Picture 4").Top myLeft = Sheets("FACE").Shapes("Picture 4").Left Sheets("FACE").Shapes("Picture 4").Copy Dim Sht As Worksheet For Each Sht In Worksheets Sht.Select 　　　　ActiveSheet.Paste 　　　　ActiveSheet.Shapes("Picture 4").Top = myTop 　　　　ActiveSheet.Shapes("Picture 4").Left = myLeft Next Sht End Sub
　セルに打ち込まれた左側から数値、たとえば10番目、20番目、30番目、40番目～に文字色をつけるにはどのようにしたら良いかご教示をお願いします。 　セルは表示形式で「文字列」にしてあります。一つにセルに数字を70～80位打ち込む予定です。 　左側から10番目ごとに（10,20,30,40,50,60,70,80）打ち込まれた数字の色と変えて表示したいと思います。打ち込むのは数字のみです。宜しくお願いいたします。 Excelバージョン 2010 Windows 10
Excelで、 Y軸の値が小さくなるほど、折れ線グラフが右上がりになるようなグラフを作りたいのです。 上手く説明できないのですが、原点OにおけるYの値を0ではなく、 １０にしたいのです。そして、Yの値が１０より低くなればなるほど、折れ線が右上がりに上昇するようにしたい。 というのも、起床時刻のグラフを作りたいのですが、 たとえばXを日付、起床時刻をYの値とすると、通常の折れ線グラフでは、 早く起きればおきるほど、グラフが右下がりになってしまいます。 ７時で起きたらYの値７、１０時で起きたらYの値１０ですので。 だから、早く起きればおきるほど、グラフが右上がりになるように、Y軸を調整したいのです。 折れ線グラフにこだわります。 尚、当方は一昨日に初めてExcel製品を入手したばかりの初心者なので、 あまり難しい専門用語などは理解できませんので、 なるべく平易に解説していただけましたら幸いです。 ※Excelといっても、 正確にはKingsoft社のSpreadsheetsですが、ほぼ同様の機能であるそうなので、 ご回答の際はExcelとして見なしてください。
Excel2016でセルにUSDまたは、JPYの文字がある場合はエラーが出ないのですが、それ以外の文字の場合ISERROR関数を使用しても#VALUE!というエラーが出ます。 関数は以下の通りです。 =IF(OR(NOT(ISNUMBER($G5)),NOT(ISNUMBER($K5))),"",IF($B$5<ROUNDDOWN($I5*IF(NOT(ISERROR(SEARCH("JPY",$D5,1))),100,VLOOKUP(CONCATENATE(MID($D5,IF(OR(SEARCH("USD",$D5,1)=4,ISERROR(SEARCH("USD",$D5,1))),1,4),3),"JPY"),$A$12:$B$18,2,FALSE))*$G5*$B$8/IF($B$8=100000,10000,IF($B$8=10000,1000,IF($B$8=1000,100,))),0),"超過",ROUNDDOWN(IF(ISNUMBER($P5),-$P5,-$I5)*IF(NOT(ISERROR(SEARCH("JPY",$D5,1))),100,VLOOKUP(CONCATENATE(MID($D5,IF(OR(SEARCH("USD",$D5,1)=4,ISERROR(SEARCH("USD",$D5,1))),1,4),3),"JPY"),$A$12:$B$18,2,FALSE))*$G5*$B$8/IF($B$8=100000,10000,IF($B$8=10000,1000,IF($B$8=1000,100,))),0))) エラーが出ているのは以下の「【】」の部分のようです。 =IF(OR(NOT(ISNUMBER($G5)),NOT(ISNUMBER($K5))),"",IF($B$5<ROUNDDOWN($I5*IF(【NOT(ISERROR(SEARCH("JPY",$D5,1)))】～ 数値を表示したいのですが解決方法を教えてください。 回答よろしくお願いします。
すみません。どうなっているのでしょうか？？ あるセルに『=SUM(J18:J48)』と合計を求める関数入れると 『11月2日』と日付が出てきます。そのセルの前後に同じ式を入れると正しく合計が示されます。因みに合計数は27700です。 何が原因なのでしょうか？ エクセルは2010、osはwindows7です。
お世話になります。 標題の通りグラフの軸の書式設定について質問があります。 グラフのY軸を「0,5,10,15,25,30,35,40,45」というように設定しています。 ですが、グラフのデータの関係上下記のように変更しようと考えています。 グラフのY軸「0,5,10,15,20,25,30,65,70,75」 そのため、軸の書式設定→表示形式→カテゴリ「ユーザー設定」と選択し、 「表示形式コード」【[=30]"65";[=40]"70";[=45]"75";0】 とし、特定の数字を故意に変更する設定をしようとしました。 しかし、表示形式コードの「追加」を何度押しても「種類」の中に追加されません。 試しに「表示形式コード」【[=30]"65";[=40]"70";0】と入力し、「追加」を押すと「種類」の中に追加されます。 この表示形式コードはもしかして[ ]内で指定できる数字が2つまでなのでしょうか？ ご回答よろしくお願いいたします。
http://imgur.com/5e8TsP1 上記図のように、シート１のB列に各文字を入力しています。 そして、A列にはもしB列に文字が入力されていたらID代わりの数値を表示する、という式を入力してあります。 次に、シート１のA列、B列をコピーして、シート２に数値としてペーストをします。 すると、A列は空白のはずが、xldown操作をすると元のセルで式が入力されていたものまで選んでしまい、真の空白セルとして認識してくれません。 そこで、このような例の場合、どうコピーペースト、または選択をすれば偽物の空白 セルを生み出さないように出来るでしょうか？ 実際に使用するデータは項目名が多く存在し、マクロですべてのセルを選択→新規ブックを作成してそこにペースト、という処理を行っています。 この時に偽物の空白セルが出ると、データベースに読みこむ際に不都合が生じますので、何とか改善を図りたいです。 VBA、関数、Excel上のテクニックのいずれでも構いませんので、どうかご教授下さい。 よろしくお願いいたします。
EXCELのデータ→データの入力規則の設定で、 入力値の種類を「リスト」にして、 「元の値」を別シートの範囲指定にすると、 その時は指定した別シートの値が表示されるのですが、 EXCELを保存・終了して再度そのファイルを開くと、 設定したはずの入力規則が綺麗に消えてしまっています。 「元の値」を同シートの範囲指定にすると、 保存・終了しても消えずに残っています。 なぜでしょうか？
色の付いたセルへの移動方法で教えて下さい。 添付した画像のような時の場合に 例えばD2セルにカーソルがあって マクロを実行すると そこから次の塗りつぶし（10～16行）のD16に移動するには どうすればいいですか？ 色の付いていないセル（画像でいうと7、9行目）と、 アクティブのセルの色と同じ色がある場合は、 その部分は抜かしたいです（画像でいうと8行目） 色は限定というわけではないので アクティブセルの色と違う色を見つけた場合に その色の塊の一番最後のD列のセルに移動するという感じです。 D16で実行すると次はD19 D19で実行すると次はD31 という感じの事が行いたいです。 ネット色々調べましたが似たような記事はこれぐらいしかありませんでした。 http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1090112035 宜しくお願いします。
Excel 2013 を起動しているとき、Win7 の[タスクバー]上の Excel のアイコンを右クリックして表示される[最近使ったもの]リストが 10個表示されます。(添付図参照) 多分これが最大個数と勝手読みしているけど、この個数を 5個に変更するとか、このリスト中の特定のブック名だけを削除(非表示)にするとか、の設定は出来ないものでしょうか？
Windows　7　Excel　2010を使用しています。Excel　のファイルを開くと添付画像のエラーが出るファイルとそうでないファイルがあります。エラーの右下のOKをクリックするとエラーは消えるのですが、エラーが出ない方法はないのでしょうか・・・・？
日々の残業時間を、Ａ列に時間、Ｂ列に１０分単位で入力しています。 月末には、Ｂ列の合計を３０分単位で丸めます。 例）　　Ａ　Ｂ 　１　　１　２０ 　・　　２　３０ 　・　　１　５０ ３０　　０　４０ 合計　　６　００ 分を集計すると２時間２０分になります。 合計行の分の表記は３０分単位で丸めたいので、 ３０分未満は００、３０分以上は３０と表記したいのですが、 どのように、計算（関数）処理すれば出来るのでしょうか。 毎月のことなので、自動計算出来れば助かるのですが。
エクセル2010使用 sheetAと同じ内容のセルを、sheetBに色つき(セル出も文字でも分かればOKです)で 表示したいです。 説明が下手で申し訳ないのですが、お教えいただければ助かります！
B列 お お い い い い う う ・ ・ こんな感じでデータがあるときに、私が操作したいデータが”い”の場合、”い”の先頭の行番号と最後の行番号を取得したいのですが、お分かりの方教えていただきたい。
添付の様に、データ「現地企業名」が現状でA-Zの順で並んでいるものを、逆のZ-Aの順に並び替えるにはどうしたらよろしいでしょうか。つまり、現在最上に来ている「Amada　Maquinaria　SL」が最後に来るように変更したいのです。 以前のEXCEL2003では簡単に出来たのですが、2013ではどこにその機能があるのかわかりません。 御教示ください。
左図のようなシートがあります。C列（部署番号）の左3桁をキーにデータとシートを分け、右図のようにシート名もその左3桁の名前にしたいと考えています。（部署番号）をキーにする場合は以下の通りとなると思うのですが Sub test1() Dim n As String Dim c, L As Long Dim ws1 As Worksheet On Error GoTo ErrorHandler Set ws1 = Sheets("Sheet1") L = ws1.Range("C65536").End(xlUp).Row For i = 2 To L n = ws1.Range("C" & i) '部門名抽出 c = Sheets(n).Range("C65536").End(xlUp).Row '部門のシートの最終行位置 ws1.Rows(i).Copy Destination:=Sheets(n).Rows(c + 1) Next i Exit Sub ErrorHandler: '部門のシートが無い時の処理 Worksheets.Add.Move after:=Worksheets(Worksheets.Count) '最後のシートの後へ追加 Worksheets(Worksheets.Count).Name = n '部門の名前をシートの名前にする ws1.Rows(1).Copy Destination:=Sheets(n).Rows(1) '1行目の項目名をコピー Resume End Sub （部署番号）の左3桁をキーにした時のコーディングがどうしても分かりません。このようなことが出来ますでしょうか。因みに元データとなる"sheet1"はそのまま残します。どうかご教授の程宜しくお願い致します。
よろしくお願いいたします。 例えば、A2Cell4をA1Cell8で割ると50となり、その数字に%表示で50%としたいのですが、書式設定で表示形式パーセントでやると5000%になってしまいます。どのようにすればいいでしょうか？よろしくお願いいたします。
VBAの初心者本を読み始めたのですが、こういう操作をしたのですが、どのように書くと一番簡単にできますか？記述していただきたいです。 sheet1の全ての内容をsheet2～最後のシートまでコピーして貼り付け (sheet1のタブは左端にあるものとします。そこからsheet2から右にあります。) For～Nextなど使うのでしょうか？よろしくお願いします。
式 =A2&A3&A4&A5 と式 =CONCATENATE(A2,A3,A4,A5) とは同じ結果になりますよね？ 前者より後者の関数を使った方が良いのはどんな場合かを知りたいのです。長年に亘って Excel を使い続けているけど、文字列結合をするときに私は CONCATENATE を使ったことがありません。 添付図をご覧ください。 セル B2 に簡単な式 =B1&A2 を入力して、このセルのフィルハンドルをマウスで「エイヤッ！」とダブクリするだけで、セル B5 には式 =CONCATENATE(A2,A3,A4,A5) と同じ効果が表示されます。このように、“CONCATENATE結合”より“＆結合”の方が絶対便利と思っているので、私の知らない CONCATENATEの特長を知りたくてお尋ねしています。
添付の料金表を集計する、エクセルシートを作ろうとしています。 料金表の数字は、以下の式で計算できます。 小学生　 授業補習　２２５０円 × 時間・日数 ＋９８００円 私立・国立受験フォロー　２７５０円 × 時間・日数 ＋９８００円 中学生 授業補習　２５００円 × 時間・日数 ＋９８００円 受験フォロー　２７５０円 × 時間・日数 ＋９８００円 高校生 授業補習　２７５０円 × 時間・日数 ＋１３４００円 例えば中学生の場合、単純に「２５００ × ○時間 × ○日」と計算できればよいのですが、「＋９８００円」があるので、例えばセルに「=2750*1*8*+9800」と入れると、生徒数が０でも9800が表示されてしまいます。この時に、それぞれのコースのセルにどういう式を立てればよいか、お分かりになる方、教えてください。
エクセル2013です。 そのブック内に、＃ＲＥＦになっている名前があったら、削除してくれるマクロを教えてください。
ご存知の方、ご指導の程よろしくお願い致します。 使用機種等は、Windows 8.1　Excel 2013 を使用しています。 長文での申し訳ありません。最後まで読んでください。 賃金台帳作成中のエクセルの表で説明を求めるのが筋ですが、OKWaveで表示する方法が判らずWordでは理解し難いでしょうがよろしくお願い致します。 A列 　B列 　C列　 D列 　 E列 　F列 　G列 　 H列　 I列 　 J列　を使用 １行目、月日　曜日　始業時刻　終業時刻　休憩時間　勤務時間　時間内　時間外　時間内支給額　時間外支給額 下記の様に表示されていますが、確認と併せて見て下さい。 ２行目　１月１日　木　5:10　17:00　1:00　10:50　8:00　2:50　8,000　16:00 ３行目　１月２日　金　5:30　16:00　1:00　 9:30　8:00　1:30　8,000　0,00 ４行目　１月３日　土　5:10　16:30　1:00　10:20　8:00　2:20　8,000　16:00 ５行目 １月４日　日　5:00　12:00　0:00　7:00　0:00　7:00　0,000　7,700 参考ですが、各列には関数が入っています。 B列(曜日)は、=TEXT(A8,"aaa") C列(始業時刻)・D列(終業時刻)・E列(休憩時間)は、いずれも手入力です。 (最小で１０分単位です) F列(勤務時間)は、=IF(OR(C2="",D2=""),"",D2-C2-E2) G列(時間内)は、=IF(F2="","",IF(F2>$J$44,$J$44,F2)) H列(時間外)は、=IF(OR(F2<=$J$44,F2=""),"",F2-G2) I列(時間内支給額)は、=IF(G2="","",G2*24*$E$41) J列(時間外支給額)は、=IF(H2="","",H2*24*$E$41*1.25) セルが見えませんが、 セルE41(平日の8時間内時給)が、1,000円です。 8時間以上の時間外賃金は、時間内時給1,000*1.25です。 契約時間は、セルJ44に8:00 と入力されています。 特に質問ですが、日曜日の場合のみ何時から何時間勤務をしても、全てが時間外勤務扱いになり、セルE42に時給1,500円を入れています。 カレンダー日曜日に対しセルD42の日に対応するものの合計をもとめます。 関数は、C42=SUMIF($B$8:$B$38,$D$42,$I$8:$I$38) としてあります。 最後に、現在私の関数よりも簡単で推薦されるものがありましたら教えて下さい。 この説明でご理解が頂けるか少し疑問ですが、よろしくお願い致します。 夜分遅く申し訳ありません。
いつもお世話になっております。 VBAにて、Sheet1 の【原価】に【商品】をキーにしてSheet2の【原価】を検索して挿入するコードを作成しました。 元々Shee1の【原価】にはすでに数値が入っていますが、下記のコードを実行すると上書きする処理のため、検索にヒットしない商品の【原価】はエラー【#N/A】となります。 ※画像参照願います。 目的はヒットする商品名の【原価】のみが更新される、 ヒットしない場合エラー【#N/A】を出さないようにする。 改良をご教示頂ければ助かります。 Sub データ検索() Application.ScreenUpdating = False Dim I As Long 　 I = 2 Do While Range("A" & I).Value <> "" 　ThisWorkbook.Worksheets("Sheet1").Range("C" & I).Value = _ 　 Application.VLookup(ThisWorkbook.Worksheets("Sheet1").Range("B" & I).Value, Worksheets　("Sheet2").Range("A2:B65535"), 2, 0) 　I = I + 1 Loop Application.ScreenUpdating = True End Sub
Ｆ列は入力規則を適用してます 花をプルダウンで選択すると何故か、Ｈ列にエラーがでます エラーがでないようにするには、どのようにすればいいのでしょうか？ また、#VALUE!が表示されないようにするには、どのような式を入力すればいいのでしょうか？
たとえばA列とB列（各列３行までデータがあるとする）の和の順位をC列に返したいとき、C1に {=RANK($A1+$B1,$A$1:$A$3+$B$1:$B$3)} と入れましたが計算してくれませんでした。1列和の列を用意せずにダイレクトに順位を返すことはできないでしょうか？アイディアがあればお聞かせ願いたく存じます。
エクセル2010についての質問です。 Sheet１に基本となる資料を作成し、印刷プレビューで確認したところ、わずかに１Ｐでは収まらないので、印刷設定でシートを１ページに印刷の設定を行いました。 その後、同じようなフォーマットで内容を多少変更した資料を５枚作成の必要が有ったので、Sheet1全体をSheet2にコピーして内容修正。同じようにSheet3～5まで全体をコピーして完成させました。その資料をパートの方に渡して印刷を依頼しておいたのですが、Sheet2～5まではわずかに１Ｐには収まらないまま印刷されてしまいました。 Sheet２から５までも同じような印刷設定を行わなかった当方のミスなのですが、この場合、それぞれのシートに『１ページに印刷する』という設定をするよりも、Sheet１の内容をSheet２にコピーする時、印刷設定（１ページに印刷する）そのものもSheet２にコピーする方法は無いのでしょうか？ 以前に他部署の人と会話した時に、そのような印刷設定もコピー出来ると聞いた記憶が有るのですが。
Excel2010で出納帳をつけています。 その中で1ページに収まらなくなったとき、タイトルを2ページ目以降に印刷するように設定していますが、その時1ページ目の最下段の横罫線が印刷されない時があります。 罫線をちゃんと印刷するにはどうすればいいのでしょうか？
添付画像のような表があります。 A1：A5には数値が入力してあります。 1つずつ中を確認し、表示通りであることを確認しています。 D1セルは　=ROUNDDOWN(20000/640800,2)+0.005　の数式で、0.035が表示されています。 D3セルは　=D1=A4　の数式でTRUEが表示されています。 D5セルは　=VLOOKUP(D1,A1:B5,2,FALSE)　の数式で　#N/Aエラーが返っています。 たぶん、エクセル特有の浮動小数点の問題ではないかとあたりをつけ、 D5セルを　=VLOOKUP(ROUND(D1,3),A1:B5,2,FALSE)　に変えると、ちゃんと4が返りました。 でも、そうだとすると、=D1=A4の数式でTRUEが返るのはなぜですか？ ROUND(D1,3)としないとA4とマッチしないのですから、=D1=A4の式はFALSEが返るはずですよね？
エクセルで vlookup関数を大量に使うと （10万行くらいvlookup関数を使う）、 反応がとても遅くていらいらします。 どうにか、速くするアイデアはないでしょうか？
ソーティングの一連の作業をマクロに記録して、別のワークシート上では走らせたら再現しませんでした。記録内容を確認すると、どうやらもともとの作業を記録したワークシートを指定しているようでした。 具体的には、以下の様なコマンドでワークシート「hogehoge01」が指定されているように思います。 ActiveWorkbook.Worksheets("hogehoge01").Sort.SortFields.Clear ActiveWorkbook.Worksheets("hogehoge01").Sort.SortFields.Add Key:=Range( _ "K2:K679"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _ xlSortNormal 実際には、hogehoge01をテンプレートにした別の任意のワークシートで走らせたいのですが、 なにか対策はありますでしょうか。 よろしくお願いします。
エクセル2013を使用しています。 入力があっているかの確認のためのデータ確認用の棒の表示はできるものでしょうか？ 例えば紙に印刷されたものだと、 定規とかをあてて、だんだん下に下げながら確認できるように わかりやすいようにしますが、 エクセルではそのような使い方はできますか？ よろしくお願いします。
画像のことをマクロでやりたいです。 3行目の問いを4行目の問いの上に同じものを貼り付けたいです。 そして1行目にQ1、Q2・・と順番に3行目に問がある上に記述させられますか。 問数は可変です。 よろしくお願いします。
A列日付、B列商品、C列販売数が並んでいるシートが有ります。 同シートにG2に日付を設定、その日付に一致するデータだけを G5以下日付、H5以下商品、I5以下販売数を反映させます。 G5セルに=IF(COUNTIF($A$2:$A$11,$G$2)<ROW(A1),"",INDEX(A$2:A$11,SMALL(IF($A$2:$A11=$G$2,ROW($A$1:$A$10)),ROW(A1)))) の関数を記入します。 上記が参照サイト：http://www.eurus.dti.ne.jp/~yoneyama/Excel/waza/fukusu_data.html　の関数で複数データを取り出す関数です。 今回、この条件に開始日と終了日を設定したいです。 H2に終了日を指定したいのですが、自分で考えた画像の数式ではエラーになりました・・・ 開始終了日指定を指定する関数を教えて下さい。
エクセルバージョンは、2002です。 A列に毎日処理するデータが1000行程あります。 構成としまして、基準となるデータから10行が1つのデータの構成で、途中から1行減って9行の構成に変化します。 途中から9行の構成部分から、10個目の部分に基準となる先頭部分が格納されて、構成データがズレてしまいます。 ズレるイメージ下記の通りです。 縦に並んでいるデータ(データは、文字列や数字です。) 1 2 3 4 5 6 7 8 9 10 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 このデータを各列のセル毎に格納 1 2 3 4 5 6 7 8 9 10 1 2 3 4 5 6 7 8 9 1　→　ズレて10の部分に1が格納 2 3 4 5 6 7 8 9 1 2　→　ズレて9と10の部分に1と2が格納 上記に組んである数式は、下記の通りです。 =INDEX($A$2:$A$1001,ROW(B2)*10+COLUMN(B2)-11) この式をB列からK列迄コピーして、必要な行数迄コピーしています。 このズレが無い様に表示させたい表示は 1 2 3 4 5 6 7 8 9 10 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 このズレが出来ない方法をご教授頂ければ幸いです。 宜しくお願い致します。
添付のE列のように、A列の日付に対して、B~Dの中で「○」のみが表示されている行に対してのみ、3営業日目を表示させるにはどうしたらよいでしょうか。 Workdayは別シートに反映済みとします。 当初、B~Dが空欄の場合は数式を反映しない、というふうにしていましたが、 空欄だけでなく添付図のように「○その他」も除外したいです。
お世話になります。 担当者毎に1シート「担当者別売上数量推移表」という表があるのですが、 そこから「商品別別売上数量推移表」を作成しました。 更にそこから、「担当者・商品別実績表」を単月で作成しました。 質問なのですが、 「担当者・商品別実績表」の月指定を簡単にできないでしょうか？ 現在、 =IFERROR(VLOOKUP(C$4,商品A!$B$6:$Z$23,19,FALSE),0) という数式で19列目の月を指定する数式を入れています。 このやり方ですと19を20に変更するという作業が発生してしまうと思うのですが、 これを「19列目をしている」という数式に置き替えることはできないでしょうか？ 若しくは、 もっと別のスマートなやり方があればご教授頂きたいと思います。 よろしくお願いします。
エクセル作成中に勝手にエラー？中断になり、やり直しする羽目になります。 こまめに保存していますが、頻繁にあるので作業効率が悪いので何とかしたいです。 パソコンは購入して2ヶ月くらいで、新しいのに、不思議です。 私しか使わないし、使っているファイルもまだ10個くらいしないです。 ちなみにDELLを使っています。 よろしくお願いしますm(_ _)m
「ルーチン」ではなく 「サブルーチン」ですか？
VBA　マクロにて B列の１行目から最終行までデータがないことを確認する方法をお教えください
win7　エクセル2010です。 ************************************************* Dim objIE As InternetExplorer Sub Sample1() Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True objIE.navigate "http://www.goo.ne.jp/" Call wait1 Set objIE = Nothing End Sub ************************************************* Sub wait1() Const READYSTATE_COMPLETE As Long = 4 Do Until objIE.readyState = READYSTATE_COMPLETE Loop Do While objIE.Busy = True DoEvents Loop End Sub ************************************************* だと うまく行きますが、 URLの部分の社内のURLにすると 実行時エラー-2147417848(80010108) 「オートメーションエラーです。起動されたオブジェクトはクライアントから切断されました」 になります。 社内のＵＲＬの拡張子は、aspxです。 ウォッチウインドウでobjIEをウォッチ式に登録すると objIE.navigate を過ぎると 中身が、<オートメーション エラーです。> になります。 これは社内のシステムの方でプロタクトがかかっているのでしょうか？
お世話になります。 エクセル2013のVBAについて教えて下さい。 　Q 　　　　　　R 1　タイトル　　　タイトル　←１行目はタイトル行 2　状況出荷済　　出荷済 3　状況準備中　　準備中 4　状況未出荷　　未出荷 このような表でQ列の文字をR列にRIGHTで文字を抽出しました。 行数は表を作る都度変わります。 Rに入っている関数を削除して値のみ残したいです。 １００行だった場合は Range("R2":"R100") Selection.value=Selection.value で実行可能なのですが、範囲が変化する場合はどう書けばいいでしょうか？
Vlookupの結果がエラーの場合、空白とするという式は入れられますが、もしVlookupの結果が「ある特定の文字」であったら、ほかの列を参照するという条件を指定することはできますか？？
エクセル　2010　を使用しています。以前　医療費控除のまとめシートを作成しました。そのシートの中に、受診者名をプルダウンで選択できるようにしたのです。（画像添付）その受診者名を追加したいのです。作成方法が思い出せないのです。教えてください。
エクセルで、「1954/6/21」を「昭和29年(0)6月21日」とやるのはすぐに分かるのですが、今、漢数字にしなさい、と言われました（今画面上の表示は「21-Jul-54」）。 しかも、「21」は「二一」ではなく「二十一」、「10」は、「一〇」ではなく「十」なのです。 関数や、ユーザー定義ではムリなような気もするのですが（表示がそうなっていれば、テキストに取り出せるので、ユーザー定義でも可）、VBAでも構いません（VBAでは、その部分のコードだけで十分で、例えば「A」列に上記「1954/6/21」のデータが入っていて、それを「B」列に書き出す部分だけで十分です）。 きのう中に結果をださないといけなかったので、きのうはとりあえず、「21-Jun-54」を文字列にしてしまって、頭２文字、真ん中３文字、後ろ２文字を抜き出して、それぞれすべて「Select Case」で「1」の場合は「一日」とか「10」の場合は「十日」、「Jan」の場合は、「一月」などと、ある意味、ほぼ手作業でやってしまいました。 しかし、明らかに鈍くさいマクロなので、本番までに、何とかスマートなマクロにしたくて、お尋ねする次第です。 よろしく、お願いします。
これはVBAで作られたプログラムのことを言っているのでしょうか？
よろしくお願いします。 D列のD7から最終行（変動します）を選択して、その行のEからG列に上線は極細の線、 下線は二重線を引きたいのですが構文が解りません。 ご教示お願いします。
人が作ったエクセルファイルなのですが ファイルを開くとリンクについてのメッセージが出ます。 リンクの解除ボタンを押すと 「リンクの解除をすると、 既存の値への外部参照と数式が変更されて元に戻すことできません。 このバージョンを保持するには、 新しい名前を付けてファイルを保存して再度リンク解除を実行してください。 今リンクを解除しますか？」 とでます。 日本語の意味がよくわからないのですが、 【１】 「このバージョンを保持するには」 と言うのは、 現在エクセル２０１０で、 元ファイルもエクセル２０１０なのですが このエクセルのバージョンを指しているのでしょうか？ 【２】 名前を付けて保存せず、今リンクを解除を実行すると 既存の値への外部参照と数式が変更されて 元に戻すことできない という認識で合ってますか？ 「既存の値への外部参照」は何を言ってるのでしょうか？ 数式が変更されるというのは 計算式も狂ってしまうのでしょうか？
セルを選択するとリボンの下のボックスに内容が表示されるかと思いますが、その表示されるボックスが出ないようになってしまいました。 これを再表示する方法を教えていただきたいです。 よろしくお願いします。
参照サイト：http://www.eurus.dti.ne.jp/~yoneyama/Excel/waza/fukusu_data.html A列日付、B列商品、C列販売数が並んでいるシートが有ります。 同シートにG2に日付を設定、その日付に一致するデータだけを G5以下日付、H5以下商品、I5以下販売数を反映させます。 G5セルに=IF(COUNTIF($A$2:$A$11,$G$2)<ROW(A1),"",INDEX(A$2:A$11,SMALL(IF($A$2:$A11=$G$2,ROW($A$1:$A$10)),ROW(A1)))) の関数を記入します。 上記の条件は、参照サイトの下側ページそのままの条件です。 しかし、参照サイトでは、１１列ぐらいまでしか反映されません。 100列ぐらいまで伸ばして使いたいのです。 関数をどこを改造したら反映列を増やせますか？ よろしくお願いします。
エクセルで名簿を作成しているのですが、氏名欄のセルを右クリックする「＝A22&B22」（下の行は　＝A23&B23）となります。セルの書式設定で「文字列」と選択しても変化ありません。なお、他の項目（住所とか電話番号など）は表示されているままです。 氏名欄も表示されている状態（文字列）で保存したいのですが、初心者でやりかたが分かりません。お教えください。
任意のセルから縦(横)方向に 1、2、3、4、… の連続数を入力する方法は、私でも承知しておりますが、 1、2、2、3、3、3、4、4、4、4、…、9、9、9、9、9、9、9、9、9、… のように、2 を２回、3 を３回、4 を４回、… それぞれ繰り返すように入力する(マクロ以外の)方法があれば教えてください。 ちなみに、私が使用する Excel のバージョンは、2002、2013 です。
ｗ７、office2007 ユーザです。 shortcut key の解説に出ておりましたが、excel　シートに　a1セルに１、ｂ１セルに２、c1セルに = a1+b1 とインプットしてから、a1 セルをポイントして、Ｃtrl +Shift +[ を押すと、参照先の c1セルに　カーソルが移る　とありました。ところが、「そのセルは見当たりません」というコメントが表示されるだけです。以前、別のＰＣで試したら巧く行ったことを経験しております。 どうも原因がわかりません。ご教示ください。よろしくお願いします。
こんばんは。 Excel初心者で、できるかどうかもわからない事があるので質問させてください。 横軸：「1985年」など、年刻み 縦軸：0～200,000★ ★この数値を、普通1,000刻みなどの一定幅だと思うのですが、 0、50、100、500、1000、2000、3000…というように、 最初だけ細かく刻みたいのですが、可能でしょうか？ Excelの使い方サイトで探してみたのですが、うまく情報にあたりません。 どうぞ宜しくお願いします。
こんばんは。 Excel初心者で、できるかどうかもわからない事があるので質問させてください。 横軸：「1985年」など、年刻み 縦軸：0～200,000★ ★この数値を、普通1,000刻みなど、一定だと思うのですが、 0、50、100、500、1000、2000、3000…というように、 最初だけ細かく刻みたいのですが、可能でしょうか？ Excelの使い方サイトで探してみたのですが、うまく情報にあたりません。 どうぞ宜しくお願いします。
ABC Co.,Ltd. DEF Co.,Ltd. 会社名が2つありデータの入力規則により、リストを２個作りたいのですが、 「ABC Co.,Ltd.,DEF Co.,Ltd.」 普通に入力すると上記のようになると思いますが、 このようにすると結果リストが ・ABC Co. ・Ltd. ・DEF Co. ・Ltd. の４個になってしまいます。先頭の２つの会社名に選択できるようにするには どうしたらいいのでしょうか？ 宜しくお願い致します。
セル内に、「A」という文字列が存在するならば必ず「BAB」であるかということを判定したいと思っています。 実際には、セル内には「A」が存在するとも限らないし、一つとも限りません。 例えば、セル内が以下の文字列の場合 セル=CCCBABBBCCABB 5文字目の「A」は「BAB」ですが後ろから3つめの「A」は条件に当てはまっていないので判定を「否」としたいのです。
エクセル２０００です。 添付画像から回転コマンドを外のツールバーにドラッグするところまではできるのですが、 添付画像の閉じるを選択するとツールバーにあるアイコンが透明になって認識しません。 何故ですか？ お詳しい方、宜しくお願い致します。
例えば 3000行に亘ってびっしりデータが埋まっているワークシートを考えます。 或るキーワード(例えば、THE NANNY)が列Ｃの何処かの複数セルにあることが分かっているとき、私は当該列全体を選択した後、Ctrl+F で[検索と置換]メニューを表示させ、[検索する文字列]ボックスに“THE NANNY”を入力して、[次を検索]ボタンをツンします。 検索方向は「上から下」になることはご承知のとおり。 此れを「下から上」にするにはどうしたらよろしいでしょうか？ 上から入力してきたデータの直近のものを探したいのです。「上から下」の検索ではどれが直近か判断するのが困難です。まだ、下に在るに違いないと思って[次を検索]を実行したら、最初に戻ってしまうことが多々あって困っています。
Excelで、WScript.Shellを使って、標準出力を経由してデータを取得 Excelで、CreateObject("WScript.Shell")を使って、標準出力を経由してデータを取得したいと考えたのですが、サイズに制限がありそうです。 標準出力のサイズが4096バイトを超えると、DOS窓が閉じず、強制的に終了させると超えた分はどこかへ消えました。 下記のコードで確かめたのですが、何かこの容量の制限を取り払う方法はないでしょうか？ Sub Sample1標準出力0() Dim WSH, wExec Dim sCmd As String Dim Result As String Set WSH = CreateObject("WScript.Shell") sCmd = "type D:\t.txt" Set wExec = WSH.Exec("%ComSpec% /c " & sCmd) Do While wExec.Status = 0 DoEvents Loop Result = "" Result = wExec.StdOut.ReadAll Debug.Print Len(Result) MsgBox Result Set wExec = Nothing Set WSH = Nothing End Sub
エクセルで見やすくするために、条件付き書式で１行おきにセルの色を変えることがよくあります。 その後、特定のセルを目立たせるために別の色にしたいときがあり、「塗りつぶし」をクリックしても、条件付き書式が優先されるので色が変わりません。その対策として ・塗りつぶしの代わりに文字の色を変える⇒ブランクのセルを目立たせたいときには使えない ・ほかの条件付き書式で適当な数式を入れて、優先順位を高くし、別の色を設定する⇒面倒 ・塗りつぶしの代わりに網掛けを使う⇒やはり面倒 どれも微妙です。 理想は条件付き書式で１行おきに色を変える設定は残しつつ、手動で塗りつぶしをクリックしたら色が変わる、というものですが、おそらくそれは無理だと思っています。 何かうまい方法がありましたら教えていただきたいです。よろしくお願いします。
A1に入ってる数字を下記のルールに従い有効数字3桁にまるめたいです。 4桁目がある場合、4桁目を四捨五入する。 ただし、4桁目が5の場合は・・・・ ・3桁目が偶数→4桁目以下を切り捨て ・3桁目が奇数→3桁目＋1。4桁目以下を切り捨て 上記の様な計算式をエクセルで作りたいのですが、 なかなかできず困っております。
都道府県以降の抽出をどうしてもユーザー定義関数で作成したいです。 都道府県の抽出のはできました。 Function Extraction(住所文字列 As String) Dim strPref As String Dim N As Long strPref = Left(Trim(住所文字列), 3) Select Case strPref Case Is = "東京都", "北海道", "大阪府", "京都府" N = 3 Case Else N = InStr(Left(住所文字列, 4), "県") End Select If N > 0 Then Extraction = Left(住所文字列, N) Else Extraction = CVErr(3) '3:#VALUE! End If End Function よろしくお願いします。
他の人が作成したエクセルシートで、なぜか初期入力が「全角カタカナ」に設定されているシートを通常のローマ字入力に戻す方法を教えて下さい。全てのセルで初期入力が「全角カタカナ」に設定されているため、セルを移動するたびに入力変更をしなければなりません。一括でシートごと変更する方法等がありますか？
Win 10 エクセル２０１３　です。 毎日の記録として　気温の最高と最低を記録しているんですが 例えば　３度から１０度と記録したいとき ３-10と　表示したいのに　エンターで確定すると ３月１０日と　月日になってしまいます。 ホーム→　ユーザー定義で数値を　標準にしてokにしても 駄目です。 最近迄できていましたが　急に出来なくなりました ちなみに　新しいエクセルを開けて　試してみても 日付け表示になります。 どなたかご教授頂ければ幸いです
出勤、退社で稼働時間の集計をしたいのですが、18時より翌日の18時迄の場合、合計が00：00になり、24:00時間に成らないので、合計が出来ない、例えば、セルA1に出勤時間、セルB1に退社時間、セルC1合計時間で、セルC1に =F3-E3+IF(E3>=F3,1) を使用してます、又、G9合計欄はSUM(G3:G8)を使ってますが、49:00 になりません、どうすればいいのでしょうか？…（泣）どうか宜しくお願い致します。困っています、早急にお願いします。
お世話になります。 EXCELにて画像のようなデータがあった場合についてです。 例えばA列には受注目安の1回目を入力する欄が設けられており、それぞれの状態を入力します。 OKの場合はそれ以降入力する必要がないのでA列が最終列となりますが、未定の場合はC列の 受注目安2に再度入力しており、それが最終列扱いとなります。 売上も同じような方法で入力していくのですが、その右側にそれぞれの行の一番最後の値が 最終売上、最終目安に反映されるようにしたいです。 ネットで調べてみて最終行の取得などはあったのですが、入力された最終行の取得について 分かりやすい解説が見つかりませんので質問いたしました。 お手数ですが、解決方法をご教授下さい。 よろしくお願いします。
ユーザー定義関数はその関数を作ったファイルでないと セルに直接入力しても関数は出ないのですか 例えば Book1.xlsxとmacro.xlsmというファイルがあります。 macro.xlsmファイルにユーザー定義関数を作成しました。 macro.xlsmだとセルに直接入力しても作成した関数が候補が出ます。 Book1.xlsxだと関数の挿入から見つけないといけません。 macro.xlsmのファイルのThisWorkbookには Private Sub Workbook_Open() Application.MacroOptions _ Macro:="aaa", _ Description:="説明" End Sub と入ってます。
Ａ１に情報と書きます。Ｂ１に評価と書きます。 Ａ２には、何も入力しません。 Ａ３には、=IF(A2="","",A2)　という式を入れます。 Ｂ２には、=ISTEXT(A2)という式を入れます。 Ｂ３には、Ｂ２をコピーして、ペーストします。 その結果、Ｂ３の式は、=ISTEXT(A3)になります。 このようにすると、Ｂ２には、FALSEと出て、Ｂ３には、TRUEと出ます。 Ａ２もＡ３も見た目には、空白なのに、Ｂ２、Ｂ３で評価が違うのはどう理解したらいいのでしょうか。 マクロを作っていたら、この問題で2時間苦しみました。解決策として、Ａ２には空白は入れないこととし、空白にしたい時は０を入れることにしました。
Excel2010のVBAで条件付書式の条件を満たすセルの番地を取得したい 具体的には、 Excel2010のあるシートのあるセル範囲(例えばA1～XFD1048576)に 条件付き書式が付けてあって、 (例えば、数式の条件が満たされたら背景色を赤色にするなど) この条件を満たすセルに指定した書式が付けられて表示されています。 この状態で、VBAで、この条件を満たしたセルの番地を、 順番に取得したいのですが、どのように記述すればよいでしょうか。 【追記】 数式をすべてのセルに入れて検出する方法や セルをひとつずつ数式に当てはめてみていく方法は、 セルが膨大なため容量的・時間的にNGです。 このため、条件付き書式で回避しています。 条件付き書式の判定結果である書式(この場合でしたら背景色が赤色) で判断する必要があります。(書式は背景色が赤色でなくてもいいです) よく分かりませんが、検索の中の書式で指定しても、 この条件付き書式の判定結果の書式はヒットしませんでした。
複数シートから指定の1行を別のシートに行を追加して貼り付けをしたいのですが、コピー元が結合していたり、していなかったりとバラバラなため、貼り付け先がぐちゃぐちゃになってしまいお手上げ状態です。 セルの結合は、行は最大2行ですが、列は1列～6列など添付画像のように統一されていません。 例えば、B3～AC4の中でセルの結合が解除されている場所を検索して、ヒットしたら手動でその部分を結合させるということはできますか？ もしくは他に良い方法はありますか？ ご教示よろしくお願いいたします。 スクリプトは見様見真似で以下のように書きました。 Sub コピー() Dim sh1 As Worksheet Dim FoundCell As Range, FirstCell As Range '「項 目」という文字列を検索 　For i = 1 To Worksheets.Count - 2 '←最大シート数 　Sheets(Sheets(i).Name).Select 　Set FoundCell = Cells.Find(What:="項*目") 　　　If FoundCell Is Nothing Then 　　　　　　MsgBox "見つかりません" 　　　　Exit Sub 　　　　Else 　　　　　　’入力されているセルを右に向かって探す 　　　　Set FirstCell = FoundCell 　　　　Set FoundCell = FoundCell.End(xlToRight) 　　　　 　　'指定の範囲を貼り付け先にコピー 　　 　　　　FoundCell.Resize(2, 25).Copy 　　　　Sheets("SheetA").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteAll 　　　　Application.CutCopyMode = False 　　End If 　Next i End Sub
お世話になります。 Internet Explorer 11 にて、 1) https ログイン後 2) 一覧表画面が表示されるサイトがあります。 その一覧画面には明細へのリンクがあります。 つきましては、一覧表画面の表データと、 リンク先の明細データを取得したいのですが。 ログイン迄の操作は完了させるとして、 表示された一覧画面と、明細画面のを取得する 方法をご教示くださいませんでしょうか？ EXCEL, フリーソフト, 有償ソフト, 参考文献等あれば ご紹介くださいますと幸いです。 こちらのリンクの方法も試してみましたが http://excel-ubara.com/excelvba5/EXCELVBA222.html ログイン後の URL を指定しましても ログイン前の情報が取得されてしまいます。 具体的にサイト名が挙げられず申し訳ございません。 宜しくお願い申し上げます。
ifステートメントで、[が含まれるかどうかを調べたいのですが ****************************** Sub test1() Dim myStr As String myStr = "[aaa]" If myStr Like "*[*" Then MsgBox "[を含んでいます。" End If End Sub ****************************** をやろうとすると 「実行時エラー93　パターン文字列が不正です」 となってしまいます。 ヘルプを見ると ************************************************************ 検索の Like 演算子で指定されているパターン文字列が無効です。 エラーの原因と対処方法を次に示します。 たとえば、文字リスト式 [a-b は、右かっこ (]) がないため、無効です。 リスト式の文字を確認します。 詳細については、目的の項目を選択して F1 キー (Windows) または Help キー (Macintosh) を押してください。 ************************************************************ との事なので、 If myStr Like "*[*]" Then としたら、問題なくできましたが、 [だけが含まれているかどうかを調べることは不可能なのでしょうか？
Ａ列　　Ｂ列　　Ｃ列　　Ｄ列　　Ｅ列 あああ　いいい　ううう　えええ　おおお Ａ列 あああ、いいい、ううう、えええ、おおお 別々のセルに入っているのを一つのセルに「、」で区切って入れたいです。 入れるのはどのセルでもいいです。 よろしくお願いします。
先日は、わたくしの質問に回答を下さった皆さま、誠にありがとうございました。 日本人の優しさに感謝しております。 また、 エクセルで書式や関数等をご教授いただきたくお願いいたします。 全くの初心者でありますため、お恥ずかしい質問になりますが、どうかお助け下さい<(_ _)> 質問内容は、下記の２つです。 【質問内容です】 (1)　Ｂ列にドロップダウンリストで「050」を強制的に選ばせるようにしました。 　　（選択肢は１つなので、わざわざと思われそうですが、０５の後にハイフンを入れる 　　ような方もいらっしゃいますので・・・・） 　　セルの書式設定で050の後にハイフンが表示するようにしています。 　　 　　ここから先がどうしたら良いのか分かりません。 　　Ｃ列に７桁の数字だけを入力してもらい、「５〇〇〇ー〇〇〇〇」としたいのです。 　　セルの書式設定のユーザ定義「５000"-"0000」とし、データの入力規則で「文字列（長さ 　　指定）」長さを「７」としてみたのですが、 　　初めに「０」（ゼロ）を入力するとエラーになってしまいます。 　　Ｃ列をセルの書式設定で「文字列」に設定してないからなのかな？と思いますが、強制的に 　　先頭に５を表示させたいのです。 　　関数は、さっぱり分かりません。 　　先日、回答をいただきながらも、私の知識が乏しいため、出来ないものもありましたため、 　　可能な限り簡素な方法をご教示いただきたく、お願いいたします。 　　 (2)　Ｂ列にＩＰアドレスを入力してもらうため、数字と.（ドット）以外入力出来ないように 　　入力規制をかけたいのです。 　　（ＩＰアドレスの先頭に０「ゼロ」がある場合もあるのでしょうか？その辺のところも 　　加味していただけますと幸いです） 　　以上、２つの質問になりますが、何卒よろしくお願いいたします。 　　
以前、XPの時にはエクセルのセルにも入力中の文字が表示されていましたが、７にしたら入力中の文字や数字は上の数式の表示の枠にしか出なくなりました。何とかセル内に出す方法があったら教えてください。
A列の各セルはAA,BB,CC,DD のいずれかであり、 B列の各セルは 111,222,333,444,555 のいずれかである場合に、 例えば、「A列のセルの値がAA、かつ、B列のセルの値が333」である個数の求め方を教えてください。 (Office 2010)
1行目に日付があり、別シートの入力項目で入れられた年月の1日を開始日として 横に連続して日付が進んでいるシートがあります やりたいことは、月ごとの集計なのですが 集計の列を各月の最終日の直後に入れないといけない事です まとめて最後に持ってくるとか、別シートに集計表とするなら ピボットテーブルも使えそうですが、今回の要望では使えません しかも 何月を入れられ羽化わからないため、列が可変長となります つまり 2月は28日か29日、その他の月は30日か31日で、 一番目指したいスタイルとしては・・・ 2月28日　2月29日　集計　3月1日　3月2日　～～　3月31日　集計　4月1日　～～ ですが、日付が存在しなければスグに集計を持ってくると言うのは 不可能と考えますので、31列固定で考えて 2月28日　2月29日　空欄　空欄　集計　3月1日　3月2日　～～　3月31日　集計　4月1日　～ でも構いません それにしても、計算の結果、月が変われば空欄にして、集計の直後から改めて翌月から はじめるということは、どのような操作で可能となるでしょうか？ どだい、集計を間に挟む事自体無理がありますでしょうか？
今までは問題なかったのに、今日 Excel 2013 の F1キーをツンすると 》 ヘルプが機能していません。ただし、Office.com にアクセスすることによって、 》 最新の記事、ビデオ、トレーニングコースをご利用できます。 のメッセージに見舞われます。 原因と対処法を教えてください。
宜しくお願いいたします。下の写真のように列がJからANまで、行がAN3900まである表に色づけしたいのです。その塗りかたは各行ごとで数字の推移を、表した表で右にいけばいくほど最新で、数字が上がったところを赤で色づけして左の数字と比べて下がってたら青色に塗りたいのです。元々この表は黄色で色づけされてます。宜しくお願いいたします。
Excel2010のVBAで、 MS-DOSのcompコマンドの実行結果を取得したいのですが、 以下の方法ではうまくいきませんでした。 どのようにすればよいでしょうか。(Windows7) ------------------------------------------------------------ Sub test() 　Dim wshShell As Object 　Dim wshExec As Object 　Dim command As String 　Dim file1 As String 　Dim file2 As String 　Dim result As String 　file1 = "C:\test\0128\test.xlsx" 　file2 = "C:\test\0129\test.xlsx" 　'command = "dir /d " & file1 & " " & file2　　　　　'(OK) 　'command = "fc /b " & file1 & " " & file2　　　　　 '(OK) 　command = "comp " & file1 & " " & file2　　　　　 '(NG) 　'command = "echo n | comp " & file1 & " " & file2　 '(NG) 　Debug.Print command 　Set wshShell = CreateObject("WScript.Shell") 　Set wshExec = wshShell.exec("%ComSpec% /c " & command) 　Do Until wshExec.Status 　　DoEvents 　Loop 　If wshExec.StdErr.AtEndOfStream = False Then 　　'エラー 　　result = wshExec.StdErr.ReadAll 　Else 　　'正常 　　result = wshExec.StdOut.ReadAll 　End If 　Set wshExec = Nothing 　Set wshShell = Nothing 　MsgBox result End Sub ------------------------------------------------------------
想像してください A列に１，３，４，５，６，７，９，１０，１１，１２, , ,29999。。。 と所々はハヌケの数値が並んでいます。１～30,000までです。 ここで、この数値の範囲を抽出して3列に分割したいのです。 B列には１～10,000までの値 C列には10,001～20,000までの値 D列には20,001～30,000までの値 という具合です。 BCDに入れる関数はどのようなものにすればよいでしょうか。
宜しくお願いいたします。急いでるのですが列がA2からAJまであり、行がA2からA4000まであるのですが、対象となるのはB列に例えば日産とかのようにメーカー名前が、記載されてます。メーカー名前には他に色々なメーカーが記載されてるのですが、メーカー名ごとに区切りのところに太線で区切りたいのです。列は先程のかさAJのところまで太線で区切りたいのです。マクロで教えてください。宜しくお願いいたします
24/5/1→2012/5/1 28/10/30→2016/10/30 27/6→2015/6/00 右のように変換するためにいつもは =IFERROR(CHOOSE(LEN(G10)-LEN(SUBSTITUTE(G10,"/",)),TEXT(("H"&G10&"/1")+0,"yyyy/m")&"/00",TEXT(("H"&G10)+0,"yyyy/m/d")),"") という関数で変換していましたがどうしてもマクロでやりたいので教えてください。 ※日付が入力されている場所は毎回変わり行の長さも違うので自分で変換したい範囲を 選択してから実行したいです。 27/6のように日が入ってない場合は00をできれば入れたいが無理なようであれば なくてもかまいません。
開始日と完了日の両方が入力されたら、稼働日数を計算する関数がうまくいきません。 例）開始日・・・Ａ1 　　完了日・・・Ｂ1 Ａ1とＢ1の両方に入力されたら、「=NETWORKDAYS(Ａ1,Ｂ1,祭日)」の計算をしたいのですが、どうしたら、良いでしょうか。 「ＩＦ」と「NETWORKDAYS」の両方は使えないですよね。。 また、Ａ1とＢ1の両方が入力されなければ、「何もしない（空白のまま）」が良いのです。 よろしくお願い致します。
日付　A 　 B 　C 　 D 2/1 　100 　10 　90 　90 2/2 　80 　20 　60 　75 2/3 　140 　20 　120 　90 2/4 　 90 　30 　 60 　 82.5 上の表で、C=A-Bです。 Dは、Cの累計を、相当する日数で割ったものです（2/3までの累計なら3で割り、2/4までの累計は4で割る、という具合に…）。 このDをEXCELの関数を使って算出できるようにしたいのですが、どうすればよいのでしょうか？ 尚、この表は一か月単位で作る予定です。 また、C列は表示の必要がなく、A,B,D だけの表の方が好都合です。
エクセルで、1つのプルダウンを選択すると、別のプルダウンを連動させたいのですが、それが複数・独立してある場合です。 例えば、次のようなプルダウンを考えています。 商品 　　　規格１　　　 　　　　規格２ テレビ　　　液晶　　　　　　40インチ テレビ　　　 プラズマ　　 　　　50インチ テレビ　　　　　　 　　　　　　60インチ ノートPC　　　パナソニック　　　　12インチ ノートPC　　　東芝　　　　　　13インチ ノートPC　　　マック　　　　　　15インチ （うまく並べられず、見にくくてすいません） A列でテレビかノートPCを選択すると、B列とC列でそれぞれのA列で選択した商品に応じて、それぞれの規格の種類をプルダウンから選択できるようにしたいのです。 例えば、ノートPCを選択すれば、 B列では、パナソニックからマックまでのメーカを選択でき、 C列では、12インチから15インチまでのモニターの大きさを選択できるようになります。 つまり、B列・C列は、ともにA列に連動します。 A列とB列の連動だけであれば、名前をつけて、indirect関数を使用する方法がネットでも載っているのですが、 B列とC列がともに同じA列に連動する場合、同じ名前になるためうまく独立して連動させることができません。 どうしたらよろしいでしょうか。 宜しくお願い致します。
8月1日（土）=DATE(2015,VALUE(LEFT(C23,1)),VALUE(MID(C23,3,1))) 8月10日（土）=DATE(2015,VALUE(LEFT(C24,1)),VALUE(MID(C24,3,2))) 10月1日（火）=DATE(2015,VALUE(LEFT(C25,2)),VALUE(MID(C25,4,1))) 10月11日（火）=DATE(2015,VALUE(LEFT(C26,2)),VALUE(MID(C26,4,2))) いつもは右の関数で 2015/8/1 2015/8/10 2015/10/1 2015/10/11に変換しています。 マクロの方が簡単かは別としてマクロを組みたいです。 日付が入力されてるセルが毎回違うので、 変換したい所を選択してからマクロ実行をしたいです。
いつもお世話になっています。 毎日行っている小テストの点数をつけている表で条件にあう点数をとったのは 何回かという数値を返すにはどうすればいいのでしょうか。 日付　　　点数 2015/12/1　85 ・ ・ 2015/12/20　95 2016/1/7　62 ・ ・ 2016/1/29　57 日付と点数が縦に並んでいるデータで 2015年の12月は85点以上何回、85点～50点は何回、50点未満　何回 2016年の1月・・・・・ というような条件下でカウントする方法はありますか。 COUNTIFを使えばできそうな感じはするのですが上手く数値を返してくれません。 よろしくお願いします。
A列　　　B列　　　　C列　　　　　D列 ２８　　　６　　　　５　　　　2016/6/5 ２９　　　１０　　　１５　　　2017/10/15 年月日で分かれているのを一つのセルに西暦に変換して入れたいです。 たくさんあるので一括で簡単にできる方法を教えてください。 関数でもマクロでもいいです。
質問失礼いたします. エクセルで,A1-A51,A52-A102,A103-153・・ のように,セルに入力してある数値を等間隔の範囲で正の数をカウントしたいのですが, 効率的なやり方はあるでしょうか. お詳しい方、ご回答宜しくお願いします.
時折セルを追加削除を繰り返していると、見出しの行全体を選んでフィルターをかけた時、添付のように見出しがない部分までフィルターがかかります。 そこで列を削除し、フィルターを解除した後再び上記の方法でフィルターを掛けると同じ結果になります。 何が残っているためこのような現象が起きるのでしょうか。 WIN 7、2010です。
ウインドウズ、エクセル２０１０についてです。PC初心者です。 エクセルで簡単なエクセル表をつくり　印刷しようとしたのですが うまくいきません。質問です。 １．エクセル表を範囲設定し ２．余白のところをクリックし　水平、垂直をクリックし 印刷が真ん中にでてくるようにしました。 ３．それで印刷しようとしたのですが　PDFドキュメントの 保存というのがでてきてしまいます。 質問は下記です。 １．保存などせずに　普通に印刷するにはどうしたらよいですか ２．印刷する用紙におおきく真ん中にいれたいのですが　小さいままになっています。 　全体を大きくするにはどのような設定にすればよいでしょうか よろしくお願いします。
EXCELに画像をたくさん張り付けなきゃいけません。画像サイズが大きいためにセル内に収めるようサイズをいちいち調整してるんですが、セル内に最初から収まるように設定できないでしょうか？ちなみにフリッカーというサイトからダウンロードしたサイズがバラバラなものを張ってます。 あと保存先を最初からデスクトップに来るようにしたいのです。やり方がわかりません。よろしくお願いします。
あるものが３０個あるとします。 それらはもともと、Ａ～Ｚという２６のアルファベットで種別が付けられているとします。 ３０個のうち、あるアルファベットが欠けていたり、または、あるアルファベットが２個以上あったりするとします。 たとえば、３０個のうち、Ａは欠けており、Ｊ、Ｋ、Ｌが２個ずつ、Ｍが３個あったり、というケースです。 それを、別の区分で５つ（第１分類～第５分類）に分け、エクセルを作成するとします。 どの区分に属するかは、人間の主観で判断するとします。 また、同じアルファベットのものは、同じ分類になるようにしなければなりません。 しかし、複数の人が作業するとき、ある人はＪを第２分類に分類し、ある人はＪを第５分類に分類した、ということが起こりえます。 どちらに分類すべきかは、協議の上決まります。さらに、２個以上あるものはダブりとして、１個のみをデータに残すことになります。 そのためにはまず、１つのアルファベットが複数の分類に分類されてしまってることに、気づかなければなりません。 これまでそのチェックを、ただ目視で行っていましたが、できればエクセルの機能で簡単な方法があれば知りたいと思い、質問させていただきます。 なお、第１分類から第５分類まで、項目は同じ列です。 非常にわかりづらい質問文で申し訳ありませんが、よろしくお願いいたします。
エクセルのワークシートA列とB列にデータがあります。 データは数値、文字列、空白です。エラー値はありません。 A列のセルと同じ行のB列のセルの値が同一でないA列データの個数（またばB列データの個数）を求めるワークシート関数はないでしょうか？（空白同士は同一とみなします。） C列などに作業列を作ってA、Bの比較をして求める方法はすぐに思いつきますが、作業列なしで求めたいのです。
お世話になります。 デスクトップに[集計]というフォルダ作って、その中に[集計.xls]というファイルがあります(画像参照) さらに[個別]というファイルダ内に[実績A.xls]というファイルがあります。 実際には実績B.xls、実績C.xlsと複数ファイルが存在します。 集計.xlsにボタンを作ってクリックすると下記のような動きを実現したいのです。 [個別]フォルダ内の実績A.xlsファイルを開いて[集計.xls]のA列(支店名)、B列(商品番号)と合致したデータを次のように挿入していきたいのです。 集計.xls 　実績A.xls C列　　←　D列の値 D列　　←　E列の値 E列　　←　F列の値 F列　　←　G列の値 この作業を実績A.xlsファイルの全シートに対して実施したいのです。(マスターというシートは抜かして左から右へ)。全シートREADし終わったら閉じて次の実績B.xlsファイルを開いて、また同じ作業を繰り返し、[集計.xls]もA2のデータから再びREAD、という動きです。 わかりにくい説明で大変恐縮ですが、業務で求められ困っております・・ どなたかご教授いただけますでしょうか。 何卒よろしくお願い致します。 Excel2013 Windows7
１０0件の住所録がアクセスで作ってエクセルに落としたため、通常の並べ替えができません。 ですのでこの関数を使って漢字のふりがなを振るのですが、全件ひとつずつ同じ作業をするのがたいへんです。１件この関数を使ったらあとは、どういう手順をふんだらいっぺんにふりがなをふれるのか教えてください。
文字列/標準で作成し保存したテーブルが、翌日開いてみると大部分が「会計」”ユーロ”にかわっていました。（変化のない部分もあります） 全てのファイルがそうなるわけではありません。現時点では二つのファイルで症状が出ています。 今回のファイルも半年以上使っていますがこの症状が出たのは今日が初めてです。 その後、気づいたのですが問題の出ているファイルでワークシートの挿入を実施したところ、そのシート全体が会計の書式になっていました。 原因と対策に心あたりある方お願いします。
エクセルからCSVファイルへの変換したときの文字化けに悩まされています。 たとえば、 千代田区大手町19－1 という住所がはいっているセルがあり、CSVに変換すると、 千代田区大手町19?1 となります。 エクセルで開いても、テキストエディタで開いても「－」が「？」に文字化けします。 エンコードの問題なのでしょうが、どうすれば文字化けが解消されるのか、わかりません。 エクセルはデフォルトではSJISで保存されるようなので、 UTF8で保存すれば、文字化けはなくなるのかもしれません。 ただ、 http://web-laboratories.com/excel-csv こちらのサイトにあるように、 [WEBオプション]をつかってUnicode[UTF-8]で保存しても、 テキストエディタで開きなおすと、SJISのままになっているようです。 文字化けをさせないCSVファイルへの保存のやり方を教えてください。
エクセルVBAで悩んでいます。 1枚目のシートに2000列くらいのデータがあり、 2枚目のシートに自分の抽出したいマスター機種一覧があります。 そして3枚目のシートに1枚目データと2枚目マスターとが一致したものだけを 全て抽出したいと考えております。 　　　　A　　　B　　　　C　　　　D　　　　　E　　　　　F　　　　G 1　　品目　　日付　　在庫数　　輸送手段　　注文数　　賞味期限　注文納期　 2　　りんご　　1/17　　5　　　　トラック　　　　50　　　　　2/5　　　 1/20 3　　りんご　　1/20　　8　　　　船　　　　　20　　　　　2/17　　　1/25 4　　ぶどう　　1/15　　8　　　　トラック　　　　100　　　　1/30　　　　1/20 5　　パイン　　1/16　　500　　　飛行機　　　200　　　　2/20　　　　2/1 6　　バナナ　　1/13　　500　　　飛行機　　　1000　　　2/25　　　　2/10 7　　バナナ　　1/15　　10　　　　トラック　　　　400　　　3/1　　　　　2/24 仮に上記のようなデータがあったとして、マスターにりんごとバナナの品目と注文数と注文納期だけを別シートに抽出するにはどうすればよいでしょうか？ 変数とif　で一致したら、、というところまでできたのですが、りんごの列が２つあると 下の列のりんごしか抽出できないのです。2列あれば2列とも抽出したいのですが、 できません。 分かりずらいかと思いますが、分かる方がいらっしゃったら、ご教授願います。
VLOOKUP関数とCOUNTIF関数の違いは あいまい検索ができるかどうかだけですか？
アドレスを分類別に分けたものを、メール作成時に宛先に張り付けたとき、順番を任意の順番にしたいです。 現状は、〇〇社長：〇〇部長：〇〇課長など管理職で分類を作成しました。 実際にメールを作成して、宛先に分類したものを設定したときに、並び順を役職順にしたいのですが、順不同になってしまいます。 解決策等、教えていただければと思います。よろしくお願いします。
パソコン初心者です。ウインドウズ７で　バイオPCで　エクセル２０１３を使い始めました 売り上げ構成の棒グラフをつくりたいのですが たとえば次のような棒グラフどのようにすればよいでしょうか。 (1)最初のエクセルデータは 　売り上げデータ（データのもととなるエクセル表の　上に横にならべて年度２０１３，２０１４，２０１５年といれ　、表の左に縦にりんご、みかん、なしの売り上げ金額と合計額） ２０１３年　りんご１０００円　みかん１０００円　なし１０００円　合計３戦円 ２０１４年　りんご２０００円　みかん１０００円　なし２０００円　合計５千円 ２０１５年　りんご１０００円　みかん２０００円　なし３０００円　合計３５００円 (2)上記を　次のようなグラフにしたいのです 横軸年度　　グラフのしたの横軸に　２０１３，２０１４，２０１５と並べる 縦軸　　それぞれの年度ごとの合計金額をたての棒グラフ全体にあらわし内訳として 　　　りんご、みかん、なしのそれぞれの売り上げ内訳をその棒グラフの中に色分けでいれる 質問です。　このときに　(1)のエクセル表をまず範囲指定してから 　　　挿入から　グラフを選ぶと思うのですが　そのあとがよくわかりません。 　　具体的におしえていただけますと幸いです。　宜しくお願いします。 　　　
エクセルＡ列にドロップダウンリストを作成し、「０１２０」、「０５７０」、「０８００」の ３つから選択するようにし、Ａ列で「０１２０」、「０５７０」を選択した場合、Ｂ列にハイフン無しの6桁の数字（先頭が０になることも考慮）しか入力出来ないように規制を掛けたいです。また、「０８００」を選択した場合には、Ｂ列に同じく７桁の数字しか入力出来ないように規制を掛けるには、どのようにしたら良いでしょうか？ ご教授いただきたく、何卒よろしくお願いいたします。
宜しくお願いします。 OS:Windows10 pro Office:MS Office 2010 Pro Plus Excelを使用中、AccessのA1というデータベースを参照したい場合があります。 このA1というデータベースのショートカットをEXCELのクイックアクセスツールバーに表示させることは可能でしょうか。
ピボットテーブルを一度作成した後に、行ラベルの内容をLeft関数を使い分解しました。 更新を実行した後にその行ラベルの表示を見ると、オリジナルの項目と分解した後の内容が両方表示されます。 例えば オリジナル：ラベル1：”北海道 札幌市”、 分解後：ラベル1：”北海道”、ラベル２：”札幌市” つまりラベル1を選ぶと、”北海道 札幌市”と”北海道”の両方が表示されます。 たとえオリジナルの項目を選んでも何も抽出されないのですが、新しい内容だけを表示するにはどうしたらいいのでしょうか。 データソースの変更で再度範囲を指定しても変わりません。
エクセルの関数で COUNTIFとCOUNTIFSの違いは何でしょうか？
あるデータから近似式をだすとy=55.67x^0.4896とでました。 この式にy=300を代入し、x値が知りたいのですが、どのように計算するのでしょうか？
宜しくお願いいたします。エクセルで、書式設定のある表を他のsheetにペーストか、移動またはコピーで写したいのですが、 ペーストでやるとコピーはできるのですが、他のsheetにペーストするとなにもおこりません。 又、移動またはコピーで移動すると普通なら移動するほうなのsheet画面に変わるのに、変わらなく移動も、されてません。なにか、考えられることありますか？助けて下さい
私は“R1C1参照形式”オプションを使用した経験が全くありません。 しかし、このオプションは、昔から、いまだに、廃止されることなく存在し続けています。 そこで、単なる興味本位からですが、専ら此れを使用している人っていらっしゃるのでしょうか？ そして、このオプションを最初から使い続けている理由は何なのでしょうか？ ちなみに、VLOOKUP、OFFSET、INDEX、ADDRESS等の関数では列番号を参照させる必要があるけど、私は何等困ったことがありません。
質問No.9060575で下記のような質問をさせて頂きました。 ↓↓↓↓↓↓↓↓ ファイルを選択するマクロを教えてください。 ブックAのシートA　セルA1に100という数字が入力されています。 C:\Users\Documents　のフォルダの中に シート選択#100.xlsm シート選択#101.xlsm シート選択#102.xlsm シート選択#103.xlsm シート選択#104.xlsm というシートがあるとします。 やりたいことはセルA1に数字が入力されている状態でマクロ実行ボタンを押した時 C:\Users\Documentsのフォルダの中にあるシート選択#100.xlsmのシートを開きたいです。 セルA1が101ならシート選択#101.xlsmを開く。 またセルA1になにも入力されていない場合はメッセージで [入力されていません] 入力されていてもフォルダ内に当てはまる番号がない場合は [ヒットするNo.がありません] みたいな感じでメッセージを表示したいです。 宜しくお願いします。 ↑↑↑↑↑↑↑↑ この質問で回答をもらい、解決できましたが ここにプラスαで、もしA2セルに999と入力されていて C:\Users\Documents　のフォルダの中に シート選択#100#999.xlsm というシートや シート選択#101#995.xlsm というシートがある場合はどのようにすればよろしいでしょうか？ 前回と同じく100や999の部分はランダムに変わります。 前回のベストアンサーを載せておきます。 ■VBAコード Sub file_open() Dim f_fmt As String, i As Integer '設定============== 　　Const dpath As String = "C:\Users\Documents\" 　　Const adr As String = "A1" 　　Const st As String = "シートA" 　　f_fmt = "#<NO>\シート選択#<NO>.xlsm" '================== 　　If Len(Range(adr).Value) = 0 Then MsgBox "入力されていません": Exit Sub 　　f_fmt = dpath & Replace(f_fmt, "<NO>", Range(adr).Value) 　　If Dir(f_fmt) = "" Then MsgBox "ヒットするNo.がありません": Exit Sub 　　Workbooks.Open Filename:=f_fmt 　　For i = 1 To Worksheets.Count 　　　　If Worksheets(i).Name = st Then 　　　　　　Worksheets(i).Activate 　　　　　　Exit Sub 　　　　End If 　　Next i 　　MsgBox "ワークブック """ & Dir(f_fmt) & """ に、ワークシート """ & st & """ が見つかりません" End Sub
F16に合計時間を計算させています。 sheet1~sheet8までの0より大きな時間の（時間の合計でなく）個数の合計を知りたいのですが ＝COUNTIF(Sheet1:Sheet8!F16,"0>")　 ｖalueのエラーが出ます。 またセルに参照式が入っていています。＝Ａ2等、参照元には、時間が入力されていますが、単純に、時間が入力された個数だけ知りたいのですが　どのようなCOUNT関数を使えばよいですか。
Windows 7 Home Premium　SP1　 64ビットオペレーティングシステム で、 Microsoft Office Personal 2010 Excel Ver.14.0.7165.5000(32ビット)を使っています。 R1C10 に「生年月日シリアル値」「12345」 RC1 に「今日の年月日」例えば「2016/1/1」 RC2 に「現在の時分」例えば　「10:30」 以上のデータから RC3 に現在時刻における満年齢を求める方法を教えてください。 満年齢書式は「##0.000」才で表記したいと思っています。 宜しくお教示ください。
Excel2013において、既に作成されたピボットテーブルの元データの範囲指定を変更したいのですが、探しても見つかりません。 どこを見れば良いのでしょうか。
Excelのグラフについて。 一旦０にリセットするグラフ（棒線）を作成できますでしょうか？ 具体的には、 ある数値について １月１日は０ １月末日は、任意の値（３５０など） ２月１日は０ ２月末日は、任意の値（７６０など） １年分、以下略 これらの値を棒グラフで示したいです。 可能でしょうか？ よろしくお願いします。 Excel2010以上
エクセルである関数を作ろうとしています。 まず前提として僕が知ろうとしているのは、「(1)～(4)の4択形式の試験で全N問あったとき、同じ数字が最大n連続するものが一つでも現れる確率は◯◯だ」ということが知りたいと思っています。 センター試験とかで同じ数字が何連続も続くと不安になりますよね？あれはどういう確率分布をしているのか、統計的に調べてみようという感じです。 そのために、Nに色々数値を代入して、（例えば10でやってみましょう）10個の乱数を発生させます。 その中で同じ数字が最大２連続している箇所の個数、最大3連続している箇所の個数、最大4連続している箇所の個数・・・、最大10連続している箇所の個数、をそれぞれ数えます。これを例えば1万回繰り返して、最大n（2~10）連続する箇所が1万回の試行回数のうちで何回出てきたかを集計すれば、だいたいどれくらいの確率で最大n連続するものが出現するかが分かるのでは、という寸法です。 長くなりましたが知りたいのは、 『乱数を10個発生させ、例えば 1433444133とすると、 この中で数字が 最大2連続している箇所が2箇所 最大3連続している箇所が1箇所 最大4連続している箇所が0か所 ・・・ 最大10連続している箇所が0か所 のようなことが分かる関数』 で、できれば 『これを一万回繰り返して、各n（2~10）について集計してくれる関数』 をぜひ考えてほしいです！＞＜ 皆様のアイディアを頂ければ嬉しいです。よろしくお願いします…！
excelのcoutif関数を使用して３００行ぐらいの文字列が入った列から特定の文字列の個数をカウントさせているのですがなぜかうまくヒットしてくれません。=countif(Ｂ4,$D$3:$D$303)と入力 して３００行ぐらいコピーしたのですが、結果が”０”となってしまいます。ところが、カウントしている文字列がＤ３：Ｄ３０３の中にあることは目視で確認できます。exclのサーチコマンドでもヒットします。カウントする文字列とカウントされる文字列をｉｆ文で比較してみても同じものだと認識されるようです。何が原因でカウントされないのかよくわかりません。countif関数 を使用するうえで特定の条件があるのでしょうか？ｄ３：ｄ３０３のデータはソートしています。
PDFファイルにグラフがあります。 棒グラフと折れ線グラフですが、 このグラフから実際の細かい数値を読み出したいです。 なにか方法があるでしょうか？
Excelに入力されている時間に対して、特定のセルに色を塗りたいのですが、どのような関数を使用したら良いのでしょうか？ 【例】 B列とC列に「13:00」「18:00」 F列以降にセルの色を塗る。(一セルは15分単位) BH～CAのセルに色を塗る。
VBAでRedHatのホームページに自動ログインするプログラムを作成しています。 <コード> Sub RedHat() Dim objIE As InternetExplorer Dim urlName As String Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True Call ieView(objIE, "https://idp.redhat.com/idp") If objIE.LocationURL <> "https://idp.redhat.com/idp" Then Call ieNavi(objIE, "https://www.redhat.com/wapps/ugc/protected/account.html") Call tagClick(objIE, "li", "utility-account") Call tagClick(objIE, "p", "ログアウト") Call ieNavi(objIE, "https://idp.redhat.com/idp") End If Call formText(objIE, "username", "丸秘") Call formText(objIE, "password", "丸秘") Call tagClick(objIE, "button", "ログイン") Set objIE = Nothing End Sub Function ieView(objIE As InternetExplorer, _ urlName As String) objIE.navigate urlName Call ieCheck(objIE) End Function Function ieCheck(objIE As InternetExplorer) As String Do While objIE.Busy Or objIE.readyState < 4 DoEvents Loop End Function Function tagClick(objIE As InternetExplorer, _ tagName As String, _ tagStr As String) For Each objTag In objIE.document.getElementsByTagName(tagName) If InStr(objTag.outerHTML, tagStr) > 0 Then objTag.Click Call ieCheck(objIE) Exit For End If Next End Function Function ieNavi(objIE As InternetExplorer, _ urlName As String) objIE.navigate urlName Call ieCheck(objIE) End Function Function formText(objIE As InternetExplorer, _ nameValue As String, _ tagValue As String) For Each objTag In objIE.document.getElementsByTagName("input") If objTag.Name = nameValue Then objTag.Value = tagValue Exit For End If Next For Each objTag In objIE.document.getElementsByTagName("textarea") If objTag.Name = nameValue Then objTag.Value = tagValue Exit For End If Next End Function "丸秘"をユーザとパスワードに修正し、 実行しました。 実行後、IE画面で以下のメッセージが表示されます。 「RedHatのログイン画面でユーザ名またはパスワードが無効です」 ユーザ欄がクリックされている状態になります。 すみません。どの行を何に修正すれば、正常に動作しますでしょうか？ 教えていただけますと幸いです。 引用元：http://www.vba-ie.net/application/twitter-login.html
下記のようなマクロで現在はマクロコード内にフォルダのアドレスを書いていますが これをダイアログを開いてフォルダを選択できるようにするには どうすればよいでしょうか？ Sub Sample10()    Call FileSearch("V:\個人\飯塚\マクロ\RawData2") End Sub Sub FileSearch(Path As String) Application.ScreenUpdating = False    Dim FSO As Object, Folder As Variant, File As Variant    Set FSO = CreateObject("Scripting.FileSystemObject")    For Each Folder In FSO.GetFolder(Path).SubFolders        Call FileSearch(Folder.Path)    Next Folder    For Each File In FSO.GetFolder(Path).Files        If File.Name = "RawData" Then Workbooks.Open fld & File, Format:=2 Range("B1:B180").Select Application.CutCopyMode = False Selection.Copy Application.DisplayAlerts = False ActiveWindow.Close Application.DisplayAlerts = True Range("f2").Select ActiveSheet.Paste ActiveSheet.Next.Activate End If    Next File End Sub
ピボットテーブルの数値を別セルにリンクすると、getpivotdataなる機能が働くのですが、これを除くにはどうしたら良いのでしょうか。 宜しくお願いします。
すいません、教えてください。 入力した大きさの四角形を自動で表示したいです。10ー20行分。 四角形はダブって表示されてもいいのですが、四角形の中にA列の記号(例えば(1))をいれて、 どの四角形なのか区別するようにしたいです。 最終的には四角形を組み合わせて 規定枠にいくつ入るか調べたい為です。 Addshapeを使うことはわかったのですが、なかなか上手く出来ません。 お知恵を下さい。 A B C 1 (1) 100 100 2 (2) 120 150 3 (3) 200 180
「複数のワークシートをピボットテーブルで統合する」のウイザードを使用したときに2ｂ/3で「ページ フィールド数を指定してください」という部分がありますが、この意味を教えていただけませんか。 1(1)の意味はわかるのですが、2以上の時はどういう働きをするのでしょうか。
添付上図を下図のタイプに変換するマクロの作り方を御教示お願いします。 ピボットテーブルの逆のパターンと考えればわかりやすいです。 項目、年、それからY軸のデータ数は変化しますので、それに対応するやり方でお願いします。 どうぞよろしくお願いします。
Excel 2013 です。 A10セルに合計の数字（金額）があります。 A20セルに「A10円」と「A10の数字」に「円」を付けて転記することが できましたら、その方法を教えてください。
ユーザーフォームを作りたくて質問させていただきます。 まずユーザーフォームを作り、そこに検索ボタンを作って そのボタンを押すと、ユーザーフォームの検索という 別の画面がでてくるよにしたいのですが、ボタンを押しても その画面が出てこなくて困っています。 まだまだ勉強したてで、なるべく自分の使いやすいよう エクセルで作りたいので、教えてください。 よろしくお願いします。
二次元配列のVBAの書き方がよくわからないのですが、 私が作ったサンプルプログラムのSub 二次元()において 二次元配列で表すにはどうすればいいのでしょうか？ Sub 二次元()では 配列を格納する変数はtmpしか使っていませんが もう一つ配列を格納する用の変数を作ればいいのでしょうか？ 数字とアルファベットは別々に取り出したいです。 ----------------------------------------------------- Sub 一次元() Dim myStr As String Dim tmp As Variant Dim i As Long For i = 1 To 5 myStr = myStr & "," & i Next myStr = Mid(myStr, 2) tmp = Split(myStr, ",") For i = LBound(tmp) To UBound(tmp) Debug.Print tmp(i) Next i End Sub Sub 二次元() Dim myStr As String Dim tmp As Variant Dim i As Long For i = 1 To 5 myStr = myStr & "," & i & "と" & Chr(64 + i) Next myStr = Mid(myStr, 2) tmp = Split(myStr, ",") For i = LBound(tmp) To UBound(tmp) Debug.Print tmp(i) Next i End Sub
エクセルで、月別でシートに分けて1年分の出勤表を作っています。 印刷して勤務時間を手書きしてもらうためのものです。 下記のことで困ってますので助けてください。 考えている作り方としては、 (1)セルA1に年を設定し、A2に月を設定する (2)=DATE（$A$1,$A&2,1～31）で、日付を出す (3)　(2)の日付のセルの、書式設定をユーザー定義「ｄ」にして日のみを表示 (4)　(2)の日付の横のセルに=TEXT(WEEKDAY((2)のセル,1),"aaa")で曜日を表示 なのですが、(2)で、31まで入れると、2月シートの29の下に、（3月の）1と2が表示されてしまいます。30日までしかない月も同様です。 これを、その月の月末の日付までしか表示しないようにしたいです。 どうしたらいいでしょうか。
ExcelのIF関数について質問があります。 B2,C2,D2に入力されている文字を一つずつスペースを設けて、A1に自動的に入力されるような関数を作りたいのですが、どうしてもできません。 B2,C2,D2に文字が入力されていれば、=B2&" "&C2&" "&D2 という関数でこの問題は解決できます。 しかし、もしC2が空白なら、上記関数ですと、スペースが２つできてしまいます。 ●もし空白なら、スペースを作らないというIF関数を作りたく試行錯誤しましたが、できませんでした。 どなたかおわかりの方教えて頂けないでしょうか？ よろしくお願い致します。
A1のセルに8：00～17:00の間の時間が入力され さらに A2のセルに17:00～24:00の間の時間が入力された時に A3のセルの色を赤く変えたいのですが どのようにすればできますか エクセル2013を使っています。 ご教授お願いします。 かなり初心者ですので、優しく手順を説明していただけると助かります。
excel2016, windows8.1ユーザーです。 excelでスタートアップフォルダを指定したいと思い、詳細設定から「起動時にすべてのファイルを開くフォルダ」を指定したのですが、意図してたのと違うフォルダを指定してしまい、どのファイル数3000くらい有るフォルダを指定してしまいました。 結果的にエクセルを起動するたびにプログラムは一生懸命すべてのファイルを開こうとして、そのうちにエラーで止まってしまいます。このような状況ですので、設定を元に戻そうとしたくても、エクセルが起動できないという堂々巡りになって困っています。 excelを起動せずに設定変更する方法はあるのでしょうか？ もしくは次々とファイルを開こうとする動きを止めて、設定変更するような何か良い方法があるのでしたらご教示頂きたくお願い申し上げます。 宜しくお願い致します。
お世話になっています 質問No.9097443 質問No.9089695　 質問No.9104294でご指導いただきました。 ◎希望条件 勉強時間を集計したシートA列：科目 B列：開始日 C列：開始時刻 D列：終了日 E列：終了時刻 の記載があるsheet1には終了時刻から開始時刻を差し引いた作業時間を表示する列がない。 sheet1に差引の作業時間列を追加することなく、別のシートで各科目の勉強時間を集計する方法を教えてもらいました。 ************************************************************************************* ◎レクチャー頂いた内容は Sheet3のA列とB列を作業列として使用して、Sheet2に科目ごとの勉強時間の合計を集計するものとします。 Sheet3のA2セルに次の関数を入力して下さい。 =IF(INDEX(Sheet1!$A:$A,ROW())="","",IF(COUNTIF(Sheet1!$A$1:INDEX(Sheet1!$A:$A,ROW()),INDEX(Sheet1!$A:$A,ROW()))=1,ROW(),"")) Sheet3のB2セルに次の関数を入力して下さい。 =IF(OR(INDEX(Sheet1!$B:$B,ROW())="",INDEX(Sheet1!$C:$C,ROW())="",INDEX(Sheet1!$D:$D,ROW())="",INDEX(Sheet1!$E:$E,ROW())=""),"",IF(ISERROR(1/(YEAR(INDEX(Sheet1!$B:$B,ROW()))>1904)/(INDEX(Sheet1!$C:$C,ROW())+0>=0)/(INDEX(Sheet1!$C:$C,ROW())+0<1)/(YEAR(INDEX(Sheet1!$D:$D,ROW()))>1904)/(INDEX(Sheet1!$E:$E,ROW())+0>=0)/(INDEX(Sheet1!$E:$E,ROW())+0<1)),"",IFERROR(TEXT(INDEX(Sheet1!$D:$D,ROW())+INDEX(Sheet1!$E:$E,ROW())-INDEX(Sheet1!$B:$B,ROW())-INDEX(Sheet1!$C:$C,ROW()),"[h]:m:s")+0,""))) Sheet2のA2セルに次の関数を入力して下さい。 =IF(ROWS(A$1:A2)>COUNT(Sheet3!$A:$A),"",INDEX(Sheet1!$A:$A,SMALL(Sheet3!$A:$A,ROWS(A$1:A2)))) Sheet2のB2セルに次の関数を入力して下さい。 =IF($A2="","",TEXT(SUMIF(Sheet1!$A:$A,$A2,Sheet3!$B:$B),"[h]:m:s")+0) ************************************************************************************* ◎☆今回は、このシートに集計期間を設定したいのですが、 可能でしょうか。 　上記のやり方だと、Sheet1の全ての日付の項目を集計してしまいます。 　そこで、 　D3に集計指定期間開始日 　E3に集計指定期間終了日　を設定するなどしてできないでしょうか。 　sheet!1に指定期間日を設定しないやり方でしたら、Sheet2でもSheet3にでもどちらでもいいのですが。 　よろしくお願いします。
エクセル2010のVBAを使ってマウスのボタンが離された場所のセル番地を取得することはできますか？　 例えば　 マウスの左ボタンをA5の位置で離したとしたらA5というセル番地が返されるようにしたいです（ボタンを離したときのセルはアクティブセルではないという条件で）。
Sub 全角() Dim i As Long, buf As String For i = 1 To Len(ActiveCell.Value) If Mid(ActiveCell.Value, i, 1) Like "[ア-ン]" Then buf = buf & StrConv(Mid(ActiveCell.Value, i, 1), vbWide) Else buf = buf & Mid(ActiveCell.Value, i, 1) End If Next i ActiveCell.Value = buf End Sub このコードだと一つのセルしか変換できません。 選択した範囲全部を変換できるようにしたいです。
G4には計算式があります。 Ｇ４の２の文字をコピペしてＧ９に貼り付ける方法は、マウス右クリックで「形式を選択して貼り付け」を選択する必要があります。 右クリックしないで、早い貼り付け方法はないでしょうか？ Ｇ９に計算式は入れない方法でご回答願います。 宜しく願います。
添付のような指定した範囲をｊｐｇなどの画像ファイルで保存できないのでしょうか？ 宜しく願います。
一覧表から「○」の条件が付いたデータのみを別シートに関数で抽出したいです。 フィルタではなく関数を使用したいのは、抽出したデータから名前の定義を使用して リスト表示をさせたいためです。ご教示のほど、宜しくお願いします。 シート１は一覧表となっており、Ａ列に「○」のついたデータのみをシート２に表示 シート１（一覧表） 　　Ａ　 Ｂ １　 ○　　山田太郎 ２　 ×　　佐藤次郎 ３　 ○　　高橋三郎 ４　 ×　　鈴木四郎 ５　 ×　　中村五郎 シート２（抽出結果を表示させる） 　　Ａ　 Ｂ １　 ○　　山田太郎 ２　 ○　　高橋三郎 ３　 ４　 ５ フィルタオプション、当方の考え得る限りの配列関数等、色々試しましたが、 不勉強のために上手く結果が表示されませんでした。 ご教示のほど、宜しくお願い致します。
Excelで店舗の休日一覧を作っており、各店舗ごとに手作業で休日の曜日を入力しています。 ————————————— 店舗A｜木　　　　　　　　｜ ————————————— 店舗B｜火（祝日→水）　　｜ ————————————— 店舗C｜月、水、年末年始　｜ ————————————— 現在このような感じで入力してありまして、ここに、今日の曜日の「文字列」が含まれているセルに（色をつける等の）強調を施す条件を設定したいと思っています。 しかし、今日の日付に色をつけることはできるのですが、曜日に色を付けることができず困っております。 条件の式などの設定方法が分かる方見えましたら、ぜひ教えていただけますでしょうか。 宜しくお願い致します。 ※今日の日付と曜日は関数で呼び出すことができています ※Excel2011を利用中ですが、Googleスプレッドシートでも同じ表を作りたいと考えているので、そちらでも使える方法がありましたら、一緒に教えていただけますでしょうか
最近、闘病生活の関係でPCを触らなくなって自信が無いのでアドバイスをお願い致します。 関数計算したいのは、インチ to ミリ変換表の作成です。 １インチ以上は、整数での計算で良いのですが、1インチ未満の時に1/2inch・1/4inchと言うように、セルに書きたいのです。 （inchの文字が邪魔になるなら、諦めます。 ただし、inchの文字を入れないと1/2は0.5に自動変換されてしまいますので、「'1/2」と入力する事になります。） 一様、私が書いたのが、 A1：1/4inch　B1：=LEFT(A1,3)　C1：=LEFT(B1,1)　D1：=RIGHT(B1,1)　E1：=25.4*C1/D1 A2：15/16inch　B2：=LEFT(A2,5)　C2：=LEFT(B2,2)　D2：=RIGHT(B2,2)　E1：=25.4*C2/D2 こんな感じで、セルを複数使う事で計算自体は希望通り出来ています。 ただ見た目が悪いので、A列に＊＊inch（＊＊は分数）として、B列に一行で済む関数計算法はあるでしょうか？？ 何卒、ご教授のほどよろしくお願い致します。 使用エクセル（MS office）は、2003・2007です。 インチ計算が必要な理由は、プリント基板のパターン作製と工作機械（旋盤・フライス盤など）のインチ部品・パーツ規格の作成など、早見表の作成をと考えています。
エクセルマクロで特定の文字を含んだファイルを指定したいのですが、 ファイル名がその都度、book1,book2,book3,のように変わります。 Range("a1").Select Windows("Book10").Activate Range("a10").Select End Sub このような記述だと、book10にしか指定できず、bookを含むファイルを指定したいのですが どのようにしたらよろしいのでしょうか。 開いているbookを含むファイルは1ファイルのみです。 　　　　　　　　　　　　　　　宜しくお願いいたします。
EXCEL2013の作業枠の色の選択が、白、灰色、濃い灰色のわずか三つしかないようですが、他の色に設定することはできないのでしょうか。 他のところでは過剰なほど様々な選択肢を用意しておきながら、個人的には一番重要なEXCELの背景色(目の疲れにも重要)がわずか三択とは意味不明なのですが。。。
エクセルの書類を印刷すると1ページ分しかデーターがのに2ページ印刷されてしまいます。 2ページ目の印刷部分は何も記入されず白紙です。 なにか設定方法が違っているのでしょうか？ それとも2ページ目に何らかのデーターがあるのでしょうか？ よろしくお願いします。
添付画像より シート１で毎日、個別名で請求書を作成しています。請求書の記入欄は１個（画面とおり）だけです。 それら請求書の内容をシート２に記録保存していきたいのですが何かよい関数式ってないでしょうか。 勿論、同日に複数名の請求書を作成することもあります。 お詳しい方、宜しく願います。
自分のPC上にはない、共有ファイルのExcelの場所を探す方法をおしえてください。
お世話になります。 Excelのシートに背景を設定しました。この背景を変更されないように、「シートの保護」を設定しました。その際、全セルのロックを解除してあります。また、「このシートのすべてのユーザーに許可する操作」の各項目には全てチェックONにしてあります。 それでも、「ふりがなの表示／非表示」がグレーアウトしています。 背景を変更されないようにして、なおかつ「ふりがなの表示／非表示」を使用できるようにする方法はないでしょうか。 VBAでも結構です。 よろしくお願いします。
設定した期間内の（項目）担当者の個数を求めたいです。 項目を毎日集計しています。 設定した期間内の項目の個数を集計したいです。 項目は一日に２つ以上発生することも有ります。 A列日付、B項目、D列集計開始、E列集計終了の列から、 F列に設定した集計開始日の項目とG列に設定した集計終了日の項目の条件に 合致した数をG列に表示させたいです。 よろしくお願いします。
　勉強時間を集計しています。 　A列科目、B列開始日、C列開始時刻、D列終了日、E列終了時刻、F列合計のシートです。 　集計開始日と集計開始終了日の間の期間だけをJ列の科目ごとにK列に集計したいのです。 　日付データで、どのようなネストを組んだらよいかわかりません。 　AVERAGEIFSとDATE関数だとは思うのですが。 　よろしくお願いします。
お世話になります。 図のような割振りを月別に「修正済み」「在庫切れ」「廃盤」と日付、氏名別の個数を出したいです。 日付、氏名別の個数は前回こちらの場でご指導いただき下記で解決できました。 ＝SUMPRODUCT((E$6:E$5681>=H$4)*(E$6:E$5681<=EOMONTH(H$4,0))*(F$6:F$5681=H6)*1) 今回は、「修正済み」「在庫切れ」「廃盤」で割り振る場合は、どのような条件を追加したらよろしいでしょうか。 度々の質問で恐縮ですが、何とぞご教授の程、よろしくお願いいたします。
お世話になります。 下記のような、上記の項目がありまして、下記の表で1月、2月と氏名別の個数を出したいです。 関数を教えていただけますでしょうか。よろしくお願い致します。 日付　　氏名　　　 2016/1/2　　山田　　 2016/1/2　　山田　　 2016/1/2　　佐藤　　 2016/1/2　　山田 2016/2/2　　佐藤　　 2016/2/3　　山田　　 2016/2/4　　山田　　 　　 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ ＜2016年1月＞ 氏名　個数 山田　　　3　　←こちらの結果を求めます 佐藤　　　1　　←こちらの結果を求めます 宜しくお願い致します。
個人的な趣味で取ったデータを整理したいのですが、 たとえば Aさん、Bさん、Cさんが、X、Y、Zの商品をいくつか買ったとして、 その総額をエクセルの表で一番右の欄に打ち込んだのですが、 総額の順に下に作った別の表に表示されるようにしたいです。 どのように打ったら計算してくれるのでしょうか・・・ 名前と、上に作った表と同様に買った個数も総額順に並び替えてほしいです。 上の表には、行に名前、列に商品名、その下に買った個数を入力して =B3*500+B4*200+B5*100 のような感じで手打ちで総額出しました。 こんな説明でわかるかわかりませんが、回答お願いします。 エクセルについてまったくの素人ですがよろしくお願いします。
お恥かしい話です エクセル２０１３です 皆様の解説を参考に、いろいろと操作しているのですが、 私のエクセルには「書式」の項目がないのです 「セルの書式設定」項目はありますが、 「条件付き書式」の項目も出てきません。 私はどうすればいいのでしょうか？
お世話になっています 質問No.9097443　及び 質問No.9089695　でご指導いただきました。 勉強時間を集計したシートA列：科目 B列：開始日 C列：開始時刻 D列：終了日 E列：終了時刻 の記載があるsheet1には終了時刻から開始時刻を差し引いた作業時間を表示する列がない。 sheet1に差引の作業時間列を追加することなく、別のシートで各科目の勉強時間を集計する方法を教えてもらいました。 レクチャー頂いた内容は ************************************************************************************* Sheet3のA列とB列を作業列として使用して、Sheet2に科目ごとの勉強時間の合計を集計するものとします。 Sheet3のA2セルに次の関数を入力して下さい。 =IF(INDEX(Sheet1!$A:$A,ROW())="","",IF(COUNTIF(Sheet1!$A$1:INDEX(Sheet1!$A:$A,ROW()),INDEX(Sheet1!$A:$A,ROW()))=1,ROW(),"")) Sheet3のB2セルに次の関数を入力して下さい。 =IF(OR(INDEX(Sheet1!$B:$B,ROW())="",INDEX(Sheet1!$C:$C,ROW())="",INDEX(Sheet1!$D:$D,ROW())="",INDEX(Sheet1!$E:$E,ROW())=""),"",IF(ISERROR(1/(YEAR(INDEX(Sheet1!$B:$B,ROW()))>1904)/(INDEX(Sheet1!$C:$C,ROW())+0>=0)/(INDEX(Sheet1!$C:$C,ROW())+0<1)/(YEAR(INDEX(Sheet1!$D:$D,ROW()))>1904)/(INDEX(Sheet1!$E:$E,ROW())+0>=0)/(INDEX(Sheet1!$E:$E,ROW())+0<1)),"",IFERROR(TEXT(INDEX(Sheet1!$D:$D,ROW())+INDEX(Sheet1!$E:$E,ROW())-INDEX(Sheet1!$B:$B,ROW())-INDEX(Sheet1!$C:$C,ROW()),"[h]:m:s")+0,""))) Sheet2のA2セルに次の関数を入力して下さい。 =IF(ROWS(A$1:A2)>COUNT(Sheet3!$A:$A),"",INDEX(Sheet1!$A:$A,SMALL(Sheet3!$A:$A,ROWS(A$1:A2)))) Sheet2のB2セルに次の関数を入力して下さい。 =IF($A2="","",TEXT(SUMIF(Sheet1!$A:$A,$A2,Sheet3!$B:$B),"[h]:m:s")+0) ************************************************************************************* 実践できたものの、仕組みが複雑でわかりません。 Sheet3のA2では、IF関数の中で、COUNTIF関数が使われていますが、なんのためなのかわかりません。 Sheet3のB2セルには関数の中に">1904"と数値の1904より大きい値を指定する関数が組み込まれたいますが、なんのためか理解できていません。 Sheet2のA2では、「Sheet2のA１：A２がSheet3のA列より大きい」という条件に適合しなかった場合、最小値を求める計算をしていますが、何のために行っているのかわかりません。 Sheet2のB2では、A2に適合しなかった場合、Sheet１のA列から何かを何かの条件に一致したものを合計して時間表示していますが、よくわかりません。 簡単でいいので、解説をお願いできませんでしょうか？ すみません、理解力が乏しいもので申し訳ありませんが、よろしくお願い致します。
Excel2010で商品管理票を作りたいと思っています。 （Windows7 32bit） 画像のようにA列に商品コードを記入した場合 B列に何回目かを表示したいのです。 初めての商品の場合は非表示で 2回目から2、3、・・・というように増やしたいのですが どうすればいいでしょう？ 【やってみたこと】 =IF(COUNTIF($A$2:A2,A2)>1,"＊","") の様な関数を入れれば 2回目以降に”＊”が表示されますが、回数がわかりません。 =COUNTIF($A$2:A2,A2)-1 ですと2回目が1と表示されてしまいます。 ”0”は書式設定のユーザー定義で「G/標準;G/標準;」にして非表示にしました。 もっと他の関数を使うのか、セルの書式設定で解決するのかもわかりません。 どなたかご教示ください。 よろしくお願いします。
別々のフォルダ内にあるファイルを一括して読み込むマクロを教えて下さい。 まず \\10.000.000.000\data\検査結果\LETO\712\20150204160549\ID000 というフォルダ内に 090 100 110 ・ ・ ・ ・ 270 というフォルダが13個あります。この13個のフォルダ内には RawData　という名前のファイルがそれぞれ保存されています。 現在はこのRawDataファイルを1回1回選択してエクセルシートに読み込んでいます。 これを上記アドレスの最後の、ID000のフォルダを選択してOKを押すと 13個のフォルダ内のRawDataというファイル名の中身を各シートの指定のセルに 貼り付けるようにしたいです。 090フォルダ内のRawDataはブック1のシート1のセルF2へ 100フォルダ内のRawDataはブック1のシート2のセルF2へ という感じで、シートは変わりますが、セル番号はかわりません。 現在使用しているマクロを貼り付けておいきます。 ご指導の程宜しくお願いします。 Sub open2(pbs_pos)    f_name_org = ActiveWorkbook.Name    MsgBox ("PBS = " & pbs_pos & " degのraw_dataファイルを選択")    open_file    fname_temp = ActiveWorkbook.Name    Range("b1:b180").Copy    Workbooks(f_name_org).Activate    Sheets("pbs" & pbs_pos).Activate    Range("f2").Select    ActiveSheet.Paste    Application.CutCopyMode = False    Workbooks(fname_temp).Close Sheets("calibration").Select End Sub
アクセス解析のURL抽出についてお教えください。 エクセル：2013 行　｜　抽出文字列（C列） １１｜en/stay/index.php １２｜en/index.php １３｜en/experience/index.php １４｜en/healing/index.php １５｜en/sports/index.php １６｜en/index.html ※各言語で合計で２００ページ程度あります。 ◎ルールとしては 言語/カテゴリ/ページ名 index.html（１６行）以外ならば下記式で抽出できるのですが、index.htmlのの場合”/”が一回しか出現しないためエラーとなります。 "=MID(C10,FIND("/",C10)+1,find("/"C10,4)-find("/",C10) ”言語／ページ名”の場合と”言語／カテゴリ／ページ名”の場合の抽出方法をお教え頂けましたら幸いです。
新しく入った会社の先輩が 「エクセルは信用できないから電卓を使って計算してる」って言ってたけど この会社、ヤバいですか？
エクセル2010です。 セルには、‏‎12:57:20という値しか入ってないのに 数式バーで文字が右に寄ってしまいます。 12の左には何も入っていません。 空白も入っていません。 セルの書式設定での文字の配置の横位置は、標準になっています。 他のセルに入っている文字は、左詰めで数式バーに表示されます。 この12:57:20の右詰を左詰めに変更するにはどうすればいいでしょうか？
セルG3に以下の計算式が入っています。 =IF(MONTH(TODAY())<=3,YEAR(TODAY())-1,YEAR(TODAY()))&"年度" これは現在の年度を表す計算式みたいです。 質問した現在でのG3は「２０１５年度」と表記されます。 次にJ11に「２０１５」と入力した時に（数字のみ入力です。）J11が赤色で塗りつぶされる方法はどの様にすれば良いのでしょうか？
エクセル２０００、以下の関数で#VALUE!になります。 =IF(AND(B1<H95,G93=""),G94+G42+I42,G93+G42+I42),IF(AND(B1>=H95,I93=""),I94+I42,I93+I42) 前後別々だと問題ありません。 =IF(AND(B1<H95,G93=""),G94+G42+I42,G93+G42+I42) =IF(AND(B1>=H95,I93=""),I94+I42,I93+I42) B1は　today() H95は　2016/1/4 G93とI93とG94は　数値入力します。 G42とI42は　SUM関数で合計しています。 何が間違っているのでしょうか？
「H270101」と入力されているものを、「H27.01.01」と直す関数はありますか。 誕生日のリストがあるのですが、「.」が入っていないため、誕生日として認識されません。 ピリオドを入れればよいのですが、 リストの数が多すぎて面倒です。 なにか良い方法をご存じの方、教えてください。
PDFからエクセルにする方法を教えてください。 原本のエクセルがないので困っています。
エクセルで「々」を置換しようとしたら、「ー」まで対象となってしまいましたが これをやめさせる方法はありますか？ 「々」のみ置換したいです。 「セル内容が完全に同一であるものを検索する」 の意味ではなく、 「々」を対象としたときには、「ー」は除外させたいです。
いつもありがとうございます。 エクセルで、Ａ列を検索し重複があれば、Ｃ列のデータを空白にするＶＢＡを検討しております。Ａ列のデータは削除するのではなく、残したままです。 画像の通りです。Ａ列の並び替え済みで、データは毎回異なります。 急いでおります。ご教示頂ければ幸いです。 よろしくお願いします。
Sub Sample1() Dim App As Excel.Application Dim xlBook As Workbook Dim MyFileName As String MyFileName = "C:\あああ.xlsm" Set App = CreateObject("Excel.Application") Set xlBook = App.Workbooks.Open(MyFileName) App.Visible = True End Sub このようなコードでエクセルファイルを他のvba付ファイルから開く場合 現在 デュアルディスプレイをしてるのですが、 左側のモニタでファイルを開きたい場合、 どうすればいいでしょうか？ 右のモニタで開くか、左のモニタで開くかは どうやって決められているのでしょうか？ コントロール パネル\すべてのコントロール パネル項目\ディスプレイ\画面の解像度 を見ると、 どうやら右のディスプレイがメインのようです。
エクセルVBAを実行していたらフリーズして しょうがないから強制終了しようとすると ほぼ毎回 実行時エラー　'-536870910（E0000002）と出ます。 でもエラー内容は書かれてません。 -536870910でググっても出てこなかったのですが どういうエラー何でしょうか？
このようなデータがあります A、B、Cが現れたら、下に示す結果のようにしたい VBAでお願いします A列　　B列 　　　　あ 　　　　A 　　　　ひ 　　　　ふ 　　　　B 　　　　こ 　　　　ぽ 　　　　ヒ 　　　　C 　　　　ほ 移動結果 A列　　B列 　　　　あ 　　　　 A　　　ひ A　　　ふ 　　　　 B　　　こ B　　　ぽ B　　　ヒ 　　　　 C　　　ほ
B1のセルにＡ1のセルの文字が含まれるか判定をするため、以下の関数を使用しました。 =IF(COUNTIF(Ｂ1,"*"&A1&"*"),0,1) 例えば、Ａ1＝400のとき、 Ｂ1=q400 Ｂ1=400 1 などの場合は、０（＝含まれる）という判定がでるのですが Ｂ1=400 Ｂ1=14000 などの時は、1（=含まれない）となります。 完全一致である400、および14000も「400」という文字列が含まれるので同じ結果を返したいのですができません。 原因はＡ１が文字ではなく数字だからということはわかるのですが。 ちなみにＡ１には文字も入力される場合があるので、どの場合でも含むかの判定を出したいです。 アドバイスお願いします。
このようなデータを並べ替えたい 簡単な方法はありますか？ A　　B　　C あ 　　E 　　　　７ ふ た 　　P 　　　　５ 並び替えた結果 A　　　B　　　C あ ふ　　 た　　　　 　　　E 　　　P 　　　　　７ 　　　　　５
イベントのタイムスケジュールを作成したのですが、 挨拶に5分次に3分……のような感じで時間を切っておいて それを開始時間の00:00に足していきたい場合(添付画像のようなイメージ)はどのように 計算すればいいでしょうか。
社内システムで次のようなCSVファイルがダウンロードできます。 名前　　チーム　道具 田中　　A 　　　1 鈴木　　　　　　2 　　　　　　　　3 このデータをEXCELの関数を多用して次のように整形したいのですが、可能ですか？ 名前　　チーム　道具 田中　　A 　　　1 田中　　A 　　　2 田中　　A 　　　3 鈴木　　A 　　　1 鈴木　　A 　　　2 鈴木　　A 　　　3
Sub test() For Each s In Worksheets Debug.Print s.Name Next End Sub これでシート名を取得する際は左から取得されますが 右からループするにはどうすればいいですか？
Excel VBAについて質問です。 ワークシートを指定するときの書き方には色々ありますが、１～３の速度の順番はどうなりますか？ オブジェクトは、変数に入れて使用したほうが速度が速くなるそうなので、 １より２のほうが速いと思いますが、３はどうでしょうか？ １．Worksheets("sheet1") ２．Dim ws As Worksheet 　　Set ws = Worksheets("sheet1") ３．Sheet1　（VBE画面で表示されるシートのプロパティのオブジェクト名） Excelのオブジェクトについて詳しいかたがいらっしゃいましたら教えてください。 よろしくお願いいたします。
エクセルファイルを保存しようとしたら <?xml version="1.0" encoding="UTF-8" standalone="yes"?> <recoveryLog xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><logFileName>error070800_01.xml</logFileName><summary>ファイル 'C:\あああ.xlsm' にエラーが検出されました</summary><additionalInfo><info>ファイルの破損が深刻なので修復できません。数式と値の保存を試みましたが、消失または破損したデータが含まれる可能性があります。</info></additionalInfo></recoveryLog> と言うエラーになりました。 元々マクロ付のxlsmふぁいるからマクロなしのファイルに名前を付けて保存しようとしたら 怒りました。 このファイルはもう使わないほうが良いのでしょうか？ 一から作り直したほうが良いですか？
いつもお世話になっています。 名前を付けて、特定のフォルダに保存したいのですが、.GetSaveAsFilenameのところで 「メソッドまたはデータ メンバが見つかりません。」のエラーがでてうまく動きません。 何処が間違っているのか教えてください。よろしくお願いします。 元のデーターは、別のフォルダに入っていて、その名前を取得したいです。 しかし、その名前の修正をしたいときもあるので、確認して保存したいです。 ご教授お願いします。 SUB test() Dim fname As String Dim SF As String SF = "\\osaka\PCBackup\" fname = Application.GetSaveAsFilename(SF, _ FileFilter:="wordファイル,(*.doc),*.docx") ActiveDocument.SaveAs Filename:=fname End Sub
今卒論のアンケート結果をExcelにまとめたものを分析している途中なのですが、 Excelの関数がわからなくて困ってます。 アンケートで「常にある」「時々ある」「あまりない」「全くない」の4つから選んでもらう設問を20問用意していて、 たとえば(1)で「常にある」or「時々ある」を選んだ人で、(2)で「常にある」or「時々ある」を選んだ人の数をかぞえるということをやりたいのですが、やり方がわかりません。 (1)-(20)まですべての組み合わせでやるので 関数が不可欠なのですが、どの計算をすればいいのでしょうか？ 厚かましいのですが、できれば具体的に 関数式を教えていただきたいです。 設問(1)は「S列」から始まり「AL列」まで 回答の行は「2行目」から「51行目」まで あります。 説明が適切かどうかも不安ですが、 回答頂けるとうれしいです。 よろしくお願いします。
VBAでシートAの範囲A1：B200までをコピーして シートBの範囲A1：B200にコピペしたいのですが、 範囲のB200のみ変動する可能性があるので、その変動に対応出来るようにしたいです。 例） Worksheets("A").Activate PD = Worksheets("入院費用一覧").Range("A1:B〇〇〇").Value Windows("B").Activate Worksheets("B").Range("A1:B〇〇〇").Value = PD B〇〇〇の所に変動できる数値を関数でC1に行数指定して対応できないかと考えていますが、何かいい方法有りますでしょうか。 宜しくお願い致します。 ※VBAあまり詳しくはありません。
OS：Windows10 Pro 64bit Office2016 Home & Business Premium Excel2016で郵便番号を入れただけで住所を出力する方法を教えてください。 9F：9I　郵便番号、9J：9Z　住所 Microsoft IMEIMEのシステム辞書には郵便番号辞書は入っています。 出来れば関数を使った方法はないでしょうか？
Windows10 PCにてマイクロソフトのOneDrive使用時に、PowerPoint onlineとWord Onlineは起動するのですが、Excel Onlineが起動しないのは何故でしょうか。 そのExcelシートは小さなもので、ローカルでは普通にExcelが起動し読み書きできるのです。 ちなみにNexus ７ではPowerPoint onlineもWord OnlineもExcel Onlineも全て起動します。 　
質問ばかりして申し訳ありません。 日経PCなどを読んで、index関数や写真に名前をつけるなどして、ドロップリストで項目を選択すると画像が切り替わるシートを作成しました。 実際に作ったシートは、66行がドロップリストになっておりまして、リストから項目を選択すると、67行目の画像が連動して切り替わるようになっています。 64行以上の項目データを合計集計する行が65行です。 65行と66行が連動していないので、一回一回手動で66行を操作しないといけません。 なんとか連動させる方法はないでしょうか？ よろしくお願い致します。
Excel 2003、2013 を使用しています。 添付図に基づいて説明させていただきます。 列Ｂの文字列データを[昇順]で[並べ替え]ると、 “ふりがなを使う”の場合は、列Ｃに示した番号順で、 “ふりがなを使わない”場合は、列Ｄに示した番号順で、 上から並べ替わります。 しかしながら、私の実力では実際に[並べ替え]操作をしてみないことには、列Ｃ、Ｄの数値が判明しません。 質問は、=RANK()関数みたいに、[並べ替え]操作をしなくても、列Ｃ、Ｄに示した数値を求めたいので、その方法を教えてください。 差行列、作業シートを使用も、式が寿限無式になることも厭わないので、マクロを使わない方法を教えてください。 文字列の長さは最大10文字としておきます。
別タイトル：　 EXCELのDATAを抽出して日別の表を作る式は 　でご指導いただいた手順のなかで、　Ctrl+Hで置換ダイアログの手順で先に進めません。 『Ctrl+Hで置換ダイアログを出し、「オプション」ボタンを押し、「ワイルドカードを使用する」にチェックを入れ、検索する文字列に「^t」置換後の文字列に「、」を入力して「すべて置換」し、そのまま検索する文字列に』 の『すべて置換」のボタンを押す前後の手順・確認すること・入力のしかたのご指導をお願いいたします。
エクセル2013、OS7です。 エクセルの帳票からインポートして、私のエクセル2013のセルに20150812と数字が打ってあります。 これを2015/08/12と変換したいのですが。 セルの書式設定の「ユーザー定義」で変換できないでしょうか。 私、未熟で難しいことは分かりませんので、宜しくお願いします。 関数で変換できるのかな。
ある集計表を作っており、「COUNTIFS」の導入を目指して勉強中です。 そこで疑問が生じましたので質問いたします。 例えば、A1のセルに「○」、B1のセルに「×」を打ち、そしてC1には○と×の合計数を数えるために「=COUNTIFS(A1:B1,"○","×")」と入力しましたが、「この関数に対して、少なすぎる引数が入力されています。」と出ます。 このエラーを回避しC1に○と×の合計数である「２」が入るようにすればどうすればよいでしょうか。別にCOUNTIFSには拘りません。もっと良い方法があるのでマクロはわからないので関数を教えてください。 また、私のつたない質問の意味が分からない方の回答はお控えくださいますよう、お願いいたします。
こんばんは。 http://okwave.jp/qa/q9089695.html 質問No.9089695 上記前回質問でお世話になりました。 勉強時間を集計したSheet1には Sheet1にA列：科目 B列：開始日 C列：開始時刻 D列：終了日 E列：終了時刻 の記載があります。 終了時刻から開始時刻を差し引いた作業時間を表示する列がありません。 頂いたアドバイスとして、 *********************************************************************************************************** Sheet3のA列とB列を作業列として使用して、Sheet2に科目ごとの勉強時間の合計を集計するものとします。 Sheet3のA2セルに次の関数を入力して下さい。 =IF(INDEX(Sheet1!$A:$A,ROW())="","",IF(COUNTIF(Sheet1!$A$1:INDEX(Sheet1!$A:$A,ROW()),INDEX(Sheet1!$A:$A,ROW()))=1,ROW(),"")) Sheet3のB2セルに次の関数を入力して下さい。 =IF(COUNT(INDEX(Sheet1!$B:$E,ROW(),))=4,IF(ISERROR(1/(INDEX(Sheet1!$B:$B,ROW())=TEXT(INDEX(Sheet1!$B:$B,ROW()),"yyyy/m/d")/(INDEX(Sheet1!$B:$B,ROW())>=1))/(INDEX(Sheet1!$C:$C,ROW())=TEXT(INDEX(Sheet1!$C:$C,ROW()),"h:m:s")+0)/(INDEX(Sheet1!$D:$D,ROW())=TEXT(INDEX(Sheet1!$D:$D,ROW()),"yyyy/m/d")/(INDEX(Sheet1!$D:$D,ROW())>=1))/(INDEX(Sheet1!$E:$E,ROW())=TEXT(INDEX(Sheet1!$E:$E,ROW()),"h:m:s")+0)),"",IFERROR(TEXT(SUM(INDEX(Sheet1!$D:$E,ROW(),))-SUM(INDEX(Sheet1!$B:$C,ROW(),)),"[h]:m:s")+0,"")),"") Sheet3のA2～B2セルをコピーして、Sheet3のA列～B列の3行目以下に貼り付けて下さい。 Sheet2のA2セルに次の関数を入力して下さい。 =IF(ROWS(A$1:A2)>COUNT(Sheet3!$A:$A),"",INDEX(Sheet1!$A:$A,SMALL(Sheet3!$A:$A,ROWS(A$1:A2))))。 Sheet2のB2セルに次の関数を入力して下さい。 =IF($A2="","",TEXT(SUMIF(Sheet1!$A:$A,$A2,Sheet3!$B:$B),"[h]:m:s")+0) *********************************************************************************************************** 上記のアドバイスを実行しましたが、項目は表示されましたが、時間が表示されません。 時間が表示されない理由はどんなことが考えられますか？ よろしくお願い致します。
VBScriptで以下の動作を実現させたいと思っています。 ・vbsファイルにテキストファイルをドラッグする ・InputBoxに任意の文字列を入力する ・変換しますか？と問われるため、 「はい」を押したらTextStreamオブジェクトを1行ごとに読み込む ・見つかった文字列を置換し、その文字列が含まれた全ての行を 　別名のテキストファイルに抽出する 　例：(ファイルA) 　　　asdfghjk.vbs 　　　1:あいうえお 　　　 2:かきくけこ 3:あいうえお ⇒ (ファイルB) 　　 asdfghjk_20151217.vbs 　　 1:をふうえお 2:をふうえお ・「いいえ」を押したら変換しないで別名のテキストファイルに 見つかった文字列が含む行をそのまま抽出する ・見つからなかった場合、何もしない (別名のテキストファイルを作成しない) 前のプログラムだと、文字列が見つからなかった場合でも 空のテキストファイルを作成していました。 これを防ぐために、以下のように修正したのですが、 オブジェクトが存在しない旨のエラーが出て機能してくれません。 どこが問題なのでしょうか？ また、次のステップとして、変換処理を加えたいのですが、 InputBoxを再び使用せずに置換することは可能なのでしょうか？ 恐れ入りますが、回答いただけますと幸いです。 Option Explicit Const ForReading = 1, ForWriting = 2, ForAppending = 8 Dim objParm, strFile, strX, lonMsgBox Dim objFSO, objOpen, strText, strNewFile, objTS Dim lonDate, v, strBuffer Set objParm = Wscript.Arguments If objParm.Count = 0 Then WScript.Echo "引数が指定されていません。" WScript.Quit ElseIf objParm.Count >= 2 Then WScript.Echo "2つ以上のファイルが指定されています。" WScript.Quit Else strFile = objParm(0) End If Set objFSO = CreateObject("Scripting.FileSystemObject") If objFSO.GetExtensionName(strFile) <> "txt" Then WScript.Echo objFSO.GetExtensionName(strFile) MsgBox "テキストファイル以外が指定されています。" & vbCr _ & "ファイルを指定し直してください。", vbExclamation, "Error" WScript.Quit End If strX = InputBox("抽出したい文字列を入力してください。", "変換処理") If IsEmpty(strX) Then MsgBox ("キャンセルされました。") WScript.Quit ElseIf strX = "" Then MsgBox "文字列が入力されていません。" & vbCr _ & "入力し直してください。", vbOKOnly, "Error" WScript.Quit End If lonMsgBox = MsgBox(strX & "を抽出します。" & vbCr _ & "変換しますか？", vbYesNo + vbQuestion, "確認") If lonMsgBox <> vbYes Then MsgBox ("変換をスキップします。") End If lonDate = "_" & Year(Now()) & right( "00" & Month(Now()),2) & right( "00" & Day(Now()),2) strNewFile = objFSO.BuildPath( _ objFSO.GetParentFolderName(strFile), _ objFSO.GetBaseName(strFile) & _ lonDate & "." & objFSO.GetExtensionName(strFile)) Set objOpen = objFSO.OpenTextFile(strFile, ForReading) Do Until objOpen.AtEndOfStream = True strText = objOpen.ReadLine v = strText.ReadLine If InStr(v, strX, vbTextCompare) > 0 Then strBuffer = strBuffer & v & VBCrLf End If Loop objOpen.Close Set objOpen = Nothing If IsEmpty(strBuffer) Then MsgBox strX & "が見つかりませんでした。" WScript.Quit End If Set objTS = objFSO.OpenTextFile(strNewFile, ForWriting, True) objTS.WriteLine strBuffer objTS.Close Set objTS = Nothing Set objFSO = Nothing WScript.Sleep 1000 MsgBox ("文字列の抽出が完了しました。")
エクセルで日々の出席簿を作成しています。 その中の日付欄に記録した日を入れるべく、セルにTODAY関数を挿入し、入力規則でリストからその日付を選べるようにしています。 そこでそのリストに空白も選べるようにしたく、入力値の種類をリストにし、元の値の所に「＝$C$2,” ”」と入力してもなかなか上手くいきません。 どうすればできるでしょうか。
最近は自分で表などを作る機会が少ない高齢者ですが、 目的は、Office2013　EXCELで AH2セルに、１日,鹿児島,山口,広島 AH３セルに２日熊本,大分,長崎　　 という文字列をそれぞれ一つのセル(AH2セルからAH32)に書き出したいのです、 EXCELの表の１行目にB列からAF列まで1から31までの一ヶ月の日付を書き入れ、 A列の2行（A２セル）から21行（A２1セル）に氏名を書き入れている表の、 DATAとして、　B2セルからAF21セルの、不特定のセルの★や☆の記号を、 一番目に、 B2～B21のなか（仮にB3セル）に　★☆の記号が有ったら、　 その行の該当氏名（鹿児島（A3セル））をWORD文字列に、書き出し、 二番目に、 B2～B21のなか(仮にB5セル)に　★☆の記号が有ると、 その行の該当氏名（山口（A５セル））をWORD文字列に、書き出すことを、 一ヶ月すべての日付（B1セルからAF1セルに該当）の★☆がある列 （B2セルからAF21セルのすべて）から抽出して、 AH2セルからAH32セルに書きだす　 式 / 関数のご指導お願いいたします。
エクセル2013　OS7です。 数量のSUMを求めたい。 数量の数字は他からコピーして印字してある。 SUMを求めたところ「０」となる。 数字が文字データと思い、VALUEで変換し、その後オートフィルをした。 が、VALUEしたセルのところは数値に変換されたが、オートフィルしたところは数値に変換されず 初めのVALUEしたところの数値が表示された。 オートフィルしたセルのVALUEの式をみると、オートフィルしたセルの番号が表示されている。 どうしたらよろしいのですか。教えてください。 2003ではこのようなことはなかった。 不得手なので表現がうまくありませんが宜しくお願いします。
今は、 Ｂ列が空白なら、赤くするになっていますが 本当は 「Ａ列に文字が入っていてＢ列が空白なら」 としたいのですが、 どのような式にすればいいのでしょうか？
お世話になります。田中と申します。 以前も同じ質問させていただきましたが、複数のブックを自動で開いて閉じるVBAロジックをご教授いただきましたく思います。 Excel VBAを使って下記(1)、(2)の処理を実現したいと思っております。 どなたかVBAロジックをご教授いただけませんでしょうか。 (1)集計.xlsxというブックがあります。このブックに[ファイル]というシートがありまして A1のパス、B1にファイル名が記入されています。 この組み合わせのファイル数は可変ですが下記のように大体10個程度あります。 A2(パス)+B2(ファイル名) A3(パス)+B3(ファイル名) A4(パス)+B4(ファイル名) A5(パス)+B5(ファイル名) ・・・ (2)このシートに[開く]というボタンを配置して、クリックされたらA1(パス)+B1(ファイル名)でファイルを開いて何もしないですぐに閉じて、次のファイルを開いて閉じて、また次のファイルを開いて閉じて。。という動きをファイル数分繰り返したいのです。 どなたかご教授いただけますでしょうか。 よろしくお願い致します。
金融機関、支店によって振込手数料が違う条件でエクセルを作成したいと考えています。 以下の条件の数式を振込手数料（セルＢ８）に表示したいと考えております。。 (1) 銀行名　Ａ銀行 支店　Ｂ支店 金額条件なし 振込手数料　0円 (2) 銀行名　Ａ銀行 支店　Ｂ支店以外 金額　30,000円以上 振込手数料　300円 (3) 銀行名　Ａ銀行 支店　Ｂ支店以外 金額　30,000円未満 振込手数料　100円 (4) 銀行名　Ａ銀行以外 支店条件なし 金額　30,000円以上 振込手数料　400円 (5) 銀行名　Ａ銀行以外 支店条件なし 金額　30,000円未満 振込手数料　200円 条件が複雑ですがぜひ教えていただければと思います。 どうぞよろしくお願い致します。
ここで教えて頂いた式なのですが セルＢ1に =IF(MID(A1,4,1)="県",LEFT(A1,4),LEFT(A1,3)) セルＥ1に =MID(A1,LEN(B1)+1,150) セルＣ1に =IF(ISERROR(FIND("大和郡山市",E1))=FALSE,"大和郡山市",IF(ISERROR(FIND("四日市市",E1))=FALSE,"四日市市",IF(ISERROR(FIND("廿日市市",E1))=FALSE,"廿日市市",IF(ISERROR(FIND("郡山市",E1))=FALSE,"郡山市",IF(ISERROR(FIND("市原市",E1))=FALSE,"市原市",IF(ISERROR(FIND("郡上市",E1))=FALSE,"郡上市",IF(ISERROR(FIND("蒲郡市",E1))=FALSE,"蒲郡市",IF(ISERROR(FIND("小郡市",E1))=FALSE,"小郡市",IF(ISERROR(FIND("市川市",E1))=FALSE,"市川市",IF(ISERROR(FIND("郡",E1))=FALSE,LEFT(E1,FIND("郡",E1)),IF(ISERROR(FIND("市",E1))=FALSE,LEFT(E1,FIND("市",E1)),IF(ISERROR(FIND("区",E1))=FALSE,LEFT(E1,FIND("区",E1)),IF(ISERROR(FIND("町",E1))=FALSE,LEFT(E1,FIND("町",E1)),IF(ISERROR(FIND("村",E1))=FALSE,LEFT(E1,FIND("村",E1)),"")))))))))))))) セルＤ1に =SUBSTITUTE(SUBSTITUTE(A1,B1,"",1),C1,"",1) 大阪府大阪市西淀川区福町3丁目1-50→大阪府　大阪市　西淀川区福町3丁目1-50 兵庫県神戸市兵庫区芦原通1丁目2番26号→兵庫県　神戸市　兵庫区芦原通1丁目2番26号 となります。これを 大阪府大阪市西淀川区福町3丁目1-50→大阪府　大阪市西淀川区　福町3丁目1-50 兵庫県神戸市兵庫区芦原通1丁目2番26号→兵庫県　神戸市兵庫区　芦原通1丁目2番26号 と市と区は同じセルに分けたいです。郡も同じで市と同じセルに分けたいです。 分ける区分は都道府県　　市区郡　　町名・番地と三つに分けます。
一つのブックにおいて、[表示]→[ウィンドウ]→[新しいウィンドウを開く]を(例えば)２回実行して、(例えば)“左右に並べて表示”させている、とします。 このとき、(左右に)表示されている同じブックの３つのウィンドウのズーム倍率を１回の操作で(例えば) 100→50％にすることができるなら、その手順を教えてください。 使用中の Excel は 2013 および 2002 です。
excel2013を利用しています。 文字A 文字B 文字C となっていて、これを 《文字A》 《文字B》 《文字C》 このように一発で囲みたいのですが、処理方法がありましたら教えてください。 5000行くらいを処理したいので一発でできる方法が知りたいです。 エクセル初心者なので、マクロ等はわかりません。
学年の人数は320人です。 評価は5,4,3,2で、それぞれの割合は、10％、25％、50％、15％です。 （１は単位不認定の者で除外してあります。） これを出した後、10段階に直して平均が6.0になるようにするには、どうすればよいでしょうか。 10段階では10,9が5段階の5、同様に8,7が4、6,5が3、4,3が2、2,1が1で、10段階のそれぞれの段階の割合は決まっていません。 総合得点と5段階評定を範囲指定して降順にし、吟味して決める方法しかないでしょうか。
図のような表で、品物の値段を選んでもらった際に その商品の価格を別のセルに表示させる方法が分からずに困っています。 オプションボタンを押して価格を表示することは可能ですが その場合には、この表を２度目に見たときに 前回の履歴が表示されたままになってしまいます。 ボタンを押すのでも、他の方法でもかまいませんので マクロを使用せずに、ワンクリックするだけで 選んだ品物の価格を指定欄（C７）に表示させる方法を教えて下さい。 よろしくお願いします。
vb.netのフォームから、エクセルファイルを立ち上げた時に、 エクセル側で Private Sub Workbook_Open() ActiveWindow.WindowState = xlMaximized としてるのに、 ウインドウのサイズを最大化されないのですが、 どうしてでしょうか？
vbaのie操作で 一つ目はタブはグーグルメール 二つ目のタブはドコモメールを開きたいのですが、 ドコモメールはPWをVBAで入れないと進めないので入れたいのですが Sub test() Dim myObj As Object Dim objIE As InternetExplorer Set objIE = CreateObject("InternetExplorer.Application") With objIE .Visible = True .Navigate "https://mail.google.com/mail/u/0/?pli=1#inbox"　’グーグル End With objIE.Navigate2 "https://mail.smt.docomo.ne.jp/mail/#fid=10000000&page=1", 2048　’ドコモ For Each myObj In objIE.document.all.tags("input") If myObj.ID = "persistent" Then myObj.Value = "PW" Exit For End If Next Set objIE = Nothing End Sub だと、 For Each myObj In objIE.document.all.tags("input") は、グーグルメールを参照しています。 LocationURLを見てみたら、 "https://mail.google.com/mail/u/0/#inbox" になっていました。 このように、二つのタブを開き、二つ目のタブに対して、操作したい場合 どうすればいいでしょうか？
エクセル2016のプロダクトキーを入力してセットアップをしようとしたところなぜかセットアップし始めると 「プロシージャエントリポイントSetWaitableTimerExがダイナミックリンクライブラリKERNEL32.dllから見つかりませんでした。」 と出てきて、 「Microsoft　Officeは動作を停止しました」 といって終わってしまいます。 どうすればよいのでしょうか？ ちなみにウィンドウズVistaです。
食べログの検索結果をVBAで取得したいのですが 上手くいきません。 例えば、東京都の和食のお店の各お店のページのURLを取得しようと Sub tset() Dim strURL As String Dim objIE As InternetExplorer Dim myObj As Object strURL = "http://tabelog.com/tokyo/rstLst/washoku/" Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True objIE.Navigate strURL Do While objIE.Busy = True Or objIE.ReadyState <> 4 DoEvents Loop For Each myObj In objIE.Document.all.tags("a") If myObj.class = "list-rst__rst-name-target js-click-rdlog" Then Debug.Print myObj.href End If Next End Sub としたのですが、 If myObj.class = "list-rst__rst-name-target js-click-rdlog" Then の部分で、 実行時エラー 438「オブジェクトは、このプロパティまたはメソッドをサポートしていません」 と言うエラーになります。 ソースを見ると tlst-1-pref-0-1-0-0-0-0-0-0-0-0-0-0-0-2-1/*-http://tabelog.com/tokyo/A1317/A131710/13014641/" class="list-rst__rst-name-target js-click-rdlog" data-adtype="add_info" data-advertise="shnm" data-onclick-sitecatalyst="rstlst_shnm" data-rd-url="http://rd.tabelog.com/DEV=p/POS=shnm/RCD=13014641/TYPE=add_info/COND=rstlst-1-pref-0-1-0-0-0-0-0-0-0-0-0-0-0-2-1/*-http://tabelog.com/tokyo/A1317/A131710/13014641/">郷土料理おいどん 不動前店</a> なので、 "list-rst__rst-name-target js-click-rdlog" でしぼってｓのURLを取得すればいいと思ったのですが なぜエラーになるのでしょうか？
ExcelのVBAのコードでB列の１カ所の「zz2300」を取得したいのですが、 どういう記述をすればよろしいのでしょうか。 ※その列には同じ文字は存在しません。 test＝Range("b65535").End(xlUp).Rowの定義があるのですが使えますか？
こちらの識者の方々にはいつもお世話になっています。 VBAの質問です。 環境は下記になります。 OS=windows7 pro 64bit Office=Excel2010(14.0.7128.5000) ・やりたいこと 題名に大いに不足があり申し訳ないです（文字制限の中で適切に表現できませんでした）。 添付ファイルのようなリストがあり、マクロを実行するたびに"CRT","CRN","MRT","MRN"を一つ↓にずらしてループさせたいのですが、 "CRT","CRN"についてはB列の値0の範囲内で、"MRT","MRN"についてはB列の値1の範囲内でそれを行いたいのです。 つまり、"CRN"が16行目にあるときに実行したら、"CRN"を2行目に持ってくる（"CRT"も同様）、 "MRN"が31行目にあるときに実行したら"MRN"を17行目に持ってくる、という感じです。 Cat0,1ともに15個ですので下段の通り現在はMOD関数でカウンター変数の余りを求めて処理していますが、 あまりいい処理とは思えません。 （Cat0,1共に同一数でなければならないという制約が付くので） Option Explicit Option Base 1 Sub hoge2() 　Dim Wb As Workbook, Ws As Worksheet 　Dim i As Long, iNA As Long, EndRow As Long 　Dim mtxNI As Variant, mtxNA As Variant 　 　Set Wb = ThisWorkbook 　Set Ws = Wb.Sheets(3) 　EndRow = Ws.Cells(Rows.Count, 1).End(xlUp).Row 　mtxNI = Ws.Range("A1:J" & EndRow).Value 　 　mtxNA = Array("CRT", "CRN", "MRT", "MRN") 　For iNA = 1 To UBound(mtxNA) 　　For i = 2 To EndRow 　　　If mtxNI(i, 10) = mtxNA(iNA) Then 　　　　mtxNI(i, 10) = "" 　　　　If i Mod 15 = 1 Then 　　　　　mtxNI(i - 14, 10) = mtxNA(iNA) 　　　　Else 　　　　　mtxNI(i + 1, 10) = mtxNA(iNA) 　　　　　Exit For 　　　　End If 　　　End If 　　Next i 　Next iNA 　Ws.Range("A1:AO" & EndRow).Value = mtxNI 　 End Sub この場合どのようなコードが適していますでしょうか。 まだまったく理解できていませんが、クラスモジュールのほうが適しているのでしょうか？ 質問に不備不足等ございましたらご指摘ください。 ご面倒お掛けしますがよろしくお願いします。
エクセル関数について質問です。 以下のような長い住所を２つのセルに分ける作業をしています。 神奈川県逗子市逗子5－2－16マンション名４６６７号棟 東京都葛飾区東北沢南元８－９９０９マンション名８９０ 埼玉県入間郡毛呂山町毛呂本郷38－５－６ 住所の区または市または郡の後の住所を隣のセルに移動する関数はありますか？ よろしくお願いいたします。
Excel、ソフトは2013で、マイクロソフト7です。 折れ線グラフを作成しています。 タイトルが長くて1行で書くこと出来ません。タイトルの枠の長さを調整（規定の長さよりも一文字でも）できないのですか？ フォントサイズを小さくするとか、2行に書き改める以外に、タイトルの長さを少し長くしたいのです。 教えてください。お願いします。
Excel、ソフトは2013で、マイクロソフト7です。 折れ線グラフを作成しています。 横（項目）軸に、製品の各々のロット番号を付したいのですが、代表数字しか記載されていません。 （例）ロットが 150107、150119、150202、150216、150304、150313、150330、150421、150515、150603、150622、 グラフの横（項目）軸には 150000、150200、150400、150600、・・・・としか文字が表示されません。 実際のロットの値がほしいのですが・・・・ 教えてください。
先ほどの質問は説明が抽象的でしたので、図を添付します。 お世話になります。 アンケートの集計をしております。 年齢層および性別が記入されている場合は、下記の関数で集計しています。 ＝COUNTIFS(年齢層,40代,性別,男性,A項目,”<>”) 年齢層または性別が無記入で、ある項目には答えてくれている場合の集計が出来ません。 年齢層または性別が無記入でも、答えてくれている人の意見も「その他」の人として集計したいと思います。 「年齢層または性別が無記入」をどう処理すればよいのでしょうか。 恥かしながら、以下ではだめでした。 ＝COUNTIFS(OR(年齢層<>”?*”,性別<>”?*”),A項目,”<>”) よろしくお願いいたします。
A1 大阪府泉南市信達童子畑20 埼玉県吉川市中野338 東京都足立区鹿浜6-26-10 B１　　　　　　　　C1　　　　　　D1　 大阪府　　　　　　　泉南市　　　　信達童子畑20 埼玉県　　　　　　　吉川市　　　　中野338 東京都　　　　　　　足立区　　　　鹿浜6-26-10 都道府県／市区郡／町名・番地 と三つに分けたいです。 どうやったらできますか。
複数の同じ形式の表から、データのある行だけを抽出し、それを全て並べて一つの表にまとめたいです。表自体の列数・行数は固定ですが、行数は項目数によっては余ることがあります。 表１： 日付　　項目　　金額 6/4 花　　　300 6/11 手紙 200 6/14 花 350 (空白) (空白) (空白) (空白) (空白) (空白) 表２： 日付　　項目　　金額 7/2 手紙 210 7/16 手紙 270 (空白) (空白) (空白) (空白) (空白) (空白) (空白) (空白) (空白) 表３： 日付　　項目　　金額 8/9 花　　　300 8/21 手紙 200 8/24 花 350 8/26 花 250 8/29 花 250 これらから下記のような表を作りたいです。 日付　　項目　　金額 6/4 花　　　300 6/11 手紙 200 6/14 花 350 7/2 手紙 210 7/16 手紙 270 8/9 花　　　300 8/21 手紙 200 8/24 花 350 8/26 花 250 8/29 花 250 実際には表も数十あるため、手動では大変で困っています。 もし方法がありましたらご教授下さい。よろしくお願い致します。
Excel 2007 で血圧を記録し、VBAで縦軸を血圧値、横軸を日付にした任意の範囲の折れ線グラフを表示できるようにしています。 選択したグラフ範囲（日付範囲）に、別途指定したイベント発生日が含まれていれば、その日付の位置にフルスケールの縦線を表示させ、可能であればそれと共にグラフの適当な位置にその日付に関連したイベントの内容を表示させたいと思います。 イベント発生日にグラフに縦線を表示する手順は添付画像に示すように系列（イベント発生）を追加しイベント発生日のデータ欄に縦軸の最大目盛り値以上の数値を書き込んで、この系列を棒グラフに変更して縦線を表示しています。（棒グラフの幅は最小幅に設定） イベントの内容は別のセルに書き込んでおいて、そのセルを参照してグラフ上に表示させたいと思いますが、具体的な方法が浮かんで来ません。 よいアイデアがあれば教えてください。 よろしくお願いします。
3番目の（　）内に1年後、2年後、3年後の日付（閏年を反映させた日）を 自動で入るようにしたいのですが、 条件がありまして、 1.一番左のセルには契約日を入力します。 ２真ん中のセルが、選択できるようにしてあります。 　契約期間が１年・２年・３年と選択するようになっています。 3.（　）内に左の年月日から【１年・２年・３年】後の日付を自動入力になるように するにはどのような式をいれたらいいのでしょうか？ わかりにくい説明ですみません。 宜しくお願い致します。
Windows　7　エクセル　2010　を使用しています。 エクセルのシートを最大化した状態（パスワードをかけない）で、シート右上のｘで閉じ、再度エクセルのシートを開いた場合は、最大化の状態でシートが開きます。しかしシートを最大化状態でシートにパスワードをかけた状態でシートを閉じ、再度シートを開いてもシートは画面の半分の大きさでしか開かないです。 シートにパスワードをかけた状態で、最大化にした状態には開くことができないのでしょうか。
お世話になります。 Excel2010 Excelにて勤務表を作成しているのですが、祝日については 全て自動的に取得することができました。 あとは夏季休暇の取得のみの状況です。 ※年末年始休暇は12/29～1/3の固定。 過去の夏季休暇は以下の通りです。 なお、日数は土日含めて5日です。 　2009年　8/12(水)～8/16(日) 　2010年　8/11(水)～8/15(日) 　2011年　8/13(土)～8/17(水) 　2012年　8/11(土)～8/15(水) 　2013年　8/14(水)～8/18(日) 　2014年　8/13(水)～8/17(日) 　2015年　8/12(水)～8/16(日) 確認すると、8/15(お盆)が 　・月～水だと前半休み（日～水） 　・木～日だと後半休み（水～日) になっているように見受けられます。 ここで質問ですが、夏季休暇で土日以外の3日間の日付を取得したい のですが、どのように導き出せばよいのでしょうか。 例えば、2015年だったら 　B1：2015/8/12 　B2：2015/8/13 　B3：2015/8/14 というように、それぞれ別のセルに取得したいところです。 なお、年はA1に入力されているとします。 ご教示の程、宜しくお願い致します。
Pictures.Insert　で書かれた内容を Shapes.AddPicture　の構文に変更したいのですが、 VBAの知識が乏しいので、なかなかうまくいきません。 どなたかわかる方はいらっしゃいますでしょうか？ 宜しくお願いします。 Sub Test() Range("B3").Select Dim fName, pict As Picture fName = Application.GetOpenFilename("JPG, *.jpg", MultiSelect:=True) If IsArray(fName) Then For i = 1 To UBound(fName) Set pict = ActiveSheet.Pictures.Insert(fName(i)) pict.TopLeftCell = ActiveCell pict.Width = ActiveCell.Width * 2 pict.Height = ActiveCell.Height * 6 ActiveCell.Offset(7, 0).Activate Next i End If End Sub
以下のもので …(1)において 「型が違う」 と、お叱りを受けます。 何処が間違えていますでしょうか？ お教えください。 Function Average(リスト As Variant) As Variant 　　Average = Evaluate("AVERAGE(" & リスト & ")")　　…(1) End Function Function testのMain(θ1 As Variant, θ2 As Variant) As Variant Dim Temp1 As Variant 　　Temp1 = Average(Array(θ1, θ2)) End Function 前は確か出来ていた だけに 出来ない のが、口惜しい です 資料もマシン崩壊に伴い消失 なんともはや…
エクセルで全シートから複数項目で検索をかけ、条件に合う項目の行ごと 新しいシートに抽出結果として表示することは可能なのでしょうか。 初心者なりに考え、無様なコードではありますが、 検索条件が１つであれば、条件にあう行をすべて抽出することはできました。 ですが複数、または列ごと条件として指定することができず、難儀しております。 たとえば Sheet1 　　　A　　　　B　　　　C　　　　D 1　　　　　 田中太郎　　 男　　　穏やか　 2　　　　　 鈴木次郎　　 女　　　うっかり 3　　　　　 山田三郎　　 女　　　怒りっぽい 4　　　　　 佐藤四郎　　 男　　　せっかち Sheet2 　　　A　　　　B　　　　C　　　　D 1　　　　　 伊藤五郎　　 女　　　用心深い 2　　　　　 加藤六郎　　 男　　　ずぼら 3　　　　　 斎藤七郎　　 女　　　臆病 4　　　　　 後藤八郎　　 男　　　陽気 Sheet3 　　　A　　　　B　　　　C　　　　D 1 　　　　　【条件】 2　　　　　 加藤六郎 3　　　　　 鈴木次郎 4　　　　　 山田三郎 5　　　　　 後藤八郎 マクロ実行後↓ 新しいシート 　　　A　　　　B　　　　C　　　　D 1　　　　　 加藤六郎　　 男　　　ずぼら 2　　　　　 鈴木次郎　　 女　　　うっかり 3　　　　　 山田三郎　　 女　　　怒りっぽい 4　　　　　 後藤八郎　　 男　　　陽気 といった具合にしたいと考えております。 この場合ですと、B列全体を条件としたり、 Sheet3の条件が入力されているセルすべてを検索条件として 渡すことはできるのでしょうか。 実際のシートでは、条件が１０個～１００個ほどあり、 シートごとに数はばらばらになっております。 どうかわかる方、お力をお貸しください。
エクセルでマクロを作成し、ボタンにマクロを登録しています。そのファイルをOneDriveに保存し利用していますが、いずれかのタイミングでボタンが消えてしまいます（マクロは残っています）。で、またボタンを作成しマクロを登録しますが、やはりその内ボタンが消えてしまいます。これはなぜでしょう。ご存知の方いらっしゃれば、ご回答お願いいたします。
こちらの識者の方々にはいつもお世話になっています。 VBAの質問です。 環境は下記になります。 OS=windows7 pro 64bit Office=Excel2010(14.0.7128.5000) ・やりたいこと 指定範囲から、指定の文字列の範囲のrangeオブジェクトを取得する。 ColumnDifferencesが比較的やりたいことに近い（というか今まではこれを使っていた）のですが、 具体的には、A列に"FALSE"か"TRUE"の値が入っている状態で、A列を昇順で並び替え、FALSEの列を削除するというコードで、 Dim rng As Range 　rng = Range("A1:A100") 　rng.ColumnDifferences(rng(2)).EntireRow.Delete というような感じでやっていました。 しかし、A列に"TRUE"か"FALSE"どちらか一方しかない場合にエラーになってしまうことがわかり、その回避をしたいのです。 Dim rng As Range 　rng = Range("A1:A100") 　rng.ColumnDifferences(”TRUE”).EntireRow.Delete のような使い方ができればと思うのですが、通りません。 ColumnDifferencesメソッドの引数ComparisonはVariant型のようですが、文字列を指定することはできないのでしょうか？ また、この場合どのようなコードが適していますでしょうか。 ColumnDifferencesメソッドを使うことには頓着していませんが、for~next文などで一行ずつ削除する方法を使わずに実現したいです。 質問に不備不足等ございましたらご指摘ください。 ご面倒お掛けしますがよろしくお願いします。
初歩的な質問で、すいません。 エクセルなのですが、例えばB1からB10まで数値を入力したとします。 B11には、B1からB10までの平均値（AVERAGE関数により算出）を表示するようにしています。 そこでなのですが、AVERAGE関数を設定すると、B1からB10までの間全部の数値が入力されていなくても計算されるのですが、B1からB10全てのセルに数値が入力されていないと計算されないようにしたいのです。 マクロは、まだ使えるとこまでいっていないので、マクロを使わないで計算表示される方法お分かりの方、教えていただきたいです。宜しくお願いします。
お世話になっています。 勉強時間をフリーソフトで記録しています。 フリーソフトからエクセルに吐き出されたシートには、開始時刻と終了時刻が記載されているだけで、終了時刻から開始時刻を差し引いた作業時間を表示する列がありません。 このシートを参照して、別の自分で作るシートに科目ごとの勉強時間の合計を集計したいのですが、いかんせん、作業時間を表示する列がないので、どのような関数をつかえばいいか思いつきません。 sumifとかで集計できないでしょうか？ やはり、参照元に作業時間列がないと無理でしょうか？ 宜しくお願い致します。
お世話になります。田中と申します。 Excel VBAを使って下記(1)、(2)の処理を実現したいと思っております。 どなたかVBAロジックをご教授いただけませんでしょうか。 (1)集計.xlsxというブックがあります。このブックに[ファイル]というシートがありまして A1のパス、B1にファイル名が記入されています。 この組み合わせのファイル数は可変ですが下記のように大体10個程度あります。 A2(パス)+B2(ファイル名) A3(パス)+B3(ファイル名) A4(パス)+B4(ファイル名) A5(パス)+B5(ファイル名) ・・・ (2)このシートに[開く]というボタンを配置して、クリックされたらA1(パス)+B1(ファイル名)でファイルを開いて何もしないですぐに閉じて、次のファイルを開いて閉じて、また次のファイルを開いて閉じて。。という動きをファイル数分繰り返したいのです。 変な処理ですが、本Excelのリンクの値がリンク先のファイルを開かないと値が飛んでこないので、リンク先のファイルを開く処理を自動化したかったのです。 どなたかご教授いただけますでしょうか。 よろしくお願い致します。 環境　Excel2013
2010以降のExcelVBAです ユーザー定義関数として使うfunction 此の引数として 幾つかの項に配列数式、又は定数配列を与えたいのです が、 此の際の 引数の受け方と処理の仕方 此が判りません 例を交え お教え願えないでしょうか？ 宜しくお願い致します。
COUNTIF関数でワイルドカードを使って検索する場合、検索対象は文字列でないと検索できないんでしょうか？　例えば、COUNTIF(A1：A10,"??1??")　と入力した場合、A1からA10は数値では検索できず、文字列でないと検索できませんか？
エクセル2010について教えてください。 現在，A列にある年月日を入力，B列にA列と本日TODAY()までの経過年月をDATEDIF関数で表記するようにしています。表記は「１年5月」の形です。 ここで，B列の年月が５か月以上経過したものには一目でわかるように，たとえばそのセルに色を付けるとか，C列のセルにマークを表記させるとかしたいと思っています。 色々調べたのですが，これぞと思うものが見当たりません。 どうかよろしくお願いします。
エクセルである日にちをセル(1)入力するとします。 セル(2)にリンクさせて、そこにはセル(1)の日付の2年後を自動で入るようにするには、 セル(2)にどのように入力すればいいですか？ そのままコピーして貼り付けたいのでそのように教えていただけると 助かります。 ご存知の方宜しくお願い致します。
どなたかの回答を読んいて、最大(小)値を求める関数に、私が使ったことのない =MAXA() とか =MINA() が存在することを知りました。私は専ら =MAX()、=MIN() を使っていたのです。 下記の文章は、MAXA関数のヘルプからの抜粋です。 １．引数には数値を表す文字列を指定できます。 ２．引数として指定した論理値と、数値を表す文字列が計算の対象となります。 ３．引数としての配列またはセル範囲の参照に含まれる空白セルと文字列は無視 ＿＿されます。 ４．引数に文字列が含まれる場合は 0 と見なされます。 添付図において、 １．範囲 B1:B5 に数値を入力。 ２．セル A1 に式 =TEXT(B1,"0") を入力して、下方にオートフィル。 ３．セル B6、B7 に式 =MAX(B$1:B$4)、=MAXA(B$1:B$4) を入力。 ４．範囲 B6:B7 を左にオートフィル。 ５．列Ｄ、Ｃも上と同様ですが、MAX を MIN の読み替えてください。 でも、当該表の結果からは MAX と MAXA の、および、MIN と MINA の違いを窺い知ることができません。どなたか MAX と MAXA の使い分けの好例を教えてください。
図のような表で、C列の売上げに値がある会社名を基準に、 売上げに値が入っていないセルも含めて、売上げがあるものと同じ 年月、会社名だった場合にD列にフラグとして会社名を表示させたいです。 IFとANDを使って色々やってみたのですができませんでした。 どうかご教示ください。
