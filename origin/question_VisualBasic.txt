図のようなリストのB列に商品番号が入っています。 ただし ・シリアル（番号）はB列に入っている（固定） ・データの最終行は未定（表による） ・データのある右端の列も未定（表による） このようなシートに対して、次のような操作ができるVBAのコードを教えてください。 1. データが入っている列の右端を調べ、そのさらに右列を入力列とする （ここではF、罫線など書式設定は不要） 2. B列（シリアル）のデータの左から3文字を検査し、ABCとなっている行は◯を入力する 3. B列の頭3文字のうち、XXの2文字がある場合（XXZでもAZZも＝緑）、Aを入力する 4. B列の頭4文字以右に該当文字（ABCやXX）があっても該当しない（ピンクは対象外）。 5. 最終行の検証が終わったら終了（ここでは12行目が最終行） お時間のあるときでいいので、よろしくお願いします。 Excel 2010 or 2013
図のような中抜の一覧ができているとき、商品コードで空行を飛ばして並び替えをしたいのですが、下記だと空行まで（チョコからわたがしまで）しか対象になりません。 ---------------------------- Sub 並べ替え() With ActiveSheet.Sort .SortFields.Clear 'Key:=Range("A3")でソートする列とタイトル位置を指定 .SortFields.Add Key:=Range("A3"), SortOn:=xlSortOnValues, _ Order:=xlAscending '.「商品コード」("A3").でソート .SetRange Range("A3").CurrentRegion ' 先頭行をタイトル行と見なす .Header = xlYes .Apply End With End Sub ------------------------- 範囲をCurrentRegion ではなくUsedRangeに広げるには、どこをいじったらいいでしょうか。 求める結果としては「商品コード」の列が登り順に揃ってほしいのです。 データ処理としてはソートをかければいいだけですが、UsedRange（範囲内のセルを選択し、Ctrl＋Shift+Endキーで選ばれる範囲）をみつけてソートをかける方法を知りたいのです。
Excel2013ですがフォームがあり重複する行をExcel枠線を残しVBAコードでセル項目、数値のみ削除したいのですが A列　B列　C列 あ　 １　　a あ　 １　　a あ　 ２　　a い　 １　　a い　 ２　　c い　 ２　　c A列　B列　C列 あ　 １　　a あ　 ２　　a い　 １　　a い　 ２　　c のようにABC列同一文字は１行にしExcel枠線を残すVBAコード、関数の解る方ご教授願います。 ActiveSheet.Range("$A$1:$C$6").RemoveDuplicates Columns:=Array(1, 2, 3), Header:=xlNo 上記の以前回答頂いたVBAコードで内容は問題なかったのですが枠線まで削除されるので改めて枠線を作っていますどうかよろしくお願いします。
Excel2013ですが表－１のA列同文字が終了したら同シートの表ー２のように１行挿入しD列に"合計"という文字、E,F列にA列の同文字に対しそれぞれに合計値を入れたいのですがVBAコードが解る方よろしくお願いします。
お世話になります。 Visual Studio Professional 2015　を購入して既定でインストールしました。 新規プロジェクトで　Visual Basicのテンプレートにお決まりのようにあるはずの Windowsフォームがないのですが、どうしればテンプレートに表示されるようになるでしょうか？ Visual Studio Professional 2012などで作成した既存のプロジェクトなどは2015で問題なく開けたので、新規プロジェクトでWindowsフォームが作成できないということはないと思うのですが・・・ Windows 10、Windws 8.1 などで既存インストール、カスタム全選択インストールの両方を試したのですがテンプレートにWindowsフォームの選択肢は表示されませんでした。 せっかく購入したのに、ものすごく焦っております。 Visual Basic のテンプレートにWindowsフォームを表示させる方法をご存じの方、何卒ご指導いただければと思います。 よろしくお願いいたします。
B2:D11まで入力された文字と数値がありB,C列のマッチした文字の計算値をH列にいれたいのですが現在H列はVBAによりセルに数式が入っておりますが計算結果のみをH列に入力したいのですが尚、図では11行までですが行数が多い時を踏まえてVBAコードをご教授願います。
A列には大半が文字が入力されており特定の文字"自分"と一部数字があればその2,3,4行を削除し以下のように行を詰めたいのですがどなたかVBAコードの解る方お願いします。 　 A 　B 　C　　　 1 鈴木　あ　い　　　　 2 自分　う　え　　　　　　 3 123 お　あ　　　 4 368 え　う 5 江藤 え　う 　　　↓ 　 A 　B 　C 1 鈴木　あ　い 2 江藤 え　う
表－１A列に同文字"あ"があれば続けてその行を下行へ移動したいのですが表－２のようにA列に"あ"でまとめた行、次に"い"でまとめた行に入れ替えたいのですがVBAコードをお教え願います。
ネットワークドライブ名を変更したい為、以下のBATファイルとVBスクリプトを作成しました。 ですが、どうも引数が渡せていないようです。 どこが間違っているのでしょうか？ どなたかご教授お願いします。 ◆BATファイル net use F: /delete net use F: \\○○\△△ set Drive = F set DriveName = PC_△△ cscript.exe "Rename.vbs" %Drive% %DriveName% ◆スクリプト（Rename.vbs） Dim oParam Dim strDrive Dim strName Set oParam = WScript.arguments strDrive = oParam(0)&":\" strName =oParam(1) With CreateObject("Shell.Application").NameSpace(strDrive) .Items().Item().Name = strName End with バッチファイルを実行すると、以下の内容になっており、引数が取得できていないようです。 cscript.exe "Rename.vbs" "" 実行時エラー：インデックスが有効範囲にありません。
大量のｔｘｔファイルのファイル名をテキストの先頭行に挿入するスクリプトを見つけて実行したのですが、１７行の引数エラーとなってしまいました。 古いスクリプト（２００７年）で作者に繋がるかわからないので、どなたかｖｂｓに詳しい方に教えていただければ幸いです。 http://beauty.geocities.jp/chirinuruwowahe/TxtTxtAddName.zip よろしくお願いします。
エクセル マクロについての質問です。 下記のコードでセルに画像を合わせて貼り付け、表を作成しています。 が、このコードだと画像の保存先を移動させると画像が表示されなくなり、分類でフィルターをかけるとバラバラの違う画像が表示されてしまったりして困っています・・・。 どなたか良いご意見を頂ければと思い、投稿しました。よろしくお願いします！ Sub PictFit() Dim PicFile As String Dim Pic As Picture PicFile = Application.GetOpenFilename() '画像のパスを取得 If PicFile = "False" Then Exit Sub Set Pic = ActiveSheet.Pictures.Insert(PicFile) '画像を貼り付ける With Pic .Height = ActiveCell.MergeArea.Height '画像の高さ .Top = ActiveCell.Top '画像の上位置を変更 .Left = ActiveCell.Left + (ActiveCell.MergeArea.Width - .Width) / 2 '画像の横位置を変更(セル幅中央に画像中央) End With End Sub
フォルダに入っている同じFMTファイルから同じシート名のファイルの9行目からデータが入力されてる行までをコピーして別ファイルの指定シートにペーストしたいです。 50シートくらいありデータを下につなげていきたいのですが、どうしたらよいでしょうか？ よろしくお願い致します。
PDFを管理するようなテーブルを作っています。 現在，レコード１件ごとにPDFのリンク（HDD上のパス）を対応させて登録し，フォーム上でクリックすると開くようになっています。 ここに，PDFの指定のページが開く機能を追加したいです。指定のページの値は，レコード内に登録されています。 暫定的に， Shell "CMD /C START Acrobat.exe /A page=3 C:\～～～～.pdf" というコードで試したところ，狙ったPDFの３ページが開きました。 そこで，page=の後ろの値をレコード内から取得するために変数を使いたいと思い， さしあたり Dim x As Integer x = 3 Shell "CMD /C START Acrobat.exe /A page=x C:\～～～～.pdf" としてみたところ， ３ページではなく，１ページが開いてしまいました。 ついでに， Dim x As Integer Dim y As String x = 3 y = "page=" & x Shell "CMD /C START Acrobat.exe /A y C:\～～～～.pdf" というのも一応試しましたが，やはりだめでした。 たぶん，変数の使い方がまずいのかと思うのですが， どうしたらよいのでしょうか。 教えていただけると助かります。
Excelで複数の文字列を一気に置換するvbaを教えていただけないでしょうか。 Book2の置換リストをBook1のSheet1に完全一致で置換したいのです。 Book1.xlsx：元ファイル Book2.xlsx：置換リスト ※下記のような配列 A列　B列 １　01_1 ２　02_2 ３　03_3 ４　04_4 以上です。 よろしくお願いいたします。
アクセスで困っています。 フォーム上にテキストボックスを設置し， そのテキストを検索ワードとしてレコードを抽出しようとしています。 レコードソースに入力する方式です。 以下のコードはきちんと動作しました。 Dim KENword As String KENword = [Forms]![Fその１]![検索ボックス] Me.RecordSource = "select * FROM テーブル WHERE (名前 like '*" & KENword & "*') or (所属 like '*" & KENword & "*')" さらに，likeの後ろを丸ごと変数にしたいと思い，次のように書きました。 Dim KENword As String Dim KENlike As String KENword = [Forms]![Fその１]![検索ボックス] KENlike = "'*" & KENword & "*'" Me.RecordSource = "select * FROM テーブル WHERE (名前 like KENlike) or (所属 like KENlike)" しかしこうすると， パラメーターの入力　KENlike の画面が出てしまいます。 msgboxなども使って試したのですが， どこが間違っているか分からず困っています。 どう直せばよいのでしょうか。 教えていただけると助かります。
初めまして。 私はExcelの初心者で、Excel2010を使っています。 名簿の整理をするにあたって 黒字は男性、赤字は女性にし、それぞれの人数を 色で識別しカウントするやり方をVBAで行いました。 Function COUNTCOLOR(data As Range, color As Integer) Application.Volatile Count = 0 For Each C In data If C.Font.ColorIndex = color Then Count = Count + 1 End If Next C COUNTCOLOR = Count End Function 上記のもの(他サイトから引用)を入力し、上手く作動したのですが 名簿の名前をDelし再計算後、カウント数が減りません。 手作業で一つ一つセル内の文字色を 白にするとカウント数が減ります。 しかし条件付きの書式でセルが""の時に文字色が白になる式を 設定してもカウント数は減りませんでした。 どのようにしたら空白の時にカウントさせないよう出来ますか。 よろしくお願いします。
ソリューションエクスプローラが表示できなくて困ってます くまなく調べたけどツールにオプションは無くてインターネットオプションという 項目ならあります そこにプロジェクト及びソリューションの項目がありません どうやれば表示させられるのでしょうか？
シートのＡ列に商品コードが入っており、別ブックのＡ列に商品コード、Ｂ列に商品名が入っています。 現シートのＡ列を一行ずつ読んで、その商品コードをキーに別ブックの商品コードを検索し一致するコードがあれば現シートのＢ列に別ブックの商品名をセットする、という作業を勉強がてらado接続を使って実行したいと思い、下記のコードで実行してみました。 Dim CN As ADODB.Connection Dim RS As ADODB.Recordset Set CN = New ADODB.Connection CN.Provider = "Microsoft.Jet.OLEDB.4.0" CN.Properties("Extended Properties") = "Excel 8.0" CN.Open "C:\Users\*****\Desktop\shohinmaster.xls" For i = 2 To 最終行 Set RS = New ADODB.Recordset RS.Open "SELECT * FROM [shohin$] WHERE 商品コード = '" & Cells(i, 1) & "' ", CN If RS.EOF Then Cells(i, 2) = "???" Else Cells(i, 2) = 商品名 End If Next これで実行しますと、現シートの商品名は空白という結果になります。？？？とすらセットされませんでした。 また RS.Open の行の '" & Cells(i, 1) & "' という箇所なのですが、現シートの商品コードは数値で 入っているのですが、別シートの商品コードは文字列としてセットされていますのでこの形式にしております。 EXCELは2016、OSはWINDOWS7です。 どこが誤っているのかアドバイスいただければ幸いです。宜しくお願い致します。
添付図のA列で丸印でチェックした右B列の項目を別セルD２より順に反映したいのですがどなたかVBAコードの解る方宜しくお願いします。
WinServer2008(32bit)でteratermマクロを起動しています。 マクロファイルの内容(ファイル名：MACRO.TTL) 1>>filedelete 'NM_00.LOG' 2>>connect 'xxx.xxx.xxx.xxx:22 /ssh /2 /auth=password /user=xxxx /passwd=xxxx /timeout=20' 3>>if result<>2 goto timout_connect 4>>filedelete 'NM_01.LOG' ・・・中略・・・ 97>>timout_connect 98>>filedelete 'NM_99.LOG' 99>>end BATファイルの内容(ファイル名：MACRO_RUN.BAT) ttpmacro.exe MACRO.TTL BATファイルはteratermがインストールされた 「ttpmacro.exe」が存在するフォルダにあります。 上記BATファイルをWinServer2008(32bit)で動作をさせると 問題なくマクロの処理が実行されます。 この処理を端末を問わず行いたいとの要望があり webシステムを作りました。(silverlight5＋VS2010C#) 実際の動作は下記の様なイメージです。 ・操作端末(Win7)⇒⇒⇒WinServer2008(32bit)⇒⇒⇒Teraterm接続先 ココでBATファイルを起動する事は出来たのですが 2>>の[connect]コマンドが無応答となってしまっています。 'NM_00.LOG'←消えている 'NM_01.LOG'←残っている 'NM_99.LOG'←残っている タスクマネージャーには ttpmacro.exe、ttermpro.exe、cmd.exeが残っています。 IIS(Ver7)、teraterm(Ver4.90)での設定等何か必要な事があるのでしょうか 宜しくお願いします。
VBAコードを用い画像のようにA列で重複する文字は無視し違う文字のみ順に別セルに表示したいのですがどなたか解る方宜しくお願いします。
WIndows7 32bit 　で ＩＯデータ社のテレビチューナーボードを使用しています。 １週間くらい前から、録画再生と同時にIE11を使うと、Visual C++ Rntome Error　が発生します。 チューナー：GV-MVP/XS3 詳細情報： CorelSDK Version,2.3.0.36 I-O DATA GV-MVP/XS,1.8.3.38 ManagerFileVersion,7, 0, 14, 8411 ManagerPublicName,mAgicマネージャ ManagerPublicVersion,7, 0, 14, 8411 ProductPublicName,I-O DATA mAgicTV GT ProductPublicVersion,7.10.10 gvmvpxs.dll,7, 10, 5, 9117 gvmvpxsw.dll,7, 10, 5, 9117 gvmvpxz.dll,7, 10, 5, 9117 テレビチューナーは最新Verです。 Visual C++ がたくさんインストールされていますが、ここに原因があるのでしょうか？ Silverligetはインストールしていません。 よろしくお願いします。
重複した値を一つだけ残していきたいです。 たとえば　リンゴ　リンゴ　リンゴ　とあれば２つリンゴが消えて欲しいです 今のところ重複した値を消す方法しかわからず詰まっています。 なにとぞよろしくおねがいします　 Option Explicit Sub test() Dim i As Double Dim x As Double Application.Calculation = xlCalculationManual Application.ScreenUpdating = False Range("T3", Range("T" & Rows.Count).End(xlUp)).Sort Key1:=Range("T3"), Order1:=xlAscending, Header:=xlYes For i = 3 To Cells(Rows.Count, 20).End(xlUp).Row Range(Cells(i, "T"), Cells(i, "T")).RemoveDuplicates Columns:=Array(1), Header:=xlYes Application.Calculate Next End Sub
失礼します。昇順がうまくいかず困っています。 本来T3から下を昇順で並び変えたのち重複した値を削除したいのですがうまくいきません もしよろしければダメな点を教えていただけないでしょうか？よろしくおねがいします。 Option Explicit Sub test() Dim i As Double Dim x As Double For i = 3 To Cells(Rows.Count, 20).End(xlUp).Row Range(Cells(i, "T"), Cells(i, "T")).Sort Key1:=Range("T2"), Order1:=xlAscending, Header:=xlYes Range(Cells(i, "T"), Cells(i, "T")).RemoveDuplicates Columns:=Array(1), Header:=xlYes Next End Sub
失礼します現在重複があればX行の隣に印を付けるというコードを書いているのですがデータ量が8万列あり、自身で下記のコードを実行すると応答なしとなってしまいます。 どう記述すれば機能するのでしょうか？よろしくお願いします。 Sub Sample2() Dim c As Range With Range("X1", Range("X" & Rows.count).End(xlUp)) .Offset(, 1).ClearContents For Each c In .Cells If WorksheetFunction.CountIf(.Cells, c) > 1 Then c.Offset(, 1) = "●" Next End With End Sub
選択したセルの列と行にたいしてIFで印を付けていきたいです 引数を選択したセルにしたいのですが下の記述では""の部分に変数を入れてもエラーが出ます 正確な記述方法をご教授いただけると助かります。 また、セルの位置と値の扱い方がいまいちわかってないです。 ご説明をいただけると嬉しいです。 Sub 重複確認() ' 変数宣言 Dim x As Long Dim y As Long x = ActiveCell.Row y = ActiveCell.Column With Range("", Range("" & Rows.count).End(xlUp)) .Offset(, 1).Formula = "=IF(COUNTIF(" & .Address & ",A1)>1,""●"","""")" .Offset(, 1).Value = .Offset(, 1).Value End With End Sub
いつも楽しく勉強させていただいております。 環境はWindows Server 2008R2 DataCenter、データベースはOracle10G、開発ツールはVB.NET2015です。 VB.NET2015からOracleのストアドを起動するのにODPを使用しています。 処理時間が短いものについては問題なく動いているのですが、重たい処理をすると 「context switch deadlockが発生しました」のエラーが発生します（画像参照）。 ここは規定以上のTimeoutを設定するべきと考えて、下記のコードを書いてみました。 Dim myCon As New OracleConnection() myCon.ConnectionString = "User Id=scot;Password=tiger;Data Source=orcl10;Connection Timeout=600" myCon.Open() ところが実行するとConnectionStringのプロパティを設定しているところで次のようなエラーが発生します。 キーワードはサポートされていません : 'Connection Timeout' ネットで見たサンプルコードをコピペしたのでキーワードが間違っているとは思えません。 System.Data.OracleClientの他に参照設定の追加などが必要なのでしょうか。 http://nanaganbaru.blog.fc2.com/blog-entry-273.html また、上記のHPで同じ現象に悩む人（ただしC#）の記事を読んで デバッグ⇒例外で例外のダイアログボックスを開き・・・とあるのを [デバッグ]-[オプション]のダイアログボックスで[デバッグ]-[オプション]の 「経過時間のPerfTipを表示する」のチェックをはずしてみたところ重たい処理を終えることができました。 これで結果オーライとするにはモヤモヤします。 疑問は下の三つです。 １．私のODPのタイムアウトの設定はどこが間違っていますか。 ２．[デバッグ]-[オプション]のダイアログボックスで設定する方法はこれで正しいでしょうか。 ３．１（正しくできたとして）と２とどちらの方法がよいでしょうか。 タイムアウトの秒数を明示的に指定したいのでできれば１の方法を使いたいのですが。
VBAでA列最終行を取得しB列にその行の値を貼付けることができますか宜しくお願いします。
セルに入力されている値を取得する方法といいますか理解が今だ出来ません エクセルの上記に入っている値＊画像添付とセルに入力されている値が違う場合 セルに入力している値を取得したいのです、説明がわかりにくいかもしれませんので、情報が足らない際はおしゃってください、よろしくお願いします。 下記のコードでは画像に入っている値を取り出します。 Sub test() Dim ret As Range Dim piyo As Variant Application.ScreenUpdating = False Set ret = Range("M:M").Find(Application.Max(Range("M:M"))) piyo = ret.Offset(0, -1).Value MsgBox piyo END Sub
Windows8.1　エクセル2010です。 マクロを使っており、小数点の計算をしたいため、初めてsingle double の変数を使いました。 例として、 Sub シングル() Dim 足される As Single Dim 足す As Single Dim 合計 As Single 足される = Range("a1").Value 足す = Range("b1").Value 合計 = 足される + 足す Range("c1").Select ActiveCell.FormulaR1C1 = 合計 End Sub A1＝2.1　B1＝5.1　普通は7.2となるのですが、7.19999980926513　と出ました。 doubleに変数を切り替えたら、ちゃんと7.2と出ました。 singleの仕組みがよくわかりません。 有効桁数数は「７桁」なら、小数点第7位まで扱える…という単純なものではないのでしょうか？
いつも楽しく勉強させていただいております。 環境はWindows Server 2008R2 DataCenter、データベースはOracle10G、開発ツールはVB.NET2015です。 このたびWindows Server 2003のVB6.0から上記の環境に乗せ換えているところです（Oracleのバージョンは変わりなし）。 最初にVB6.0からVB.NETへの変換はかけましたが、 なるべくVBのソースは変更しないという制約があります（テストのし直しが膨大になるので）。 VBとOracleはADOを使って接続しています。 ADOを使ってテーブルの読み書きはできるのですが、ストアドプロシージャの起動がうまくいきません。 具体的には入力パラメータはストアドに渡って処理も動くのですが、出力パラメータが返ってきません。 ストアドが正しく動くことはObjectBrowserで確認済みです。 下記のソースはVB6.0で動いていたものですが、VB.NET2015では二つの出力パラメータの値がNothingとなります。 （本来ならステータスとメッセージが返ります）。 VB.NET2015でADOでストアドを使うことは無理なのでしょうか。 Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load Dim Cnn As New ADODB.Connection Dim cmd As New ADODB.Command Dim Prm As New ADODB.Parameter Dim strMsg As String On Error GoTo Err_cmdExec_Click With Cnn .Provider = "MSDASQL" .ConnectionString = "DSN=DB1;" & "UID=abc;" & "PWD=efg" .Open() End With 'ストアドプロシージャ呼び出し設定＆呼び出し With cmd .CommandTimeout = 0 'タイムアウト設定を無制限に .ActiveConnection = Cnn 'サーバー接続設定 .CommandText = "CHECK_PROC" 'ストアド名セット .CommandType = ADODB.CommandTypeEnum.adCmdStoredProc 'ストアドなのでadCmdStoredProc Prm = .CreateParameter("p_yyyymm", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamInput, 6, "201601") cmd.Parameters.Append(Prm) Prm = .CreateParameter("p_sts", ADODB.DataTypeEnum.adChar, ADODB.ParameterDirectionEnum.adParamOutput, 1) cmd.Parameters.Append(Prm) Prm = .CreateParameter("p_msg", ADODB.DataTypeEnum.adVarChar, ADODB.ParameterDirectionEnum.adParamOutput, 512) cmd.Parameters.Append(Prm) '実行 .Execute() '戻り値の判断＆表示用メッセージ生成 If .Parameters.Item("p_sts").Value = "0" Then strMsg = "正常終了しました" Else strMsg = "異常終了しました" & vbCrLf & "ErrMsg=" & .Parameters.Item("p_msg").Value End If End With Exit_cmdExec_Click: '接続解除 Cnn.Close() 'Set Cnn = Nothing 'メッセージ表示 MsgBox(strMsg) Exit Sub Err_cmdExec_Click: 'ストアド以外の場所でのエラーなので、VBのErrの情報セット strMsg = "異常終了しました" & vbCrLf & "ErrNO=" & Err.Number & " ErrMsg=" & Err.Description Resume Exit_cmdExec_Click End Sub
よろしくお願いします。 Excel2003　VBAで異なるシート間でセルのコピーをしています。 ある条件の時だけコピー先のセルに値を足し込みたいのですがうまくいきません。 以下、１部抜き出しで申し訳ありませんが問題のコードを記載します。 各配列にはコピー元シートのセル列数（C_Arr）とコピー先シートのセル行数（B_Arr）・列数（A_Arr）を指定してあります。 For y = 1 To UBound(B_Arr) For x = 1 To UBound(A_Arr) If A_Arr(x) = 22 Then Worksheets("A").Range(Cells(y + 2, C_Arr(x - 1)), Cells(y + 2, C_Arr(x - 1) + 1)).Copy Worksheets("B").Cells(B_Arr(y - 1), A_Arr(x - 1)).PasteSpecial Paste:=xlValues, Operation:=xlAdd Application.CutCopyMode = False Else Worksheets("A").Range(Cells(y + 2, C_Arr(x - 1)), Cells(y + 2, C_Arr(x - 1) + 1)).Copy _ Destination:=Worksheets("B").Cells(B_Arr(y - 1), A_Arr(x - 1)) End If Next x Next y コードを実行するとエラーにはならないのですが、値が足し込まれず最後のコピー値が上書きされる 結果となります。 うまくいく方法を教えて下さい。
Excelを起動したときに、「NumLock」キーがOFFにならないようにしてONのままで、IMEが日本語入力ONで起動できるようにしたいのです。 Excel2010では、起動したとき、下記の3行マクロで「NumLock」キーがOFFにならずにONのままで、IMEを日本語入力ONで起動できておりました。。 Sub Auto_Open() SendKeys ("{kanji}") End Sub しかし、Excel2013では、IMEは日本語入力ONになるにはなるのですが、SendKeysの影響で「NumLock」キーがOFFになってしまいます。 「NumLock」キーをONにするために、Call numLockOnを挿入して、 Sub Auto_Open() SendKeys ("{kanji}") Call numLockOn End Sub としましたが、「NumLock」キーがOFFになってしまいます。 「NumLock」キーをONにしたいのですが、記述の何が足らないかお教えいただけませんか。 よろしく、お願いします。
MySQLから取り込んでフォームに表示させるには。 (ExcelVBA) MySQLデータベースからデータを取り込んで Excelブックのユーザーフォーム1のコンボボックス1に表示させる。 ゴールはこれなんですが。 まずはよさそうな下記サイトを参考にしようとしましたが、 コードの意味がさっぱりわからず どこをどういじればいいのか困っています。 他を探しても初心者向けではなく、似たようなものばかりです・・ http://www.cocoaliz.com/excelVBA/index.php/40/ どのようにすればいいでしょうか。
初歩的なことですが、マクロ初心者なので 教えて下さい。 A,1に分類、B,1に商品名、C,1にH店の売上個数、D,1にK店の売上個数が入っている時、 sheet1のB列の抜き出したいセルをマウスでドラッグすると、そこの行がコピーされ、sheet2にその行がペーストされる仕組みのマクロを作りたいのですが、どうすればいいのでしょうか(´・_・`) 例えば、マクロボタンを押して、mainを選択したら、"商品を選択してください"といったinputboxが出てきて、B4:B8を選択したら、4行目から8行目までが、sheet2の2行目から6行目にコピーされているようにしたいということです。 詳しい方、教えて下さい！
マクロ(VBA2007)で、作業中の1つのシートにある、複数のピボットテーブルのレポートフィルターを一括で選択しようとしております。以下のマクロでは”ピボットテーブル１”と名前のついたピボットしか操作できませんでした。複数のピボットを一括で選択する方法を教えていただけますか？(メーカー名がA、B、Cとあるフィルターです） ******************* Sub try() 　　Dim pf As PivotField 　　Dim p　As PivotItem 　　Set pf = ActiveSheet.PivotTables("ピボットテーブル1").PivotFields("メーカー") 　　pf.Orientation = xlPageField 　　pf.ClearAllFilters 　　For Each p In pf.PivotItems 　　　　Select Case p.Value 　　　　Case "A", "C" '表示アイテム名をカンマ区切りで指定 　　　　Case Else 　　　　　　p.Visible = False 　　　　End Select 　　Next End Sub *********************** よろしくお願いいたします。
Private Sub CommandButton31_Click() ListBox12.ColumnCount = 5 ListBox12.ColumnWidths = "4.0cm;4.0cm;2.0cm;3.0cm;2.0cm" End Sub Private Sub TextBox175_Change() SetList End Sub Private Sub TextBox176_Change() SetList End Sub Private Sub TextBox177_Change() SetList End Sub Private Sub TextBox178_Change() SetList End Sub Private Sub TextBox179_Change() SetList End Sub Private Sub SetList() ListBox12.Clear ListBox12.AddItem TextBox175.Text ListBox12.List(0, 1) = TextBox176.Text ListBox12.List(0, 2) = TextBox177.Text ListBox12.List(0, 3) = TextBox178.Text ListBox12.List(0, 4) = TextBox179.Text End Sub ここで、TextBox175~179の値をコマンドボタン1を押す度、 ListBox12の最終行の直下に挿入されていくようにしたいです。 列はそのままです。 1行目 (0,1),(0,2),(0,3),(0,4) 2行目 (1,1),(1,2),(1,3),(1,4) 3行目 (2,1),(2,2),(2,3),(2,4) どのようにやればいいでしょうか。
お世話になります。 EXCEL VBAを使って下記のことを実現したいです。 [やりたいこと] [データ]シートに社員情報が4人分入っています。(本当は可変です) [データ]シートに"集計"というボタンを作ってクリックするとVBAが動いて[集計]という シートにデータを集計したいのです。この[集計]シートのフォームが少し変わっていて一人に つき3行使用します。次の人はまた3行、また次の人は3行と繰り返していきたいのです。 上記やりたい事を画像にもしてみました。 上記動作を実現するVBAコードをどなたかご教授いただけませんでしょうか？ 何卒よろしくお願い致します。 環境 EXCEL 2017 Win7
Sheet1のA1セルからE1セルまで「品名」、「単価」、「単位」、「在庫数量」、「備考欄」が記入されております。10000品目の在庫管理に使用しております。 Sheet2においてinputboxを使用し品名を入れるとSheet1のA1セルを起点とした表のA列「品名」から部分一致で検索し、検索結果のA列からE列までのデータをSheet3に表示するという構文を教えていただけると幸いです。 宜しくお願い致します。
エクセルで次のような表のデータが１ヶ月分、31日分あり ます。すなわち31枚のシートに同じ表で中の○× の内容が違うデータがあります。〇×は単純に「まる」「ばつ」と入力して変換したものです。 　 ア イ ウ エ オ (1) 〇 × × 〇 〇 (2) 〇 × 〇 〇 × (3) × 〇 〇 〇 × (4) 〇 〇 × × 〇 そして〇をゼロ、×を1と数えて、 31枚のシートの〇と×を集計して他のブックの 同じ表に集計の結果を示したい のです。 例えばこんな感じで他のブックのシート の同一の表に計算結果を表示したいです。 ア イ ウ エ オ (1) ７ ４ ５ ０ ０ (2) ８ ５ ０ ２ ２ (3) １ １ ０ １ ０ (4) ０ ０ ４ ６ ８ 31枚のシートの〇と×を数値に 変換し、それを串刺し集計した いのです。 countifは串刺し集計 で使えないので 次のようなユーザ定義関数を教えて戴き、同じブックの３２枚目のシートの同じ表に 集計が可能となり誠に教えて戴いた方には感謝する次第では御座いますが、 他のブックの同一の表に集計するには、ユーザ定義関数の記述をどのようにすれば よろしいでしょうか。宜しくお願い致します。 Public Function CountIfAcross(シート区間先頭セル As Range, シート区間後尾セル As Range, 検索条件 As String) Dim sRef As String, sRefE As String, c As Range, cnt As Long, i As Long 　　sRef = シート区間先頭セル.Address(0, 0) 　　sRefE = シート区間後尾セル.Address(0, 0) 　　If sRefE <> sRef Then sRef = sRef & ":" & sRefE 　　For i = シート区間先頭セル.Worksheet.Index To シート区間後尾セル.Worksheet.Index 　　　　For Each c In Sheets(i).Range(sRef) 　　　　　　If c.Text Like 検索条件 Then cnt = cnt + 1 　　　　Next 　　Next i 　　CountIfAcross = cnt End Function 普通のExcel関数のように、 =CountIfAcross(Sheet1!B2,Sheet31!B2,"×") =CountIfAcross('#1'!B2,'#31'!B2,"×") 等の様に シート区間先頭セル、シート区間後尾セル、検索条件 を指定してカウントした数を返します。
お世話になっております。 ＡｃｃｅｓｓＶＢＡの初心者です。 subプロシージャのボタンクリックイベントから共通モジュール（Public）の動作を呼び、変数の加減乗除の計算をさせたいです。 共通モジュールの中をif文にする時、if「（subプロシージャの）ボタンが押された」時という記述はどのようにすれば良いでしょうか。 よろしくお願いします。
エクセルでマクロを組み始めたばかりの者です。下記のようなマクロを組んでみましたが、27行目もしくは41行目のActiveSheet.Pasteで「実行時エラー‘1004‘： 変更しようとしているセルまたはグラフは保護されているため読み取り専用となっています…」というエラーメッセージが出て止まってしまいます。 しようとしている内容は、転送ボタンを押し各シートの指定セルへ一括転送（コピー）をしたいのです。 その際、転送先はシート保護をしておきたいのです。 エラーはエクセル2010で確認しましたが、職場のＰＣを使用するため2007や2003等他のバージョンを利用する可能性もあります。また、仕事で使用するため早急に使わなければならず焦っています。 Option Explicit Private Sub CommandButton2_Click() Call Macro2 End Sub Sub Macro2() Workbook.Open Filename:=”K:¥共有¥○○○.xlsm” ActiveSheet.Unprotect ThisWorkbook.Activate Range(”D4:G20”).Select Selection.Copy Windows(”○○○.xlsm”).Activate Range(”E7”).Select ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode = False Workbook.Open Filename:=”C:¥Users¥Desktop¥×××.xlsm” ActiveSheet.Unprotect ThisWorkbook.Activate Range(”D4:G20”).Select Selection.Copy Windows(”×××.xlsm”).Activate Sheet(”△△△”).Select Range(”AF18:AI34”).Select ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode = False Workbook.Open Filename:=”K:¥共有¥□□□.xlsm” ActiveSheet.Unprotect ThisWorkbook.Activate Range(”D4:G20”).Select Selection.Copy Windows(”□□□.xlsm”).Activate Sheet(”▽▽▽”).Select Range(”AF18:AI34”).Select ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode = False MsgBox " 『○○○』と" & vbCrLf & "『×××』と" & vbCrLf & "『□□□』の" & vbCrLf & "規格を変更しました。" End Sub どの様に修正すれば良いのでしょうか？ マクロが原因でしょうか？または他の原因があるのでしょうか？ マクロ初心者のため、修正方法など具体的な詳細をお教えいただけないでしょうか。 お手数をおかけして申し訳ございませんが、よろしくお願いします。
お世話になっております。 ただいま、アクセスＶＢＡにてＤｏ…Ｌｏｏｐの練習をしております。 テキストボックス１に数字を入れ、コマンドボタンを押すと入力した数字が１ずつ引かれる形でテキストボックス２に入るようにしたいです。 （テキストボックス１に「８」→テキストボックス２に「８７６５４３２１」のように） Dim I As Variant I = Me.text1.Value Me.text2.Value = Me.text1.Value Do Until I = 1 I = I - 1 Me.text2.Value = Me.txt2.Value & I Loop で動作そのものはするのですが、doloop前の「Me.text2.Value = Me.text1.Value」を正さないといけないようです。（課題です） これがないと入力された数字そのものが入らなくなってしまうのですが… よろしくおねがいします。
http://officetanaka.net/excel/vba/vbe/05.htm を参考に VBAコードを取得したいのですが Declare Function GetTickCount Lib "kernel32" () As Long Public sampledata As String Sub Sample9() Dim Code As String Code = ThisWorkbook.VBProject.VBComponents("Module1").CodeModule.Lines(7, 5) MsgBox Code End Sub を実行すると 実行時エラー　2001 'VBProject'メソッドは失敗しました：'_Workbook'オブジェクト が、 Code = ThisWorkbook.～ の行で発生します。 何が間違ってますか？
エクセルのマクロに関する質問です。 今開いてるブックの『Aシート』に転送ボタンを作成します。これとは別に『Bシート』を作り、『Aシート』の2列目からAA列目までと、『Bシート』の2列目からW列目までのデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内の『マクロ』というブック、『1シート』ならびに『2シート』の名前のシートにセルB9～,C9～,D9～…といったように毎日転送(コピー)しようと思います。 イメージとしては以下の通りです。 【5/3】 『Aシート』 日付　　名前　　 時刻　　データ　　　… 5/1 　　田中　　7：30　　534986 5/2　　 太田　　13：00　 691324 5/3 鈴木　　14：00 143985 ↓[転送ボタン] 『1シート』 日付　　名前　　 時刻　　データ　　　… 5/1 　　田中　　7：30　　534986 5/2　　 太田　　13：00　 691324 5/3 鈴木　　14：00 143985 【翌日5/4】 『Aシート』 日付　　名前　　 時刻　　データ　　　… 5/1 　　田中　　7：30　　534986 5/2　　 太田　　13：00　 691324 5/3 鈴木　　14：00 143985 5/4　　 佐藤 8：30　　068912 ↓[転送ボタン] 『1シート』 日付　　名前　　 時刻　　データ　　　… 5/1 　　田中　　7：30　　534986 5/2　　 太田　　13：00　 691324 5/3 鈴木　　14：00 143985 5/4　　 佐藤 8：30　　068912 5/5以降も下の行に毎日『Aシート』『Bシート』に入力したデータを『1シート』『2シート』に転送(コピー)し保存します。 その際、転送先はシート保護をしておきたいのです。 Sub Macro1() Dim GYOU As Long Dim 様式1 As Worksheet, 様式2 As Worksheet Dim 様式A As Worksheet, 様式B As Worksheet With ThisWorkbook Set 様式A = .Worksheets("様式A") Set 様式B = .Worksheets("様式B") End With With Workbook.Open(Filename:="C:\共有\マクロ.xlsx") Set 様式1 = .Worksheets("様式1") Set 様式2 = .Worksheets("様式2") 様式1.Unprotect 様式2.Unprotect 様式A.Unprotect 様式B.Unprotect 様式A.Range("B16:AA2000").Copy 様式1.Range("B" & Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues 様式B.Range("B16:W2000").Copy 様式2.Range("B" & Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues Application.CutCopyMode = False 様式1.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True 様式2.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True 様式A.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True 様式B.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True .Close SaveChanges:=True End With MsgBox "『マクロブック』へ" & vbCrLf & "データ転送しました。" End Sub この様なマクロを組んでみましたが、転送ボタンを押した際転送先の『様式1』『様式2』シート共に保護がかかったままデータがされるものの最初のデータ（5/1）から当日分（5/4）全てが張り付けられてしまいます。 【翌日5/4】 翌日5/4】 『Aシート』 日付　　名前　　 時刻　　データ　　　… 5/1 　　田中　　7：30　　534986 5/2　　 太田　　13：00　 691324 5/3 鈴木　　14：00 143985 5/4　　 佐藤 8：30　　068912 ↓[転送ボタン] 『1シート』 日付　　名前　　 時刻　　データ　　　… 5/1 　　田中　　7：30　　534986 5/2　　 太田　　13：00　 691324 5/3 鈴木　　14：00 143985 5/1 　　田中　　7：30　　534986 5/2　　 太田　　13：00　 691324 5/3 鈴木　　14：00 143985 5/4　　 佐藤 8：30　　068912 ポイントとしましては以下の通りです。 (1)『様式A,B』のシートは『様式1,2』へそれぞれ転送。 (2)毎日データ転送し、『様式1,2』へは下の行へその都度入る。 (3)『様式A,B』及び『様式1,2』は入力箇所以外は保護が掛けられ、データ転送後も保護が掛けられた状態のまま保存。 (4)日付データは重複しない。 どの様に修正すれば良いのでしょうか？ よろしくお願いします。
アクセスでエクスポートする際に フィールド開始位置が有効ではないとなり テキストのアウト出来ない場合 下記の DoCmd.TransferText acExportDelim, , "ファイル名クエリ", "C:\Documents and Settings\Administrator\デスクトップ" & "\" & "ファイル名.csv", True End Sub のようにして対応しているのですが 1レコード目に 余計な フィールド1,フィールド2,フィールド3,フィールド4,フィールド5のようなレコードが 付いてしまうのですが インポートしたままの状態でエクスポート出来ないでしょうか。 ちなみにファイル数が多いのを想定して あとで１レコード目を削除する方法は考えておりません。 どうぞよろしくお願いします。
マクロ・VBA初心者です。 ご教授お願いします！！ 経費精算のExcelデータを画像のような「"",]で区切ったテキストファイルを作成するマクロを作りたいと考えてます。 完成イメージ：マクロのボタンを押すとテキストファイルの形でフォルダに作成される。もしくは、マクロボタンを押すとテキストファイルの形で区切ったものが表示されるものを作りたいです。 ＊経費精算データに関してA列からX列まであり、集計データにより列にデータを埋めていく作業が入っております。なので、A列からX1列まででデータが記入されている範囲で集計できるようにしたいと考えております。 現在は、勉強しつつ組み立てた結果、 CSVのExcelファイルをフォルダの中に作成できるようになりました。 （コードは下記に記載します） ただ、テキストファイルが作れるコードができていないのが問題です。 このコードをどのように変えればよいのか？ もしくは、別のコードで出来るようならば教えていただけると嬉しく思います。 宜しくお願いします。 ______________________________ 〈コード〉 Option Explicit Sub ExcelファイルCSV形式作成() '変数宣言 Dim filePath As String Dim i As Long Dim maxRow As Long Dim fileNo As Integer '初期値設定 filePath = ActiveWorkbook.Path & "\経費計算エクセル（CSV保存）.csv" maxRow = Range("A1").End(xlDown).Row '最終行取得 fileNo = FreeFile 'FreeFile関数で使用可能なファイル番号取得 'ファイル開く Open filePath For Output As #fileNo '最終行までループ For i = 1 To maxRow '列の数は決め打ち Write #fileNo, Cells(i, 1), Cells(i, 2), Cells(i, 3), Cells(i, 4), Cells(i, 5), Cells(i, 6); Cells(i, 7), Cells(i, 8), Cells(i, 9); Cells(i, 10), Cells(i, 11), Cells(i, 12); Cells(i, 13), Cells(i, 14), Cells(i, 15); Cells(i, 16), Cells(i, 17), Cells(i, 18); Cells(i, 19), Cells(i, 20), Cells(i, 21); Cells(i, 22), Cells(i, 23), Cells(i, 24) Next i 'ファイル閉じる Close #fileNo End Sub ＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿ 以上です。 本当に困ってます。よろしくお願します。
エクセルでマクロを組み始めたばかりのため、皆様にご教授頂ければと思います。 今開いているシートに転送ボタンを作成します。このシートのセルC4からC27までデータ(言葉や数値など)を、ボタンを押して、デスクトップ内の「マクロ」というブック、「記録用紙」名のシートにB列に横へ(B4,C4…)、毎日データ転送しようと思います(4行目,5行目…)。 その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub CommandButton1_Click() Call Macro1 End Sub Sub Macro1() Range(”C4:C27”).Select Selection.Copy Workbook.Open ”C:¥Users¥user¥Desktop¥マクロ.xlsm” Workbooks(”マクロ.xlsm”).Activate Sheets(”記録用紙”).Select Range(”B65536”).End(xlup).Offset(1).Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _:=False, Transpose:=True Windows(”マクロ.xlsm”).Activate End Sub この様なマクロを組んでみました。転送ボタンを押しても、「保護の為、読み取り専用」というエラーメッセージが出て途中で止まってしまいます。 どの様に修正すれば良いのでしょうか？お手数をおかけして申し訳ございませんが、よろしくお願いします。
Windows Script Hostは、スクリプト言語なのでしょうか？ Sub Sample() Dim WSH As Variant Set WSH = CreateObject("Wscript.Shell") Debug.Print WSH.SpecialFolders("Favorites") Set WSH = Nothing End Sub このようなコードでVBAでWSHを使っていますが WSHが何なのかわからないまま使っています。
【環境】 ・Windows7 Pro 32bit ・VS.net2010（VB.NET） ・Excel2013 ・.net Framework 4.0 お世話になります。 VB.NETを使用して、あるCSVファイルを読み込み、 その読み込んだ内容を既存Excelファイルに対して書き込みを行うプログラムを書いております。 書き込む際、Excelシート内の特定の１つの列をキー項目としておりまして、 CSVから読み込んだ値とExcel側のキー値を比較して該当した行の特定のセルに 値をセットするような処理を行っています。 １回１回セルを参照して値を取得し、CSVの値と比較するようなことは避けようと思い、 初めはFind関数を使用していました。 しかし、Find関数は処理が遅いという記事をネットで見てから Match関数を使うと良いという内容でしたので、 早速Match関数を使用しようと思い以下の様なコードを書いてみたのですが エラーとなってしまいます。 ※Lookup系の関数も同じエラーになります。 -エラーメッセージ- COMExceptionはハンドルされませんでした。 WorksheetFunction クラスの Match メソッドが失敗しました。 エラーコード：-2146827284 Dim ret As Integer = 0 Dim xlApp As Excel.Application Dim xlSheet As Excel.Sheet Dim xlFunc As Excel.WorksheetFunction = xlApp.WorksheetFunction Dim rTemp As Excel.Range rTemp = xlSheet.Range("A1:A10") ret = xlFunc.Match("12345", rTemp , 0) '←ここでエラー ※上記コードは一部を抜粋してきたものです。 ただ、Count関数やMax関数、Min関数などは問題なく使用出来ましたので xlFuncが機能していない訳ではなさそうです。 Matchの書き方に問題があるのでしょうか。 また、そもそも使用出来ないものなのでしょうか。 何かお分かりになる方、もしいらっしゃいましたらご教示の程お願い致します。
Inputbox で URL 文字列の一部を打ち込むと、IE オブジェクトがある場合には新規タブを作成し、当該サイトへアクセスするスクリプトを作っています。 後述がサンプルです。 スクリプトの最後にウィンドウをアクティブにするコードを入れているのですが、スクリプト自体はエラーなく完了するものの、IE ウィンドウをアクティブにすることができません。 Win10+IE11 を使っているのですが、何かコードが足りなかったりするのでしょうか。。。 それとも、Win10 + IE11 環境ではそもそも VBS で IE ウィンドウをアクティブにすることはできないのでしょうか。。。 アドバイスを下さると幸いです。 よろしくお願いいたします。 -------------------------------------------------------------------- Dim linknum dim objIE dim spurl linknum=Inputbox("リンク番号を入力してください。") spurl="https://xxxx" & linknum 'Shell.Applicationオブジェクトの作成 Set objShell = CreateObject("Shell.Application") 'IEウィンドウの個数をカウント lngCount = 0 For Each objWindow In objShell.Windows lngCount = lngCount + 1 Next With objShell.Windows 'IE オブジェクトがないときは、新しく作成する If lngCount = 0 Then .Item.Navigate2 spurl lngCount = lngCount + 1 objIE.FullScreen = True objIE.Visible = True 'IE オブジェクトがあるときは、タブを操作する（新しいタブを作成） Else .Item(lngCount - 1).Navigate2 spurl,&H800 IE ウィンドウをアクティブにする Set WshShell=Wscript.CreateObject("Wscript.Shell") WshShell.AppActivate "ページタイトル" WshShell.SendKeys "%( )" WshShell.SendKeys "R" End If End With -------------------------------------------------------------------------------
※ Waveinコントロールの著作権は、Kentaro HARA氏にあります。 　Windows7 Professional SP1，64bit上のVS2010のVB2010で、Waveinコントロールを用いたAppを開発し、VSのセットアッププロジェクトでインストーラーを作りました。ターゲットはx86です。 　開発機ではインストーラーが作成したexeは問題なく動くのですが、Windows7 Ultimate SP1，64bitのマシンにインストールしたexeが起動しません。というか、起動直後（ロード直後？）に停止するので、デバック情報も取れなくて困っています。 　デバック情報がないのでWaveinが原因ではないかも知れませんが、他に心当たりがありません。HARA氏のHPによれば、C++のランタイムが必要となっていますので、 　　VC++ 2010 再頒布可能パッケージ (x86) 　　VC++ 2010 再頒布可能パッケージ (x64) を順番に当ててみましたが、駄目でした。 　何か情報はないでしょうか？。
Sheet1のセルA1に"2016/5/1"のデータが有ります。 このデータをファイル名にして保存したいので、以下のVBAを作りました。 しかし、ファイル名が"2016/5/1"ではなく、"ym"になってしまいます。 どうしたらよいでしょうか？ Option Explicit Sub コピー保存() Dim ym As Long Sheets("Sheet1").Range("a1").Select ym = Range("z1") ThisWorkbook.SaveCopyAs _ Filename:="H:\" & "ym" & ".xlsm" End Sub
いつもお世話になっております。 マクロ勉強中の者です。 ２つの別ブックのシート（互いに任意）を同時に開いている前提での作業です。 (1)あるブックのシート（任意）は，シート保護が施されています。このシートのシート保護の解除をします。 (2)(1)で示したブックとは別のブックのシート（任意）に，次のようなマクロを設定してあり，指定した範囲のコピーを行います。 Sub コピー() コピー Macro Range("E6:AI73").Select Selection.copy End Sub (3)次に，(1)で示したブックのシート（任意）に次のようなマクロを設定してあり，先ほどコピーした内容を貼り付けます。 Sub 貼り付け() Range("E6").Select ActiveSheet.Paste 　ActiveSheet.Protect End Sub (4)(1)で示したシートには，(2)で行ったコピーの内容を貼り付け，シート保護された状態で作業が終わります。 この一連の作業の中で，(1)の作業を省けないかと考えています。つまり， 別ブックのシートを２枚開いている状態で， ◎あるブックのシートの内容をコピー（範囲指定あり） →◎別のブックのシートに，シート保護解除して(2)でコピーした内容を貼り付け，（セル指定あり）シート保護して終了 (3)で示したマクロに　ActiveSheet.Unprotect　を付け加えて実行してみたのですが，うまくいきません。エクセルの性格上，「貼り付け」の前にシート保護解除の動作が入ることで，コピーした内容が失われ？て貼り付けることができないのかな？と感じているのですが，どなたかご教授いただけると嬉しいです。 エクセルのバージョンは，２０１６になります。
access vba についての質問です。 フォームにテキストボックスが二つあるのに対して、 オプションボタンが三つあります。（グループです） テキストボックス１に文字列を入力し、コマンドボタンを押すと 選択されているオプションボタンのcaptionをテキストボックス１の文字列と合わせる形でテキストボックス２に反映させたいです。 コマンドボタンのクリックで以上の動きをするfunctionプロシージャを呼び出したいのですが、呼び出す側プロシージャと呼び出される側プロシージャの変数の設定がわかりません。 超初心者のため初歩的、かつ説明がわかりづらくて恐縮ですが、理解のため省略などをしない形でコードの見本等お教え願えませんでしょうか。 よろしくおねがいします。
仕事で月次報告をするのですが、報告書が Word のファイルであり、ファイル名のパターンが決まっているため、VBA でファイル名を生成し、VBA のコードで指定したパスにファイル保存させたいと考えています。 そこで、いろいろと調べて以下のコードを作ってみたのですが、保存する際に [実行時エラー 5152: ファイル名が正しくありません] と表示されます。 試しに以下のコードのうち、ファイルの保存先のパスと保存するファイル名を & でつなぎ Msgbox で表示したところ、ファイルの保存先とファイル名は意図したとおりに生成されています。 SaveAs メソッドに問題があるのではないかと考えていますが、ちょっとこれ以上は私では対処することができませんでした。 恐縮ですが、エラーを回避し、意図したパスに自動的にファイル名を生成して保存できるようにするためのコードを教えていただきたく思っています。よろしくお願いします。 以下は私が作成したサンプルです。 ------------------------------------------------- Sub 保存() 'レポート対象月の取得 dtDate = Format(Date, "yyyymm") '保存先フォルダーの指定 dtSaveFolder = "C:\Users\UserName\Documents\" & Year(Date) & "\" 'ファイル名の指定 dtSaveFileName = "XXXX" & dtDate & "YYYY.docx" '保存の実行 ThisDocument.SaveAs FileName:=dtSaveFolder & dtSaveFineName, FileFormat:=wdFormatDocument End Sub -------------------------------------------------
教えてください。 全てのシートをコピーして一つのシートにまとめるプログラムシートを作成しました。 1番目のシートからコピーを始める場合は For i = 2 To Worksheets.Count 2番目のシートからコピーを始める場合は For i = 3 To Worksheets.Count とすればよいのですがこれだといちいちモジュールコードを出して数字を変更しなければならず面倒です。 そこでユーザーフォームのコンボボックスに任意の数字を入れてクリックを押せば希望するシートからコピーを始めるプログラムを作成してみましたがうまくいきません。どなたか教えてくださいませんか。 Sub matome() Dim i As Integer Dim lRow As Long, lCol As Long, lRow2 As Long, lRow3 As Long, SNo As Integer '----何番目からコピーを始めるかを決定します With UserForm2 SNo = .ComboBox1.value End With For i = 1 + SNo To Worksheets.Count With Worksheets(i) lRow = .Cells(Rows.Count, 1).End(xlUp).Row + 1 lCol = .Cells(1, Columns.Count).End(xlToLeft).Column '----シートのデータが2行以上の場合にコピーします If lRow >= 2 Then lRow2 = Worksheets(1).Cells(Rows.Count, 1).End(xlUp).Row + 1 If lRow2 < Worksheets(1).Cells(Rows.Count, 5).End(xlUp).Row + 1 Then lRow2 = Worksheets(1).Cells(Rows.Count, 5).End(xlUp).Row + 1 .Activate .Range(Cells(2, 1), Cells(lRow, lCol)).Copy Worksheets(1).Cells(lRow2, 1) End If End With Next i
VB6.0またはVB.NETでGoogleスプレッドシートの特定ワークシートを CSV形式でダウンロードしたい web上で検索しても日本語で分かりやすく解説しているものがなく 困っています どなたか、ご教授お願い申し上げます
こんにちは。 Visual Studio 2008（Visual Basic) で開発をしています。（簡単なものです。） 今回、Oracle 11g 32bit のデータに接続したいのですが よくわかりません。 ネットなどを見ると、推奨はOracle社製のデータプロバイダーを利用するそうなのですが どのサイトのどのファイルをダウンロードして、インストールすればよいのかわかりません。 詳しい方、いらっしゃいましたら教えてください。 お願いいたします。 サーバー環境は Windows Server 2008 SP1 32bit Oracle Database 11g Release2 32bit クライアント環境は Windows 7 Pro 32bit Oracle Client 11g Release2 32bit Visual Studio 2008 Pro
　Visual Studio 2010でWMP（Windows Media Player）を使用するアプリを書いています。Windows7です。 　VS（Visual Studio）の提供してくれる相互運用ライブラリでCOM化し、MSDNでメソッドやプロパティーを調べてコードを書きました。 　WMP.URL＝"ファイル名"でwavファイルを与え、WMP.Controls.Play，WMP.Controls.Stopでwavファイルの再生を開始，停止し、WMP.Ctlcontrols.currentPositionで現在位置を取得などしているのですが、WMP.URL＝"ファイル名"で一度ファイルをWMPに関連付けると、Stopした後もファイルがWMPから解放されません。 　Stop後にファイルの一部を変更したいのですが、「別のプロセスが使用中でアクセスできません」が出ます。WMPに関連付けたファイルを解放する方法を教えて下さい。 　MSDNで調べてはみたのですが、機械語直訳のせいか、なかなか意味がわかりません。お願いします。返答はCでもかまいません。
行き詰っています。 よろしくお願いします。 下の構文では、 エラー：オブジェクトは、このプロパティまたはメソッドをサポートしていません と、表示されます。 ”コンボボックス1のデーターと重複しているセル（B2:B50)を探してその行の データーを上書きしたいのです” Private Sub CommandButton1_Click() Dim Mynumber As String Dim FoundCell As Range Sheets("ＡＡ").Range("B2:B50").Select Mynumber = ユーザーフォーム.コンボボックス1.Value Set FoundCell = Cells.Find(What:=Mynumber, After:=ActiveCell, _ LookIn:=xlFormulas, LookAt:=xlPart, _ SearchOrder:=xlByRows, _ SearchDirection:=xlNext, MatchCase:=False, _ MatchByte:=False) If FoundCell Is Nothing = False Then FoundCell.Select Sheets("ＡＡ").Offset(0, 0).Select = Me.コンボボックス1.Value Sheets("ＡＡ").Offset(0, 1).Select = Me.テキストボックス1.Value Sheets("ＡＡ").Offset(0, 2).Select = Me.テキストボックス2.Value Sheets("ＡＡ").Offset(0, 3).Select = Me.テキストボックス3.Value End If Exit Sub End Sub
エクセルのA列に以下の文字列が入っています。 A1 A2＝100-101 A3=102-103 A4=104-105 A5=106-107 A列の文字列を上から順に結合するため下記のVBAを実行しました。 結合の条件として、文字列の最後の数字と次のセルの最初の数字が連続しているならば、互いに消去して結合、そうでないなら「,」 (カンマ)でつなげて結合したいと思っています。 なので期待する結果としては A1=100----107 となってほしいのですが、実際は A1＝100--103,104-105,106-107 となってしまいました。 (ループ中の1回目の条件分岐だけが成功し、２回目以降は違っている) 「IF～Then」の部分が間違っているようなのですが・・・・・わかりません。 プロパティの使い方など全体的に至らぬ点があるかもしれませんがよろしくお願いします。 Dim i As Integer Dim X As String Dim mojisu As String i = 3 X = Cells(i, 1) mojisu = 3 Cells(1, 1) = Cells(2, 1) Do Until Cells(i, 1).Value = "" If Left(X, mojisu) - Right(Cells(1, 1), mojisu) = 1 Then Cells(1, 1).Value = Left(Cells(1, 1), Len(Cells(1, 1)) - mojisu) & Right(X, Len(X) - mojisu) Else Cells(1, 1).Value = Cells(1, 1).Value & "," & Cells(i, 1).Value End If i = i + 1 Loop
複数のブックの特定のシートを1つのブックにまとめたいのですが そのマクロは下記のように検索してでてきたのですが Sub test() Dim Fname As String Dim Wbm As Workbook Dim Wbs As Workbook Application.ScreenUpdating = False Set Wbs = ThisWorkbook Fname = Dir(ThisWorkbook.Path & "\*.xlsx*") Do While Fname <> "" If Fname <> ThisWorkbook.Name Then Workbooks.Open ThisWorkbook.Path & "\" & Fname Set Wbm = ActiveWorkbook Wbm.Worksheets("2016.03").Copy after:=Wbs.Worksheets(Wbs.Worksheets.Count) ActiveSheet.Name = Left(Fname, InStr(Fname, ".") - 1) Wbm.Close End If Fname = Dir() Loop Application.ScreenUpdating = True End Sub たとえば、特定のシートというのが毎回変わる場合今回は”2016.03"ですが 次回は”2016.04”という風に変わる時、どこかに入力したセルの値を元にシートを検索してくることなどは可能なのでしょうか？ よろしくお願い致します。
-質問内容-VBA作成2つ- ActiveCell.Offset(RowOffset:=[O1991], Columnoffset:=0).Activate アクティブセルを指定した段階で オフセット(縦下方向にO1991のセルに入れた数値分下に、ヨコに0) 移動しアクティブセルにする ------------------------------------------------------ ------------------------------------------------------ 別々のVBAでやりたいこと (1)これを、アクティブセルを指定した段階で セルの値をコピーして オフセット縦下にO1991.ヨコ0分下にペースト(貼り付け) したい 例)　　 　　A　　　 1　成功　　←アクティブセルをコピー　　 3　成功　　←　ActiveCell.Offset(RowOffset:=[O1991], Columnoffset:=0).Activate　 アクティブセル～オフセットしたセルまでを最初にアクティブセルからコピーし →アクティブセル～オフセットしたセルまでペーストする ----------------------------------------- (2)これを、アクティブセルを指定した段階で セルの値をコピーして オフセット縦下にO1991.ヨコ0分下に アクティブセル～オフセットされたセル位置まで フィルダウンさせたい 例)　　 　　A　　　 1　1　←アクティブセルをコピー　　 5　 ←オフセットセル 2つのVBAのやり方/プログラムの表記/組み合わせ方を 無知で愚かな私ですが どうかご教授のほど 宜しくお願い致します (>_<)謝↓ペコッ --------------------------------------- --------------------------------------- 変数を使うのでしょうか? セル範囲を指定するとして Range("ActiveCell:ActiveCell.Offset(RowOffset:=[O1991], Columnoffset:=0).Active") となるのでしょうか? 又変数の使い方として Dim a As Range 又は Dim a As Objectになるのでしょうか この際代入として使うには a = ActiveCell b = ActiveCell.Offset(RowOffset:=[O1991], Columnoffset:=0).Activate になるのでしょうか 本当に度々申し訳ないのですが 宜しくお願いします (:>_<:)ペコリ Range(ActiveCell).copy ActiveCell.Offset(RowOffset:=[O1991], Columnoffset:=0)ActiveCell.PasteSpecial End Sub
Desktop上のあるZIPファイル（例；zzz.zip）を別のフォルダ（例；DドライブのFolder1）にコピーして解凍する場合、下記のVBSで実行できると思いますが、これをDesktopの階層が異なる（後述の　xxxxx）不特定多数のPCで実施する場合、実行できない場合があります。 このためDesktopの階層が左右されないScriptにしたいのですが、模範Scriptを教えていただけないでしょうか。DesktopPathなどで対応すればできるのでは、と思いますが、なかなかうまくいきません。 使用PCのOSはWindows7（32ビット）です。 '------------------------------------------------------------- DIR_Source = "C:\xxxxx\Desktop\zzz.zip" DIR_Destination = "D:\Folder1" Const FOF_Silent = &H04 Const FOF_NoConfirmation = &H10 Set objShell = CreateObject("Shell.Application") Set FilesInZip = objShell.NameSpace(DIR_Source).items Set objFolder = objShell.NameSpace(DIR_Destination) If (Not objFolder Is Nothing) Then objFolder.CopyHere FilesInZip, FOF_NoConfirmation + FOF_Silent End If
Excelマクロの初心者です。 マクロの記録のやり方の質問です。 今あるフォルダの中にファイルA、Bがある状態でファイルAのマクロの記録で、ファイルBのコピーを同じフォルダーに作る操作を記録しようとしましたが、うまく記録できません。 何かやり方が間違っているのでしょうか、ファイルAの中でのセルの色塗り等のマクロの記録はうまくできます。 マクロの記録ができない操作があるのでしょうか、あるとすれば記録できないものはどのような操作でしょうか？教えて下さい。
vbを勉強するなら他の言語をやった方がいいのでしょうか？ 仕事ではなく趣味です。
Access2003を使用しています。 AccessVBAで、日報のようなExcelを操作しようとしています。 シート名は日付で、当日シートをコピーし、翌日シートにデータを流し込むというものです。 当日シートをコピーし、新たなシートを翌日にリネームするところまではできていますが、 元シート名（当日）に(2)が残ってしまいます。 ※必ず一つ前のシートをコピーするという条件でも可です。 ※コピー元のシートに(2)は既に存在する場合がありますが、必ず日付のみのシートが存在します。 元シート名を変えずにコピーする、または元シート名（一つ前のシート）をリネームする方法があればご教示いただきたいと思います。 --------------------------------------------------- Dim xlApp As Object Dim xlSheet As Object Dim stFileName As String Dim stSheetName1 As String Dim stSheetName11 As String Dim xlBook1 As Object stSheetName1 = DatePart("d", DateAdd("d", -1, [Forms]![日報]![対象日])) 　'今日 stSheetName11 = DatePart("d", [Forms]![日報]![対象日]) 　'対象日（明日） 'Excel展開 Set xlApp = Excel.Application Set xlBook = xlApp1.Workbooks.Open(Forms![日報作成フォーム]![日報1])　'ファイル名 'シートコピー Set xlSheet = xlBook.Worksheets(stSheetName1) xlSheet.Copy , xlBook.Worksheets(stSheetName1) 'シート名変更 xlSheet.Name = DatePart("d", [Forms]![日報]![対象日]) '対象日（明日） xlApp.Worksheets(stSheetName11).Select MsgBox "コピー完了" End Sub
EXCEL2007のvbaを使用してieを操作してます。 あるie画面を自動的に閉じる際、ie画面の「戻る」を自動クリックするとMsgboxが表示され「ok」「キャンセル」を要求されとまります。 自動的に「ok」を押して画面を閉じたいのですが・・・・・ どうすればよいのでしょうか？ ＜ieソース＞ <TD nowrap align="right" height="20" CLASS="NAVBAR" width="224"><INPUT type=image src="/Suite/AAA/BBB/CCC/Returnja_JP.gif" alt="戻る" name="btnReturn1" id="btnReturn1" height="15" onclick="javascript:returnConfirm();" border="0" haht-alt-type="NLS" width="34"></TD> </TR> ＜VBA＞ IE.Script.setTimeout "javascript:returnConfirm();" ,200 Sleep 5000 SendKeys "{ENTER}" msgboxは表示されたまま、「ENTER」が押されず次の処理に進む よろしくお願いいたします。
VBAのプロの方が、 初心者の方が作ったシステムのコードを見て、 「うわ。なんじゃこりゃ。こんなコードは絶対書いちゃだめだ！」 という経験があれば教えて下さい。
【現在の状況】 毎日仕事で、 60件ぐらい、書類を発送しています。 伝票番号を入力すると、配達状況が分かるホームページがあります。 伝票番号の数だけ、 IEから配達状況を取得して、 エクセルに落とすマクロを書き、実行してみました。 60件もあるからなのか、 終わるまで10分ぐらいかかります。 【マクロの構成】 For...Nextステートメントで、伝票番号をループします。 そして、伝票番号の数だけ、サイトにナビゲートします。 ie.navigate "xxx.com/xxxx/=123456789 【質問】 プロなら、このように数が多い場合、 どのようにアプローチするのでしょうか？ もっと早くなるアドバイスなど、もし思いついたことがあれば、教えて頂けると幸いです。 ありがとうございます・・・
仕事で、部下の営業マンたちに、 下記のメールを自動で送っています。 ******************************************** 【件名】　 ○○君　今週の成績 【内容】 ○○君へ、 調子はどうだ。 前の年、君はがんばったね。 ○○件、成約した。 今週は、何件、 成約したのかね？ ○○より ******************************************** そうしたら、 受信者から、 数字だけが、返信されてきます。 ５００ というふうに。 そして、LEFT関数で、その数字を取り組んでいます。 ’件名に○○君があったら、 If InStr(Mailitem.Subject, "○○君") > 0 Then ’4つめの文字を摘出 Range("A1") = Left(MailItem.Body, 4) エキスパートの皆さんはこのようにアプローチしますか？ どのような他のアプローチがあるでしょうか？ このコードの問題は、 返信は数字だけ送らなければいけない、ということです。 数字だけじゃなくて、 普通にメールに返信してもらって、（お疲れさまです。元気ですなど） 私が知りたい数字だけ（今週の成約数）、摘出したいのです。 例えばアウトルックのメールの中で行に番号がつけれれば、 この行の文字を摘出する・・・とか？ よいアイデアがあれば、教えて頂ければ幸いです・・・
　質問させていただきます。よろしくお願いいたします。 環境：Windows７　＋　エクセル２０１０　でございます。 少し気になりましたのでご質問させてください。 　50MBほどのエクセルファイルでデータを加工するために、大きな配列を下記のように繰り返し使用する事がよくございます。 Do 　ReDim varData(1000000, 10) 　　： 　　：　★ 　Erase varData Loop Until　～ 　Erase前（例えば★マークのところ）でエラーやブレークによる中断 →そのままVBAを「停止」（＝四角いリセットボタンの事です） →デバッグしてからVBA再実行 を何度も繰り返しておりますが、「停止」させた時点でこの配列のメモリは開放されているのでしょうか？ 　といいますのが、何度もVBA実行→中断を繰り返しておりますとエクセルの動作が重くなってくる事があるので、上記の問題を疑ってエクセルを一度落として再起動することが時々あります。 （再起動すればメモリが残っていても開放されると思いますので。 しかしエクセルファイル自体が重いので、何が原因なのかは不明です。） 　毎回きちんとEraseできればメモリは開放されると思うのですが。。。 　あともしメモリ上に残っているのであればですが、VBA起動直後にそれを確認してEraseするようなコードがもしございましたらお教えいただけないでしょうか。 試しに Sub Test 　If varData<> Empty Then Erase varData のような事をしてみましたが、 ＞実行時エラー１３：型が一致しません のエラーが出てうまくいきませんでした。 　もしお詳しい方がいらっしゃいましたら、どうぞよろしくお願いいたします。
うちの経営している店では 10台ぐらいのパソコンがあります。 ネットワークで繋がっています。 社員の皆さんは、 がんばって夜遅くまで仕事してくれることが多いのですが、 （ブラック企業じゃありません！ちゃんと残業代払います） ついパソコンの電源を切り忘れて帰ってしまう時が多いです。 エクセルマクロで、ウィンドウズAPIを使い、 ある時間になったら電源がついているパソコンを特定し、 強制シャットダウンするコードが書ける、 みたいなことをどこかでちらっと聞きました。 でも、本当にそんなことできるのでしょうか。。。？ 詳しい方教えて下さい！！
http://officetanaka.net/excel/vba/vbe/05.htm の Sub Sample9() Dim Code As String Code = ThisWorkbook.VBProject.VBComponents("Module1").CodeModule.Lines(7, 5) MsgBox Code End Sub のエクセルではなく アクセスバージョンはないでしょうか？ http://d.hatena.ne.jp/taka_2/20090907/p2 をアクセスの標準モジュールに貼り付けてみたのですが inFileName = WScript.Arguments(0) で実行時エラー424になってしまいます。
いつもお世話になっています。 セル内改行された文字列の上段のみ消す方法を探しています。 たとえば、 セルA１に　１２３４５ 　　　　　 ６７８９０ のようにセル内で改行されたデータがあります。 そのうちの上段１２３４５のみを削除したいのですが、 そういったことは可能でしょうか。 関数でもマクロでも方法があればなのですが。 よろしくお願いします。　
For Each myObj In objIE.document.all.tags("a") If myObj.alt = "文字" Then End If Next の様に、IEをVBAで操作する際に、altの値は取得できないのでしょうか？ 実際上記のコードを実行すると 実行時エラー '438' オブジェクトは、このプロパティまたはメソッドをサポートしていません。 になります。 それともloop中のaタグにalt要素がないからエラーになっているのでしょうか？ であれば、aタグにalt要素があるかどうかを取得するにはどうすればいいでしょうか？ 出来ればIfステートメントで取得したいです。
質問です。 特定のファイル名を複数コピーする場合、 理想な処理はなんでしょうか？ 1. IF文でファイルを確認してコピー処理 2. *.txtにファイル名を予め書き込んでおいて、 　 1行づつ読み込んで検索してコピー処理 など…、 コードが綺麗に見えて、尚且つ何処に何があるか オープンソースにした時他人がひと目で分かるような 処理構造とはなんでしょうか？ あと If File.Exists("C:\test_A.txt") Then File.Copy("C:\test_A.txt", "D:\test_A.txt", True) Else If File.Exists("C:\test_B.txt") Then File.Copy("C:\test_B.txt", "D:\test_B.txt", True) Else MessageBox.Show("test_B.txt" & vbCr & vbCr & _ "ファイルが見つかりません。再度ダウンロードして下さい", "Error", _ MessageBoxButtons.OK, MessageBoxIcon.Error) End If MessageBox.Show("test_A.txt" & vbCr & vbCr & _ "ファイルが見つかりません。再度ダウンロードして下さい", "Error", _ MessageBoxButtons.OK, MessageBoxIcon.Error) End If と永遠に書いてると、何が何処にあるのか難しいです。 一つ一つの確認に～は無い。～はある場合はコピーというのしたいです。 このIF文も何らかの形で解りやすい処理方法に変更してくれれば 幸いです。 【回答お願い】 1. 最も綺麗に見えて他人からも理解出来て処理が 　 重くならない方法でコピーするコードを書くには？ 2. 上記で記載したIF文を500行ぐらい書いています。 　 もっと綺麗に書く方法はありますか？
ステンシルのシェイプテンプレートをマクロで張り付けているところなのですが、 その張ったオブジェクトを操作したいです。 ／＊＊＊＊＊＊＊＊＊＊＊＊＊＊／ ◆困っていること DROP関数を実行した際に、 新しくオブジェクトIDが振られるわけですが、そのIDが取れず困っています。 ◆試したこと(1) IDを取れなかったので DROP関数の戻り値がシェイプオブジェクト だったようなので、 シェイプオブジェクト ＝ DROP関数（※略） として見たのですが オブジェクト変数または With ブロック変数が設定されていません となり、 戻り値なしでDROP関数を使って張り付けています。。 ◆試したこと(2) PAGEオブジェクトから、 現在の最大のインデックスを取れるか試してみたのですが （MSDNのページを見てそれっぽい関数は色々試してみたのですが出来ませんでした。。） どちらの方法も出来そうな気はするのですが。。 ．
Excel2007 windows7　使っています。以下のマクロを実行すると、アプリケーション定義やオブジエクト定義エラーになってしまします。どうしてでしょうか。ご教示お願いします。 sub test() If Not IsNumeric(Range("F17").Formula) Then Range("f17").Formula = "=IF(OR(R2=""新規用"",R2=""継続用""),"""",IF(COUNTIF(+D10,""*改定*""),78,39))" End If end sub
Ｃドライブには、 IntelもWindowsのどちらのフォルダも存在するのに Sub Sample() Dim myFSO As Object Debug.Print CreateObject("scripting.filesystemobject").GetFolder("C:\Intel").Size Debug.Print CreateObject("scripting.filesystemobject").GetFolder("C:\Windows").Size Set myFSO = Nothing End Sub をＶＢＡで実行すると \Windows の方だけエラーになります。 エラー内容は 実行時エラー　70　書き込みできません。 です。 何故でしょうか？
Sub test() Set cn = CurrentProject.Connection rs.Open "T分類", cn, adOpenStatic, adLockPessimistic rs.Filter = "中分類 = '不明' And (大分類 <> '不明')" For i = 1 To rs.RecordCount str大分類 = rs("大分類") rs("中分類") = str大分類 & "(不明)" rs.Update rs.MoveNext Next rs.Close: Set rs = Nothing cn.Close: Set cn = Nothing End Sub アクセスADOで上記のようなコードなのですが よく意味の分からないエラーが発生します。 コードの内容は 大分類が不明ではなく中分類が不明なら 中分類のレコードに大分類の値+不明にする です。 例えば該当のレコードが8レコードあれば i＝5の時に、 実行時エラー3021「BOFとEOFのいずれかTRUE になっているか、 または現在のレコードが削除されています。 要求された操作には、 現在のレコードが必要です。」 が発生します。 規則としては rs.RecordCountの半分の値までは大丈夫ですが rs.RecordCountの半分+1の時に 上記のエラーが発生します。 ADOでデータの追加をする時にAddNewメソッドを入れ忘れた場合も 上記と同じエラーが発生しますが 今回のコードはフィルターをかけ 更新したいレコードを掴んでいるので AddNewメソッドは不要だと思っています。
excel vbaで、他のEXCELファイルのマクロの処理を中断して、自己ファイルのマクロを処理後、再度他のEXCELファイルのマクロを継続して再度処理を行わせるにはどうすれば良いですか。教えて下さい 他のＥＸＣＥＬファイルとして、フリーソフトを利用しています。 そのソフトは、モジュールにロックが掛ってるので、その中のマクロなどを編集することはできません。（ロック解除などは考えていません。） そのソフトを起動して、データファイル入力画面で、データファイルを入力して、処理をして、処理結果を保存することを、入力データファイルを変えながら、繰り返し行いたいです。 そこで、処理マクロを作成しています。その手順とＶＢＡを説明します。 １）フリーソフトを開き、 ２）そのフリーソフトのシート内のボタンを、ＶＢＡで、マウスカーソルを移動させて、マウスのキー操作で、「押す」「離す」を行い、 ３）ファイルの初期化の問合せの警告が出るので、キー操作で、「Ｙ」を押し、 ４）データファイルの名称をクリップボードにコピーし ５）ＥＸＣＥＬのカレントフォルダを、データファイルのあるフォルダに変えて ６）DoＥventsとして、フリーソフトのデータファイル入力画面を開いています。 この時、画面のポインタは、データ入力画面のファイル名入力欄にあり、 この後、データファイル名をクリップボードから入力したいので、 キー操作で、「ｃｒｔｌ＋ｖ」としたいのですが フリーソフトのマクロが起動中で、作成している処理マクロに制御が移らないためと思いますが 入力できません。（人手での入力は可能ですが）、自動化したいので、どの様にすれば良いか教えて下さい。 マクロは長いので、抜粋して記載します。 sub a() （宣言文省略します。） Workbooks.Open freesoft Dim mPSet As Long mPSet = SetCursorPos(b,c) Call mouse_event(MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0) Call mouse_event(MOUSEEVENTF_LEFTUP, 0, 0, 0, 0) keybd_event VK_Y, 0, fKEYDOWN, 0 keybd_event VK_Y, 0, fKEYUP, 0 Application.CutCopyMode = False Dim d As New DataObject With d .SetText e .PutInClipboard End With ChDrive f ChDir g DoEvents （ここで、止まります。） With d .GetFromClipboard .GetText End With keybd_event VK_RETURN, 0, fKEYDOWN, 0 keybd_event VK_RETURN, 0, fKEYUP, 0 DoEvents Dim mPSet2 As Long mPSet2 = SetCursorPos(h, i) Call mouse_event(MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0) Call mouse_event(MOUSEEVENTF_LEFTUP, 0, 0, 0, 0) Workbooks(freesoft).SaveAs FileFormat:=xlNormal, Filename:=k Workbooks(k).Close End sub
地震速報のページがあります。 http://www.jma.go.jp/jp/quake/quake_sindo_index.html このページのテーブルの一番上に、 最新の地震速報が更新されていく仕組みです。 最新の地震速報が現れた瞬間に、 MS　OUTLOOKでメールを送信したいのです。 そのようなマクロを作ろうとしているのですが、 新しい情報が現れた時、をどのように定義するのかがよく分かりません ※マクロの経験あります
Excel2010を使用しています。 以下のページの最初に紹介されているマクロを実装・使用したいのですが、やり方がわかりません。 『excel_vbaでスクリーン上のpixelの色を拾いたい』 http://www.excel.studio-kazu.jp/kw/20060624174313.html APIを使ったマクロを書いたことがないので、Declare Function~Sub辺りの運用がわかりません。 詳しい方のご助力を願います。
いつもお世話になっています。 ありがとうございます。 下のようなことがしたいのですがうまくいきません。 どのようにしたらよいのでしょうか。お教えください。 Dim u As Long For u = 4 To 15 入力フォーム(CommandButton & u).ForeColor = RGB(0, 0, 0) Next u
お世話になります。 G7～AK24のセルの中で条件に該当するセルに条件付き書式で色をつけました。（G7とG8、H7とH8、AK23とAK24のように縦2つのセルが結合されています。） その色のついたセルに、あらかじめ図形で作成しておいた〇（Oval1という名前）を結合したセルの中心に重ねて、見た目でセルの中の文字が〇に囲まれているようにしたい思います。（結合したセルの中には、一文字のみ入力されています。） そういうことがマクロで可能でしょうか？ また、できれば条件付き書式で範囲内のいろいろなセルに色がついているため、たとえば赤色をつけたところを判定して〇を重ねるようにしたいです。 よろしくお願いします。
お世話になります。 エクセルで、セルに1と入力したらaと変換するマクロを作っています。 それと同時に変換したaを◯で囲みたいのですが、そういうことは可能でしょうか？ よろしくお願いします。
Windowsタブレットで使用するテンキーアプリの作り方について質問です。 Visual Studio 2015のVisual Basicにて作成しています。 アプリテンキーの数字や文字をクリックする（指で打つ）と、同じアプリ内のラベルに表示するよすにしました。 そこで、「Enterキー」なるものをクリックすると、その時に開いているExcelなどのファイルにその文字が入力され、且つラベルの表示がクリアされるようにしたいです。 どのようにプログラミングをすればいいでしょうか？ ちなみにラベルは「Label1」、Enterキーは「Botton10」になっています。 プログラミング初挑戦ですので、あまり専門用語は分からないので、初心者でも分かるようにお願いいたします。
タイトル：エクセルVBA実行時のエラー：DLLファイルが見つかりません 　質問させていただきます。どうぞよろしくお願いいたします。 環境：PC１～３の全てが、Excel2010、Win7になります。 初めてVBAから読み込むためのDLLファイルを作成いたしました。 　 　PC１上で動作確認できている２つのファイル（Test4.dll（VC++2013にて作成）と それを呼び出すVBAのついたエクセルファイル）を、 PC２とPC３に移動し、VBAを実行しましたところ 何故かPC３でのみ下記エラーが発生いたします。 ＞実行時エラー'53' ＞ファイルが見つかりません。Test4.dll ・２つのファイルは同じフォルダ内で実行しております。 ・VBAのカレントパスは 　　ChDrive Left(ThisWorkbook.Path, 1) 　　ChDir ThisWorkbook.Path で変更しております。 　試しにC:\Windows\System32と　C:\Windows\SysWow64にも Test4.dllをコピペしてみましたが、同じエラーが出てまいります。 ・PC３のみ違うところを探してみましたが、思いつくのは下記くらいでございます。 　　１．VSが入っておりませんでした。（必要なのでしょうか？？） 　　２．実行しているパスが違います。 　　　　PC1とPC2の実行パス： 　　　　　D:\Users\Administrator\Documents\VBA_TEST 　　　　PC３の実行パス： 　　　　　D:\Documents\VBA_TEST 　　　　　 　　　　　 　もし何か原因として思いつかれる事がございましたらお教えいただけないでしょうか。 お詳しい方がいらっしゃいましたら何卒よろしくお願いいたします。
よろしくお願いします 下の構文を標準モジュールに書き込み、callで実行しているのですが 処理に時間がかかります。 処理を早くする方法と構文の簡素化のご教示をお願いします。 Application.ScreenUpdating = False For i = 1 To 12 With Worksheets(i) .Select LastRow = .Range("A150").End(xlUp).Row + 1 .Range("A8:G" & LastRow).Sort Key1:=Range("A8"), order1:=xlAscending .Range("G8:G" & LastRow - 1).Formula = "=G7+E8-F8" LastRow = .Range("A150").End(xlUp).Row + 1 .Range("A" & LastRow).Select Dim EndRow As Long EndRow = .Range("A" & Rows.Count).End(xlUp).Row Cells(Rows.Count, 1).End(xlUp).Offset(1, 3) = .Name & "合計" Cells(Rows.Count, 1).End(xlUp).Offset(1, 4) = Application.WorksheetFunction.Sum(Range("E7:E" & EndRow)) Cells(Rows.Count, 1).End(xlUp).Offset(1, 5) = Application.WorksheetFunction.Sum(Range("F7:F" & EndRow)) Cells(Rows.Count, 1).End(xlUp).Offset(2, 3) = "前月繰越" Cells(Rows.Count, 1).End(xlUp).Offset(2, 4) = .Range("G7") Cells(Rows.Count, 1).End(xlUp).Offset(2, 5) = "" Cells(Rows.Count, 1).End(xlUp).Offset(3, 4) = "" Cells(Rows.Count, 1).End(xlUp).Offset(3, 3) = "次月繰越" Cells(Rows.Count, 1).End(xlUp).Offset(4, 3) = "合計" Cells(Rows.Count, 1).End(xlUp).Offset(3, 5) = Cells(Rows.Count, 1).End(xlUp).Offset(2, 4) + Cells(Rows.Count, 1).End(xlUp).Offset(1, 4) - Cells(Rows.Count, 1).End(xlUp).Offset(1, 5) Cells(Rows.Count, 1).End(xlUp).Offset(4, 4) = Cells(Rows.Count, 1).End(xlUp).Offset(2, 4) + Cells(Rows.Count, 1).End(xlUp).Offset(1, 4) Cells(Rows.Count, 1).End(xlUp).Offset(4, 5) = Cells(Rows.Count, 1).End(xlUp).Offset(3, 5) + Cells(Rows.Count, 1).End(xlUp).Offset(1, 5) Cells(Rows.Count, 1).End(xlUp).Offset(1, 6) = "" Cells(Rows.Count, 1).End(xlUp).Offset(2, 6) = "" Cells(Rows.Count, 1).End(xlUp).Offset(3, 6) = "" Cells(Rows.Count, 1).End(xlUp).Offset(4, 6) = Cells(Rows.Count, 1).End(xlUp).Offset(0, 6) .Range("C7").End(xlDown).Select Selection.Offset(4, 2).Borders(xlEdgeTop).Weight = xlHairline Selection.Offset(4, 2).Borders(xlEdgeBottom).LineStyle = xlDouble Selection.Offset(4, 3).Borders(xlEdgeTop).Weight = xlHairline Selection.Offset(4, 3).Borders(xlEdgeBottom).LineStyle = xlDouble Selection.Offset(4, 4).Borders(xlEdgeTop).Weight = xlHairline Selection.Offset(4, 4).Borders(xlEdgeBottom).LineStyle = xlDouble Selection.Offset(0, 2).Borders(xlEdgeTop).Weight = xlHairline Selection.Offset(0, 2).Borders(xlEdgeBottom).LineStyle = xlContinuous Selection.Offset(0, 2).Borders(xlEdgeBottom).Weight = xlThin Selection.Offset(0, 3).Borders(xlEdgeTop).Weight = xlHairline Selection.Offset(0, 3).Borders(xlEdgeBottom).LineStyle = xlContinuous Selection.Offset(0, 3).Borders(xlEdgeBottom).Weight = xlThin Selection.Offset(0, 4).Borders(xlEdgeTop).Weight = xlHairline Selection.Offset(0, 4).Borders(xlEdgeBottom).LineStyle = xlContinuous Selection.Offset(0, 4).Borders(xlEdgeBottom).Weight = xlThin End With Next i Application.ScreenUpdating = True
お世話になります。 現在、社内集計作業のため下記のようなマクロを組みました。 条件として保存動作をすると実行…ということで諸々調べた結果、VBE→ThisWorkBookから指定のプロシージャを選んで、その中にコードを記入する、ということが多数でしたので、それに倣いました。 ところが、いざ下記コード内容で実行しようとすると「インデックス範囲が有効ではありません」とストップをかけられる上、最初の新規ワークブック追加～コピペすら正しく行われません。 標準モジュールでは正しく実行してくれるのですが、このようなケースでエラーになる理由がよくわかりません。 つきましては、下記コードがエラーとなる理由、そして可能であればどのように修正をすればよいかお教えください。 ご面倒をおかけしますが、よろしくお願いいたします。 Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean) ' Macro2 Macro ' ' Columns("A:A").Select Range("A:FU").Select Selection.Copy Workbooks.Add ActiveSheet.Paste Columns("FU:FU").Select Application.CutCopyMode = False Selection.Copy Columns("FT:FT").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Columns("FT:GF").Select Application.CutCopyMode = False Selection.Delete Shift:=xlToLeft Columns("A:A").Select Range(Selection, Selection.End(xlToRight)).Select Selection.NumberFormatLocal = "G/標準" Sheets("Sheet3").Select Application.DisplayAlerts = False 'メッセージを出さない ActiveWindow.SelectedSheets.Delete Application.DisplayAlerts = False 'メッセージを出さない Sheets("Sheet2").Select ActiveWindow.SelectedSheets.Delete Range("A1").Select Columns("A:A").Select Range(Selection, Selection.End(xlToRight)).Select Selection.Copy Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone,SkipBlanks _ :=False, Transpose:=False ChDir "\\sv-qlikview.dmsinc.local\Documents\社内実績集計画面\読込用(仮)" Application.DisplayAlerts = False 'メッセージを出さない ActiveWorkbook.SaveAs Filename:= _ "\\sv-qlikview.dmsinc.local\Documents\社内実績集計画面\読込用(仮)\第○営業部.xlsx", _ FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False ActiveWindow.Close End Sub
初心者の為中々組めず困っています。 画像のような表のA列の特定条件の際は非表示にする方法を模索中です。 条件(以上/以下)で行ごと非表示に出来るようにする方法又は… 万年カレンダーにしている為、１日と月末の位置が変わるのでそれに合わせて 前月の日付と翌月の不要な日付が入った時は非表示になるようなVBAはないでしょうか。 A3からA39に日付、B列に曜日が固定で入力。 ※他ブックに転記する為に縦の曜日固定カレンダーにしています。 If monthもうまく行かず頭打ちの状態です。
VB.netで作成したアプリから、Excel（Excel2010）へ必要な情報を出力し、帳票を作成しているのですが、VB.netで作成したアプリから、セルの［列の幅］、［行の高さ］をミリ単位で設定し帳票を作成したいと考えております。セルの［列の幅］、［行の高さ］はピクセル単位での設定になると言われたのですが、ミリ単位で設定する事は可能なのでしょうか。 どなたか、分かる方がいらっしゃいましたら、ご教授お願い致します。 ※帳票イメージとしては添付画像のような帳票となります。
以前教えていただいた構文ですが、NOWより過ぎてない日付がFirstRow ３１より有り、過ぎた日付がない場合に実行するとエラーが出ます。これを回避するのを教えてください。 宜しくお願いします。 Const DateColumn = "B" '日付が入力されている列 Const FirstRow = 31 '削除の対象となる可能性がある最初の行 Dim LastRow With ActiveSheet LastRow = .Range(DateColumn & Rows.Count).End(xlUp).row If LastRow <= FirstRow Then MsgBox "処理すべきデータがありません。" _ & vbCrLf & "マクロを終了します。" _ , vbExclamation, "データ無し" Exit Sub End If With Application .ScreenUpdating = False .Calculation = xlManual End With .Range(DateColumn & FirstRow - 1 & ":" & DateColumn & LastRow) _ .AutoFilter Field:=1, Criteria1:="<=" & Now, _ Field:=1, Criteria2:="", Operator:=xlOr .Range(DateColumn & FirstRow & ":" & DateColumn & LastRow) _ .SpecialCells(xlCellTypeVisible).EntireRow.Delete .Cells.AutoFilter End With With Application .CutCopyMode = False .Calculation = xlAutomatic .ScreenUpdating = True End With
vbaで指定文字を含まない列を削除したいです。 指定文字を含む列を削除するプログラムはできましたが、これを指定文字を含まない列を削除に変更したいです。 途中まで作ったこのプログラムを生かして、どう変更すれば含まないにできますか？ 教えて頂けると助かります。 Private Sub CommandButton1_Click() Sheets("シート１").Select Do While (True) Rows("5:5").Select Set myselect = Selection.Find(What:="あああ", LookAt:=xlPart) If myselect Is Nothing Then Exit Do Columns(myselect.Column).Select Selection.Delete Shift:=xlUp Loop End Sub
VBScriptでADO（ADODB）接続により、SQLServer(2012)に接続して クエリを発行し、結果をファイルに出力するVBScriptを作成して います。 SQL実行時のエラーに対応する為、VBScriptにてエラーオブジェクトのプロパティ (Err.Number、Err.Description)を使用し、エラー番号と内容を取得しているの ですが、SQL Serverから発行しているエラー番号、エラー内容を取得したいので すが、取得できません。 どのようにすれば、データベース固有のエラーを取得ができますか。 是非ご教示いただきたく、 お手数をおかけ致しますが、宜しくお願い致します。 ------------------------------------------------- Option Explicit Dim objADO Dim objRS Dim Sql if WScript.Arguments.Count <> 1 then WScript.echo("usage: script.vbs arg1") WScript.Quit(-1) end if arg1 = WScript.Arguments(0) Set objADO = CreateObject("ADODB.Connection") objADO.Open "Provider=SQLOLEDB;" & _ "Data Source=hoge;" & _ "Initial Catalog=hoge;" & _ "Integrated Security=SSPI;" sql = "" sql = "select ～ where column ='"&arg1&"'" set objRS = objADO.Execute(sql) If Err.Number <> 0 Then objADO.Close Set objADO = Nothing WScript.Quit(-1) End If sql = "" sql = "update ～ ～ where column ='"&arg1&"'" objADO.Execute(sql) If Err.Number <> 0 Then 更新の破棄とエラー内容の表示 Else 更新を反映 End If objADO.Close Set objADO = Nothing
よろしくお願いします 1月から12月までの条件付き集計です。 以下の構文を簡素化できないでしょうか =SUM(SUMIF('1月'!$C$8:$C$100,J4,'1月'!$F$8:$F$100),SUMIF('2月'!$C$8:$C$100,J4,'2月'!$F$8:$F$100),SUMIF('3月'!$C$8:$C$100,J4,'3月'!$F$8:$F$100),SUMIF('4月'!$C$8:$C$100,J4,'4月'!$F$8:$F$100),SUMIF('5月'!$C$8:$C$100,J4,'5月'!$F$8:$F$100),SUMIF('6月'!$C$8:$C$100,J4,'6月'!$F$8:$F$100),SUMIF('7月'!$C$8:$C$100,J4,'7月'!$F$8:$F$100),SUMIF('8月'!$C$8:$C$100,J4,'8月'!$F$8:$F$100),SUMIF('9月'!$C$8:$C$100,J4,'9月'!$F$8:$F$100),SUMIF('10月'!$C$8:$C$100,J4,'10月'!$F$8:$F$100),SUMIF('11月'!$C$8:$C$100,J4,'11月'!$F$8:$F$100),SUMIF('12月'!$C$8:$C$100,J4,'12月'!$F$8:$F$100))
いつもお世話になっております。 VBAで、既存のテーブルに新規にデータを追加するマクロを作成しました。 追加する項目は全て文字列なのですが、何度かこの追加作業をやっていたら 左肩に、緑色の三角マークが付くものと付かないものが出てきました。 三角マークにマウスを合わせると 『このセルにある数値はテキスト形式化または・・・・』という 表示がでます。 できれば、追加する全ての文字列を、この三角マークが付かないように したいので、やり方を教えてください。宜しくお願い致します。
お世話になります。 range("B")列に日付がありその行にはRange(”C”）以下データがあります。 Range("B3")からRange("B30")までDELETEしたくない日付があり Range("B31")からの日付はNow以前はDeleteしたいのですがどなたか構文を教えてください。 宜しくお願いします
フォルダ内のワークブック約2,000個のデータを1つのシートにまとめたいのですが、VBAの勉強を始めたものの時間ばかりかかってなかなかうまくいかないので、ご指導をお願いいたします。 コピー対象の各ブック内のデータは以下の通りです ・シートは一番左端のもの1つ ・データの行数はバラバラで終端行の検出基準は「J列」 ・データの列は12列で固定 上記のようなデータをまとめ用の新規ブックを作って、1つのシートに全ブックのデータを加算してコピーをしたいです。 コピー対象の各ブックのシート名などは要りません。 ご教示よろしくお願いします。
ざっくりとした質問なのですが、 visual studioには各バージョンがありますが、 VisualStudio 2005 VisualStudio 2008 VisualStudio 2010 VisualStudio 2012 VisualStudio 2013 上記バージョンは下記バージョンを包含していると考えていいのでしょうか？ コントロールなどが、上位バージョンには対応していないなどは除くとします。 でも細かい要望に対応すると考えると、それぞれのバージョンの製品を保持したほうがいいのでしょうか？
こんばんは。 開発初心者です。 Visual StudioとOracleデータベースで簡単な購買管理の開発しようと思っています。 そこで、ご質問ですが、Windowsアプリケーションと.NETアプリケーションの違いを教えてください。
以前どこからか以下のようなVBAを見つけ使用していました。 今になり実情に合ったものに改良したいと思い始めたのですが、コピーをとる時のプロパティ UsedRangeが理解できません。 実はデータは少し不完全な場合があり、A列が他の列に比べ不足しております。 解説書などではUsedRangeを使えば、データの一番外枠、つまり全てのデータを含むようにコピーされると理解したのですが、違うのでしょうか。 データはこんな感じです。 A、B XXX、BBB XXX、BBB 、BBB よろしくお願いします。 Sub Sample() Dim sWS As Worksheet 'データシート（コピー元） Dim dWS As Worksheet '集約用シート（コピー先） Set dWS = Worksheets("AllData") '集約用シートの2行目以降を削除 dWS.UsedRange.Offset(1, 0).Clear '各シートの2行目以降のデータを、集約用シートの末尾にコピー For Each sWS In Worksheets If sWS.Name <> dWS.Name Then With sWS.UsedRange 'コピー元シートにデータが1件以上ある場合 If .Rows.Count > 1 Then .Offset(1, 0).Resize(.Rows.Count - 1).Copy _ Destination:=dWS.Cells(Rows.Count, 1). _ End(xlUp).Offset(1, 0) End If End With End If Next sWS End Sub
OS:Win7 Pro(32bit) VB.net:Visual Studio 2010 現在、vb.net2010を使用して、あるアプリケーションの改造を行っておりますが、 二つの別々の変数にもかかわらず、一方の変数に値をセットすると もう一方の変数にも値がセットされるという現象が発生しています。 APの構造は以下の通り（概略） Dim 変数Ａ　as list(Of cSubStr_A)（パブリック変数） Private Sub ルーチンＡ Dim 　変数Ｂ　as cSubStr_B 変数Ｂ.SubString. = 変数Ａ.SubString(インデックス） 変数Ｂ.SubString.left = 123 End Sub 変数Ａについては、他のサブルーチンなどで値がセットされています。 変数Ａ、変数Ｂの配下には、leftという変数があります。 現在、変数Ｂ.SubString.left = 123が実行されたときに、 変数Ａ.SubString.leftに対しても同じ値がセットされてしまいます。 （ステップ実行で確認） 他のプログラマが作成したものなので、 詳細は現在不明なのですが、変数Ａと変数Ｂは別の変数なのに、 どうして変数Ｂ配下の変数に値がセットされると、変数Ａに 反映されてしまうのかがわかりません。 別の人に聞いてみたのですが、変数名は違うけれど、 アドレスが同じところを見ているので、こういう現象になるのでは？ という指摘がありました。 今までこういう現象にで合ったことがないので、 手がかりがつかめない状態です。 なにかヒントがあれば、お教え願えればと 思います。 以上、よろしくお願い申し上げます。
VBAで if関数の処理が複数ある場合、 if ** then （AAA と BBB） のように１行で記述したいのですが、可能でしょうか？ また、Cだと、；で1行に追記できるのですが、 VBAで複数処理を１行で書く方法はあるのでしょうか？
老害と算数嫌いで・・・ ベーシックコードで ２点間(sx,sy)～(ex,ey)を対角線とする正四角形です。 他の点　(x0,y0),(x1,y1)を求めるコードを教えてください。
C#（VisualStudio2015）にてアクセスファイルに接続をしようとしています。 Windows10x64上にVMでWindows10x86を動かし、そこで実行。 System.Data.OleDbにて接続。 １．Provider=Microsoft.JET.OLEDB.4.0で.mdbファイルに接続 　　　→接続できます。 ２．Provider=Microsoft.ACE.OLEDB.12.0で.accdbファイルに接続 　　　→プロバイダはローカルコンピュータに登録されていません となります。 実行環境のx86にACCESSはインストールしていません。 OSがx64の場合は、CPUをx86でコンパイルする必要があるという記述を見つけたので、 ターゲットCPUを変更してみましたが、すべて同じ結果でした。 ご存じの方いらっしゃいましたら、ご回答お願いします。
エクセル2010でマクロを組んでデータ処理を簡単に行いたいのですが、 よくわからないので、教えてください！ シート2のC列とシート1のD列を比較し、同じ文字列があった場合に シート2のE列をシート1のF列にコピーする。 ただし、シート2のE列に〇が入っている場合は、シート2のG列をシート1のF列にコピーする。 どなたかご教示いただけませんか？ よろしくお願いします！
お世話になります。 A.xlsxというブックがあります。 この中に田中、鈴木、高橋と氏名のシート複数あります。このシートは増えたり減ったりします。 一番左のシートを選んで、ボタンをクリックしたら以下の処理が走るVBAを作成したいのです。 一番左のシートから順にパスワードを解除(パスワードはAAAA)して、ある処理をして処理後にまたパスワードを設定(パスワードはAAAA)して次の右隣のシートに映って同じ処理を繰り返していく、というVBAロジックをご教授いただけませんでしょうか。 ただしシート名に"*集計*"と名称がつくシートが存在する場合は上記処理をスキップさせたいです。 どなたかご教授いただけませんでしょうか。 よろしくお願い致します。 環境　Excel 2013
お世話になります。 エクセルVBAで Rows("3836:3836").Select の数字の部分を変更するにはどうしたら良いでしょうか？ Rows("Mdata:Mdata").Select Rows("& Mdata & ":" & Mdata &").Select では、エラーとなってしまいます。 変数の処理って私には難しいです。 よろしくお願いします。
VBA 特定の範囲のシートを並べ替えをして、処理後にマクロ実行前のシートを表示させたい。 EXCEL2013を使用しています。 現在、以下のような構文を使用して、保存時に実行しています。 処理は、シート名を書き換えてシート保護をかけて先頭から9番目のシートのA1へ戻るようにしています。 これを、次のような処理にしたいと考えています。 １．シート名を書き換え ２．シート保護 ３．先頭から9番目のシートから、31番目のシートをシート名でソート ４．マクロ実行前に作業していたシートへ戻る ちなみに、書き換えたシート名が、"１．○○○" や、"２．△△△"などになっているのですが、"."より前の値で並び替えられると便利になります。 また、デフォルトのシート名のままのものと、書き換えられたものがあり、書き換えられたものにだけ"."つきのシート名になります。 よろしくお願いいたします。 ******************************* Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean) '画面のちらつき防止 Application.ScreenUpdating = False 'シート名更新 For i = 1 To Sheets.Count Sheets(i).Select Sheets(i).Name = Range("A1").Value Next i '全シート保護 Dim ws As Worksheet For Each ws In ThisWorkbook.Worksheets ws.Protect Password:="aoken", _ DrawingObjects:=False, _ Contents:=True, _ AllowInsertingRows:=True, _ AllowDeletingRows:=True, _ Scenarios:=True, AllowFormattingCells:=True Next ws Application.Goto Sheets(9).Range("A1"), True End Sub *******************************
VBAのpaperbinを使用してプリンターのプロパティを開き、給紙方法をマルチパーパストレイを選択して、印刷するというシンプルな構文がわかりません。 どなたかわかる方いらっしゃいましたら、ご教授お願い致します。
お世話になります。 エクセルの文で下記の式があります。 =IF(ISERROR(VLOOKUP($E3822,☆集計!$C:$D,2,FALSE)),"対象外",IF($D3822>=VLOOKUP($E3822,☆集計!$C:$D,2,FALSE),"対象","対象外")) これは、正常に通ります。 これをVBAのFomura関数にしてみした。 Mdata = 3824 Range("L" & Mdata).Formula = "=IF(ISERROR(VLOOKUP($E" & Mdata & ",☆集計!$C:$D,2,FALSE))," & "対象外" & ",IF($D" & Mdata & ">=VLOOKUP($E" & Mdata & ",☆集計!$C:$D,2,FALSE)," & "対象外" & "," & "対象" & "))" 'Range("L" & Mdata).Formula = "=IF(ISERROR(VLOOKUP($E" & Mdata & ",☆集計!$C:$D,2,FALSE))," & Gai & ",IF($D" & Mdata & ">=VLOOKUP($E" & Mdata & ",☆集計!$C:$D,2,FALSE)," & Gai & "," & "Tai" & "))" コンパイルエラーとなりませんのが、実行しますと下記の様になります。 #NAME?となり、 式が =IF(ISERROR(VLOOKUP($E3824,☆集計!$C:$D,2,FALSE)),対象外,IF($D3824>=VLOOKUP($E3824,☆集計!$C:$D,2,FALSE),対象外,対象)) となり、対象、対象外が" "で括られません。 そこで、様々なサイトを参考にして下記の様にダブルクォートを重複して書きました。 ""対象""、""対象外""とすると赤字でエラーとなってしまいます。 Formula関数は、初めて使いますが、他の、単純な関数では成功しています。 どのようにすれば、通常の関数と同じ働きでインプットできるのか、ご教授して頂ければ有りがたく存じます。 よろしくお願いします。
VB.net(2010)でテキストファイルから特定の文字を検索してその後にある文字列を取得するにはどのようにすれば良いでしょうか。 【具体例】 C:\testフォルダ以下にある複数のtextファイルから"aaa"の文字を検索して、その後にある"xxx"を取得する。（同じ行にある文字列） 【textファイルの中身】 111 aaa xxx 222 ご教示のほど、よろしくお願いします。
画像をエクセルに貼り付ける作業を行っています。 マクロを使いファイル内の画像（約３０枚程度）を１列づつスペースを空け 右方向に４枚 １行スペースを空け ３行目の左に戻り その位置よりまた１列づつスペースを空け右方向に４枚・・・・・ これを繰り返しファイル内の画像をすべて 貼り付けたいのですがうまく動作が出来ません。 何卒ご教授の程よろしくお願いします。 ※マクロ Sub EggFunc_pasteDirImage() ' 変数定義 Dim fileName As String Dim targetCol As Integer Dim targetRow As Integer Dim targetCell As Range Dim shell, myPath Dim pos As Integer Dim extention As String Dim isImage As Boolean ' 選択セルを取得 targetCol = ActiveCell.Column targetRow = ActiveCell.Row ' フォルダ選択画面を表示 Set shell = CreateObject("Shell.Application") Set myPath = shell.BrowseForFolder(&O0, "フォルダを選んでください", &H1 + &H10, "C:\Users\0602116.MS\Desktop\") Set shell = Nothing ' フォルダを選択したら... If Not myPath Is Nothing Then fileName = Dir(myPath.Items.Item.Path + "\") Do While fileName <> "" ' ファイル拡張子の判別 isImage = True pos = InStrRev(fileName, ".") If pos > 0 Then Select Case LCase(Mid(fileName, pos + 1)) Case "jpeg" Case "jpg" Case "gif" Case Else isImage = False End Select Else isImage = False End If ' 拡張子が画像であれば If isImage = True Then ' 貼り付け先を選択 Cells(targetRow, targetCol).Select Set targetCell = ActiveCell ' 画像読込み ActiveSheet.Pictures.Insert(myPath.Items.Item.Path + "\" + fileName).Select ' 画像が大きい場合、画像サイズをセル幅に合わせる If Selection.Width > targetCell.Width Or Selection.Height > targetCell.Height Then If Selection.Width / targetCell.Width > Selection.Height / targetCell.Height Then Selection.Height = Selection.Height * (targetCell.Width / Selection.Width) Selection.Width = targetCell.Width Else Selection.Width = Selection.Width * (targetCell.Height / Selection.Height) Selection.Height = targetCell.Height End If End If ' 表示位置をセル中央に移動 Selection.Top = targetCell.Top + (targetCell.Height - Selection.Height) / 2 Selection.Left = targetCell.Left + (targetCell.Width - Selection.Width) / 2 ' 貼り付け先行を+1 targetCol = targetCol + 2 End If fileName = Dir() Loop MsgBox "画像の読込みが終了しました" End If End Sub
C2とD2のセルに英文字を入力した時，先頭文字を大文字にするVBAを組んだのですが，いざ実行すると「スタック領域が不足しています」と出てしまいます。以下にコードを示します。 'Sheet1 Option Explicit Private Sub Worksheet_Change(ByVal Target As Range) 　　If Target.Row = 2 And Target.Column = 3 Then 　　　　Range("C2").Value = StrConv(Range("C2").Value, vbProperCase) 　　End If 　　If Target.Row = 2 And Target.Column = 4 Then 　　　　Range("D2").Value = StrConv(Range("D2").Value, vbProperCase) 　　End If End Sub なぜこのようなエラーが出るのでしょうか。考えれば考えるほど合っているように思えて仕方なくなったので，ミスがあればご指摘をおねがいします。
デルファイですが、ベーシックでもかまいません。 正四角形の各点x0,y0 x1,y1 x3,y3からx2,y2を求めるには？ どのようなコードになりますか？
お世話になります、この度for Eath C in Range("B3").Re Size(6,7) if Application.count If Range("B3:B500"),C.Varue)>0 Thenこの計算結果をｍｓｇに表示させる構文をどなたか教えてください。
エクセルマクロについて質問です。 以前に教えていただいたコードですが、おそらく指定したセルがひとつのとき反応するコードだと思います。 これを、なおかつ、数値データがあるときに実行するにはどのように変更すればよいでしょうか？ 数値データか空白しかありません。 お手数かけますがよろしくおねがいします。 With Target If .Count = 1 Then
VBAの正規表現について学びたいのですが vbaの正規表現に特化した本はありますか？ 関数やマクロの本ならたくさんありますが 正規表現の本が見当たりません。
ExcelのVBAのコード記述についてなのですが、 ブックを閉じるの動作で、読み取り専用として開いているブックのみを閉じる方法ってあるのでしょうか？ 補足ですが、２つブックを開いていて、ブック名も同じ名前で、読み取り専用を名前を付けないように閉じてもう一方のブックが見られる状態にしたいです。
エクセルvbaの速度を向上できないか、お知恵を貸していただきたく存じます。 以下のvba（sumif関数）をもっと速めたいです。何とかできないでしょうか。長い記載となり申し訳ないのですが、何卒よろしくお願い申し上げます。 myCnt7 = 2 Do Worksheets("●").Cells(myCnt7, 4).Value = WorksheetFunction.SumIf(Worksheets("◆").Range("B:R"), Worksheets("●").Cells(myCnt7, 3), Worksheets("◆").Range("R:R")) - WorksheetFunction.SumIf(Worksheets("★").Range("B:C"), Worksheets("●").Cells(myCnt7, 3), Worksheets("★").Range("C:C")) Worksheets("●").Cells(myCnt7, 7).Value = WorksheetFunction.SumIf(Worksheets("◆").Range("B:R"), Worksheets("●").Cells(myCnt7, 6), Worksheets("◆").Range("R:R")) - WorksheetFunction.SumIf(Worksheets("★").Range("B:C"), Worksheets("●").Cells(myCnt7, 6), Worksheets("★").Range("C:C")) Worksheets("●").Cells(myCnt7, 10).Value = WorksheetFunction.SumIf(Worksheets("◆").Range("B:R"), Worksheets("●").Cells(myCnt7, 9), Worksheets("◆").Range("R:R")) - WorksheetFunction.SumIf(Worksheets("★").Range("B:C"), Worksheets("●").Cells(myCnt7, 9), Worksheets("★").Range("C:C")) Loop While myCnt7 > 201 ※シート●のＣ列から３列ごとに、Sumifの検索条件があります。 ※シート●のＤ列から４列ごとに、Sumifの計算結果を出力させます。 ※計算対象シートは、シート◆とシート★の２つです。 　シート◆のSumif合計から、シート★のSumif合計を差し引いています。 　Sumifの条件自体は、どちらのシートも同じ（シート●）。 ※上記のSumif関数の記述は、３つですが、実際の記述は２４あります。 ※すなわち、検索条件の組み合わせが２４あり、201行分をmyCnt7でLoopさせて実行しています。
大変お世話になります。 開発環境 Visual Studio 2012 VB.Net SQL Server 2014 Windows フォームで各コントロールをBindingSourceにてバインドしております。 TableAdapter.Updateにて　UPDATEやINSERTなどに関連づけられているストアドプロシジャーも正常に動作しております。 UPDATEやINSERTのストアドプロシジャーには戻り値として、主キーが返ってくるようになっております。 TableAdapter.Updateは楽に登録更新をしてくれるのは良いのですが、新規に登録した場合に主TableAdapter.Update　の戻り値は　反映した件数だと思うのですが、キーとなる値をどのように取得するのかがわかりません。INSERTで登録してあるストアドプロシジャーで本来かえってくる値を取得することはできるのでしょうか？ 大変難儀しております。 何卒よろしくお願い申し上げます。
あるEXCELで動いているソフトでエラーがでます。 メッセージは 　Microsoft Visual Basic 実行時エラー’1004’ 　Worksheet FunctinクラスのRDTプロパティを取得できません。 とでます。 　どうやったら治るか皆目見当がつきません。
質問を見ていただき、ありがとうございます。 VBAで、Evaluateを[ ]で代用して計算を行っています。 たとえばA1からA3のセルに数値が入っているとき、 A1からA3までの合計をメッセージボックスに出したければ ワークシート関数を利用して、以下のように書けます。 Sub Sum1() Dim Ans Ans = [SUM(A1:A3)] Call MsgBox(Ans) End Sub このとき、もし範囲を変数で指定したいならば どのように書けばよいのかが解らず、困っております。 たとえば、[ ]を使わずにEvaluateを使うのであれば 以下のようにできるのですが、あまり美しくない気がします。 Sub Sum2() Dim Ans, R R = "A1:A3" Ans = Evaluate("sum(" & R & ")") Call MsgBox(Ans) End Sub どなたか、ぜひ良い方法をご教授ください。
TEXTBOX とCombBoxの入力エリアへの書式（Ex.￥123,456等）のデータ入力前に設定しておく方法が分かりません。 例えばプロパティの使用で可能なのでしょうか？ 可能でしたら、そのプロパティの名称と設定方法をお教えいただきたいのですが！
漠然とした事なのですが、お教え下さいませ。 クラウド上に SQL Server が動作していたとして、それをネット経由で VB.Net の　Windowsフォームで作成したシステムで動作させることは可能なのでしょうか？ 接続文字をクラウド上で動作する文字列に変更するだけで使えないものでしょうか？ 一般的にはどうなのでしょうか？ やはりASP.Net などのシステムで制作しないとダメなものなのでしょうか？
マクロについて教えてください。（初心者です） B列にある、特定の文字（ランダムに複数の文字あります）がある場合、その行ごと削除 するマクロを教えてください。 例えば、 ＜B列＞ 2015-001 2015-002 2015-003 2015-004 と、数値があります。 2015-0002 2015-0003 の行を削除したいです。 削除対象の文字はランダムに40こほどあります。 宜しくお願いします。
以下のエクセルvba内で、「シート★」のＡ列（項目名：条件）にある値に該当するデータのみを、抽出するというSQLを書いているのですが、その速度を速めたいです。 時間が掛かる部分は、SELECT句のところで、Ａ列の条件を参照するのが、上から一つ一つになるためと分かっています。。。 何とか速度を速めることはできないでしょうか？お知恵を貸してください。 ※Ａ列の条件が入力されている値の数（行数）は、変動します。 最小で50、最大で200となります。 ◆以下、VBA（一部）－－－－－－－－－－－－－－ Dim mySQL AS String Dim i n = Cells(Rows.Count, 1).End(xlUp).Row For i = 2 to n mySQL = "SELECT * FROM [シート★$] WHERE 条件 = Cells(n, 1) " ※この下に、上記SQLから別シートにデータを出力するSQLを記載 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー 以上
Excelの自作マクロを送って欲しいと上司に言われたのですが、 どうやって送ればいいのでしょうか？ マクロは作業中のシートで保存しました。
こちらでは大変お世話になっております。 開発環境：Visual Studio 2012 Protected Overrides Sub WndProc(ByRef m As Message) MyBase.WndProc(m) End Sub 上記はよくあるメッセージ系のサブクラスで使うオーバーライトですが、 TextBoxのサブクラスでProtected Overrides Sub WndProc　を使った場合に 入力された文字を一切、オブジェクトに渡したくない場合、 （TextBoxには入力された文字は一切表示させない） ByRef m As Message　の　m に対してどのようなプログラムを書けば、 この先のTextBoxに値を渡さなくできるでしょうか？ m = Nothing などでは無理のようですので いろいろな加工を途中で行った文字列をプログラム側で代入したいなどを行いたいと 思っております。 何卒よろしくお願い申し上げます。
お世話になります。 環境：Visual Strudio 2012 VB.Net フォームにTABコントールを配置しまして、いろいろと設定やボタンなどを配置しました。 結構苦労してデザインなども行いました。 ところが、このTABコントロールに対しまして、Protected Overrides Sub WndProc(ByRef m As Message)　が必要となりまして、サブクラスにして配置しなおせば可能なのは、十分わかっているのですが、ボタンやデザインなど全て設定し直さないといけなと思うと失神しそうになった次第であります。 既にデザインやボタンなどを配置したTABコントロール対して、Protected Overrides Sub WndProc(ByRef m As Message)　を後付させることは可能なのでしょうか？ 最悪はサブクラスを作成して、デザインをやり直す覚悟ですが、最後と思いましてこちらに質問させていただきました。 何卒よろしくお願い致します。
アクセスです。 ADOで該当のフィールドの数値のMAXの値を取得するにはどうすればいいですか？ テーブルの番号フィールドには、 1 2 3 4 5 と入っているのですが、 この場合、一番大きい値は５なので MAX関数のようなもので５を返したいのですが ADOにそのようなプロパティはありますか？ オブジェクトブラウザーでRecordsetを見てみましたが 見つけられませんでした。 Sub Sample() Dim cn As New ADODB.Connection Dim rs As New ADODB.Recordset Set cn = CurrentProject.Connection rs.CursorLocation = adUseClient rs.Open "SELECT * FROM T_test", cn, adOpenStatic, adLockPessimistic rs.Sort = "番号 DESC" Debug.Print rs("番号").Value rs.Close: Set rs = Nothing cn.Close: Set cn = Nothing End Sub これで同じような動きは出来ますが、 もっとシンプルにできませんか？
win7　32ビット　オフィス２０１０です。 https:/○○login.php のようなサイトを開こうとすると ------------------------------------------------------ Dim objIE As InternetExplorer Sub test() Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True objIE.Navigate "https:/○○login.php" Call WaitIE1(objIE) End Sub ------------------------------------------------------ Function WaitIE1(objIE As InternetExplorer) Do While objIE.Busy = True DoEvents Loop Do While objIE.Document.ReadyState <> "complete" DoEvents Loop End Function ------------------------------------------------------ このコードがエラーになります。 Do While objIE.Document.ReadyState <> "complete" の部分で 実行時エラ―　-2147417848 オートメーションエラーです。 起動されたオブジェクトはクライアントから切断されました。 となります。 objIEをウォッチ式に登録してみてみると Function WaitIE1(objIE As InternetExplorer) の時に、「変数なし」となっています。 objIE.Navigate http://www.goo.ne.jp/ にすれば、 エラーにならずに、コードが最後まで行きます。 ウォッチ式を見ても 「変数なし」にはなりません。 この違いは何でしょうか？
Windows7(SP1)＋VB.NET(VS2013)にてアプリケーションを作成しています。 既定値がカラー印刷の富士XEROXの複合機で印刷しようとしています。 経費の関係で大量ページの印刷や、モノクロでも良い印刷をプログラムのほうでモノクロにし印刷できるようにしたいと思っています。 色々なサイトを調べてGetPrinter()、SetPeinter()などのAPIを使用してDEVMODE構造体を操作して変更するようにしました。が、用紙サイズ、印刷方向の変更はできたのですが、カラーの変更が出来なくて困っています。何故カラーの変更が出来ないのでしょうか？
よろしくお願いします。 添付の資料の通り、データを格納しているシートがあります。 項目は、 　・処理日 　・科目 　・D列 　・E列 　・F列 とあったとし、抽出条件は、 　・処理日の範囲指定 　・科目の指定 としたいと思っています。 VBAで処理したいのですが、まずはEXCEL関数のDSUMを使用し、添付の通り指定して、 抽出されることを確認しました。 これと同様の抽出をVBAで行いたく、VBAでワークシート関数を使用するために、 　Dim x As Variant x = Application.WorksheetFunction.DSum(Range(Cells(3, "A"), Cells(15, "E")), "D列", Range(Cells(3, "O"), Cells(4, "Q"))) とし、正しく値を取得することができました。 ですが、条件を指定する部分を、セルで指定するのではなく、例えば 　"処理日" >= 20151001 and "処理日" <= 20151002 and "科目" = "01" のように、式をVBAで生成して作成したいのですが、方法はありませんでしょうか？ ACCESSのDSUM関数のような記述ができませんでしょうか？ お手数をおかけします、よろしくお願いいたします。
お世話になります。 さて「アプリＡ」という無料ソフトがあって、 それは「ＯＥＭ」ボタンなるものを提供しており、 自作ソフトＭｅから通信で制御できるのです。 つまりアプリＡの機能を自由に使えるわけです。 そこで、アプリＡのボタンをＭｅから押して、 アプリＡのメニュー画面が出して見ると、 自作ソフトＭｅが最前面のままとなるのです。 これではＡかＡメニューのどこかをクリックして、 Ａを最前面にするか、Ｍｅを最小化しないと、 メニュー操作ができません。 ましてやＭｅ画面を最大化しているときは、 ＡとＡメニューは裏に隠れて見えすらしません。 タスクバーをクリック操作すればよいでしょうが、 そうした操作なしに自動化したいのです。 （添付の画像を参照してください） そこで現状は自作ソフトＭｅから、 １）アプリＡを最小化するメッセージを送る SendMessage(p.MainWindowHandle,&H112,&HF020,0) 上記関数の引数の意味はよく分かりませんが。 ２）アプリＡの目的のボタンを通信で押す。 AppliObj.DoButton( TARGET_BUTTOM ) ここからが困っています。 。 ３ａ）アプリＡを元のサイズにするメッセージを送る SendMessage(p.MainWindowHandle,&H112,&HF120,0) ところが！、２）をした後では反応しません。 Ａメニューがモーダルフォームだからのようです。 順序を逆にしたら、このやっていること自体が無意味。 ３ｂ）アプリＡの最小化アイコンを手動クリックする これは成功！ Ａメニューだけがポップ表示されました。 しかも自作ソフトＭｅの前面に！ しかし手動クリックをすることは目的から外れます。 ３ｃ）アプリＡの最小化アイコンを自動クリックする ところがそのアイコンのＸ座標が状況で変わるため 自動クリックの位置が定まりません。 なにか解決策を教えてもらえないでしょうか！ よろしくお願い申し上げます m(__)m
エクセル「Sheet2」のA列、C列、D列にそれぞれ100個の文字列が入力されています。 B列は空欄になっています。 （作業内容） C列とD列のデータを結合して、B列に入力 A1～B100のデータを１つのテキストファイルとして保存する。 ファイル名はその都度指定する。 よろしくお願い申し上げます。
初めてアクセスでツールを作っています。 リストを登録するツールを作っており、フォームに入れた情報を 「テーブル」に登録する仕様となっております。 フォームを開く際、自動的にIDのフォームにID番号を採番したいです。 ID番号はリストを登録する「テーブル」を参照し、既存のレコードの最後の行を検索し 最後の行に＋１をした番号を振るようにしました。 下記のようにプログラムを組み、最初のID：１、２、３まではフォームを開いた際に自動的に採番できました。 ところが次の4番目のデータを登録する際にフォームを開くと 何故かIDは３のまま表示されてしまいます。 デバックしたところ、Debug.Print rs!ID　の箇所は何故か数字が２が入っております。 MoveLast でレコード末尾を参照しようとしているのですが、 何故か末尾であるはずの３にはなりません。 アクセスでこのようなツールを作るのは初めてになるため、原因がわかる方お願い致します。 Private Sub Form_Load() 'フォーム読み込み時にID番号を付与 Dim rs As New ADODB.Recordset Me.ID.Value = Null rs.Open "テーブル", CurrentProject.Connection If rs.EOF = True Then Me.ID.Value = 1 Else rs.MoveLast Debug.Print rs!ID Me.ID.Value = rs!ID.Value + 1 End If rs.Close End Sub
質問です。 <?xml version="1.0" encoding="UTF-8"?> <ABC> <tarou id="pen" value="1" /> </ABC> とABCの太郎のペンは何本あるか？とXMLに記述してある場合、 どのようにコーディングして取得と設定を行うのでしょうか？ System.Xml.Linq等、色々あるみたいですがXMLは触れた事が無いので…。 お優しい方お教え下さい。
使用するパソコンが変更になり、今まで問題なく動作していたのですが、できなくなってしまいました。 （パソコン環境） 故障によりパソコンは変わりましたが、VISTA、Excel2003という環境は同じです。 （動作内容） 個別の色コードを12個つなぎ合わせて、1つの商品コードにします。 ランダムにピックアップして、400個の商品コードを作成します。 （具体的には） 12箇所の色コードをそれぞれ4パターンの中から1つを選択して、商品コードを作成するものです。 Sheet1には、48個（12箇所×4パターン）のコードを予め用意したものがあり、VBAによって、 Sheet2に400個の商品コード（セル範囲A1～D400）を作成します。 色のコードはあらかじめセル（4種×12面で48個のセル）に入力してあります（手作業で）。 エクセルシートのＡ列に、たてに48個を入力 　・セル（　Ａ３～　Ａ６）にＡ面の色コード 　・セル（　Ａ８～Ａ１１）にＢ面の色コード 　・セル（Ａ１３～Ａ１６）にＣ面の色コード 　・セル（Ａ１８～Ａ２１）にＤ面の色コード 　・セル（Ａ２３～Ａ２６）にＥ面の色コード 　・セル（Ａ２８～Ａ３１）にＦ面の色コード 　　　　　　　　　・ 　・セル（Ａ５８～Ａ６１）にＬ面の色コード （問題点） 動作しているようなのですが、Sheet2が真っ白のままで終了していまいます。 エラー表示のウィンドウは出てきません。 これまでSheet2には商品コードが400行作成（セル範囲A1～D400）できておりました。 （お願い） 原因が分からず途方に暮れております。解決方法をお願いいたします。 （以下にコード転載します。） Sub 商品コード作成400() Dim ASide, BSide, CSide, DSide, ESide, FSide, GSide, HSide, ISide, JSide, KSide, LSide nTotal = 400 '←コード作成数 sFileName = Range("A1") '←商品の名前（Sheet1のA1セル） '12面分の色コードを配列に取り込む ASide = Range("A3:A6") BSide = Range("A8:A11") CSide = Range("A13:A16") DSide = Range("A18:A21") ESide = Range("A23:A26") FSide = Range("A28:A31") GSide = Range("A33:A36") HSide = Range("A38:A41") ISide = Range("A43:A46") JSide = Range("A48:A51") KSide = Range("A53:A56") LSide = Range("A58:A61") Application.ScreenUpdating = False With Sheets("Sheet2") .Cells.ClearContents For i = 0 To 4095 'パターン作成　４の６乗　４０９５個 .Cells(i + 1, 1) = sFileName aa = 1 + Int(i / 4 ^ 5) Mod 4 bb = 1 + Int(i / 4 ^ 4) Mod 4 cc = 1 + Int(i / 4 ^ 3) Mod 4 dd = 1 + Int(i / 4 ^ 2) Mod 4 ee = 1 + Int(i / 4 ^ 1) Mod 4 ff = 1 + Int(i / 4 ^ 0) Mod 4 '前半６個の組み合わせ .Cells(i + 1, 3) = ASide(aa, 1) & BSide(bb, 1) & CSide(cc, 1) & DSide(dd, 1) & ESide(ee, 1) & FSide(ff, 1) '後半６個の組み合わせ .Cells(i + 1, 4) = GSide(aa, 1) & HSide(bb, 1) & ISide(cc, 1) & JSide(dd, 1) & KSide(ee, 1) & LSide(ff, 1) .Cells(i + 1, 5) = Rnd() Next i 'ランダムに並び替え .Range("A1:E4096").Sort Key1:=.Range("E1") '不要な分を削除　４００個のみ残す .Range("E1:E4096").ClearContents .Range("A401:D4096").ClearContents End With End Sub
EXCEL2010を使用しています。 Ｄ3に於いて名前を選択できるようにしています。Ｄ3に入力する名前と同一の写真（JPG)がDISK TOP上フォルダー内に複数あります。 Ｄ3で名前選択時,該当する写真をA5:M29に表示したい。 以下のコードは他の方が使われてるコードを参考にしたもので、※印の場所でエラーとなります何が 原因なのか？他の部分も合わせ教えて下さい。 Private Sub Worksheet_Change(ByVal Target As Range) If Target.Address = "$D$3" Then myPath = "C:\Users\Users\DeskTop\PHOT" myFile = myPath & Range("D3").Text & ".jpg" For Each sh In ActiveSheet.Shapes If Left(sh.Name, 7) = "Picture" Then sh.Delete End If Next Range("A5:M29").Select myTop = Selection.Top myLeft = Selection.Left myWidth = Selection.Width myHeight = Selection.Height ※ActiveSheet.Pictures.Insert(myFile).Select With Selection .Top = myTop .Left = myLeft .Width = myWidth '画像の幅 .Height = myHeight '画像の高さ End With Range("D3").Select End If End Sub
情シスとしてシステム会社から最近中途入社しました。 年配の担当者が内作して色々とプログラムを作っていますが、未だVB6で作っています。 今更VB？という感じですが、win7でもwin10でも動作するので、イマイチ.NETに替えるメリットが見出だせません。 結構そういう会社多いような気がするんですが、皆さんどういう対応してますか？ ご意見ください。
こんにちは。 VB初心者です。 前任者が作成したCSVファイルをメモリに格納するプログラムから Oracleテーブルのデータからメモリへ格納するプログラムへ 変更したいのですが、全くのVB初心者でわかりません。 ヒントでもいいですので教えてください。 CSVファイルをメモリに格納するプログラムは以下の通りです。 Function ReadCSV(ByVal szFilePath As String) As String()() ' (全般) に Imports 追記 ' Imports System.IO ' Imports System.Text Dim arrayTempLines()() As String = {} ' ストリームを開きます Dim reader As New IO.StreamReader(szFilePath, System.Text.Encoding.Default) Dim iIdx As Integer = 0 ' 一気に読み込みます Dim szData As String = reader.ReadToEnd() ' 不要な文字を取り除きます szData = szData.Replace(vbCr, "") ' 改行で分離して配列に格納します Dim arrayLines() = szData.Split(vbLf) Dim szLine As String For Each szLine In arrayLines Dim iCount As Integer = 0 Dim szTemp As String = "" Dim bValid As Boolean = False If szLine.Length > 1 Then ' 配列の追加します ReDim Preserve arrayTempLines(iIdx) ' カンマ区切りで分離して配列に格納します arrayTempLines(iIdx) = szLine.Split(",") ' データのチェックをします If arrayTempLines.Length >= 1 And _ arrayTempLines(iIdx)(0) <> "" Then bValid = True ' 不要データを除きます For Each szTemp In arrayTempLines(iIdx) arrayTempLines(iIdx)(iCount) = _ szTemp.Replace(Chr(34), "").TrimEnd() ' Chr(34)は"のことを指します iCount += 1 Next ' 配列数チェックをします If bValid Then iIdx += 1 End If Next ' 配列を切り詰めます 'ReDim Preserve arrayTempLines(iIdx - 1) ' 読み込み用のストリームを閉じます If (Not reader Is Nothing) Then reader.Close() reader = Nothing End If ReadCSV = arrayTempLines End Function 以上です。 ちなみに、Oracleテーブルの中にはフィールドが二つあります。
VBScript Script ファイル (.vbs)を書き出して、エクセル表の加工をしようとしています。 Set objExcel = CreateObject("Excel.Application") objExcel.Visible = True Set objWorkbook = objExcel.Workbooks.Open("～～～ ・ ・ ・ 先頭行を固定したく、下記のようにしましたがエラーになります。 objWorksheet.Range("A2").Select objWorksheet.ActiveWindow.FreezePanes = True また、データーのある最下行+2にデーターの合計を入れるように、追加コードを記述したいのですが、どのようにするのでしょうか？
Module Public Structure Elem Public nr As Integer Public type As Integer Public side()() As Double ' side(Nr.)(x|y|z)== normal vector Public Sub initialize() Dim side(100)() As Double End Sub End Structure Public e_enq As Elem() = New Elem(100) {} End Module 　'******　以下ボタンなどで本文内で動作させている *********** Dim i, j, k As Integer 1 ReDim e_enq(100).side(50)(2) 2 For k = 0 To 10 With e_enq(k) For j = 0 To 10 .side(j)(0) = 0.0　　'*** .side(j)(1) = 0.0 .side(j)(2) = 0.0 Next j End With Next k 1 の方法での記述で　newが必要とのエラーコメント 2 の方法でも　'***部でやはり　newが必要とのエラーコメントが出る 　sideが1次元ならば、動作するのですが、2次元にするとエラーが発生します。 　現在、プログラムが進展しなくて困っています。 　どなたか、お詳しい方がいらしゃれば、どうかご指導をお願いいたします。
ExcelのVBAのマクロですが、デバックモードではマクロの実行速度が速く、実行モードではかなり遅くなる現象についての質問です。 速度比は1:5-1:10程度です。 速度比を1:1程度にする方法を教えていただきたい。 マクロは、Xp-2003で作りW7-2007で作動させております。 マクロにて、Openしたり、Saveしたりするファイルは[.xls]です。 また関係ファイルには、マクロ実行用のコントロールボタンが多々あります。 Openしたり、Saveしたりするファイルも同様です。 何かの時、ボタンの表示形式が影響しているとういうことを聞いた気がします。
.NET Frameworkを理解するには ｖｂ．ｎｅｔを学べば おのずと、.NET Frameworkも理解できますか？
お世話になります。 開発環境：Visual Strudio 2012(VB.Net) DB：SQl Server 2008 OS：Windows 7 WindowsフォームやDataView のデータソース元として　TableAdapter（ストアドプロシジャー）を作成しました。 また、その際にコマンドを既存のストアドプロシジャーに登録する箇所で、 Insert , UpDate, Delete として各ストアドプロシジャーを作成し登録しました。 WindowsフォームやDataViewのデータソースをそのTableAdapterで作成して できたBindingSourceにしている場合に、たとえば　BindingSource.RemoveAt(10)など で見かけ上データを削除した時でも　コマンドで登録したDeleteのストアドプロシジャーが 実行されず、再びフォームを開くと消したはずのデータが表示されます。 TableAdapterでコマンド登録した各ストアドプロシジャーは　新規登録、更新、削除を行った場合、どのようにすれば実行させることができるのでしょうか？ そんなことはできない　や　こうすればよいなどの情報がございましたら何卒ご教授いただければと思っております。 よろしくお願い申し上げます。
Word　2003で作成したファイル（拡張子doc）のプロパティの「詳細」タブに示される「コンテンツの作成日時」をExcel 2003のVBAで取り出すことができません。これまでに、(1)FileDateTime　(2)FSOのDateCreated　(3)FSOのDateLastModified　などを試しましたが、得られたのはいずれもプロパティの「全般」タブの「作成日時」や「更新日時」で、「コンテンツの作成日時」ではありませんでした。対象としているdoc ファイルは、復元ソフトで復元したもので、唯一、「コンテンツの作成日時」だけが、今回、取り出したい、最初にファイルが作成された日時が保存されており、「全般」タブの「作成日時」などは、ファイルを復元した日や操作した日となっています。どうしても「コンテンツの作成日時」を取り出して、ファイル作成日をファイル名に追加し、新しいファイル名にしたいと思っています。よろしくお教えいただきますようお願いいたします。
VBAの初心者です。 サーバ内の各ホルダーに入っているファイル情報をSheetに書き出しさらにそのファイル名にハイパーリンクをつけてファイルを参照するマクロをWebから例を参照させて頂き作成しました。 マクロを作成した目的は、頻繁に更新されるネットワーク越しのファイルを ユーザ単位で指定したホルダー分参照出来るようにしたい為です。 そして、VBAを意識せず安易に誰でもこのマクロを実行出来るようにする事です。 とりあえず、下記マクロ文で、M:\01_仕事\10_仕様書ホルダー内のファイル情報を 　Sheet名＝仕様書へ書き込む事は出来て、ハイパーリンクも貼れてファイル内の参照は出来ています。 作成したSheetを画像添付しました。 しかし、下記点が旨く出来ません、ご教示頂けたらと思います。 ・このマクロ内で複数、参照したいファイルのホルダー名と書き出すSheet名を、変数や配列などに 　記述して一挙に作成したい。 ・下記マクロ内のPrivate Sub FileDisp(strPath, i)ではWorksheetsの所で変数名が使えない為、 　Worksheets("仕様書").Cells(i, 2)などと、Sheetの名前をいちいち記述しました。 　複数のホルダーに対応させるにはどうしたら良いか？ ---------以下はマクロ文　------------------------------------------------------------------------------------- Private Sub test7() 'Private Sub Auto_Open() Dim a As String Dim b As String a = "仕様書" b = "M:\01_仕事\10_仕様書" Call SHEETNAME(a) Call FORDERR(a, b) End Sub Sub SHEETNAME(a) 'SheetAddDelの使用例 SheetAddDel (a) End Sub Sub SheetAddDel(shname As String) '現在のWorkbookに同名のSheetがないか確認する。 'あれば、そのSheetを削除する。 'それから、新しいSheetを挿入する Dim sh As Object For Each sh In Worksheets If sh.Name = shname Then Application.DisplayAlerts = False sh.Delete Application.DisplayAlerts = True End If Next sh Sheets.Add.Name = shname End Sub Private Sub FORDERR(a, b) strPath = b Range("c1").Value = strPath Worksheets("仕様書").Cells(3, 2) = " " Range("A3", ActiveCell.SpecialCells(xlLastCell)).ClearContents Range("A3").Select i = 3 FileDisp strPath, i End Sub Private Sub FileDisp(strPath, i) Dim WSname As String Dim WSvalue As String 'Application.ScreenUpdating = False '画面を固定する事により高速化しま Set objFs = CreateObject("Scripting.FileSystemObject") Set objFld = objFs.GetFolder(strPath) Worksheets("仕様書").Cells(i, 2) = objFld.Path 'sak With Worksheets("仕様書").Cells(i, 2).Font 'sak .Bold = True 'sak End With 'sak With Worksheets("仕様書").Cells(i, 2).Interior 'sak .ColorIndex = 6 'sak .Pattern = xlSolid 'sak End With 'sak i = i + 1 ' サブフォルダ名を入れるsak For Each objFl In objFld.Files Worksheets("仕様書").Cells(i, 2).Select WSname = objFl.ParentFolder.Path & "\" & objFl.Name 'hyperlink用sak WSvalue = objFl.Name 'ヘルプの「Addメソッド」から「Hyperlinks オブジェクトの Add メソッド」を参照 Worksheets("仕様書").Hyperlinks.Add anchor:=Cells(i, 2), _ Address:=WSname, ScreenTip:=WSname, TextToDisplay:=WSvalue With Worksheets("仕様書") .Cells(i, 2).Font.Size = "11" .Cells(i, 3) = objFl.ParentFolder.Path & "\" & objFl.Name ' フルパスに変更sak .Cells(i, 4) = Int(objFl.Size / 1024) .Cells(i, 5) = objFl.Type .Cells(i, 6) = objFl.DateCreated .Cells(i, 7) = objFl.DateLastAccessed .Cells(i, 8) = objFl.DateLastModified End With i = i + 1 Next For Each objSub In objFld.SubFolders FileDisp objSub.Path, i Next End Sub ------------------------------------------------------------------------------------------------------------------------------
VB2010で作成したEXEプログラムがあります。 このプログラムを別のVB2010で呼び出しています。 Shell("K:\Test.exe", vbNormalFocus) フォームは最大化して、Test.exeを任意の位置に 表示させたいのですが、Test.exeのプロパティを 書き込む方法がわかりません。 Test.exeのプロパティはMy Projectの設定で My_x Integer ユーザー 0 My_y Integer ユーザー 0 としています。 Test.exeでは位置の設定は Dim i As Integer = My.Settings.My_X Dim j As Integer = My.Settings.My_Y With Me .Top = j .Left = i End With どなたか教えてもらえませんか。
excelでハイパーリンクからwebサイトを呼び出そうとして不適切なURLだと 「サイトへのリクエストが正しくありません」とメッセージを表示してくれる便利な機能があります この機能を呼び出して不適切であるかどうか判定してハイパーリンク先をあらかじめチェックするマクロを組みたいのですが、どのように記述すればよろしいでしょうか？
2列(N列,O列)に1～3の数字が入ってる行を、指定したsheetへ抽出させるVBAのマクロを 作成したいのですが、VBAが全く分からず困っています。 または、Excel上でも簡単に上記の事が出来るのでしたら、その方法も教えて下さい。
※この質問は、以前の質問で完全解決前に、自分で受付終了としてしまったので、改めて質問させていただくものです。 以前の質問：http://okwave.jp/qa/q9054210.html 【実現を希望したいこと】 エクセルファイル（ファイル(1)）を自分のＰＣのローカルドライブ（Ｃドライブ）に置いておき、会社内の共有サーバー内にある別のエクセルファイル（ファイル(2)）にて、DSUMのVBAを実行して、エクセルファイル(1)のデータをDSUM集計する。 （ファイル(1)内のデータを、ファイル(2)のDSUMマクロのデータベースとして実行するという感じ） 【以前の質問でご教示いただいたVBA】 sub macro1() 　application.screenupdating = false 　workbooks.open filename:="C:\DB.xlsx"　’拡張子他注意 　with thisworkbook.worksheets("Sheet1")　’シート名不明注意 　　.range("D2").formula = "=DSUM([DB.xlsx]Sheet1!A:D,4,A1:C2)" 　　.range("D2").value = .range("D2").value 　end with 　workbooks("DB.xlsx").close false 　application.screenupdating = true end sub ※keithin様より教えていただいたものです。 【現在困っていること】 上記VBAをベースに少し手直したVBAをつかい、私自身が共有サーバー内のファイル(2)からマクロを実行したところ、希望通り動きました。 しかしながら、他のメンバーが共有サーバー内のファイル(2)からマクロを実行したところ、 workbooks.open filename:="C:\DB.xlsx" の部分がうまいこといきませんでした。まあ、そりゃＣドライブ内という記述なので、他メンバー自身のＣドライブを参照しに行くという命令になりますもんね。。。 【質問】 前置きが長くなってしまい申し訳ございませんが、共有サーバー内のエクセル（ファイル(2)）から、どのメンバーがマクロを実行しても、特定個人（私自身）のローカルドライブ（Ｃドライブ）内のエクセル（ファイル(1)）を参照しにいくVBAを教えていただけないでしょうか。 自分としては　workbooks.open filename:="C:\DB.xlsx"　の記述の変更が必要と思っています。。。 何卒、よろしくお願い申し上げます。
初心者です。デリゲートを初めて使うのですが、 スレッド処理でWebClientでイベントハンドラを作成した後、 以下の Delegate Sub MyDelegate() Private Sub downloadClient_DownloadProgressChanged(ByVal sender As Object, ByVal e As System.Net.DownloadProgressChangedEventArgs) If InvokeRequired Then Invoke(New MyDelegate(AddressOf DownloadProgressA)) '終わり Else ProgressBar1.Value = e.ProgressPercentage Label1.Text = e.ProgressPercentage & "%" End If End Sub でDownloadProgressAには ProgressBar1.Value = e.ProgressPercentage Label1.Text = e.ProgressPercentage & "%" と書いたのですが、 メソッド 'Private Sub DownloadParmertar(sender As Object, e As System.Net.DownloadProgressChangedEventArgs)' に、デリゲート 'Delegate Sub MyDelegate()' と互換性があるシグネチャがありません とエラーが発生します。 スレッド処理やDelegate、Invokeを初めて使うので よく分かりません。どうすれば進行度を処理表示 出来るでしょうか…。 お優しい方教えて下さい。
お世話になります。 Excel 2010で互換モードでxlsファイルを使っていたのですが、xlsmに変更してVBAの更なる自動化を図っていました。 そのファイルを書いている最中、別件で、共有ファイルを開く仕事が入って、開いた途端、応答なしになり、強制終了せざるを得なくなりました。 何回もxlsmのファイルを起動しようとしたのですが、開けず、かなり書いたプログラムを読むことができません。 そのファイルは、VSSに張り付いていたxlsを加工していますので、別途保存していませんし、ファイルが大きいので自動保存もしていませんでした。 xlsのファイルから作り直しでしょうか？ よろしくお願いします。 P.S.会社のファイルなので社外に持ち出すことができません。 来週以降にならないといじることはできないセキュリティシステムになっています。
頭書の件、現在マクロで以下のようなことを行おうとしており悩んでおります。 皆様のお知恵を拝借いたしたく、お願いいたします。 エクセルのSheet1に以下のような形でデータが格納されております。 A行：文字列、B行：数字でそれぞれ60000個程度のデータ格納されております。 この中から、特定の文字列を含んだ列を全て削除したデータを配列に格納するマクロを作成したいと考えています。 「特定の文字列」は、例えば"山田", "佐藤", "田中"の３種類とします。 もし上述の文字列のいずれかを含んだデータが30000個あれば、削除後の30000個程度のデータを新しい配列に格納したいと思っています。 イメージ的には以下のような操作がしたいのですが、「If C(i, 1) <> List Then」では通らないので、この部分に該当するような操作をなにかしらの方法で表現できましたらご教授いただけると助かります。 Sub test() Dim C As Variant Dim D As Variant Dim i As Long Dim j As Long Dim List As Variant List = Array("山田", "佐藤", "田中") C = Worksheets("Sheet1").Range("A1", "B6000") For i = 1 To 60000 If C(i, 1) <> List Then D(j,1)=C(i,1) D(j,2)=C(i,2) j=j+1 Else End If Next End Sub お手数をおかけいたしますが、宜しくお願いいたします。
IE11のダウンロード通知バーをExcel VBAから操作する為、 http://okwave.jp/qa/q8121989.html を参考にさせて頂きました。 「保存」のボタンを探す条件がまずい為か、IUIAutomationElementのButtonを参照する所で、Buttonが見つかっていない為、エラーになります。 Dim iCnd As IUIAutomationCondition Set iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, "保存") Dim Button As IUIAutomationElement Set Button = e.FindFirst(TreeScope_Subtree, iCnd) Dim InvokePattern As IUIAutomationInvokePattern Set InvokePattern = Button.GetCurrentPattern(UIA_InvokePatternId) 〈エラーメッセージ〉 実行時エラー '91'： オブジェクト変数またはwithブロック変数が設定されていません 〈動作環境〉 OS Windows 10 64bit Excel2013 どなたか、解決方法のアドバイスを宜しくお願いします。
お世話になっております。 エクセルで次のようなテーブルの自動生成マクロを作成したいと考えておりますが、なかなかうまくいきません。 皆さまのお知恵を拝借いたしたく、お願いいたします。 「Data」シート、「Table」シートの２つのシートをエクセルに用意します。 「Data」シートには、200行2列のデータが予め入っています。 1列目にはaaa.F、aaa.W、aaa.R、bbb.F、bbb.W、bbb.Rといった形の文字列が延々と入っています。 2列目には数字のデータが入っています。 行いたいのは、まず1列目のデータを「.」で区切って、２つの配列「st」と「pr」に入れなおすことです。 ただ、単にsplitするだけですと、1列目のデータを分けた際に、 st=(aaa、aaa、aaa、bbb、bbb、bbb) pr=(F、W、R、F、W、R) といった形で同じ値が格納されますが、ダブっている文字ははじく様にしたいのです。 このため、例えばstについて、次のようなマクロを考えたのですが、これだとstをdebug.Print等で出力した際、一番最後のデータだけしか格納されていませんでした。 Dim C As Variant C = Worksheets("DATA").Range("A1:B65000") Dim D As Variant Dim i As Integer Dim st As Variant For i = 1 To 10 D = Split(C(i, 1), ".") If st <> D(0) Then st = D(0) Debug.Print (st) 　↑ここでstを出力している分には、aaa、bbb、cccとダブった文字を省いたすべてのデータが出力されます。 Else End If Next Debug.Print (st) 　↑ここでstを出力すると、最後のデータだけしか出力することができません。 　st(3)等、特定の要素を出力しようとしてもできないようです。 stをvariant型にしていることが問題なのかもしれませんが、stをstring型のarrayで定義し、各要素ごとに入力すると、st(0)=aaa、st(1)=aaaといった形で同じ値のものも入ってしまいます。 異なった文字列だけ各要素に入力していくにはどのようにマクロを組めばよいのでしょうか？
A1セルにAAA VVV EEE TTT YYYYY UUUUUU WW RRRR WW TTTT という文字列が入力されています。 VBAによって、B1セルから順序右へ空白ごとに分割した文字列を代入することができますか？ できれば、空白の数に制限なくできるものを所望しています。 もし不可能であれば最低でも10個までのものだと助かります
sub macro1() 　dim a as variant 　dim h as range 　dim r as long 　dim w0 as worksheet 　set w0 = activesheet 　worksheets.add after:=w0 　r = 1 　range("A1:G1") = array("苗字","名前","住所","TEL","〒","好きなスポーツ","性別") 　on error resume next 　for each h in w0.range("A1:A" & w0.range("A65536").end(xlup).row) 　　if h <> "" then 　　　a = split(replace(application.trim(replace(replace(h, "　"," "),"：",":")),": ",":"), " ") 　　　r = r + 1 　　　cells(r, "A") = split(a(0), ":")(1) 　　　cells(r, "B") = split(a(1), ":")(1) 　　　cells(r, "C") = split(a(2), ":")(1) 　　　cells(r, "D") = split(a(3), ":")(1) 　　　cells(r, "E") = split(a(4), ":")(1) 　　　cells(r, "F") = a(5) 　　　cells(r, "G") = a(6) 　　end if 　next end sub
【VBA】同一ディレクトリ内のファイル名取得とA列、B列のコピペ A.xlsに同一ディレクトリ内にあるyyyymmdd.csvファイルを順に読み取り A.xlsの A1に対象ファイル名 B列に対象ファイル内のA列をコピペ C列に対象ファイル内のB列をコピペ 次のファイルはD1 その次はG1 ・ ・ といった処理をさせたいです。 どのように記述すればよいでしょうか。 よろしくお願いしますm(._.)m
ウインドゥというのでしょうかvisual studioのコードを入力したりプロジェクトにいろいろ追加する部分を消してしまって戻し方がわかりません しょーもない質問だと思いますが教えてください こんな画面になってます
Excel２０１３でVBAを動かすと「型が一致しません」と表示され、 動作が中断されます。 解決方法がわからないので、教えてください。 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー Dim i As Long, k As Long, MaxRow As Long MaxRow = Range("H" & Rows. Count).End(xlUp).Row k = 2 For i = 2 To MaxRow If Month(Range("H" & i)) <> Month(Range("H" & i + 1)) Then 　←　ここで中断する Range(Cells(i, 8), Cells(i, 10)).Copy Cells(k, 1).PasteSpecial Paste:=xlPasteValues Else Range(Cells(i, 8), Cells(i, 10)).Copy Cells(k, 1).PasteSpecial Paste:=xlPasteValues k + 1 End if ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー 「on Error Resume Next 」をエラー箇所の前に追加すると 最後まで動き、正しい結果になります。 しかし、こんな解決方法でいいのか不安なので、 別の解決方法がわかれば、教えてください。 よろしくお願いします。
いつも楽しく勉強させていただいております。 OSはWin7でOffice365です。 Excelマクロはまだまだ勉強中です。 Excelシート上の折れ線グラフの線をマクロから削除したいのですが、どうしてもできません。 前提として６本線の折れ線グラフがあります。 データによってはグラフの線は６本以下のことがあります。 その場合は不要なグラフの線を消したいのです。 そこでグラフを右クリックし、[データソースの選択]ダイアログで削除したい系列を削除して、それをマクロ記録しました。 Sub Macro2() ActiveSheet.ChartObjects("グラフ 146").Activate ActiveChart.FullSeriesCollection(6).Delete End Sub これを参考に下記のマクロを書きました。 Sub d() Dim a As ChartObject Dim b As Chart Set a = ActiveSheet.ChartObjects(1) Set b = a.Chart b.FullSeriesCollection(6).Delete End Sub ところが最後の行で「実行時エラー1004 パラメータが無効です」になって異常終了してしまいます。 デバッガを使って調べると b.FullSeriesCollection.Countが3になており、 b.FullSeriesCollection(3).Deleteつまり三つ目の系列なら削除することができます。 しかし最大６個の系列のうち、後ろの方から削除したいのでこれでは困ってしまいます。 どうしたらいいでしょうか。 なぜ系列は６個なのに３個にされてしまうのでしょうか。 ちょっと引っかかるのが[データソースの選択]ダイアログで「データ範囲が複雑すぎるため表示できません」と言われることです。
初めまして、Y-Kobayashiです。 私はVisualBasicを勉強しているのですが、行き詰っております。 なぜかと言いますと、サンプルプログラムを打ち込んでも、そのままでは実行ができないからです。 使用している書籍は「かんたんVisual Basic（技術評論社）」というものです。 以下が、そのサンプルです。 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー Module Module1 Private mName As String = "YOSHI" Sub Main() Dim SUJI As Integer = 3 If SUJI = 3 Then Console.WriteLine(mName) End If '-> Console.ReadLine() End Sub Sub DispMsg() Console.WriteLine("Hello {0}", mName) End Sub End Module ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー Sub Main()内のmNameは表示されるのですが、Sub DispMsg()内のものが表示されないのです。 一応、「'->」のある位置に「DispMsg（）」と入れれば実行されるのですが、書籍にはそういった記載がありません。 どうすれば良いのでしょうか？ 他にも、Subとはどういう意味なのか、Moduleとはどういう意味なのか、それらはどの様な働きをするのか等、最初から使う物にも関わらず記載がなされていないので、明確に認識ができない状態です。 SubはC言語でいうところの、関数の様なもの。 Moduleはそれらをまとめるグループ（？）もしくは関数の様なもの。 NameSpeaceはModuleをまとめるグループ（？）もしくは関数の様なもの。 という認識を持ちつつありますが、これで合っているのでしょうか？ VBの参考書はこういった説明が省かれる傾向があるのでしょうか？ 図書館で何冊か見ましたが、途中から出てくる単語の解説が無くなって行きます。 それらは大抵自動で入力されるのですが、意味が分からないと気持ち悪いです。 おすすめの参考書があれば教えてください。 よろしくお願いします。 乱文失礼しました。
DOMについて教えてください classの名前が class="abc"となっている時、下記のようなコードでヒットします。 IDの名前が id="def"となっている時、If objE.idName = "def" Thenなんて書くとエラーになります。 この場合どういうふうに書けばいいんでしょうか。 For Each objE In div2.getElementsByTagName("DIV") If objE.className = "abc" Then htmData1 = objE.innerText
ホームページのソースをVBAで表示してみてます。 ヤフーhttp://www.yahoo.co.jp/の場合は問題ないのですが、 ソフトバンクhttp://www.softbank.jp/の場合は日本語が文字化けしてしまいます。 何が違うんでしょうか。 ブラウザで表示して、ソースを表示させてみるとどちらも文字化けせす正常に表示されます。 どなたか教えてください。 コードこんな感じです、ネットで探したものです。 Sub test() Dim http As WinHttp.WinHttpRequest Dim sURI As String Dim sHTML As String Set http = CreateWinHttpRequest 'sURI = "http://www.softbank.jp/" sURI = "http://www.yahoo.co.jp" With http .open "GET", sURI, False .send sHTML = .ResponseText End With Debug.Print sHTML End Sub
Windows7とExcel2007でマクロ作成中の初心者です。 (1)縦の行に連番を振るコードはたくさんありますが、横に連番を振る コードは皆無です。 (2)教えて頂きたいのは、あるセルＦ4から、右横方向に1から28までの番号を振りたいです。そして２９番目からまた、右方向に1から28まで番号を振ります。これを繰り返します。 (3)ただし、今の番号を振る行の下の行の最終列までで終了したいです。 よろしくお願いします。 以下のような縦の例は数え切れないほどサンプルがあります。 Sub 横に番号を振る() Dim i As Long With ThisWorkbook.Worksheets(1) For i = 1 To 28 .Cells(i, "A").Value = i Next i End With End Sub
お世話になります。 自分では解決できなかったのでお知恵をお借りしたいです。 google翻訳APIで下記のデーターが帰ってきますが、下記結果の 「これはペンです。」の部分を抜き出したいのですが、どの ようにしてもエラーがでます。 http://d.hatena.ne.jp/so_blue/20090326/1238084885 上記を参考にがんばってみましたがうまくいきません。 お知恵をお借りできれば幸いです エクセル2002のVBAにてプログラムしております。 { "data": { "translations": [ { "translatedText": "これはペンです。" } ] } }
Ｗindows7とＥxcel2007でマクロ作成中の、初心者です。 (1)ブックＡにマクロ書き込み、Ｂブックに処理データがあります。 (2)Ｂブックは毎月一回だけ、書式の変更マクロを実行します。 (3)そのため、苦肉の策として Range("E3")が０のときは、実行するが、１のときはマクロ実行しないように しています。 (4)以上の方法では、更新するときは、いちいちRange("E3")の値を手動で０に する必要があります。面倒です。 (5)そこでＡブックのユーザーフォームに日付の入ったテキストボックスを取り付け ここの日付けが変更されたときだけ、マクロを実行するようにしたいのですが。 難しくて出来ません。教えていただきたいです。お願いします。 Sub 書式の変更操作() Application.ScreenUpdating = False Dim n As Long Dim myBtn As Integer Dim myMsg As String, myTitle As String Dim mydate As Date mydate = Worksheets("集計").Range("D2").Value If Range("E3").Value = 0 Then myMsg = "この" & Format(Range("D2").Value, "m月") & "分 表の書式等を更新します。" myTitle = "書式変更の確認" myBtn = MsgBox(myMsg, vbOKOnly + vbExclamation, myTitle) 書式更新のマクロ実行 Range("E3").Formula = "1"　’ここで次回起動時マクロ実行しない MsgBox "書式を更新しました。" Else MsgBox "既に変更済みです。", vbOKOnly + vbExclamation Exit Sub End If Application.ScreenUpdating = True End Sub
VBA初心者です。 下記コードのエラー修正をお願いします。 実行時エラー91 オブジェクト変数またはWithブロック変数が設定されていません と出てしまいます。 デバッグではIf obj.Document の文がおかしいそうです。 またこのコードは不安定で、最後まで実行できる時もあれば、途中でエラーになるときもあるので修正頂けると嬉しいです。 よろしくお願いします。 Sub テスト() Dim obj As Object Set obj = CreateObject("InternetExplorer.Application.1") obj.Visible = True targetURL = "http://map.japanpost.jp/pc/syousai.php?id=300197019000" obj.navigate (targetURL) Do While obj.Busy Loop obj.Visible = True For I = 0 To obj.Document.All.tags("div").Length - 1 If obj.Document.All.tags("div")(I).classname = "str_title_hira" Then S = obj.Document.All.tags("div")(I).InnerText Worksheets("Sheet1").Range("A1") = S End If Next For I = 0 To obj.Document.All.tags("div").Length - 1 If obj.Document.All.tags("div")(I).classname = "str_title_kana" Then S = obj.Document.All.tags("div")(I).InnerText Worksheets("Sheet1").Range("B1") = S End If Next For I = 0 To obj.Document.All.tags("p").Length - 1 If obj.Document.All.tags("p")(I).classname = "unit" Then S = obj.Document.All.tags("p")(I).InnerText Worksheets("Sheet1").Range("C1") = S End If Next obj.Quit End Sub Sub waitNavigation(ie As Object) Do While ie.Busy Or ie.ReadyState < 4 DoEvents Loop End Sub
現在、自分で作ったマクロを登録したバイナリファイルを、何人かに配布しているのですが、モジュール・フォーム共に多数登録してある為、更新に時間が掛かってしまいます。 そこで、更新を自動にしようと思い立ちました。 モジュールとフォームの数が多いので、バイナリファイルごと入れ替える方式にしようと思っております。 具体的に言うと、 (1)PERSONAL.xlsbファイル内に以下の内容のマクロを起き、ファイルを開いた時に自動で起動する。 (2)ネットワークフォルダ内のMACRO.xlsbと、 CドライブXLSTARTフォルダ内のPERSONAL.xlsbを比べる。(3)MACRO.xlsbの方が新しかったら、MACRO.xlsbをXLSTARTフォルダ内にコピーする。 (4)PERSONAL.xlsbを削除する。 (5)MACRO.xlsbの名前をPERSONAJ.xlsbにする。 (6)自分自信を別名保存し、MACRO.xlsbをリネームし、そのファイルをオープン。 (7)MACRO.xlsbのsheet1に組み込んだマクロを起動し、別名にしたPERSONAL.xlsbを閉じて、削除する。 この工程で、(6)までは何とか出来たのですが、(7)のマクロが起動しません。 マクロ呼び出しのコードは、 Application.Run "PERSONAJ.xlsb!削除" としていますが、エラーが出る訳でも無く、動きません。 何故でしょうか？ バイナリファイルだからとか、何か制約があるのでしょうか？ 分かる方、是非ご教示下さい。
VBA初心者です。 以下のコードを打つと、実行時エラー`91'オブジェクト変数またはWithブロック変数が設定されていません。 と出てしまいます。 どこを直したら上記の表示が消えますか？ Sub テスト() Set obj = CreateObject("InternetExplorer.Application.1") obj.Visible = True targetURL = "http://map.japanpost.jp/pc/syousai.php?id=300197019000" obj.navigate (targetURL) Do While obj.Busy Loop obj.Visible = True For i = 0 To obj.Document.All.tags("div").Length - 1 If obj.Document.All.tags("div")(i).classname = "str_title_hira" Then s = obj.Document.All.tags("div")(i).InnerText Range("A1") = s End If Next For i = 0 To obj.Document.All.tags("p").Length - 1 If obj.Document.All.tags("p")(i).classname = "unit" Then s = obj.Document.All.tags("p")(i).InnerText Range("A3") = s End If Next obj.Quit End Sub
こんばんは。 Windows 8.1 Pro 64bit + Visual Studio (Basic) の環境で印刷するプログラムについて教えてください。 ドットプリンターに出力する連続紙の用紙サイズを追加したのですが crReportDocument.PrintOptions.PaperSize = PaperOrientation.のところで 補完機能のリストに追加した用紙サイズが表示されません。 どうしてなのでしょうか。
こんにちは。 Windows 8.1 Pro 64bit + Visual Studio 2013 （Basic）で ちょっとしたプログラムについてご質問します。 インストールされているプリンターをComboBoxに表示させるには どのようにすればいいのでしょうか？
VBA初心者です。 この度住所録を作成することになりVBAで操作しようと考えております。 http://map.japanpost.jp/pc/syousai.php?id=300197019000 このURLの店舗名・住所の部分を抜き出しExcelシートに出力したいと考えています。 そしてこの要領で残りの店舗分もソースのフォーマットは一緒なので取得したいと考えております。 コードの書き方がわかりませんので、教えて頂けませんか？よろしくお願いします。
今日、表題のとおりの質問に次のとおり教えていただきました。 自分としては、８月の21でなく、９月の２１を選びたいです。 Sub 日付選択() Range("AL4:CU4").Select Selection.Name = "日付範囲" Range("日付範囲").Find(What:=Day(Range("AJ2")), LookIn:=xlValues).Select End Sub セルAJ2には、2015/9/21が入っています。 AL4からCU4には　８月18日から10月17日の間の、日にちだけが、はいっています。 上のコードを実行すると、８月21日を選択します。 これを9月21日のところを選択するようにしたいです。よろしくご教示お願いします。
Windows7 EXCEL2007でマクロ作成中の初心者です。 (1)セルには式がはいってます。 'セルL4 に =VLOOKUP(J73,年月管理!F17:I39,4,FALSE) 'セルM4 に =L4+1 'セルN4 に =M4+1 'セルO4 に =N4+1 'セルP4 に =O4+1 (2)セルの表示は年月日のうち日のみ表示 'セルL4 に 18 (2015/8/18の日付のうち日のみ）が表示されてる 'セルM4 に 19 (日付のうち日のみ）以下同じ 'セルN4 に 20 (日付のうち日のみ） 'セルO4 に 21 (日付のうち日のみ） 'セルP4 に 22 (日付のうち日のみ） (3)検索したい年月日は次のとおりです 'セルK4 に 2015/8/21 次のようなコードでＯ4のセルを選択したいのですが、うまく行きません。 どうしたらよいか、教えて下さい。 Sub 日付選択() Range("L4:P4").Select Selection.Name = "日付範囲" Range("日付範囲").Find(Range("K4").Value).Select End Sub
アクセスでadoを使ってレコードセットを開く時に rs.Open "Q_(クエリ名)", cn, adOpenStatic, adLockPessimistic とするとエラーになります。 しかし、 Q_(クエリ名)というクエリは作成できたし、問題なく開けます。 adoの時は、カッコ付のオブジェクト名を指定できないという事でしょうか？
質問です。 Access-VBAで下記の記述をしました。 Me.品目コード.SetFocus Me.品目名.Value = "AAAA" これでコンパイルすると、エラーが発生します（メソッドまたはデータメンバーが見つかりません）。 コントロール名の後に「.」を入力すると、メソッドやプロパティのリスト入力ができるようになりますが、その中にSetFocusやValueがありません。 ライブラリの参照設定の問題なのでしょうが、どれを参照すれば分かりません。 動作環境は以下の通りです。 　・OS ：　Windows 7 　・Access　： 2015 どのように対応すればよろしいでしょうか？ 回答、よろしくお願いします。
下記のVBAでファイルを出力することはできるようになったのですが、 出力するときに[キャンセル]を押しても"MsgBox ：Excelファイルへの出力が完了しました。"が表示されてしまいます。 「キャンセル」した場合は、このメッセージが表示されないようにできないでしょうか？ Private Sub Image_Export_Click() On Error GoTo Err_FileDialog_Click 'ファイル出力 Dim strFileName As String Dim ExpFileName As String ExpFileName = "T_master_" & Format(Now(), "yyyymmdd") strFileName = GetFileName(False, "MicrosoftExcel ブック (*.xls)|*.xls", "", ExpFileName & ".xls") If Len(strFileName) = 0 Then 'キャンセルボタンが押されたときの処理を記述 MsgBox "キャンセルが押されました。" Else DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel8, "T_master", strFileName & ".xls", True End If MsgBox "Excelファイルへの出力が完了しました。", , "出力完了" Exit_FileDialog_Click: Exit Sub Err_FileDialog_Click: MsgBox "予期せぬエラーが発生しました" & Chr(13) & _ "エラーナンバー：" & Err.Number & Chr(13) & _ "エラー内容：" & Err.Description, vbOKOnly End Resume Exit_FileDialog_Click End Sub
ボタンを押すとテーブルのデータが出力できるようにしたいと思います。 標準Module1とFormのボタンには下記のような記述をしていますが 添付ファイルのように保存のダイアログまではうまく動いているようです。 ただ、ファイル名がブランクですので、"表示材料_" & Format(Now(), "yyyymmdd")と自動的に表示させたいです。 ご教授お願いいたします。 【PC環境】 Access:2010 WIndows 7 【標準Module1】 Function GetFileName(OpenOrSaveFlg As Boolean, strFilter As String, _ strTitle As String) As String Dim returnValue As Integer Dim strFilePath As String If strFilter = "" Then strFilter = "全てのファイル (*.*)|*.*" End If WizHook.Key = 51488399 'WIZHOOK有効 returnValue = WizHook.GetFileName( _ 0, "", strTitle, "", strFilePath, "", _ strFilter, _ 0, 0, 0, OpenOrSaveFlg _ ) WizHook.Key = 0 ' WizHook 無効 GetFileName = strFilePath End Function 【Fromのボタン】 Private Sub コマンド28_Click() Dim strFileName As String Dim ExpFileName As String ExpFileName = "表示材料_" & Format(Now(), "yyyymmdd") strFileName = GetFileName(False, "MicrosoftExcel ブック (*.xls)|*.xls", "") If Len(strFileName) = 0 Then 'キャンセルボタンが押されたときの処理を記述 MsgBox "キャンセルが押されました。" Else DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, "T_WO_MAT", "", True, "" End If End Sub
上段の表の１行目の"●"印の列のみ表示し１行目空白は列削除し下段の表にしたいのですがどなたかVBAコードが解る方宜しくお願いします。
「原紙」という名前のエクセルブックがあり、新しいお客様が増えたらそのブックを複製し、更にその時にダイアログを出してお客様の名前を入力し、それをファイル名にしたいです。 下記の.vbsファイルに元ファイルをドラッグすると連番を付けて複数作る、という目的でのコマンドを見つけました（これも凄いですが）。 もし改良出来る方がいたら教えてください。 ・コピー数の指定は必要ありません（毎回1ファイルのみ複製）。 ・ドラッグすると、ダイアログが出てきて入力したものがファイル名になる。 よろしくお願い致します。 If WScript.Arguments.Count = 0 Then WScript.Quit Dim fso Set fso = CreateObject( "Scripting.FileSystemObject" ) '--- コピー元ファイルの確認 filePath = WScript.Arguments.Item(0) If fso.FileExists( filePath ) = False Then WScript.Echo filePath & "がありません" WScript.Quit End If '--- コピー数の指定 Num = InputBox( filePath & vbNewLine & "をいくつコピーしますか") If IsNumeric( Num ) = False Then WScript.Echo "数値を入力してください。" WScript.Quit End If If Num > 999 Or Num < 1 Then WScript.Echo "数値は１～999で指定してください。" WScript.Quit End If Extention = "." & fso.GetExtensionName( filePath ) '--- ファイルチェック For i=1 To Num newFilePath = Replace( filePath, Extention, "_" & Right( "000" & i, 3) & Extention ) If fso.FileExists( newFilePath ) = True Then WScript.Echo "作成予定のファイル【" & newFilePath & "】が既に存在します。" WScript.Quit End If Next '--- ファイルコピー For i=1 To Num newFilePath = Replace( filePath, Extention, "_" & Right( "000" & i, 3) & Extention ) fso.CopyFile filePath, newFilePath Next
B.xlsのA列とA.xlsのB列、B.xlsのC列とA.xlsのD列の行がマッチしたらA.xlsのF列、H列の数値をB.xlsのD,E列に添付の下図のように数値を入力したいのですがVBAコードが解る方宜しくお願いします。（同じく関数の方もわかればお願いします）
今まで問題なくできていたのですが エクセルのｖｂａのＡＤＯでアクセスにレコードを追加していました。 なんだか今日いきなりエラーになりました。 エラー内容は 実行時エラー3251 現在のRecordsetは更新をサポートしていません。 プロバイダ―か、選択されたロックタイプの限界の可能性があります です。 発生したコードは rs("不可") = エラー文字列 です。 要するに、今までは更新できるテーブルだったけど 何かの拍子で更新できないテーブルになってしまったから エラーになったのでしょうか？
あるバイナリデータのバックアップを印刷したいと考えています。 元のバイナリデータが2MBぐらいあるのでそれをZIP圧縮して1MBでそれをbase64で文字列に変換すると 2MBぐらいの文字列になってしまい 印刷すると150ページでした。 金庫にしまうにしても150ページでは多いのでなんとか10ページぐらいに抑えたいです。 そこで考えたのですがbase64の要領で日本語の文字列に変換することができれば印刷枚数を減らせるかと思うのですが　そういった圧縮を行うライブラリってないものでしょうか？ 容量は減らなくてもいいので 印刷のページ数を減らしたいです。 base64が64文字に対し日本語の文字列は5万文字？あるので大幅に減らせそうですし 小学生で習う漢字レベルだけでも1文字の情報量が100倍以上になるのでうまくいくのかなぁ？っと。 ちなみにバックアップするものは秘密鍵のような物で もちろん暗号化してクラウド等オンラインでもバックアップをしていますが 非常に重要な物のため万が一に備えて紙でも印刷して残しておき　いざというときに復元できるようにしたいです。 復元する際はOCR使って さらに目視でデータ確認で数時間とか数日かかるとしても 復元したいと思うレベルのデータです。 環境はVisualStudioでC#で組もうかと思っていますが 変換と復元作業ができれば環境は問いません。　いいライブラリやアルゴリズムがあれば教えてください。 あるいは日本語文字でなくても　QRコードのように印刷した紙から一定のアルゴリズムでデコードできればなんでもいいのでよろしくお願いいたします。
#include <stdio.h> int main(void) { int n1, n2; int wa; puts("二つの整数を入力してください。"); printf("整数1:"); scanf_s("%d", &n1); printf("整数2:"); scanf_s("%d , &n2") wa = n1 + n2; printf("それらの和は%dです。\n", wa); return 0; } エラー 1error C2146: 構文エラー : ';' が、識別子 'wa' の前に必要です。c:\users\伸之\documents\visual studio 2013\projects\training\source.cpp101training 2IntelliSense: ';' が必要ですc:\Users\伸之\Documents\Visual Studio 2013\Projects\training\Source.cpp92training のエラーが出たなんですけど、原因がわかりません。 よろしくお願いします。
VBAでIE操作メニュー選択完了まで待機したい ●経緯： VBAを利用し、IEを操作するマクロを組んでいますが、下記の部分で処理が終わるまで待つ方法がわかりません。 IEで、あるWebサイト内にある複数のプルダウンメニューを順に選択して行きますが、このプルダウンメニューはそれぞれ順番に入力していかないと入力できないタイプの物です。 説明がわかりにくいかもしれませんが、下記のような3つのメニューがあり、MenuName1は最初から選択可能な状態。 MenuName2と3はグレーアウトしており選択できないが、MenuName1を選択するとMenuName2が選択可能になり、MenuName2を選択するとMenuName3がそれぞれ選択可能になります。 　MenuName1　→　選択可能 　MenuName2　→　グレーアウト 　MenuName3　→　グレーアウト 該当のプルダウンメニュー部分のWebソースは後述しますが、上記各メニューを選択後、 fireEvent ("onchange") を実行し、そのまますぐに次のメニューを選択しようとすると、Web側の処理が追いつかずにエラーになってしまいます。 現状、下記のように無理やり一定時間待機させてから次のメニュー選択に移っていますが、他にメニューのグレーアウトが終わるまで待つ方法はありませんでしょうか？ While Now < DateAdd("s", second, Now) DoEvents Wend ●HTMLソース： それぞれ、該当メニュー部分のコードは下記のとおりです。 ・アクティブになっているプルダウンメニュー <select name="MenuName1" onchange="javascript:setTimeout('__doPostBack(\'MenuName1\' ,\'\')', 0)" id="MenuName1" style="width:110px;"> ・非アクティブのプルダウンメニュー <select name="MenuName2" onchange="javascript:setTimeout('__doPostBack(\'MenuName2\' ,\'\')', 0)" id="MenuName2" disabled="disabled" style="width:110px;"> ●試したこと： １） Do While objIE.Busy = True Or objIE.readyState <> 4 DoEvents Loop で、一番最初のWebページ読み込み完了まで待つことはできますが、該当 プルダウンメニューの選択完了を待つことはできませんでした。 ２） Do ～～～ DoEvents Loop 上記コードをMenuName2、3の実行直前にいろいろ試してみましたが、どうにもうまくいきません。 それぞれ下記のような条件文で記載しましたが、記載のとおりの失敗でした。 ２－１） Do While InStr(objIE.Document.getElementById("MenuName2").outerHTML, "disabled") > 0 →「書き込みできません」 ２－２） Do Until IsNull(objIE.Document.getElementById("MenuName2").disabled) →無限ループ？ここで止まる ２－３） Do While objIE.Document.getElementById("MenuName2").disabled = True →「オブジェクト変数またはwithブロック変数が設定されていません」 ２－４） Obj1 = objIE.Document.getElementById("MenuName2").disabled Do Until Obj1 Is Nothing →「オブジェクトが必要です」 ※Obj1はVariant型で宣言 しかも上記、それぞれ何度も繰り返しているうちに、タイミングの問題なのかたまに成功したりします。 さらに、Debug.Print等で各条件文入れてみると、ちゃんと条件結果の値が出てくるので、ますますうまくいかない理由がわかりません。 本件、各プルダウンメニューのグレーアウトが解除されるまで待つ方法を教えてください。 ※書き込みには上記（↑）に対する回答を含めてください。 ※該当WebサイトのHTMLソース、マクロの全文は長いので抜粋にて記載しています。 　不足がある場合は該当部分を探してきますので、どの部分が必要か補足してください。 ※該当Webサイトは関係者専用のため、URLは公開できません。 ※該当Webサイトは委託先に発注しているもので、Web側の改変は不可能です。 ※「検索したけど解決法はありませんでした」と言う旨の回答はご遠慮願います。 ※書き込みは他のユーザーの迷惑にならないようにお願いいたします。
エクセル2007を使用しています。 ユーザーフォームのコードに以下のコードを書いてシートのセル情報をユーザーフォームに表示したいと考えています。 以下のコードでは「ActiveRow」の指定が固定になってしまうので、ユーザーフォームに「NEXT」ボタンを追加して、NEXTボタンが押されたら「AcviveRow」を一つづつ増やして表示させるという方法を教えていただけないでしょう。 VBA素人です。 よろしくお願いします。 尚、ActiveRowの初期値は「４」になります。 Private Sub UserForm_Initialize() Call Farst End Sub Sub Farst() Dim Data1 As String Dim Data2 As String Dim Data3 As String Dim Data4 As String Dim Data5 As String Dim Data6 As String Dim Data7 As String Dim Data8 As String Dim Data9 As String Dim Data10 As String ActiveRow = 4 With Worksheets("MDH,MDO") Data1 = .Cells(ActiveRow, 1) Data2 = .Cells(ActiveRow, 2) Data3 = .Cells(ActiveRow, 3) Data4 = .Cells(ActiveRow, 4) Data5 = .Cells(ActiveRow, 5) Data6 = .Cells(ActiveRow, 6) Data7 = .Cells(ActiveRow, 7) Data8 = .Cells(ActiveRow, 8) Data9 = .Cells(ActiveRow, 9) Data10 = .Cells(ActiveRow, 10) Me.TextBox1連番.Text = Data1 Me.TextBox2品番.Text = Data2 Me.TextBox3品番2.Text = Data3 Me.TextBox4品番3.Text = Data4 Me.TextBox5単価.Text = Data5 Me.TextBox6PO_NO.Text = Data6 Me.TextBox7発注日.Text = Data7 Me.TextBox8数量.Text = Data8 Me.TextBox9層.Text = Data9 Me.TextBox10備考.Text = Data10 End With End Sub
Excel2007を使っています。 VBA初心者ですがユーザーフォームのテキストフォームにエクセル内のセルデータを表示させたいと考えています。 以下のコードをユーザーフォームのコードに書いてユーザーフォームを走らせましたがユーザーフォームは表示するのですがデータがまったく表示されません。 どなたかご教授いただけませんでしょうか。 Sub Farst() Dim Data1 As String Dim Data2 As String Dim Data3 As String Dim Data4 As String Dim Data5 As String Dim Data6 As String Dim Data7 As String Dim Data8 As String Dim Data9 As String Dim Data10 As String Dim ActiveRow As String ActiveRow = 4 With Worksheets("MDH,MDO") Data1 = .Cells(ActiveRow, 1) Data2 = .Cells(ActiveRow, 2) Data3 = .Cells(ActiveRow, 3) Data4 = .Cells(ActiveRow, 4) Me.TextBox1連番.Text = Data1 Me.TextBox2品番.Text = Data2 Me.TextBox3品番2.Text = Data3 Me.TextBox4品番3.Text = Data4 End With End Sub
お世話になります。 どうしてもわからないので教えてください。 やりたいことは以下です。 ●DecをHexの符号ありに(1byte)変換 ●結果としてDec「-02」を変換してHex「FE」が欲しい。 -128～127(変換後は80～7F)まで200通り以上あるので自動変換したいです。 使用しているインターネットのサイトだとできますが、VB6のプログラムで書くとうまくいきません。 ネットに繋がらない環境で変換しなくてはいけなくなったので、どなたか助けてください！ お願いします。
WindowsCE7.0を社内WLANに接続し、PC上のMicrosoft Accessデータベース(mdb又はaccdb)に接続し、操作するプログラムが開発できるかどうか調査しています。 開発環境はVisual Studio 2008（.NET Compact Framework 3.5）で、VBです。 .NET Compact Frameworkで、SQL Serverに接続することはできそうですが、Accessデータベースに接続することは不可能でしょうか。
エクセルVBAで以下の方法のマクロが分からず、教えて頂きたいです。 まず、ブックAのシートAがあり、シートAのセルD3には号機No.を入力します（999などの数値のみ） 次にブックBのシートBがあり、このシートのD列にも号機No.が入力されています。 やりたい事はブックAのシートAのD3に号機No.を入力したら、ブックBのシートBのD列から同じ号機No.を 探し、当てはまる号機の行のI列、J列、K列、L列、M列をコピーし ブックAのシートAのF13、F14、F15、F16、F17、に貼り付けたいです。 それぞれの貼り付け先は K列⇒F13　L列⇒F14　M列⇒F15　I列⇒F16　J列⇒F17のようになります。 それとブックBのシートBのD列に入力されている号機No.は同じ数値が入力されている時があります。 この場合は必ず下にある号機No.のが最新ですので、そちらを読み取るようにしたいです。 例えば、4行目と8行目に同じ号機No.がある場合は8行目の方を読み取る。 現在は　GYOU = Application.InputBox　でターゲットの行番号を入力して その行の列をコピー・ペーストしている感じです。 Private Sub Worksheet_Change(ByVal Target As Range) On Error Resume Next Dim tmp() As String If Intersect(Target, Range("D3")) Is Nothing Then Exit Sub Else End If Dim buf As String Dim j As Integer Dim GYOU As String Set xCur = Selection Dim OpenFileName As String Workbooks.Open Filename:="業務都合の為載せれません" GYOU = Application.InputBox("行を選択してください", "行指定") '<キャンセルの場合、処理を終わりにします。> If GYOU = "False" Then Exit Sub For j = 11 To 11 ActiveSheet.Cells(GYOU, j).Copy ThisWorkbook.ActiveSheet.Cells(13, 6).PasteSpecial Paste:=xlPasteValues Next j For j = 12 To 12 ActiveSheet.Cells(GYOU, j).Copy ThisWorkbook.ActiveSheet.Cells(14, 6).PasteSpecial Paste:=xlPasteValues Next j For j = 13 To 13 ActiveSheet.Cells(GYOU, j).Copy ThisWorkbook.ActiveSheet.Cells(15, 6).PasteSpecial Paste:=xlPasteValues Next j For j = 9 To 9 ActiveSheet.Cells(GYOU, j).Copy ThisWorkbook.ActiveSheet.Cells(16, 6).PasteSpecial Paste:=xlPasteValues Next j For j = 10 To 10 ActiveSheet.Cells(GYOU, j).Copy ThisWorkbook.ActiveSheet.Cells(17, 6).PasteSpecial Paste:=xlPasteValues Next j ActiveWorkbook.Close SaveChanges:=False With xCur .Parent.Parent.Activate '元のブックへもどる .Parent.Activate '元のシートへもどる End With End Sub ど素人の為、めちゃくちゃな並びだとは思いますが一応現在の状態のマクロを載せておきます。 御指導の程、宜しくお願いします。
ファイルが存在している場合は、ファイルをオープンして書き込み、ファイルが存在していない場合は、ファイルを作成後、オープンして書き込みを行わせたいと考えています。 しかし、ファイルが存在していないとき、ファイルは作成されるのですが、『エラー：800A0046　書き込みできません。VBScript実行時エラー』が出て、書き込みができません。モードをWritingにしても同じでした。 お手数をおかけしますが、ご教示いただけますようお願いいたします。 Option Explicit '■ オブジェクトの宣言 Dim objFSO Dim objFile '■ 定数の宣言 Const strFileName = "C:\VBS\TEST.TXT" '■ 定数の宣言 '// ファイル入出力モード(8:追加書き込み) Const ForAppending = 8 Set objFSO = CreateObject("Scripting.FileSystemObject") If objFSO.FileExists(strFileName) Then WScript.Echo "ファイルが見つかりました" Else WScript.Echo "ファイルが見つかりませんでした" Set objFile = objFSO.CreateTextFile(strFileName) If IsObject(objFile) Then WScript.Echo "ファイルを作成しました" Else WScript.Echo "ファイルを作成できませんでした" WScript.Quit(1) End If End If '// ファイルのオープン Set objFile = objFSO.OpenTextFile(strFileName,ForAppending) objFile.WriteLine "2012/12/21,100,ブレーキパッド,35000"
フォルダ、ファイルが存在しないとき、作成するスクリプトをVBSで作成していますが、疑問点があるのでご教示ください。 objFSO.CreateFolder、objFSO.CreateTextFileを実行が、正常に行われた場合、 Err.Numberに0がセットされると思っていましたが、実際は違っていました。 objFSO.CreateFolderでフォルダが作成される場合、Err.Numberに13が返されます。 objFSO.CreateTextFileでファイルが作成される場合、Err.Numberに438が返されます。 このスクリプトを実行後、フォルダ、ファイルが存在しない場合、作成されることも確認しています。 フォルダ作成後、作成されたフォルダに対して、ファイルの作成／データの書き込みのアクセス権を拒否にすると返されるErr.numberに70がセットされることも確認しています。 なぜ、フォルダ、ファイルが作成された場合、0が返されないのかご存知の方がいらっしゃいましたらご教示ください。 また、その情報が記載されている書籍およびサイトがあれば、お教えいただければ、幸いです。 Option Explicit Dim objFSO Dim objFile Const strFolderName = "C:\VBS" Const strFileName = "C:\VBS\test.txt" On Error Resume Next Set objFSO = CreateObject("Scripting.FileSystemObject") If Err.Number = 0 Then WScript.Echo "FSOオブジェクトを作成しました" Else WScript.Echo "FSOオブジェクトを作成できませんでした" WScript.Quit(1) End If If objFSO.FolderExists(strFolderName) Then WScript.Echo "フォルダが見つかりました" Else WScript.Echo "フォルダが見つかりませんでした" If objFSO.CreateFolder(strFolderName) Then If Err.Number = 13 Then WScript.Echo "フォルダを作成しました" Else WScript.Echo "フォルダを作成できませんでした" WScript.Quit(1) End If End If End If If objFSO.FileExists(strFileName) Then WScript.Echo "ファイルが見つかりました" Else Script.Echo "ファイルが見つかりませんでした" If objFSO.CreateTextFile(strFileName) Then If Err.number = 438 Then WScript.Echo "ファイルを作成しました" Else WScript.Echo "ファイルを作成できませんでした" WScript.Quit(1) End If End If End If
excelの抽出をマクロ化しようと思っています。 キー記録で Sheets("data").Range("B11:O714").AdvancedFilter Action:=xlFilterCopy, _ CriteriaRange:=Sheets("data").Range("G3:G5"), CopyToRange:=_ Range("B4:O615") , Unique:=False を得たので、これを元にして、条件範囲をオートシェイプのある列を条件にしようと思い、 col = ActiveSheet.Shapes(Application.Caller).TopLeftCell.Column で、オートシェイプの列を取得し、 Sheets("data").Range("B11:O714").AdvancedFilter Action:=xlFilterCopy, _ CriteriaRange:=Sheets("data").Range(Cells(3, col), Cells(5, col)),_ CopyToRange:=Range("B4:O615") , Unique:=False としたのですが、エラーになってしまいます。 colを使って条件範囲をするにはどうしたらいいのでしょうか？ よろしくお願いします。
VBAにてシート名称を取得しシート１の一覧にまとめ、ハイパーリンクで一覧から各シートへ飛べるようにしています。 Dim retsu As Long,gyo As Long For retsu = 1 To Worksheets.Count 'シート名称をリストに記入 ThisWorkbook.Worksheets(1).cells(gyo + 1, 2) = Worksheets(retsu).name Next このコードでシート名称を取得するとシート名称が「001」などの頭に０の数字があるとき、リスト上では「１」となってしまいます。 そのため、リスト上とシート名称が異なり、ハイパーリンクの設定時に参照エラーとなってしまいます。 桁数を問わずに「001」は「001」のまま、「１」は「１」のまま取得するにはどうすればよいでしょうか？ ※シート名称には「1月度」などの文字列もあります。(数字の名称のみではありません)
vb.net使用です。 メニュー画面（メイン） 待ち画面（テキストボックスとボタンがあります。） 実行画面 の3つのフォームがあります。 メイン画面から待ち画面を表示し、待ち画面から実行画面に移ります。 待ち画面でテキストにデータが入るまでループさせていて、 テキストにデータが入ってから実行画面を表示させるプログラムを作っているのですが、 待ち画面のループのプログラムで実行画面を表示させているのですが、（この時は表示している） プログラムが終了すると実行画面が消えてしまいます。 ループのプログラムをやめて、ボタンから行うと実行できます。 INVOKEも使用してみても状況がかわりません。 実行画面が使用できるようにするにはどうしたらよいか教えていただけないでしょうか。 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ Private Sub 待ち画面_Load(sender As Object, e As System.EventArgs) Handles Me.Load Psmachi End sub Private Sub　　Psmachi（） Do Until txttxt.text <> “” 　　　 実行画面.show Me.hide Loop End sub Private sub bottan_click 　　　 実行画面.show Me.hide End sub
(1)　デスクトップのフルスクリーンイメージを「Print Screen」でクリップボードに取り込んで、 System.Drawing.Image として宣言した変数に My.Computer.Clipboard.GetImage() で格納し、 System.Drawing.Imaging.ImageFormat.Png System.Drawing.Imaging.ImageFormat.Jpeg System.Drawing.Imaging.ImageFormat.Bmp でファイル化しました。 (2)　同じデスクトップのフルスクリーンイメージを ペイント、ワード（解像度デフォルト）、GIMPに取り込んでファイル化したデータと比較したところ、 PNGファイル以外は程度の差はあるが、何れも(1)の方が画質が悪かったです。 質問ですが、 VBでデスクトップイメージを高画質でファイル化できないでしょうか？
ブックBシート１A列の値にマッチする値をそれぞれの列にVLOOKUPでブックAシート１にある値から貼り付けたいのですがVBAコードが解る方宜しくお願いします。尚、データーが50行ぐらいあるのですが。
VBScriptでファイル名を取得して、そのファイル名(英数字)を元に文字を表示させたい。 またファイル名に使用されている文字が[1]なら[^]、[2]なら[(]、[3]なら[a]というふうに、決められた文字を反映させたい場合は、どういう作り方をすればいいのか教えてください。
各シートの同じ位置に「シート１に戻る」ボタンを付けるマクロを実行したいです。 前回教えていただいたことから、ボタンを設置するマクロはわかったのですが、 『2枚目以降のシートから、シートが終わるまで、各シートにボタンを設置する』マクロがわかりません。 1枚目は目次？的なページですので、 2枚目以降から、シートが終わるまで、決められた位置に「戻る」ボタンをつける。 という作業をマクロに記憶させたいと考えています。 ※下記は、こちらで教えていただいたものを参考にしたマクロです。 「戻る」という言葉をどこに入れてよいかもわからりません。 ・・・・・・・・・・・・・・・・・・・・・・・・・・・ Sub 戻るボタン設置() With ActiveSheet For i = 1 '幅140、高さ20のボタンを追加 .Buttons.Add(145 * i, 120, 140, 20).Text = i Next i End With End Sub
1）Excel2007＆windows7を使いマクロ作成中の初心者です。 2）シートに毎月データを追加入力し、年で締め切る表を作成しています。 3）表はF列からL列まで、6行目から580行（毎月変動）ぐらいの表です。 4）Ｈ列には、Ａ部門、Ｂ部門、Ｃ部門のいずれかの文字列が入ります。 5）Ｊ列には、平成２７年１月から１２月までの年月が入ります。 6）Ｋ列、Ｌ列には数値が入力されます。 以上が、毎月作成する表の概要です。 そして、やりたいことは、この表に基づいて、例として、２７年１月の表示される行の中の Ａ部門のＫ列の合計、Ｂ部門のＫ列の合計、Ｃ部門のＫ列の合計を知りたいことと、 Ａ部門のＬ列の合計、Ｂ部門のＬ列の合計、Ｃ部門のＬ列の合計を知りたいです。 この、合計の結果を、他のシートに表示したいです。 Excel関数でもExcel VBAでも、やりたいこと出来れば、どちらでもいいです。 =SUMIF(C17:C29,"Ａ部門",F17:F29) 同一シート内で上の関数を、利用できますが、これに２７年１月だけで集計したいです。 また、他のシートの中に表示したいです。どうしたらよろしいか教えてください。
Excel2013使用です。 現在、アクティブなセルに日付を入力する為に日付入力ボタン(DateButton)を作成しています。 内容は下記の通りです。 Private Sub DateButton_Click() ActiveCell.Value = Date End Sub ですが、間違ってボタンを押した場合に元に戻す事が出来ません。 日付入力undoボタンを作成し、間違ってボタンを押した場合に元に戻す機能を追加したいと思います。 どうかご教授ください。
下記の様に動作するマクロを組みたいのですが、自分なりにチャレンジして みましたが、意図した動作が実現できず困っています。ご教授お願い致します。 １．セルA1-A20にデータを入力。 2.予め作っておいた"確認"のコマンドボタンを押すと、入力した文字列が 　　"○○○○○-○"の7文字で構成される文字列になっているか確認し、 　　一つでも誤りがあれば"間違っています"、誤りがなければ"問題ありません" 　　と表示。※○に入る数値は、0-9の数字。 3.A1-A20のすべてのセルにデータを入力しない場合もあるので、空白が 　存在した時点でプログラムを終了。 ※私が作ったプログラムは、すべてのセルに入力しないと誤った文字列が 　　　入っているのに、"問題ありません"と表示されてしまいます。
元データ（ブックAシート１）を更新するたび 条件にあったデータを 別ブックのシートに自動的に抽出したいのですが ブックBを開いたらブックAが開きシート１の抽出をブックBシート１にコピーしたいのですがVBAコードを教えてください。 ◇ブックAシート１◇ ※元データ 　A 　　　　 B 　　　 C 　　　 D 　　　 F 1　氏名　役職　部署　年齢　移動時期　　　　　 2　山田　社員　開発　45　　未調整 3　田中　社員　人事　42　　4/1～ 4　鈴木　派遣　企画　30　　 5　高橋　役員　人事　50　　未調整 6　坂野　社員　企画　33　　未調整　　 7　井上　派遣　企画　29　　未調整 ◇ブックBシート１◇　※部署が人事で移動時期が未調整の人のみ抽出 　A 　　　　 B 　　　　C 　　　 D 　　 F 1　氏名　役職　部署　年齢　移動時期　 2　高橋　役員　人事　50　　未調整 説明が不十分で伝わりにくいかと思いますが よろしくお願いします。
こんにちは　お世話になります。 VisualBasicでpdfファイルの「パスワードによるセキュリティ」を「セキュリティなし」にして別ファイルに保存しようとしています。 ownerpasswordは分っています。 itextsharpを利用した場合、 writer.SetEncryption(iTextSharp.text.pdf.PdfWriter.STRENGTH128BITS, Nothing,？？？, Nothing) ？？？になにかを入れたら解除できるのでしょうか。 それともまったく別の方法でないとできないのでしょうか。 ご存知の方おりましたらご協力願います。
VBAでホームページの解析をしてみてます。 普通のページは解析できるんですが、検索の結果表示されるハロワのページ（https://www.hellowork.go.jp/servicef/130020.do　こんなのです）のようなものはどういうふうに読み込めばいいんでしょうか？
選択したテキストファイルをエクセルで開いたコピーし、 もう一つ開いたエクセルファイルにペーストするというマクロをVBAで 作成していますが、つまずいてしまいました。 ----------------------------------- Dim wb1 As String Dim wb2 As String Sub Opentxt() wb1 = Application.GetOpenFilename("テキストファイル,*.txt") If wb1 <> "False" Then Workbooks.OpenText Filename:=wb1, DataType:=xlDelimited, comma:=True End If End Sub Sub Copy() Dim LastRow As Long wb2 = Application.GetOpenFilename("Microsoft Excelブック,*.xls?") If wb2 <> "False" Then Workbooks.Open wb2 LastRow = wb2.Sheets("一覧表").Range("A" & Rows.Count). End(xlUp).Row wb2.Sheets("一覧表").Range("A5:A" & lastRow).Copy _ wb1.Sheets("Sheet1).Range("B33") End If End Sub ----------------------------------- Opentxtの方は問題ないですが、Copyの方を実行すると wb1とwb2で引っかかって「コンパイルエラー/ 修飾子が不正です」と 表示されて、エラーになってしまいます。 この場合変数の型などがおかしいのでしょうか？ excel2007を使用しています。 よろしくお願いします。
いつもお世話になっております。 早速ですが、現在会社で生産の進捗がわかるソフトを開発中です。 生産予定を絵として見たいのでラベルを積み重ねて表示しています。 例） 生産１　8:20~9:00　作業時間が40分なのでラベル幅40に設定 生産２　9:00~10:00　作業時間が60分なのでラベル幅60に設定し、生産１ラベルの左位置値＋生産１ラベル幅の位置を求め生産２ラベル配置 といった感じで作成しています。 この組み方の問題点は解像度の変化に臨機応変に変動しないことです。 解像度変化時等伸縮が臨機応変に変化できるような組み方何かないものでしょうか？ 教えてください。 開発環境 vb2010Express
VisualBasicでFFFTPのように外部にあるサーバーのフォルダやファイルをツリー状に表示させ操作したいのですが... FtpConnectServerでサーバーへ接続し、FtpPutやFtpGetで直接記述しての操作はできてます。 でもやはりビジュアルにやりたいのです。 どうすればいいのか、どなたか教えてください。
Visual Basicの課題で、 3+3²+3³+・・・3n乗で、500から50000の間に入る数字は 何個あるか？を求めるアプリを作らなければいけないのですが、 Do...Loop構造の繰り返し処理が理解できていないために解答 することができません。 解答と考え方をご教授いただけば大変助かります。 どうぞよろしくお願いいたします。
「kkk4 "バージョン 6" 23」 このような文字列（コマンドライン引数）をsplitで分割したいです。 ""で囲った部分は一続きとして配列に入れたいです。 なので期待としては ary(0)・・・kkk4 ary(1)・・・"バージョン 6" ary(2)・・・23 となってほしいですが、バージョンと6の間にスペースがあるので ary(0)・・・kkk4 ary(1)・・・"バージョン ary(2)・・・6" ary(3)・・・23 となってしまいます。 これを期待通りにするにはどうすればいいでしょうか？ ""は実際には後で外そうと思っています。(「バージョン 6」という文字列が必要） ""が使えないかと思って一時的につけているのです。 大変恐れ入りますが、よろしくお願いします。
VisualBasicで、現在起動中の全ての FireFoxのURLとタイトルを取得するにはどうしたらいいでしょうか？ IEのURLとタイトルは取得できました。（SHDocVw.dllなんてのを使ったサンプルがありました） VBがMSだからIEしかできないんでしょうか。
Visual Basic初心者です。演習問題に、 「1+2+3...=n<100となる最大のnを求めるアプリ。」を作成しなさい。 といったものがあり、添付画像のようにプログラムしてみたのですが、1+2+3...=n>100となる最小のnは求められても最大のnの求め方がわかりません。どうぞご教授ください。よろしくお願いします。
「LINQ」ってあまり使われてないんでしょうか。 事例を検索しても、少ないっていうかコピーしたとしか思えないような似たものばかりなんですよね。 どうなんでしょうか。
コントローパネルのディスプレイから、「デスクトップ上のテキスト～～縮小拡大」の処 小　100％ 中　125％ 大　150％ で変更ができますが、この拡大率をVBで取得する方法を教えて下さい。 アクセス2013　VBA使用です。
VisualBasic2008の「LINQ」で「SQLServer」を操作する場合、「NorthwindDataContext」というAccessの匂いのするやつは必須なのでしょうか？
vbのDataTableのselectメソッドで、年月に該当する日付検索をしたいです。 DataTable1.select(date1 = CDate('2015/01/01')) みたいな事ですが、 やりたいのは、2015年01月のものを全てという条件です。 date1の属性を年月に変換して、2015/01とイコールのものを抽出するか、 date1の属性をYYYYMMDD文字列に変換して、like '201501%' みたいな事をするのか。 postgresqlに例えると、 select * from tb1 where to_char(date1,'YYYYMMDD') like '201501%' みたいな事をＶＢのDataTableのselectメソッドでやりたいです。 よろしくお願いします。
プログラム初心者です。 VisualBasicについてご教授ください。 課題は、 TextBox1（数値）からTextBox2（数値）の間で、偶数・奇数がそれぞれ何個あるかを求めるアプリを作りなさい。といったものですが、添付画像のところで偶数の個数を出そうとしているのですが、うまく解答を出すことができません。どうぞご教授ください。よろしくお願いいたします。
VisualBasicで作ったものをホームページやブログに載せることはできるでしょうか。 たとえば、テキストボックスに時刻を表示させるだけの単純なプログラム「testtime.exe」を作り、それをホームページの一部として表示したり、ブログのサイドバーに表示させたりということです。 ご存知の方、教えてください。
osはwindows7を使ってます。以前visual basic5.0で作成したプログラムを少し直したいんですが今のosではvisual basic5.0ではエラーが出て開けません。この自作プログラムを開いて直せるソフトがあれば教えていただきませんか。visual basic6.0は６万円と高くも少し安くできたら無料のがあればと思ってますがどうでしょうか。お願いします。
エクセルを開いたらA１セルの値が５だったら２行目のA１セル値とマッチしたG2 ５の値の列が先頭列へ移動するようにしたいのですがVBAコードが解る方宜しくお願いします。
VBAでもコマンドプロンプトでもいいのですが、1000行くらいあるテキストファイルを読み込んで、キーワード「タイムアウト」を含む行の1つ手前の行の文字列を抽出、それらを1つのファイルにまとめて出力させたいのです。 VBAで自分なりにやってみたのが http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q12142881517 の最後の回答にあるマクロに手を少し加えて「タイムアウト」のある行番号をテキストファイルに出力し、その出力ファイルを読み込んで、一つ手前の行番号のリストを作ることまではできました。 ですが、どうやってそのリストから行番号を指定して、元のファイルからタイムアウトを含む行の1つ手前の行を抽出し、1つのファイルにまとめて出力させられるのかが分かりません。 後Powershellはまだ勉強途中なのですが、こっちでならできますか？ アドバイスをお願いします。
こんばんは。VB初心者です。お聞きしたいのですが、２つの異なるファイルからの情報に齟齬がないかをマクロで調べたいのですが（できればIF関数やEXACTを使わないで）、どうもうまくいきません。 例えば、下のような情報がSHEET1にある場合、 File1 Apple　　　OrangeBananaPlum　　　Mango Cucumber CarrotTomatoLettusMellon File2 OrangeApple　BananaPlumMango CucumberCarrot TomatoMellonLettus マクロを使って、下のように結果を求めたいのですが、どのワークシートファンクションを使えばいいのかわかりません。マッチングやテストもあるのですが、どうもよくわかりません。 FALSE FALSETRUE　TRUETRUE TRUE　　　TRUE TRUE FALSEFALSE 自分で少し考えてみたのですが、アドバイスをよろしくお願いします。 Sub Test() Dim lngLine As Long Dim lngTest As Long 　 Worksheets("Sheet1").Select GYO1 = Sheets("Sheet1").Cells(Rows.Count, 1).End(xlUp).Row + 1 GYO2 = Sheets("Sheet1").Cells(Rows.Count, 1).End(xlUp).Row + 2 lngTest = 0 If Len(Range("A2")) > 0 Then lngLine = Range("A1").End(xlDown).Row lngTest = WorksheetFunction.???????? End If Range(Cells(GYO1, 1), Cells(GYO1, １０００)).Value = lngTest Range(Cells(GYO2, 1), Cells(GYO2, １０００)).Value = lngTest End Sub
こんにちは。VB初心者です。二つ別のファイル（A とB)のデータを比較して、その中で一致したものを並べたいのですが、とっかかりがつかめません。 例えばですが、商店名から下のデータ（一つのエクセルファイルAのシート１）に一致するものを、 EXCEL　FILE A Sheet1 担当者　価格　　　地域　在庫商品名商店名 Bさん　　　　　　　　　埼玉　　　卵　　　佐藤屋 Cさん　　　２５０円　　　神奈川　有り牛乳　　　高橋屋 もう一つのエクセルのファイル　（下のデータ、エクセルファイルBシート１）の中から探して、商店名から比較したデータの結果をもう一つのシートに書き込みたいのですが、どうしたら情報を行ごとにマッチングできるのかわかりません（行ごとに情報が違うので）。。簡単にVLOOKUPでデータを拾うのではなく、マクロで比較したいのですが、よろしくお願いします。 EXCEL FILE B Sheet1 商店名商品名価格　　　地域　担当者在庫 山田屋みかん１００円東京　Aさん有り 佐藤屋卵　　　２００円　　埼玉　Bさん有り 高橋屋牛乳　　　２５０円神奈川　Cさん有り あと、情報をマッチングの後、情報が抜けているところ（佐藤屋の価格、在庫）を色（赤）に塗ることができますか？こちらのほうもよろしくお願いします。
・シート１ ○○No　　番号 番号の様式 000-000-000 になっています。 【メインシート】 メインのページより、 設定１ 設定２ から選択し、選択した該当（シート１より）「選択１or選択２（○○No）」のセルから 最大値を１プラスした数字を求めたい。 【シート１】 データが、「100-000-001」だった場合、 設定１を選択すると、 「100-000-002」とメインページに出力させたいと考えています。 またデータが「100-000-999」だった場合は、 数値をリセットし、「100-001-001」としたいです。 わかりづらくて申し訳ございませんが、 ご教授のほどよろしくお願いいたします。
C#でエクセルのシートを追加し、末尾に移動したいのですが Sheet1/Sheet2/Sheet3/Sheet4/ の順にならず Sheet1/Sheet2/Sheet4/Sheet3/ になってしまいます、どこが間違っているのでしょうか？ すみませんが教えていただけないでしょうか？ Excel.Application ExcelApp = new Excel.Application(); ExcelApp.Visible = false; Workbook wb = ExcelApp.Workbooks.Add(); Worksheet ws = wb.Worksheets.Add(); ws.Select(Type.Missing); ws.Cells[1, 1] = "aaa"; //末尾に移動する int totalSheets = wb.Sheets.Count; ws.Move(wb.Worksheets[totalSheets]); //saveダイアログを表示する SaveFileDialog sfd = new SaveFileDialog(); sfd.FileName = ""; sfd.Filter = "EXCELファイル(;*.xlsx)|*.xlsx|すべてのファイル(*.*)|*.*"; sfd.FilterIndex = 1; sfd.Title = "保存先のファイルを選択してください"; sfd.RestoreDirectory = true; //OKなら保存する if (sfd.ShowDialog() == DialogResult.OK) { Console.WriteLine(sfd.FileName); wb.SaveAs(sfd.FileName); } //エクセルを閉じる sfd.Dispose(); wb.Close(Type.Missing, Type.Missing, Type.Missing); ExcelApp.Quit();
チェックボックスでチェックしたらもしくはボタンを押したら指定行を非表示になるようにしたいのですがどなたか解る方よろしく願います。
エクセル２０１０にて。 行を選択した状態から、１行目から現在行の１つ上までを選択し、それを非表示とするマクロを組みたいのです。 ＶＢＡは全く分からず・・・ 変数を宣言し、その変数を代入すれば良いかと試行錯誤しましたが判らず。 Sub ３行目から現在行より上を選択して非表示() ' 　Dim x As Integer 　x = ActiveCell.Row Rows("3:x-1").Select Selection.EntireRow.Hidden = True End Sub では、全く動作せず。。 例えば２０行目を選択した状態で、マクロを実行すると３～１９行目までが非表示になるようにしたいのです。御教示下さいませ。
お世話になっております。 Windows7 Professional(64bit)のXPモード環境にVisualBasic6.0の開発環境を構築しています。XPモードの環境にクリスタルレポートをインストールしようとしたところ、下記エラーによりインストールできませんでした。 エラーメッセージ１．「序数1010がダイナミック ライブラリ CRPE32.dllから見つかりませんでした。」 エラーメッセージ２．「OCX C:\Windows\system32\crystl32.ocxを登録できません。」 インストールは、VisualStudio6.0媒体のCOMMON\TOOLS\VB\JAPANESE\CRYSREPTから実行しています。 XPモード環境にクリスタルレポートをインストールする方法をご存知でしたら、教えていただけると大変助かります。 インストールしようとしているのは「Crystal Reports for Visual Basic 6.0」で、ヘルプで見るとバージョンは4.5になっています。 よろしくお願いいたします。
みなさま お世話になります。 BatやVBSを使用して ファイル名から判断して指定のフォルダにコピーする方法についてご教授下さい。 環境・実行内容は下記になります。 【OS】 Windows7 【環境】 ＜コピー元＞ フォルダ：C:\画像 ファイル：tokyo_yyyymmddhhmmss.jpeg　～　okinawa_yyyymmddhhmmss.jpeg (各県の画像が数枚保管されています） ＜コピー先＞ 親フォルダ：D:\画像\VMD 子フォルダ：01_東京　～　47_沖縄 【実行内容】 コピー元フォルダに保存されている各県のファイルから判断し、コピー先の子フォルダにコピーしたい。 例） C:\画像\tokyo_yyyymmddhhmmss.jpeg ↓ D:\画像\VMD\01_東京 他不足情報がありましたらご指摘下さい。 よろしくお願い致します。
WindowsXPに入れたApacheをコマンドプロンプトで次のようにして必要な時だけ起動しています。 CD C:\Program Files\Apache2412\Apache24\bin httpd -k start これをVBAのWshellでやりたいのですが、エラーになってできません 下記どちらでも「Runメソッドは失敗しました」になります Sub Sample_WShell01() Dim ShellObj Set ShellObj = CreateObject("WScript.Shell") ShellObj.Run "CD C:\Program Files\Apache2412\Apache24\bin", 0, true ShellObj.Run "httpd -k start", 0, true End Sub Sub Sample_WShell01() Dim ShellObj Set ShellObj = CreateObject("WScript.Shell") ShellObj.Run "C:\Program Files\Apache2412\Apache24\bin\httpd -k start", 0, true End Sub パスを通しておけば下記でできるのはわかってますが… Sub Sample_WShell01() Dim ShellObj Set ShellObj = CreateObject("WScript.Shell") ShellObj.Run "httpd -k start", 0, true End Sub パスの通ってない状態ではできないのでしょうか、教えてください 書き方だけのような気はしますが…
Excel VBAにて、データ加工するプログラムをご教授ください。 環境はWindows7 Pro Excel2010 添付データのsheet1をsheet2の状態にするロジックです。 ・sheet1、sheet2は別シート ・sheet1の列は最終行までという形　何行あるかは不明で連続したデータが入っている。
VB CommunityでRS232C通信プログラムを作成しています。 OKWaveをみて、ポート接続などはできたのですが、 データ送信でつまづいてます。 16進数をバイナリ変換し送信したいのです。 その部分ですが、16進数で[11]をバイナリに変換して送信したい場合、 Dim command(0) As Byte command(0) = &H11 SerialPort1.Write(command, 0, 1) としても、16進数で[11]を送ったときの動作を行いません。。 VectorなどでのRS232通信テストツールでは反応あるのですが。。 初歩的ですみませんが、よろしくお願いします。
ブラウザを操作するVBAが私のPCでは正常動作するのに別のPCでは424のエラーがでます。 エクセルからブラウザを操作してフォームの登録作業を自動化するマクロを組みました。 フォームにある名前・年齢・住所・・・などの項目を、複数分エクセル入力しておき、入力と登録を繰り返させるというものです。 ここで問題なのが、私のPC2台(エクセル2013と2003)でテストしたところ正常動作したのですが、依頼主のPC(エクセル2013)で実行すると、オブジェクト云々の424エラーが出るということでした。 検索してみたところ、2014年末のアップデート後からマクロが動かなくなるような現象もあるそうだったので、そこにある解決策の通り%temp%からExel8.0のフォルダーを削除したりもしたのですが、改善されませんでした。 解決策をご存知の方はなにとぞご教示をお願いします。
エクセル初心者ですので、どなたか教えて下さい！ お客様からの商品注文リストの作成をしています。 その中で、お客様の郵便番号から該当する支店を入力する欄があります。 今は1件1件郵便番号で支店の検索をして、紙に控え、手入力しています。 毎月1000件程の注文があるので、 エクセルで作ったリストの郵便番号を入力したら、自動的に検索サイトへ行き、 該当支店をエクセルの支店名欄に反映できないものかと悩んでおります。 郵便番号検索のような一覧があればシートにはりつけるのですが、 残念ながら有りません。 店の閉店や開店が目まぐるしいので常に検索して確認の必要があります。 ちなみに郵便番号で検索すると、 1つの郵便番号に対して複数の支店が混在している場合もあります。 このような場合、エクセルでは難しいのでしょうか？
お世話になります。 VB.Netで作成されたプログラムＡがあります。 VB6.0で作成されたプログラムＢがあります。 プログラムＢはイベント待ち状態になっており、特定のイベント（ボタンクリックイベント等）で特定のプロシジャーを実行するようになっております。 プログラムAからプログラムBの特定のイベントを発生させる、もしくはプログラムBの特定のプロシジャーを実行させる方法を探しております。 前回同じような質問をさせていただきましたが、こちら側からWindowsイベントとVB6.0のイベントの指定の説明が抜けておりましたので、改めて質問をさせていただきます。 何卒よろしくお願い申し上げます。
Excel VBAにて、テキストファイルから文字列を選別して、それをエクセルファイルのテキストボックスに張り付けるコードの記述をご教授いただけますでしょうか。 環境はWindows7 Pro Excel2010 下記テキストファイルです。 test.txt IDENTIFICATION DIVISION. PROGRAM-ID. sample AUTHOR. XXX * ENVIRONMENT DIVISION. INPUT-OUTPUT SECTION. FILE-CONTROL. SELECT A ASSIGN TO B SELECT C ASSIGN TO D DATA DIVISION. FILE SERECTION. この FILE-CONTROL.と DATA DIVISIONの間に挟まれている SELECT A ASSIGN TO B SELECT C ASSIGN TO D この2行を取り出して、エクセルファイル上にあるテキストボックス張り付ける処理です。 よって、FILE-CONTROL.と DATA DIVISION.の間にある不特定多数の行を抽出するロジックです。 テキストボックスに張り付ける前の行を抽出するだけでも、ご教授頂けたら幸いです。 よろしくお願いします。
お世話になります。 Windows98で開発したVB5のプログラムが現在もXPで動いています。 ９８で作成したのは当方ですが、XPへ移したのは別人です。 で、先日実行中にエラーが出たということでソースをみようとしたところVBがエラーで立ち上がらず見ることがでなかったので、 他のXPのPCへVB５へインストールし、そちらにソース、データを移し、コンパイルしたところ、エラーが出て先へ進みません。 場合１）　参照設定：　DAO 3.51 の場合、DBEngine.Workspaces(0)　でエラー 場合２）　参照設定：　DAO 3.6　の場合、コンパイルはできるが書き込みの時点で、 「このコンポーネントのライセンス情報が見つからない。デザイン環境でこの機能を使うためのライセンスがない」　とのエラー 場合２）で、MaskEdBox の参照をはずし、ソース、ホームからも削除してみたが同じエラーがでます。 尚、DBList, DBguridなど使用しています。 何かしらお気づきの点があればアドバイス、よろしくお願いします。
皆さんこんにちは。 エクセル2013使用しているVBA初心者です。 エクセルVBAでコードをど根性&こちらで質問させていただいた時のご回答を元に 作成してみたのですが思うような動作になりません。 下記のコードが美しくないのも重々承知しておりますが 下記内容で修正するべき個所を教えていただけないでしょうか。 やりたい事は ・ユーザーフォーム5でフレームが2個あり 　1個は作成書類を7個から1つ選択 　もう1個は支社を7個から１つ選択 　→「次へ」のボタンを押すと「○○と△△支社を選択しています。お客様情報に～」のメッセージ表示 　→OK→処理を続行します→OKならユーザーフォーム4（お客様情報）を開く 　　キャンセル→処理を中断します→ユーザーフォーム5を再度表示して選択し直せるように・・・ 　 という事をやりたいのですが知識不足の上いくら参考書等を探しても これだ！というものにたどりつけずに困っています。 「○○と△△支社が選択されています」の箇所も myMSG & vbCrLf & "と" & myMSG & だと「△△と△△支社が選択されています」に なってしまうのは理解出来ているのですが代わりにいれるコードも分かりません。 また、「メッセージ表示のOK」を押して「処理を続行しますのキャンセル」を押しても ユーザーフォーム5に戻ることはなくユーザーフォーム4に 進んでしまう始末です。 毎度拙い質問文で申し訳ございませんが どうか皆様のお知恵をお借りできないでしょうか。 ※コードはコマンドボタン1（次へ）に書いてあります。 ---------------------------------------------------------------------------------- Private Sub CommandButton1_Click() Dim myMSG As String Dim i As Integer For i = 1 To 14 If Me.Controls("OptionButton" & i).Value = True Then myMSG = Me.Controls("OptionButton" & i).Caption End If If (OptionButton1 Or OptionButton2 Or OptionButton3 Or OptionButton4 Or OptionButton5 Or OptionButton6 Or OptionButton7) = False Then MsgBox ("作成する書類を選択して下さい") Me.Hide UserForm5.Show End If If (OptionButton8 Or OptionButton9 Or OptionButton10 Or OptionButton11 Or OptionButton12 Or OptionButton13 Or OptionButton14) = False Then MsgBox ("支社を選択して下さい") Me.Hide UserForm5.Show End If Next i intRtn = MsgBox(myMSG & vbCrLf & "と" & myMSG & "支社" & vbCrLf & "が選択されています。" & vbLf & _ "お客様情報に移動します。", _ vbOKCancel + vbExclamation + vbDefaultButton2, _ "作成書類選択") If intRtn <> vbOK Then MsgBox ("処理をキャンセルしました。") Me.Hide UserForm5.Show End If intRtn = MsgBox("処理を続行します。", vbOKCancel + vbExclamation + vbDefaultButton2, _ "作成書類選択") Unload UserForm5 UserForm4.Show If intRtn <> vbOK Then MsgBox ("処理をキャンセルしました。") Me.Hide UserForm5.Show End If End Sub Private Sub UserForm5_QueryClose(Cancel As Integer, CloseMode As Integer) 'Formが閉じるとき If CloseMode = 0 Then '×ボタンを押された場合 End 'プログラムの実行を終了 End If End Sub
皆さんこんにちは。 エクセルVBAの初心者です。 選択画面に戻るためのコードが足りていない感じなのですが・・ ご教授をお願いします。 ※エクセル2013を使用しています。 ユーザーフォーム1で作成書類を5種類から選択するようにしました。 選択後、「次へ」のボタンを押すと 『○○が選択されています。支社選択画面に移動します。』という メッセージが出るようにコードを作りました。 「OK」を押せば次の選択画面が開くように今後作っていく予定なのですが 「キャンセル」を押すとユーザーフォーム1が画面から消えるようになってしまっています。 やりたい事は「キャンセル」を押し『処理をキャンセルしました。』と メッセージが出た後に 最初のユーザーフォームで作成書類を選択し直すところに戻りたいのです。 私が作成したコードを記載しますので どこがどう間違っているのか、何が足りないのか ご教授いただければ幸いです。 ----------------------------------------------------- Private Sub CommandButton1_Click() Dim myMSG As String Dim i As Integer For i = 1 To 5 If Me.Controls("OptionButton" & i).Value = True Then myMSG = Me.Controls("OptionButton" & i).Caption End If Next i intRtn = MsgBox(myMSG & vbCrLf & "が選択されています。" & vbLf & _ "支社選択画面に移動します。", _ vbOKCancel + vbExclamation + vbDefaultButton2, _ "作成書類選択") If intRtn <> vbOK Then MsgBox "処理をキャンセルしました。" End End If intRtn = MsgBox("処理を続行します。", vbOKCancel + vbExclamation + vbDefaultButton2, _ "作成書類選択") If intRtn <> vbOK Then MsgBox "処理をキャンセルしました。" End End If End Sub
excel2010を使っています、VBA勉強中の初心者です教えてください。 随時データ量の変化するsheet1があります。 sheet1 A2からデータの入ってる最終行、R列までをコピーし、 sheet2 A列：R列まで、最終行に貼り付けをしたいのでご教授ください sheet1, sheet2ともに行１にタイトルがあります
お世話になります。 VB6.0で開発されたプログラムとVB.Netで開発されたプログラムがあります。 それぞれはプログラム上で何の関連もない独立したプログラムです。 ＰＣの起動時にこの2つのプログラムが起動するものとして、お互いのフォーム上に それぞれの名前のついたボタンを配置したとして、ボタンをクリックすると もうひとつのプログラムがカレント（画面上に表示される）にすることは可能でしょうか？ Alt + Tab で切り替えるやり方は存じておりますが、上記のような事が可能であれば そのやり方をお教えいただけますようお願い申し上げます。
VBAからIE９のタブ機能を操作しようと悪戦苦闘しております。 詳しく申し上げると、最前面に表示されているIEの アクティブなタブを確実につかんだうえで、 そのページのDOMを操作したいです。 色々調べていったところ、IAccessibleインタフェースの 中にあるaccStateプロパティを見れば、タブがアクティブになっているかどうか 判別できるところまでたどり着きました。 以下のページを参考にしました。 http://mt-soft.sakura.ne.jp/kyozai/excel_apps/tab-ctrl/index-jump.html?pg_02.html ※C#を多少かじったので、クラス等の知識は微量ですがあります。 上記のサイトを参考に実際にコードを組んでいたのですが、 AccessibleオブジェクトとIEオブジェクトを行き来する方法が わからず、せっかくタブの状態がわかっても それをメインのコードに反映することができません。 Accessibleオブジェクトの階層を上のほうまで辿って行けば、 IEオブジェクト(Shell Windowオブジェクト？）にたどり着く？ ということも考えたのですが、辿り方がわからず頓挫しております。 最前面のIEはFindWindow関数でハンドルを取得し、 それをAccessibleインターフェイスに渡す方法で accStateを取得しています。 Sub ie_find() Dim IE As Object Dim hWnd As Double hWnd = FindWindow("IEFrame", vbNullString) 'タブのリスト Dim TabList() 'タブリスト作成 MakeTabList hWnd, TabList For i = 0 To UBound(TabList) If TabList(i).accState(CHILDID_SELF) = 2097154 Then Next i ’ここにいれる処理がわかりません。 ’IEオブジェクト⇔Accessibleオブジェクトの ’方法があれば処理できると思います。 End Sub Private Sub MakeTabList(hWnd As Double, ByRef TabList()) ' ' タブ一覧生成 ' Dim hWndChild As Long Dim Cnt As Long, i As Long Dim ClassName As String Call Class_Initialize 'AccessibleオブジェクトのUUID設定 hWndChild = GetDirectUIHWND(hWnd, "CommandBarClass") 'IE9以前 If hWndChild = 0 Then hWndChild = GetDirectUIHWND(hWnd, "WorkerW") 'IE10以降 If hWndChild = 0 Then Exit Sub Dim objAcc As IAccessible, v AccessibleObjectFromWindow hWndChild, OBJID_CLIENT, IID_IAccessible, objAcc If Not (objAcc Is Nothing) Then Dim Children() As Variant Dim Count1 As Long, Count2 As Long Dim retCount As Long Count1 = objAcc.accChildCount ReDim Children(Count1 - 1) Call AccessibleChildren(objAcc, 0, Count1, Children(0), retCount) '子オブジェクト For i = 0 To objAcc.accChildCount - 1 If TypeOf Children(i) Is IAccessible Then If Children(i).accRole(CHILDID_SELF) = ROLE_SYSTEM_PAGETABLIST Then 'タブ行？ Count2 = Children(i).accChildCount ReDim TabList(Count2 - 1) 'タブの一覧を生成　「タブ」と「新しいタブ」のボタン Call AccessibleChildren(Children(i), 0&, ByVal Count2, TabList(0), retCount) Exit For End If End If Next i End If End Sub Private Function GetDirectUIHWND(hWnd As Double, ClassName As String) As Long ' ' DirectUIHWND のウィンドウハンドルを取得 ' Dim hWndChild As Long hWndChild = FindWindowEx(hWnd, 0, ClassName, vbNullString) If hWndChild <> 0 Then hWndChild = FindWindowEx(hWndChild, 0, "ReBarWindow32", vbNullString) If hWndChild <> 0 Then hWndChild = FindWindowEx(hWndChild, 0, "TabBandClass", vbNullString) If hWndChild <> 0 Then hWndChild = FindWindowEx(hWndChild, 0, "DirectUIHWND", vbNullString) GetDirectUIHWND = hWndChild End Function Private Sub Class_Initialize() 'AccessibleオブジェクトのUUID設定 With IID_IAccessible .Data1 = &H618736E0 .Data2 = &H3C3D .Data3 = &H11CF .Data4(0) = &H81 .Data4(1) = &HC .Data4(2) = &H0 .Data4(3) = &HAA .Data4(4) = &H0 .Data4(5) = &H38 .Data4(6) = &H9B .Data4(7) = &H71 End With End Sub どうかこの辺詳しい方、ご教示よろしくお願いいたします。
IFERROR(INDEX(***,MATCH(***)),"")この式を下記マクロに組み込むことは、可能でしょうか？ Sub　Macro1() ' Dim　line3　As　Integer Dim　line5　As　Integer line5　=　2　　'初期値を２行目に設定してます Do　While　Worksheets("Sheet5").Cells(line5,　1).Value　>　0 'sheet5の通し番号をsheet3のH列から検索して、その行数をline3に代入する。 　　line3　=　Worksheets("Sheet3").Range("H:H").Find(what:=Worksheets("Sheet5").Cells(line5,　8)）.Row 'A,B列内容のコピー 　　Worksheets("Sheet5").Range("A"　&　line5,　"B"　&　line5).Copy　Worksheets("Sheet3").Cells(line3,　1) 'D～G列内容のコピー 　　Worksheets("Sheet5").Range("D"　&　line5,　"G"　&　line5).Copy　Worksheets("Sheet3").Cells(line3,　4) 　　line5　=　line5　+　1　　　　'次の行へ Loop 　　（　http://soudan1.biglobe.ne.jp/qa8921867.html　）
現在Excel2003を使っています。 説明が苦手なのでどう言えば伝えられるか分からないのですが。 ちょっとした自作カードを作っていて、(図参照)C7セル内に打ち込まれた文字列をクリップボードにコピーし、一番右端○の画像ファイル内にテキストボックスを作成させた黄色枠内に、 先程クリップボードでコピーした内容をテキストボックスをアクティブにし、文字列として貼り付けるとゆうマクロを作成しています。 ------------------- Sub を() ' ' を Macro ' マクロ記録日 : 2015/2/27 ユーザー名 : Owner ' ' Range("C7").Select ActiveCell.FormulaR1C1 = "C7" ActiveSheet.Shapes("Rectangle 27").Select Selection.Characters.Text = "C7" With Selection.Characters(Start:=1, Length:=2).Font .Name = "ＭＳ Ｐゴシック" .FontStyle = "標準" .Size = 11 .Strikethrough = False .Superscript = False .Subscript = False .OutlineFont = False .Shadow = False .Underline = xlUnderlineStyleNone .ColorIndex = xlAutomatic End With Range("D6").Select --------------------------- とゆうプログラムとなっており、この場合だとSelection.Characters.Text = "C7" の""間のC7と文字列が入ります。ここを""にすると空白ですし、 そこでIF関数を用いて ""の場合は何もしない ""に何か入力(C7セル内に入力)されたときのみ、C7セルない文字列をクリップボードにコピーしその内容を右端の画像内テキストボックスに貼り付けるとゆうふうなプログラムを作成するには、参考としてどのように書いたらよろしいのでしょうか？ クレクレ内容みたいで申し訳なく思いますが何とぞ教えていただけませんでしょうか。
２３歳OLです。 VBAと正規表現についての質問です。 ▼やりたいこと ================================================ 1 | 0 |1234567890 | 2014-2-22 22:22:22.06+09 という数列から 1234567890　という数字のみを抜き出したいです。 正確には２本目の|と３本目の|の間に入っている様々な数字です。 ※桁数が固定されていません。 ================================================ ▼実際書いたコード ================================================ Sub Sample2() Dim RE, strPattern As String, i As Long, msg As String, reMatch Set RE = CreateObject("VBScript.RegExp") strPattern = "☆この部分☆" With RE .Pattern = strPattern .IgnoreCase = True .Global = True For i = 1 To 10 Set reMatch = .Execute(Cells(i, 1)) If reMatch.Count > 0 Then msg = msg & reMatch(0).Value & vbCrLf End If Next i End With MsgBox msg Set reMatch = Nothing Set RE = Nothing End Sub ================================================ ☆この部分に☆に何を入れればよいでしょう？ ご指導よろしくおねがいします。
VBAで三井住友銀行にログインしたいのですが、 どうやらマウスで一度、画面をクリックして、色を反転させないとログインボタンを押下しても文字が入力されたと認識されないようです。 「契約者番号」の部分のテキストボックスが灰色になっていますが、 これは点店番号を入れると灰色になります。 ＶＢＡで店番号のテキストボックスに値を入れても、「契約者番号」のテキストは灰色になりません。 こういう場合、ｖｂａでテキストボックスをアクティブにする方法はありますか？
ＰＣ　ほぼ素人です。ネットで調べて、下記のコードを作成できました。 バージョンは2007 Sub 抽出() Worksheets("Sheet5").Activate Worksheets("Sheet5").Range(Cells(1, 1), Cells(328, 18)).Clear With Worksheets("Sheet3").Range("A8") .AutoFilter Field:=1, Criteria1:=Worksheets("Sheet3").Range("a2") ''(1) .AutoFilter Field:=2, Criteria1:=Worksheets("Sheet3").Range("b2") ''(1) .CurrentRegion.SpecialCells(xlVisible).Copy Worksheets("Sheet5").Range("A1") ''(2) .AutoFilter ''(3) End With Worksheets("Sheet5").Activate End Sub Ｓｈｅｅｔ5に抽出後、そのデータを書き換え　Ｓｈｅｅｔ3へ戻したいのですが可能なのでしょうか？ 　　　　　Ａ　　Ｂ　　　　　　Ｃ　　　　　Ｄ　　　　　　Ｅ　　　　　　Ｆ　　　　　　Ｇ 　　1　　月　　日　　　得意先　　　前回　　　　数量　　　　今回　　　　数量 　　2　　3　　　5　　　　Ａ商事　　　1月15日　　　2　　　　　2月5日　　　3 　 抽出後、Ｓｈｅｅｔ3には、ABDEFGを戻したいのです。 説明不足かもしれませんが、どうか宜しくお願い致します。　　　
いつもお世話になります。 パワーポイント２００７を使用しております。 それぞれのページ番号の表記を、 ページ番号/総ページ数 にしたいのですが、方法はありますでしょうか。
マクロ（excel2013）の方で、指定フォルダに指定ファイルを配置しておけば、 自動でワークシートに読み込んで表示する、という設定にしたいです。 宜しくお願いします。
データベースから抽出したExcelの人材情報リストから、VLOOKUP関数で情報を射影して、指定した人材を数人分連続で印刷するマクロを設定して、定型のプロフィールシートを作成しました。  改良したい点として、人によって情報量が異なる項目があるので、特定の行（例えば5行目）の高さのみを自動調整するようにしたいのですが、どのようにすればよいでしょうか。  VLOOKUP関数を使用しているからか、書式から行の自動調整を設定してみても１行の高さになってしまいます。  マクロで一度に印刷できるようにしたので、一枚一枚レイアウトを修正しなくてもいいようにしたいです。  VBA初心者ですので、宜しくお願いします。
１日１回だけ特定セルをリセットしているのですが、データファイルを複数で共有しているので、２回以上押してしまうことがあります。 現在は、特定のセルをリセットするためのリセットボタンを押すとボタンの色が変わるようにマクロを組んでいるのですが、それでも、２回押す場合があります。 問： リセットスイッチを１日１回だけアクティブになるようにするにはどうしたらよいのでしょうか。（リセットスイッチを１回押すと、日付が変わらないと再度アクティブ状態にならないようにする。） よろしく、ご指導お願いいたします。
2005から2010への移植で下記SQLが正しく動作しなくなりました。 select count(*) from [テーブル名] where [条件] レコードが5件あるはずなのに0が返ります。 サーバエクスプローラからクエリを発行すると正しい値が返ります。 プログラム自体は2005で正しく動作しているので、 ロジック的には間違っていないと思います。 バージョンが変わる事でコードの修正が必要になるのでしょうか。
Sub test() Dim db As Database と宣言しているコードがあるのですが、 いきなり使えなくなりました。 コンパイルエラー プロジェクトではなく、ユーザ定義関数を指定してください。 というエラーになります。 http://oshiete.goo.ne.jp/qa/465366.html を参考に 「Microsoft DAO X.X Object Library」（X.Xはバージョン） にチェックを入れようとすると 「この名前は既にあるモジュール、プロジェクト、オブジェクトライブラリで使われています」 になります。 オブジェクトブラウザーで「db」を検索すると Excel.WorksheetFunction のメンバー にdbというメソッドがありました。 Dim db As Database のdbという名前が原因かなと思い、dbを違う名前に変えてみても同じです。 win8、アクセス２０１０です。 原因わかる方ご回答よろしくお願いします。
VBA初級者です。 エクセルで自動設定されたグラフ系列色（点のみ、線なし）の RGBを取得するにはどうしたらいいのでしょうか？ 系列色を設定する方法は以下のようにすればいいようですが。。。 ActiveSheet.ChartObjects("グラフ 1").Activate ActiveChart.SeriesCollection(1).Select 　　 With Selection .MarkerBackgroundColorIndex = 色番号 / xlAutomatic .MarkerForegroundColorIndex = 色番号 / xlAutomatic 　　　または、 　　　 .MarkerBackgroundColor = RGB(?,?,?) .MarkerForegroundColor = RGB(?,?,?) End With 私がやりたいことは、上のような記述でxlAutomaticで自動的に設定された ある系列の色を他の系列にも適用したいのです。もう少し具体的に言うと、 系列1，2、系列3，4、のように隣り合う系列を同色にしたいのです。 系列数が少なければ各組合せに対してRGBを設定すればいいのですが、 系列が大量になってきますと、自分でRGBを設定するのも大変で、 系列１，３，５・・・に関しては、xlAutomaticで自動設定して、その色を 系列２，４，６・・・に適用しようと思ったのですが、よくわかりませんでした。 ActiveChart.SeriesCollection(1).Select　 With Selection .MarkerBackgroundColorIndex = xlAutomatic Color = MarkerBackgroundColorIndex End With ActiveChart.SeriesCollection(2).Select　 With Selection .MarkerBackgroundColorIndex = Color End With などとしてみましたがダメでした。恥ずかしながら基礎を 理解できていないので詳しく説明していただけると幸いです。 よろしくお願いいたします。
皆さんこんにちは。VBA素人のモノです。 ※エクセル2013使用しております。 表題の通り、別シートの名称を置換に利用したいのですが うまく組めないのでご教授ください。 シートには「4月」というシートと 「関数」というシートがあり、「関数」シートには「4月」を参照する関数が 山盛りに入っています。 月が替わった時にボタンを押すと 「4月」シートをコピーし、「5月」シートを作成→ 「4月」シート内に入っている関数を全て値にする・・ という所までマクロを組みました。 次に行いたいのが「関数」シート内にある関数の参照先を '4月'!から'5月'!にしたいのです。 単に4月から5月に置換するだけなら簡単だったのですが これが毎月行われるとなると難しくて挫折してしまいました。 自分の頭の中では、参照先のシートを 「関数」シートの 「2つ左のシート」→「1つ左のシート」にして 関数シート内を文字を置換をすれば良いのかなぁ？という ぼんやりとしたイメージがあるのですが こんなマクロをどうやって組めば良いのか さっぱり見当がつきません。 こんな拙い説明で申し訳ないのですが 上記のイメージをマクロに出来るのであれば 教えていただけると幸いです。
Excelvba 2010のVBAについてご教授願います。 Sheet1にある楕円の図形をSheet2の結合セルの個所にコピーしたいのですが、 コピーできません（貼付できていないといった方が良いのかも）。 但し、コピー先の結合セルには文字が入っており（「有」という文字）、 この文字はそのまま残した方法で楕円の図のみ文字の上に上書きというか 文字にかぶせたいのです。 コードは以下の様に記述しました。 WorkSheets("Sheet2").Activate Worksheets("Sheet1").Shapes("楕円").Select Selection.Copy ActiveSheets.Range("EE120").MergeArea.Select ActiveSheet.Paste
Excel2003を使っています。 ユーザ定義を使ってセルへの入力をします。 例えば、 セルB1に　AB1111 セルC1に　AB2222 セルD1に　AB3333 セルE1に　AB4444 セルF1に　AB5555 と入力します。 4桁の数字の前に"AB"が決まって付くので、ユーザー定義 "AB"##0000 を使って数字4桁だけ入力するようにしました。 そしてさらに、 エクセルVBAを使って、変数iに AB1111 を格納したいのですが、iには 1111 しか取得できません。 iに AB1111 を取得したいのですが、どなたか方法を教えてください。 よろしくお願いします。
Excel2010 VBAについて、ご教授をお願い致します。 １つのセルに入力されている文字列の変更について以下の様に変更したいのですが、簡単にできる方法はございますか？ （色々と試しましたが、うまくいきません。） 　　　既内容　　　　　　　　　　　　　　　　→　変更後内容 　・「、」(読点)＋改行（読点は半角を含む）　→　読点だけにする(改行を削除) 　・「。」(句点)＋改行（句点は半角を含む） →　句点だけにする(改行を削除) 　・「,」 (半角のカンマ)＋改行　　　　→　半角のカンマだけにする(改行を削除) 　・「.」 (半角のピリオド)＋改行　　　→　半角のピリオドだけにする(改行を削除) 　・改行（のみ）　　　　　　　　　　　→　読点（、）にする。 以下にサンプルを記述します。 ☆元データ あああ、（改行） おおお（改行） いいい。（改行） ううう,（改行） えええ.（改行） ☆求める結果の内容（「おおお」の次の文字「、」は改行を置換え） あああ、おおお、いいい。ううう,えええ. よろしくお願いいたします。
Excel VBAで日付データがA列、通貨データがB列にあるとして シート１のセル(A:1)、セル(B:2)が空白セルとして条件式を作りたいのですが記述方法はどのようになりますか? 下記でよろしいでしょうか? If CDate(sheet1.cell(A:1).value) = Empty then If CCur(sheet1.cell(B:1).value) = Empty then
ExcelVBA をExcel2007で苦戦している初心者です。 マクロ記載のＡブックとＢブックを使っています。 Ａブックのユーザーフォーム「表紙」にあるボタンをクリックして Private Sub CommandButton11_Click() 表紙.Hide Workbooks.Open Filename:=ThisWorkbook.Path & "\改善案.xlsm" Sheets(1).Select End Sub Ｂブック（改善案）に飛び、作業後これを閉じ、Ａブックに戻したいです。 Ａブックは、まだ閉じてはいません。 同時に、ユーザーフォーム「表紙」を再表示したいです。 Private Sub CommandButton2_Click() Unload UserForm1 Application.DisplayAlerts = False ThisWorkbook.Close Application.DisplayAlerts = True 表紙.show End Sub すると次のエラーが表示され 「コンパイルエラー　変数が定義されていません」 表紙.showの表紙が反転表示されます。 Ａブックに戻ったときにユーザーフォーム「表紙」を表示するには どうしたらよろしいでしょうか。よろしくお願いします。
Excel 2007 VBAを使用しています。 下記のようなことを考えています。 1. テキストボックスにyyyy/m形式の日付データを入力 2. ボタンシートのコマンドボタンを押下。 3. テキストボックスの日付データを確認 4. 商品シートの列値、日付データ(A列)、商品番号(B列)、商品名(C列)、状況(D列)から条件に 該当した行を結果シートに行コピー。 　 ただし、日付データ(A列)には日付データ以外にも文字列データ、"未定"、空白セル("")などがございます。 そして、商品シートの3行目のベッダー情報は先頭に置いて、その下に該当行を行コピーしていく。 質問; 解らないのは、同じif文で日付データと文字列データとの処理です。 テキストボックスのyyyy/m形式の日付データを基にその日付以降の該当する行を別のシートに コピーしていくのですが、参照元の商品シートの日付データ(A列)には他に文字列データが存在します。 この文字列データも抽出の対象にしたいのです。 あと、テキストボックスのyyyy/m形式の日付データは半角入力しますが全角入力されたとき エラー表示させる方法はありますか? これらの処理を行うにあたりサンプルなるコードはありませんか? 商品シートの3行目のベッダー情報は先頭に置いて、その下に該当した行を行コピーしていく。 1. 商品シート; 注文日付商品番号商品名状況 2010/9312000 ノコギリ受取済み 2014/5 　　 542000ハンマーn/a 未定 544000トンカチn/a (空白セル)542000ハンマーn/a 2014/11312000 ノコギリ注文中 ・ ・ 2. ボタンシートで、日付データを入力(2014/5)、実行ボタンを押下。 条件は2014/5以降で、状況が"受取済み"、"注文中"以外の行データをコピーして状況が未確定のリストを作成します。 そして、注文日付が"未定"、空白セル("")の行データもコピーします。 そして、順次、結果シートに行コピーしてします。 結果シート; 注文日付商品番号商品名状況 2014/5 　　 542000ハンマーn/a 未定 544000トンカチn/a (空白セル)542000ハンマーn/a ・ ・ VBAコード; Option Explicit Private Sub CB2_Click() '変数を定義 Dim i As Long Dim maxRow As Long Dim cnt As Long Dim inSheet As Worksheet Dim outSheet As Worksheet '入出力先のシートをオブジェクト変数へ格納 Set inSheet = Worksheets("商品シート") Set outSheet = Worksheets("結果シート") 'テキストボックスの内容を判定 '全角入力されたときエラー表示させる方法はありますか? If (Me.TextBox1.Value = "") Or (Not IsDate(Me.TextBox1.Value)) Then MsgBox "日付が正しく入力されていません" Exit Sub End If maxRow = inSheet.Cells(Rows.Count, "A").End(xlUp).Row '商品シートの最終行番号で分岐処理 If maxRow > 3 Then '出力先を削除してヘッダーをコピー outSheet.Cells.Delete inSheet.Range("A3").EntireRow.Copy outSheet.Range("A1") Application.CutCopyMode = False Else '4行目以降にデータが入力されていなければメッセージで終了 MsgBox "該当データがありません" Exit Sub End If '4行目から最終行まで繰り返し For i = 4 To maxRow 'ここからが上手くいきません。 'If IsDate(inSheet.Cells(i, "A").Value) Then 'フィルター条件; 'A列 注文日付 → 2014年05月以降、未定、(空白セル) 'D列 金額 → 受取済み、注文中以外 If inSheet.Cells(i, "A").Value >= CDate(Me.TextBox1.Value) And _ CStr(inSheet.Cells(i, "A").Value) = "未定" And _ CStr(inSheet.Cells(i, "A").Value) = "" And _ CStr(inSheet.Cells(i, "D").Value) <> "受取済み" And _ CStr(inSheet.Cells(i, "D").Value) <> "注文中" Then inSheet.Rows(i).Copy outSheet.Rows(cnt + 2) cnt = cnt + 1 End If 'End If Next i End Sub
Excel2010 VBAについてご教授願います。 あるセルに以下の様な内容が有ったとします。 （数字の部分は変動しますが、数字5桁＋「-」＋数字3桁＋「-」数字3桁の 　フォーマットとします。 　改行も変動します。） セルの内容 12345-678-001　あああ。（改行） 12345-678-002　いいいいい12345-678-003ううう。（改行） 23456-789-010　えええ。23456-789-011　おおおおおおお（改行） 34567-890-123　かか 上記から以下の様なレイアウトで文字を取得したいと思います。 Split関数等を使用すればできるのかな、とも思いますが、 どの様に作成したらよろしいのか分かりません。 次のデータの ニューメリック5桁 - ニューメリック3桁 - ニューメリック3桁のレイアウトが 発生した時点でニューメリックのデータから前の文字までを取得するという 方法が取れればよろしいでしょうけれども、これが出来ないという事であれば 判定する方法とすれば、数字部分を変数等で与える事になろうかと思いますが、 この数字部分も変動します。 12345-678-001　あああ。 12345-678-002　いいいいい 12345-678-003ううう。 23456-789-010　えええ。 23456-789-011　おおおおおおお 34567-890-123　かか
あるセル範囲（例えばB1:G1)にそれぞれ数値が入力されていたとします。 入力ダイアログでその範囲を指定し、その範囲内の数値の合計値を表示するマクロを作りたいのですが、やり方が分かりません。 セル範囲を入力させるプログラムはこれで合っていますか？ Sub セル範囲の合計() Dim 範囲 As Range 範囲 = appllication.InputBox(prompt:="セル範囲は？", Title:="セル範囲", Type:=8) End Sub ここからどのように変えればいいでしょうか？
Excel 2007を使用しています。 下記のようなことを考えています。 1. テキストボックスにYYYY/M形式の日付データを入力 2. コマンドボタンを押下。 3. 日付データを確認 4. オリジナル(sheet1)の列値、日付データ(A列)、商品番号(B列)、商品名(C列)から条件に 該当した行をサマリー(sheet2)にコピー。 オリジナルの3行目のベッダー情報は先頭に置いて、その下に該当行を付ける。 オリジナルデータ; 注文日付商品番号商品名 2010/9312000 ノコギリ 2011/12　　 542000ハンマー ... ... 2014/5312000 ノコギリ サマリー; 注文日付商品番号商品名 2010/9312000 ノコギリ 2014/5312000 ノコギリ ご質問; 1. 上記3、4の処理はコマンドボタンのクリックイベント処理として、まとめて 記述すれば 良いのでしょうか? 2. 日付データのオブジェクト名を"TextBox1"として、コマンドボタンのクリックイベント処理 など、これらの処理を行うにあたりサンプルなるコードはありませんか? 　 オリジナルの行数は変動します。 3. ユーザーフォームを作らずにシート上(shhet1)にテキストボックス、 コマンドボタンを作成できますか? 　 ありましたら方法を教えてください。 以上、宜しくおねがいします。
EXCELでシフト表を作成していますが次の操作をVBAで処理したいと考えていますが初心者で難しく教えて頂きたく宜しくお願いいたします。 1.sheet1でB1～AF1に日付、A2～A15に名前、日ごとに担当者を決め役割を記号(1)、(2)、（1）、（2）、等の記号をセルに入れてAさんは1日には(1)2日は(2)とこんな感じでシフト表を作成しています 2.Sheet2のB1～AF1に日付、A2に(1)、A3に（１）、A4に(2)～と記号を入れ、シフト表の逆で例えば1日の(1)は誰が担当者かを分かるようにSheet1のシフト表からSheet2のセルに担当者を代入する表を作りたいのです（ここの構文を教えて頂きたい）。Range("A1").Valueでお願いしますRC形式だと分からないのです勝手で説明が下手ですいません、何卒宜しくお願いたします。
VB.net 2010での質問です。 外部テキストファイルを読み込んで、フォーム上のコンボボックスに入れるのは簡単にできましたが、 ボタンを押したときに、選んだコンボボックスの該当データのうち一部だけを取り出して他データとからめつつ処理して表示させたいのです。 テキストファイルが以下のようになっています。データ件数は多くはありません。 阿部,北海道,10001,2001/05/01 山崎,東京都,11111,2003/09/25 ボタンを押した時には、別のテキストボックスに 山崎 - 10001 と表示させたいのです。贅沢を言えば、コンボボックスには人名のみが表示されるようにできれば素晴らしいです。 どうかよろしくお願いします。
生年月日（F3：F187）から85歳6か月になる人を（I3:I187)に☆を入力する構文を教えてください。 sheet名は入力です。よろしくお願いします
VBAを使っていて ユーザーフォーム上にボタンを二つ配置します。 ボタン1を押すとsub 1が実行されます。 このプログラムで出力された変数を ボタン2で実行するsub 2で使いたいのですが どうすれば良いですか？ sub 1の中でcall subを使ってプログラム2を呼び出すということはしたくないのですが このsub を終了しても変数が消えないようにするには ワークシートのセルに代入するか ユーザーフォームのテキストボックスなどに代入するしかないでしょうか？ この変数を外に出さずに隠さずに保存しておき 次のsub で使いたいのですが 何か良い方法はないでしょうか？
Excel上のVBAで資料作成をおこなっているのですが、一部、どうしたら良いのかわかりません。 アドバイスをお願いいたします。 ■やりたいこと 　・Excelの一覧表で、行ごとに1番大きい値と2番目に大きい値を取得する。 　・取得する際、項目名（1行目にある値）も併せて取得する。 　・取得数の上限は2件のため、1番目、2番目がそれぞれ複数ある場合、 　　あらかじめ用意してある、優先順位の表にしたがって上位2件を取得する。 ■例 　・図のような成績表があった場合、取得結果は以下を想定しています。 　　Aさん→国語：100、英語：90 　　Bさん→数学：100、社会：90 　　Cさん→国語：80、数学：60 　※ 　　・Aさん： 　　　・最大値→国語：100 　　　・2番目→英語：90 　　　最大値、2番目ともに、そのまま取得でOK。 　　・Bさん： 　　　・最大値→数学：100 　　　　そのまま取得でOK 　　　・2番目→理科と社会の90 　　　　優先順位で社会が上位にあるため、社会を取得。 　　・Cさん： 　　　・最大値→国語と英語の80 　　　　優先順位で国語が上位にあるため、国語を取得。 　　　・2番目→数学と理科の60 　　　　優先順位で数学が上位にあるため、数学を取得。 よろしくお願いします。
Powerpointをコンテキストメニューに「読み取り専用」を追加するために以下のVBscriptを起動すると前面表示されません。 どうしたら前面表示されますでしょうか？ 起動コマンド wscript.exe "C:\Program Files\Microsoft Office\Office14\OpenPptAsReadOnly.vbs" "%1" 以下がVBscript（OpenPptAsReadOnly.vbs）です。 Dim strPPTFileName Dim objPPTApp '引数のチェック If WScript.Arguments.Count <> 1 Then WScript.Quit 'ファイル名取得 strPPTFileName = WScript.Arguments(0) '起動 Set objPPTApp = WScript.CreateObject("Powerpoint.Application") objPPTApp.Visible = True '読み取り専用で開く Call objPPTApp.Presentations.Open(strPPTFileName,True) '終了処理 Set objPPTApp = Nothing WScript.Quit
コマンドラインソフトのffmpegを使って、動画の再生時間などを取得したいのですが VBAでコマンドプロンプトの結果を変数に代入する方法について教えてください。 "D:\xxxx\ffmpeg\bin\ffmpeg" -i "d:\xxxx\aaff.mp4" 2>&1 | grep Duration これをコマンドプロンプトで実行すると d:\xxxx\aaff.mp4の再生時間などがコマンドライン上に表示されます。 これを変数に代入するために、 http://officetanaka.net/excel/vba/tips/tips27.htm このページを参考にして Sub Sample1() Dim WSH, wExec, sCmd As String, Result As String Set WSH = CreateObject("WScript.Shell") ''(1) sCmd = """D:\xxxx\ffmpeg\bin\ffmpeg"" -i ""d:\xxxx\aaff.mp4"" 2>&1 | grep Duration" Set wExec = WSH.Exec("%ComSpec% /c " & sCmd) ''(3) Do While wExec.Status = 0 ''(4) DoEvents Loop Result = wExec.StdOut.ReadAll ''(5) MsgBox Result Set wExec = Nothing Set WSH = Nothing End Sub を実行しました。 しかしResultには何の文字列も代入されませんでした。 恐らく、このページのタイトルにもあるように「MS-DOSコマンドの標準出力を取得する」 とあるので、標準出力しか取得できないのではないかと思います。 それでは一般的なコマンドラインソフトの実行結果を変数に代入するにはどうしたら良いでしょうか？
毎度お世話になります。m(__)m 例えばHドライブにある全フォルダを同じ階層を保ったまま フォルダだけ、Kドライブに作成するということは 可能でしょうか？ H:\未完成\D001512.xls H:\未完成\A027739.xls H:\完成\製造\M124.xls H:\完成\営業\S117.xls とあったとすると K:\未完成 K:\完成\製造 K:\完成\営業 とこんな感じにバシャッと．．． そんなこと夢物語ですかね．．． よろしくお願いします。
エクセルで別のエクセルファイルをマクロで取込み、取込したデータを自動で任意の場所にデータが入力されるようなものを作りたいと考えています。 csvデータの取込は作ることが出来たのですが、エクセルファイルをcsvデータのように取込することは出来ないでしょうか？ 出来ないとしたら、取込したいエクセルファイルを一度csvで保存してからcsvとして取込するというやり方で対応するしかないでしょうか？ 出来れば、取込したいエクセルファイルのシートが複数にわかれていて、全シートの情報を取込したいと考えているので、エクセルのままで全シート取り込めれば・・と思います。 何か上記の方法でなくとも、最善の方法（一番工数が少なく済む方法）があれば教えていただきたいです。 よろしくお願いします。
webページのソースコードを検索して、検索した文字列に続く3文字を取得したいです webページのソースコードが下記だと仮定します （ソースコード） 　　AAA 　　ABC＊＊＊ 　　BBB 　　CCCAAA ABC　という文字列を検索して、＊＊＊という変数を取得したいです ＊＊＊の部分は毎回変わる、英数字のランダムな文字です 説明が下手で申し訳ありません どの様に取得すればよいかわかりません どうぞよろしくお願い申し上げます
VBScript初心者です。 IEを起動し、さらに表示倍率を変更したいのですが、 方法がわからずとても困っています。 ウィンドウの大きさではなく、表示倍率です。 ご教授よろしくお願いいたします。
MenuStripのメニュー「ヘルプ」（説明書き）をクリックするとWindowsフォームのTextFile1.txtを表示させたいのですが、どのようなコードを書けば良いのでしょうか。宜しくお願いいたします。
宜しくお願いします。 山川谷.BATをダブルクリックすれば、 クリップボードに、”山”をコピーし、続いて、”川”、”谷”を順次コピーする様な コードをお教え下さい 『谷』のみをクリップボードにコピーするコードは見つかりました （　SET /P<NUL="谷"|clip　）　が、知識が無く、応用が全く利きませんので お教え下さいます様、宜しくお願い致します。
よろしくお願いします ユーザーフォームに決定ボタンで、テキストボックスを任意の数追加しました。 追加されたテキストボックスにD1.D2.D3.D4・・・と名前をつけ、それぞれに 1.2.3と数値を記入し、 登録ボタンをクリックした後ワークシートkeyplanの 指定したセルD30～G30へ代入させようとしたところ、 「変数が定義されていません」となってしまいます。 Nameの付け方が悪いのでしょうか。転機の仕方が悪いのでしょうか。 マクロを勉強し始めて日が浅いので、対処の方法がわかりません。 ご回答よろしくお願いします。 Option Explicit Private Sub UserForm_Initialize() worksheets("keyplan").Select End Sub Private Sub 決定_Click() Dim txt As Variant Dim i As Integer 'テキストボックスを配置 i = nyuryokubox() For i = 1 To i Set txt = Me.Controls.Add("Forms.Textbox.1", , True) With txt .Width = 20 .Height = 18 .Top = 300 .Left = 1 + (.Width + 80) * (i + 1) .BorderColor = &H666666 .BorderStyle = fmBorderStyleSingle .Font.Size = 15 .Name = "D" & i End With Next End Sub Private Sub 登録_Click() With worksheets("keyplan").Select .Range("D30").Value = D1.text .Range("E30").Value = D2.text .Range("F30").Value = D3.text .Range("G30").Value = D4.text End With End Sub 変数　i　にはテキストボックス(nyuryokubox)に直接数値を入れるようにしています
いつもお世話になっております。 ファイルの移動についてです。 A列にファイルの一覧があります。 この一覧にあるファイルを全てTドライブのフォルダに同じ配下で移動したいのです。 A列 ファイル S:\未完成\data\DA00001146.xls S:\未完成\test\data\DA00001147.doc S:\未完成\test\DA00001148.ppt 逆スラッシュは実際には半角の￥で表示されています。 ファイル T:Sドライブ\未完成\data\DA00001146.xls T:Sドライブ\未完成\test\data\DA00001147.doc T:Sドライブ\未完成\test\DA00001148.ppt movefile を使うとFileObjectSystemを使うことになり 私には変数をどのように設定していいかわかりません。 Sub test() Dim FSO As Object Set FSO = CreateObject("Scripting.FileSystemObject") ''C:\Tmp\フォルダ内の*.xlsをC:\Work\フォルダに移動します FSO.MoveFile "C:\Tmp\*.xls", "C:\Work\" Set FSO = Nothing を探してきて、何とかしようと思ったのですが、うまく 使えませんでした。 ご教授ください。 よろしくお願いします。
VB.net 2010 の質問です。 配列変数を他のプロシージャに引数で渡す際の、配列変数の要素数をあらかじめ宣言していないとエラーになります。 Dim Hairetsu() As String '　←エラー Dim Hairetsu(100) As String '　←正常 Public Sub aaa(ByRef Hairetsu() As String) Hairetsu(0) = "Test" '←正常の場合と、エラーの場合 End Sub Hairetsu(100) のように、要素数を宣言していると、エラーにならないのですが、 プログラム中、要素数がどこまで増加するか、分かりません。 Hairetsu()のように、要素数未確定の配列変数を渡すことは出来ないのでしょうか。 ご存知の方がいらっしゃいましたら、なにとぞアドバイスの程、よろしくお願いいたします。
ACCESS VBAで以下のような指定でインポートを行っています。 DoCmd.TransferDatabase acImport _ , "Microsoft Access" _ , S_FileName _ , acTable _ , hairetu(j) _ , hairetu(j) _ , False インポートは正常にできるのですが、テーブルのプロパティの説明の記述が消えてしまいます。 消えなくする方法はありますか？ できなければ、プログラムで付与する方法はありますか？
例えば、下記のCallでプロシージャProc1を実行した後に、そのCallで例外(HRESULT からの例例:0x800A01B6)が発生します。 Call Proc1(a, b, c) デバッグモードでこのCallにストップをかけ実行します。停止した後に1ステップごとに実行を進めるとと、Proc1が正常に終了した後、このCallで例外が発生したと報告されます。 環境は、Windows 7、VB 2010 Express、IE 11です。 何が起こっているのでしょうか？
ブックBシート炉の１月１日の横にある入力ボタンでブックAシート総括の日付のマッチ（ブックBのA3とブックAのA2）したらブックBの１月１日のB3:C7がブックAのA1:B7にコピーしたいのですがどなたかVBAコードが解る方お願いします。 同様に順に１月２日の横にある入力ボタンでブックAへコピーしたいのですが。
ExcelVBAで手入力し忘れた場合、毎日指定時刻（17:00:00）に前日のセル内容をコピーしたいのですがお解りになる方よろしくお願いします。 １月１日、１月２日は手入力してますが、１月３日当日17:00:00までに入力し忘れた場合（空白）自動マクロで１月２日の内容をコピーし、毎日当日の同指定時刻になればマクロ実行に設定したいのですが。
　Form1にButton1とTextBox1、TextBox2、TextBox3を配置します。 TextBox2はMultiLineにします。 プログラムを実行し、１度目は4などを入れ「Enterキー」を押し、間違えます。 TextBox3には「不正解」と表示されます。 次に、textbox2に正解の3を入れ「Enterキー」を押しても「正解」とは表示されません。 私の頭では「正解」と表示されると思うのですが、どこがおかしいのでしょうか。 　もう一つ、TextBox2はEnterキーを押したときの「ピン」という警告音が出ないようにMultiLineにしていますが、MultiLineにせず、警告音を消す方法はありますか。宜しくお願いいたします。 　以下はコードです。 Dim Problem As String Dim RightAnswer As String Dim Answer As String Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load problem = "1+2=" RightAnswer = "3" End Sub Private Sub TextBox2_PreviewKeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.PreviewKeyDownEventArgs) Handles TextBox2.PreviewKeyDown If e.KeyCode = Keys.Enter Then Answer = Me.TextBox2.Text If Answer = RightAnswer Then Me.TextBox3.Text = "正解" Else Me.TextBox2.Text = "" Me.TextBox3.Text = "不正解" Me.TextBox2.Focus() End If End If End Sub Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Me.TextBox1.Text = Problem Me.TextBox2.Focus() End Sub
vb.netでIEを制御するアプリを作成するために、それに必要な知識をネット上で収集しています。 下記のコードを部分的に借用させて頂こうとしていますが、行番号31のDebug.Printで出力される内容が"http://www.yahoo.co.jp/"ではなく、"about:blank"です。どうしてでしょうか？ 1 Public Class Form1 2 Private Const IE_MAX As Integer = 5 3 Private Const NAV_OPEN_IN_NEW_TAB As Integer = &H800 4 Private Const NAV_OPEN_IN_BACKGROUND_TAB As Integer = &H1000 5 6 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click 7 8 'IE起動＆タブを５つまで開く 9 Dim objShell As Object = CreateObject("Shell.Application") 10 Dim objIE As SHDocVw.InternetExplorer = _ 11 CreateObject("InternetExplorer.Application") 12 Dim count As Integer 13 Dim ieList As New List(Of SHDocVw.InternetExplorer) 14 objIE.Visible = True '可視 15 While count < IE_MAX 16 If count = 0 Then 17 objIE.Navigate("about:blank") 18 Else 19 objIE.Navigate("about:blank", NAV_OPEN_IN_BACKGROUND_TAB) 20 End If 21 System.Threading.Thread.Sleep(1000) 'ある程度の時間Sleepしないと、異なるタブで開けない 22 ieList.Add(objShell.Windows.Item(objShell.Windows.Count - 1)) 23 count += 1 24 End While 25 Application.DoEvents() 26 27 'タブ１と２でサイトを表示 28 ieList.Item(0).Navigate("http://www.google.co.jp/") 29 ieList.Item(1).Navigate("http://www.yahoo.co.jp/") 30 31 　　　 Debug.Print(ieList.Item(1).document.URL) 32 33 End Sub 34 End Class 環境は、Windows 7、VB 2010 Expressです。 ご教示の程、よろしくお願い致します。
オラクル(11.0)とACCESS2010において ODBC接続をおこない　クエリでデータを抽出しました。 データ件数(6千件ほどあります） そのクエリより、外部エクスポート　機能によりCSVファイルを作成したいのですが テキストウィザード（ODBC接続に失敗・・・）が表示され　ウィザードが開きません また、データ件数30件程度で、実行すると、正常にウィザード画面が開き、エクスポート 定義画面が表示され、スムーズに処理を行うことができます。 上記の操作が成功した際には、VBA　TransferTextコマンドにて対応したいと考えて おります。 なにが、要因でなるのか不明です。
Excelsheet1VBAコードに下記に記載されておりA列全てのセルクリックでカレンダーが表示されますがA1セルクリックのみカレンダー表示するにはどのようにコードを変更すれば良いかお願いします。 Private Sub Worksheet_SelectionChange(ByVal Target As Range) ' 複数セル選択時は無視 If Target.Count <> 1 Then Exit Sub ' A列以外は無視(今回サンプルの例) If Target.Column <> 1 Then Exit Sub ' カレンダーフォームを起動する Call ShowCalendarFromRange(Target) End Sub
VBAにてsheet2より sheet1 A1日付に合致した日付の内容を添付のようににコピーしたいのですがよろしくお願いします。
以下のようなものをマクロで組むことは可能でしょうか？ エクセルのマクロについての質問です。 デスクトップの発注書集計というフォルダの中に、店舗1～店舗19のエクセルファイルがあります。 この店舗1～店舗19までの数値を同じフォルダ内にある発注書まとめというファイルにまとめたいです。 シート数とシート名は毎回違います。 集計の仕方は以下の通りです。 各店舗ファイルのシート名と発注書まとめのシート名が同じシート(例えば各店舗ファイルのSheet1の値は発注書まとめのSheet1にまとめます)に以下の範囲の値と書式(セルの色)を貼り付けます。 店舗1 各シートのC59:68を発注書まとめ各シートのC59:68に貼り付け 店舗2 各シートのD59:68を発注書まとめ各シートのD59:68に貼り付け 店舗3 各シートのE59:68を発注書まとめ各シートのE59:68に貼り付け 店舗4 各シートのF59:68を発注書まとめ各シートのF59:68に貼り付け 店舗5 各シートのG59:68を発注書まとめ各シートのG59:68に貼り付け 店舗6 各シートのH59:68を発注書まとめ各シートのH59:68に貼り付け 店舗7 各シートのI59:68を発注書まとめ各シートのI59:68に貼り付け 店舗8 各シートのJ59:68を発注書まとめ各シートのJ59:68に貼り付け 店舗9 各シートのK59:68を発注書まとめ各シートのK59:68に貼り付け 店舗10 各シートのL59:68を発注書まとめ各シートのL59:68に貼り付け 店舗11 各シートのM59:68を発注書まとめ各シートのM59:68に貼り付け 店舗12 各シートのN59:68を発注書まとめ各シートのN59:68に貼り付け 店舗13 各シートのO59:68を発注書まとめ各シートのO59:68に貼り付け 店舗14 各シートのP59:68を発注書まとめ各シートのP59:68に貼り付け 店舗15 各シートのQ59:68を発注書まとめ各シートのQ59:68に貼り付け 店舗16 各シートのR59:68を発注書まとめ各シートのR59:68に貼り付け 店舗17 各シートのS59:68を発注書まとめ各シートのS59:68に貼り付け 店舗18 各シートのT59:68を発注書まとめ各シートのT59:68に貼り付け 店舗19 各シートのU59:68を発注書まとめ各シートのU59:68に貼り付け シート数が多くかなり時間を取られてしまいます。 この集計作業を何とか軽減したいです。 何卒ご教示お願い致します。
こんにちは。 エクセルでの名前定義ですが、通常、下記のように、セル番地を使用すると思いますが、 配列を使用することは出来ないのでしょうか？ ActiveWorkbook.Names.Add Name:="test", RefersToLocal:="=Sheet1!$A$1:$B$2" 下記のようなマクロを作り実行しましたが、うまくいきませんでした。 Dim ABC(0 to 1) ABC(0) = 1 ABC(1) = 2 ActiveWorkbook.Names.Add Name:="test", RefersToLocal:="=ABC" ご指導のほど宜しくお願いいたします。
エクセルのマクロについての質問です。 複数のシートのデータを一つのシートにまとめるマクロを使用しています。 以下のものになります。 Sub まとめ() Dim i As Long, ii As Long ii = 1 With Worksheets .Add before:=.Item(1) For i = 2 To .Count .Item(i).Range("BX6:CQ15").Copy .Item(1).Cells(ii, "A") .Item(i).Range("C59:U68").Copy .Item(1).Cells(ii, "U").PasteSpecial Paste:=xlPasteValues ii = ii + 10 Next i End With Application.CutCopyMode = False Range("1:1").Insert Sheets(2).Range("BX5:CQ5").Copy Sheets(1).Range("A1") Sheets(2).Range("C58:U58").Copy Sheets(1).Range("U1") Columns("B").SpecialCells(xlCellTypeBlanks).EntireRow.Delete Sheets(1).Columns("C:D").Delete Sheets(1).Columns("F:G").Delete Sheets(1).Columns("G:O").Delete End Sub このマクロを使用してまとめたシートの数値の部分（各シートのC59:U68のデータを貼り付けた部分、まとめたシートのH2のセルが起点です）を変更するとコピー元（各シートのC59:U68）の数値も同じように変わるというものを作りたいです。 いろいろと調べましたが手も足も出ませんでした。 ご教示いただけないでしょうか？ 宜しくお願いいたします。
http://oshiete.goo.ne.jp/qa/8858627.html このページでVBAのGDI+を使った8bitや24bitの画像の取扱方にについて教えていただきました。 追加の質問なのですが 画像を読み込んで画像のビット数を調べるにはどうしたら良いですか？ 8bitなのか24bitなのか？ それと読み込んだ画像のdpiを取得する方法および dpiを設定して画像を保存するにはどうしたら良いですか？ 検索して調べてみましたが見つかりませんでしたので ご助言いただけないでしょうか？ 　
VBAを使っています。 htmlファイルを読み込んで href="http://www.xxxx.html" の http://www.xxxx.html このURLの部分だけを順番に抽出し配列に保存するプログラムを書きたいのですが どのように書けば良いですか？
VBAに関する質問です。 複数のテキストファイルを読み込んで 指定した文字列を別の文字列に検索・置換してくれるプログラムを作りたいと考えています。 これをするためには一度 Set MyTxt = FSO.OpenTextFile(StrPath, 1) Do While MyTxt.AtEndOfStream = False hairetu(xxx) = MyTxt.ReadLine loop のようにしてテキストデータを全て配列に読み込み、 Replace関数で一つずつ検索・置換した後に Open StrPath For Output As #1 Print #1, hairetu(xxx) のようにしてファイルを出力し直すしかないですか？ 配列に読み込まずに 既存のファイルを直接編集する方法を教えてください。
師も走りまわる１２月。。皆様（師）も走りまわっていることでしょう。 私は。。。走りません、はい。 本題です。 ExcelのVBAでToggleButtonを排他的に使いたいのです。 調べるとオプションボタンになさいと書かれてはいるのですが・・・。 ワークシート上にToggleButton1～3があります。 １を押す（凹）と“処理A”，もう一度押す（凸）と“処理Ｚ” 2　　同上　　　 “処理Ｂ”，　　同上 3　　同上　　　 “処理Ｃ”，　　同上 以下のコードでなんとなく動くのですが，排他的動作の際には，TrueなToggleButton#の動作をおこなってしまいます。 Excel2007,Windows7です。 師の皆様の良い御提案が御座いましたら御教示下さい。 ----ボタンがあるシートモジュールに記載---------------------------------------- Option Explicit Dim strCode As Variant Private Sub ToggleButton1_Click() If ToggleButton1.Value = False Then strCode = "処理中Ｚ" ' Debug.Print "ＡからＺに戻します。" Else strCode = "処理中Ａ" ' Debug.Print "Ａを押しました。" ToggleButton2.Value = False ToggleButton3.Value = False End If 'Debug.Print "Ａでの処理をします。" Call 処理(strCode) 'Debug.Print "Ａから処理をしました。" End Sub Private Sub ToggleButton2_Click() If ToggleButton2.Value = False Then strCode = "処理中Ｚ" ' Debug.Print "ＢからＺに戻します。" Else strCode = "処理中Ｂ" ' Debug.Print "Ｂを押しました。" ToggleButton1.Value = False ToggleButton3.Value = False End If 'Debug.Print "Ｂでの処理をします。" Call 処理(strCode) 'Debug.Print "Ｂから処理をしました。" End Sub Private Sub ToggleButton3_Click() If ToggleButton3.Value = False Then strCode = "処理中Ｚ" Else strCode = "処理中Ｃ" ToggleButton1.Value = False ToggleButton2.Value = False End If Call 処理(strCode) End Sub Sub 処理(strCode) Dim i As Long Dim Start As Single Dim Finish As Single Start = timer i = 0 'Application.ScreenUpdating = False Application.Calculation = xlCalculationManual For i = 1 To 1000 i = i + 1 Cells(2, 1).Value = strCode & i Next i Application.Calculation = xlCalculationAutomatic 'Application.ScreenUpdating = True Cells(1, 1).Value = strCode Finish = timer Cells(3, 1).Value = Format$(Int((Finish - Start) * 10 ^ 4 + 0.5) / 10 ^ 4) End Sub --------------------------------------------------------------------------- おまけ： 　上記サンプルを作ってみましたが，ToggleButton1だけ相対的に処理速度が速いです・・・。 なぜなんでしょう？？
任意の関数式を入れるとグラフを描くプログラムを作りました。表示するのに時間がかかる（といっても1秒程度ですが）ので「計算中！」と赤で表示させ、グラフが描き終わると消したいと思い、グラフ開始時にLabel2.Visible=True、終了時にLabel2.Visible=Falseを付けましたが、思惑通りには行きません。何故でしょう。おわかりになる方、教えてください。
VBAを使っていて 関数fffに引数として配列aaaを入れたいとします。 通常 fff(aaa) と指定するところですが fff(aaa()) と括弧を付けて指定する場合もあるようです。 このように括弧を付けるのはどういう理由があったでしょうか？
.NET2005です。既存のプロジェクトを「名前を付けて保存」はできないのでしょうか。お願いします。
配列の使い方について教えてください １つの配列をどんどん追加したりしたいので１つの mybox　で追加していきたいと思っています。 （下記コードが実現できればと思います。） (1)配列を広げ追加したい (2)繰返しを使わず一気に書き込みたい (3)一部をクリアしたりしたい のですがよろしくお願いします。 Sub Macro1() Range("A1").Value = "A" Range("A2").Value = "B" Range("A3").Value = "A" o = Range("A1").End(xlDown).Row mybox = Range(Cells(1, 1), Cells(o, 1)).Value 'myBox(1,1)=A 'myBox(2,1)=B 'myBox(3,1)=A ←このような表示になります。 '------------------------------------------------- '(1)配列を広げ追加したい ReDim Preserve mybox(o, 2) For i = 1 To UBound(mybox) If mybox(i, 1) = A Then mybox(i, 2) = 0 Else mybox(i, 2) = 1 End If Next i '------------------------------------------------- '(2)(1)をＣ列に「myBox(?,2)を「繰返しを使わず一気に」書き込みたい 'Transposeは限界（65536個）を超えるので使えません。 Range(Cells(1, 3), Cells(UBound(mybox), 3)) = mybox '(3)配列myBox(？,1)は残したままmyBox(？,2)はクリアにしたい End Sub
VS2010を使用 メールサーバーはExchangeを利用 参照設定でImports Microsoft.Office.Interop.Outlookを追加済 単にOutlookの投票ボタンのオプション（承認、却下）を入れてメール送信したいのです。 ググりまくりましたが的を得た頁が見つからず悩んでおります・・
VisualStugio.Net2003でソースコードを記述しており、コード内でSQLのSELECT文を実行して、実行結果をDataTableに格納する処理をしています。 今回、とあるテーブルに対し２パターンのSQLを実行し、それぞれの実行結果を１つのDataTableに格納したいのですが、どのようにすれば良いでしょうか？ 自分で調べたところ、先に実行したSQL結果に、後から実行したSQL結果を１行ずつ追加するといった方法は見つかりましたが、１行ずつではなく、一括で追加する方法が知りたいです。 前提として、２回のSQL実行では、同じテーブルの同じ項目をSELECTしております。 下記に簡単ですがコード記述の概要を補足しておきます。 ・コード記述概要 【変数宣言】 Dim DB1 As DataTable Dim DB2 As DataTable 【SQL文1】 SELECT A,B,C FROM テーブル１ WHERE 条件文１ DB1 = SQL文1の実行結果 【SQL文2】 SELECT A,B,C FROM テーブル１ WHERE 条件文２ DB2 = SQL文2の実行結果 【DB1にDB2のデータを追加】←ここのやり方を知りたいです DB1 = DB1 + DB2 よろしくお願いいたします。
VBを活用していきたく、勉強を始めました。 （N88-BASICはずっと前に使っていました。） 下記URLを参考に、線を描くことに挑戦したのですがうまくいきません。 状況は以下の通りで、原因がわからず困っているのですが、誰かしっている人いたらお願いします。 ・Visual Basic 2010 Expressを使用 ・下記URLを参考に 　e.Graphics.DrawLine(Pens.Red, 50, 60, 100, 150) 　をForm1.vbに記述してF5キーで実行したらエラー一覧に 「'Graphics'は'System.EventArgs'のメンバーではありません。」 との表示が出てきてしまします。 参考URL http://homepage1.nifty.com/rucio/VBStandard/vbstandard2.htm
VBAを使用してWebサイトにログインを行いたいのですが、ログインをする際に必ず新規セッションでウィンドウを起動してログインするようにするにはどのようなコードを組めばいいのでしょうか？ 下記のようなコードで現在は動かしているのですが、explore.exe -noframemergingで起動すれば新規セッションでIEを開けるとのことだったのですが、上手く組み込むことができません・・・。 どのようにすれば上手く動くのでしょうか・・・。 申し訳ありませんがどなたかご教授願います。 '========================================= sub ろぐいん() '変数 Dim IE As Object Dim UserID As String Dim UserPass As String 'ID,PASS設定 UserID = "ID" UserPass = "PASS" 'IE起動 Set IE = CreateObject("InternetExproler.Application") IE.Visible = True '接続 IE.navigate "http://" '文字入力 IE.document.gatelementbyid("ID").Value = UserID IE.document.gatelementbyid("PASS").Value = UserPass '送信 Call IEButtonClick(IE, " 送信 ") Set IE = Nothing End Sub 'クリック Public Function IEButtonClick (ByRef IE As Object, ButtonValue As String) Dim ObjInput As Object For Each ObjInput In IE,document,getelementsbytagname("INPUT") If ObjInput,Value = ButtonValue Then ObjInput,Click Exit For End If Next End Function '=========================================
様々なサイトを参考にして、自分でマクロを作り、うまく動作したまではいいのですが、不勉強で不備があるかどうか自分では判断できません…。 どなたか不備を指摘してはいただけないでしょうか。 内容：指定したフォルダ内のフォルダ名を、一行ずつ間を空けて書き出す。 Public Sub make_FolderList_02() ' FileSystemObjectを作成する。 Dim Obj As Object Set Obj = CreateObject("Scripting.FileSystemObject") ' フォルダ名をシート上に出力する為のカウンタ Dim cnt As Long cnt = 0 ' 「C:\Sample」フォルダ配下に存在するフォルダを一つずつ参照する。 Dim f As Object For Each f In Obj.GetFolder("C:\Users\test\Desktop\test").SubFolders ' フォルダ名をシート上に出力する。 Range("A1").Offset(cnt, 0).Value = Obj.GetFolder(f).Name cnt = cnt + 1 ' 空白セルを出力する。 Range("A1").Offset(cnt, 0).Value = Null cnt = cnt + 1 Next f Set f = Nothing ' 別のフォルダを書き出す Dim a As Object For Each a In Obj.GetFolder("C:\Users\test\Desktop\nyannko").SubFolders ' フォルダ名をシート上に出力する。 Range("A1").Offset(cnt, 0).Value = Obj.GetFolder(a).Name cnt = cnt + 1 Range("A1").Offset(cnt, 0).Value = Null cnt = cnt + 1 Next a Set a = Nothing ' オブジェクトを破棄する。 Set Obj = Nothing End Sub ここでは、２つのディレクトリを書き出していますが、実際には、６～７つ書き出す予定です。 また、参照先を共有フォルダにした場合、過剰な負荷が掛からないかどうかも、教えていただけると嬉しいです。 大変無駄の多い内容だとは思いますが、ご指導のほどよろしくお願いいたします。
日時をFormat関数を使って所望の書式に変更したいのですが http://excelvba.pc-users.net/func/func3.html このページにあるようになぜかmmには 月と分という二つの異なるものが割り当てられています。 yyyymmdd のようにyyyyやddと一緒に書くと月となり、 mmのように単体で書いても月になり、 hh:mm:ss　のようにhhやssと一緒に書くと分として扱われます。 では、 分だけを単体で取り出したい場合にはどうしたら良いのでしょうか？ yyyymmss とかに年と時間を混ぜたらどうなるのでしょうか？ 月と分をちゃんと使い分ける方法があれば教えてください。
下記の図表【事前】のA列に時間（シリアル値）が入力されていますが、 これをマクロを使って不要な時間帯のデータを行ごと削除したいです。 それを実行するためのマクロをご教示頂けますでしょうか？ 削除対象の条件 ・9:00:00～18:00:00以外の夜間や早朝の時間帯は削除する。 その他 ・データが入力されている行数分繰り返し処理 ・秒数、分数は全て0 ・列は3列（B、C列は任意） ・Excelのバージョンは2007 【事前】 　　A　　　　　　　　　　　　　　　　　　　　　　　B　　　　　　C １ yyyy/mm/dd 01:00:00　※削除対象 ２ yyyy/mm/dd 23:00:00　※削除対象 ３ yyyy/mm/dd 09:00:00 ４ yyyy/mm/dd 15:00:00 ５ yyyy/mm/dd 17:00:00 ６ yyyy/mm/dd 19:00:00　※削除対象 ７ yyyy/mm/dd 04:00:00　※削除対象 【事後】 　　A　　　　　　　　　　　　　　　　　　　　　　　B　　　　　　C １ yyyy/mm/dd 09:00:00 ２ yyyy/mm/dd 15:00:00 ３ yyyy/mm/dd 17:00:00
数値をソートする方法にはバブルソートやクイックソートなどがあり アルゴリズムは分かるのですが 文字列を五十音順にソートしたい場合にはどのようにしたら良いですか？ 検索をかけてみたのですが、大抵プログラミング言語に備わったsortの方法が紹介されており 自分で処理を行う方法については書かれていません。 ExcelのSort機能を使わない方法で教えてください。
http://oshiete.goo.ne.jp/qa/8852322.html http://oshiete.goo.ne.jp/qa/8856128.html このページで画像の配列への入出力の仕方を教えていただきました。 配列の読み書きの方法が分かればできるかと思ったのですが やり方がわかりませんでしたので質問いたします。 24あるいは32bitの場合には教えていただいた方法で問題ないのですが 8bitの画像（インデックスカラー画像）の場合にはどうしたら良いでしょうか？ 8bit画像を GdipCreateBitmapFromFile(ByVal StrPtr(strInName), pSrcBitmap) で取得し、そのまま GdipSaveImageToFile pSrcBitmap, StrPtr(strOutName), encTIFF, VarPtr(udtEncParam) を使って、別の画像形式に再圧縮して出力しても 8bit画像として出力されるので、 pSrcBitmapにはインデックスカラーに関する情報と 256階調（8bit）での画像情報も含まれているようです。 しかしながら、 GdipBitmapGetPixel pSrcBitmap, x, y, myARGB で画像情報を抽出すると 8bit画像を読み込んだとしても 32bitカラー情報として抽出されてしまいます。 http://www.vbforums.com/showthread.php?718163-GDI-GdipGetImagePixelFormat-(untrusted) このサイトにPixelFormatの設定の仕方が書かれてあって、 PixelFormat24bppRGB = &H21808 を用いると24bit画像として出力できることが分かりました。 PixelFormat8bppIndexed = &H30803 を指定してみたのですが、 一応、8bit画像として出力することは確認できたのですが 出力にものすごく時間がかかってしまうのですが。 恐らくインデックスを生成するのに時間がかかっているのだと思うのですが 既にインデックスがでている場合にどのように指定すれば良いか、 8bit画像からインデックスを抽出するのかが分からないのですが。 どのようにすれば インデックスカラーと256階調（8bit）での画像情報を 配列に読み込み、および配列から画像への書き出しを行えますでしょうか？
http://oshiete.goo.ne.jp/qa/8852322.html このページで、 配列から直接圧縮画像ファイルを出力する方法を教えていただきました。 次は圧縮画像ファイルから配列を読み取るプログラムを作りたいと考えています。 http://tanlab.blog.fc2.com/blog-entry-31.html このページで画像ファイルをメモリに読み込む方法は書かれていて、 GdipCreateBitmapFromFile(ByVal StrPtr(file1), image) で変数imageに読み込むことができます。 このimageを上記のページの変数pDstBitmapに回すことで、 読み込んだ画像を別の画像として出力できることがわかりました。 いまやりたいことは 変数imageあるいは変数pDstBitmapを配列に書き出すことなのですが どうやれば良いでしょうか？ これらの変数はLongとして定義されていて、 型が配列ではないのですが どのようにして扱えば良いのでしょうか？ 一応、検索などして調べてみましたが 分かりませんでしたので教えてください。
VBAについての質問です。 Excel2013を使っています。次のような場合に不具合があります。 sheet１上にフェオームコントロールのボタンを配置し、ユーザーフォームを呼び出します。 ユーザーフォームにはコマンドボタンを配置し、コードは　Worksheets("Sheet2").Select　です。 実行すると、Sheet2に画面は変わりますが、セルに何かを入力すると、入力したはずのものがすぐ 消えて、しまいます。スクロールもできません。 実際には　Sheet１　に入力されています。 sheet１上のボタンをActiveXコントロールのコマンドボタンを使用して、同じユーザーフォームを呼び出し実行すると、正常に作動します。 この現象は、2010以前のバージョンだと、どちらも同じ動作をすると思います。すべてを調べたわけではありませんが。 12月10日（水）の更新後、Excel2013ではActiveXコントロールのコマンドボタンが使用できなくなったと思いますが、VBAに詳しい方で、何か解決策をご存じの方、アドバイスをお願いします。
VBAでフォーム上のListViewにavi動画ファイルをD&Dすると そのパスを読み取って、自動でプログラムを実行するマクロを作成しました。 問題無く実行できる場合には問題ないのですが バグがあったりして、デバッグモードに入ったり 途中でプログラムの実行を中断したりすると、 そのavi動画ファイルをシート上にD&Dしたのと同じ状態になり Excelでavi動画ファイルを開こうとしてしまいます。 大きなファイルなら開けませんが、 小さなファイルだとバイナリデータとして無理矢理開くことになり Excelがフリーズしてしまいます。 それでVBAかExcelの設定で シート上にファイルをD&Dしても読み込まない設定にしたいのですが どのようにすれば良いでしょうか？ 一応検索して調べたのですが見つかりませんでした。 どなたか教えてください。
Win7(32bit) Excel 2010 を使用していますが、突然、以下の不具合が発生しました。 1.　シート上に配置したActiveXコントロールのコマンドボタンが押せない状態に 　　 なりました。（マクロは起動します） 2. ActiveXコントロールが使用出来ない。 この事象は、12/11のWindows Updateの更新プログラムを自動更新した以降に 発生しました。そこで、更新プログラムの不具合と思い、順次アンインストールして 確認しましたら(KB2687455)の32ビット版更新プログラムを削除すると復元すること が解りました。マイクロソフトの技術サポートに連絡しましたら、本件は有料相談に 該当しますので、34,344円かかるとの事でしので、悩んでいます。皆さんに同様な事象 は発生していませんか？　何か良い対策方法か、情報などありませんでしょうか。 教えて下さい。
ある配列をtiff画像ファイルとして出力したいのですが 配列を一度bmp画像ファイルとして出力して http://oshiete.goo.ne.jp/qa/8809275.html このページにある方法を使って、それをtiffファイルに変換して 残ったbmpファイルを削除するというプログラムを作りました。 この方法だと、HDDにアクセスする手順が多くなるため、ファイル数が多い時に時間がかかってしまいます。 bmpファイルをメモリにいったん保存しておいて、 それをtiffファイルに書き換えるようなプログラムを作るにはどうしたら良いですか？ あるいは配列から直接tiff画像ファイルを出力する方法があれば 教えてください。
マクロで以下のような操作をしたいと思っております。 どのようなコードを書けばよろしいでしょうか。ご教授ください。 【顧客データ一覧.xls】というブックのシート１に顧客データ一覧表があります。 同ブックのシート１上部にコマンドボタンを作成し、ボタン押下で以下のような操作を行いたい １.ファイルダイアログを開いて、【顧客データひとり分.xls】というブックを選択 ２．【顧客データひとり分.xls】に入力されているデータを、【顧客データ一覧.xls】の顧客データ一覧表の末尾に、コピーして追加・上書保存 顧客データひとり分はセル（3,4)に年齢が入力されている等、入力箇所は固定です。 ３.顧客データひとり分.xlsは閉じて、更新された顧客データ一覧.xlsを表示させる よろしくお願いいたします。マクロは作成したことがありますが、何年もブランクがあり、かなり忘れてしまいました・・・。 と、エクセル2003以来久しぶりに操作ですので、エクセルそのものに大変戸惑っております。。。実力不足でお恥ずかしいのですが、お力をお借りできれば幸いです。
過去の質問を閲覧していて入力方法が解らなく、初歩的な質問だとは思うのですがご教授頂きたく宜しくお願い致します。 「Rst.FindFirst "名称コード" & " = " & "' 101 "'」という記述を「Microsoft Visual Basic for Applications」を使用し「"' 101 "'」と入力する場合、半角ＡでShift+2(")で、「"」が入力できますがそのまま、Shift+7(')と入力すると、「"の３番目」がセミコロンの下部分の様な記号が入力されてしまいます。つまり「"'」となりません。（この質問ページでは「"'」と入力出来ますが）どの様にすれば「"'」と入力出来ますでしょうか？
VBAです。 If (a <1 and a>100) OR (b<1 and b>100) then これは(a <1 and a>100)か、(b<1 and b>100)のいずれか、あるいは両方が成り立っている場合の条件。 どちらか片方のみが成り立っているとしたい場合には、 If ((a<1 and a>100) OR (b>=1 and b<=100)) OR ((a>=1 and a<100) OR (b<1 and b>100)) then とする必要がありますか？ もっと簡単な方法があれば教えてください。
　VB.net 2010 のプログラムで、ExcelからA4サイズの帳票を作り、自動印刷する機能を作っていますが、解決できない点が1つありますので、質問させて頂きました。 　実行するPCによって、1枚当たりに印刷できる幅が異なるのです。 　画像をご覧いただきたいのですが、画像上段にある"A"はBV列までが、印刷できる範囲です。ところが"B"では、CF列までが印刷範囲となっています。(各列の幅は0.64(9ピクセル)です。) ”ページ設定”の値を見比べましたが、全て同じ設定です。 　結果、"B"になってしまうPCで帳票を作ると、BW～CF列の余計な列のせいで、印刷できる帳票のサイズが小さくなってしまいました。 実行したPCの環境は以下のものです。 　A画像になったPC　 Windows7 & Excel2010 　B画像になったPC　Vista & Excel2007 　プリンタは同じプリンタを使っています。 A4で1枚当たりに印刷できる長さを固定に出来ないかご教授ください。 VBの印刷設定～印刷までのソースは次の通りです。 (objAppはExcel.Application、objSht はExcel.Worksheet オブジェクトです） Dim xlPageSetup As Excel.PageSetup = objSht.PageSetup With xlPageSetup .PaperSize = Excel.XlPaperSize.xlPaperA4 '用紙サイズをＡ４ .Orientation = Excel.XlPageOrientation.xlPortrait .LeftMargin = objApp.CentimetersToPoints(1.3) '左余白 .RightMargin = objApp.CentimetersToPoints(1) '右余白 .TopMargin = objApp.CentimetersToPoints(1.4) .BottomMargin = objApp.CentimetersToPoints(1.5) .FooterMargin = objApp.CentimetersToPoints(1) .HeaderMargin = objApp.CentimetersToPoints(0.8) .PrintTitleRows = "$14:$16" .LeftFooter = "&""ＭＳ Ｐ明朝,""XXXXXX会社　見積書 (NoXXXXX)" .RightFooter = "&""ＭＳ Ｐ明朝,""&P/&N" .CenterHorizontally = True End With objSht.PrintOutEx()
皆様おはこんばんちわ。 セル(Ex.B2,B3,B4)をダブルクリックする度に、そのセル内にオートシェイプを描画／削除したいのです。 描画は下記（で良いのかですが）で出来たのですが、削除がどうしてもわかりません。 ------------------------------------------------------------------------- Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) If Intersect(Target, Range("B2:B4")) Is Nothing Then Exit Sub With ActiveCell With ActiveSheet.Shapes.AddShape _ (msoShapeOval, .Left, .Top, .Width, .Height) .Fill.Visible = msoFalse .Line.Weight = 1.75 .Line.ForeColor.SchemeColor = 0 End With End With End Sub ------------------------------------------------------------------------- 既に図形があるセルをダブルクリックで削除するにはどの様な方法があるのでしょうか。 バージョンはExcel2007です。 皆様よろしくご教示ください。
今、エクセルにて商品管理をするツールを作成していました。 ユーザーフォームにて、売却した商品コードを入力すると、在庫シートから該当商品を検索し、ユーザーフォーム内に商品データが入力されるようになっています。 売上登録処理を実行した時に、売買明細シートへＡ列には(1)売却した商品コード、Ｂ列には(2)売却した商品名、Ｃ列には(3)売却価額、Ｄ列には(4)売却した商品の仕入価額（これは”在庫シート”の中で商品コード（Ｂ列）を検索し、在庫シートのＪ列から引っ張る）という情報を転記したあと、(5)在庫シートへ記載されているその商品情報の行を削除したいのです。 (1)～(3)の処理はできたのですが、(4)の在庫シート内で商品コードを検索する　というコードが書けません。 (1)～(3)の処理は、 Dim Ctrl As Control With Worksheets("売買明細") 'A列の最終セルからEndプロパティでデータの最終行を取得し、 '＋１をして、次にデータを入力する行の行番号を取得 RowNum = .Cells(Rows.Count, 1).End(xlUp).Row + 1 'ワークシートの行列を指定してテキストボックスの値を1つずつセルへ代入 .Cells(RowNum, 1).Value = Me.商品コード.Value .Cells(RowNum, 2).Value = Me.商品名.Value … 以下続くとしました。 すみませんが、どなたかお知恵を貸していただけないでしょうか。 よろしくお願いいたします。
こんにちは。 Visual Studio 初心者です。 テキストファイルを開く、簡単なプログラムを作成しました。 そのテキストファイルを開発マシンに保存すると、問題なく開くのですが テキストファイルをサーバーに指定するとエラーが発生します。 開発環境はWindows 8.1 Pro 64bitで、 .NET Framework 4.0を使用しています。 サーバーはWindows Server 2008 R2 32bitで .NET Framwork 3.5がインストールされています。 なにが原因かわかりますか？
お世話になっています。 標題の件に付いて教えて頂きたく質問板に投稿させて頂きました。 以下の様な複数の文字列があり各文字列で共通の文字列のみを抽出するといった処理を行いたいのですが可能でしょうか？？ 例(1) 赤鉛筆を11/1に購入 青鉛筆を11/5に購入 黄鉛筆を11/20に購入 →鉛筆を購入 例(2) 今日の天気は晴れです 今日の天気は曇りです 今日の天気は雨です →今日の天気はです という様な感じです。 文字列には決まったパターン等はありません。 申し訳ありませんがご教授下さい。 よろしくお願い致します。
A列　　B列 a 　　 ああああ b　　　いいいい b　　　うううう b　　　ええええ c　　　おおおお c　　　かかかか d　　　きききき d　　　くくくく d　　　けけけけ d　　　ここここ d　　　ささささ このような配列でデータが存在します。 A列の文字を名前にしてB列に名前を定義しようとしています。 例えばああああという文字列にaという名前を定義したいのです。 いいいい、うううう、ええええにはｂという名前を定義したいのです。 A列の同じデータの数が決まっていないので Dim cnt As Long 'A列の同じ値の数 Dim tName As String 'A列の値 cnt = WorksheetFunction.CountIf(ActiveSheet.Range("A1:B500"), tName) という関数を探してきたので、これでA列の同じ値のセルの数を取得しようと思います。 名前の定義はマクロを記録したところ・・・ ActiveWorkbook.Names.Add Name:="a", RefersToR1C1:="=Sheet1!R2C2:R2C2" を得ました。 この後どのようにしてプログラムを組み立てたらいいでしょうか。 よろしくお願いします。
困っております。 ご教授ください。 エクセルシート上に1～10の数字が列方向に並んでいます。 ユーザーフォームでtextbox1とtextbox2を作成します。 textbox１とtextbox2は1～10の間で範囲を入力します。 textbox2でエンターを押されたときに処理が開始します。 例えばtextbox１に「3」、textbox2に「8」が入力された場合、 3,4,5,6,7,8のセル範囲を選択したいのですがどのようにすればよろしいでしょうか。 よろしくお願いします。
１行目には１ヶ月分の日付がはいっています。 ２行目にはWEEKDAY関数で１行目の日付の曜日をいれています。 ３行目に月曜日（WEEKDAY関数では２）なら公休日の"公"と表示したいのですがどのようにしたらよいでしょうか？ Sub 公休日() If Range("A2").Value = 2 Then Range("A3").Value = "公" End If End Sub このような作業を繰り返すにはどうすればよいでしょうか？ 補足として、エクセル2007を使用しています。 ３行目には数字を入力するためIF関数を使うことができません。
いつもお世話になっております。 エクセルVBAでIE制御についてです。 環境はWIN7、IE 9or11とエクセル2010です。 あるページのリンクをクリックすると、 WEBからのメッセージというダイアログボックスが出てきて、 続行しますか？　はい　いいえ　を聞かれます。 その「はい」をVBAで押したいのですが、 sendkeysメソッドで押そうとしてもうまくいきません。 以下に記載したサイトのOKボタンを押すと出てくるものです。 http://kamicha1.web.fc2.com/Excel/Test20090726.html 以下が書いたコードです。 Declare Sub Sleep Lib "KERNEL32" (ByVal dwMilliseconds As Long) Sub test() Dim ie As Object Set ie = CreateObject("InternetExplorer.Application") ie.Visible = True ie.navigate "http://kamicha1.web.fc2.com/Excel/Test20090726.html" 　　　　　　 Do While ie.Busy Or ie.readyState < 4 DoEvents Loop ie.document.getElementsByClassName("bt2")(0).Click　'-ここで止まる Sleep 2000 SendKeys "{Enter}" End Sub ステップ実行していくと、ここで止まると書いた所で、 IE上にダイアログは表示されるのですが、 それ以上ステップ実行ができなくなってしまいます。 ダイアログを自分でOKかキャンセルで消すと続きが動くようになります。 その間はVBEはビジー状態となり操作できません。 そのためそれ以降のsendkeysメソッドに たどり着けない状況かと思われます。 いろいろ調べたところIE8以降はダイアログボックスは IEから出ているのではなくOS？から出ているとの事でした。 上記のサイトはHTML本体にjavaスクリプトが記載されており、 それをVBAから操作すればどうにかOKボタンが押せるらしいのですが、 自分が操作したいページにはそれらしき記載がありませんでした。 対象のアンカータグは <a herl=URL 中略　data-comfirm=続行しますか？　＞ のような感じで記載がありました。 完全に煮詰まっております。 自動でOKをクリックするかEnterキーでOKを押すでも構いません。 どうかご教授お願いいたします。
セルの変更時、列によって行の内容を変更するプログラムを組んだのですが、 エラーが起きてうまくいきません。 使用しているExcelは2007です。 ファイルを参照するあたりが全然わかってないのでそのあたりがあやしいです。 実行時エラー '91': オブジェクト変数または With ブロック変数が設定されていません。 → hoge = book1.Worksheets(customer).Range("A34:D" & endrow) '係数表をコピー ↓デバッグ押すと 実行時エラー '-2147417848 (80010108)': 'Value' メソッドは失敗しました: 'Range'オブジェクト → Call all_feeCulc_change2(target.Parent.Name, target.row) 番号をメモし忘れました。91かこれが表示されます。どちらが出るかわかりません。 'Range' メソッドは失敗しました:'_Worksheet' オブジェクト →endrow = book1.Worksheets(customer).Cells(Rows.Count, 1).End(xlUp).row '最終行番号を取得 何回かリトライして開いたり閉じたりを繰り返したら↓のようなダイアログも出ました。 マクロでスタック領域が不足しています また、ダイアログで終了を押したらセルを正しく選択できなくなりました。 デバッグを押したら、停止ボタンを押すと応答なしになった後、Excelが終了し再起動しました。 そして、どちらを選択した場合でも、メニューや閉じるボタンを押してもExcelが終了できず、 タスクマネージャからプロセスを終了させるしかなかったです。 その時CPU使用率が50%を超えてたりと異常事態になっております。 ###標準モジュール### Sub all_feeCulc_change2(ByVal sheetName As String, ByVal row As Integer) If sheetName <> "" Then Dim customer As String customer = Worksheets(sheetName).Cells(row, 3) On Error Resume Next Dim book1 As Workbook '別ファイルのオープン（触らない） Workbooks.Open Filename:="hogehoge.xlsm" '別ファイルのオープン（触らない） Set book1 = Workbooks("hogehoge.xlsm") '別ファイルのオープン（触らない） On Error GoTo 0 Dim endrow As Integer '最終行番号 endrow = book1.Worksheets(customer).Cells(Rows.Count, 1).End(xlUp).row '最終行番号を取得 Dim hoge As Variant hoge = book1.Worksheets(customer).Range("A34:D" & endrow) '早見表から係数表をコピー With Worksheets(sheetName) ... ###ThisWorkbook### Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal target As Range) If target.Count = 1 Then Dim column As Integer Dim row As Integer column = target.column row = target.row If row >= 3 Then If ((column - 3) Mod 5) = 2 And column > 3 Then '更新セルがメーターだったら Call usageCulc_change(target.Parent.Name, target.column, target.row) Call all_feeCulc_change(target.Parent.Name, target.column - 1, target.row) Call chenge_tax_change(target.Parent.Name, target.column + 1, target.row) ElseIf column = 3 Then target.Value = format(target.Value, "000") '誤入力防止 Call all_feeCulc_change2(target.Parent.Name, target.row) Call chenge_tax_change2(target.Parent.Name, target.row) End If End If End If End Sub Private Sub Workbook_Open() '*****すべてのシート名を取得*****' Dim ws As Worksheet Dim sheetName() As String ReDim sheetName(3) Dim cnt As Integer cnt = 0 For Each ws In Worksheets If cnt > 3 And (cnt Mod 4) = 0 Then ReDim Preserve sheetName(UBound(sheetName) + 4) End If sheetName(cnt) = ws.Name cnt = cnt + 1 Next '*****取得終了*****' Dim endrow As Integer Dim line As Variant For Each line In sheetName If line <> "000" And line <> "" Then With Worksheets(line) endrow = .Cells(Rows.Count, 3).End(xlUp).row Dim i As Integer Dim j As Integer For i = 0 To endrow For j = 0 To 11 .Cells(3 + i, 4 + j * 5).NumberFormatLocal = "0.0" .Cells(3 + i, 5 + j * 5).NumberFormatLocal = "0.0" .Cells(3 + i, 6 + j * 5).NumberFormatLocal = "#,##0" .Cells(3 + i, 7 + j * 5).NumberFormatLocal = "#,##0" .Cells(3 + i, 8 + j * 5).NumberFormatLocal = "#,##0" Next j Next i End With End If Next End Sub
現在、カレンダーをプログラミングで作成しています。 カレンダーの土日を色づけして表示するところまでは、出来たのですが、祝日でつまづいています。 企業などで、休みは暦通りや、カレンダー通りという言葉を耳にしますが、これを作成するには祝日の振り替え休日のロジックがわかりません。 どの祝日は振り替え休日となるのか、何曜日に対して振り替えされるのか、振り替えされない場合など、ルールがわかりません。 どなたか、詳しい方アドバイスよろしくお願いいたします。 参考URLなどあると助かります。 尚、現在テストプログラムはExcel_VBAで作成しています。 今後、VBかC#でも作成する予定です。 よろしくお願いします。
お世話になります。 現行使用しているモジュール内に記述されているファイル名をVBAで書き換えたいのです。 現状コーディング中に記述されているファイル名には、頭に年度を表わす、例えば 2014年なら下2桁の　"14データ処理用"　と書かれていて、年度が変わるたびに、 14を15の様にキーボードより編集しています。 　しかしモジュールの中にファイル名の記述箇所が複数あり、またモジュールは複数あり その中にもその年のファイル名が記述されているために修正も一苦労しています。 そこでVBAのコードの記述を変換するためのフォームを作成し、西暦の下2桁を、前年、当年 それぞれ入力し、前年で検索して当年に置換するようにしたのですが、実行時エラー'13' で落ちてしまいます。 PCはゲストで使用しています。御存じのかたいらっしゃいましたらご教示願います。 以下VBAのコーディングです。宜しくお願いします。 Option Explicit Dim Target As Workbook, VBC, i As Long Private Sub CommandButton1_Click() Set Target = Workbooks(Sheet1) With Target.Workbooks(Sheet1).VBProject.VBComponents("Module1").CodeModule For i = 1 To .CountOfLines If .Lines(i, 1) = "" & In_Year & "データ" Then 'In_Year;前年 .ReplaceLine i, "" & Out_Year & "データ" 'Out_Year;当年 End If Next i End With Target.Save End Sub
動作環境 OS:Windows7(64Bit) Home Premium SP1 MS:Office Version2007 SP3 Excel図形内のテキストの編集で、マウスをドラッグしてテキストの領域を選択後、コンテキスト メニューから、フォント(F)－フォント(設定ダイアログ)画面－[フォント]タブ上に、下線の色が、 あります。 テキスト設定した場合、vba上から下線の色を取得する方法が、知りたいです。 大体、目途は、付いています。 どなたか、ご指導願います。 ■現在、自分が、分かっている下線の色を取得するPG 下記の方法ですと、全てエラーです。 For Each wkbWorksheets In ActiveWorkbook.Worksheets For Each wksShapes In wkbWorksheets.Shapes With wksShapes.TextFrame2.TextRange.Characters MsgBox .Font.UnderlineStyle.ColorIndex MsgBox .Font.UnderlineStyleColorIndex MsgBox .Font.Underline.ColorIndex MsgBox .Font.UnderlineColorIndex End With Next wksShapes Next wkbWorksheets
以下のように関数を設定し、実行してみたのですがCall CommonModule.testの部分で 実行時エラー '424': オブジェクトが必要です。 と表示され関数が実行されません。 初心者なので知識が浅く、初歩的なミスかもしれませんがご教示いただければ幸いです。 Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal target As Range) If target.Count = 1 Then Dim column As Integer Dim row As Integer column = target.column row = target.row If row >= 3 Then If ((column - 3) Mod 5) = 2 And column > 3 Then Call CommonModule.test 'エラー '424' オブジェクトが必要です。 End If End If End If End Sub Function test() MsgBox "test" End Function
フォームをロードし、下記のようにしてもカーソルが点滅しません。その解決方法を教えてください。 Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load TextBox1.Focus() End Sub
町の図書館です。蔵書データをエクセル（蔵書リスト）で3万件持っています。 実際に本があるかどうか蔵書点検をしたいと思っています。 バーコードリーダーで図書のバーコード（図書ＩＤ）を一件ごと読みこんで、図書ＩＤをエクセルの新ファイル（図書ＩＤリスト）に次々と入れ込みたいのですができますか？ 読み込みができれば、蔵書リストとマッチングするマクロを組みたいと思います。
おはようございます。 【オートシェイプ内のテキスト行間を指定するプロパティ】 オートシェイプ内のテキスト行間を指定するプロパティはありますでしょうか？ excel 2007で　オートシェイプにテキストをいれた場合、 右クリックすると「段落」という項目がでてきて、 オートシェイプ内のテキストの行間を指定できたのですが、 オートシェイプ内のテキストの行間をVBAで指定することはできるのでしょか？ （マクロを登録してもなにも記述されていないので、困っています。） 最終的にはアクティブブックの全シートのオートシェイプの行間を変更する VBAにしたいと思っています。 参考URL等あれば教えていただけませんでしょうか？ よろしくお願いいたします。
win7を使っています。 あるブックに入ったVBAで別のブックに入ったsubマクロを開きたいのですが http://qanda.rakuten.ne.jp/qa7769745.html このページに書かれた方法を参考にすると 別のxlsmファイルが開いて、マクロを開こうとするところまではいくのですが 権限がない、と言われてsubを開くことができません。 回答をよく読むと、XPの方法には対応しているが win7に対応しておらず xlApp.Visible = True xlApp.Run "'" & MyFileName & "'!" & "test" を入れるとうまくいく、 みたいなことが書いてあるのですが、 これをやってもうまくいきませんでした。 どなたか方法を教えてください。
こんばんは .vbsファイルからデータベースを操作しようとして躓いています。 エクセルvbaでは動いているのに、.vbsに移植するとエラーが出てしまいます。 エラーの内容は「プロバイダーが見つかりません。正しくインストールされていない可能性があります。」です。 次のスクリプトです。 'ここから Dim ADO_CONNECT Dim MDBName Dim dbCon Dim strSQL ADO_CONNECT = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" MDBName = WScript.Arguments(0) 'エクセルVBAの場合はハードコード Set dbCon = CreateObject("ADODB.Connection") dbCon.Open ADO_CONNECT & MDBName & ";" strSQL = "命令文" dbCon.Execute (strSQL) 'ここまで プロバイダーの場所、バージョン、32/64ビット、あたりに問題がのかもしれませんが、調べてもよくわかりません。エクセルVBAでは動作するので、参照設定？の違いなのかもしれません。どのように解決したら良いでしょうか。 Win 7 Pro 64bit MS Accessなし Excel 2007 あり
　関数のグラフを描くプログラムを作りましたが、グラフが背面にあり、座標平面の格子に消されています。前面に出す方法はありませんか。 　FormにPictureBoxを載せ、格子はe.Graphics.DrawLineで描き、グラフはビットマップに描き、PictureBoxのImageで置きました。宜しくお願いします。
現在VBAでIEを操作しようとしております。 URLやタイトルから指定してIEを操作することはできるようになりました。 今度はデスクトップの最善面にあるIEを操作したいと考えています。 下記を参考にして考えていますが、Hwndプロパティが読み取り専用らしく ハンドルから操作するIEを指定することができません。 http://okwave.jp/qa/q2147057.html そもそもVBAで可能なのかについても よく分からないのですが、恐れ入りますが代案を含め方法があれば教えてください。 ひとまず、煮詰まっていますが、 今残っているコードを載せておきます。 Public Declare Function GetForegroundWindow Lib "user32" () As Long ’--------------- Sub shell_test() Dim objie As Object Dim a as long Set obj = CreateObject("shell.application") a = GetForegroundWindow Debug.Print a End Sub
お世話になります。 環境：windows7 Professional Adobe Acrobat 11 Standard AcrobatでファイルをPDF化する際に出てくる 「PDF　ファイルの保存」ダイアログの操作について質問です。 ファイルの保存先を入力する部分に sendkeysで任意の保存先を入力したいと思っておりますが、 アドレス入力バーを特定する方法がわかりません。 もし、ご存知の方がいらっしゃいましたら、 ご教授頂けますでしょうか？ よろしくお願い致します。
vb6で座標平面を作成するプログラムを作っています。lineやlabelを配列で設置しましたが、 lineが前面に出てしまい、とても見づらいものになってしまいました。labelを前面に出すにはどうしたらよいでしょうか。 (1)lineコントロールを配置し、index=0 (2)labelコントロールを配置し、index=0 (3)(1)と(2)が重なるようにします（label1(0)が前面に出ています）。 (4)以下を実行します Private Sub Form_Load() Form1.ScaleMode = 3 Label1(0).FontSize = 15 Label1(0).FontBold = True Line1(0).BorderWidth = 2 Line1(0).BorderColor = &H80000005 Load Line1(1) With Line1(1) .X1 = 100 .X2 = 100 .Y1 = 0 .Y2 = 200 .Visible = True End With Load Label1(1) With Label1(1) .Left = 98 .Top = 80 .Visible = True End With End Sub (5)label(1)が背面になります。
会社で、GPIB、I/O、ActiveXコンポーネントの環境下で、 VB6のプログラムを使用して試験評価を行っているのですが、 VB6のコードを変更するにあたり、うまくいきません。 どなたかご教授願います。 内容は、 コードを変更したいので、元々の.vbpを開くと、 まず、「オブジェクトライブラリは登録されていません」とエラーが出ます。 その後、「プロジェクトのロードを続けますか？」となるので、OKを押します。 すると、「読み込み中にエラーが発生しました。・・・.logを参照してください」と出ます。 気にせず、OKを押し、コードの内容を変更したあと（※変更しなくても）、 プロジェクトの上書き保存をしたあと、.exeの作成（上書き）をすると、 また、「読み込み中にエラーが発生しました。・・・.logを参照してください」と出ます。 気にせず、OKを押し、作成した.exeを開くと、変更した内容になっていますが、 いざ、実行すると、「実行時エラー”１３”　型が一致しません」とエラーが出ます。 .logの内容を確認すると、”クラス・・・がロードされていません”とか、 ”プロパティ名・・・が不正です”とか表示されています。 試験する上で、使用しやすいようにVB6のコードを変更したいのですが、 試験で使用しているPCで元々のコードを変更しようとすると、上記のようなエラーが出ます。 どなたか、解決方法を教えてください。
http://officetanaka.net/excel/vba/filesystemobject/filesystemobject.htm このページにファイル名から、拡張子やドライブ名などを出力する方法が書かれていますが ファイルが入っているフォルダ名を取得するコマンドはございますでしょうか？ 例えば、 C:\xxxx\yyyy.txt の場合、 C:\xxxx\ を取得したいのですが、コマンドはありますか？
Excelやwordでは Ctrl+yキーに、Ctrl+zキーのやり直しが割り当てられていますが、 Excel VBAでは http://span.jp/office2010_manual/excel_vba/reference/excel-vba-shortcut.html 行の削除が割り当てられています。 これをExcelやwordと同様に「やり直し」操作を割り当てたいのですが どのようにすれば良いですか？ あるいは、他のショートカットキーに「やり直し」操作はありますでしょうか？
VB2013 expressです。 VBで作成したフォーム上にファイルをD&Dすることで フルパス名を取得するプログラムを書きたいのですが http://dobon.net/vb/dotnet/control/droppedfile.html このページにのように、テキストボックス上に D&Dすればうまくいくものは見つかったのですが、 フォーム全体で受け付けてくれるものが見つかりません。 どのように改良すれば良いか教えてください。
VBSを使ってプログラムを作りたいのですが、 visual studioを使ったデバッグの方法について教えてください。 バージョンはvisual studio express 2013で最新バージョンです。 OSはwin8 64bitです。 ・とりあえず、 http://winscript.s41.xrea.com/wiki/index.php?%5B%5B%A5%A8%A5%C7%A5%A3%A5%BF%2FVWD2005%5D%5D のページにあるように、 タイトル VBSスクリプトの実行(&R) コマンド C:\WINDOWS\system32\wscript.exe 引数 $(ItemPath?) を外部ツールに登録した上で MsgBox "テスト" と書かれた適当なvbsファイルをD&Dで読み込ませてみたのですが コードの色分けが行われておらず全て同じ色になっています。 http://www.koutou-software.co.jp/junk/use-vs-project-with-vbscript.html このページのようにdimなどを青色に表示するにはどうしたら良いですか？ ・MsgBox "テスト"の左横にブレイクポイントの赤い丸を付けて VBSスクリプトの実行をしたのですが、 特にプログラムを停止することなく実行されてしまうのですが どうすれば指定した位置でプログラムを止めることができますか？ ・あとEXEファイルとして出力したいのですが ビルド機能が見つからないのですがどうすれば良いですか？ ・http://www.koutou-software.co.jp/junk/use-vs-project-with-vbscript.html このページには Visual C++としてプロジェクトを作成し、いろいろな設定を行った後にするみたいな解説がありますが この通りやっても、wscript.exeが見つからないというようなエラーが出て 実行することができませんでした。 少し質問が多いですが よろしくお願いいたします。
ｖｂ６にて、元々のコードの内容を変更して、 プロジェクトの上書き保存をした後、 上書きの内容のexeを作成しようとすると、 「コンパイルエラー　：メソッドまたはデータメンバが見つかりません」とでます。 デバッグ開始ボタンで変更したコードが問題ないことは確認済です。 元々のコードの内容を変更せず、 exe作成で同じ名前で上書きをしようとしても上記のコンパイルエラーが表示されます。 なぜでしょうか？コンパイルエラーが出る理由をお教え願います。 GPIBやI/Oを使用しているのですが、測定機器につなげた状態で、 exe作成をしないとダメなのでしょうか？？？ 素人でよくわかりません。どなたかお教え願います。
http://oshiete.goo.ne.jp/qa/8809275.html このページでbmp画像をtiff圧縮する方法を教えていただきました。 このプログラムを改良して jpegやpng画像にも対応したプログラムを作ることはできないでしょうか？ 恐らく、 　　　CLSIDFromString StrPtr("{E09D739D-CCD4-44EE-8EBA-3FBF8BE4FC58}"), .Guid ' 圧縮方法 というところを書き換えれば、他の形式にも対応できると思うのですが、 CLSIDFromString　で検索しても、情報は見つかりませんでした。 どうか教えてください。
VBSを使って、 ファイルの更新日時プラス任意の時間をファイル名に書き込むプログラムを作ろうとしています。 zisa = 10 zikan = objFile.DateLastModified +zisa objFile.Name = Right("0" & CStr(Hour(zikan)), 2) & Right("0" & CStr(Minute(zikan)), 2) のようにして、変数zisaに任意の時間を代入して ファイル名を書き換えたいのですが、 objFile.DateLastModified　の　フォーマットが不明であるため 上記の方法では、うまくいきません。 zisa を10000とか適当な値にも変えてみましたが うまくいきませんでした。 objFile.Name = Right("0" & CStr(Hour(zikan)+zisa), 2) & Right("0" & CStr(Minute(zikan)), 2) とする方法だとうまくいきますが、 日付が変わってしまう場合には、うまくいきません。 どうすればうまくいきますでしょうか？
ＶＢ初心者です。 ＶＢ等でアクティブウィンドウのパスを取得する方法を探しています。 タイトルであればGetWindowTextで取得で可能ですし、 アプリケーションのパスであれば、 　http://sumishiro.blogspot.jp/2009/09/blog-post_30.htmlが参考になりました。　 しかしドキュメントファイルのパスを取得する方法がどうしてもわかりません。 例えば、ワードでtest.docxを開いているとき、そのウィンドウハンドルからwinword.exeのフルパスでなく、test.docxのフルパスを取得する方法です。（ワード、エクセル等だけでなく画像ビューアーが画像ファイルを開いているとき、その画像ファイルのフルパスの取得） どうぞよろしくお願いいたします。
こんにちは。 よろしくお願い致します。 在庫数が０になった時間をK列に表示したいのですが、うまく出来ません。 H列、I列、J列、K列を使います。 H列は自分で数字を入力しています。 I列はCOUNTIFで他のシートから数字を持ってきています。 J列には「H－I」の数式が入っています。 そしてK列にJ列の数字が０になった時の時間を表示したいです。 どうぞよろしくお願い致します。
お世話になります。 VBAでテキストボックスに日本語入力する為に、Validation.IMEmodeを活用しています。 このオブジェクト．プロパティで、エクセルを立ち上げた時に、WorkBook全体を自動的に日本語入力ONにしようと色々試みましたが実現出来ません。 教えて頂きたく宜しくお願いします。
概要としてはスピードの値を入力して開始をクリックするとSheet1からSheet8まで順番にシートを表示して簡単なアニメーションができるというプログラムを動かしたいのですが、思うような動き方をしてくれません。お知恵を拝借できればと思います。よろしくお願いします （OSの32ビットと64ビットが関係しているような気がしますが解決ができない状態です） 動作環境（windows8.1、Excel2013） プログラムコードは以下になります。 Public Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long) Sub Sample() nSec = Worksheets("目次").Range("C5") For i = 1 To 8 Sheets("Sheet" & i).Select Sleep nSec Next i Sheets("目次").Select End Sub
エクセル マクロについて質問です。 現在，以下のような記述をエクセル上のボタンに登録しています。 ボタンを押すと，デスクトップ上の任意のCSVファイルの選択を行い，CSVファイルを選択し，そのCSVデータを全てエクセル上のデータとして落としさせたいと思っています。 しかし，csvファイルによっては， 「実行時エラー　 アプリケーション定義またはオブジェクト定義のエラーです。」と出て， 「デバック（D）」ボタンを押すと，下から４行目の 「Cells(i, j) = strCell」のところが，黄色くエラーとして表示されてしまいます。 下記の記述もネット上で皆さんに教えていただきながらなんとかやっているもので，正直自分自身でよく理解できていませんが，上記のようなエラーを回避する方法をどなたかご教示いただけないかと思います。 どうかよろしくお願いいたします。 Sub Macro5() Dim varFileName As Variant Dim intFree As Integer Dim strRec As String Dim strSplit() As String Dim i As Long, j As Long, k As Long Dim lngQuate As Long Dim strCell As String varFileName = Application.GetOpenFilename(FileFilter:="CSVファイル(*.csv),*.csv", _ Title:="CSVファイルの選択") If varFileName = False Then Exit Sub End If intFree = FreeFile '空番号を取得 Open varFileName For Input As #intFree 'CSVファィルをオープン i = 0 Do Until EOF(intFree) Line Input #intFree, strRec '1行読み込み i = i + 1 j = 0 lngQuate = 0 strCell = "" For k = 1 To Len(strRec) Select Case Mid(strRec, k, 1) Case "," '「"」が偶数なら区切り、奇数ならただの文字 If lngQuate Mod 2 = 0 Then Call PutCell(i, j, strCell, lngQuate) Else strCell = strCell & Mid(strRec, k, 1) End If Case """" '「"」のカウントをとる lngQuate = lngQuate + 1 strCell = strCell & Mid(strRec, k, 1) Case Else strCell = strCell & Mid(strRec, k, 1) End Select Next '最終列の処理 Call PutCell(i, j, strCell, lngQuate) Loop Close #intFree End Sub Sub PutCell(ByRef i As Long, ByRef j As Long, ByRef strCell As String, ByRef lngQuate As Long) j = j + 1 '「""」を「"」で置換 strCell = Replace(strCell, """""", """") '前後の「"」を削除 If Left(strCell, 1) = """" And Right(strCell, 1) = """" Then strCell = Mid(strCell, 2, Len(strCell) - 2) End If Cells(i, j) = strCell strCell = "" lngQuate = 0 End Sub
2009年頃の発行ですが「VBA for Professional Access VBA+SQL実践活用」のサンプルファイルを紛失してしまいました。マイコミから入手できませんでした。AccessVBAを読み直ししているところです。
業務でマクロを使うことになり、ご教示お願い致します。 （例） 実行前　→実行後 C列　　　　 C列 001　　　　　001 003　　　　　001-1 002　　　　　001-2 005　　　　　002 001　　　　　002-2 001　　　　　003 002　　　　　005 同じ文字が複数ある場合、2個目以降には”-1”、”-2”と区別し、並べ替えを実行。 （データはA列～BI列まで入っていますので、C列が動いた場合、連動させる形で…。） ActiveWorkbook.Worksheets(BaseSheet).Activate p = HeaderPos + 1 For i = (HeaderPos + 1) To SearchNum CelValue = Range(Inbound & i).Value For m = 0 To SearchNum If KindType(m) = CelValue Then KindCount(m) = KindCount(m) + 1 Range(Inbound & i).Value = KindType(m) + CStr(KindCount(m)) Exit For ElseIf KindType(m) = "" Then KindType(m) = CelValue KindCount(m) = KindCount(m) + 1 Range(Inbound & i).Value = KindType(m) + CStr(KindCount(m)) Exit For End If Next If CelValue = "" Then Exit For End If Next イメージはこんな感じなのですが、お分かりになる方よろしくお願いいたします。
こんにちは。 マクロで下記作業をしたくて悩んでいます。 【Aブック　シートa　A列】 ↓ A列の前6文字を ↓ 【Bブック　シートb　B列】へ貼付け A列が空欄になれば処理は終了 MIDを使って作っていたのですが、別ブックへの貼付けが組めません…。 検索をしても丁度参考になるものが見つけられませんでした。 詳しい方、ご教示頂けませんでしょうか？ よろしくお願いいたします。
マクロ初心者です。 Sheet1のＡ１からＣ３に入力されているデータがあります。 それを別のブック（集計）のＳheet1のA２からＣ４へ値のみコピーを行いたいと思っています。 ２回目以降は、Sheet1のＡ１からＣ３のデータをＡ５からＣ７というように前回コピーした内容に上書きしないように連続してコピーを行いたいのですがそのようなことは可能でしょうか。 マクロで実行したいです。 ご教授よろしくお願いいたします。
動作環境 OS:Windows7(64Bit) Home Premium SP1 MS:Office Version2007 SP3 Excel図形内のテキスト編集で、マウスをドラッグしてテキストの領域を選択後、コンテキスト メニューから、フォント(F)－フォント(設定ダイアログ)画面－[文字幅と間隔]タブ上に、間隔と幅が、 あります(画像参照)。 テキスト設定した場合、vba上から文字間隔と幅を取得する方法が、知りたいです。 それと、カーニングもついでに、取得する方法が、知りたいです。 大体、目途は、付いています。 どなたか、ご指導願います。 ■現在、自分が、分かっている文字間隔と幅を取得するPG(URL参照) http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1188387871 下記の方法ですと、MsgBoxで、[文字間隔を広げる]設定値が取得されます。 For Each wkbWorksheets In ActiveWorkbook.Worksheets For Each wksShapes In wkbWorksheets.Shapes With wksShapes.TextFrame2.TextRange.Characters MsgBox .Font.Spacing End With Next wksShapes Next wkbWorksheets ※[標準]、[文字間隔をつめる]、[カーニング]で、vbaから設定値を取得するには？
お世話になります。 マクロを作成するのに、If～Thenを使用したいのですが上手く使えません。 ＜例＞ A列に文字・数字が入っているとき→B列に”い”、C列に”う”、D列に”え”と反映させる。 A列が空白のセルになったら→その行はすべて空白にする。 行数は５０行程度の予定です。 　　　　A　　　　　　B　　　　　　C　　　　　　D １　　　あ　　　　　い　　　　　　う　　　　　　え ２　　　空白　　　空白　　　　　空白　　　　空白 ３　　　あ　　　　　い　　　　　　う　　　　　　え ４　　　空白　　　空白　　　　　空白　　　　空白 ---------------------------------------------------------- 数値に対して一致・大小等の条件であれば、問題なく作成できたのですが…。 私の探し方が悪いのだとは思いますが、 セルが空白か否かを判断して文字を反映させる、というのが見つけられませんでした。 関数を使えば簡単なのは承知しておりますが、その他の処理をすべてマクロで作成したので、 できれば統一させてしまいたい…と思っています。 初心者用の本を見ながら作成している初心者ですが、何卒ご教示頂けませんでしょうか？ よろしくお願いいたします。
VBAを使って、bmp画像をtiff圧縮するプログラムを教えてください。 検索すると http://okwave.jp/qa/q8508126.html 画像圧縮、変換用のライブラリ　を使えば良いという回答ページは見つかったのですが 具体的な方法が分かりません。 「画像 dll vba　tif bmp」などで検索してみても分かりませんでしたので 教えてください。
株価グラフを、セル範囲に合わせて横に３個並べて表示させています。 同時に凡例非表示などの条件を設定していますが 　１．ローソクの幅（太さ）を広くしたい 　２．背景を着色したい この２つの設定が出来ません。何回か挑戦しましたがエラーの壁にはじき飛ばされて 困っています。是非、教えて下さい。 (Win7、エクセル2010) For I = 1 To 3 With ActiveSheet.ChartObjects.Add(Left:=Cells((I - 1) * 4 + 1).Left, _ Top:=Cells(3, 1).Top, Width:=xSize(2), Height:=ySize(2)) With .Chart .SetSourceData Source:=GFDB(4, I), PlotBy:=xlColumns .ChartType = xlStockOHLC '-------------株価グラフ .HasLegend = False '---------------------凡例非表示 .HasAxis(xlValue) = False '-------------Y軸（数値軸）非表示 .HasAxis(xlCategory) = False '---------X軸（項目軸）非表示 End With End With Next I
　excelのマクロは少しかじっていますが、word　vbaは全くの初心者です。宜しくお願いします。 　例えば、下のように、似かよった文面が複数行ある文書で 　 　[8:50:31] qqe-CF: The building where Q-ty’s friend lives is very old. 　[8:50:53] qqe-CF: The town where my father grew up is small. 　[8:51:40 | 8:52:14] qqe-CF: That is the school where Q-rex teaches. 　[8:52:44] qqe-CF: That is the room where I keep my books. 　[8:53:59 | 8:54:14] qqe-CF: This is a picture of the place where we are going for our holidays. 　[8:54:33] qqe-CF: This is the place where I fell off my bike. 　[8:54:52] qqe-CF: That is the place where we stayed for our honeymoon. ↑ここの左端から半角10文字目から始まる、半角10文字で、それが数字の場合（3行目の「 8:52:14」など）のみを、指定した複数行に渡り、数字か文字かを判別しながら自動で繰り返し削除するＶＢＡマクロのプログラムを教えて下さい。 　質問内容のまとめ 　１．各行の、左端から半角10文字目から始まる半角10文字を削除対象とする。 　２．数字のみを削除対象とし、文字はスルーする。 　３．操作範囲行を指定できるようにする。１行から１000行の範囲で。 　 　実際には、１０００行以上の文書です。よろしくお願いします
ACCESSの初心者ですが、 データベースオブジェクトにDAO・ADO・ADOＸとありますが、 使用する環境にもよると思いますが、どれを使うのが、妥当なのでしょうか。 ---------------------環境---------------------- サーバーにACCESSのDBを置き。 ２～３人程度で使用する超小規模システムで利用したい。 WindowsでExcelとの連携あり。 ----------------------------------------------- ※SELECT／INSERT／UPDATEが基本が思っていたので 　やり方が多々あり、びっくりしてしまいました。
シート内に複数のグラフを表示させていますが、セル範囲から微妙にズレてしまい、 セルに記載した説明文との間隔がバラバラになってしまい、体裁が悪く困っています。 なんとか、セル範囲（行６，列４）に合わせてグラフを作成する方法を教えて下さい。 （エクセル2010） For I = 1 To 4 For J = 1 To 4 LA = LA + 1 ActiveSheet.ChartObjects.Add(J * 183 - 182, I * 2 * 123 - 225, 183, 105).Select ActiveChart.ChartType = xlLine ActiveChart.SetSourceData Source:=GFDT(LA), PlotBy:=xlColumns ActiveChart.Parent.Name = "GF" & LA Next J Next I
作成してあるフォルダの中にテキストファイル(html)を格納する事は可能でしょうか。 フォルダはすでに作成してあります。 デスクトップ＞zenkoku＞kanagawa＞kanagawa01＞kanagawa01A ファイル名はすべて　index.html 　 (1)「kanagawa02」フォルダには　会社名と住所とF列の値（20社分） 　 →20社ごとに01、02、03　となっています。 (2)「kanagawa02A」フォルダには　会社名と住所と電話番号（1社分のみ） ※以下は　会社と住所のHTMLファイル（(1)の例）です。 <!DOCTYPE html> <html lang="en"> <body> <div class="span3" id="sidebar"> 　　<div class="widget"> 　　<h4 class="widgetTitle">ＨＨＨ病院</h4> 　　<ul><li>神奈川県横浜市</li> 　　<li>kanagawa02A</li></ul></div> 　　<div class="widget"> 　　<h4 class="widgetTitle">株式会社ＩＩＩ</h4> 　　<ul><li>神奈川県横浜市</li> 　　<li>kanagawa02B</li></ul></div> 　　（２０社分） </div> </body> </html> ※以下は　会社と住所と電話番号のHTMLファイル（(2)の例）です。 <!DOCTYPE html> <html lang="en"> <body> <div class="span3" id="sidebar"> 　　<div class="widget"> 　　<h4 class="widgetTitle">ＨＨＨ病院</h4> 　　<ul><li>神奈川県横浜市</li> 　　<li>電話番号</li></ul></div> </div> </body> </html>
背面画像Aと前面画像Bがあります。 画像Bは画像A上をファイルから読み込んだ X,YのLocationを任意に移動します。 Bの画像の白色の部分を透過にして、背面の画像Bが見えるように 表示したいのですが、うまくいきません。 PictureBoxコントロールのimageプロパティに 画像Bを設定して、backColorにTransparentを指定しても 親コントロール(画像Bを表示しているPictureBox)の BackColorで表示されるだけでした。 vb6だとimageコントロールを使用すればできました。 vb.netで何か良い方法はないでしょうか？
動作環境 OS:Windows7(64Bit) Home Premium SP1 MS:Office Version2007 SP3 下記のURLを参考にして、色の設定ダイアログ画面を出力させました。 ところが、この画面、モーダレス出力をモーダル出力にさせたいのですが、 方法が分かりません。 ちなみに、Excelのvbaで、試しています。 どなたか、ご指導願います。 ■色の設定ダイアログ画面(URL) http://www.tsware.jp/tips/tips_343.htm
会社の一覧があるのですが企業数が増えてきたのでフォルダを作成して分類しようと考えています。 一覧表には「県ごと」「２０社ごと」「１社ごと」にコードが割り振られています。 以下のようなフォルダの構成にしたいのですが、ＶＢＡによって自動的にフォルダ作成することは可能でしょうか。 zenkoku > hokkaido 　　　　　　　miyagi 　　　　　　　chiba 　　　　　　　mie 　　　　　　　kanagawa > kanagawa01 > kanagawa01A 　　　　　　　　　　・　　　　kanagawa02 > kanagawa02A 　　　　　　　　　　・　　　　　　　・　　　　　kanagawa02B 　　　　　　　　　　・ 　　　　　　　　　　・ １県あたりに20社以上ある場合は、kanagawa01、kanagawa02　となっています。 元のエクセルのデータがソートされてもＯＫです。 　　　　　 　　　　　　 　　　　　　 　　　　　　
動作環境 OS:Windows7(64Bit) Home Premium SP1 MS:Office Version2007 SP3 Excel図形内のテキストの編集で、マウスをドラッグしてテキストの領域を選択後、コンテキスト メニューから、フォント(F)－フォント(設定ダイアログ)画面－[フォント]タブ上に、下線のスタイルが、 複数あります。 テキスト設定した場合、vba上から下線のスタイルを取得する方法が、知りたいです。 大体、目途は、付いています。 どなたか、ご指導願います。 ■現在、自分が、分かっている下線のスタイルを取得するPG 下記の方法ですと、MsgBoxで、.Font.Underline=2が取得されます。 For Each wkbWorksheets In ActiveWorkbook.Worksheets For Each wksShapes In wkbWorksheets.Shapes With wksShapes.TextFrame.Characters MsgBox .Font.Underline End With Next wksShapes Next wkbWorksheets ※「1.」～「16.」で、下線のスタイルをvbaから取得するには？ 1.一重線 2.二重線 3.太線 4.点線 5.太点線 6.破線 7.太破線 8.長破線 9.長太破線 10.一点破線 11.太一点破線 12.二点破線 13.太二点破線 14.波線 15.太波線 16.二重波線
いつもお世話になっております。 早速ですが、VB2013Expressを使用しソフトを組んでいます。 組んだソフトをWin8.1がインストールされているタブレットで使用するつもりです。 そこで質問なのですが、フォームにパネルを配置しスクロールバーを表示させます。 そのスクロールを指で行いたいと思っております。 VB2013の標準機能で実行可能なのでしょうか。 宜しくお願い致します。
エクセルのマクロを使って、自動的にセルの内容をオブジェクト(図形）に入れていきたいです。 (オブジェクトは随時新規作成） 例えば、セルのA1からA3に、”あ”、”い”、”う”が記入してあるとすると、 図形が3個作成されて、図形にはそれぞれ文字が記入されている。 という感じに作りたいのですが、できますか？ 誰か教えてください＞＜
動作環境 OS:Windows7(64Bit) Home Premium SP1 MS:Office Version2007 SP3 Excel図形内のテキストの編集で、マウスをドラッグしてテキストの領域を選択後、コンテキスト メニューから、フォント(F)－フォント(設定ダイアログ)画面－[フォント]タブ上に、下線のスタイルが、 複数あります。 訳が合って、この各下線の表意定数を、知りたいのです。 大体、目途は、付いています。 どなたか、ご指導願います。 ■各下線の表意定数 括弧内の?を、ｘｌ～のように知りたいです。 後、クエスチョン以外も、間違っている場合、教えて下さい。 1.一重線(xlSingle) 2.二重線(xlDouble) 3.太線(xlMedium) 4.点線(xlDot) 5.太点線(?) 6.破線(xlDash) 7.太破線(?) 8.長破線(?) 9.長太破線(?) 10.一点破線(xlDashDot) 11.太一点破線(?) 12.二点破線(xlDashDotDot) 13.太二点破線(?) 14.波線(?) 15.太波線(?) 16.二重波線(?)
数日前に"Locationができなくなりました"というタイトルで質問させて頂きました。 内容に誤りがありましたので、再度質問させて頂きます。 実はVB2008でExcelを使用するわりと大きなプログラム「ブリッジ」を作成中です。Excelの操作を勉強するため、練習用のプロフラム「Excel練習」を作成し、ここでExcelの操作を勉強しました。 この「練習用プログラム」ではExcelの参照設定を行い、Importもし、皆様の助けを頂きながらなんとか完成することが出来ました。ちなみに”Excelの参照設定”、”Import”の内容は Excelの参照設定：Imports Microsoft.Office.Interop.Excel Import記述内容：Imports Microsoft.Office.Interop です、そこでこの内容を「ブリッジ」に移植した所問題が発生しました。「ブリッジ」では。Excelに関する宣言で「Application'は名前空間'Microsoft.Office.Interop.Excel'では不適切です」とエラーメッセージが表示されます。下記がその例です。 　　Dim oXls As Excel.Application：Excel.Applicationにエラー ところが”Import”の記述内容を　　 Imports Microsoft.Office.Interop.Excel　　：.Excelを追加 とすると、Excelに関する宣言でのエラーが無くなる代わりにLocatinをしようとしたところ で Label14.Location = New Point(350, 100)　：Pointに「Pointは、名前空間Microsoft.Office.Interop.Excelでは不適切です」とエラーメッセージが表示されます。 全くの初心者なのでエラーの原因が全く判りません。ご教示のほどよろしくお願い致します。
ＶＢ２００８でExcelの操作をしている初心者です。ファイルを開き、シートを指定しセルのデータを読み込むまではなんとかたどり着きましたが、セルへのデータ書き込みが出来なく困っています。下記のようにセルアドレスをA1方式で指定すれば書き込みできますがR1C1方式でセルアドレスを指定する方法が判りません。よろしくお願い致します。 exCel.Range("A1").Value = "Hello World"
excel　vbaで次のようなコードを作りたいです。 シート1に元データが4000件ほどあります。 シート2に、シート1のidが同じものを、3行ずつ横に表示したいです。 idと名前は1度のみ、それ以降は都道府県名と数字のみ表示します。 同じidを持つものが3行に満たないのであれば、改行します。 同じidを持つものが3行以上ある場合は、3行ごとに改行します。 1　佐藤　東京　1000 1　佐藤　千葉　2100 1　佐藤　青森　1300 2　鈴木　東京　5600 2　鈴木　千葉　3500 3　山田　三重　2910 3　山田　長野　3820 3　山田　山口　8760 3　山田　沖縄　6560 4 ： ↓ 1　佐藤　東京　1000　千葉　2100　青森　1300 2　鈴木　東京　5600　千葉　3500 3　山田　三重　2910　長野　3820　山口　8760 3　山田　沖縄　6560 4 ： どなたかこのような動作を行うvbaのコードを教えてください。 よろしくお願いします。
住所録を分類（大中小の３つ）して、それぞれの名前でファイルを作成しています。 旧）中分類のファイル名で「chu」フォルダ内にＨＴＭＬファイルを作成 　　小分類のファイル名で「sho」フォルダ内にＨＴＭＬファイルを作成 これを以下のように改変したいと思っております。 新）大分類の名前のフォルダを作成して、 　　そのフォルダの中に該当する分だけの「中分類のファイル」を作成 　　同じフォルダの中に該当する分だけの「小分類のファイル」を作成 当方まったくの初心者なので、手も足も出ませんでした。 どうかご教授よろしくお願いいたします。 Sub 中分類HTMLソース() Dim fso As Object 'ファイルシステムオブジェクト Dim strPath As String '削除対象ファイル Set fso = CreateObject("Scripting.FileSystemObject") strPath = Environ("USERPROFILE") & "\Desktop\chu\*.*" fso.DeleteFile strPath, True Set fso = Nothing 'ファイルの削除（読み取り専用の場合も削除） Dim myPath As String Dim i As Long myPath = Environ("USERPROFILE") & "\Desktop\chu\" Range("A:I").Sort Key1:=Range("H2"), Header:=xlYes, MatchCase:=False, _ Orientation:=xlTopToBottom For i = 2 To Range("H1").End(xlDown).Row If Range("H" & i).Text <> Range("H" & i - 1).Text Then Open myPath & Range("H" & i).Text & ".html" For Output As #1 Print #1, "<!DOCTYPE html>" & vbNewLine _ & "<html lang=""en"">" & vbNewLine _ & "<body>" & vbNewLine _ & "<div class=""span3"" id=""sidebar"">" & vbNewLine End If Print #1, "<div class=""widget"">" & vbNewLine _ & "<h4 class=""widgetTitle"">" & Range("A" & i).Text & "</h4>" & vbNewLine _ & "<ul><li>" & Range("B" & i).Text & "</li>" & vbNewLine _ & "<li><a href=""/sho/" & Range("I" & i).Text & ".html"">連絡先・地図はこちら</a></li></ul></div>" & vbNewLine If Range("H" & i).Text <> Range("H" & i + 1).Text Then Print #1, "</div>" & vbNewLine & "</body>" & vbNewLine & "</html>" Close #1 End If Next End Sub Sub 小分類HTMLソース() Dim fso As Object 'ファイルシステムオブジェクト Dim strPath As String '削除対象ファイル Set fso = CreateObject("Scripting.FileSystemObject") strPath = Environ("USERPROFILE") & "\Desktop\sho\*.*" fso.DeleteFile strPath, True Set fso = Nothing 'ファイルの削除（読み取り専用の場合も削除） Dim myPath As String Dim i As Long myPath = Environ("USERPROFILE") & "\Desktop\sho\" Range("A:I").Sort Key1:=Range("I2"), Header:=xlYes, MatchCase:=False, _ Orientation:=xlTopToBottom For i = 2 To Range("I1").End(xlDown).Row If Range("I" & i).Text <> Range("I" & i - 1).Text Then Open myPath & Range("I" & i).Text & ".html" For Output As #1 Print #1, "<!DOCTYPE html>" & vbNewLine _ & "<html lang=""en"">" & vbNewLine _ & "<body>" & vbNewLine _ & "<div class=""span3"" id=""sidebar"">" & vbNewLine End If Print #1, "<div class=""widget"">" & vbNewLine _ & "<h4 class=""widgetTitle"">" & Range("A" & i).Text & "</h4>" & vbNewLine _ & "<ul><li>" & Range("B" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("C" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("D" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("E" & i).Text & "</li></ul></div>" & vbNewLine If Range("I" & i).Text <> Range("I" & i + 1).Text Then Print #1, "</div>" & vbNewLine & "</body>" & vbNewLine & "</html>" Close #1 End If Next End Sub
AccessでActiveDirectoryデータを管理したいと考えておりますが、ADからcsvdeで出力した後、Accessにインポートしています。 が、"DN"フィールドに、分割管理したい項目がまとめて入っており、分割する為のクエリを作成したいと思いますが、文字の抽出方法が分かりません。 CN=日本語ユーザー名（可変長）,OU=OU名（可変長）,DC=下位ドメイン名,DC=上位ドメイン名,DC=local ◎下記項目を切り出し CN=〇〇〇 OU＝〇〇〇 単純に、Left関数・Mid関数では切り出し出来ない為、コーディング方法をお教え頂けましたら幸いです。
VB2008を使用している初心者です。 Excelをオープンすることは出来ましたが、作業するSheetの指定が出来なくてこまっています。作業するSheetをアクテイブにするためのコード、プロパティ、パラメータ、など教えてください。
たびたびお世話になっております、VBA初心者です。 同じ形式の複数のエクセルBOOKに入っている特定の列の特定の行範囲にあるデータを、 別の集計用エクセルBOOKの単一のシートの中に順々にコピーをしていきたいのです。 集計用BOOKの特定の行には、データBOOKのBOOK名が横にずらっと記載されて おり、集計用BOOKに組んだVBAでBOOK名を読み取り、そのBOOK名のデータBOOKを 開き、特定セル範囲（A2:A1000）の値をコピーし、集計用BOOKのBOOK名が記載されて いる列に貼り付けしていく。同様に、集計用BOOKの右どなりの列に記載されている BOOK名を読み取り、そのBOOKを開き．．．と継続し、集計用BOOKにデータ用BOOK 名が記載されていない列まできたら、Do Whileステートメントを終了する、ということ をやりたいのです。 ＜問題点＞ 集計用BOOKに記載のあるデータ用BOOK名のBOOK自体が存在しないものがあるのです。存在しない場合は無視して次に進んで行ってほしいのですが、「ファイルが見つかりません」とメッセージが出て先に進まないのです。IFとTHENを使ってやってみたのですが、IFの中の構文の作り方がよくわからず、なにかうまい方法はありましたら教えて頂きたいのですが。 ＜プログラム＞ Sub W() Dim ファイル名 As String Dim 列番号 As Long 列番号 = 4 Do While Cells(2, 列番号).Value <> "" ファイル名 = Cells(2, 列番号).Value Workbooks.Open "D:\学校\データ\" & ファイル名 & ".xlsx" Range("A2:A1000").Copy Application.DisplayAlerts = False ActiveWorkbook.Close ThisWorkbook.Activate ActiveSheet.Paste Cells(5, 列番号) 列番号 = 列番号 + 1 Loop End Sub よろしくお願いいたします！
よろしくお願いいたします。 下記をやろうとした際、「クリップボードに大きな情報があり．．．．．」なる メッセージが都度出てしまい、次に進みません。 これを回避する方法を教えて頂きたいのですが。 ＜やりたいこと＞ 同じ形式の複数のエクセルBOOKに入っている特定の列の特定の行範囲にあるデータを、 別の集計用エクセルBOOKの単一のシートの中に順々にコピーをしていきたいのです。 集計用BOOKの特定の行には、データBOOKのBOOK名が横にずらっと記載されて おり、集計用BOOKに組んだVBAでBOOK名を読み取り、そのBOOK名のデータBOOKを 開き、特定セル範囲（A2:A5）の値をコピーし、集計用BOOKのBOOK名が記載されて いる列に貼り付けしていく。同様に、集計用BOOKの右どなりの列に記載されている BOOK名を読み取り、そのBOOKを開き．．．と継続し、集計用BOOKにデータ用BOOK 名が記載されていない列まできたら、Do Whileステートメントを終了する、ということ をやりたいのです。 ＜問題点＞ 実行させると、「修飾子が不正です」なるメッセージが出てしまい 先に進まないのです。 ＜プログラム＞ Sub W() Dim ファイル名 As String Dim 列番号 As Long 列番号 = 4 Do While Cells(2, 列番号).Value <> "" ファイル名 = Cells(2, 列番号).Value Workbooks.Open "D:\学校\データ\" & ファイル名 & ".xlsx" Range("A2:A1000").Copy ThisWorkbook.Activate ActiveSheet.Paste Cells(5, 列番号) ファイル名.Activate Workbook.Application.CutCopyMode = False ActiveWorkbook.Close 列番号 = 列番号 + 1 Loop End Sub ＜エラー発生部分＞ ファイル名.Activate ＜補足＞ 「ファイル名.Activate Workbook.Application.CutCopyMode = False」 という部分はもともとなかったのですが、データが入っているBOOKを閉じる際 「クリップボードに大きな情報があります。この情報．．．」なるメッセージが 出てしまったため、回避策として追加修正したものです。 すみませんお手数ですが、よろしくお願いいたします。
業務にて、選択した範囲の名前のシートを作成し、 なおかつその内容は「マスタ」というシートをコピーする。というマクロを作ったのですが、うまくいきません。 名前のシートを作成するのみならばうまくいくのですが、内容をコピーしようとすると、逆順になり、空白のシートが挿入されます。 最終的には降順（名称にはNo.があります）になり、空白のシートが挿入されないようにしたいです どうしたらうまくいくのでしょうか？ ==== Sub 連続シート作成() For Each 対象セル In Selection Sheets.Add After:=ActiveSheet Sheets("マスタ").Copy After:=Sheets("マスタ") ActiveSheet.Name = 対象セル.Value Next 対象セル End Sub
今折れ線グラフを作成しています。 データの範囲設定で悩んでいます。 項目軸ラベルのセル範囲と、グラフデータのセル範囲を指定を以下のように設定し折れ線グラフを作成しました。 Set RngData = Union(Wb3Sh6.Range(Cells(範囲1, 1), Cells(範囲2 - 1, 1)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 12), Cells(範囲2 - 1, 12)), _ 　　　　　　　　　　　　 Wb3Sh6.Range(Cells(範囲1, 18), Cells(範囲2 - 1, 18)), _ 　　　　　　　　　　　　 Wb3Sh6.Range(Cells(範囲1, 33), Cells(範囲2 - 1, 33)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 34), Cells(範囲2 - 1, 34)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 39), Cells(範囲2 - 1, 39)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 40), Cells(範囲2 - 1, 40))) ActiveChart.SetSourceData Source:=RngData, PlotBy:=xlColumns ですが。 項目軸を「Wb3Sh6.Range(Cells(範囲1, 12), Cells(範囲2 - 1, 12)), 」 のみとしたいのに 項目軸が「Wb3Sh6.Range(Cells(範囲1, 1), Cells(範囲2 - 1, 1)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 12), Cells(範囲2 - 1, 12)), _ 　　　　　　　　　　　　 Wb3Sh6.Range(Cells(範囲1, 18), Cells(範囲2 - 1, 18)), _ 　　　　　　　　　　　　 Wb3Sh6.Range(Cells(範囲1, 33), Cells(範囲2 - 1, 33)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 34), Cells(範囲2 - 1, 34)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 39), Cells(範囲2 - 1, 39)), _」 となってしまいます。 項目軸を確実に設定したいのですが、どうすればよいでしょうか。
ひとつのエクセルに　BOOK1,2　を　起こして BOOK1　から　BOOK2　の　自作フォームの　テキストに　値は　送り込めないのでしょうか？ シートのセルと　ボタンは　可能なのですが・・・ Workbooks("Book2.xlsm").Worksheets("Sheet1").Range("A1:a4").Copy Workbooks("test.xlsm").Worksheets("Sheet2").Range("A1:a4").PasteSpecial Workbooks("test.xlsm").Worksheets("Sheet2").opb2.Value = True フォームには何か書き方が有るのでしょうか
VBA初心者です。 VBAで作成したプログラムがエラーで止まってしまい、先に進まないのです。 わかる方いらっしゃいましたら、ご教示頂けないでしょうか。 ＜やりたいこと＞ 同じ形式の複数のエクセルBOOKに入っている特定の列の特定の行範囲にあるデータを、 別の集計用エクセルBOOKの単一のシートの中に順々にコピーをしていきたいのです。 集計用BOOKの特定の行には、データBOOKのBOOK名が横にずらっと記載されて おり、集計用BOOKに組んだVBAでBOOK名を読み取り、そのBOOK名のデータBOOKを 開き、特定セル範囲（A2:A5）の値をコピーし、集計用BOOKのBOOK名が記載されて いる列に貼り付けしていく。同様に、集計用BOOKの右どなりの列に記載されている BOOK名を読み取り、そのBOOKを開き．．．と継続し、集計用BOOKにデータ用BOOK 名が記載されていない列まできたら、Do Whileステートメントを終了する、ということ をやりたいのです。 ＜問題点＞ 実行させると、「実行時エラー'1004' 'Range'メソッドは失敗しました :'Global'オブジェクト」なるメッセージが出て、先に進まないのです。 ＜プログラム＞ Sub W() Dim ファイル名 As String Dim 列番号 As String 列番号 = c Do While Range(列番号 & "5").Value <> "" ファイル名 = Range(列番号 & "5").Value Workbooks.Open "D:\学校\データ\" & ファイル名 & ".xlsx" Range("A2:A5").Copy ActiveWorkbook.Close ThisWorkbook.Activate ActiveSheet.Paste Range(列番号 & "6") 列番号 = 列番号 + 1 Loop End Sub ＜エラー発生部分＞ Do While Range(列番号 & "5").Value <> "" ＜補足＞ ちなみに、VBAの組んであるBOOKは「学校」フォルダの中、データが入っている BOOKは「データ」フォルダの中に格納されています。 以上お手数をおかけしますが、よろしくお願いいたします。
エクセルのVBA初心者です。 最近、といっても２～３日前に始めたのですが、簡単なところで つまづいてしまい、本を読んでもにっちもさっちもいかず、困っております。 下記にやりたいことと、構文を記載しますので、お手数ですがアドバイスを 頂ければ助かります。 ＜やりたいこと＞ 特定のセルに記載された文字をファイル名としたエクセルファイルを VBAで開きたい。 ＜構文＞ Sub W() Dim ファイル名 As Integer ファイル名 = Range("C5").Value Workbooks.Open "D:\日本\データ\ファイル名.xlsx" End Sub ＜問題点＞ 上記のように構文を組んでも、「実行時エラー　'1004'」なるメッセージが出て 「＊＊＊が見つかりません。ファイル名およびファイルの保存場所が正しいか．．．」とのメッセージが出てしまいます。 C5のセルにはファイル名が記載され、このファイル名を変数としたつもりです。 VBAが入っているファイルは、「日本」というフォルダに入っており、変数によるファイルは「日本」というフォルダの子供である「データ」というフォルダに入っています。 アドバイスよろしくお願いします。
エクセルで作成した住所録があります。 数が増えてきたのでコードで分類したいと考えています。 現在の住所録には「大分類」のＣ列まで入力されています。 ここからＶＢＡによって、 「中分類」と「小分類」を入力したいと思います。 ＊中分類は末尾に２ケタの数字を追加（２０ごとに　01、02、03　とする。） ＊小分類は末尾に１ケタの英字を追加（１つごとに　A、B、C　とする） どうかよろしくお願いいたします。
VB2008でExcel（.xls）のセルデータを読み込もうと思い、ネットにあるものを試しましたが、全くよみこめません。列と行を整数型変数で指定して読み込む方法を教えてください。
お世話になります。 Accessにて顧客管理システムを作成しています。掲題について、連結サブフォームでの入力項目の郵便番号には入力支援として住所の自動入力は設定しています。 ただ、その郵便番号入力後 住所を入力者が変えた時、郵便番号と異なる場合のチェックを保存処理のボタンを押したタイミングでDBに予め用意したフラグフィールドに付けたいです。 このチェック方法をVbaのコードで示して頂けると助かります。どうかよろしくお願いいたします。 ※住所から郵便番号を自動入力で変えるということは考えてません。郵便番号と住所、どちらが正しい情報なのか区別するため、ただ一致しないという判別をつけるだけであとで入力者本人に確認する運用にします。
会社リストからＨＴＭＬファイルを作成しています。 １つの地域で１つのファイルにしています。 地域によっては会社数が多くなってきたので、 ２０社ごとにファイルを別にして出力したいと考えております。 tokyo tokyo2 tokyo3 tokyo4 　・ 　・ 　・ Ｇ列のファイル名を２０社ごとに変換するには 以下のソースをどのように改良すれば良いのか、ご教授願います。 Sub HTMLファイル出力() Dim myPath As String Dim i As Long myPath = Environ("USERPROFILE") & "\Desktop\Hoge\" Range("A:G").Sort Key1:=Range("G2"), Header:=xlYes, MatchCase:=False, _ Orientation:=xlTopToBottom For i = 2 To Range("G1").End(xlDown).Row If Range("G" & i).Text <> Range("G" & i - 1).Text Then Open myPath & Range("G" & i).Text & ".html" For Output As #1 Print #1, "<!DOCTYPE html>" & vbNewLine _ & "<html lang=""en"">" & vbNewLine _ & "<body>" & vbNewLine _ & "<div class=""span3"" id=""sidebar"">" & vbNewLine End If Print #1, "<div class=""widget"">" & vbNewLine _ & "<h4 class=""widgetTitle"">" & Range("A" & i).Text & "</h4>" & vbNewLine _ & "<ul><li>" & Range("B" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("C" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("D" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("E" & i).Text & "</li></ul></div>" & vbNewLine If Range("G" & i).Text <> Range("G" & i + 1).Text Then Print #1, "</div>" & vbNewLine & "</body>" & vbNewLine & "</html>" Close #1 End If Next End Sub
エクセル2003で作成した会社の一覧表があります。 Sheet1は会社一覧（上図） Sheet2はエリア表（下図）です。 マクロを使用して、Sheet1のＧ列にエリアの読みを表示 どうにか自分でやろうとしたのですが、できませんでした。 Sheet1の最後まで行くとストップするようにしたいのです。 どうかご教授お願いいたします。
エクセル2003で商品の一覧表を作成しています。 Sheet1は商品一覧（左図） Sheet2は価格表（右図）となっています。 マクロを使用して、Sheet1のB列に価格表のデータを転記させたいと考えています。 VLookupになるのかと思い、自分でいろいろとやってみたのですが、 どうしても動作せず、挫折してしまいました。 商品一覧の最後の行までいって、空白セルがくると止まるというのが、 難しくてできませんでした。 どうかお願いいたします。
エクセル2003で作成した住所録があります。 県名（３文字）のみを抽出して、新たに設けたD列に表示させたいと考えています。 Sub 県名の列作成() 　Dim myStr As String 　myStr = ActiveCell.Value 　Range("D2").Value = Left(myStr,3) End Sub ここまで、できたのですが・・・・ B列の２行目から順に処理をして、一覧表の最後まで行って、 空白セルの行が見つかったら終了させる方法が分かりません。 どうかよろしくお願いします。
会社のPCがExcel2010からExcel2013に変更されたのですが、Excel2010の環境で作成していたVBAマクロの処理がもの凄く遅くなってしまいました。 Excel2010では10秒ほど待てば終わった処理が30分以上かかるようになってしまい、業務効率を上げるために作ったVBAが逆に非効率になってしまい困っております。 (フリーズしたような感じになりますが、長時間までは処理は終わり、エラーは出ておりません) Excel2013で重くなった箇所を調べていたら、下記コード部分の繰返し処理で重くなっているのが分かりました。 処理の概要は、「全体」シートの指定列の最終行のセルから指定された番号(12345)があるか１行ずつ調べていき、ヒットしたらその行を全体を切取り、「●●」シートの最終行に貼り付けていく単純なものです。 「全体」シート行数は8000～10000行あります。 ・重くなっている処理の箇所 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Application.ScreenUpdating = False ActiveWorkbook.Worksheets("全体").Activate LastRow = Cells(Rows.Count, 1).End(xlUp).Row For i = 1 To LastRow If Cells(i, 5).Value Like "12345" Then Rows(i).Cut Sheets("●●").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0) End If Next i ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Excel2010で問題のなかった処理がExcel2013になって途端に重くなった原因自体も分かりませんが、問題点の回避方法や処理速度を改善する方法はありませんでしょうか。 よろしくお願いいたします。
早速ですが Cells(cnt, n - 5) = WorksheetFunction.Sum(Me.Range("cr" & cnt + 1 & ":ct" & cnt + 1)) は　通っています。 sumの範囲を　可変にしたいので 可変値　$CR$6　＝3　とします（ｃｒ、ｃｓ、ｃｔ） で Cells(cnt, n - 3) = WorksheetFunction.Sum(Me.Range("cr" & cnt & ":" & Offset("cr" & cnt, $CR$6 * -1, 1))) が　OFFSETが　定義されていない　となります こうした、使い方は出来ないのでしょうか 他の方法があればご教示ください
現在、ユーザーフォームに60個のテキストボックスを設置しています。 数値入力されるとカンマが付くようコードを書いているのですが、まとめて処理できるようなコードはないでしょうか？ 現在… Private Sub TextBox1_Change() TextBox1.Text = Format(TextBox1.Text, "#,##0") End Sub Private Sub TextBox2_Change() TextBox2.Text = Format(TextBox2.Text, "#,##0") End Sub Private Sub TextBox3_Change() TextBox3.Text = Format(TextBox3.Text, "#,##0") End Sub これを60個 試しにfor～Nextで書いてみましたが、失敗しました。 Dim c As Integer For c = 1 To 60 Controls("TextBox" & c).Text = Format("TextBox" & c.Text, "#,##0") Next End Sub ご存知の方、お力を貸してください。 ウィンドウズ7のエクセル2013を使用しています。
現在、グループの数だけユーザー名の合計数をSheet2に抽出するという 事をやっているのですが....... コードの方は下記になります Sub Sample3() Dim i As Long, j As Long, k As Long, lastRow As Long, lastCol As Long Dim wS2 As Worksheet, wS3 As Worksheet Set wS2 = Worksheets("Sheet1") Set wS3 = Worksheets("Sheet2") Application.ScreenUpdating = False If wS2.Range("Y1") = "" Then wS2.Range("Y1") = "ダミー" End If With Worksheets("Sheet1") If .Range("A4") = "" Then .Range("A4") = "ダミー" End If lastRow = .Cells(Rows.Count, "B").End(xlUp).Row Range(.Cells(5, "B"), .Cells(lastRow, "B")).AdvancedFilter Action:=xlFilterCopy, copytorange:=wS3.Range("A1"), unique:=True '★ For i = 2 To wS3.Cells(Rows.Count, "A").End(xlUp).Row wS2.Cells(7, (i - 2) * 8 + 3) = wS3.Cells(i, "A") .Range("A4").AutoFilter field:=2, Criteria1:=wS3.Cells(i, "A") Range(.Cells(5, "AA"), .Cells(lastRow, "AA")).SpecialCells(xlCellTypeVisible).Copy wS2.Cells(7, (i - 2) * 8 + 2) For k = wS2.Cells(Rows.Count, (i - 2) * 8 + 2).End(xlUp).Row To 7 Step -1 wS2.Cells(k, (i - 2) * 8 + 3) = WorksheetFunction.CountIfs(.Range("AA:AA"), wS2.Cells(k, (i - 2) * 8 + 2), .Range("B:B"), _ wS2.Cells(7, (i - 2) * 8 + 3)) If WorksheetFunction.CountIf(wS2.Columns((i - 2) * 8 + 2), wS2.Cells(k, (i - 2) * 8 + 2)) > 1 Then wS2.Cells(k, (i - 2) * 8 + 2).Resize(, 2).Delete shift:=xlUp End If Next k Next i wS2.Range("B1").CurrentRegion.Borders.LineStyle = xlContinuous wS2.Cells.Replace what:="ダミー", replacement:="", lookat:=xlWhole .Cells.Replace what:="ダミー", replacement:="", lookat:=xlWhole wS3.Cells.Clear .AutoFilterMode = False End With Application.ScreenUpdating = True End Sub このコードで検索をかけるSheet1のセルBの文字をセルCに移動して検索かけたいという事なのですが、下記の用なコードでBをCに変更してみた結果エラーが発生してしまいます。 lastRow = .Cells(Rows.Count, "C").End(xlUp).Row Range(.Cells(5, "C"), .Cells(lastRow, "C")).AdvancedFilter Action:=xlFilterCopy, copytorange:=wS3.Range("A1"), unique:=True '★ For i = 2 To wS3.Cells(Rows.Count, "A").End(xlUp).Row wS2.Cells(7, (i - 2) * 8 + 3) = wS3.Cells(i, "A") .Range("A4").AutoFilter field:=2, Criteria1:=wS3.Cells(i, "A") Range(.Cells(5, "AA"), .Cells(lastRow, "AA")).SpecialCells(xlCellTypeVisible).Copy wS2.Cells(7, (i - 2) * 8 + 2) For k = wS2.Cells(Rows.Count, (i - 2) * 8 + 2).End(xlUp).Row To 7 Step -1 wS2.Cells(k, (i - 2) * 8 + 3) = WorksheetFunction.CountIfs(.Range("AA:AA"), wS2.Cells(k, (i - 2) * 8 + 2), .Range("C:C"), _ どなたかご教授の方お願い致します。
WEBページのテキストを取り込んで、携帯あてメールで転送するのですが、今まで、文字コードを意識せず使っていたのですが、YAHOO.BBの携帯（グーグルNEXUS5）に送ると　文字化けします。 一番簡単な文字コード指定の方法は無いでしょうか？ネットでは保存されたファイルの変換等のサンプルは有るのですが、 StrConv関数の使い方的な方法でJIS-2022-JP（これで良いハズ？）に化けてくれると良いのですが・・・ 今のコードは SendMail oObjDoc.documentElement.outerHTML　’web取り込み Public Sub SendMail(txt As String) Dim CDOMail As Variant Dim STUl 'On Error Resume Next Application.DisplayAlerts = False Set CDOMail = CreateObject("CDO.Message") CDOMail.From = ConfigForm.TxtSendAddr.value CDOMail.To = ConfigForm.TxtDesMailAddr.value If Len(sTitle) > 0 Then CDOMail.Subject = sTitle Else CDOMail.Subject = ConfigForm.TxtTitle.value End If 'CDOMail.TextBody = txt CDOMail.HtmlBody = txt 'CDOMail.AddAttachment ThisWorkbook.FullName STUl = "http://schemas.microsoft.com/cdo/configuration/" With CDOMail.Configuration.Fields .Item(STUl & "smtpserver") = ConfigForm.TxtSendServer.value .Item(STUl & "smtpserverport") = ConfigForm.TxtPort.value .Item(STUl & "sendusing") = 2 .Item(STUl & "smtpauthenticate") = 1 .Item(STUl & "sendusername") = ConfigForm.TxtSendUser.value .Item(STUl & "sendpassword") = ConfigForm.TxtSendPwd.value .Item(STUl & "smtpconnectiontimeout") = 60 .Update End With CDOMail.Send Application.DisplayAlerts = True End Sub
VB .netで自分のドキュメントにフォルダを作成する方法を教えて下さい。 普通のフォルダ作成はできました。 System.IO.Directory.CreateDirectory("c:\test\test") 自分のドキュメントに作りたいので以下のようにやってみましたがダメでした。 System.IO.Directory.CreateDirectory("%USERPROFILE%\Documents\test") 何かやり方がありますか？ それとも以下のようなベタ書きしかできませんか？ System.IO.Directory.CreateDirectory("c:\Users\user1\Documents\test")
VisualBasic2008です。 csvファイルに「タイトル名」が100個あります。 フォームに100個のボタンがあり、起動時にcsvの「タイトル名」でボタンのtextを動的に変更しています。 この動的な変更をやめて、ボタンのtextを固定したいと思います。 ひとつずつ手動でtextを変更すればできるのですが、なかなか大変です。 そこで動的に変更した状態をそのまま保存し、コードを取り除くことができれば一番いいのですが・・・ そんなことできるでしょうか？ もちろんコードの削除は手動で問題ありません。
エクセル「Excel2003」ブックのデータを仕分けしてテキストファイルを作成する。 住所録（全国一覧表：シート１枚に記載）があります。 住所ごとにデータを分けて、個別のテキストファイルを作成する ※テキストファイルのファイル名は地域コード（英数字）にする。 　tokyo.html ※テキストファイルの種類は、HTMLファイル ※住所録の項目は、 　会社名、住所、電話、FAX、担当者、地域コード　の６個 ※HTMLファイルに表示させるのは地域コードを除いた５項目 ※以下は、HTMLファイルの例になります。 <!DOCTYPE html> <html lang="en"> <body> <div class="span3" id="sidebar"> <div class="widget"> <h4 class="widgetTitle">会社名1</h4> <ul><li>住所1</li> <li>電話番号1</li> <li>ファックス1</li> <li>担当者1</li></ul></div> <div class="widget"> <h4 class="widgetTitle">会社名2</h4> <ul><li>住所2</li> <li>電話番号2</li> <li>ファックス2</li> <li>担当者2</li></ul></div> <div class="widget"> <h4 class="widgetTitle">会社名3</h4> <ul><li>住所3</li> <li>電話番号3</li> <li>ファックス3</li> <li>担当者3</li></ul></div> <div class="widget"> <h4 class="widgetTitle">会社名4</h4> <ul><li>住所4</li> <li>電話番号4</li> <li>ファックス4</li> <li>担当者4</li></ul></div> <div class="widget"> <h4 class="widgetTitle">会社名5</h4> <ul><li>住所5</li> <li>電話番号5</li> <li>ファックス5</li> <li>担当者5</li></ul></div> <div class="widget"> <h4 class="widgetTitle">会社名6</h4> <ul><li>住所6</li> <li>電話番号6</li> <li>ファックス6</li> <li>担当者6</li></ul></div> </div> </body> </html>
現在、関数ではなく　VBAでマクロを勉強しているのですが、 下記のコードでエラーが発生してしまいます。 是非、ご教授願えませんでしょうか。 Sheet3を作業用のSheetとして使用しています。　 Sub Sample1() Dim i As Long, k As Long, lastRow As Long, wS2 As Worksheet, wS3 As Worksheet Set wS2 = Worksheets("Sheet2") Set wS3 = Worksheets("Sheet3") Application.ScreenUpdating = False With Worksheets("Sheet1") lastRow = .Cells(Rows.Count, "A").End(xlUp).Row .Range("A:A").AdvancedFilter Action:=xlFilterCopy, copytorange:=wS3.Range("A1"), unique:=True For i = 2 To wS3.Cells(Rows.Count, "B").End(xlUp).Row .Range("B1").AutoFilter field:=1, Criteria1:=wS3.Cells(i, "B") Range(.Cells(3, "B"), .Cells(lastRow, "B")).SpecialCells(xlCellTypeVisible).Copy wS2.Cells(3, (i - 1) * 2) For k = wS2.Cells(Rows.Count, (i - 1) * 2).End(xlUp).Row To 2 Step -1 wS2.Cells(k, (i - 1) * 2 - 1) = WorksheetFunction.CountIfs(.Range("A:A"), wS3.Cells(i, "A"), _ .Range("C:C"), wS2.Cells(k, (i - 1) * 2)) For j = 2 To wS3.Cells(Rows.Count, "E").End(xlUp).Row .Range("E1").AutoFilter field:=1, Criteria1:=wS3.Cells(j, "E") Range(.Cells(3, "E"), .Cells(lastRow, "E")).SpecialCells(xlCellTypeVisible).Copy wS2.Cells(3, (j - 1) * 2) For l = wS2.Cells(Rows.Count, (j - 1) * 2).End(xlUp).Row To 2 Step -1 wS2.Cells(j, (j - 1) * 2 - 1) = WorksheetFunction.CountIfs(.Range("A:A"), wS3.Cells(j, "A"), _ .Range("E:E"), wS2.Cells(k, (j - 1) * 2)) If WorksheetFunction.CountIf(wS2.Columns((j - 1) * 2), wS2.Cells(k, (j - 1) * 2)) > 1 Then wS2.Cells(l, (j - 1) * 2 - 1).Resize(, 2).Delete shift:=xlUp End If Next k Next i wS2.Range("A1").CurrentRegion.Borders.LineStyle = xlContinuous .AutoFilterMode = False End With Application.ScreenUpdating = True End Sub 実際に抽出結果を出したい概要は下記に用になります。 検索したいsheet1には セルBにはUsername番号などがあります。 　　　　　A　　　　　　　　B　　　　　　　C　　　　　D　　　　　E　　　　　F　　　　　G １　　　　　　　　　　　Ｕｓｅｒｎａｍｅ　　　　　　Ｇｒｐ番号　　　 ２　　　　　　　　　　　ｙａｍａｄａ１０ｘ　　　　　　Ｇｒｐ１　　　　　　　　　　　　 ３　　　　　　　　　　　ｙａｍａｄａ４ｘ　　　　　　　Ｇｒｐ１　　　 ４　　　　　　　　　　　ｙａｍａｄａ１０ｘ　　　　　　Ｇｒｐ１ ５　　　　　　　　　　　ｙａｍａｄａ１０ｘ　　　　　　Ｇｒｐ１ ６　　　　　　　　　　　ｙａｍａｄａ４ｘ　　　　　　　Ｇｒｐ２ ７　　　　　　　　　　　ｙａｍａｄａ１０ｘ　　　　　　Ｇｒｐ２ ８　　　　　　　　　　　ｙａｍａｄａ４ｘ　　　　　　　Ｇｒｐ２ ９　　　　　　　　　　　ｙａｍａｄａ１０ｘ　　　　　　Ｇｒｐ３ ． ． ５０　　　　　　　　　　　ｙａｍａｄａ４ｘ　　　　　　Gｒｐ４０ Sheet2にはセルBとCにyamada10xの合計数とgrp番号、セルEとFにはyamada4xの合計数とgrp番号などがあります。 　　　　　A　　　　　　　　B　　　　　　　　　　C　　　　　　　D　　　　　　　　E　　　　　　　　　　　F　　　　　 １ ２　　　　　　　ｙａｍａｄａ１０ｘの合計数　Ｇｒｐ番号　　　　　　　ｙａｍａｄａ４ｘの合計数　　Ｇｒｐ番号　　 ３　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 ４　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 ５　　　　　　　　　　　　　　 ． ． １０　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 sheet1で検索したユーザ名・Grp番号などを行数3のセルC・ＦにはGrp番号を抽出 行数3のセルB・ＥにはGrp番号ごとのｙａｍａｄａ１０ｘとｙａｍａｄａ４ｘの合計数をsheet2に 抽出させたいという形になります。 　　　　　　A　　　　　　　　B　　　　　　　　　　C　　　　　　　D　　　　　　　　E　　　　　　　　　　F　　　　　 １ ２　　　　　　　ｙａｍａｄａ１０ｘの合計数　　Ｇｒｐ番号　　　　　　　ｙａｍａｄａ４ｘの合計数　Ｇｒｐ番号　　 ３　　　　　　　　　　　　　　　３　　　　　　　　　Ｇｒｐ１　　　　　　　　　　　 １　　　　　　　　Ｇｒｐ１ ４　　　　　　　　　　　　　　　１　　　　　　　　　Ｇｒｐ２　　　　　　　　　　　 ２　　　　　　　　Ｇｒｐ２ ５　　　　　　　　　　　　　　　１　　　　　　　　　Ｇｒｐ３ ． ． １０　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　１　　　　　　　Ｇｒｐ４０ わかりにくい図と説明で申し訳ございません。 お手数をおかけしますが、ご教授の方をお願いできますでしょうか。 よろしくお願い致します。
ワークシートイベント内で、 セルの値に応じて行色を変更する処理をしているのですが、 オートフィルをした場合、 範囲内のセル全てに処理が適応されません 何か解決策はありますでしょうか？
Ｅｘｃｅｌｌ　ＶＢＡ　にて ユーザーフォーム内に［コマンドボタン］を配置し、このボタンにてユーザーフォームの消去およびその他の作業を行うコードを書い動作させています ユーザーフォームの右上隅に表示されている［×］ボタンを表示しない（又は消去する）方法をおしえてください
質問です。 定期的に更新されるテキストファイルをFileSystemWatcherクラスで監視し、 FileSystemWatcher.OnChangedで変更があった時に、 変更された内容や追記されたを検出したいのですが、 どうすればいいでしょうか？ 前データを予めRenderなどで取得しておき、それをIFでチェックする処理を 毎秒や毎分置きにすると負荷が掛かりそうですし、 何か良い提案を探しています。 Q, 変更された内容や追記されたを検出したいのですが、 どうすればいいでしょうか？ Q, 仮にIFでチェックした際に負荷を軽減化する場合は？ よろしくお願いします。
こんにちは。 EXCELの表からグラフが自動表示されるように設定しております。 ただ、表は日々、更新されデータが増えていきます。 そこで、最終行が更新されたデータに合わせてグラフの選択範囲が変動されるように したいです。 イメージは添付画像の通りです。 以下の関数をどのように修正するべきかをご教授ください。 よろしくお願いします。 FX!$N$1:$N$500
Win7とExcel2007でマクロ作成の初心者です。 Sub 選択範囲を広げる() Sheets("計算").Select Range("CU6").Select Selection.Resize(, Selection.Columns.Count + 27).Select ここで選んだセルの選択部分を、下の行に向かって選択範囲を広げたいです。 ただ、下方の行数は、常に変動するため、どうやって変動の選択範囲を広げたいか わかりません。よろしくお願いします。 表のCU6以下は、文字列と空白が交互にあります。 End Sub
現在vb.netでインストーラを作成しています。 (1)その中でexeファイルをレジストリに登録しようと考えています。 そのexeファイルを登録することはvb.netで可能でしょうか？ (2)またアンインストールも同じプロジェクトで作成しようと考えているのですがそれも可能ですか？ わかる方がいらしたら教えていただきたいと思います。 よろしくお願いします。
を勉強したいです。 ビジュアルベーシックってなに？というレベルです。（レベルじゃない） 無料で講習を受けたいです。 どこかで講習会等は開催されていませんか？ 滋賀県在住です。
はじめまして、業務用で下記の用にExcel VBABasicでマクロを 組みたいのですが、組み方の方がわかりません。 是非、ご教授願えませんでしょうか。 Ms Oficeは2010です。 検索したいsheet1には ユーザの名前とGrp番号などがあります。 　　　　　A　　　　　　　　B　　　　　C　　　　　D　　　　　E　　　　　F　　　　　G １　Ｕｓｅｒｎａｍｅ　　　Ｇｒｐ番号　　　 ２　ｙａｍａｄａ１０ｘ　　　Ｇｒｐ１　　　　　　　　　　　　 ３　ｙａｍａｄａ４ｘ　　　　Ｇｒｐ１　　　 ４　ｙａｍａｄａ１０ｘ　　　Ｇｒｐ１ ５　ｙａｍａｄａ１０ｘ　　　Ｇｒｐ１ ６　ｙａｍａｄａ４ｘ　　　　Ｇｒｐ２ ７　ｙａｍａｄａ１０ｘ　　　Ｇｒｐ２ ８　ｙａｍａｄａ４ｘ　　　　Ｇｒｐ２ ９　ｙａｍａｄａ１０ｘ　　　Ｇｒｐ３ ． ． ５０　ｙａｍａｄａ４ｘ　　　　ｇｒｐ４０ Sheet2にはyamada10xやyamada4xの合計数とＧｒｐ番号などがあります 　　　　　　A　　　　　　　　　　　　　　B　　　　　　　C　　　　　　　　　　　　　D　　　　　　　E　　　　　F　　　　　 １　　ｙａｍａｄａ１０ｘの合計数　Ｇｒｐ番号　　ｙａｍａｄａ４ｘの合計数　　Ｇｒｐ番号　　 ２　　　　　　　　　　　　　　　　　 ３　 ４ ５ sheet1で検索したGrp番号などの合計数を下記の用にGrp番号にはGrp１などを抽出 そのGrp番号に合ったyamada10xやyamada4xの合計数などをsheet2に抽出させたいのですが 　　　　　　A　　　　　　　　　　　　　　B　　　　　　　C　　　　　　　　　　　　　D　　　　　　　E　　　　　F　　　　　 １　　ｙａｍａｄａ１０ｘの合計数　Ｇｒｐ番号　　ｙａｍａｄａ４ｘの合計数　　Ｇｒｐ番号　　 ２　　　　　３　　　　　　　　　　　　　Ｇｒｐ１　　　　　１　　　　　　　　　　　　Ｇｒｐ１ ３　　　　　１　　　　　　　　　　　　　Ｇｒｐ２　　　　　２　　　　　　　　　　　　Ｇｒｐ２ ４　　　　　１　　　　　　　　　　　　　Ｇｒｐ３ ． ． １０　　　　　　　　　　　　　　　　　　　　　　　　　　　１　　　　　　　　　　　　Ｇｒｐ４０ わかりにくい図で申し訳ございません。 お手数をおかけしますが、ご教授の方をお願いできますでしょうか。 よろしくお願い致します。
vb.netで作成したexeファイルをアンインストールする際にパスワード認証をさせたいのですが、可能ですか？ また、可能の場合どうすればいいですか？ ご存じの方がいらしたらおしえていただけないでしょうか。。 よろしくお願いします。
vb.netで作成したEXEファイルを終了させないアプリにしたいと考えています。 そのため、タスクマネージャーの”プロセスの終了”でもそのアプリが終了しないようにしたいのですがそれは可能でしょうか？
vbaにて勤怠表を作っているのですが、時刻と時間の区別はどのようにするのでしょうか。 初歩的な質問でしたら、どうかご容赦ください。 項目には出勤時間、休憩時間、退勤時間、勤務時間、他（省略します）があるのですが、 退勤時間から出勤時間を引いた時間をmyTimeとして、myTimeに応じて休憩時間の判定を行ないたいです。 myTimeが４時間未満で休憩時間０分 ４時間以上６時間未満で休憩時間３０分 ６時間以上８時間未満で休憩時間４５分 ８時間以上で休憩時間は１時間 の時間を休憩時間セルに入力させたいのですが、myTimeが時刻から変えられず困っています。 恐らく、８時より前か後か、といったような判断をしているのだと思います。 ちなみにセルには別のExcel関数が入っていて、マクロを実行するときに関数を無視して（上書きして）入力させたいので、Excel関数での提案は今の所考えておりません。 コードの書き方を教えてくださいませんでしょうか。 現在の表記がh：mmになっている為、これで統一出来れば嬉しいです。 このあと勤務時間の集計も行なう為、時間の計算方法なども教えて頂けると助かります。 （一応自力で調べてみてはいるものの、まだ理解には及びません。） Dim STAR_TIME As Date Dim RECESS_TIME As Date Dim myTime As Date STAR_TIME = Cells(0, STAR_CL)　　　'出勤時間の行です LAST_TIME = Cells(0, LAST_CL)　　　'退勤時間の行です myTime = LAST_TIME - STAR_TIME With Cells(0,RECESS_CL)　　'休憩時間の行です If myTime >= Format(Time, "8:00") Then .Value = Format(Time, "1:00") ElseIf Format(Time, "8:00") > myTime And myTime >= Format(Time, "6:00") Then .Value = Format(Time, "00:45") ElseIf Format(Time, "6:00") > myTime And myTime >= Format(Time, "4:00") Then .Value = Format(Time, "00:30") ElseIf Format(Time, "4:00") >= myTime Then .Value = Format(Time, "0:00") End If End With 記号（大なり、小なり）の挙動もいまいち理解出来ていません。 何度も試してみて今の位置にしてみたのですが、 いろいろ試して変えまくって、なんだかよく分からなくなってきました。正直合っている気はしないです。 実際にはもうすこし長いコードですが、必要そうな所だけ書き出しました。 私のミスで足りないところがあるかもしれません。必要であれば書き足します。 作成はExcel for mac 2011ですが、 実際に運用するのはWindowsの各Excelバージョン（複数）の為、 互換性のあるコードで教えてください。宜しくお願い致します。
初歩的なことなのですが、どうか教えてください。 (1)はわかるのですが、(2)が分かりません。 どのように表したらよいでしょうか。 (1)Range("A1","C5")　⇒　Range(Cells(1, 1), Cells(5, 3)) (2)Range("A1:C5,E1:G5") ⇒　？？？
win 7 とEXCEL2007でマクロ作成初心者です。 Sub kigoumade() Range("DK30").Activate Do Until ActiveCell.Value = "※※" ActiveCell.UnMerge ActiveCell.Clear ActiveCell.Offset(1).Activate Loop End Sub 上のコードでDK列のセル（※※の無い行だけ）を消去できました。 これをActiveCell列のセルでなく、 （"BR30：EE30")という複数セルを、※※のある行の手前までをClearしたいのですが どうすればよろしいかご教示お願いします。
現在，以下の記述でエクセル上にマクロ実行ボタンを作成しました。 任意のCSVファイルをエクセルに取り込み利用する目的です。 実行ボタンを押すと，「実行時エラー　ファイルにこれ以上データがありません。」として，記述中の 「Input #intFF, X(1), X(2), X(3), X(4), X(5), X(6), X(7) ' (2)」 部分が黄色になって止まってしまいます。 エクセル画面上には，希望通りのデータが出力されているようなので，このエラーが表示されなければデータの取り込みとしては問題ないのですが・・・。 どのようにこのエラーを回避し処理すればよいかかが分かりません。 どなたかご教示いただければ幸いです。 どうかよろしくお願いいたします。 Sub Macro4() ' CSV形式テキストファイル(7カラム)読み込みサンプル Const cnsTITLE = "テキストファイル読み込み処理" Const cnsFILTER = "CSV形式ファイル (*.csv),*.csv,全てのファイル(*.*),*.*" Dim xlAPP As Application ' Applicationオブジェクト Dim intFF As Integer ' FreeFile値 Dim strFileName As String ' OPENするファイル名(フルパス) Dim vntFileName As Variant ' ファイル名受取り用 Dim X(1 To 7) As Variant ' 読み込んだレコード内容 ' (1) Dim GYO As Long ' 収容するセルの行 Dim lngREC As Long ' レコード件数カウンタ ' Applicationオブジェクト取得 Set xlAPP = Application ' 「ファイルを開く」のフォームでファイル名の指定を受ける xlAPP.StatusBar = "読み込むファイル名を指定して下さい。" vntFileName = xlAPP.GetOpenFilename(FileFilter:=cnsFILTER, _ Title:=cnsTITLE) ' キャンセルされた場合はFalseが返るので以降の処理は行なわない If VarType(vntFileName) = vbBoolean Then Exit Sub strFileName = vntFileName ' FreeFile値の取得(以降この値で入出力する) intFF = FreeFile ' 指定ファイルをOPEN(入力モード) Open strFileName For Input As #intFF GYO = 1 ' ファイルのEOF(End of File)まで繰り返す Do Until EOF(intFF) ' レコード件数カウンタの加算 lngREC = lngREC + 1 xlAPP.StatusBar = "読み込み中です．．．．(" & lngREC & "レコード目)" ' レコードを読み込む(このサンプルは7項目のCSV) Input #intFF, X(1), X(2), X(3), X(4), X(5), X(6), X(7) ' (2) ' 行を加算しA～G列にレコード内容を表示(先頭は2行目) GYO = GYO + 1 Range(Cells(GYO, 1), Cells(GYO, 7)).Value = X ' 配列渡し ' (3) Loop ' 指定ファイルをCLOSE Close #intFF xlAPP.StatusBar = False ' 終了の表示 MsgBox "ファイル読み込みが完了しました。" & vbCr & _ "レコード件数=" & lngREC & "件", vbInformation, cnsTITLE End Sub
vb.netのexeファイルでのアプリの一部の動作ができません。 プロジェクトファイルを開いて実行すれば稼動するのですが、生成したexeファイルを実行した場合に一部の動作が稼働できません。その動作以外の動作は稼働します。 その稼働しない動作はデバイスの状態変更(有効から無効)にする動作です。 原因が分かる方、推測できる方がいらっしゃったら、教えていただけないでしょうか？ 宜しくお願いします。 exeファイルは監視exeでデバイスの接続時にフォームが表示するようにタスクスケジューラーで常時監視をしています。 また、通常時は画面上には見えないように「ShowInTaskbar」をFalseにしており、フォームは通常時最小化されている状態になります。
ＶＢ2010を使っています。 Oracleのプロシージャを呼び出しするのですが、 以下のエラーが出て困っています。 ORA-06550:行1、列7： PLS-00801:内部エラー[22503] ORA-06550:行1、列7： PL/SQL:Statement ignored 実際のＰＧ Public Function ORA_EXECUTE(ByVal strSQL As String) As Boolean ' データ格納領域の初期化 Dim v_return_flg As Boolean Dim Ora_Cnn_bk As OracleConnection Dim Ora_Cmd_bk As OracleCommand ' Oracle接続情報の初期化 Ora_Cnn_bk = New OracleConnection Ora_Cmd_bk = New OracleCommand ' Oracleへのコネクションの確立 Ora_Cnn_bk.ConnectionString = "User Id=(ユーザ名); Password=(パスワード); Data Source=(接続文字列)" & "; Pooling=false" Ora_Cnn_bk.Open() v_return_flg = False Try Dim oTYPE_CHAR As OracleDbType = OracleDbType.Char Dim oPARM_OUTPUT = ParameterDirection.Output 'バインド変数のセット Ora_Cmd_bk.Parameters.Add("AAA", oTYPE_CHAR) Ora_Cmd_bk.Parameters("AAA").Value = " " Ora_Cmd_bk.Parameters("AAA").Direction = oPARM_OUTPUT Ora_Cmd_bk.Parameters("AAA").OracleDbType = oTYPE_CHAR 'ストアドプロシージャ実行 Ora_Cmd_bk.CommandType = CommandType.StoredProcedure Ora_Cmd_bk.CommandText = strSQL Ora_Cmd_bk.Connection = Ora_Cnn_bk Ora_Cmd_bk.ExecuteNonQuery() Catch ex As Exception MessageBox.Show("SQL(" + strSQL + ")" + Chr(13) + ex.Message, "確認", MessageBoxButtons.OK) Finally ' コネクションを閉じる Ora_Cnn_bk.Close() ' Oracle接続情報のクリア Ora_Cnn_bk = Nothing Ora_Cmd_bk = Nothing End Try ' データ返却 Return v_return_flg End Function Oracle側のプロシージャは、別ＰＧで使用していて Ｃ＋＋からアクセスし使える状態です。 お分かりになる方教えてください。 m(_ _)m
csvファイルを別のファイル(エクセル)に並べ替えて保存したいと考えてVBAでプログラムを 書いてみたのですがうまくできないので解決策をご教示いただけないでしょうか。 960行640列のデータを，「行，列，値」←エクセルでいうとA列＝行，B列＝列，C列=値 の形に並べ替えようとしています。 　行　　列　　値 　1　　　1　 　28 1 　 2 　10 　1　　　3　　　0 　・　　　・　　　・ 　・　　　・　　　・ 　960　640　 37 といった具合です。 実行すると，行と列は並べ替えて表示されるのですが，値だけはどの行でも同じ値が入ってしまいます。元のデータでは値はランダムです。 書いたプログラムを下に載せます。 配列tmpのインデックスがループを追うごとに変化しないことが原因かと考えていますが， 変数nを追加して　”For tmp = 0 To UBound(tmp) Next n”　を　”For j = 1 To 640　Next j” の中に入れてみましたが(これでは意図と違う表示がされそうですが)，結果はおなじでした。 配列tmpの中身を，対応するセルに一つ一つ入れていくにはどのようにしたら良いのでしょうか。 本やネットの情報をつまみ食いして書いているので，理屈やスマートな書き方など よくわかっておらず，見苦しいものかとも思いますがどうぞよろしくお願いします。 ------------------------------ Sub　並べ替え() Dim i As Long, j As Long, m As Long Dim buf As String, tmp As Variant Open "ファイル" For Input As #1 m = 1 Input #1, buf tmp = Split(buf, ",") Cells(1, 1).Value = "X" Cells(1, 2).Value = "Y" Cells(1, 3).Value = "Z" For i = 1 To 960 For j = 1 To 640 m = m + 1 Cells(m, 1).Value = i Cells(m, 2).Value = j Cells(m, 3).Value = tmp Next j Next i Close #1 ChDir "新しいファイル" ActiveWorkbook.SaveAs Filename:="新しいファイル", _ FileFormat:=xlCSV, CreateBackup:=False End Sub ---------------------
excel初心者です。 文字列を置き換え、オリジナルの隣のセルに表示させる方法を教えてください。 扱っている商品名のいくつかが変更になったので、過去に入力済みのデータを一括変換したいのですが、旧商品名も残しておきたいと思っています。 たとえば、 日付商品名数量価格 9/6オレンジジュース1550 9/6バナナミルク1500 9/6カフェラテ1600 を 日付新商品名旧商品名数量価格 9/6フレッシュオレンジオレンジジュース1550 9/6バナナオレバナナミルク1500 9/6カフェオレカフェラテ1600 という感じです。 商品名が多く40以上あるため、SUBSTITUTEだと無理があり、VBAでの方法を調べ始めたものの、replaceでは上書きしかできない（？）ようで、いまいちよくわかりません。 どなたかご教授いただけないでしょうか。 また、VBAについて初心者向けにわかりやすく解説しているサイトや本がありましたら、あわせて教えていただけたら幸いです。 よろしくお願いいたします。
VisualBasic2008で作った実行ファイル（～.exe）はあるんですが、そのほかのソースなどフォルダごと削除してしまったようです。 実行ファイル（～.exe）は別のところにコピーして使ってたので残っているんです。 実行ファイル（～.exe）からソースを作るなんて事できませんか？ 自分で作ったやつなので大まかには分かるんですが・・・・
windws7 Excel2007でマクロ作成中の初心者です。 B列に８月21日から９月20日まで入力されてます。 以下のコードでセルＢＷ28の数値によりセル選択範囲が異なります。 すべて８月２１日の行から開始します。 28のときは、８月２１日の行から２８番目の行まで選択 29のときは、８月２１日の行から２９番目の行まで選択 30のときは、８月２１日の行から３０番目の行まで選択 以上正常にセルの選択が出来ます。 しかし３１のとき ８月２１日の行ただ１行しか選択してくれません。 上の例のように ８月２１日の行から３１番目の行、つまり９月２０日までの行まで 選択したいのですが、どうしたらよいでしょうか。 Sub sersu sentaku() If Range("BW28") = 28 Then Range("B30").Resize(Day(DateSerial(Year(Date), Month(Date), 28)), 66).Select ElseIf Range("BW28") = 29 Then Range("B30").Resize(Day(DateSerial(Year(Date), Month(Date), 29)), 66).Select ElseIf Range("BW28") = 30 Then Range("B30").Resize(Day(DateSerial(Year(Date), Month(Date), 30)), 66).Select ElseIf Range("BW28") = 31 Then Range("B30").Resize(Day(DateSerial(Year(Date), Month(Date), 31)), 66).Select End If End Sub
vb.netでデバイス状態変更のアプリを作成しています。 その中で、Visual Studio上でデバックすると、デバイスの状態変更げできるのですが、アプリとして起動するとデバイスの状態変更が出来なくなってしまいます。 調べてもこの現象に関してのことはわかりませんでした。ですので、わかる方がいらしたら、教えていただけたらと思い質問させていただきました。
VBAのプロの方にお願いがあります。下記、内容で欄ごとに仕入書価格と申告金額を集計しその結果を別シートの10行目から表示させるにはどのようなプログラムを作成すればいいでしょうか。欄番号と輸入統計品目番号も合わせて表示したいです。またSMALLのグループの中では税率ごとで金額が一番大きい輸入統計品目番号を表示させることはできますでしょうか。どなたかお力をお貸しください。よろしくお願いいたします。 欄　大額・少額　輸入品目統計番号　　税率　仕入書価格　 申告金額 1　　　Large　　　　8708.70-0906　　　　　無税　　　5,659.00　　　¥777,320 2　　　Large　　　　8708.10-0006　　　　　無税　　　2,250.00　　　¥309,060 3　　　Small　　　　8708.94-0004　　　　　 無税　　　　854.50　　　¥117,374 3　　　Small　　　　8708.29-0006　　　　　 無税　　　　735.00　　　¥100,959 4　　　Small　　　　6211.43-2006　　　　　　9.1%　　　　420.00　　　　¥57,691 4　　　Small　　　　6204.62-2001　　　　　　9.1%　　　　194.40　　　　¥26,702 5　　　Small　　　　7318.15-0195　　　　　　2.8%　　　　142.62　　　　¥19,590 　
初心者です。 エクセル2010を使用しています。 社内のエクセルシートで工事の依頼を物件ごとに記入していきます。（A:N） 工事完了後、（A:N）に色を付けます。 毎回パレットで選んでいます。色番は16777164 マクロで一連の動作を記憶させ、ボタン一つで出来るようには作れたのですが、元々色の付いている箇所だけはそのままの色にしたいのです。 元々色がついてる理由ですが、工事には材料が必要なのですが、仕入れて請求が来るのが月末となります。金額の入力を忘れない為に色を付けています。 そういった場合はどのようなプログラムになるのでしょうか。 ご教示お願い致します。
sqlでの拡張子保存ができません。 mac OS X バージョンは10.8.5です。 テキストエディットを使って、「○○.sql」という拡張子で保存したいのですができません。 なにか特別な設定が必要なのでしょうか。
vbで作成したフォームアプリケーションをサービスに登録し、Windowsが起動時に自動で実行するようにしたいのですが、vbで作成したフォームアプリケーションをサービスに登録する方法がわからないのでわかる方がいらしたら、教えていただきたいと思います。 アプリの動作は、デバイスの抜き差しの監視アプリです。
毎月の150人分の給与データをエクセルにする必要があります。 csvデータを加工の途中で一名分のデータが3行になります。 その3行になった時点でそれぞれ各個人のデータの2行目に あたる部分のAからＣを削除したいのですが、 例えば　A2-C2, A5-C5, A8-C8, A11-C11 ........ A449-C449 を一括で削除する。 マクロでそういった記録は可能でしょうか？
あるフォルダに100曲くらいのmp3があります。 これをAxWindowsMediaPlayerリストに入れて、再生しています。 たとえば100曲中の12曲目の再生中に終了（例えばボタンを押す）させた場合、12という数値を取得する方法がありますか？ その数値をテキストファイルに書き込んでおいて、次回再生する際は13曲目から再生したいのです。 いろいろ調べてみたのですが、取得する方法がわかりません。 よろしくお願いいたします。 下記をforで回して100曲セットしてます Me.AxWindowsMediaPlayer1.currentPlaylist.appendItem(AxWindowsMediaPlayer1.newMedia(　～～　)) 下記で再生してます Me.AxWindowsMediaPlayer1.Ctlcontrols.play()
お世話になります。 平成○○年○月 　　　　Ａ　　Ｂ　C 　D 　E 　 F 　G　 １　　　月　火　水　木　金　土　日 ２　　　○　○　○　○　○　○　○ ３　　　○　○　○　○　○　○　○ ４　　　○　○　○　○　○　○　○ ５　　　○　○　○　○　○　○　○ ６　　　○　○　○　○　○　○　○ 上記のようなデータがあり、条件付き書式のルールで土曜日と日曜日のセル（Ｆ２からＦ６とＧ２からＧ６）、にはセルに色がついています。マクロをつかって、色のついたセルの〇を自動で消したいのですが、そういうことは可能でしょうか？　ちなみに月日を変えると曜日は自動で変わるようになっています。 よろしくお願いします。
バッチおよびVBのドがつくほどの初心者です。 環境：Windows7 Pro 下記のような行が数百行ほど記載されているCSVファイル(xyz.csv)があります。 "(桁数不定の変数a)-(1桁の変数b)(1桁の変数c)","yyyymm" これをバッチまたはVBにて (1桁の変数b),(桁数不定の変数a),(1桁の変数c),yyyymm に自動的に変更したいと考えています。 例 "1234567890-12","201409" ↓ 1,1234567890,2,201409 「-」を「,」に変更したり「"」の削除、また桁数が不定でなければ指定の位置に「,」を入れることは出来そうなのですが 桁数が不定ということで、行き詰ってしまいました。 システム上 "(a)-(b)(c)","yyyymm"を "(a)-(b)(c)","(a)-(b)(c)","(a)-(b)(c)","yyyymm" に変更することは出来そうなので、先頭から検索して「-」の個数と位置で指定の文字列を消すという方法もあるのかなと思ったのですが こちらについてもやり方がまったくわからなくお手上げ状態になってしまいました。 （桁数固定なら、こちらで指定の位置だけ削除できればと思っていたのですが……） 上記処理を行えるバッチまたはVBで編集するコマンドをご教示いただければと思います。 ご回答お願いいたします。
VBScriptにてIEを操作しています。 先日PCを新しくwin7のIE11にしたところおかしくなりました。 httpのサイトにアクセスするとDocumentCompleteが発生しません。 というか最初のnavigateでは発生はしているようなのですが 次のURLにnavigateした時発生せずreadystateは1のままです。 2度目のnavigateの挙動がおかしい気がします。 ちなみにhttpsのサイトは問題ありませんでした。 試しに以下のようなスクリプトを作成してみたところ Msgboxにて"http://www.yahoo.co.jp/"、"http://weather.yahoo.co.jp/weather/" の二つが表示されてしまいました、、、。 画面上にはお天気ページのIEのみが起動（見えて）していてIEはQuitできていません。 かなり困っています。 Option Explicit Dim ie Dim isReady Set ie = WScript.CreateObject("InternetExplorer.Application", "ie_") ie.Visible = True ie.Navigate "http://www.yahoo.co.jp/" Call wait ie.Navigate "http://weather.yahoo.co.jp/weather/" Call wait ie.Quit Set ie = Nothing msgbox "ok" Sub wait() Dim count: count = 0 isReady = False Do While isReady = False WScript.Sleep 100 count = count + 1 If count > 100 Then Call chkIe ie.Quit Set ie = Nothing WScript.Quit End If Loop End Sub Sub ie_DocumentComplete(ByVal pDisp, URL) If pDisp Is ie Then isReady = True End Sub Sub chkIe Dim fso Dim browse Dim pn Set fso = CreateObject("Scripting.FileSystemObject") For Each browse In CreateObject("Shell.Application").Windows pn = fso.GetFileName(browse.FullName) If LCase(pn) = "iexplore.exe" Then msgbox browse.LocationURL Next Set fso = Nothing End Sub ほかのWIN7、IE11のPCでは問題なく操作できています。 この新しいPCのIEもデフォルトのままで特別な設定はしていません。 どなたか何か心当たりがありましたらよろしくお願い致します。
Excel2003で、VBAで指定フォルダを開く場合に myFol = "D:\aaa" Shell "C:\Windows\Explorer.exe " & myFol, vbNormalFocus これで開きますが、環境変数HOMEを指定することはできないでしょうか？
早速ですが、 シート1　行　3.000から4000.列　セル式　Ｈ-AM　まで シート2　行　3.000から4000.列　セル式　Ｈ-W　まで シート3　行　3.000から4000.列　セル式　Ｈ-AO　まで このような、BOOKが有ります。 データの追加（各シートのＡ-Ｇ　1行追加）に伴い　シート1から　3まで　セル式の計算が行われます。 で、計算が済んだあと、セルの変化をとらえて、次のアクションを起こすのですが、 セル式が完了するまで、時間を稼ぎたいのですが、 今は、タイマーで act時刻 = Now ａｃｔ時刻 = DateAdd("n", 2, act時刻 ) 待ち時間 = DateAdd("s", 20, act時刻 ) Application.OnTime act時刻 , "ｎｅｘｔ-job", 待ち時間 このタイマーが不正確（動作したりしなかったり）で　上の式は　2分待ちですが　1分以下だと　100％起動せず、 1分40秒以上でどうやら・・・ で、タイマー以外で　 シートにデータ送り込むＶＢＡ（15分毎のタイマー）の続きに　計算完了、もしくは、セル式の仕事を止めないで、セル式計算完了を　まって、”ｎｅｘｔ-job”　の　仕事をさせたいのですが セル式の仕事を止めない時間稼ぎは無いでしょうか　
以前別のカテゴリで質問したのですが、そちらでは解決出来なかったので、こちらで改めて質問します。 下記のマクロで、一つのブックからSheet1だけをコピーして来て、少し処理をし、元のブックを閉じるというもので、ブックの数は多くて3000程、少ない時は300位です。 で、このマクロだと９００位までですと最後まで行くのですが、それを超えるとリストが９５位で止まってしまいます。 自宅で別データを作ってやってみるとうまくいきました。 コピー元のブックにはテキストデータのみで、２００文字から５００文字程度の大きさしかありません。 ファイル名も５０文字程度の物を全部２０文字程度まで短くしてもみましたが、ダメでした。 どうかお知恵をお貸しください。 Sub ★1★ブックの結合() Dim sFile As String Dim sWB As Workbook, dWB As Workbook, aWB As Workbook Dim dSheetCount As Long Dim i As Long Dim SOURCE_DIR As String 'エクセルデータに変換されたファイルのあるフォルダを選択します。 MsgBox "エクセルに変換されたデータのフォルダを選択" With Application.FileDialog(msoFileDialogFolderPicker) If .Show = True Then SOURCE_DIR = .SelectedItems(1) & "\" End If End With Application.ScreenUpdating = False '指定したフォルダ内にあるブックのファイル名を取得 sFile = Dir(SOURCE_DIR & "*.xls") 'フォルダ内にブックが無ければ終了 If sFile = "" Then Exit Sub '集約用ブックを作成 Set dWB = Workbooks.Add '転記マクロの中のDMリストシートをコピーする Workbooks("転記用マクロ.xlsm").Worksheets("DMリスト").Copy Before:=dWB.Worksheets("Sheet1") Application.DisplayAlerts = False Worksheets(Array("Sheet1", "sheet2", "sheet3")).Select ActiveWindow.SelectedSheets.Delete Application.DisplayAlerts = True '集約用ブック作成時のシート数を取得 dSheetCount = dWB.Worksheets.Count Do 'コピー元のブックを開く Set sWB = Workbooks.Open(Filename:=SOURCE_DIR & sFile) 'コピー元のsheet1を集約用ブックにコピー sWB.Worksheets("sheet1").Copy After:=dWB.Worksheets(dWB.Sheets.Count) シート転記 'コピー元ファイルを閉じる Application.DisplayAlerts = False sWB.Close Application.DisplayAlerts = True 'セルA2の名前を変更する 'シート名をセルA2の値に変更 'ActiveSheet.Name = Range("A2").Value '次のブックのファイル名を取得 sFile = Dir() Loop While sFile <> "" '集約用ブックを保存する 'dWB.SaveAs Filename:=DEST_FILE Application.ScreenUpdating = False End Sub
ACCESSでORACLEのサーバからデータを取得しようと試みましたがうまくいきません。どこを改善したらよろしいでしょうか？どなたかご教示ください。 クライアント：WINDOWS7 ACCESS2010 サーバ：WIN-SV2003 ORACLE10G 以下のエラーがVBAで取得しようとするとでてきてしまいます。 「[Microsoft][ODBC driver for Oracle][Oracle]ORA-00923:FROMキーワードが指定の位置にありません。」 SQL部分の空白は見直しました。 Private Sub コマンド610_Click() Dim adoCON As Object Dim rs As Object Dim oraclebox() As Variant Dim rdsu As Long On Error GoTo Err_Han 'データベースに接続する' Set adoCON = CreateObject("ADODB.Connection") adoCON.Open "Driver={Microsoft ODBC for Oracle};" & _ "CONNECTSTRING=*****; UID=abcd; PWD=1234;" sqlstr = "SELECT J.KTN_COD,J.SBN,J.GYOSYA_COD,G.GYOSYA_MEI" _ & "FROM JITU_SHARYOU J ,GYOSYA G" _ & "WHERE J.GYOSYA_COD = G.GYOSYA_COD" Set rs = adoCON.Execute(sqlstr) rs.MoveFirst 'レコード数カウント' Do Until rs.EOF rdsu = rdsu + 1 rs.MoveNext Loop '配列を再定義' ReDim oraclebox(rdsu, 4) i = 1 rs.MoveFirst Do Until rs.EOF oraclebox(i, 1) = rs!KTN_COD oraclebox(i, 2) = rs!SBN oraclebox(i, 3) = rs!GYOSYA_COD oraclebox(i, 4) = rs!GYOSYA_MEI i = i + 1 rs.MoveNext Loop rs.Close Set rs = Nothing '警告ダイアログをオフ' DoCmd.SetWarnings False DoCmd.RunSQL "DELETE FROM SAMPLE_T" 'Oracleデータを書き込み' For i = 1 To rdsu DoCmd.RunSQL "INSERT INTO SAMPLE_T(KTN_COD,SBN,GYOSYA_COD,GYOSYA_MEI)" _ & "VALUES('" & oraclebox(i, 1) & "','" & oraclebox(i, 2) & "','" & oraclebox(i, 3) & "'," & oraclebox(i, 4) & ")" Next i '警告ダイアログをオン' DoCmd.SetWarnings True Exit Sub Err_Han: ' エラー処理' MsgBox (Err.Description) End Sub ＊単一のテーブルであればDoCmd.TransferDatabase acImpor等を使うのですが、場合によっては今後データ量が多かったりより複数のテーブルを扱うことになるので。
画像を御覧ください、 データベースがutf8で、クエリーがvbaから投げるからunicodeになっているせいかな？ 対策はどうすればよいでしょうか…
以前に質問をさせていただき、こちらでベストアンサーを決定した後に急きょ変更があったところがあり、わからなくなってしまいこちらに戻ってきた次第です。 http://oshiete.goo.ne.jp/qa/8743521.html にて質問をさせていただきました内容について、以下のVBAで解決できております。 しかし、抽出したファイル名にハイパーリンクが欲しいという要望を受けてしまいました。 ハイパーリンクのＶＢＡについていろいろ調べましたが、この記述方法に追加して実行する方法が全く分かりませんでした。 お分かりになる方がいましたら、この内容にハイパーリンクをつける方法をお教えいただけますでしょうか。よろしくお願いいたします。 Sub Macro1() Dim i As Long Dim myPath As String, Flnm As String ReDim Flnmfp(0) As String Dim WS1 As worksheet Set WS1=ThisWorkbook.sheets("sheet1") myPath="望みのフォルダパスを入力" Call fpFileName(myPath, Flnmfp ) 'フォルダ内のファイル名取得 If Ubound(Flnmfp)=0 Then 'フォルダにファイルが無ければ終了 Exit Sub End if For i =1 to Ubound(Flnmfp) Workbooks.open filename := Flnmfp(i) Flnm=Dir(Flnmfp(i)) With Workbooks(Flnm).sheets("sheet1") WS1.Cells(2, i).value=.Range("G5").value WS1.Cells(3, i).value=.Range("G6").value WS1.Cells(4, i).value=.Range("K7").value WS1.Cells(5, i).value=CStr(.Range("G9").value) & CStr(.Range("N9").value) & CStr(.Range("P9").value) '同じ要領で望みのセルを記入する WS1.Cells(8, i).value=Flnm End with Workbooks(Flnm).close Savechanges:=False Next i End Sub Sub fpFileName(ByVal myPath As String, ByRef Flnmfp() As String) 'サブフォルダも含め全部のxlsファイル名をフルパスで取得する 　　Dim cnt As Long, buf As String, f As Object 　　buf = Dir(myPath & "\*.xls") 　　Do While buf <> "" 　　　　cnt = Ubound(Flnmfp) + 1 ReDim Preserve Flnmfp(cnt) 　　　　Flnmfp(cnt)= myPath & "\" & buf 　　　　buf = Dir() 　　Loop 　　With CreateObject("Scripting.FileSystemObject") 　　　　For Each f In .GetFolder(myPath).SubFolders 　　　　　　Call fpFileName(f.Path, Flnmfp) 　　　　Next f 　　End With End Sub
以前次の計算式を教えていただきました。 NewDataRow = Cells(Rows.Count, "J").End(xlUp).Row + 1 Range("J" & NewDataRow).FormulaR1C1Local = "=IF(DATEDIF(RC5,TODAY(),""Y"")>80,""大型中止"",""OK"")" 今度はRange("N"&NewDataRow）に曜日指定された（たとえば水曜）曜日の日になると10％の割引金額を表示する計算式をどなたか教えてください。。 自分でも考えながらやっていますがなかなか辿り着けません、宜しくお願いします
VisualBasic2008 で外部のサーバーにあるMySQLに接続できません。 Cnn.Open()の所で、こんなエラーがでます。 Unable to connect to any of the specified MySQL hosts. MysqlTest.vshost.exe Error: 0 : Unable to connect to any of the specified MySQL hosts. 'MySql.Data.MySqlClient.MySqlException' の初回例外が MySql.Data.dll で発生しました。 System.Transactions Critical: 0 : <TraceRecord xmlns="http://schemas.microsoft.com/2004～ ～～ PC内にあるMySQLには接続できるんですが。 外部のサーバーのMySQLには接続できないのでしょうか。 -------コード------------------ Dim sqlStr As String = "SELECT * FROM allitem" Dim CnnStr As String = "server=xxxxxxxxxxx.com:3306;database=PGTESTDB;User Id=pgtestuser;Password=xxxxxx" Dim Cnn As MySqlConnection = New MySqlConnection Cnn = New MySqlConnection(CnnStr) Cnn.Open()
皆様、どうぞお知恵をお貸しください。 現在、社内有給日数一覧を作成しております。 社内規定で入社日（中途もいるためバラバラです）から半年を過ぎると10日間の有給が発生し、更にそこから毎年一年が経過すると10日の有給が発生します。 これらの動きをマクロで再現できないものかと思っているのですが、難しいでしょうか？ どうぞよろしくお願いいたします。
64bit版ExcelのVBAでEnumChildWindowsを使用して、子ウィンドウのウィンドウハンドルを 取得したいと考えています。 下記のようなサンプルを作ってみましたが、コールバック関数でExcelが異常終了します。 （05行目にブレークポイントを設定、各変数の値を参照しようとした時点でExcelが異常終了) また、コールバック関数の第3引数(lParam)の型をInteger,Long,LongPtr等変えてみましたが、 いずれもExcelの異常終了となりました。 つきまして、64bit　Excelでの本ＡＰＩの使い方を教えていただきたくよろしくお願いいたします。 （なお、32bit版のExcelでは正常に動作しました) <以下サンプルコード> 行　コード 01 　 Declare PtrSafe Function EnumChildWindows Lib "user32.dll" (ByVal ParenthWnd as LongPtr, ByVal EnumWindosPROC as LongPtr,ByVal lParam as Long) as Integer 02 03 04 Function ListupChildWindows(hWnd as LongPtr,lParam as Long) as Boolean 05 MsgBox hWnd 06 ListupChildWIndows =True 07 End Function 08 09 Sub test_CwinList 10 Dim ThishWnd as LongPtr 11 12 ThishWnd=Excel.Application.hWnd 13 Call EnumChildWindows (ThishWnd , AddressOf ListupChildWindows ,0) 14 End Sub
IEを制御するvb.netで作成して動作していたアプリが、何をきっかけか分りませんが(OSやIEのVupがあったかも知れません)が動かなくなりました。 その対処方法をご教示して頂きたくお願いします。 エラーのステートメント： objIE.Document.FORM_301_01.btn.Click() エラーの内容： 公開メンバー 'btn' は型 'HTMLFormElementClass' に見つかりませんでした。 動作環境 　OS：Windows 7 64bit SP1 　IE: Ver.11 　vb: Visual Studio 2010 Express 　.NET Framework: Ver.4.5 よろしくお願い致します。 P.S. 間違って他のジャンルで質問してしまいましたが、こちらで再質問させて頂きました。
ブックを開くコマンド × Workbooks("filename.xls").open ○ Workbooks.open filename:="filename.xls" 何故下なのですか？ワークブックコレクションの中から特定のブックを指定し開くなら、上の構文にした方がワークシートコレクション等と構文表現を統一出来ます。 現にブックを閉じるコマンドは Workbooks("filename.xls").close です。何故ブックを開くコマンドだけ別表現なのですか？
類似質問を読んでも今ひとつ完全に仕上がらない為、こちらで質問をさせていただいた次第です。 社内の全員がコンピューターに疎く、せめて私が一番マシという状況だったのですが、私のVBAの端っこをかじったくらいでは到底難しい現状です。お力添えいただけますでしょうか。 EXCELは2010です。 誰でも操作できるようにしたい為、ブックにボタンを作成しそのボタンを押すとVBAが実行され、共有上にあるフォルダから、その中にある.xlsのファイルすべて（サブフォルダも含め）のsheet1から、必要な情報だけ抜き取り、新規ブックにリスト化する、という作業をしたいです。（ボタンの作成や、ボタンを押してのVBA実行のあたりは経験がありますので大丈夫だと思います。） 共有上の.xlsのsheet1には決まったひな形のデータがあります。 共有のパスはts-****/share/共有/発注管理　「発注管理」の中にあります。 そこから企業名、支店名、実施店舗名、実施日、担当名、案件進捗状況などだけを抜き取ってリスト化できると非常にありがたいです。 なので、A2から企業名、A3に支店名、A4に担当名、A5に実施日、A6に実施店舗名、A7に案件進捗状況、A8にファイル名、という項目を入れて それぞれB列から下にそれを反映させていきたいです。 共有上のsheet1にはG5に企業名、G6に支店名、K7に担当名、実施日はG9に初日N9に「～」が入ってP9に終了日が入っている状態でできれば一つのセルに*/*～*/*という表記にしたいです。G10に実施店舗名、X8に案件進捗状況が入っています。 このVBAを実行すればその時フォルダに入っているものが一覧で見ることができる、という事が出来ると非常に作業が効率化できる状況です。 文字ばかりでわかりにくい状況かもしれませんが、ご教授いただけると非常にありがたいです。 よろしくお願いいたします。
最終シート名が「基本」、その前が「種別」、さらにその前が「一覧」と言うシート名になっています。 またその「一覧」の前２ケは、シート名をindexで指定したいです。 以下のコードを実行してもうまく、シートを除外してくれません。どうしたらよろしいでしょうか。 Sub 各シートに関数を入力() Dim EXCEPT_NAME As String EXCEPT_NAME = " 一覧 　種別　 基本" & Worksheets(Sheets.Count - 4).name & Worksheets(Sheets.Count - 5).name Application.ScreenUpdating = False ChDrive ThisWorkbook.Path ChDir ThisWorkbook.Path Dim list, sheetName For Each sheetName In ActiveWorkbook.Worksheets If InStr(EXCEPT_NAME, sheetName.name) = 0 Then Sheets(sheetName.name).Activate ActiveSheet.Unprotect Call 関数貼付 End If Next End Sub
ＭＯＳでオフィスマスターを習得しました。ＶＢＡを使いこなせるようになりたいと思い一からプログラミングの勉強をしたいです。 (1)プログラミング初心者にはBasic言語がいいみたいですが、BasicとVisual Basicは違うものですか？ (2)先日Visual Basicのテキストを買いました。テキストには「VS Expression 2013 for Desktop」という無償のソフトを使って勉強していくタイプなのですが、エクセルやワードに入っているＶＢＡではできないのでしょうか？ 詳しい方、よろしくお願いします。
ＶＢＡでエクセル関数のDATEDIF関数でJ3から始まりその列の最後に入力された次の空白セルに関数を埋め込みたいのですがうまくいきません、どなたか教えてください。 現在の式は　Range("J"＆NewDataRow)、Value=,=IF(DATEDIF(E3,Today(),"Y")>80,"大型中止",OK）ですがE3の結果が出ます、列には途中違う計算式も入っていくことになるので入力した行の計算結果がほしいのです。よろしくお願いします
セル式ですが、記載シートならば下記で　ＯＫですが =INDIRECT("A"& COUNTA(A:A)) 他のシート値が取得できません。 =INDIRECT (データ2!A　& COUNTA(A:A)) #name? エラーが返ります データ2　は　基本　nameです。　オブジェクト名もやりましたが、だめでした。 ””など、やってみたのですが・・・・
win7のVB2012で作成したプロジェクト丸ごとを、 WIN8のVB2012で編集できるようにしたいのですが どのような手続きが必要でしょうか？ WIN8二は既にVB2012はインストール済みです。 その後の方法を教えてください。 C:\Users\win7\Documents\Visual Studio 2012\Projects に入っているフォルダを C:\Users\win8\Documents\Visual Studio 2012\Projects に移動させればいいのでしょうか？
Windows Updateの状況をExcel VBAより取得したい 試した事 １．WindowsUpdate.logを参照したが、都合の良いキーワードがない ２．Windows Upadteの画面から文字を取得しようとしたが、 　　DirectUIHWNDクラスらしくて、お手上げ 何かヒントをお願いします
http://bekkoame.okwave.jp/qa8051745.html のように、自身で作ったフォームをデスクトップにショートカットとしておきたいのですが、 bin\Releaseの中身はカラです。 この状態は普通（正常）なのでしょうか？ bin\Debugの中には、exeファイルはあります。
ソリューションの名前を変更しても、 C:\Users\○○\Documents\Visual Studio 2012\Projects の配下にあるフォルダ名は変更されないのでしょうか？ プロジェクトごと、ソリューションごと名前を変更したいのですが、 全て変更できないのであれば訳が分からなくなるのでやめたいのですが、 ソリューションの名前を開発画面で変えた場合 手作業でフォルダ名を変更すればいいのでしょうか？
ＶＢ２０１２です。 選択範囲を一気にコメントアウト（コメントブロック）したいのですが、 どこから行えばいいのでしょうか？ ツールバーを見ても探せないし、コメントアウトがどのカテゴリーに入ってるかもよくわかりません。
vb2012をインストールしようと http://www.microsoft.com/ja-jp/download/details.aspx?id=34673 のページを開いたのですが wdexpress_full.exe VS2012_WDX_JPN.iso のどちらを選べばいいのかわかりません。 http://gurigumi.s349.xrea.com/programming/visualcpp/install2012_1.html を見ると、 「オフラインインストールをする場合は、VS2012_WDX_JPN.iso のチェックを入れます。 Webインストールをする場合は、wdexpress_full.exe のチェックを入れます。」 とのことですが、 「オフラインインストール」と「Webインストール」の違いがわかりません。 どちらでもいいのでしょうか？
VBS初心者です。 以下のように、リストを読み込んで動的配列に持たせたいです。 ----------------------------------------------------------------- GET_FILE = "sample.txt" SET objFs = CreateObject("Scripting.FileSystemObject") ' 動的配列セット Call Array_Set("AryVal",GET_FILE) ' 表示 For i = 0 To Ubound(AryVal) msgbox AryVal(i) Next ' 終了 WScript.Quit 0 Function Array_Set(AryName,ReadFile) Set strVal = objFs.OpenTextFile(ReadFile) ' 1行づつ処理 Do While strVal.AtEndOfStream <> True i = i + 1 ReDim Preserve AryName( i - 1 ) AryName( i - 1 ) = strVal.ReadLine Loop End Function ----------------------------------------------------------------- 見て頂くと分かるとおり、動的配列として持たせたい変数名を Functionの引数として渡しています。(当然のごとくエラー、、、) Functionの引数として渡した値に動的配列が格納される方法があれば教えてください。 よろしくお願いします。
excel2013でシート１にB２～K２１、B２２～K４１まで分けて、それぞれ、あ行～わ行順に氏名が入っています。このデータをシート２のB２～B１０５の範囲にシート１の氏名を実行ボタンで並べるようにマクロ組みしているのですが、並べる際に氏名を昇順で並べられるようにしたいです。初歩的な質問で申し訳ありませんが、この場合、どのようなコードでしょうか？ご回答宜しくお願い致します。
VBA初心者です。 エクセル2007で、sheet1にある商品名（A列)・金額(B列)・個数(C列)・発注日(D列)のリスト（AからD列の50行ほどの範囲。行は増える可能性あり）を商品名をキーにあいうえお順で並べ替え、 sheet2のフォーマットの各セル（A6,D6,G9,J9)へsheet1の商品名・金額等を差込→印刷の繰り返しを行うマクロを組みました。 業務内容に変更があり、ある商品（商品名Ｃとします）のみsheet2ではなく、別のフォーマットへ差込印刷しなければならなくなりました。（別のフォーマットはsheet3とします） 商品Cも含めた全リストを、商品名であいうえお順に並べ替えて印刷（商品名順に印刷したい）を行うためにはどのようにマクロを書き換えれば良いか教えていただきたいです。 リスト並べ替え→商品Cの1行前まで差込印刷LOOP→商品Cをsheet3に差込印刷→商品Cの1行 後から差込印刷LOOPという組み立て方でいいのでしょうか？ IF等使用して商品Cの前の行まで繰り返しを指示すればいいのかなと、自分なりに検索して調べてみましたが方法がわかりませんでした。 宜しくお願いします。 Range("A1:D100").sort_ 　Key1:=Range("A1"),_ 　Order1:=xlAscending,_ 　Header.=xlYes,_ 　Orientation:=xlTopToBottom Workheets("sheet1").Active Range(A1).Select Do Activecell.Offset(1,0).Select If Trim(ActiveCell.Value)=""Then Exit do End if If ActiveCell.EntireRow.Hidden=False Then With Worksheets("sheet2") .Range("A6").value=ActiveCell.Offset(0,0).Value .Range("D6").value=ActiveCell.Offset(0,1).Value .Range("G9").value=ActiveCell.Offset(0,2).Value .Range("J9").value=ActiveCell.Offset(0,3).Value .Printout End With End If Loop End Sub VBAを勉強しだしたばかりですが、今月中に変更する必要があり困っています。 よろしくお願いいたします。
ＶＢ2010Ｐｒｏアプリケーションを作成し、他のＰＣで動かす為に、実行ファイルの作成までは出来ましたが、Ｗｉｎインストーラの作成が上手く出来ません。 ＯＳは、Ｗｉｎ7です。アプリケーションは、ＤＡＴＡをＸＭＬファイルで保存したり読み込んだりします。このＸＭＬファイルをしっかり読み込めないので、問題が生じるようです。 「ひと目でわかるVisualBasic2010データベース開発入門」を読みながら、setup.exeとsetup.msiはできましたが、他のＰＣで起動させると次のようなエラーとなります。 「データデースファイルが見つかりません。データベースへのパスを確認してください。 DataSouce=c:\programFiles\taro\setup\taro.sdf」 と表示されます。 エラーの詳細を見ますと、次のように表示されます。 ************** JIT デバッグ ************** Just-In-Time (JIT) デバッグを有効にするには、このアプリケーション、 またはコンピューター (machine.config) の構成ファイルの jitDebugging 値を system.windows.forms セクションで設定しなければなりません。 アプリケーションはまた、デバッグを有効にしてコンパイルされなければ なりません。 例: <configuration> <system.windows.forms jitDebugging="true" /> </configuration> JIT デバッグが有効なときは、このダイアログ ボックスで処理するよりも、 ハンドルされていない例外はすべてコンピューターに登録された JIT デバッガーに設定されなければなりません。 これが解決策かもしれませんが、どのようにすれば良いのか分かりません。 お分かりの方は、お教えいただけますでしょうか。 インストーラが使えないと、スタートメニューの登録とかコントロールパネルからの削除が出来なくなり困っています。
visual basicで、CheckBoxに値をセットするとエラーになります。 ＜例＞ Me.CheckBox1がNothingの状態で、 Me.CheckBox1.Checked = False すると、 『オブジェクト参照がオブジェクト インスタンスに設定されていません』というエラーが出ます。 CheckBoxをオフにするには、どうすれば良いのでしょうか？
Excel VBAにて、質問します。お手数ですが宜しくお願いします。 画像の様に、E列に特定の記号"●"や"▲"含んだ行以外、抽出し 印刷のシート名に貼り付けしたいと思います。 ですが、条件がありまして、その条件とは、InputBoxを使って 抽出したい日付を入力し、入力した日付、時刻までの記号"●"や"▲"以外 を抽出できる様にしたいです。 例えば実行時の日付が8/21日ならば InputBoxに、8/28 20：00と入力したら、入力した日付、時刻までの 記号"●"や"▲"以外を抽出となります。 画像の様に、1行目の見出し名も貼り付けできる様に、VBAを使って できませんでしょうか？ ※　画像ではSheet1のみ載せましたが、 Sheet2とSheet3とSheet4とSheet5とSheet6まで似た内容のデータがあるので シート名を指定して動作できると良いです。 Array("Sheet1","Sheet2","Sheet3","Sheet4","Sheet5","Sheet6")見たいな 感じでできますでしょうか？ どの様なコードを書けば良いでしょうか？ 御面倒お掛けしますが宜しくお願いします。
お世話になります。 ThisWorkbookとActiveWorkbookの使い方で悩んでいます。 ThisWorkbookのデータをActiveworkbookにコピーしようとしています。 Sub test() Dim temp As String, lrow As Long temp = "C:\申請.xlt" Workbooks.Open temp MsgBox ThisWorkbook.Name MsgBox ActiveWorkbook.Name ThisWorkbook.Sheets("Sheet3").Range(Cells(6, 3), Cells(lrow, 3)).Copy ActiveWorkbook.Sheets(1).Cells(6, 3) End Sub メッセージボックスで確認するとThisWorkbookとActiveWorkbookを正しく選択してくれているのですが、 実際にコピーをする作業のところでは、ThisWorkbookのデータを同じファイルに書き込んでしまいます。 Dim Sendbook As String Workbooks.Open temp Sendbook = ActiveWorkbook.Name を追加して ThisWorkbook.Sheets("Sheet3").Range(Cells(6, 3), Cells(lrow, 3)).Copy Workbooks(Sendbook).Sheets(1).Cells(6, 3) とすると、アプリケーション定義またはオブジェクト定義のエラーです。となります。 どこが間違っているのか、教えてください。 よろしくお願いします。
複数の動画ファイルをD&Dして、ファイル名に更新時間と動画時間（動画ファイルのプロパティのビデオの欄に表示される「長さ」という項目） をファイル名に追加するプログラムを書きたいと考えています。 更新時間を書き込む方法は http://www.vector.co.jp/soft/winnt/util/se501476.html のvbsを参考に作ることができました。 動画時間の読み取りに関しては http://q.hatena.ne.jp/1312251379 に書かれてあるのですが、うまくいきません。 ExtendedPropertyのところで、 オブジェクトでサポートされていないプロパティまたはメソッドです。 というエラーが出て実行することができません。 以下が、作りかけですが、作成したプログラムです。 WScript.Echo "Duration : [" & CStr(objFile.ExtendedProperty2("Duration")) & "]" ' 単位は 100ns のところをどのように書き換えれば良いか教えていただけないでしょうか？ Dim stArrayData Dim objParam Set objParam = WScript.Arguments'D&Dでの読み込みを可能にする Dim objFs Set objFs = WScript.CreateObject("Scripting.FileSystemObject") ' 引数の全ファイルについてファイル名を変更する Dim objFile Dim dtLastModified Dim strLastModified Dim i Const FMTID_AudioSummaryInformation = "{64440490-4C8B-11D1-8B70-080036B11A03}" For i = 0 To objParam.Count - 1 If objFs.FileExists(objParam(i)) Then Set objFile = objFs.GetFile(objParam(i)) ' DateLastModifiedのフォーマットが環境によって違うかもしれないので ' いったんDate型にする dtLastModified = CDate(objFile.DateLastModified) If Hour(dtLastModified) < 10 Then strLastModified = strLastModified & "0" End If strLastModified = strLastModified & Hour(dtLastModified) If Minute(dtLastModified) < 10 Then strLastModified = strLastModified & "0" End If strLastModified = strLastModified & Minute(dtLastModified) ' ファイル名を設定 stArrayData = split(objFile.Name, ".") objFile.Name = stArrayData(0) & "-" & strLastModified & "." & stArrayData(1) WScript.Echo "FileName : [" & objFile.Name & "]" WScript.Echo "Duration : [" & CStr(objFile.ExtendedProperty2("Duration")) & "]" ' 単位は 100ns WScript.Echo "FMTID_AudioSummaryInformation,3 : [" & CStr(objFile.ExtendedProperty(FMTID_AudioSummaryInformation & " 3") ) & "]" ' 単位は 100ns Set objFile = Nothing End If Next Set objFs = Nothing Set objParam = Nothing
System.Net.NetworkInformationの NetworkInterface[] adapters = NetworkInterface.GetAllNetworkInterfaces(); をつかって、MACアドレスを取得しているのですが、CMDのipconfigと比べると明らかに取得数がすくなく、どうやら、取得した時点で使用しているMACアドレスしか取得できていないことがわかりました。 あと、ipconfigだと、ブルートゥースのアドレスなども取得していました。 .netの機能で、ipconfingと同じように、そのPCのすべてのMACアドレスを取得したいのですが、方法はないのでしょうか？CMDから取得する方法を現在はとっているのですが、遅すぎて困っています。 環境はVS2010のC#です。
VS2013上でアプリが完成したので、発行してVS2013の環境のない別マシンで動作確認を行ったところ、そのコンピューターに音声リソースが存在しなかったため正常動作しませんでした。これでは配布することができません。 リソースをexeに埋め込むとか、発行時にセットアップファイルに同梱させる方法はありませんでしょうか。
複数ユーザーが使用するものを作っています。 ユーザーが任意に選んだエクセルの任意のセルの値を取得することは可能でしょうか？可能であればお教えいただけませんか？不可能であれば何か代替案をいただけるとうれしいです。 よろしくお願いします。
お世話になります。 EXCEL VBAで 以下の処理をしています。 C6の内容に応じて、セルに式を設定するだけなのですが このシートの全然関係ないセルで[Delete]キーを押下した際に 実行時エラー　13 型が一致しません というエラーが発生します。 どういう理由でエラーとなるのでしょうか？ また、どのような対処をすればいいでしょうか？ 以下、実際のコードです Private Sub Worksheet_Change(ByVal Target As Range) If Target = Range("C6") Then If Range("C6").Value = "する" Then Range("I11").Formula = "=C7" Range("I12").Formula = "=C7" Range("I13").Formula = "=C7" Range("I14").Formula = "=C7" Range("J11").Formula = "=C8" Range("J12").Formula = "=C8" Range("J13").Formula = "=C8" Range("J14").Formula = "=C8" Else Range("I11").Formula = "" Range("I12").Formula = "" Range("I13").Formula = "" Range("I14").Formula = "" Range("J11").Formula = "" Range("J12").Formula = "" Range("J13").Formula = "" Range("J14").Formula = "" End If Else End If End Sub
エクセルのセル式の質問で恐縮ですが シート1　の　Ａ列　月日　Ｂ＝時間　15分ピッチ　Ｃ＝データ　　空列に　月日+時間は可能です（が　、下記の検索の為に時間のみ　取り出す方法が分かりません　A10+hour（B10）で　0：00になります） 2014/1/6　19:45　データ1 2014/1/6　20:00　データ2 2014/1/6　20:15　データ3 2014/1/6　20:30　データ4 2014/1/6　20:45　データ5 2014/1/6　21:00　データ6 シート2　Ａ列　月日　Ｂ＝時間　1時間ピッチ　Ｃ＝データ　　空列に　月日+時間は可能です 2014/1/6　19:00　データ60-19 2014/1/6　20:00　データ60-20 2014/1/6　21:00　データ60-21 シート1　に　シート2のデータで　月日と時間が一致する　値を埋め込みたいのです 2014/1/6　19:45　データ1　データ60-19 2014/1/6　20:00　データ2　データ60-20 2014/1/6　20:15　データ3　データ60-20 ＶＢＡでなく　シート1の　Ｄ列に入れる　セル式が欲しいのですが シート1,2　とも　検索の為の　列は利用できます。 よろしくどぞ
エクセル2010で下記コードの矢印の部分でエラーが出てしまいます。 ほぼネットで見つけたコードそのままですが矢印のところで題記のエラーが出てしまいます。 内容はトヨタのホームページの燃料電池車の画像を保存するはずなのですが・・・ どなたかご存知の方ご教示いただけますでしょうか？？？ Sub aaa() GetImageFile "http://toyota.jp/sp/image/e_bn/", "FCV_20140625.jpg" End Sub Sub GetImageFile(ImgName As String, SaveName As String) Dim SaveFileName As String, DownloadFile As String, Ret As Long If ImgName = "" Then Exit Sub SaveFileName = SaveName DownloadFile = ImgName Ret = URLDownloadToFile(0, DownloadFile, SaveFileName, 0, 0)　’←ここです If Ret = 0 Then MsgBox "ダウンロードできました" Else MsgBox "エラーが発生しました" End If End Sub
Visual Studio 2013でプログラムを作っているときにメニューバーを配置し、 「ヘルプ=>バージョン情報」と構成し、バージョン情報をクリックすると、 別で用意したバージョン情報フォームを表示させたいのですが、 'バージョン情報 Private Sub バージョン情報ToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles バージョン情報ToolStripMenuItem.Click ShowDialog(AboutBox1) End Sub としても、 追加情報:既に表示されているフォームをモーダル ダイアログ ボックスとして表示できません。showDialog を呼び出す前に、フォームの Visible プロパティを false にしてください。 と表示されてしまいます。 どのようにすればうまくいくでしょうか。よろしくお願いします。
毎日同時刻に下記のVBSファイルを自動実行したいと思います。 タスクスケジューラで実行すると download.exe は起動しますが 表示されたダイアログがアクティブ状態にならないため （タイトルバーが灰色のまま、タスクバーのボタンが点滅）、 文字入力ができないまま、処理が終了してしまいます。 １．ダイアログをアクティブにし、正常に処理を実行させるには 　　どのように記述すれば良いですか？ ２．このVBSファイルをユーザーがログオフされている状態で 　　実行することは可能ですか？ 恐れ入りますが、ご存じの方がおられましたら、ご教示願います。 ＜環境＞ Windows 2008 Server R2 standard （64ビット） ＜D:\aaa.vbs＞ Set objShell = WScript.CreateObject("WScript.Shell") 'ダウンロードEXEを実行 Set objExec = objShell.Exec("D:\download.exe") WScript.Sleep 1000 objShell.AppActivate(objExec.ProcessID) 'ファイルのダウンロード先を指定し、実行（ENTER） WScript.Sleep 1000 objShell.SendKeys "D:\data.txt~"
初心者です。 いろいろ試してみたのですが、だめでした。 ご教授ください。 対象という名前を定義させたいと思っています。 定義の参照範囲は可変です。 定義したい範囲はSheet1のAA3からAAの最終行までです。 それでマクロの自動記録から名前の定義のコードを取ってきて 変数を代入してみましたが、参照範囲を正しく取ってきてくれませんでした。 Sub test() '対象の名前を定義する Dim n As Long n = Sheets("Sheet1").Cells(Rows.Count, 27).End(xlUp).Row Sheets("Sheet1").Select Range(Cells(3, 27), Cells(n, 27)).Select ActiveWorkbook.Names.Add Name:="対象", RefersToLocal:="=Sheet1!R3C27:RnC27" End Sub RefersToLocal:="=Sheet1!R3C27:RnC27"の部分を RefersToLocal:="=Sheet1!R3C27:R&n&C27" RefersToLocal:="=Sheet1!R3C27:"R"&n&"C27"" にしてもだめでした。 うまく範囲をとってくれる方法を教えてください。 お願いします。
EXCELのマクロについて質問させてください。 一覧シートから、職種別の各シートへ集計（貼り付け）が出来るような プログラムを作成したいのでやってみたところ、私の知識では上手く出来ませんでした。 お力をお借り出来ると幸いです。 具体的には、一覧シートへ入力後（毎月入力） 『A』　『B』　『E』と分かれた職種別の各シートへ職種別かつ氏名の昇順でソートが掛かった状態で 貼り付け？集計？が出来るようにしたいです。 一覧シートのB列には「A・B・E」のどれかの職種が入力されており 氏名はD列E列へ記載しています。（漢字、カナ表示） A～AD列までデータを記入していますので、全て各シートへ集計出来ると嬉しいのですが・・・ 行は8行目から記載してます。 上記のようにプログラムを組む事は可能でしょうか。 具体的なプログラムも載せて頂けると嬉しいです。 宜しくお願い致します。
Access2010を使用しています。 エクスポートするExcelファイルに画像のような作成日を入れたいのですが どの様にすればよいでしょうか？
いつも大変お世話になっております。 上手く説明できない点もあるかと思いますが、 よろしくお願い致します。 現在、色々とプログラムを組むことが多く、 毎回調べては書いて…の繰り返しのため 良く使うもの・便利だったものはメモ帳などに貼り付けて 保存してあります。 しかし、この状態では メモ帳が大量にあり探すのにとても苦労しますし、 内容もとても見づらいものになってしまいます。 現在、同フォルダにあるTXTファイルを自動的にHTMLに変換するVBSと 同フォルダにあるファイルのリンクを作成し、一覧をHTMLにするVBSを作りました。 少しずつ便利にはなってきていますが、 やはり見づらさという点では変わりありません。 そこで、やりたいこととしまして ・ジャンル別に分けたい。　（できればツリー状にして表示したい） ・2フレームで作成したい。（左側に目次、選択したものを右側に表示） 全自動でHTMLファイルを作成しようと思っているのですが、 さすがにむずかしいでしょうか？ 例えば HTML化用ファイル 　　| 　　|--「HTMLファイルをここに作成」 　　| 　　--TEST 　　　　｜ 　　　 　------ブック 　　　　｜　　　　|___新規ブック.html 　　　　｜　　　　| 　　　　｜　　　　|___ブック名編集.html 　　　　｜ 　　　 　------シート 　　　　｜　　　　|___新規シート.html 　　　　｜　　　　| 　　　　｜　　　　|___シート編集.html 　　　　｜　　　　| 　　　　｜　　　　|___シート保護.html 　　　　｜　　　　| 　　　　｜　　　　|___シートコピー.html 　　　　｜　　　　| 　　　　｜　　　　|___シート削除.html 　　　　｜　　　　 　　　　｜　　　　 　　　　｜　　　　 　　　 　------目次３ 　　　　｜ 　　　 　------目次４ 　　　　｜ 　　　 　------目次５ ----------------------------------------- 【理想】 　　　　 　　　 　| 　　　TEST 　　 |　 　　　　｜ 　　　 |　 　　　 　------ブック 　 | 　　　　｜　　　　|___新規ブック.html |　クリックしたHTMLの内容表示 　　　　｜　　　　| 　　　| 　　　　｜　　　　|___ブック名編集.html | 　　　　｜ 　　　 | 　　　 　------シート 　 | 　　　　｜　　　　|___新規シート.html | 　　　　｜　　　　| 　　　| 　　　　｜　　　　|___シート編集.html | 　　　　｜　　　　| 　　　| 　　　　｜　　　　|___シート保護.html | 　　　　｜　　　　| 　　　| 　　　　｜　　　　|___シートコピー.html | 　　　　｜　　　　| 　　 | 　　　　｜　　　　|___シート削除.html 　| 　　　　｜　　　　 　　　| 　　　　｜　　　　 　　　| 　　　　｜　　　　 　　　| 　　　 　------目次３ 　| 　　　　｜ 　　　 | 　　　 　------目次４ 　| 　　　　｜ 　　　 | 　　　 　------目次５ 　| ↑↑　折りたたむことも可能↑↑ 今は、同じフォルダ内にあるものを HTML化することはできています。 ------------------- Sub TEST2() Dim strScriptPath'自分の現在位置 strScriptPath = Replace(WScript.ScriptFullName,WScript.ScriptName,"")'フルネームから、スクリプトネームを削除！ ' フォルダをオブジェクト取得 Set objFso = CreateObject("Scripting.FileSystemObject") Set objFolder = objFso.GetFolder(strScriptPath) Set HTMLOutPutData = objFso.CreateTextFile("ファイル一覧.html",True) HTMLOutPutData.WriteLine "<html>" HTMLOutPutData.WriteLine "<head>" HTMLOutPutData.WriteLine "<title></title>" HTMLOutPutData.WriteLine "</head>" HTMLOutPutData.WriteLine "<body>" HTMLOutPutData.WriteLine "<h1 align=""" &"center" &""">まとめ</h1>" HTMLOutPutData.WriteLine "<hr>" for each file in objFolder.Files If file.name<> "ファイル一覧.html" and file.name<> WScript.ScriptName and Right(file.name,4)<> ".vbs" Then HTMLOutPutData.WriteLine "<font size=""" &"5" &"""><a href=""" & file.Path & """>"& file.name & "</a></font><br>" End if Next HTMLOutPutData.WriteLine "</body>" HTMLOutPutData.WriteLine "</html>" End Sub ------------------ http://lll.s21.xrea.com/m/link/37.html Javascriptは特にやっていなかったのと、 HTMLも不慣れなため、簡単なものしかかけませんでした。 フォルダ内の状況をそのまま HTMLとして出力する方法があれば、 教えて下さい。 よろしくお願い致します。 以上、よろしくお願い致します。
Beepと記述すると一回だけビープ音が鳴りますが、 ある処理をしている最中、ビープ音を鳴らすことは出来ますでしょうか？
早速ですが WEBクエリーで　下記の値が　セルに取り出せます Last Updated: Friday, 25 Jul 2014 06:00 PM これを　他のセル　と　比較するために　yyyy/mm/dd　に変換したいのですが MIDで　取り出すと　曜日と月のスペル文字列の長さが一定でないので困っています。 何か方法は無いでしょうか If Format(Mid(NKNY.Range("J213"), 15, 10), "yyyy/mm/dd") = Format(NKNY.Cells(10, 2) - 1, "yyyy/mm/dd") Then
35万件以上あるエクセルデータに対して、マクロを使って以下のような処理で重複業を削除したいと思っています。 Sub DeleteOldRow() Dim lastRow As Integer Dim i As Integer Dim j As Integer Dim strVal As String 'B列の最終行を求めます。 lastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, 2).End(xlUp).Row '1行目から最終行の前まで繰り返します。 For i = 1 To lastRow - 1 'チェックする値を、strValに代入します。 strVal = ActiveSheet.Cells(i, 2).Value '今見てる行から、下をチェックします。 For j = i + 1 To lastRow 'もし、値が同じであれば、 If strVal = ActiveSheet.Cells(j, 2).Value Then '元の行を削除します ActiveSheet.Rows(i).Delete '最終行が１行減ったのでlastRowの値を減らします。 lastRow = lastRow - 1 'チェックしている行を１行前に戻します。 j = j - 1 End If Next j Next i End Sub 上記処理を３５万件あるファイル上でマクロの実行すると、オーバーフローしてしまいました。マクロ側で対象ファイルを読み込むなどして、処理を軽くするやり方はありますでしょうか。上記処理にどのような処理を加えればスムーズに処理されるでしょうか。
例えば、テキストボックス内でF1を押した時に あるプログラムを走らせたいのですが、 F1を押したかどうかは、どうやって判定すれば良いのでしょうか？
VB6でForm内にCommandButtonがいくつか有ります。 各CommandButtonはClickするとShellオブジェクトでファイルを開く様になっています。 やりたいことは 2つのCommandButton間をDragDrop？によりCaptionを入れ替えたいです。 (CommandButton間をマウスDragDropでCaption名入れ替え) MouseDownとDragDropイベントで何とかなると思いましたがうまくいきません。 Dim dd As Integer Private Sub Command1_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single) If Button = vbLeftButton Then dd = 1 'CommandボタンNo, End If End Sub Private Sub Command2_DragDrop(Source As Control, X As Single, Y As Single) Dim cn As String cn = Command2.Caption Command2.Caption = Controls("Command" & dd).Caption Controls("Command" & dd).Caption = cn End Sub CommandButtonプロパティでDragModeを自動にするとShellオブジェクトでファイルが開かないし サイトで調べたところファイルの移動やコマンド自体の移動などで分かりませんでした。 ご教授お願い致します。
指定するキーが無かった場合は終了。 あった場合、指定キーにデータを上書きする。 無かった場合は終了する。 こういうVBSプログラムを書きたいと思っています。 例）HKEY_CURRENT_USER\Software\TEST1\TEST2\TEST3の中の 　　名前が　Level　のキーの値を5に変更 色々探した結果 ---------------------------- WScript.Echo "レジストリの値を変更します" Set Shell = CreateObject("Wscript.shell") On Error Resume Next If IsNull(shell.regread("HKEY_CURRENT_USER\Software\TEST1\TEST2\TEST3\Level")) Then WScript.Echo "レジストリが存在しません。" Else WScript.Echo "レジストリのLavelキーの値を5に変更します。" Shell.RegWrite "HKEY_CURRENT_USER\Software\TEST1\TEST2\TEST3\Level", 5, "REG_SZ" End If -------------------------------- このように書いて、VBSとして実行しようと思うのですが 何か問題とかありそうでしょうか？ （また、思い通りの操作ができそうでしょうか…） レジストリということもあり、何も考えずに実行してしまうのは少し怖いです。 以上、回答お願い致します。
初めて質問せて頂ます 指定した文字だけを変更することは可能なのですが セル内にある指定した文字全部の色が変わらなくて困っています マクロ初心者なもので大体インターネットから拾ってきたものをつなぎ合わせて使う程度の能力です どなたか教えていただけませんでしょうか？ ちなみに「質問No.2769123」を参考にしましたがセルに含まれる文字は１つしか色が変わりません 例）セル内に指定した文字が10個あった場合全部色を変えたいと思っています 1つのセル内の文字「ABCD、ABCD、ABCD、ABCD、ABCD、ABBA、ABCD、ABBA、ABBA、ABCD…」 上記の場合ABBAの文字を全部赤に変えたいといった感じです どうかよろしくお願いいたします 経緯としては検索した文字がヒットしたらその文字の色を変更したいと思ったからです
Excel2013 Enterキーを押すと隣りのセルに移動ではなく、次に入力したいセルにカーソルが移動するようにしたいです。 たとえば、 必要事項を入力する書類で、B2のセルに入力したら次はD5のセルに入力、次はA6に入力といった書類あり、Enterキーを押して次の入力セルに移動するようにしたい。また、書類の書式を崩されたくないのでシート保護して使いたいです。 Enterで進み、戻る時はUPキーか、↑キーなどで設定したいと考えてます。 どなたか、VBで教えてくださる方お願いします。
Excel2013 指定した文字の個数を求めたい。 例えば、 A1からJ1に入力された"a"の数をK1に表示。 続いてA2からJ2に入力された"b"の数をK2に表示。 関数ではなくて、VBでコードを書きたいのですが、どなたがVBに詳しい方教えて下さい。よろしくお願いします。
VB2010でファイルの置き換えについてご相談させてください。 ファイルが2つあります。 ・C:\MyFile.txt ・D:\YourFile.txt(このYourFile.txtは日々、ファイル作成日が更新されるものとします） この2つはファイル作成日が違います。 それを利用して、 MyFile.txtとYourFile.txtのファイル作成日を比較。 YourFile.txtのファイル作成日が新しければ、MyFile.txtと置換え。 といった事をしたいと思っています。そこで、FileInfo.CopyToメソッドを利用しました。 そうすると、YourFile.txtがMyFile.txtより新しい日付でも中身をコピーするだけで作成日はかわりませんでした。 次に、FileInfo.Replaceメソッドを利用しようと思いましたが、これはバックアップファイルを作成するみたいなので、それは不要のため利用するのはやめました。 後は、もしYourFile.txtのファイル作成日が新しければ、MyFile.txtを削除。 その後、CopyToメソッドを使用してファイルをコピーするといった方法が思いつきました。 他に何かスマートな方法はないでしょうか？
お世話になります。 アクセス使い始めて１ヶ月ぐらいの初心者です。 アクセスのフォーム１に、ファイル参照ボタンを作って フォーム１にテキストボックスも作り、参照ボタンで選んだ path?をテキストボックスに入るようにしました。 次にそのテキストボックスに入ったpathを利用して、外部からテキストファイルを インポートしたいのですが、 インポートボタンを作って、ボタンを押したらテキストボックスに参照して入ってるpathを 取得してインポートできるようにしたいのですが、、、 知恵をお貸しいただけたら嬉しいです。 今作ったのは Private Sub コマンド44_Click() Dim objFileDialog As Object 'FileDialog Dim stTitle As String 'タイトル Dim stPath As String 'ファイルパス Dim stInitialFileName As String '初期ファイルパス If Me.chk.Value = -1 Then stTitle = "ファイル参照" '★ stInitialFileName = "C:\Test\" '★ Set objFileDialog = _ Application.FileDialog(msoFileDialogFilePicker) Else Const msoFileDialogFolderPicker = 4 'フォルダの参照 stTitle = "フォルダ参照" '★ stInitialFileName = "C:\Test\" '★ Set objFileDialog = _ Application.FileDialog(msoFileDialogFolderPicker) End If With objFileDialog 'ダイアログボックスのタイトル .Title = stTitle '初期フォルダパス .InitialFileName = stInitialFileName If .Show = False Then 'キャンセル時 GoTo Exit_SUB Else '★選択時フォルダパス表示 stPath = .SelectedItems(1) Me.テキスト45.Value = stPath End If End With Exit_SUB: Set objFileDialog = Nothing End Sub とゆう感じでテキストボックス４５に入ったpathを利用してインポートしたいのです、 文章が読みにくくて申し訳ないです、 よろしくおねがいします。
いつもお世話になっております。 http://okwave.jp/qa/q8672643.html 前回質問させていただいた、 ｔｘｔファイルをHTMLに自動的に変換するプログラムを 作成中ですが、 ひとつ分からない点があるため、質問させていただきました。 ためしに、テキストファイル２つ。 VBSファイル１つをフォルダに置いて実行してみました。 しっかり1行ずつ実行できているか Msgbox　を使って確認したのですが、 1つ目のファイル「読み込み失敗.txt」が1度で全部読み込みしてしまい、 2つ目のファイル「読み込み成功.txt」は1行ずつ読み込め、無事変換できております。 ------------読み込み失敗.txt------------- Private Sub CommandButton1_Click() Application.DisplayAlerts = False Application.ScreenUpdating = False ''資料作成 ChertGraph.ComboBox1.Value = Me.ComboBox1.Value 'データ入力 Call ChertGraph.CommandButton1_Click 'ボタンクリック Graph_MAKE.ComboBox1.Value = Me.ComboBox1.Value'データ入力 Graph_MAKE.ComboBox1.Value = Me.ComboBox1.Value'データ入力 Call SCKindofGraph_SELECT.BothCreate_Click'ボタンクリック Call SCKindofGraph.CommandButton1_Click 'ボタンクリック History.ComboBox3.Value = Me.ComboBox1.Value '履歴に値を入れる Call History.CommandButton1_Click '履歴出力実行 Call BookCopy 'データ出力 Application.DisplayAlerts = True Application.ScreenUpdating = True Call Module1.sheet_sort MsgBox Me.ComboBox1.Value & vbCrLf & "完了しました。" Worksheets("TOP").Activate End End Sub ---------------------------------------- ------------読み込み成功.txt------------- Sub ComboboxNarabi() Dim i As Long Dim j As Long Dim Count As Long Dim Swap As String Dim SortListData As Variant SortListData = Array("A", "B", "C", "D", "E", "F", "G", "") Count = 0 For j = 0 To UBound(SortListData) For i = 0 To ComboBox2.ListCount - 1 If ComboBox2.List(i) = SortListData(j) Then Swap = ComboBox2.List(Count) '現在の位置の内容をSwapにコピー ComboBox2.List(Count) = ComboBox2.List(i) '現在位置に、検索したワードをコピー ComboBox2.List(i) = Swap 'もとの内容をコピー Count = Count + 1 End If Next Next End Sub ---------------------------------------- --------------VBSファイル--------------- Dim strScriptPath'自分の現在位置 strScriptPath = Replace(WScript.ScriptFullName,WScript.ScriptName,"")'フルネームから、スクリプトネームを削除！ ' フォルダをオブジェクト取得 Set objFso = CreateObject("Scripting.FileSystemObject") Set objFolder = objFso.GetFolder(strScriptPath) for each file in objFolder.Files If file.name<> WScript.ScriptName and Right(file.name,5)= ".html" Then objFso.DeleteFile file.Path End if Next Set objFolder = objFso.GetFolder(strScriptPath) for each file in objFolder.Files If file.name<> WScript.ScriptName and Right(file.name,4)= ".txt" Then Msgbox file.Path Set HTMLOutPutData = objFso.CreateTextFile(objFso.GetBaseName(file) & ".html",True) Set fileRead = objFSO.OpenTextFile(file)'ファイルを開く If Err.Number = 0 Then HTMLOutPutData.WriteLine "<html>" HTMLOutPutData.WriteLine "<head>" HTMLOutPutData.WriteLine "<title></title>" HTMLOutPutData.WriteLine "</head>" HTMLOutPutData.WriteLine "<body>" HTMLOutPutData.WriteLine "<h1 align=""" &"center" &""">"& objFso.GetBaseName(file) & "</h1>" HTMLOutPutData.WriteLine "<hr>" Do Until fileRead.AtEndOfStream = true LINEDATA = fileRead.ReadLine Msgbox LINEDATA If InStr(LINEDATA,"'") = 0 then'含んでない場合 HTMLOutPutData.WriteLine "<font color=""" &"black"&""">" & LINEDATA & "</font><br>" Else HTMLOutPutData.WriteLine Replace(LINEDATA,"'","<font color=""" &"green"&""">'") & "</font><br>" End if Loop HTMLOutPutData.WriteLine "</body>" HTMLOutPutData.WriteLine "</html>" fileRead.Close Else MsgBox "ファイルが開けません" End If End if Next Msgbox "終わり！" ---------------------------------------- LINEDATA = fileRead.ReadLine Msgbox LINEDATA と実行した場合に、何故1行ずつ読み込めていないのか 調べ方が悪いのか情報が無かったため 何か情報があれば、お願い致します！ 以上、よろしくお願い致します。
Visual Basic を用いて、TextBoxから入力した 数字について、ボタン１を押すと平方根を求め、Labelに書き出し、 ボタン２を押すとリセットされるプログラムを 作りたいのですが、全くわかりません。 コピペしたらプログラムが動くコードを教えてください。 お願いします。
お世話になっております。 同じフォルダの中に入っているtxt全てを 自動的にHTML化しようと思っています。 分からないなりに考えて書いたのは下記コードです。 --------------------------------- Dim strScriptPath'自分の現在位置 strScriptPath = Replace(WScript.ScriptFullName,WScript.ScriptName,"")'フルネームから、スクリプトネームを削除！ ' フォルダをオブジェクト取得 Set objFso = CreateObject("Scripting.FileSystemObject") Set objFolder = objFso.GetFolder(strScriptPath) for each file in objFolder.Files Set fileRead = objFSO.OpenTextFile(file)'ファイルを開く If file.name<> WScript.ScriptName Then 'Msgbox objFso.GetBaseName(file)ファイル名 Msgbox objFso.GetBaseName(file) Set HTMLOutPutData = objFso.CreateTextFile(objFso.GetBaseName(file) & ".html",True) 'If InStr(l, "本社") = 0　含んでない場合 'Replace(文字列,どれを、どれに) '<font color="green">文字列</font>緑色に If Err.Number = 0 Then HTMLOutPutData.WriteLine "<html>" HTMLOutPutData.WriteLine "<head>" HTMLOutPutData.WriteLine "<title></title>" HTMLOutPutData.WriteLine "</head>" HTMLOutPutData.WriteLine "<body>" HTMLOutPutData.WriteLine "<h1 align=""" &"center" &""">"& objFso.GetBaseName(file) & "</h1>" HTMLOutPutData.WriteLine "<hr>" Do Until fileRead.AtEndOfLine = true LINEDATA = fileRead.ReadLine If InStr(LINEDATA,"'") = 0 then'含んでない場合 HTMLOutPutData.WriteLine "<font color=""" &"black"&""">" & LINEDATA & "</font><br>" Else HTMLOutPutData.WriteLine Replace(LINEDATA,"'","<font color=""" &"green"&""">") & "</font><br>" End if Loop HTMLOutPutData.WriteLine "</body>" HTMLOutPutData.WriteLine "</html>" fileRead.Close Else MsgBox "ファイルが開けません" End If End if Next Msgbox "終わり！" ------------------------------------------- とりあえず、'の後全ては緑色に変更。 1行読み込み、1行ずつ改行。 元のファイル名と同じで、拡張子を.htmlにして保存。 これを目標にやっていましたが、 全ファイル思ったとおりに行くわけではなく エラーの連続です。 プログラムが悪いのでしょうか？ 1個目のファイルはどんどん重くなり、 300Kくらいのサイズになります。（他のファイルは２K程度です） それを削除しようとすると、どんどんパソコンが重くなり… どこかのループが悪さしているのでしょうか？
VBAの初心者で、なかなか思うようにいきません。 とても恐縮ですが、どなたかにご指導頂きたくこちらに投稿させていただきました。 環境はExcel2010です。 ワークブック「DATA]、ワークシート名「data」にあるデータを ワークブック「TEST」、ワークシート名「test」に張り付ける。 また、元データのワークブック名はこのマクロを行う際に選択出来るようにしたいです。 張り付けるデータは、図の 「数値2」欄に記述されている数字の行に対して 「数値１」欄の数値と、「名前」欄の（カッコ内）のローマ字のみを エクセル名TESTに張り付けたいです。 その際「数値1」はA列、「名前」はB列にそれぞれ行の1から。 また、「数値1」欄が”0”であったり”=H10+I10”のような式の場合、 その行の「数値1」欄の値と「名前」欄の文字を 張り付けないようにしたいです。 画像のようになるのが目標です。 今現在私の考えている方法では 「数値2」を LAST = ActiveSheet.Range("D3").End(xlDown).row で空白セルの一つ上のセルの行数を出す。（この場合⇒7=LAST） 「数値1」欄のコピー、貼り付けを if文でC3からLASTまで・・・・。 とここまででものマクロでさえエラーがずっと続き コンパイルが通らず 分からないことだらけです。 言葉足らずで質問内容が分かりにくいかもしれません。 どうぞ宜しくお願い致します。
早速ですが =SUM(INDIRECT("g"&P25&":g"&P26))　自分のシートは無問題 でも、 =SUM(INDIRECT("損益!M"&P25&":損益!M"&P26))　が　#REF!　となります。 p25,p26　は　それぞれ　合計したい行の数値です。 最終は =SUMIF(indirect("損益!M"&q25&":損益!M" &q26,">0", "損益!M"&q25&": 損益!M"&q26))) これなのですが・・・・ どこで　間違ったのでしょうか よろしくどうぞ
Visual Basic を用いて、TextBoxから入力した 数字について、平方根を求め、Labelに書き出す プログラムを作りたいのですが、全くわかりません。 コピペしたらプログラムが動くコードを教えてください。 お願いします。
実行中の他のアプリのパスを取得する方法を教えてください。 プロセスの一覧の取得はできるんですが、インストールされている場所が取得できません。 例えば「エクセル」だとプロセス名の「EXCEL」は取得できるんですが、「C:\Program Files\Microsoft Office\Office\EXCEL.EXE」も取得したいのです。 例えば「メモ帳l」だとプロセス名の「notepad」は取得できるんですが、「C:WINDOWS\system32\notepad.exe」も取得したいのです。 検索してみてるんですが、ありそうでないんです。 OSはWindowsXP、VisualBasic2008で取得したいのです。 よろしくお願いします。
任意の数字を入力し、Len関数とMid関数を使って2進数を10進数に変換するというプログラムを作っているのですが、うまくいきません。 コードは Dim a　 As Integer Dim b　 As Integeｒ Dim i　　As Integer a = Val(TextBox1.Text) For i = Len(a) To 1 Step -1 If Mid(a, Len(a), 1) = "1" Then b += 2 ^ (i - 1) End If Next Label3.Text = b 　　　End Sub 上記のものが作ったコードです。 問題点の指摘をよろしくお願いします。
visual basicのeventとcontrolについての質問です。 　初心者で苦労しています。以下のようなcodeingをしましたが上手く行きません。宜しくお願いします。 1.下記のcall updatefileによりupdatefile内でcombobox内のdataを設定します。これは次のdialogで 　　設定どおりに出ています。しかし元のsub startdialog1に帰ってdialogを表示してみるとcombobox 　　内は空となっています。　　subroutineが変わるとformの　controlは消えるのでしょうか。 　　もしそうならどの様にすれば良いのでしょうか。 　　(pushdata変数等をpublicとして再度comboに入れることもやりましたがNG) ２．STARTDIALOG1の初めに　RADIO BUTTONの変更のCODEが有りますが、此処でEVENTが 　　　発生しUPDATEFILEに行きます。 　　　DIALOGを出すまでは初期値を設定しDIALOG上でCLICK等して変更をするCODEなので 　　　不具合です。　(ほかにもいろいろ同じCODEが入っていますので） 　　　CODE上の設定変更はEVENTが発生しないように、DIALOGからの変更はEVENT発生としたい 　　　のですがどの様にしたら良いでしょうか。(普通そうなので何か勘違いしてるかも) 　 INTERNETで見るとAddHandler,AddressOf,REmoveHandlerなどが記載されていますが、 　　　書き方と何処に書くのか判りません。(本当に必要かも?) 　　　よろしくお願いします。 　　　(以下のcodeは読みやすいように簡略化しています、code errorは大目に見て下さい。 ---------------------Form1.vbに記載---------------------------------------　　　 Sub STARTDIALOG1() 　　　'此処から処理が始まる with cform2 as Fform2 .Radio_btn1.Checked = True　　’ここへくるとbuttonのeventが発生,routineにいき,updatefileへいく Call UpdatePfile(1) 'ここはcomboboxの初期値を設定する(UPDATEPFILEを使う) .ShowDialog()　　 　 ’UpdatateFileでは入っていたがCOMOBOXの中は空になっている 　　　　　　　　　　　　　　この後comboboxのdataの選択などをdialogue上で設定値を変更する。 end with end sub -----------------------form1.vbに記載---------------------------------- sub UpdatePfile(ByVal cntlNO) 'PushDataはこの前にREADして設定している、keがそのDATAの個数 For k = 1 To ke cForm2.Combo_P.Items.Add(pushdata(k))　’COMBOBOX Comb_Pに一覧として入れる Next k cForm2.ShowDialog()　　　'ここではCOMBOBOXにPUSHDATAが入ったLISTがでる end sub --------------------------------------------------------------------------- DisalogはForm2に作成 　　　radioボタン　Radio_btn1とRadio_btn2,combobox combo_P等をsetしている '---------------------------Form2.vbに記載------------------------------------ Private Sub push_button(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Radio_BTN1.CheckedChanged,Radio_BTN2.CheckChanged Dim cls As Form1 RDBTN = 1 If RDBTN > 0 Then Call cls.UpdatePfile(RDBTN) end Sub
デスクトップの\dataフォルダに、名前を付け替えたいファイルが多数あります。 それらのファイル名（旧名）と、変更したい名前（新名）は、エクセル上の２列に 入力済みです。VBAを使って、ｄｏｓプロンプトのＲＥＮを実行しようとしましたが、 多くのファイル名にスペースが含まれるせいか、大半が変更できませんでした。 良い方法があれば、教えてください。どうかよろしくお願いします。 ※作成したプロシージャは以下の通りです。 Sub ファイル名変更() Dim カウンタ As Integer For カウンタ = 2 To 1000 Dim wsh As Object, wexec As Object, cmd As String Dim 旧名 As String, 新名 As String Set wsh = CreateObject("wscript.shell") 旧名 = Cells(カウンタ, 1).Value 　　　 '旧名はA列にある 新名 = Cells(カウンタ, 2).Value 　　　'新名はB列にある cmd = "ren c:\users\me\desktop\data\" & 旧名 & " " & 新名 Set wexec = wsh.Exec("%comspec% /c " & cmd) Set wexec = Nothing Set wsh = Nothing Next End Sub
Dim moji As String Dim myAll As Variant moji = "<" Set objMSXML2 = CreateObject("MSXML2.XMLHTTP") objMSXML2.Open "GET", "http://○○.html", False objMSXML2.Send myAll = objMSXML2.responseText myAll = Replace(myAll, Chr(10), "") と言うコードがあるのですが とあるサイトで、 myAll = Replace(myAll, Chr(10), "") の部分で、 実行時エラー１４ 文字列領域が不足しています。 となります。 どういう意味のエラーなのでしょうか？ 「文字列領域が不足」と言う日本語がわかりません。 ちなみに myAll = Replace(myAll, Chr(13), "") とすると、問題なくコードが通ります。
お初にお目にかかります 過去の質問を見ていて http://oshiete.goo.ne.jp/qa/8633081.html この方の質問と同じことを私もやりたいと思い NO2の方の回答と同じVBSファイルを作成して 起動しましたが 失敗しました -2147417848 とエラーが表示されてしまいます。 環境はwin7 64bitとExcel2007です。 なんとか私の環境でも動くようにならないでしょうか？ よろしくお願いいたします。
VisualStudio2008で、Access2010のデータベースからデータ抽出を行えるアプリを作っています。 このときＳＱＬ文を用いてAccessからデータ抽出を行うんですかね？ そもそもVisualStudio、SQL、Accessそれぞれがどのように関係しているのかわかりません。 いくつかサイトを見て回ったのですが・・・ 教えてほしいこと １．データ抽出アプリを作るにあたってVisualStudio、SQL、Accessの各々がどのような役割を果たすか ２．Accessのデータベースの形式は空or Webどちらが有効なのか ３．VisualStudioでデータの抽出を行う方法 長くなりましたがよろしくお願いします。 開発言語はＶＢで、私自身は簡単なプログラムであれば理解できるレベルです
Fortranのread/writeをＶＢへの書き換え方を教えて下さい。 他の方の作られたfortran.90のprogramをvisual basicに書きなおす作業をしています。その中の下記のfileのaccessが上手出来ません。このなかに有るbinary,とかbig_endianが原因のようです。 (これの無いfile accessの箇所は問題なく出来ました。) program内でdataをfileに書込み保存して蓄積しているようで、後日このdataをreadして使うようになっていますので新しくfileを作り直すわけにもいきません。 いろいろとcodeを入れてみたが、結果は文字化けばかりで10日も費してしまいました。 binary,bigendianなどの理屈が判っていないのでどうしょうもないと感じました。 どうか下記のfortranをVisual Basicへの書き変え方をご教授お願いします。 REAL ShipDim(17) '読み込みの時 　 filename = 'c:\pbcal\pbcal\pushdata\'//'push04' open (3,file= filename, status='old', & & form='BINARY', convert='BIG_ENDIAN',err=930) DO 10 J= 1,17 read(3) shipDim(j) 10 CONTINUE 　　　　　（中略)　　'見やすいように簡略化しています。 CLOSE (3,STATUS='KEEP') 　 '書込みの時はopenは下記で、後readをwriteに変えただけです。 open (3,file= filename, status=pstatus,form='BINARY', convert='BIG_ENDIAN',err=940) VBでTRYしたことの一例 　　　　Dim dat() As Byte = New Byte(-1) {} 　 Dim sr As System.IO.Stream = Nothing 　 Dim br As System.IO.BinaryReader = Nothing Dim strf As String = filepath & "push04" 'filepathは適当にしている 　　 sr = System.IO.File.Open(strf, _ 　　　　　　 System.IO.FileMode.Open, System.IO.FileAccess.Read) br = New System.IO.BinaryReader(sr) ReDim dat(sr.Length - 1) dat = br.ReadBytes(sr.Length) 　　　　 dat に=572個の2-3桁の数字が入っています。encodingなどでためしてみたが文字化け 　　　　ばかりです。 　　　(System.Text.Encoding.GetEncoding("＊＊＊＊").GetString(dat) など） 　　　　　 　　どうかよろしくお願いします。
VBAで文字列の抜き出しの方法を教えてください。 同様な質問があり、参考にしてみたのですがうまくいきません。 お分かりの方がいましたらご享受お願いいたします。 30~45字からなる文字列があります。 その中に特定の文字列が２つあり、そのうちの最初の特定文字列に続く文字２つ目の特定文字列前までを抜き出したいのですがうまくいきません。 具体的には abcdefghi GN=12jikl PE=fghj456 という文字列のなかから"GN="と"PE="の中間の文字を取り出したいのですが、 自分で書いたものでは"PE="以上が抜き出され、"GN="より前の文字列を抜き出せませんでした。 GN=......, PE=......の文字数はそれぞれ不規則です。また、GN=...よりも前の文字数も不規則です。 以下が作成したものです。 Dim i As Integer Dim Srch As String Dim Btwn As String Const Chr1 As String = "GN " Const Chr2 As String = "PE" Dim m As String Set sheetobj = ThisWorkbook.Worksheets("A") With sheeobj lastrow = sheetobj.Cells(sheetobj.Rows.Count, 10).End(xlUp).Row For i = 2 To lastrow Srch = sheetobj.Cells(i, 10) Btwn = Mid(Srch, InStr(Srch, Chr1) + 1, InStr(Srch, Chr2) - InStr(Srch, Chr1) - 1) sheetobj.Cells(i, 9) = Btwn Next i End With End Sub なにかいい方法があれば教えて頂けたらと思います。 よろしくお願い致します。
エクセルのマクロで以下の事を行いたいのですが、上手く行かずに悩んでおります。 どなたかご教示ください＞＜ 前提：範囲指定した部分をcsvで出力 1.csvの保存フォルダを指定したい （\\192.168~などのネットワークドライブ） 2.形式はデフォルトでcsvを選択した状態にしたい 3.ファイル名を「年月日売上表」にしたいので、デフォルトでファイル名部分に「売上表」と入れたい 年月日は都度手動で変更して保存したいので、上記のフォルダ選択→名前を付けるところまでとマクロで行いたい。 どなたかお知恵をお貸し下さい。
こんにちは。添付画像にあるような事をしたいと思っています。 左側のメニューはtreeviewコントロールで作られていると思います。ツリーの各ノードを選択すると、右側の領域が変更されるようにしたいと思っているのですが、どういった方法を使えば実現できるのかお教え頂けませんでしょうか？ コントロールを色々調べてみたのですが、該当するものがありませんでした。よろしくお願いいたします！
集計表などで○月小計などを表の途中に追加して更新する 作業が良くあるのですが・・・ 書式をコピーしてペーストの際に○月（例：４月→５月）を 自動で更新してくれるマクロがコードのどこからどこまでを指すのか 教えて頂きたくご教授下さい。 下記のコードは 選択した場所を２段下に書式コピーして先頭列の "月合計"　と　"月実績"　の部分の "○月" が自動で翌月になるように 書いて頂いたものです。 このコードの中で →"月合計"　と　"月実績"　の部分の　"○月"　が自動で翌月になるように という部分を指示しているコードを、他のマクロにも応用できるように勉強したいのですが どこからどこまでを　ひとつの区切りとして見たらよいかわかりません。 解説頂けると幸いです。 ちなみに、VBAの事は勉強中で初心者です。 変数の使い方について　筆者の理解度は・・・ 変数を　i　とした時 『 i が１から１０まで変化する』 みたいな単純なものしか、解説を見ても理解できないでいます。 この例題を使わせて頂いて変数のプログラムの書き方と ２段下を指定する方法など獲とくしたいと考えております。 よろしくお願いいたします。 [サンプルコード] Sub 書式を2段下にコピー() Dim i As Long Dim MyMonth As Integer Selection.Copy For i = Selection.Row + 2 To Selection.Row + 4 Step 2 Cells(i, "A").Select Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _ SkipBlanks:=False, Transpose:=False MyMonth = Val(StrConv(Left(Cells(i, "A").Offset(-1, 0).Value, 1), vbNarrow)) Cells(i, "A").Value = Month(DateAdd("m", 1, Year(Date) & "/" & MyMonth & "/" & "1")) & "月合計" Cells(i, "A").Offset(1, 0).Value = Month(DateAdd("m", 1, Year(Date) & "/" & MyMonth & "/" & "1")) & "月実績" Next Application.CutCopyMode = False End Sub ※本当は、上記のサンプルコードの回答を頂いたスレッドで質問を続けたかったのですが、 タイトルを変更することで、同じような事をしたくて検索している方の検索にひっかかりやすく なればいいなと思い、新たにスレッドを立ち上げさせて頂きました。
VBA勉強中の初心者です。 マクロで書式のコピーをしようと思い まずは、マクロの記録をしました。 ですが、いつも同じセルにコピーする訳ではないので プログラムに手を加えてペースト先を選択したセル もしくは、コピー元の何行下の行に・・・とか になるように書き変えたいのです。 （※筆者のやりたい事は、項目毎に毎月の集計欄を２行ずつ追加します。 『６月合計/６月実績』→『７月合計/７月実績』みたいに何月だけを変更して 書式は一緒で値はクリアにして・・と言うような事を１枚のSheet上で複数回 繰り返します。 〈マクロの記録をした状態〉 Sub 書式のコピー() Range("A2:D3").Select Application.CutCopyMode = False Selection.Copy Range("A11").Select　→→→→（ここの指定を色々変わる変数みたいのでどうにかしたい） Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _ SkipBlanks:=False, Transpose:=False End Sub 分からないなりに調べて１行マクロなるものでショートカットキーを割り当てて書式のコピーをする マクロってのを試して見たのですが・・・『該当するセルがみつかりません』とエラーが出てしまいます。 上記の１行マクロは、個人マクロブックに保存しました。 個人用マクロブックはエクセルを立ち上げると自動で立ち上がるようにはなっています。 〈１行マクロの中身〉 Sub 書式のコピー() 'Keybord shortcut: Ctrl+Shift+O Selection.PasteSpecial Paste:=xlFormats End Sub どちらも色々調べて試してみたのですが、上手くいきません。 ちなみに、試しているExcelは2007です。 どうか、アドバイスをお願い致します。
Excelのオートシェイプをテキストデータに変化するVBAを作成したいです ただし対象となるオートシェイプは複数のオートシェイプがグループ化された グループオブジェクトになっています それら特定のパターンを持つオートシェイプオブジェクトの一群があり 1つ1つには想定される名称が存在します 具体的な操作としては複数のオートシェイプオブジェクトを横に並べたイメージダイアグラムを 作成し、それらにそって対応するテキストを配置していきたいというものです このようなオートシェイプの情報をうまく拾う方法、テキストデータと紐づける方法はありませんでしょうか よろしくお願いいたします
コールセンター勤務のExcelマクロ初心者です。 時間帯ごとの迷惑電話リストデータを作成するにあたり、オペレーター約100名から数ヶ月間情報を徴収しようと思っています。 受信業務の妨げにならないよう、簡単に操作できるExcelでのマクロを作成し、そのExcelを100名に配信する予定です。 オペレーターがマクロボタンを操作したら集計用Excelが開いてデータが集まる、というイメージです。（以降便宜上オペレーターが操作するExcelを子Excel、集計用Excelを親Excelと表記） 迷惑電話業者リストは既に手元にあり、「何時何分に電話が掛かってきているのか」のデータが欲しいのです。 【親Excelイメージ】 a列・・・業者名 b列・・・業者電話番号 c列・・・掛かってきた時刻 1ヶ月あたりの累積で約500件（500行）ほどのデータを収集見込みです。 【子Excelイメージ】 a列・・・業者名 b列・・・業者電話番号 c列・・・時刻（関数now） そしてd列にボタンを配置させ、行数（業者数）は10行程度になります。迷惑電話が掛かってきたら、該当行のボタンを押してもらう形です。 ここで質問です。 子Excelのセルd1にあるボタンをクリックすると、セルa1～c1をコピーし、親Excelを開いて最終行を探し、値のみを貼り付けて保存して親Excelを閉じる、というところまでのマクロは作れます。困っているのが、複数のオペレーターが同時刻に操作してしまった場合のバッティングです。 例えばオペレーターAが親Excelを開いていた場合に、オペレーターBは親Excelが閉じられるのを待ってから貼り付けにいく、という感じにしたいのです。 若しくは、親Excelをブックの共有としたときに、全く同時刻にオペレーターAとオペレーターBが最終行を探しにいってもエラーにならないようにしたいのです。 どちらの方法でも構いませんので、どなたかご教授頂けると幸いです。オペレーターは100名ほどおりますので、2名同時操作どころか3名同時操作もあり得ます。これ以外にも懸念される事項があれば教えてください。
お世話になっております。 現在、Excel2007でCSVファイルを取り込むVBAで作成しています。 下記のURLを参考にしています。 http://www.asahi-net.or.jp/~ef2o-inue/vba_o/sub05_110_030.html エラー処理について皆さんにお聞きしたい事があり、投稿させていただきました。 ダイアログでファイルを選択した際にエラーが発生した場合、どのようにエラー処理をしたらいいのでしょうか。 できれば Do Until objTS.AtEndOfStream ※この中で・・・ Loop 現在は下記のように記述していますがうまく処理できません。 正常でもエラーでもエラー扱いされてしまいます。 　Do Until objTS.AtEndOfStream 　　On Error GoTo ErrHandler ErrHandler: 　　MsgBox "エラーが発生しました。Excelを強制終了します。", vbOKOnly + vbCritical, "終了" 　　Application.Quit 　　Windows("ファイル名").Close True 　Loop すみませんがどうかアドバイス宜しくお願いします。 では失礼します。
Excel2007でCSVファイルを取り込むVBAで作成しています。 下記のURLを参考にしています。 http://www.asahi-net.or.jp/~ef2o-inue/vba_o/sub05_110_030.html 皆さんにお聞きしたい事があり、投稿させていただきました。 CSVファイルの先頭行にタイトル行が指定されている場合、VBA上で除外する事は可能でしょうか。 できれば Do Until objTS.AtEndOfStream ※この中で・・・ Loop すみませんがどうかアドバイス宜しくお願いします。 では失礼します。
勉強させてください。 ｖｂ2010.net win764bit FTPサーバーにアクセスし、FTPサーバーにあるCSVファイルをすべて 指定のフォルダにコピーしたいのです。 http://dobon.net/vb/dotnet/internet/ftpwebrequest.html#downloadfile を参考に作成しましたがうまくいきません。 1, Cドライブにコピーしたいのですが下記部分でアクセスに拒否されましたと 　エラーが発生します。 　Dim fs As New System.IO.FileStream( _ downFile, System.IO.FileMode.Create, System.IO.FileAccess.Write) 　フォルダの設定をPrivate Const PATH_Folder = " C:\DATA"から 　Private Const PATH_Folder = " \DATA"に変更するとサーバー上にアクセス（ファイルの書き込み） 　が行われます。（プログラムの保存先が影響？） 　指定したローカルにコピーするにはどうしららよいでしょうか。 2,1でサーバー上にファイルの書き込みができたのですが、FTPサーバーにあるCSVのデータの内容を 　書くみたいでコピーできませんでした。 　fs.Write(buffer, 0, readSize)をfs.CopyTo()に変更すればいいのではないかとおもい変更してみましたが、 　fs.CopyTo(ここがわからない)が理解できずに動作しません。 アドバイスよろしくお願いいたします。 Imports System.Net Imports System.IO Module Module1 'FTP用host Private Const FTP_HOST = "ftp://TEST" 'FTP用USER Private Const FTP_USER = "ftpuser" 'FTP用PASSWORD Private Const FTP_PASS = "ftppass" 'FTPファイルコピー先フォルダ Private Const PATH_Folder = " C:\DATA" Private Function FTPDownLoad() As Boolean FTPDownLoad = False 'Try 'ダウンロードするファイルのURI Dim u As New Uri(FTP_HOST) 'ダウンロードしたファイルの保存先 Dim downFile As String = PATH_Folde Sub Main() '----------------------------- '-- FTP データ取得 '----------------------------- If FTPDownLoad() = False Then body = "FTPからのデータダウンロードに失敗しました。" + vbCrLf + sys_date & sys_time Exit Sub End If Private Function FTPDownLoad() As Boolean FTPDownLoad = False 'Try 'ダウンロードするファイルのURI Dim u As New Uri(FTP_HOST) 'ダウンロードしたファイルの保存先 Dim downFile As String = Palet_PATH_Folder 'FtpWebRequestの作成 Dim ftpReq As System.Net.FtpWebRequest = _ CType(System.Net.WebRequest.Create(u), System.Net.FtpWebRequest) 'ログインユーザー名とパスワードを設定 ftpReq.Credentials = New System.Net.NetworkCredential(FTP_USER, FTP_PASS) 'MethodにWebRequestMethods.Ftp.DownloadFile("RETR")を設定 'ftpReq.Method = System.Net.WebRequestMethods.Ftp.DownloadFile ftpReq.Method = System.Net.WebRequestMethods.Ftp.ListDirectoryDetails '要求の完了後に接続を閉じる ftpReq.KeepAlive = False 'ASCIIモードで転送する ftpReq.UseBinary = False 'PASSIVEモードを無効にする ftpReq.UsePassive = False 'FtpWebResponseを取得 Dim ftpRes As System.Net.FtpWebResponse = _ CType(ftpReq.GetResponse(), System.Net.FtpWebResponse) 'ファイルをダウンロードするためのStreamを取得 Dim resStrm As System.IO.Stream = ftpRes.GetResponseStream() 'ダウンロードしたファイルを書き込むためのFileStreamを作成 Dim fs As New System.IO.FileStream( _ downFile, System.IO.FileMode.Create, System.IO.FileAccess.Write) 'ダウンロードしたデータを書き込む Dim buffer(1023) As Byte While True Dim readSize As Integer = resStrm.Read(buffer, 0, buffer.Length) If readSize = 0 Then Exit While End If fs.Write(buffer, 0, readSize) End While fs.Close() resStrm.Close() 'FTPサーバーから送信されたステータスを表示 Console.WriteLine("{0}: {1}", ftpRes.StatusCode, ftpRes.StatusDescription) '閉じる ftpRes.Close() 'Catch ex As Exception ' MsgBox(ex.Message) ' Exit Function 'End Try FTPDownLoad = True End Function END sub
ユーザーフォームを作ったのですが、 いくつかあるテキストボックスを enterを押すことで 上から下に順番に移っていくことはできますか？？ その方法が知りたいです！ よろしくお願いします<(_ _)>
こんばんは VBをせこせこ書いているのですが、躓いて分からないところがあります。 たとえば、その日の Day が 15日よりも前か後かを判定するにはどうすればよいのでしょうか？ 日付を比較したり足したり引いたりする関数はわかるのですが、日数を比較する方法がわかりません。 例えば、今日は6月11日です。11日は15日より前なのでTrue、このプログラムをを6月16日の時点で実行するとFalseが返るといった具合です。特定の年・月とは無関係で、日だけをチェックしたいと考えています。 どのように記述したらよいでしょうか？教えてください。
Private Sub Worksheet_Activate() Dim wsData As Worksheet Dim number As Variant Const SH_DATA As String = "データ入力" Set wsData = Worksheets(SH_DATA) On Error Resume Next If wsData.Range("G3") = "" Then number = InputBox("個人番号を入力してください") If number Is Nothing Then Exit Sub Else wsData.Range("G3") = number MsgBox "性別を選択してボタン(1)を押してください" End If End If End Sub このコードの If number Is Nothing Then のところがうまく動きません、、、 カーソルをnumberに持っていくと値はきちんとはいっています！ なのに何回やっても Exit Sub に飛んでしまいます(-_-;) どなたかよろしくお願いします(__)
Sub clear() Dim wskyu As Worksheet Dim wsData As Worksheet Dim Y As Range Const SH_KYUYO As String = "給与明細" Const SH_DATA As String = "データ入力" Set wskyu = Worksheets(SH_KYUYO) Set wsData = Worksheets(SH_DATA) With wsData For Each Y In .Range("C3:G55") If Y.Interior.ColorIndex <> xlNone Then Y.ClearContents End If Next End With With wskyu Range ("P7:AQ7"), .Range("D10:AQ10"), .Range("D13:AQ13"), _ .Range("D17:AQ17"), .Range("D20:AQ20"), .Range("D24:AQ24"), _ .Range("D29:AI29").Select Selection.SpecialCells(xlCellTypeConstants, 23).Select Selection.ClearContents End With MsgBox "個人番号を入力後、性別を選択しボタン(1)を押してください" End Sub 値のみ削除しようと上のコードを書いたのですが With wskyu のあとの Range～ でプロパティの使い方が不正です と言われてしまいました(-_-;) ヘルプボタンがあったので押しても空のページに飛んでしまい どうすればよいのかわかりません、、、 どうかよろしくおねがいします！！
Visual Basic 2010を勉強しています。 フォームに貼り付けたコントロールのプロパティの設定についてですが、 今までは、貼り付けた後にプロパティウインドウで直接いじっていました。 (Text、Font、Imageなど...) ですが、知人が書いたコードを見ていると、コードの中で設定しているようなのです。 プロパティウインドウで設定した方が、視覚的にも確認しながら設定できるのでそうしていたのですが、コード内で設定するのと違いはあるのでしょうか？(パフォーマンスやコードの見やすさなど...) 動的にコントロールを配置したい時や、プロパティを変更したい場合にはコード内で操作しますが、初期設定やラベル等の変更することがないようなコントロールに関しては、どちらでも同じような気がするのですが... 実際に皆さんがどうされているのかも気になり、質問させて頂きました。 以上、何卒よろしくお願いいたします。
ファイルを探すプログラムをネット頂き　テストしたのですが c:\ のみ　動かず　c:\*** は　そのフォルダーから下を探します e:\ は　全てのフォルダーを探します。 ＷＩＮ８　ですが　どこで間違ってるのでしょうか？ よろしくどうぞ Option Explicit Private g_dteDate As Date Private g_strEXT As String '参照設定　M-Scripting.Runtime Cells(1, 2).Value　に　探すアドレス　記載　c:\ 　e:\ 　c:\*** など Sub Sample_FileSearch2() 　　Dim vntF As Variant Dim objFSO As FileSystemObject Dim dteDate As Date Dim GYO As Long Dim cntFound As Long Set objFSO = New FileSystemObject ' FSO Rows("5:65536").ClearContents GYO = 4 ’ g_dteDate = DateAdd("m", Cells(3, 2).Value * -1, Date)　更新　不要 g_strEXT = UCase(Trim(Cells(2, 2).Value)) ' ルートフォルダから探索開始 Call Sample_FileSearch2_SUB(objFSO, _ objFSO.GetFolder(Trim(Cells(1, 2).Value)), GYO, cntFound) Set objFSO = Nothing ' 処理結果の表示 If cntFound = 0 Then MsgBox "見つかりません" Else MsgBox cntFound & "個見つかりました" End If End Sub '''******************************************************************************* ''' ファイル探索処理(再帰動作) '''******************************************************************************* Private Sub Sample_FileSearch2_SUB(objFSO As FileSystemObject, _ ByVal objFolder As Folder, _ GYO As Long, cntFound As Long) Dim objFolder2 As Folder Dim objFile As File ' サブフォルダの探索 For Each objFolder2 In objFolder.SubFolders ' サブフォルダ個々の探索(再帰動作) Call Sample_FileSearch2_SUB(objFSO, objFolder2, GYO, cntFound) Next objFolder2 ' このフォルダ内のファイルの探索 For Each objFile In objFolder.Files ' ここから条件判断 With objFile If (UCase(objFSO.GetBaseName(.Path)) = g_strEXT) Then GYO = GYO + 1 Cells(GYO, 1).Value = .Name Cells(GYO, 2).Value = .DateLastModified Cells(GYO, 3).Value = _ Left(.Path, Len(.Path) - Len(.Name) - 1) cntFound = cntFound + 1 End If End With Next objFile End Sub
お世話になります。 [環境] VS2005 VB.net VB.netのISDATE関数を使い日付のチェックをしています。 端末により結果が違っていて困っています。 端末Ａ：ISDATE(昭和５０/10/01)・・・True 端末B：ISDATE(昭和５０/10/01)・・・False インターネットで調べるISDATE関数は環境により結果が違う為、 ISDATE関数は使用するなと書かれていました。 環境とはどのような環境なのでしょうか？ 今後はISDATE関数は使わないようにしようと思いますが、 たちまちは既存プログラムが正常に動かすようにしたいと思っております。 どなたか設定で回避できる方法をご存じの方がいらっしゃいましたら ご教授いただければと思います。
困りました、、 Findを使って検索しようとしていて、 検索する値に変数を使っているのですが （変数は文字列） 検索するものがたくさんあり、 ひとつの項目ごとにFindを書くのがとても面倒です 調べてみても数字を増やしていく方法しか見つからず どうすればいいのか分からなくなりました^^; どうにかひとつのFindで１０個ほどある項目を順番に検索していく方法が ありましたらお願いします(__)
複数選択でのファイルの配列取り込みは下記でおこなえましたが、 tmp = Application.GetOpenFilename(, , "処理したいファイルを複数選択してください", , True) For Z = LBound(tmp) To UBound(tmp) 同じような感じの事をフォルダでしたいのですが・・・ ネットや本を探してみましたが、見当たりません・・・ 具体的には複数選択したフォルダ（年月の名前が付いたフォルダ）が複数個あり そのフォルダ内に約７００個づつファイルがります フォルダは年月の名前が付くフォルダなので１年分だと１２フォルダ、２年分だと２４フォルダになり名前も変わります（２０１４０３、２０１４０４、２０１４０５、・・・・） ファイルはフォルダの１分毎のデータになりますので名前が変わり、数も多いです。１フォルダ分（１ヶ月なら２４時間×２８～３１日でだいたい７００ファイルくらい）なので過去分も含めると月数が増えると手ではちょっとキツイです。 ３か月分を処理するとして フォルダ２０１４０３、２０１４０４、２０１４０５を複数選択し 　フォルダ２０１４０３の 　ファイル２０１４０３０１０００１→２０１４０３０１０００２→２０１４０３０１０００３・・・　２０１４０３３１２３５９ 　フォルダ２０１４０４の 　ファイル２０１４０４０１０００１→２０１４０４０１０００２→２０１４０４０１０００３・・・２０１４０４３０２３５９　　フォルダ２０１４０５の 　ファイル２０１４０５０１０００１→２０１４０５０１０００２→２０１４０５０１０００３・・・２０１４０５３１２３５９ まで順次ファイルを開いてセルのデータを１ヶ月分毎に収集したいのですが 月数が増えると手ではちょっとキツイので複数フォルダを選択するとフォルダとファイルを配列に取り込み 対象Folders = 複数選択したフォルダの配列 For Z = LBound(対象Folders) To UBound(対象Folders) 　　　　対象fileｓ = 複数選択したファルダ内のファイルの配列 　　　　　For Y = LBound(対象fileｓ) To UBound(対象fileｓ) 　　　　　　　　　　ファイルを開いてデータ収集 　　　　 Next Next 上記のようなイメージの処理をしたいのですが ご存知の方ご教示いただけると幸いです。 よろしくお願いいたします。 ＯＳはＷindows7、エクセルは2010です。
Visual Basic 2010　×　SQLite　を使ったアプリケーション開発の勉強をしています。 そこで、ふと思ったのですが、データベースの値を参照する時に、 一々データベースへの接続処理をしなくても、 「DataAdapter」 の 「Fill」 メソッドだけを使えばいいのではないかと... 皆様のご意見を伺いたく質問させて頂きました。 具体的には、 SQLiteDataAdapter (System.Data.SQLiteライブラリ) のFillメソッドは、 データベースへのコネクションが確立されていなければ接続し、 データベースの値をデータセットに格納し、Closeする。 (コネクションがあればそれを使い、Closeしない) 上記のことから、常に DataAdapter の Fill だけを使っていれば、 一々、Open→Close しなくてもいいのではないかと思ったのです。 アプリケーションやデータベース等の規模や使い方にもよると思うので、 簡単に結論が出るような話ではないと思いますが、 ごく簡単なアプリケーションで、小規模なデータベースをちょっと参照するくらいなら、 上記でもいいのでは？ 皆様がどう使い分けているかお伺いできれば幸いです。 それとも、「使い分けもなにも、Open → Close しないなんてバカなことはしないよっ！」 と笑われて終わりという話でしょうか...＾＾； 何卒よろしくお願いいたします。
HLOOKUPを使ってある文字列を探し、その値がある行番号を知りたいのですが どうすればよいのでしょうか？？ findを使えばいいのかもしれませんがfindはあまり良くないという意見を多く聞くので どうにかLOOKUPで行こうと思っています みなさんよろしくお願いします(__)
VBAを勉強し始めた者です。 下記、やりたい処理があるのですがやり方が分からないのでアドバイス頂ければと思います。 よろしくお願いします。 　　　　A　　　　　　　B　　　　　　　C　　　　　　　D　　　　　　　E　　　　　　　F １　発注単位　１月末在庫　２月使用数　２月注文数　２月末在庫　安全在庫 ２　　　50　　　　　　500　　　　　　400　　　　　　　　　　 　=B2-C2+D2　　301 ３ ある品種について２月末時点で３０１以上の在庫を持ちたい場合、 いくつ注文するか（D2セルに入る数値）を求める方法を教えてください。 ただし、注文する数は発注単位（５０）の倍数とします。 上記は１品種ですが、縦に色々な条件の品種が並んでいると想定してください。 自分のイメージはE2セルが３０１未満なら５０買う、５０買っても３０１未満なら さらに５０買う、３０１を超えたら終了するというイメージです。 今回の場合、２５０買うという結論を導きたいです。 もっと簡単な方法があればそれでもかまいません。
VB6でデバッグする時にカーソルのある行まで簡単にスキップすることは出来ますでしょうか? 右クリックで[カーソルの直前まで実行]というのはあったのですが、 カーソルの直前まで実行せずにスキップしたいのですが。
dim a as string dim b as string dim c as string dim d as string dim e as string dim f as string dim g as string dim h as string dim i as string a = "○○" b = "○○" c = "○○" d = "○○" e = "○○" f = "○○" g = "○○" h = "○○" i = "○○" 上記のような形でたくさん宣言しているのですが、 実際はもっとあり、これだととても長いコードになってしまいます(・・;) なんとか簡略化したいとは考えたのですがよい方法が見つからず 皆さんよろしくお願いいたします_(_^_)_
VBAど初心者です。どうしても最終行のデータを選んだシートにコピーできません。 LastRow.Selectのところで、止まってしまいます。どのように行を設定していいのかさっぱりわかりません。どなたか、ご指導のほどよろしくお願いします。 Sub copy_last_line() Dim LastRow As Long Sheets("Sheet1").Select LastRow = Cells(Rows.Count, 1).End(xlUp).Row LastRow.Select Selection.Copy Sheets("Sheet2").Select Range("A1").Select ActiveSheet.Paste Sheets("Sheet1").Select Range("A1").Select End Sub
コードの書き方が分からないのですが、 一つもともとあるｅｘｃｅｌファイル（ｆｉｌｅ１）にマクロを保存しておいて それを使うときに新しく必要な情報が入った上のとは別のｅｘｃｅｌファイル（ｆｉｌｅ２）を作ります そしてｆｉｌｅ１を開いた状態でｆｉｌｅ２から値を参照するにはどうすればよいのでしょうか？ つまり今ｆｉｌｅ２はありません しかしｆｉｌｅ２を作りそこから参照したいときににコードをさわらなくてもいいように書きたいのです file２は毎回同じように作るので値は変わっても場所は毎回同じセルに入ります 説明が下手で質問が分かりづらいとは思うのですがどうかよろしくお願いいたしますm(__)m
FileSystemObjectでファイルをコピーしたく、下記のようなコードを書きました。 SYSFILEはファイル名です。（拡張子なし） ******************************************************* Dim objFileSys SYSFILE Set objFileSys = CreateObject("Scripting.FileSystemObject") objFileSys.CopyFile("C:\TEST\", "C:\REAL\SYSFILE") C:\REAL\SYSFILE"を編集して"C:\REAL\SYSFILE_NEW"を作成（コード省略） SYSFILE_NEWを読み込んで最終行の番号を取得（コード省略） ’取得した番号にリネームコピー objFileSys.CopyFile("C:\REAL\SYSFILE_NEW", "C:\REAL\XXX")←★　 ******************************************************* ★のCopyFileで「ファイルが見つかりません」のエラーになります。 "C:\REAL\SYSFILE_NEW"は確実に作成されて存在しますが発生します。 おかしいと思って直前にFileExistsをしてもFalseになります。 エクスプローラー上では確かに存在するし、コピーもできます。 実際はファイル名の箇所は変数名なので中身を確認しようと★の直前行で echoで出力してみたが、変数の中身も問題ありませんでした。 おかしいのがその後です。 今度はエラーにならずに処理が通りました。 直前にechoでダイアログを表示させた場合にはエラーが発生しません。 その記述を削除するとまた発生します。 考えられる原因を教えていただきたいです…
困りました、 下は一部ですがこのような表から 　　B　　　　　E　　　　H 135,417　149,999　A×40% 150,000　299,999　A×30%+15000 300,000　549,999　A×20%+45000 550,000　833,333　A×10%+100000 833,334　1,249,999　A×5%+141667 If a < .Range("E8") Then kyu = .Range("H8") ElseIf a > .Range("B14") Then kyu = .Range("H14") Else H = Application.WorksheetFunction.VLookup(a, .Range("B9:J13"), 3) H = Replace(H, "Ａ", a) H = Replace(H, "×", "*") kyu = Evaluate(H) End If このコードを実行すると 最後のところでkyuに計算後の値が入る予定なのですが エラーも起きず なぜか何も入りません(・_・;) 原因がよくわからないので どなたかよろしくお願いいします！！
困りました、、、 ＶＢＡを使って A×30%+15000 これが入ったセルＢ２と たとえば250000が入ったセルＢ２を掛け算したいのですが （Ｂ2の数字は固定ではなくいろいろな数字が入ります） 文字列が入っていることにより うまくいきません 今は仕方なくＭｉｄ関数で数字を抜き出して使っているのですが なにかよい方法はないでしょうか よろしくお願いします<m(__)m>
困りました、、 下のような表から検索したいのですが うまく取り出せません ～63,000 63,000～73,000 73,000～83,000 83,000～93,000 93,000～101,000 101,000～107,000 107,000～114,000 114,000～122,000 122,000～130,000 130,000～138,000 138,000～146,000 146,000～155,000 155,000～165,000 165,000～175,000 175,000～185,000 185,000～195,000 195,000～210,000 210,000～230,000 230,000～250,000 250,000～270,000 270,000～290,000 たとえばこの中から225000が当てはまるところを探したいのです 今はselect caseで一つずつ判定しているのですが これではコードが果てしなく長くなってしまいます もっとスマートなコードはないのでしょうか？？ よろしくお願いします<m(__)m>
マクロ初心者です。 文字を検索する列の範囲はD~Fとし、検索開始セルはDとします。 検索結果を表示するセルの先頭セルはAとし、A～Cに結果を表示させます。 もしD2に文字があった場合、A１に”１”を表示させます。 E３に文字があった場合は、A３に”１”を、B３に”１”を表示。 E５に文字があった場合、E列に文字が入ったのが２回目となる為、A５に”１”を、B５に”２”と表示。 上記のように、それぞれの列に何個文字があったのかカウントしていくマクロを作成したいのですが、作成できずに困っています。 よろしくお願いします。
