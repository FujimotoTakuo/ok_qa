お世話になります。 データベースのシーケンスによるシリアル型について質問があります。 例えば下記のような商品テーブルがあるとします。 ・商品コード ・商品名 ・価格 ・備考 ※商品コードは重複しない値(一意)を格納。 このようなマスタを作成する際にシーケンスによるシリアル型による自動採番のフィールドを指定した方がいいのでしょうか。またシーケンスによるシリアル型をどのような場合に使うのが一般的なのでしょうか。 大変、お手数をお掛けしますが説明していただけませんでしょうか。 くだらない質問ですみませんが宜しくお願いします。
VB.NETとPostgreSQLで社内システムを作っています。 更新クエリを実行すると15秒くらいでタイムアウトしてしまいます。 （エラーコードはメモを持ち帰るのを忘れたため覚えておりません…が、割と急いでいるので質問させて頂いてます） Statement_Timeoutはいじっておらず、値は0のままです。 プロバイダはnpgsqlです。 タイムアウトしないようにするにはどうすればいいでしょうか。 アドバイスお願いいたします。
現在、保守対応を行っているシステムにて、 不明点があり、皆様にご助言を頂ければ幸いで御座います。 ■使用環境 "PostgreSQL 8.1.23 on i686-redhat-linux-gnu, compiled by GCC gcc (GCC) 4.1.2 20080704 (Red Hat 4.1.2-51)" ■現状 update tbl_result_interview set {割愛} where ｛割愛｝ を実行すると mst_exam_resultというテーブルも更新がされます。 恐らくトリガーが引かれているのかと考えているのですが、 実態が確認出来ず苦慮しております。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ \d+ tbl_result_interview Column | Type | Modifiers | Description --------------+-----------------------------+-------------- {割愛} Indexes: "tbl_result_interview_pkey" PRIMARY KEY, btree (app_id) Foreign-key constraints: "tbl_result_interview_app_id_fkey" FOREIGN KEY (app_id) REFERENCES tbl_app_exam(app_id) Has OIDs: no ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ \d+ mst_exam_result Column | Type | Modifiers | Description --------+------------------------+-----------+----------------------------------------- {割愛} Indexes: "mst_exam_result_pkey" PRIMARY KEY, btree (code) Has OIDs: no ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ ちなみにpgadminで確認しても、トリガ関数(0)と出ており、 トリガはなさそうです。 関数は数個ありますがmst_exam_resultに更新処理を行う様な記述は見れません。 update tbl_result_interview set {割愛} where ｛割愛｝により、 mst_exam_resultが更新されるのですが、 実態がわからず、確認項目でも構いませんので、 ご助言、ご指摘頂ければ幸いで御座います。 以上、引き続き宜しくお願い致します。
postgresqlを使用してます。 既存をリプレイスしたく、 VMでバージョンを上げて試してます。 引き継いだ案件で今までほっておいたのですが、 設定がわからず、確認箇所があれば、 ご教示頂きたいです。 □既存 (1)あるユーザでサーバにログインします。 (2)psqlのみでDBに接続します。 ここで、伺いたいのですが、 psqlのみの場合、ログインに(1)のあるユーザが適用されるかと考えてましたが、 実態は別のユーザー。 ※ちなみに-Uで別のユーザーを指定してみましたが同じ挙動です。 お伺いしたい事は以下です。その下は補足です。 「-U省略と別ユーザを紐づけている箇所がわかりません。思い当たる箇所があればご教示頂きたいです。」 ~/.pgpassに設定があったので、それかと考えもしましたが、 この設定はパスワードを省略出来る??と記載があり、ユーザー名までは違う? 新しくVMで作った方に入れてみても、[psql]のみではユーザー名は変更出来ませんでした。 psqlのみの時、-Uがどこか連携する箇所あればご教示頂きたいです。 どうして別ユーザーで入れるのかわからずとん挫しております故、 何卒宜しくお願い致します。
PL/pgSQLのことで教えてください。 これまで SQL Server を使っていましたが、PostgreSQL に移行しています。 Npgsql で、VB.Net から接続しようと思っています。 PL/pgSQLで、ストアドファンクションなどを定義するのではなく、PL/pgSQLスクリプトを 直接実行することはできないのでしょうか？ SQL Server では、T-SQLのスクリプトを直接実行できました。 例えば ManagementStudioのクエリ実行画面にスクリプトを入力して実行したり、 VBからだと、SqlCommand の CommandText に T-SQLを書いて実行したり、という ことです。 pgAdminIIIのSQLエディタや、NpgsqlのNpgsqlCommandで同様のことをやろうとすると エラーになります。 何か良い方法があるのでしょうか？
postgresqlのbit型のselectについて質問です。 例えば、各個人のアンケートの回答なりのデータがbit型で格納されている場合に | user | data | ------------------------- | A | 0100011100 | ------------------------- | B | 0111011101 | ------------------------- | C | 1101011101 | ------------------------- | D | 0101011100 | ------------------------- | E | 0111011100 | ------------------------- (1)１番左を１番目の質問として、１番目の回答に１がついている人数（上記の場合は１人） (2)３番目の質問に１がついているuser（上記の場合はBとE） 以上の２点について、うまくselect出来る方法がありましたらご教授いただきたいです。
postgresqlで、「WARNING　 進行中のトランザクションがありません」のエラーが出てしまいました。 これはそのままの意味だと思うのですが 直す方法がわかりません。 ワーニングなので、、、といいたいところですが、そうもいかず。 apのログで、トランザクション関係の辺りを見ましたところ、 トランザクションを開始し、 TABLEをDROPしようとしましたが、存在しなかった（ようだ）。 （PQexecがエラーでリターン） 存在しないけれど、commit　してトランザクションを終わらせている。 のが原因かなと思いました。 なので、PQexec()がエラーの場合はcommitしなければいいのかと はずしましたが結果は同じでした。 トランザクションが無いのだからrollbackもいらないですよね。 そこで質問ですが drop文、１ステップのSQL実行も明示的にトランザクションの処理をしたほうがいいのでしょうか？ このワーニングは通常のトランザクションの処理の中で、どういう時にでるのでしょうか？ oracleとpostgresqlの明示的・暗黙的な制御に戸惑っています。 （oracleからpostgresqlに移行することになりました） 叱咤でも何でもかまいませんので、アドバイスよろしくお願いいたします。
例えば単純化して 出席番号と点数と登録時刻を登録すようなテーブルにて seiseki table bangou int //出席番号 tensu int //点数 instime timestamp//登録時刻 出席番号1番の人が20 点 25点 40点という成績を順にとって 1 20 2014-01-04 1 40 2014-03-20 1 25 2014-05-11 とレコードがあった場合　一番点数がよいレコードの登録期日を求めるにはどうやったらよいでしょか・・・
複数のテーブルから登録順にデータ取得なんてことできるのでしょうか？ table_A A_id int A_time timestamp A_title　text table_B B_id int B_time timestamp B_title text とtable_A　table_Bにデータが存在するときに AB関係なく　A_titleもしくはB_title　を登録順のA_timeもしくはB_time 順に10個とかSQL一発でかけるのでしょうか？ そもそもこのような作りにするな！ということでしょうが・・・
よろしくお願いいたします。 PostgrSQLでPosGIS対応にし、テーブルにGeomカラムを作り、そこにPoint型で地理情報をインサートしました。 次に、特定の範囲に、何件Geomカラムの位置が入っているのかを調べようと思い、次のようなSQLを書きました。 SELECT * FROM hogetable WHERE ST_Within(geom, ST_GeomFromText('POLYGON((10 10, 10 20, 20 20, 20 10))',4326)); これを実行すると、POLYGONのところが、パースエラーになります。どこがおかしかったのでしょうか？ Postgresqlは、あまり触ったことがないので、変なことを書いてしまっていたらごめんなさい。 環境は、CentOS6.3 64bit Postgresql9.3 Postgis2.1です。 よろしくお願いいたします。
くだらない質問で申し訳ありませんが宜しくお願いします。 下記のようなデータを格納するテーブルを構築しています。 ・ユーザーID ・名前 ・カタカナ ・パスワード ・年齢 ・郵便番号 ・住所１ ・住所２ ・住所３ ・電話番号 ・メールアドレス ・備考 ・削除フラグ ・登録者 ・登録日 ・更新者 ・更新日 上記の内容を下記のようなテーブルのフィールドのデータ型を考えました。 ・ユーザーIDのデータ型をVARCHAR(4) ・名前のデータ型をVARCHAR(32) ・カタカナのデータ型をVARCHAR(32) ・パスワードのデータ型をVARCHAR(255) ・年齢のデータ型をINTEGER ・郵便番号のデータ型をVARCHAR(8) ・住所１のデータ型をVARCHAR(255) ・住所２のデータ型をVARCHAR(255) ・住所３のデータ型をVARCHAR(255) ・電話番号のデータ型をVARCHAR(18) ・メールアドレスのデータ型をVARCHAR(255) ・備考のデータ型をTEXT ・削除フラグのデータ型をVARCHAR(1) ・登録者のデータ型をVARCHAR(4) ・登録日のデータ型をTIMESTAMP ・更新者のデータ型をVARCHAR(4) ・更新日のデータ型をTIMESTAMP そうしたら下記のような風にテーブルのフィールドのデータ型にしたら格納する文字列の桁エラーが起こらないからどうといわれました。 ・ユーザーIDのデータ型をVARCHAR(4) ・名前のデータ型をTEXT ・カタカナのデータ型をTEXT ・パスワードのデータ型をTEXT ・年齢のデータ型をTEXT ・郵便番号のデータ型をTEXT ・住所１のデータ型をTEXT ・住所２のデータ型をTEXT ・住所３のデータ型をTEXT ・電話番号のデータ型をTEXT ・メールアドレスのデータ型をTEXT ・備考のデータ型をTEXT ・削除フラグのデータ型をVARCHAR(1) ・登録者のデータ型をVARCHAR(4) ・登録日のデータ型をTIMESTAMP ・更新者のデータ型をVARCHAR(4) ・更新日のデータ型をTIMESTAMP ※現在、使用しているデータベースはPostgreSQLですが、Microsoft　SQL ServerやOracleやMySQL等の他のデータベースでもいいものなのかもご教授いただけると助かります。 私の知識不足でどちらがいいのかがわからず投稿させてもらいました。 申し訳ありませんが皆さんのお知恵をお貸し下さい。 宜しくお願いします。
PostgreSQLを使用しております。 バージョンは9.1です。 日本語の検索を行いたいので、create index ・・・を使用してインデックスを作成し select * from hoge where item like '%ほげ%'; といった形で検索をかけてみました。 正常？に検索でき結果が出力されました。 いろいろネットを調べてみると、PostgreSQLで日本語の検索をやるにはpg_trgmやpg_bigmを インストールしないとダメなようなことが書いてあるのですが、私がやったことは誤っているのでしょうか？ やはりpg_trgmなどをインストールしなければ日本語の検索はできないのでしょうか？ 詳しい方教えてください。
どうしても分からないので教えてください。 先人の書いたphpの記述を解析しています。 postgreSQLとやり取りしている部分に、次のようなselect文の記述があります。 select lpad(seq_no,shiyo_keta,'0'),seq_min,seq_max from seqno_info where seq_key='YAMATODENPYO'; 実行すると次のようなエラーがでます。 ERROR: 関数lpad(bigint, smallint, unknown)は存在しません 茵 1: select lpad(seq_no,shiyo_keta,'0'),seq_min,seq_max from seqn... （lpadのあたりに印が付いていましたが、ここではずれるので消してあります。） HINT: 指定名称、指定引数型に合う関数がありません。明示的な型キャストが必要かも しれません テーブルの型は次のようになっています。 \d seqno_info Table "public.seqno_info" Column | Type | Modifiers ------------+----------+----------- seq_key | text | not null seq_no | bigint | seq_min | bigint | seq_max | bigint | shiyo_keta | smallint | 以下がそれぞれに入っているデータです。 select seq_no from seqno_info; seq_no -------- 999 (1 row) select shiyo_keta from seqno_info; shiyo_keta ------------ 3 (1 row) 調べても有力な情報が見当たらず困っています。 どなたか、ご教示ください。
以下のようなテーブルがあったとします。 select * from T1; +------------+------+ | date | num | +------------+------+ | 2014-01-01 | 1 | | 2014-01-02 | 2 | | 2014-01-03 | 2 | | 2014-01-05 | 1 | | 2014-01-07 | 1 | +------------+------+ このとき、「各日付を起点として、その日を含む過去3日分の合計num数を出力」させるためにはどのようなSQLを書けばいいのでしょうか。 以下のような結果が返ってくることを期待しています。 | date | sum_num | +------------+------+ | 2014-01-01 | 1 | | 2014-01-02 | 3 | ※ 1+2 | 2014-01-03 | 5 |　　※ 1+2+2 | 2014-01-05 | 3 |　　※ 2+1 | 2014-01-07 | 2 |　　※ 1+1 +------------+------+ PostgreSQL 8系なのですが、環境の問題でwith recursive句を使うことができません。 相関サブクエリをうまく使って取得する方法は無いでしょうか。 よろしくお願いいたします。
教えてください。 現在、ある人の書いたPHPを解析しています。 その中で、postgreSQLを使ってデータをアップデートしている以下の記述があります。 begin;update goods_belong_cat set belong_cat_1='10002', belong_cat_2='10025', belong_cat_3='10086', belong_cat_4='' ,goods_id='1000402' or goods_id='1000393' or goods_id='1000412' or goods_id='1000232' or goods_id='1000241' or goods_id='1000240' or goods_id='1000840' ;commit work; （一行です。） この記述を実行すると、以下のようなエラーが出ます。 BEGIN ERROR: boolean型への入力構文が無効です: "1000402" 茵 1: ..., belong_cat_3='10086', belong_cat_4='' ,goods_id='1000402' ... 　　　　　　　^ ROLLBACK どこに誤りがあるのか分かりません。 どなたかご教示願えませんでしょうか。 Postgreのバージョンは、psql (PostgreSQL) 8.4.13です。 古いバージョンのPostgreでは正常に動いていました。
以下にある二つのテーブル(coursemaster, opencourses)を結合して 月ごとに講義があるかをo,xで一覧にして[期待結果]の様な表を抽出したいです。 coursemaster テーブル course_id | course_name 1 | 経理講義 2 | 財務講義 3 |　 簿記講義 4 | 税理講義 opencoursesテーブル 　　month course_id 200706 | 1　　　 　 200706 | 3 200706 | 4 200707 | 4 200708 | 2 200708　| 4 [期待結果] 　　　　　経理講義　財務講義 　簿記講義 　税理講義 200706　　○　　　　　　×　　　　　○　　　　　　○ 200707　　×　　　　　　×　　　　　×　　　　　　○ 200708　　×　　　　　　○　　　　　×　　　　　　○ 以下の様なSQL文で表を結合してみたのですが 日付の値が重複されてしまい、期待通りの結果になりません。 誰かご教授いただけないでしょうか？ SELECT month AS 開講日 ,CASE WHEN course_name='経理講義' THEN '○' ELSE '×' END AS 経理講義 ,CASE WHEN course_name='財務講義' THEN '○' ELSE '×' END AS 財務講義 ,CASE WHEN course_name='簿記講義' THEN '○' ELSE '×' END AS 簿記講義 ,CASE WHEN course_name='税理講義' THEN '○' ELSE '×' END AS 税理講義 FROM OpenCourses AS OC INNER JOIN CourseMaster AS CM ON OC.course_id = CM.course_id ORDER BY 1 ;
先人の書いたPHPを解析しています。 PostgresSQLとのやり取りをしている記述で、どうしても分からないところがあるので、教えてください。 select count(*) from yamato_order_info yo where yo.maker_system_id in (select mbs.maker_system_id from maker_base_info mbs where mbs.maker_name like '%$_GET[txtSearch]%'); fromでyoとmbsと書かれた部分があります。このデータベースには、そのようなテーブルが無いのですが、これは、Postgresの構文でしょうか？ また、(　の直前のinについてもなんとなくは理解できますが、ネットを調べても出てきません。 古い記述なので、最近のものには対応していないのかもしれません。 どなたかご教示願えませんか。 また、このような場合どのように調べれば良いでしょうか。
すみません、SQLを教えてください。 ID, 名前の2つのフィールドを持つテーブルがあります。 中身は以下のように入っています。 1, AAA 2. AAA 2, BBB 3, CCC 3, AAA 4, DDD 5, EEE, 5, DDD これを、名前のダブリをスキップしながら、 IDの大きな順番に名前を取り出したいのです。 結果は、以下のようになればいいです。 DDD EEE AAA CCC BBB どのようなSQLを組んだら実現できますか？ よろしくお願いいたします。
以下のテーブルの様に時系列が抜けているテーブルから直近2年度連続で減少していない年度を 抽出しようとしています。 /* year|sale --------- 1990|50 1992|50 1993|52 1994|55 1997|55 */ /* CREATE TABLE sales2 (year INTEGER NOT NULL , sale INTEGER NOT NULL , PRIMARY KEY (year)); INSERT INTO sales2 VALUES (1990, 50); INSERT INTO sales2 VALUES (1992, 50); INSERT INTO sales2 VALUES (1993, 52); INSERT INTO sales2 VALUES (1994, 55); INSERT INTO sales2 VALUES (1997, 55); */ 以下の記述で直近の年度までなら表示できているとは思うのですが2年連続となると やり方が思いつきません。誰かご教授いただけないでしょうか？ select year,sale from sales2 s1 where sale >=(select sale from sales2 s2 where s2.year = (select max(year) from sales2 s3 where s1.year > s3.year)) order by year ;
PostgresSQLに詳しい方、教えてください。 現在、私はネットショッピングサイトのサーバ管理をしており、データベースにPostgresSQLを使ってます。 サーバのハードが老朽化してきたため、今までの自社サーバーをやめ、レンタルサーバをかりてそこへサイト移転することになりました。 PHPやHTMLといったソース類は、容易に移転できたのですが、データベースの移転がうまく行かず困っております。 どなたかご教示ください。 ■環境(移転元) サーバ：自社サーバ OS：Linux version 2.4.20-16.9 Postgresバージョン：psql (PostgreSQL) 7.3.4 ■環境(移転先) レンタルサーバ会社：さくらインターネット サービス名：さくらのVPS(v3) 1G OS：Linux version 2.6.32-279.1.1.el6.x86_64 Postgresバージョン：psql (PostgreSQL) 8.4.13 ■現象 移転元のサーバにて、pg_dump -i コマンドを実施。 生成されたダンプファイルをFFFTPにて自分のWindows7のマシンに保存。 Windows7上のエディター(DreamWeaver)でファイルを開くと文字化けしています。 エディターのエンコードをシフトJIS→EUCに変更するとデータベースに入力されている文字列をきちんと見ることができます(一部文字化けは残るのですが。)ので、ここまでは成功しているように思っています。 このダンプファイルをFileZillaにて移転先のサーバにアップロード。 psqlコマンドでリストア。 あらかじめ、移転先のPostgresには移転元のデータベース名と同じものを作成し、ユーザー名も同じものを作成してあります。 ところが、いざselectコマンドを使いデータを検索してもあるはずのデータが出てきません。 テーブルはきちんと作成されているようなのですが。 どうしたらデータをきちんと移転できるのでしょうか？ どなたか、ご教示頂けないでしょうか。
添付の表よりSQLのcase文を使用して2年連続でsaleが上がったyearを求めようと しています。 前年より上がった場合は以下のSQLで表示できたのですが 2年連続に上がった年を表示させようとするとうまく表示できません。 誰かご教授いただけないでしょうか？ select year,sale from sales s1 where sale > (select sale from sales s2 where s2.year = s1.year -1) order by year
Windows7でレジストリよりPostgreSQLのインストール先をバッチで取得しようとしたのですが取得できませんでした。 同じ階層で「文字列値」に空白がない「Version」は取得できるのですが 「Base Directory」になると取得できません。 文字列値に空白がある場合「”～”(ダブルコーテーション）」でくくればいいとあったのですが、駄目でした。 どなたかご存知の方教えてください。 @echo off FOR /F "TOKENS=1,2,*" %%A IN ('REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\PostgreSQL\Installations\postgresql-9.0" /v "Version"') DO IF "%%A"=="Version" SET GET_Version=%%C FOR /F "TOKENS=1,2,*" %%A IN ('REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\PostgreSQL\Installations\postgresql-9.0" /v "Base Directory"') DO IF "%%A"=="Base Directory" SET GET_DIR=%%C echo PostgreSQL Version cho %GET_Version% echo PostgreSQL Directory echo %GET_DIR% pause exit
postgrsqlでバックアップしたプレーンデータがリストアできないトラブルが発生しています。 それはそれで一旦置いておいて、 プレーンデータの中身であるcopyコマンドについて調べています。 copyコマンドの検証の為に簡単なsqlコマンドをpgAdminIIIのSQLエディタで叩いてみました。 create table tb1 ( item1 smallint ,item2 character varying ); copy tb1 (item1, item2) FROM stdin; 1【TAB】aaa 2【TAB】bbb 3【TAB】ccc \. ※ここに投稿するとタブを消されるので、【TAB】と表現しています。 結果は以下です。 ERROR: "1"またはその近辺で構文エラー LINE 10: 1 aaa ^ ********** エラー ********** ERROR: "1"またはその近辺で構文エラー SQLステート:42601 文字:127 これの何がいけないのでしょうか？
PostgreSQLにおいて、テーブルに記録されている行を、例えば１０行ずつ取得したいのですが、どのようなSQL文にしたらよいでしょうか？
皆様 いつもお世話になります。 早速ですがご質問させて頂きます。 Postgresqlを使ったシステム開発の勉強するため、最新版をインストールしようと思っています。 (利用しているPCは中古で購入したものなので)あらかじめ入っていたPostgresqlを アンインストールしようと思ったのですが、方法が分からず困っています。 PCにPostgresqlがあらかじめ入っているかどうかは以下のコマンドで確認しました。 #psql --version psql (PostgreSQL) 9.1.9 contains support for command-line editing とりいそぎGoogleで検索してみたところ、 /Library/PostgreSQL/(Postgresqlのバージョン)/uninstall-postgresql.app にてアンインストールできるらしいのですが、/Libraryディレクトリ以下にPostgreSQLディレクトリがありませんでした。 作業が進まずほとほと困っています。 どなたかお詳しい方ご教授のほど何卒宜しくお願い致します！ 環境： MacOSX 10.8.5 Postgresql9.1.9
PostgreSQＬのＳＱＬで空文字判定する場合 =="" , <> "" , !=""ではなく IS NULLで良いのでしょうか？ IS NULLは、空の場合とnulｌの場合の2つを判定しているのでしょうか
現在、とあるショッピングサイト（データベースはPostgreSQL、OSはLinux）を運営しておりまして、そのサイトの英語版を別のサーバで作ることになりました。 商品数が膨大にありますため、一つ一つの商品をショッピングサイトの管理画面からコピーペーストし翻訳することは、物理的にできません。 そこで、PostgreSQLのデータベースの中身を自分のPC(Windows7)にいったんコピーし、テキストエディターで開き、翻訳した後、CSVによって英語版サーバへアップロードする方法を思いつきました。 pg_dumpによってデータベースをコピーし、FTPによって自分のPCに持ってくることは、できました。 いざ拡張子に.txtと付けてメモ帳で開いてみたところ、添付画像のような文字化けとなってしまいました。 拡張子をhtmlに変更しブラウザのエンコードで、シフトJIS、EUC、UTF-8といろいろ試しましたが、ダメでした。DreamWeaverのような文字コードの変換ができるエディターで全ての文字コードを試しましたが、やはりできません。 添付画像のような文字化けを日本語に直す方法をご存知の方、いらっしゃいませんでしょうか？
PostgreSqlのテーブルをVBから更新 【テーブル】 tbl1 ( item1 integer not null, -- 数値：ユニークキー , item2 character varying, -- 文字 , item3 timestamp without time zone -- タイムスタンプ , CONSTRAINT tbl1pk PRIMARY KEY (item1) ) 【仕様】 １．テーブル内の特定の１レコードを取得 ２．取得したレコードをVBの画面に表示 ３．入力：VBの画面で　item2　の表示内容を変更 ４．ボタン入力 ４－１．レコードが存在しない場合 　メセージボックスに「誰かが消した」と表示 ４－２．タイムスタンプに変化がある場合 　メセージボックスに「誰かが変更した」と表示 ４－３．タイムスタンプに変化がない場合 　Updateする。 【前提】 普通にアップデートするだけなら、下記でできました。 Private DateTime1 As DateTime ' 画面表示の時に取得したitem3の値が入っているとする 　： 　： Dim NpgsqlConnection1 As NpgsqlConnection = New NpgsqlConnection Dim NpgsqlCommand1 As NpgsqlCommand = New NpgsqlCommand NpgsqlCommand1 = NpgsqlConnection1.CreateCommand NpgsqlCommand1.CommandText = "update tbl1 " _ & "set item2 = '" & Me.TextBox1.Text & "'" _ & ", item3 = current_timestamp " _ & "where item1 =" & キー値 NpgsqlConnection1.ConnectionString = 接続情報 NpgsqlConnection1.Open() NpgsqlCommand1.ExecuteNonQuery() NpgsqlConnection1.Close() 【考察】 変更された場合は、更新対象外にするのは、条件に入れればなんとかなります。 NpgsqlCommand1.CommandText = "update tbl1 " _ & "set item2 = '" & Me.TextBox1.Text & "'" _ & ", item3 = current_timestamp " _ & "where item1 =" & キー値 _ & "and date_trunc('second', item3) =" & "to_timestamp('" & Format(DateTime1, "yyyy-MM-dd HH:mm:ss") & "', 'YYYY-MM-DD HH24:MI:SS')" しかし、これではこのＳＱＬで更新されたのか、他で更新があったためにスキップしたのかが分かりません。 直前のＳＱＬで更新があったかどうか、もしくは何件更新対象になったかを得る事はできませんか？ もしくは、 一旦呼び出してロックし、その間にタイムスタンプを取り出し、 Ｖｂ内に持っていた前回のタイムスタンプと比較し、同じであれば更新する。 同じでなければステータスを返す。 というふうにしたいです。 【質問】 アップデート文で更新対象になった件数を取得する事はできませんか？ もしくは、フェッチの方法を教えて下さい。 上記の仕様のようにタイムスタンプを判断し、そのレコードを掴んだままアップデートしたいなら、フェッチするしかないのかと思っています。 でも、そのやり方が分かりません。 ・コネクト ・カーソル定義 ・カーソルオープン ・ネクストレコード ・レコードを取得し、VB側のタイムスタンプと比較←どうやって？ ・カーソル行に対しアップデート ・レコードの終わり ・０件なら「誰かが消した」と表示 ・カーソルクローズ ・コネクト解除 やりたい事は上記でSqlもVbも分かるのですが、インターフェイス込みでコマンドレベルの方法が分かりません。 フェッチでの方法が分からないので教えて下さい。 フェッチで以外の方法で同等の事が出来るもっと良いやり方があれば教えて下さい。 以上、よろしくお願いします。
リモートホストのpostgresqlにwindows7ホストからつなぐために、windowsホストにphpPgAdminをインストールしようとしています。 windowsホストにはpostgresql, phpなどをインストールしていません。 windows側でサーバーソフトを動かす予定はありません。 多くの解説サイトではpostgresqlサーバーにphpPgAdminを導入するのを前提としているようでよくわからないのですが、この場合、phpPgAdminのみを単独でインストールすればよいでしょうか、あるいは、先立ってphpなどインストールしておく必要があるのでしょうか？ 2013年11月1日
SQLのみで以下の様なことをしたいのですが、やり方が分かりません。 何かしら手法をお知りの方はご教授願いたく存じます。 ▼Postgresバージョン 8.1 ▼テーブル情報 id, numbers 1, '0,20,10,30,50' 2, '10,20,30,50,60' ↓ numbers の値をカンマ（ , ）で分解し、加算したい。 例） 　'0,20,10,30,50'　→　0 + 20 + 10 + 30 + 50 → INTEGERの 110 を取得 ※regexp_split_to_table の関数は、postgresのバージョンが古いために使用できませんでした。 postgresのバージョンを上げる事が出来ないため、8.1でも可能な対応方法を模索しています。
PostgreSQLのApplication Stack Builderを使用しNpgsql.dllをインストールしたところ バージョンが2.0.12になりました。2.0.11をインストールしたいのですが、 バージョン指定でインストールすることはできないのでしょうか？ ご回答のほど、よろしくお願いいたします。 【環境】 Windows7 Professional SP1 VB2010 PostgreSQL9.2.1
PostgreSQLとPHPでサイトを作っています。 下の２つの表がある場合に、「表１」のid名に応じて、 表2のid_noの該当件数を取得したいと思っているのですが、 うまくいかないため質問させいてただきました。 【表1】 idtitle ----------------------- 1ほげ1 2ほげ2 3ほげ3 4ほげ4 【表2】 id_nocoment ----------------------- 1コメント 2コメント 2コメント 2コメント 3コメント 3コメント 3コメント 【ほしい結果】 idtitlecount ----------------------- 1ほげ11 2ほげ23 3ほげ33 4ほげ40 SELECT title,id, (SELECT COUNT(*) FROM comment WHERE id_no ='【ID番号】') FROM informations AS count こちらの様なSQL文で取得出来るのではと考えたのですが、 【ID番号】の部分に、「表１」のidを動的に入れる事が出来ずに困っています。 解法がありましたら教えて下さい。
PostgreSQLで検索をすると濁点や半濁点もヒットしてしまいます。 「%カルヒ」で、「カルビスープ」も「カルピス」もヒットしてしまいます。 データべースは下記の通り作成しました。 CREATE DATABASE testdb WITH OWNER = postgres ENCODING = 'UTF8' TABLESPACE = pg_default LC_COLLATE = 'Japanese_Japan.932' LC_CTYPE = 'Japanese_Japan.932' PostgreSQLにて検索で濁点や半濁点をヒットさせない方法はありますか？
ｂａtchInsert処理を行うと正常終了しますが、DBには追加されてiいません。 ConnectionMgr.commitConnection(conn);文が終了後実行されています。 ＳＱＬ文 public void batchInsertSgnbtuInfo(ArrayList list, String rysnoo, String pgmId, Connection conn) throws DBException, SQLException { if (list == null || list.size() < 1) { return; } PreparedStatement pstmt = null; int[] rst = null; //sql文 StringBuffer sql = new StringBuffer(); sql.append(" INSERT INTO sgnjsk_inf (" + " kjikminoo, " + " hnkrrkymd, " + " untbng, " + " sgnetyjyn, " + " sgncod ) " + " VALUES (?, to_timestamp(?, 'yyyy/MM/dd hh24:mi:ss'), ?, ?, ?); try { pstmt = conn.prepareStatement(sql.toString()); //SQL文のパーラメタを設置 for (Iterator it = list.iterator(); it.hasNext();) { SgnbtujskinfInfo info = (SgnbtujskinfInfo) it.next(); int i = 1; // VALUES pstmt.setString(i++, info.getKjikminoo()); pstmt.setString(i++, info.getHnkrrkymd()); // ユニット番号 pstmt.setInt(i++, info.getUntbng()); //資源登録順 pstmt.setInt(i++, info.getSgnetyjyn()); pstmt.setString(i++, info.getSgncod()); pstmt.addBatch(); } pstmt.executeBatch(); } finally { if (pstmt != null) { pstmt.close(); } } } よろしくご教授ください。
お世話になります。 以下のSQL文のイメージでselectの結果をさらにselectしたいのですが”subquery has too many columns”というエラーを吐かれます。 Postgreに合った書き方がお分かりでしたら教えてください。 よろしくお願いします。 select * from [DB名] where [パスワード] = 'test' IN ( select * from [DB名] where [ユーザID]='1111' order by [更新日] desc limit 3) [やりたいこと] テストDBからユーザIDが1111の行を更新日をキーに降順で並べ、先頭から3行分を取り出す。 その3行からパスワードが"test"のものをselectしたい。
お世話になります。 例えば以下のようなテーブルでデータ件数が100,000件あった場合、 SELECT * 条件指定無しでデータ抽出した場合と、 SELECT key 条件指定無しでデータ抽出した場合で パフォーマンスはどのぐらい変わってくるでしょうか？ create table test ( key char(8) primary key, data1 int8, data2 char(20), data3 char(10), data4 date, data5 char(10) ); 参考になる情報（数値）をお持ちの方がいれば、 教えて頂けるとありがたいです。 よろしくお願い致します。
現在Postgresqlの日付　文字列比較で困っています。 あるテーブルに更新日付を入力するカラムがあるのですが、 「SELECT * FROM test WHERE updatetime = '2013/07/26 12:07:13'」 というSQLを実行した場合、updatetimeが「2013/07/26 12:07:13」のデータが取得できません。 Create Castでキャストを作ってやる必要があるのでしょうか？ もしくは別の方法がございましたらご教授をお願い致します。
PostgreSQLを使ったJavaシステムで、検索スピードが最も速い方法を教えていただきたいと思います。 ・検索するテーブル（tblS） 　scode　Varchar　6　主キー 　sname　Varchar　30 　stni　Varchar　2 　skmk　Varchar　2 　stnk　Int4 ・検索する項目 　入力されたnameがテーブルのsnameに存在した場合、他の４項目のデータを読み込む。 　これを連続して5回（nameが５件ある）行う。 現在考えているのが、tblSのデータをArrayListに読込み、ArrayListの検索を行う方法です。 現在、tblSの件数は1500件ですが、日々増加しています。 どうかよろしくご教授ください。
Postgres初心者です。 教えてください。 pg_dumpコマンドでdump拡張しのバックアップファイルを生成し、 tarコマンドで****.tar.gzファイルに圧縮しました。 このtar.gzのファイルを直接リストアするコマンドがあれば 教えていただけないでしょうか？ -bash-3.2$pg_restore -U postgres -d (データベース名） < ****.tar.gz と実行すると、以下のエラーメッセージが表示されます。 →pg_restore: [アーカイバ] 入力ファイルが有効なアーカイブではないようです。 -bash-3.2$gunzip -C ****.tar.gz | pg_restore -d (データベース名） と実行すると、以下のエラーメッセージが表示されます。 →pg_restore: [tarアーカイバ] tarアーカイブ内でファイルtoc.dat用のファイルヘッダがありませんでした よろしくお願い致します。
お世話になります。 phpPgAdminで更新作業をしていまして 一件一項目の更新で update "store_table" set "tenpo_add" = '東京都１－１－１' where "kaiin_no" = '123456'; とした場合はうまく更新でできたのですが、以下のように複数項目の更新が文法エラーになります。 update "store_table" set "tenpo_post1","tenpo_post2","tenpo_add" = '123','4321','東京都１－１－１' where "kaiin_no" = '123456'; このようにした場合、　　","　←この部分が文法上おかしいとのエラーが出ました。 どのように記載すれば良いかご指導いただければ幸いでございます。。
あるWebアプリのDBをOracleからPostgresqlへ移行中なのですが、 トランザクション処理でエラーが発生します。 エラーコード：25006 メッセージ：リードオンリーのトランザクションでは UPDATE を実行できません Oracleでは正常にトランザクションが処理されてPostgresqlではできないということがあるのでしょうか。 類似の問題に経験のある方はご教授をお願い致します。 ちなみに、OracleとPostgresqlのバージョンは下記の通りです。 Oracle：11g Postgresql：9.2
CentOS 6.4をインストールし、標準装備のpostgresql 8.4をインストールしました。 この環境にpgadmin3をインストールしたいのですが、最も簡単な方法を教えて下さい。 ネットで調べると、「ソフトウェアの追加／削除」から「pgadmin3」を検索し、ヒットしたモジュールにチェックを付ければインストールが完了するような事を書いていましたが、「ソフトウェアの追加／削除」で検索してもモジュールはヒットしません。 http://www.linuxmania.jp/postgresql_01.html 例ではCentOS 5でしたので、念のためにCentOS 5で試しましたが、やはり出来ません。 yumでインストールできるような事を書いているのもありましたが、 yum list 上にpgadmin3は見当たりません。 うーん、という感じです。
PostgreSQL（9.1.4）のストリーミング・レプリケーションについて 現在、半年ほどRails+PostgreSQL（9.1.4）で構成されたシステムを運用しております。 DBサーバ（PostgreSQL 9.1.4）を2台使用し、PostgreSQLのストリーミング・レプリケーション機能を用いて、サーバ間でのデータ同期処理を実現させておりました。 しかし、本日より、このストリーミング・レプリケーション機能が正常に動作せず、データの同期処理が行われない状態となってしまいました。 原因の調査方法が、分からず、どのようなログを見て、どのように対処すべきか、ご存知の方がいらっしゃいましたら、教えて頂けないでしょうか？ 何卒よろしくお願い申し上げます。
お世話になります。DB初心者です。 現在　、PostgreSQLのphpPgAdminを使っていまして 以下のようなDBがあり kaiin_no　 t_name 　 t_chiket -------+-------+---------- 1001 　　 太郎　 　　 なし 1002 　　 次郎　 　　 なし 1003 　　 三郎　 　　 なし 1004 　　 四朗　 　　 あり 1005 　　 五朗　 　　 あり 以下のようなSQLで目的のデータを表示できるのは解ったのですが SELECT "kaiin_no","t_name","t_chiket" FROM "public"."store_table" WHERE "kaiin_no" IN ('1001','1002','1003'); kaiin_no　'1001','1002','1003'　の t_chiket　を　「なし」　から　「あり」　に変更すする方法をご教授いただけますでしょうか？ お手数をおかけしますがよろしくお願いいたします。
select first_nm,last_nm,addr,blood from prof のように複数の列名を指定して結果を取得する方法で 列名ではなく「n番目の列」というような要素番号のようなもので指定して 取得する方法はないでしょうか select [1番目の列],[2番目の列],[3番目の列],[4番目の列] from prof というような構文です。
pg_dumpall > [出力ファイル名] で作成したバックアップからテーブル単位でリストアする方法はないのでしょうか? pg_dumpallのマニュアルを読むと、リストアはpsqlで行うことになっていますが、psqlのマニュアルには テーブル単位で取り出すオプションなどはないようです。 また:pg_dumpallで作成したファイルを: pg_restore -l [入力ファイル名] の入力ファイルにすると、"pg_restore: [archiver] input file does not appear to be a valid archive" エラーが発生します。 webでも調べてみたのですが、該当するページが見あたりません。 お手数ですがご教授ください。
PostgreSQLをバージョン8.2から9.2にＵＰし、Ｔｏｍｃａｔをバージョン５から７にＵＰしました。 そのほか、ＯＳはWindows7でローカルシステムを構築中です。 実行すると、HTTPステータス５００javax.naming.NamingException: Could not load resource factory class [Root exception is java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSourceFactory] とエラーが出ます。 以下の環境設定の間違いと思われますが、どこを直せばよいかわかりません。 よろしくご教授ください。 ＰｏｓｔｇｒｅＳＱＬは、C:\Program Files\postgresql9.2に配置しました。 Ｔｏｍｃａｔは、C:\Tomcat7に配置しました。 システムはC:\Tomcat7\webapps\test1に配置しました。 ＪＤＢＣドライバは、postgresql-9.1-901.jdbc3.jar と　postgresql-9.1-901.jdbc4.jar を C:\Tomcat7\libnにコピー＆ペーストしました。 接続の定義は、C:\Tomcat7\conf\catalina\localhost に　test1.xmlファイルを作りました。 以下がその記述です。 <?xml version='1.0' encoding='utf-8'?> <Context path="/test1" reloadable="true" docBase="C:\Tomcat7\webapps\test1" workDir="C:\Tomcat7\work" > <Resource name="jdbc/RDBMS" auth="container" type="javax.sql.DataSource" debug="1" factory="org.apache.commons.dbcp.BasicDataSourceFactory" driverClassName="org.postgresql.Driver" username="postgres" password="postgres" maxActive="100" maxIdle="30" maxWait="10000" url="jdbc:postgresql://localhost:5432/LocalDB" removeAbandoned="true" removeAbandonedTimeout="300" /> </Context>
いつもお世話になっております。 標題についてご教授下さい。 DBからある項目をupper関数を使って変換しているのですが、 変換されません。 UPPERは文字列などを大文字に変換する認識なのですが、 わかりません。 [table A] key1 Ｔｅｓｔ key2 test SELECT upper(key1), upper(key2) from A 結果 key1 　 key2 Ｔｅｓｔ　 TEST 全角の英字が変換されません。 そもそも全角はtranslateしないとだめでしょうか。 お手数ですが、宜しくお願いします。 　
PostgreSQL 8.4に関する質問です。 サーバ：Linux、PostgreSQL 8.4 クライアント：Windows 7 Windowsマシンから、バッチファイルでサーバ上のPostgresのバックアップを取りたいのですが、 以下のコマンドをバッチファイルに記述して実行すると、 「パスワード:」というプロンプトが出て処理が止まってしまいます。 pg_dump.exe -h [DBサーバのIP] -U [ユーザ名] -F custom -b -v -f "C:\test.backup" "test" パスワードを入れればバックアップはできるのですが、 パスワードの入力まで完全自動化するにはどうすればいいでしょうか。 Linux上のPostgresはSSL接続のみ許可するようになっています。 Windowsのタスクで毎日バックアップする運用を想定しています。
Windowsに、PostgreSQL 旧バージョン等をインストールしたいのですが、 以下のバージョンをインストールする事は可能でしょうか。 PostgreSQL 7.3.6 Apache 2.2.23 PHP 5.2.17 Windows は、できれば7(64bit)、駄目ならXP(32bit)に入れたいです。 Postgresを自分で探してみたのですが、Linuxバージョンしか見つける事ができませんでした。
PostgreSQLバージョン　9 OS：RedHat 現在Oracleからの移行でPostgreSQLにてTEXT取り込み処理を作成しています。 OracleではSQLLoaderを使用して取り込んでいましたが、 PostgreSQLではCOPYコマンドを使用すれば取り込みできるところまで調べました。 しかし、行末に区切文字があるためうまく取り込みできません。 【コマンド】 \copy hoge from 'hoge.txt' delimiters '|'; 【行末に区切文字がある場合NG】 AAA|BBB|CCC| ERROR: extra data after last expected column CONTEXT: COPY hoge, line 1: "AAA|BBB|CCC|" 【行末に区切文字がない場合OK】 AAA|BBB|CCC SQLLoaderでは行末の区切文字があっても取り込めましたが COPYコマンドでは取り込めないようです。 回避策はないのでしょうか？ （取引先からのTEXTなので相談はして見ますがレイアウトの変更は難しいかもしれません。） 回避策がない場合、行末の区切文字を削除する方法はありますでしょうか？ 行末だけの区切文字を削除する方法が分かりません。 （テキストは固定長でないため、桁数を指定した削除ができません） 行末区切文字削除の方法だけでも良いのでお願いします。
ポスグレでイベントトリガを使いinsert時に任意の関数を呼び出し処理を行いたいのですが 最後にinsertされた(正確にはそのイベントが発生したときにinsertされた)レコードの データを関数内で使うやり方がわかりません。 そういった関数みたいのがあるのでしょうか。 ご存知の方、ご教示いただけると助かります。
お世話になります。 PostgreSQL8.4.8のphpPgAdmin3.5.3を使ってデータを削除する際に 先ずデータをSELECT で表示させて確認後、 SQL編集　で　SELECTを　DELETE　に書き換えて実行しましたが以下エラーが出ます ≪一覧確認用≫一覧表示はできました。 SELECT "kaiin_no","tenpo_no","tenpo_name" FROM "public"."store_table" WHERE "kaiin_no" IN ('1234',2222'); ≪削除用≫SELECT 　→　DELETEに変更　→　実行　→　以下エラー DELETE "kaiin_no","tenpo_no","tenpo_name" FROM "public"."store_table" WHERE "kaiin_no" IN ('1234',2222'); ≪エラー内容≫ ERROR: syntax error at or near "," LINE 1: SELECT COUNT(*) AS total FROM (DELETE "kaiin_no","tenpo_no",... ^ 文: SELECT COUNT(*) AS total FROM (DELETE "kaiin_no","tenpo_no","tenpo_name" FROM "public"."store_table" WHERE "kaiin_no" IN ('1234','2222')) AS sub 文法エラーのようなのですが 一覧が出来ているのに　なぜ削除が出来ないのか 初心者で恐縮ですが ご教示頂ければ幸いです。
pl/pgsqlで変数が文字列として扱われてしまうのですがどうすればいいのでしょうか。 具体的には以下のような感じです。 CREATE OR REPLACE FUNCTION test_func() RETURNS VOID AS $$ DECLARE test_val TEXT ; ofs_num INTEGER := 0; lmt_num INTEGER := 0; t_name TEXT := 'schema1.table1'; BEGIN SELECT INTO ret_val * FROM t_name OFFSET ofs_num LIMIT lmt_num; END; $$ LANGUAGE plpgsql; 上記のofs_numやlmt_numは変数として認識してくれるのですが FROMに続く「t_name」が変数ではなくそのままの文字列として認識されてしまいます。 t_nameを変数として認識させる方法はありませんでしょうか。 教えていただけると助かりますm(_)m
素朴な疑問ですが、教えてください。 SQLのcreate index構文は「create index idx on table(id);」ですが、 そもそも、なぜindex名をこちらが名前を指定するようになっているのでしょうか。 別にシステム側で決めても良い気がします。delete index するときも 列名を指定する仕組みにして、列名に張られたindexを削除する仕組みにすればいいのにと 思います。 よろしくお願いします。
お世話になります。 複数レコードがあるテーブルにて、あるレコードだけカウントアップする為のSQL文はどのように記述すれば良いでしょうか？ 要件： テーブル名'名簿'の No, 名前, 更新者, 備考に 01, 芥川龍之介, ほげ太, NULLを入力し 備考は書き込みさせるためとりあえずNULLを代入しておき 名前と更新者は同じで、Noの部分だけを01～10までカウントアップさせたい 何卒、ご教授のほど、宜しくお願いします。
ポスグレDBで以下のような二つのテーブルがあって レコード数、カラム等の構造も同じだったとして カラム1の値が二つのテーブルで同じであり カラム2～4のうちどれか一つでも違うレコードを抽出するSQLがわかりません。 下記の例で言うと抽出結果がスキーマA.テーブルAの「←」のレコードを抽出したいです。 スキーマA.テーブルA カラム1|カラム2|カラム3|カラム4| --------------------------- A |aaaaaaa|bbbbbb|ccccccc --------------------------- B |aaaaaaa|bbbbbb|ccccccc　　　　　　← --------------------------- C |aaaaaaa|bbbbbb|ccccccc　　　　　　← --------------------------- D |aaaaaaa|bbbbbb|ccccccc　　　　　　← --------------------------- E |aaaaaaa|bbbbbb|ccccccc スキーマB.テーブルB カラム1|カラム2|カラム3|カラム4| --------------------------- A |aaaaaaa|bbbbbb|ccccccc --------------------------- B |1111111|bbbbbb|ccccccc --------------------------- C |aaaaaaa|777777|ccccccc --------------------------- D |2222222|bbbbbb|8888888 --------------------------- E |aaaaaaa|bbbbbb|ccccccc よろしくお願いします。
SQLで2つの表から条件に合ったデータを取り出し、同じ列に表示させたいのですが、 どうやっても外部結合のようにすることしかできませんでした。 取り出したデータを縦に結合?させることはできるのでしょうか? 例) dataは月の上旬中旬下旬でそれぞれabcとします。 入力値はmonthとdayで、これらからuriageを選択します。 dataの取りうる値はa,b,c,ab,bc,abcとします。 　　 table:A 売上表　　　　　　　　　　　　table:B 上旬中旬下旬判断 ---------------------------　　　----------- 　key　|　data　|　month　|　uriage 　　day | data --------------------------- 　　　----------- 　　1　|　　a　　|　　1　　|　　500　　　　　 1　|　　a 　　2　|　 ab 　|　　1　　|　　800　　　　　…　|　　… 　　3　|　 bc 　|　　1　　|　　400　　　　　10　|　　a 　　4　|　　c　　|　　1　　|　　100　　　　　11　|　　b 　　5　|　　abc　|　　1　　|　　900　　　　　…　|　　… 　 …　|　　…　　|　　…　　| …　　　　　31　|　　c --------------------------- 　　　----------- month = 1 , day =5のとき 　table:Bより 　　SELECT data FROM table:B WHERE day = 5 としてdata "a" を得ます。 この"a"と同じdataを持つuriageを表示させたいので 　　SELECT uriage FROM table:A 　　WHERE month = 1 AND data = (SELECT data FROM table:B WHERE day = 5) として 　table:query1 　-------- 　　 uriage 　-------- 　　　500 　-------- を得ました。 ここまでは良いのですが、これに付け加えて、 table:Bから取り出したdata "a"をtable:Aのdataが含むとき(data = a,ab,abcのとき) その全てのuriageを表示させたく、 ワイルドカードを使おうと 　　SELECT uriage FROM table:A 　　WHERE month = 1 AND data = %(SELECT data FROM table:B WHERE day = 5)% 等としてみたのですが、上手くいきませんでした。 そこで、別のクエリーを作って 　　SELECT uriage FROM table:A 　　WHERE month = 1 AND data = 'ab' AND data = 'abc' として 　table:query2 　--------- 　　uriage 　--------- 　　　800 　--------- 　　　900 　---------- を得ました。 そして、最後に、 得られた2つの表をまとめて 　--------- 　　uriage 　--------- 　　　500 　--------- 　　　800 　--------- 　　　900 　--------- としたいのですが、 　　SELECT uriage, uriage FROM query1, query2 とすると 　------------------ 　　uriage　|　uriage 　------------------ 　　　500　 |　　800 　　　500　 |　　900 　------------------ となりますし、UNIONは使い方がよくわからないためシンタックスエラーにしかならず...。 そもそも、縦に結合?はできるのでしょうか??? あれこれ試してみたのですが、詰まってしまったので、 どなたか知恵をお貸しください。
商品マスタがあり、データは下記の感じで登録されています。 　コード　|　商品名　　|　商品カナ　|　分類コード　・・・ --------------------------------------------------------- 　0001　　|　マウス　　|　マウス　　|　01　　　　　・・・ 　0002　　|　キーボード|　キーボード|　01　　　　　・・・ 　0003　　|　モニター　|　モニター　|　01　　　　　・・・ 　　　　　　　　　・ 　　　　　　　　　・ 　　　　　　　　　・ SQL文で質問があります。 下記のSQLでは取得できるんですが・・・ SELECT * FROM M_SHOHIN WHERE code = ANY('{0001,0002,0003}'); 下記のSQLを実行したらエラーが出力されました。 SELECT * FROM M_SHOHIN WHERE code = ANY( 　SELECT ARRAY_AGG(code) AS code FROM M_SHOHIN WHERE class_code = '01' ); ERROR: operator does not exist: character varying = character varying[] HINT: No operator matches the given name and argument type(s). You might need to add explicit type casts. なので下記のようにCASTをするようにして実行したらエラーは出力されなくなりましたがデータの取得ができませんでした。 SELECT * FROM M_SHOHIN WHERE code = ANY( 　SELECT CAST(ARRAY_AGG(code) AS VARCHAR) AS code 　FROM M_SHOHIN WHERE class_code = '01' ); どのようにすれば取得できますでしょうか。 説明が下手で申し訳ありませんがアドバイスいただけませんでしょうか。 データベースはPostgreSQL 8.4.9です。 宜しくお願いします。
業務システムでPostgreSQL８．３を利用しており日次でバックアップを行っています。しかし、もしシステム稼動中にサーバー障害が発生した場合、データの復旧可否が利用者にとって一番気になるところだと思います。（日次バックアップは実施しているので前日データまでは復旧できると思います。） そこで質問なのですが、最新データまで復旧するとなるとログデータが必要になると思いますが、サーバが何らかの障害でログデータすらサルベージできない状況が起きることを想定して、ログデータも別のサーバに常に退避するように設定することは可能でしょうか？（無知ですみません） 可能な場合、PostgreSQLにおける上記の具体的な実施方法を教えて頂けないでしょうか？（お恥ずかしい限りではありますが、そもそもこの方法が妥当かどうかも判断できていないです） 上記の中で、質問者はデータベースのことを分かっていないと判断されましたら、合わせてアドバイス・一般論なども頂けると幸いです。 何卒、よろしくお願いします。
複数行の上位3位を1行に表示する。 分かる方がいれば教えて下さい。 OS：Windows7 DB：PostgresSQL 8.3 ＜参照デーブル＞ 品番　　ID　　　金額　　　　日付 1;　　　　3;　　　1000000;　"2012-08-31" 1;　　　　2;　　　970000;　　"2012-08-18" 1;　　　　1;　　　970000;　　"2012-08-10" 1;　　　　4;　　　940000;　　"2012-08-20" 2;　　　　16;　　300000;　　"2012-08-25" 2;　　　　13;　　300000;　　"2012-08-13" 2;　　　　12;　　250000;　　"2012-08-10" 2;　　　　15;　　250000;　　"2012-08-18" 2;　　　　14;　　200000;　　"2012-08-15" 2;　　　　11;　　200000;　　"2012-08-08" 上記の様なテーブルを、金額が高くかつ時間の速いもの順で、上位3位を1行に表示したいのですが、上手くいかずに困っています。 ＜抽出したい結果＞ 品番　　ID1　　　金額1　　　　ID2　　金額2　　　ID3　　　金額3 1;　　　　3;　　　　1000000;　　1;　　　970000;　　　2;　　　970000 2;　　　　13;　　　　300000;　　16;　　300000;　　　12;　　　250000 このように抽出しいたいのですが上手くいきません。 どなたか教えていただけいないでしょうか。 よろしくお願いします。
PostgreSQL初心者です。 AccessからPostgreSQLに移行しようと思い、ODBCで接続しようとしたのですが、エラーが発生して進めません！ そして、いろいろ試してみたのですが、同じエラーが発生してしまいます。 設定、エラー内容は、下記になります。 エラー内容 「ODBC--呼び出しが失敗しました。 Could not connect to the server; Could not resolve hostname.(#101)[Microsoft][ODBC Driver Manager]ドライバのSQLSetConnectAttrは失敗しました。(#0)」 設定 データソース（ODBC）→システムDSN→PostgreSQL Driver Setup Database Server dbserver User Name localhost Description Port 5432 以上、宜しくお願い致します。 OS:WindowsXP Professional Version 2002 Service Pack3 PostgreSQL 9.1 Version 1.14.3 Access XP(2002) になります。
下記のようなテーブル（tbl）があり Code Name ------------ A1　　　A-1 A1　　　A-2 A1　　　A-3 B1　　　B-12 B1　　　B-13 C1　　　C-9 以下の結果を取得したいのですが Code Name ------------ A1 A-1 B1 B-12 C1 C-9 です。Accsessでは SELECT Code, First(Name) FROM tbl GROUP BY Code; などと書けるのですがPostgresSQL V9.1ではどのように書けばよいのでしょうか？ Window関数かと思いますが、旨く結果が得られません。 初歩的な質問で申し訳ありませんが、教えていただけませんか？
お世話になります。 データが更新された段階で、外部プログラム(xxx.exe)を実行したいと考えております。 おそらく、トリガを利用すれば可能かと思い調査しておりますが、 どのようにして外部プログラムを実行すればよいか分かっておりません。 ご存知の方、ご教示頂けないでしょうか。 よろしくお願いいたします。
PostgreSQLの全レコードを順次Updateしたいのですが、 SQLの記述方法がわかりません。 [やりたいこと] ユーザ情報を保持しているテーブルに、新しく"ID_TMP"カラムを追加。 カラム"ID_TMP"に、ユーザIDを保持しているカラム"ID_INFO"の内容を書き込む。 コピーしたいレコードが単一の場合、次のSQLで可能だと思うのですが、 テーブルに保持している全レコードを順次処理する方法を教えてください。 update [テーブル名] set ID_TMP = (select ID from [テーブル名] where id = [ID名]); 宜しくお願いいたします。
こんにちは。 SQLについて質問です。 id　　name　　goal 1　　山田　　東京 2　　木下　　北海道 3　　高橋　　大阪 3　　高橋　　沖縄 こういう状態でデータが入っていたとして、 idが3の高橋はgoalが違う状態で2件データがあります。 これを、 id　　name　　goal 1　　山田　　東京 2　　木下　　北海道 3　　高橋　　大阪、沖縄 こうなるようにしたいのですが、 どうSELECT文を書けばよいでしょうか？ よろしくお願いします。　　
DBサーバー：Linux、Postgresql 8.4.9 クライアント：Windows7 pro、vb.net 2010 にて開発を行っております。 ■経緯 copyコマンドを使用して、クライアントにあるcsvファイルのデータを DBテーブルに一括登録したいと考えております。 まず、「COPY table FROM 'csvファイルパス' 」で試したところ、 　ファイル経由のCOPY FROM、COPY TOを行うにはスーパーユーザでなければなりません 　標準入出力経由のCOPYは誰でも実行可能です。またpsqlの\\copyも誰でも実行できます 旨のエラーが返ってきた為、下記の方法を考えております。 ■質問内容 psqlからのcopyにより、登録を行おうと考えている。 その際に、vb.netからpsqlコマンドの実行がそもそも可能なのかどうか、 (Linux上のpsqlコマンドなのだから、vb.netから実行できない？) 根本的なところからの質問となってしまいますが よろしくお願いいたします。 また、上記実装を開設してるサイトなどもございましたら、 ご教授願います。よろしくお願いいたします。
よろしくお願いいたします。 ■経緯 Linuxサーバ & PostgreSQL 8.4.9 において開発を行っております。 データベースを日時でバックアップをとる案件がございまして、 pg_dumpでは差分バックアップができないことが判りました。 ネット等でも検索したところ、 「 PostgreSQL 8.0 以降では、前回バックアップした内容からの差分バックアップ、 特定時間までの巻き戻しが可能です 」 との書き込みも見つけたのですが、具体的な方法を調べてみたのですが、 目的の情報に、いまだたどり着いておりません。 ■質問内容 当然、私どもの使用するデータの種別、内容、に寄るところではありますが PostgreSQLを差分バックアップを取る場合に、 一般的にどのようなバックアップツール？（WAL?pg_rman?）を使用して、 差分を抽出しているのか、参考に教えていただけますでしょうか。 また具体的なコマンドの使用方法等を解説しているページなどもありましたら よろしくお願いいたします。
PostgreSQL のバージョンアップを検討しています。 Version 9.1.4 Version 8.3.19 Version 8.3.1と比べると機能・性能・セキュリティなどが良くなっているのですか？ phpからの操作の仕方や挙動が変わるとかあるのでしょうか。 Version 8.3.19 の方がよいですしょうか。
色々、試しているのですがうまくゆきません。 どうしたらよいでしょうか？ ポストグレのドライバを設定するところがあるのですが、 何を設定していいか分かりません。
よろしくお願いいたします。 LINUX & PostgreSQl　8.4.9 を使用してDB構築をしております。 PostgreSQLでは、CreateTable等、DDLを作成する際に、 テーブル名カラム名に対して大文字小文字が区別されるということですが、 PostgreSQLのconfファイル等の設定などによって ケースセンシティブ（大文字小文字の区別）の基準値などを設定することは可能なのでしょうか。 （ケースセンシティブを有効にする無効にする、のような設定） また、PostgreSQLのリファレンス内に、 ケースセンシティブについて触れた記述があるページが見つからなかったのですが、 そのような記述がある場所（Postgresの公式ページ内で）を、 ご存知の方いらっしゃいませんでしょうか？
基礎的なことで申し訳ございませんが、 お力添えよろしくお願いいたします。 CentOs 5 & PostgreSQL 8.4.9にてDB構築しております。 DB構築から、テーブル作成・項目追加・キー設定まで行いまして、 検索する際に、抽出件数が多く負荷のかかりそうなものに Indexを作成しようと考えております。 ■本題 　１．Indexを作成する対象となる項目の、目安としてどのようなものが考えられるでしょうか。 　　・キー対象の項目になっているもの 　　・検索条件の対象となる項目なども当たるでしょうか 　２．項目をまとめて一つのIndexにするメリット・デメリットはどのようなものでしょうか　 　３．テーブル結合したときのIndexの動作 　　　例) 下記のようなテーブルがあった場合 tablea(データ50000件程度) hoge_id pkey1 hoge_no hoge_nm ... tableb(データ150000件程度) test_id pkey1 hoge_id pkey2 hoge_betu_kb ... 　　　　select t1.hoge_id, t1.hoge_nm, t2.hoge_betu_kb rom tablea as t1 leftjoin tableb as t2 on t1.hoge_id = t2.hoge_id where t1.hoge_id > '100' and t1.hoge_nm like 'あいう%' 　　このような場合のIndex作成は、 A. Create index idx_tablea_hoge_id ON tablea (hoge_id); B. Create index idx_tablea_hoge_id ON tablea (hoge_nm); C. Create index idx_tableb_hoge_id ON tableb (hoge_id); ←tableaで指定しているのでこれは不要？ 　４．A.B.C.のようなIndex作成した際のテーブル定義の書き方 　　テーブル定義書のフォーマットは定められており、お門違いな質問かとは存じてはおりますが、 　　テーブル定義にIndex定義を書く場合に、添付した画像のようなフォーマットの書き方が 　　よく理解できずお気づきの点などございましたら、ご指摘願えたら助かります。 　　（以前は、CSEツールなどで自動出力される定義書のような書き方をしていたもので・・・） 　　　　 　　　例）tablea IDX1 IDX2 IDX3 hoge_id 1 hoge_nm 2 このような書き方になるのかどうか？ 　　　　　IDX2, IDX3の項目とは？どのようなIndex定義をした際に書き込むことになるのかが判らず。。。 　　　　　基礎から勉強しなおすべきとは存じておりますが。。。 現状の期間あまり時間がないことと、 DB構築を一人で行っており、このような内容を相談できるものがおりませんゆえ、 改めて、Index付加することを考えてみると、いまさら聞けないような内容かもしれませんが ちゃんと把握したうえで、テーブル構築したいと思いますので 今までの他の皆様の経験からのノウハウなども踏まえて、 ご教授いただけると大変助かります。
質問させていただきます。 DB:postgresql 言語:PHP タイトルの通りなのですが、 現在下記のような形でSQLを実行しています。 「to_char(created, 'YYYY年MM月') as created_styled,」 しかし、この形では月の部分が01月と0を含んだものになってしまいます。 MySQLであれば、%cを使用すれば0無しの月を生成出来るようなのですが、 postgresqlでも同じような機能は無いのでしょうか？ また、無理にSQL側で処理を行う必要も無いので、データを取り出した後での処理方法でも構いません。 もしこういった場合に一般的な0を消す対処方法があれば教えて頂けると助かります。 よろしくお願い致します。 また、質問に不備などがあればすぐに修正致しますので、その際はご指摘お願いします。
4コアのCPUですが、CPUのうち1つだけが使用率100%で、他のCPUを使ってくれず困っています。 対処法が解る方、助言をお願いします。 ＠環境 Linux version 3.2.12-gentoo Intel(R) Core(TM) i5-2400S CPU @ 2.50GHz postgresql-server-9.1.3
現在バージョン9.0.5をLinux上で動作しているのですが、 次のようなログを残してCPUが100％を示したままになってしまいました。 WARNING: worker took too long to start; cancelled そのときにwebアプリケーションはデータベースに接続できないエラーが発生していましたが、DBサーバを再起動すると再び正しく動作するようになりました。 このログが表示される原因はいくつかあると思いますが、一つでも原因について何か情報があれば教えて下さい。 また、解決方法もわかれば教えて下さい。
Webを検索しても方法が出てこなかったため、質問させていただきます。 ファイル内に記載されたSQLファイルをPostgresで実行したいと思っております。 OracleのSqlPlusでは以下のファイルを次のように実行できました。 【コンソール】 SQL> @@C:/path/hogehoge.sql 【ファイルの中身】 @@C:/path/xxx.sql @@C:/path/yyy.sql @@C:/path/zzz.sql ・ ・ ・ 今回、Postgresでもファイル内に記載されたSQLファイルを呼び出して実行するために、コンソールで以下のコマンドを実行したのですが、エラーとなってしまいます。 psql -e DB名 ユーザ名 < C:/path/hogehoge.sql 他のオプション指定が必要なのか、またはファイル内のSQLファイルのパスの指定方法が間違っているのか…現状では解決方法が見つかっておりません。 どなたか解決方法を知っている方がいらっしゃれば教えていただけませんでしょうか？
現在、引数の値を元に下記のようなSQL文を生成しています。 SELECT code, name FROM T_CGY WHERE code = '1111' UNION SELECT code, name FROM T_CGY WHERE code = '1110' UNION SELECT code, name FROM T_CGY WHERE code = '1100' UNION SELECT code, name FROM T_CGY WHERE code = '1000' ORDER BY code; ※出力されたSQL文に誤りがないかを確認する為にコピーしてターミナル上で実行したら該当するレコードを取得する事ができました。 それをストアドプロシージャ内で生成したSQL文を「QUERY EXECUTE」を実行して該当するレコードが取得できるように改造してみました。 下記が出力された結果です。 getCgyData -------------------- (1000,洋服) (1100,子供服) (1110,ズボン) (1111,長ズボン) 出力されたデータは私が望んだ内容なんですが・・・ 私的には下記のように出力したいと考えています。 col1　　　　｜　col2 ------------------------- 1000　　｜　洋服 1100　　｜　子供服 1110　　｜　ズボン 1111　　｜　長ズボン 何とか上記のように出力できるようにするにはどうしたらいいでしょうしょうか。 そもそも上記のように出力する事は可能なのでしょうか。 CREATE FUNCTION getCgyData (VARCHAR) RETURNS TABLE(col1 VARCHAR, col2 VARCHAR) AS ' DECLARE key ALIAS FOR $1; sql TEXT; BEGIN 　　　　　　　　　　　　　　　　・ 　　　　　　　　　　　　　　　　・ ※ここでSQL文を生成して、変数(sql)に格納しています。 　　　　　　　　　　　　　　　　・ 　　　　　　　　　　　　　　　　・ RETURN QUERY EXECUTE sql; END; ' language 'plpgsql' ; データベースのバージョンはpostgreSQL8.4.9です。 再度、申し訳ありませんがアドバイス、宜しくお願いします。 では、失礼します。
2つのテーブル（basecodeとaddcode）からVIEWを作りたいのですが、 そのVIEWについてご教授いただきたく。 ＜TABLE名：basecode＞ ---------------------- no name area code ---------------------- 1 aaaa 2 102 2 bbbb 4 103 3 cccc 4 203 4 gggg 3 303 5 eeee 3 101 6 ffff 5 104 7 hhhh 1 115 ---------------------- ＜TABLE名：addcode＞ ----------------------------------------- base anum bnum cnum dnum dmy no ----------------------------------------- bbbb 1 1 1 1 aaa 2 cccc 12 13 10 2 aaa 3 cccc 12 13 10 0 aaa 3 cccc 12 13 10 5 aaa 3 dddd 12 15 3 1 aaa 3 dddd 12 15 3 3 aaa 3 dddd 12 15 3 4 aaa 3 eeee 10 3 12 1 aaa 5 eeee 10 3 12 2 aaa 5 eeee 10 3 12 3 aaa 5 eeee 10 3 12 4 aaa 5 eeee 13 12 15 3 aaa 5 eeee 13 12 15 0 aaa 5 eeee 13 12 15 1 aaa 5 eeee 13 12 15 2 aaa 5 hhhh 4 3 11 0 aaa 7 hhhh 4 3 11 2 aaa 7 hhhh 4 3 13 2 aaa 7 kkkk 0 0 0 0 aaa 9 ----------------------------------------- VIEWの抽出は以下の通り。 　basecodeのno 　basecodeのname 　basecodeのcode 　addcodeのbase 　addcodeのanum 　addcodeのbnum 　addcodeのcnum 　addcodeのdnum VIEWの作成条件としては以下の通り。 ＜条件＞ TABLE名：basecodeとaddcodeのnoが存在し、かつ、 baseaddのnoが複数あり、baseが同じものは以下で判断 　・anumとbnumとcnumが同一であればその中のdnumが最小であるレコードを抽出 　・anumとbnumとcnumが異なれば別々に抽出 上記より、以下のように抽出したい。 ＜TABLE名：basecodeview＞ ----------------------------------------------- no name code base anum bnum cnum dnum ----------------------------------------------- 2 bbbb 103 bbbb 1 1 1 1 3 cccc 203 cccc 12 13 10 0 3 cccc 203 dddd 12 15 3 1 5 eeee 101 eeee 10 3 12 1 5 eeee 101 eeee 13 12 15 0 7 hhhh 115 hhhh 4 3 11 0 7 hhhh 115 hhhh 4 3 13 2 ----------------------------------------------- よろしくお願いします。
aaa bbb ccc ddd eee ggg hhh ---------------------------------------------- 111 111 111 111 111 111 111 112 112 112 112 112 112 111 112 113 113 113 113 113 111 114 114 114 114 114 114 111 114 114 114 114 114 114 112 114 115 115 114 114 115 111 114 115 115 114 114 115 112 116 116 116 116 116 116 111 116 116 116 116 116 116 112 116 116 116 116 116 117 111 116 116 116 116 116 117 112 118 118 118 118 118 118 118 上記のようなデータより、SQLのSELECTを使用して、以下のように抽出したいです。 抽出条件は以下が全て満たしているものとなります。 ・aaa,ccc,ddd,eee,gggが重複、hhhが小さいもの ・bbbが異なるもの aaa bbb ccc ddd eee ggg hhh ---------------------------------------------- 112 112 112 112 112 112 111 ・・・(1) 112 113 113 113 113 113 111 ・・・(1) 114 114 114 114 114 114 111 ・・・(2) 114 115 114 114 114 115 111 ・・・(2) (1)はaaa,ccc,ddd,eee,gggが重複、bbbが異なるため抽出対象 (2)はaaa,ccc,ddd,eee,gggが重複、bbbが異なるため抽出対象 　また、hhhが小さいもの 以上、よろしくお願いします。
PL/pgSQL を使用し更新処理を行いたいのですが、 パラメータの数が多すぎるのか 以下のエラーでデータベースにファンクションを定義出来ません。 ERROR: functions cannot have more than 100 arguments SQLステート:54023 可変長引数で作成すると、データベースに定義は出来るのですが ファンクション実行時に同様のエラーが発生し更新処理が行えません。 PL/pgSQL の引数を100以上使用出来る様にする設定等、存在するのであれば 教えて頂きたいです。 環境は以下の内容です。 CentOS-6.2-x86_64 Apache/2.2.15 PostgreSQL 9.1.3 PHP Version 5.3.3 (PDOを使用しています)
下記の3つのテーブルがあります。 ・社員マスタ(TBL_SHAIN) ・得意先マスタ(TBL_TOKUI) ・地域マスタ(TBL_AREA) 各テーブルのフィールドは下記の通りです。 ・社員マスタ(TBL_SHAIN) 　・社員コード(shain_code) 　・社員名(shain_name) 　・役職タイプ(post_type) 　・地域コード(area_code) ・得意先マスタ(TBL_TOKUI) 　・得意先コード(tokui_code) 　・得意先名(tokui_name) 　・地域コード(area_code) ・地域マスタ(TBL_AREA) 　・地域コード(area_code) 　・地域(area_name) 　・分類コード(kind_type) ※社員マスタ(TBL_SHAIN)の地域コード(area_code)は配列型です。 社員マスタの地域コードには下記のような配列データが格納されています。 ・「{E01,E02,S01,T01,C03}」 　※この値は地域マスタ(TBL_AREA)の地域コード(area_code)です。 試しに 下記のSQLで配列データを下記のような形式に変換。 　SELECT chr(39) || array_to_string(area_code, ''',''') || chr(39) FROM TBL_SHAIN; 　　「'E01','E02','S01','T01','C03'」 上記で出力した値('E01','E02','S01','T01','C03')で得意先マスタを検索できるかと思って下記のSQLを実行。 SELECT * FROM TBL_TOKUI WHERE area_code IN (SELECT chr(39) || array_to_string(area_code, ''',''') || chr(39) FROM TBL_SHAIN); 結果は空でした。 やりたい事は社員マスタ(TBL_SHAIN)の地域コード(area_code)と地域マスタ(TBL_AREA)の地域コード(area_code)を結合し、また得意先マスタ(TBL_TOKUI)の地域コード(area_code)と結合しようと考えています。 みなさんにアドバイスいただきたいのは社員マスタと得意先マスタと地域マスタを結合するにはどのようにしたらいいでしょうか。 また社員マスタの地域コードに該当する得意先を参照するにはどうしたらいいでしょうか。 どうか宜しくお願いします。
PostgreSQLのDBサーバがハードディスク故障で使えなくなり、新サーバに交換しましたが、幸い古いディスクからファイルシステムのデータをコピーできました。 この場合、どうやって新サーバにDBのリストアできるのでしょうか？ コピーされた古いディスクのファイルはdumpしてない元々のファイル群ですので、ちょっと復元のやり方が分かりません。 新サーバに同じバージョンのPostgreSQLをインストールして、古いファイルを上書きすればいいでしょうか？ ちなみに、旧サーバと新サーバのスペックは一緒です。 分かる方いればぜひ教えてください。
現在、Access2010＋Postgresqlにてシステムを構築しており ADOにてデータベースからレコードの検索・追加・更新を行っております。 今回質問させて頂きましたのはpostgresqlのチューニング方法についてです。 現在、あるテーブルにWANからVPNを経由して接続した状態でSELECTを行うと、 結果が帰ってくるまでにおよそ6分程度かかるテーブルがあります。 （LAN内では4秒程度） 抽出するフィールドを*ではなく、1フィールドに限定しても約4分程度かかります。 そのテーブルには約30000件ほどレコードが格納されており SELECTする際は、bool型のフィールドをWHERE条件に入れています。 例）SELECT * FROM tbl_test WHERE f条件 = TRUE; しかし同じテーブルの別のvarchar型フィールドにLIKE演算子で検索を かけると、すぐ（0.44秒）に結果が帰ってきます。 例）SELECT * FROM tbl_test WHERE 名称 LIKE '%テスト%'; 尚、この場合の結果は20件ほどですので、結果が早いのは当然ですが なぜbool型を条件にした場合に6分もかかってしまうのでしょうか。 システムの都合上、WANからVPNを経由してアクセスする事が必須ですので LAN内の速度が速くてもWANからの速度が遅いのはNGなのです。 一応、Web上で紹介されている一般的なチューニング方法を参考にし postgresql.confの設定値は下記の通りに行いました。 ・shared_buffers → 1024MB ・max_connections → 100 ・effective_cache_size → 512MB ・random_page_count → 2 ・work_mem → 3MB 恐らく根本的にどこかの設定や設計がまずい為、このような結果に なっているのであろうと思うのですが、それを特定するに至りません。 見直すべき点やアドバイスなどがあれば教えて下さい。 ＜サーバースペック＞ OS：WindowsXP Pro SP3 メモリ：3GB CPU：Pen4 2.8GHz Postgresqlバージョン：8.3
postgreSQL8.4を使っているのですが、SQL支援ソフトを導入したいと考えています。 以前、cseを使ったことがあるのですが、これ以外にオススメのソフトありましたら、ご教授願います。
SELECT point FROM point_1 where id = 1; SELECT point FROM point_2 where id = 1; 別のテーブルの同じカラムで引き算をしたいです。 どうすればいいのでしょうか？
同じselect文でも 1回目のselect文と2回目のselect文の早さが全然違います。 なぜでしょう？
皆さんのお陰でストアドファンクションを作成する事ができました。 ここで1つ、疑問が・・・ ネットでPostgreSQLの「CREATE PROCEDURE」を検索しても私が望んでいる情報を得る事ができませんでした。 申し訳ありませんがここで質問があります。 PostgreSQLで「CREATE PROCEDURE」はないんでしょうか。 PostgreSQLではストアドプロシージャとストアドファンクションは一緒なのでしょうか。 MySQLやSQL Serverではストアドプロシージャとストアドファンクションは別だった気がしますが・・・ ※違っていたらすみません。 どなたか私の疑問を解決していただけませんでしょうか。 宜しくお願いします。
初歩的な事を聞かせて下さい。 テーブルを作成しました。 テーブルの項目は以下の通りです。 連番 コード 名前 カタカナ パスワード メールアドレス 所属 権限 削除フラグ 作成者 作成日 更新者 更新日 プライマリキー(主キー)を貼る際の注意は有りますでしょうか。 私自身、プライマリキーはユニーク項目に貼るという認識していますが間違っていますでしょうか。 また、一つのテーブルにプライマリキーって貼る事はできますかっていうか貼る事ができるんでしょうか。 くだらない質問をしている事は重々、承知していますが自身がありません。 申し訳ありませんがアドバイスいただけませんでしょうか。 皆さん、ご教授宜しくお願いします。
PostgreSQLでストアドファンクションを作成しました。 ファンクションの内容は下記の通りです。 CREATE FUNCTION getRenban (VARCHAR) RETURNS VARCHAR(7) AS ' DECLARE key ALIAS FOR $1; code VARCHAR(7); code2 VARCHAR(2); code5 VARCHAR(5); renban INTEGER; new_code VARCHAR(7); BEGIN SELECT MAX(code) INTO code FROM M_ITEM WHERE flg = TRIM($1); code2 := TRIM($1); IF code IS NULL THEN renban := 1; ELSE SELECT SUBSTR(code, 2) INTO code5; SELECT TO_NUMBER(code5, ''99999'') INTO renban; renban := renban + 1; END IF; code5 := ''''; SELECT TO_CHAR(renban, ''00000'') INTO code5; SELECT code2 || code5 INTO new_code; RETURN new_code; END; ' language 'plpgsql' ; コンソール上で下記のコマンドを実行したらエラーが出力されました。 SELECT getrenban('01'); 出力されたエラーの内容は下記の通りです。 ERROR: value too long for type character varying(5) CONTEXT: PL/pgSQL function "getrenban" line 19 at SQL statement お恥ずかしいですがいくらコードを見てもどこが原因なのかわかりません。 申し訳ありませんがご教授お願いできませんでしょうか。 昨日から悩んでいます。 どうか助けて下さい、宜しくお願いします。
伝票データを各テーブル(ヘッダと明細)に分けたい格納したいと考えています。 ※ヘッダ情報と明細にヘッダNoというフィールドを作成してこの値で紐付けるようにしています。 そこで皆さんに質問があります。 ヘッダ情報を削除した際に紐づいている明細データも一緒に削除され、明細のみ削除する際はヘッダ情報は削除されずに明細のみが削除されるような仕組みにするにはどうしたらいいでしょうか。 またこういう機能ってういか、仕組みの事を何て言うんでしょうか。 ※確かテーブルを作成する際に何か記述したらできたような記憶がするんですが・・・ 　間違っていたらすみません。 説明が下手ですみませんが理解していただけましたでしょうか。 申し訳ありませんがアドバイス宜しくお願いします。
テーブルを作成する際に下記の項目のフィールドを考えていますがいい英語のフィールド名が浮かびません。 ・作成者 ・作成日 ・更新者 ・更新日 申し訳ありませんがご教授いただけませんでしょうか。 また命名で気をつける事がありましたらアドバイスいただけたら幸いです。 宜しくお願いします。
現在、phpおよびPostgreSQLを使用して ＷＥＢアプリケーションを開発しています。 その中で、あるテーブルのデータを一括削除するために TRUNCATEを使用したいと思い、以下のようにTRUNCATE権限を設定しようと したところ以下のエラーになりました。 ERROR: unrecognized privilege type "truncate" truncateタイプの権限設定が認められていない感じのエラーでしょうか。 ちなみに、テーブル作成および権限設定はphpPgAdminを使用して行いました。 ＳＱＬは以下の通りです。 CREATE TABLE stock_tbl ( cc_no int, course_no int, date int, time_no int, status int NOT NULL DEFAULT 0, del_flg int NOT NULL DEFAULT 0, create_dt timestamp NOT NULL DEFAULT now(), update_dt timestamp NOT NULL DEFAULT now(), PRIMARY KEY (cc_no, course_no, date, time_no) ); REVOKE ALL ON stock_tbl FROM admin; GRANT SELECT, UPDATE, INSERT, DELETE, TRUNCATE ON stock_tbl TO admin; 環境は以下の通りです。 サーバーはCentOS5.5 PostgreSQLのバージョンは8.1.23 phpPgAdminのバージョンは4.1.3 バージョンなどの問題でTRUNCATEの権限を設定できないのかなと思い 色々調べてみたのですが、解決に結びつくものが見当たりませんでした。 なんとか、上記テーブル、ユーザーにTRUNCATEの権限を与えたいのですが どのように設定を行えばよろしいでしょうか？ 補足ですが、PostgreSQLのバージョンが8.1.22で 上記テーブルに何の特権も設定せずにアプリケーションでTRUNCATEを 実行してもエラーになりませんでした。 どなたか、上記に関してアドナイスをいただけないでしょうか？ よろしくお願いいたします。
SQL文で“ある箇所のデータがNULLだったら指定した場所からデータを引用する”ということをしたいのですがどのように記述すれば良いのでしょうか？ 画像にあるようなテーブル構成だと仮定します。 やりたいこととして select A.XA, A.YA, A.ZA + M.M2, B.XB, B.YB B.ZB from A, B, M where A.XA = B.XB and A.YA = B.YB and B.ZB = M.M1 ; というような書き方です。 ちなみにM2のデータ型は「Interval Day？」とかいうような型らしい？です。名前忘れましたが・・・ このイラストから見るとマスターテーブルの“F5”のM2データがNULLです。 NULLデータは日付の加算ができなくなるので・・・対処したいのです。 このSQL文に加える処理として、 「もし、マスターテーブルのF5がNULLの場合のみG6のM2を参照する」 という構文を追加したいのですが・・・ そのような記述はSQL内で可能なのでしょうか？
データベースに 名前|取得時間 AAA|2011-12-11 19:00:33.562266 BBB|2011-12-16 18:53:13.163553 CCC|2011-12-19 14:01:35.91384 ってあった際に、18時から20時の間だけ抽出して 名前|取得時間 AAA|2011-12-11 19:00:33.562266 BBB|2011-12-16 18:53:13.163553 と表示したいです。 時間はnow()でINSERTしています。 宜しくお願いします。
PostgreSQLで、テーブル(2)の情報をキーに(1)を削除したいのですが、エラーが出てしまいます。 どなたか解決策をご存知の方いらっしゃいましたら ご教授宜しくお願い致します。 _構造_____________________ テーブル(1)・・カラムA テーブル(2)・・カラムA、カラムB _SQL文_____________________ DELETE FROM (1) INNER JOIN (2) ON (1).カラムA= (2).カラムA WHERE (2).カラムB=X _エラーメッセージ__________ [Err] ERROR: syntax error at or near "INNER"
テーブルの移行（Aテーブルのデータをキーを変更してBテーブルにInsertする）を行ったところ、 ERROR: duplicate key violates unique constraint "Bテーブル_unique"とメッセージが出ます。 SQL文はつぎの通りです。 INSERT INTO Bテーブル(契約番号, ユニット番号, 資源番号, 入力日, 数量) SELECT a.契約番号, a.ユニット番号, a.資源番号, a.入力日, a.数量 FROM Aテーブル a ; Bテーブルのキーは、契約番号, ユニット番号, 資源番号, 入力日です。 Aテーブルのキーは、契約番号,入力日,レベル１,レベル２です。 データ件数は約３万件です。 Bテーブルを調査して、重複となるレコードを表示させたいのですが、 SQL文がわかりません。 よろしくご教授ください。
いつもお世話になっております。 postgresql8.4でsubstrを使うとエラーになります。 ご教授願えないでしょうか。 select type_cd, brand_cd, brand_name from bags bag inner join type t on substr(bag,0.2) = t.type_cd としています。 尚、type_cd ,brand_cd はinteger function substr(integer, integer, integer) does not exist とエラーが表記されるので、 substr(bag,0.2)　→ substr(integer(bag),0,2)とやると、 "(" がシンタックスエラーとなります。 なにぶんSQLの経験が少なくてこまっております。 宜しくお願いします。
postgresqlのデータをcsvテキストに出力してmysqlに入れたら、booleanデータがmysqlではすべて 0 になりました。 postgresqlのbooleanはt/f表現であり、mysqlでは1/0表現のためと思いますが、うまく処理する方法はないでしょうか？ 2011 Dec. 18.
性能を考えた場合、文字列を格納するカラムはvarcharとtextではやはりvarcharの方が優れているのでしょうか？ 文字列には最大120文字しか入れない想定です。 それともバージョンによっては、特に差異はないとかありますか？
Postgresで関数（ストアドプロシージャ）を作成するのに PLPGSQLを使用しています。 レコードセットを取得し、1列目～40列目までを順次値を判定し、特定の値がある場合は、41列～80列のそれぞれ対応する（1列目なら41列目、13列目なら53列目…）列から数値を取得する動きを実現したいと考えています。 上記条件は下記プログラムで実現してますが、再帰処理で同じことが実現できないでしょうか？ ※商品マスタを作成して、クエリを作成するのが当たり前と思いますが、よんどころのない事情でこのテーブル形式をを崩せません。（外部システムの汎用データから取り込むためです） ------------------- 以下現状のプログラム　------------------- declare rec record; int1 integer; begin int1:=0; for rec in select * from kudamonouriage where syainid=$1 and kppw=$2 loop if substr(rec.kate1,1,3)='りんご' then int1:=int1+rec.kingaku1; end if; if substr(rec.kate2,1,3)='りんごthen int1:=int1+rec.kingaku2; end if; if substr(rec.kate3,1,3)='りんご' then int1:=int1+rec.kingaku3; end if; … … if substr(rec.kate39,1,3)='りんご' then int1:=int1+rec.kingaku39; end if; if substr(rec.kate40,1,3)='りんご' then int1:=int1+rec.kingaku40; end if; end loop; return int1; end; ---------------- 以上現状のプログラム　--------------------- これを ------------------- 希望するプログラム　------------------- declare rec record; int1 integer; begin int1:=0; for rec in select * from kudamonouriage where syainid=$1 and kppw=$2 loop for i 1..40 loop if substr(rec.(i),1,3)='りんご' then int1:=int1+rec.(40+i); end if; end loop; end loop; return int1; end; ---------------- 以上希望のプログラム　--------------------- このようにしたいと思っています。 サイト上で色々と検索していますが、解決に至っていません。お力を貸していただけると大変助かります。宜しくお願いいたします。
Postgres9のconfigureで--disable-thread-safetyをセットした場合の影響について調べています。 マニュアルには -------------------------------------- クライアントライブラリのスレッドセーフを無効にします。これにより、libpqやECPGプログラム内 の同時実行スレッドは、安全にその固有の接続ハンドルを制御できなくなります。 -------------------------------------- と書かれています。 言葉の意味そのままだと、安全でなくなるように読み取れます。 JavaやPerlで作成したWebアプリからのDB操作を行なっていますが、 プログラム側で意図的にスレッドを作ったりはしていません。 このような環境で、--disable-thread-safetyにするのは何かしらの不都合が発生するのでしょうか？ どういった問題が起こりえるのかを知りたいです。 どなたかご存じの方がいらっしゃいましたらご教授願います。
Solaris10にpostgres9.0.5をインストールしようとしています。 Solarisには現時点での最新パッチが当たっている状態です(詳細はちょっと不明) 以下のオプションでconfigureを行うと、エラーになります。 ./configure --prefix=/usr/local/postgres --without-readline --enable-thread-safety 以下エラー --------------------------------------------------------------- checking thread safety of required library functions... no configure: error: thread test program failed This platform is not thread-safe. Check the file 'config.log' or compile and run src/test/thread/thread_test for the exact reason. Use --disable-thread-safety to disable thread safety. --------------------------------------------------------------- config.logの中のエラーの内容 --------------------------------------------------------------- configure:28765: checking thread safety of required library functions configure:28798: gcc -m64 -o conftest -O2 -Wall -Wmissing-prototypes -Wpointer-arith -Wdeclaration-after-statement -Wend if-labels -fno-strict-aliasing -fwrapv -pthreads -pthreads -D_REENTRANT -D_THREAD_SAFE -D_POSIX_PTHREAD_SEMANTICS -D IN_CONFIGURE conftest.c -lz -lnsl -lsocket -lm -lpthread -lpthread >&5 Undefined first referenced symbol in file sched_yield /var/tmp//ccVp73Io.o collect2: ld returned 1 exit status ld: fatal: symbol referencing errors. No output written to conftest configure:28802: $? = 1 configure: program exited with status 1 --------------------------------------------------------------- thread-safetyを無効にすれば正常にインストールできます。 このエラーを回避するにはどうすればよいでしょうか？ あまり参考にはならない情報かもしれませんが、9.0.4/9.1.1でも同様のエラーが出ます。
前回の質問を間違えて、解決済にしてしまいました。 前回の質問番号はQNo.7135032です。 改めて質問させて頂きます。 下記ファンクションにて実行してみたのですが、うまくいきません。 CREATE OR REPLACE FUNCTION raise_test(in i_data_num numeric, out o_data_num numeric, out o_data_char character varying) RETURNS integer AS 度重なる質問で、誠に申し訳ございませんが、手法をご教授ください。 よろしくお願いいたします。
Aというテーブルのaカラムが更新されれば、Bテーブルの列の中でAテーブルの列id含む列（複数）のbカラムをFalseからTrueに変更されるような、トリガー　と　プロシージャを作りたいのです。 考えていたのは、プロシージャは、 CREATE FUNCTION update_edit_b() RETURNS OPAQUE AS ' BEGIN （複数列指定？） NEW.b := 't'; RETURN NEW; END; ' LANGUAGE 'plpgsql'; プロシージャで、Bテーブルの複数列を指定するにはどうしたら良いでしょうか？ トリガーは CREATE TRIGGER trgger_a AFTER UPDATE OF a ON Table_a FOR EACH STATEMENT EXECUTE PROCEDURE update_edit_b ; こんな感じでしょうか？
お世話になります。 SQLからSQLを呼び出す形で以下のことを行おうとしています。 呼び出し元のSQLにRAISE文を記述し、フィールドの内容を表示させようとしているのですが、 SELECTで実行すると、「PERFROMに変更してください」とのエラーになってしまいます。 そこで、PERFORMに変更し実行しますと、RAISE文の結果が表示されません。 また、PERFORMのままで表示させるには、呼び出し先のSQLにRAISE文を記述すれば 良いようなのですが、呼び出し先のSQLに手を加えたくありません。 （呼び出し先のSQLをテストしているので・・・。） どなたか、うまく表示させる方法をご存知の方がいらっしゃいましたら、是非とも ご教授下さい。 よろしくお願い致します。
text.sql ---------------------------------------- update tbl_name set text = E'「あああああ」 いいいいい うううううう' where id = 1; ---------------------------------------- というSQL文を作成し、実行後、selectにてupdateしたデータを見ると、 　　　　　　　　　　text ---------------------------------------- あああああ\r いいいいい\r \r うううううう ---------------------------------------- というように、「\r」が表示された状態となります。 作成したSQL文に間違いがあるのでしょうか？ 使用しているDBの文字コード：UTF-8 改行コート：CR+LF になります。 よろしくお願いします。
初歩的な質問で申し訳ありません。 テーブルＡの中に、キー１が１００から１０９までのキーを持つレコードがあるかないかを調べるＳＱＬ文を教えてください。 テーブルＡ キー１　キー２ 100　　　1 100　　　2 105　　　1 107　　　1 上記の場合結果は 100　　有り 101　　なし 102　　なし 103　　なし 104　　なし 105　　有り 106　　なし 107　　有り 108　　なし 109　　なし と表示したいのです。 よろしくご教授ください。
約2万件のデータ読込み、帳票を作成してダウンロードする処理があるのですが、 最初のリクエストでの処理時間が３３秒もかかります。 しかし、続けて同じ処理をさせていると、3回目には８秒にまで短縮しました。 繰り返しているとDBアクセス処理が早くなるのはどうしてでしょうか？ 使っている言語は　Java DBソフトは　PostgreSQL　です。 よろしくご教授ください。
いつもお世話になっております。 標題についてご教授頂きたく質問させて頂きました。 [SQL} select A, B, count(*) as cnt from product where A=1 and cnt > 2 group by A order by cnt desc とこのようにSQLを記述して実行したのですが、 cnt>2でエラーが出ます。 order by には count　の別名を使用できるのですが、 where句やHAVINGでは使えません。 この場合 cont(*)>2 またはcount(項目名)>2 としなければならないのでしょうか
いつもお世話になっております。 サブクエリで複数項目を取得する方法をご教授下さい。 [既存] select 商品, 価格, (select user_id from user_master where user_id = 1 ) from products where 商品ID = 1 上記のようなSQLがあり、 user_masterから取得する項目をもうひとつ追加したいと思っています。(user_name) select 商品, 価格, (select user_id, user_name from user_master where user_id = 1 ) as user from products where 商品ID = 1 と修正したいのですが、当然エラーになってしまいます。 この場合は別にサブクエリを指定して取得した方がいいのでしょうか。 宜しくお願い致します。
以下のようなビットフラグのレコードが３レコードあるとして、 table name : bit_flg flg 　| name --------------------------- 0010 | ビットフラグ１ 0100 | ビットフラグ2 1000 | ビットフラグ3 このflgカラム全てのand結果(1110)がほしいのですが、どうすればよいでしょうか。 自分でグルグル回さず"SELECT hoge(flg) FROM bit_flg"のような感じでほしいのです。。 宜しくお願いします。
おせわになります。 早速ですが質問です。 -------------------------------------------------- 仮想PC(VMWare)側 CentOS 5.6 + PostgreSQL 9 実PC Win XP -------------------------------------------------- と言う環境で、ODBC接続のテストを行おうとすると、 「FATAL:no pg_hba.conf entry for host "xxx.xxx.xxx.xxx", user "xxx", database "xxx", SSL off」 と表示されます。 調べたところ"pg_hba.conf"に修正が必要とのことですが、"pg_hba.conf"なるファイルが見付らず、代わりに？"pg_hba.conf.sample"と言うファイルが存在します。 場所は"opt/postgreSQL/9.0/share/postgresql"です。 とりあえず、同じフォルダにコピーを作成してリネームし、"host all all xxx.xxx.xxx.xxx/xxx trust"の記述も追加しましたが、結果は変わらずでした。 そこで、 -------------------------------------------------- １．"pg_hba.conf"が見付らない時点で、何かおかしい（セットアップエラー？）のか？ ２．同じフォルダにコピーを作成してリネーム、"host all all xxx.xxx.xxx.xxx/xxx trust"の記述追加は正しいのか？ ３．２が正しいのであれば、ODBC接続テストでこのエラーが出る原因には何が考えられるか？ -------------------------------------------------- が解る方はおみえでないでしょうか？ 因みに、仮想PCのファイアウォールは無効にしてあり、実PCからのPingが飛ぶのも確認しております。 以上、よろしくお願いいたします。
Windows版のPostgreSQLを使用していますが、ブロックサイズをデフォルトの8Kから 変更をおこないたいと考えています。 UNIX版であればconfigureコマンドにて設定を行うようですが、 Windows版はどのように設定すれば良いのでしょうか？ ちなみにバージョンは9.0.5でWindows7の環境です。
WinXPにpostgresのodbc（psqlodbc_09_00_0310のpsqlodbc.msi）をインストールしたのですが、 管理ツールのデータ ソース (ODBC)にpostgresが表示されません。 HKEY_LOCAL_MACHINE¥SOFTWARE¥ODBC¥ODBCINST.INI¥PostgreSQL Unicode の中身を見たりして、値は確認していますが、 パスなど値はあってそうです。 通常psqlodbc.msiを実行するだけでodbcの中にpostgresは表示されるはずなのですが、 何か表示されない理由などは考えられますでしょうか？ （再起動も実行済み）
Windows7 psql9.0.5 環境のPostgreSQLにおいて psql実行時に空エンターを６，７回すると postgres=# 入力ファイルから読み込めませんでした: Not enough space \q 続行するには何かキーを押してください . . . のメッセージが表示され 強制終了されてしまいます。 何が原因と考えられますでしょうか？ ちなみにディスクはGB単位で空いておりますので問題無いかと思われます。
テーブルのカラムのデフォルト値に create table test(test integer default 0xffffff); というように１６進数を指定したのですが、 ERROR: syntax error at or near "xffffff" とエラーが発生していまいます。 １６進数を指定するにはどうすれば良いのでしょうか？
テーブル作成時、カラムにUNIQUEをつけると自動でインデックステーブルが作成されますが、このインデックステーブルで、通常のselect検索も早くなるのでしょうか？ 具体的には、ユニークなカラムidを持つテーブルtableA create table tableA( id INTEGER UNIQUE, some_column INTEGER ); を作ったあとで、そのidにあらためて CREATE INDEX id ON tableA (id); と、インデックスを張る必要があるのでしょうか。 よろしくお願いします。
下記のようなレコードがあります。 node_id_1 node_nm_1 node_id_2 node_nm_2 ------------------------------------- 00001　　　AAAA　　　　00002　　　BBBB 00003　　　CCCC　　　　00004　　　DDDD このレコードを元に下記のようなデータを別テーブルに挿入したいのですが、SQLで可能でしょうか id node_id node_nm ----------------- 1　　00001　　AAAA 1　　00002　　BBBB 2　　00003　　CCCC 2　　00004　　DDDD idはシーケンスで取得します。そして、同一レコードだったものには同じidを振ります。 DBはPostgreSQL 8.4です。
WEB APでデータベースを勉強中のものです． ユーザを管理するID番号をデータベースの連番IDではなく，文字列のIDにしたいのですが，どうすればいいでしょうか．PHP等で作成する方法でもいいです． 文字列IDにすると特定されにくいかなって思っています． 例えば A100001 C100002 です．
postgresの外部結合で質問です。 テーブルを複数外部結合する場合、 A（左）B(右)、 A（左) C（右）と外部結合する場合のSQLはよく載っているのですが A（左)B(右)で外部結合、 そしてさらに B（左）C（右）の外部結合のSQL例がなかなか載っておらず、見つけれません。 どなたか教えてください。
質問させてください。 SQLのJOINで複数の表をまとめる場合、以下のどちらの方法が一般的でしょうか。 A, B, C : 表 X, Y : 条件 表ごとにくぎる (A INNER JOIN B ON X) INNER JOIN C ON Y 条件ごとにくぎる A INNER JOIN B INNER JOIN C ON Y ON X 以上よろしくお願いいたします。
質問させてください PostgreSQLでは集約関数をネストできないのでしょうか。 以下の命令を実行すると「集約関数をネストできない」というエラーになります。 SELECT RCT_NO, MAX(SUM(BUYNUM)) FROM TRN_RECEIPT_DETAILS GROUP BY RCT_NO 実行環境はPostGreSQL 8です。 解決策をご存知でしたらお教えください。
現在mac上にVisualBoxでCentOSをいれており その中にPostgreSQLでDBを作成しました。 phpでpg_conect、何も表示されません。 エラーメッセージもなしです。 phpの保存場所は/var/www/htmlです。 エラーもなしなので場所が悪いのでしょうか？？ 初心者な質問ですいません。
データベースで表示算のような計算は可能ですか？ データベースで在庫数管理を行いたいのですが、集計方法がわかりません。Postgreで、以下のデータベースで計算可能な方法があれば教えてください。 データは日付と入出庫及び3/4時点での在庫数がわかった場合、 下記のテーブルをSQLなどで作成は可能でしょうか？ Excelだと簡単なのですが ------------------ 日付 入出庫 在庫 3/4 0 30 3/5 10 40 3/6 -5 35 3/7 -20 20 ----------------- 素案としては日付、ソート後、１つずつデータを取り出し、集計結果を在庫にUpdateする予定です。 アドバイスお願いします
データベースを勉強しているものです． 勉強の題材としてWEBアプリで予約システムみたいなものを作ってみているのですが，正規化したテーブルに対してデータを追加する際にどのようにすればいいのか悩んでいます． 予約tableと予約詳細tableを作り，予約IDで関係付けようと思っているのですが， 予約が入った際に予約tableのデータをinsertしてから予約詳細tableにinsertをすると思われます．このとき，予約詳細tableにデータをinsertする際に予約IDをどのように入れたらいいでしょうか． １．トランザクション開始 ２．予約IDを払い出し（WebAP上の変数で保持する） ３．予約tableに予約IDと登録するデータをinsert ４．予約詳細tableに予約IDと登録するデータをinsert ５．コミット これをやってしまうと予約IDが別のセッションで同じIDになってしまう恐れがあります． どうしたらいいでしょうか． 予約IDテーブルでも作って，払い出した際に，他のセッションに奪われないように作るなどの方法をとればいいのでしょうか．
質問させてください。 pg_restoreコマンドの-Cオプションって、何に使用するのでしょう？ ヘルプを読む限り、データベースを作成するとあるのですが、特に何か変化があるわけでもなく・・・。 -Cがあってもなくても動作は変わらないように感じています。 素人質問で大変申し訳ありませんが、どなたか回答をお願いしたいです。
質問させてください。 例えば、以下のコマンドを実行してpostgreSQLでリストアをするとします psql -h localhost -U postgres -d testdb この場合、testdbというDBを作成していないと、エラーになります。 DBまで自動的に作成するコマンドはありませんでしょうか。 psql、pg_restoreの両方でお聞きしたいです。
SoundMAXについて 僕のPCはnoteパソコンです。 それでマイク内臓で、ゲームをキャプチャーしたいのですが、 ゲームの音だけでやりたいのですが、そとの声が入ってしまいます。 ですから、実況しか使えません ゲームの音声だけで、captureする方法はありませんか
PostgreSQLでスーパーユーザー(管理者)が他のユーザー(利用者)のパスワードを閲覧する方法WindowsXPのPCにxampp(Apache+MySQL+PHP+Perl)を導入し、PostgreSQLも導入しました。 PostgreSQLに２人のユーザアカウントを作成しました。 postgreでデータベースにログインし、 alter rolg visitor with pssword 'test'; とすればvisiorのパスワードを変更できます。 しかしvisiorの現在のパスワードを閲覧する方法がわかりません。 教えてください
plpgsqlのエスケープ文字について教えてください tblのテーブルのnameフィールドの値をtitleフィールドに更新する関数を作成してます。 cur cursor for SELECT id, name FROM tbl; rec RECO RD; begin open cur; LOOP FETCH cur INTO rec; EXIT WHEM NOT FOUND; w_sql := ''UPDAT tbl SET title = ''; w_sql := w_sql ll '' ''''タイトル: '' ll rec.name ll '' '''' ''; w_sql := w_sql ll '' WHERE id= '' ll rec.id= '' ll rec.id ; EXECUTE w_sql; END LOOP; ・ ・ ・ ・ ・ 上記のようにnameフィールドの値をset句に設定していますが、 nameフィールドには 「90's」 や「men's」 のような値が入ったレコードがあるためエラーとなってしまいます。 name内の「'」をエスケープする為にはどのように書けばよいでしょうか 教えてください
PHPとPostgreSQLでサイト作ってます。HTMLのフォームタグを利用し、ユーザーが選択した画像(ユーザーのPC内のもの)をPostgreSQLで保存するにはどうしたらいいですか 教えてください
CentOS5.5×2 PostgreSQL8.4.4×2 リストア時にinvalid command \Nというエラーが出ます insertコマンドであれば普通に通るのですが、 出力ファイルが10G近くありダンプ+アップロード+リストアで一日半近く掛ってしまいます エディタで内容を確認しようにもファイルが大きすぎるため開けません どのようにすればリストアできますでしょうか
の中に CREATE TABLE EMP ( name text, salary integer, age integer, cubicle point ); INSERT INTO EMP VALUES ('Sam', 1200, 16, '(1,1)'); INSERT INTO EMP VALUES ('Claire', 5000, 32, '(1,2)'); INSERT INTO EMP VALUES ('Andy', -1000, 2, '(1,3)'); INSERT INTO EMP VALUES ('Bill', 4200, 36, '(2,1)'); INSERT INTO EMP VALUES ('Ginger', 4800, 30, '(2,4)'); -- the argument of a function can also be a tuple. For instance, -- double_salary takes a tuple of the EMP table CREATE FUNCTION double_salary(EMP) RETURNS integer AS 'SELECT $1.salary * 2 AS salary' LANGUAGE SQL; SELECT name, double_salary(EMP) AS dream FROM EMP WHERE EMP.cubicle ~= '(2,1)'::point; というコードが有るのですが 最後のWHERE EMP.cubicle ~= '(2,1)'::pointの ~= はどういうもので どんなときにつかうのでしょうか？ また単なる = ではエラーになるようなのですが=との使い分けはどのようにすれば良いのでしょうか? よろしくお願いします
次のような構造テーブルがあったとします。 create table sample_tbl ( no numeric(7) primary key, val numeric[] not null ) ※val列は 配列型。 テーブルの中身は次のような状態 no　　　　　val -------　---------------- 1　　　　　　{1,2,5} 2　　　　　　{1,3,4,5} 3　　　　　　{2} 4　　　　　　{1,5} 5　　　　　　{1,2,3,4,5} 6　　　　　　{1,5} 最終的に "val列" の中身の数値ごとの件数を知りたいです。 ＜欲しい結果＞ 1 → 5件 2 → 3件 3 → 2件 4 → 2件 5 → 5件 SQLのみを用いたできるだけ単純（一時テーブルなどを使わずに） 且つ高速な方法を探しております。 何か良い方法はありますでしょうか・・？ よろしくお願いいたします。
roleを使わないでuserばかり使っても 動いているようなのですが そもそもroleは何でしょうか？ roleはなんのためにあるのでしょうか？ userとroleの使い分けはどのようにするのでしょうか？ 以上どれでもいいのですが教えてください よろしくお願いします
PostgreSQL 8.4.8 文書にのっているサンプルプログラムの 例 30-1. libpq サンプルプログラム 1 #include <stdio.h> #include <stdlib.h> #include "libpq-fe.h" ・・・・・・・・・・・・・ をコピペしてコンパイルしたところ次のようなエラーがでました # gcc sample.c /tmp/cctZBolQ.o: In function `exit_nicely': sample.c:(.text+0xd): undefined reference to `PQfinish' /tmp/cctZBolQ.o: In function `main': sample.c:(.text+0x4a): undefined reference to `PQconnectdb' sample.c:(.text+0x5a): undefined reference to `PQstatus' sample.c:(.text+0x6a): undefined reference to `PQerrorMessage' sample.c:(.text+0xa5): undefined reference to `PQexec' sample.c:(.text+0xb5): undefined reference to `PQresultStatus' sample.c:(.text+0xc6): undefined reference to `PQerrorMessage' sample.c:(.text+0xed): undefined reference to `PQclear' sample.c:(.text+0x105): undefined reference to `PQclear' sample.c:(.text+0x119): undefined reference to `PQexec' sample.c:(.text+0x129): undefined reference to `PQresultStatus' sample.c:(.text+0x13a): undefined reference to `PQerrorMessage' sample.c:(.text+0x161): undefined reference to `PQclear' sample.c:(.text+0x179): undefined reference to `PQclear' sample.c:(.text+0x18d): undefined reference to `PQexec' sample.c:(.text+0x19d): undefined reference to `PQresultStatus' sample.c:(.text+0x1ae): undefined reference to `PQerrorMessage' sample.c:(.text+0x1d5): undefined reference to `PQclear' sample.c:(.text+0x1ed): undefined reference to `PQnfields' sample.c:(.text+0x20f): undefined reference to `PQfname' sample.c:(.text+0x26b): undefined reference to `PQgetvalue' sample.c:(.text+0x2a8): undefined reference to `PQntuples' sample.c:(.text+0x2ba): undefined reference to `PQclear' sample.c:(.text+0x2ce): undefined reference to `PQexec' sample.c:(.text+0x2de): undefined reference to `PQclear' sample.c:(.text+0x2f2): undefined reference to `PQexec' sample.c:(.text+0x302): undefined reference to `PQclear' sample.c:(.text+0x30e): undefined reference to `PQfinish' collect2: ld はステータス 1 で終了しました # # find /usr/include/ -name libpq*.h /usr/include/pgsql/internal/libpq-int.h /usr/include/pgsql/server/libpq/libpq-be.h /usr/include/pgsql/server/libpq/libpq.h /usr/include/pgsql/server/libpq/libpq-fs.h /usr/include/libpq/libpq-fs.h /usr/include/libpq-events.h /usr/include/libpq-fe.h # gcc -I/usr/include sample.c でもおなじです どうすればコンパイル出きるようになるでしょうか? よろしくお願いします
日頃はデザイン関連の作業担当なのですが、、、、 データの重複チェック方法で　 会員番号と店舗番号を入力するのですが　登録画面には //会員番号重複チェック if(Duplication_Check2("store_table","'".$kaiin_no."'",$tenpo_no)){ $err .= "会員NO「".$kaiin_no."」で店舗NO「".$tenpo_no."」は既に登録されています。<br />"; } としてまして、重複のエラー表示をさせています。 重複チェックの関数定義では //重複チェック2 function Duplication_Check2($kaiin_no,$tenpo_no){ global $db; $sql = "select * from store_table where kaiin_no='".$kaiin_no."' and tenpo_no=".$tenpo_no; $rst = pg_query($db,$sql); if($rst){ if(pg_num_rows($rst) = 0){ return true; }else{ return false; } }else{ return false; } } としたのですが　ここに文法エラーが出ます。 初心者の質問で恐縮なのですがどこをどうすればいいのでしょうか？ ご教授いただければ幸いです。
質問があります。 ・PostgreSQLで、oidを節約する方法はあるでしょうか(create tableでWithout OIDSを指定する以外に) ・oidはPostgreSQLが管理上使うらしいのですが、具体的にはどのぐらい消費するか、計算方法はありますでしょうか。 以下、経緯です。 PostgreSQLに大量のバイナリデータを含むデータを登録するようなシステムを作ろうとしています。現在Oracleで動作しているのですが、DBを置き換える計画です。 調べたところ、バイナリデータを入れられる型としてoidとbyteaがありました。 このうちoidは、データを直接レコードに入れるのではなく、データベース全体で一意の番号を使用してバイナリデータを管理するもののようでした。この「一意の番号」というのが4バイト(32bitOSなので)しかなく、さらにこの番号はPostgreSQLも管理上使用するようです。仮に半分がバイナリデータの識別に使えるとして、21億個までデータを入れられる計算です。 充分な数のようにも思いますが、昨今のHDD事情や(1個1KBとして21億個は約2TBです)、OracleのLOBロケーターはバイナリデータの識別だけで20バイト確保されていることと比べると、「4バイト-PostgreSQLの管理使用分」というサイズはどうも不安です。 この制約を回避するためbyteaを使うことにしました。 しかしPostgreSQLにはTOASTという仕組みがあり、データが大きいときは分割して別の仮想的なテーブルに入れられ、その管理には結局oidが使われるというではありませんか。しかもデータは2000バイトづつに分割されてそれぞれにoidが付くという「浪費」っぷりです。 有償DBと比較するのもいかがなものかとは思いますし、何事にも「無限」ということはないのですが、結局バイナリデータがどれだけ入れられるのかが知りたいです。 PostgreSQLは何にどのぐらいoidを消費するか、計算方法を教えてください。 あるいは、何か勘違いをしていましたらご指摘いただけますと助かります。
こんにちは。 現在アンケートサイトを作成しているのですが、チェックボックスを利用した質問の複数選択した回答をデータベースに登録できません。 htmlやphp、PostgreSQLに詳しい方指摘お願いします。 ※sample.html <form method="post" action="sample.php"> <b>7.あなたはどのような資格を持っていますか？</b><br> <input type="checkbox" name="sikaku[]" value="1" checked>ITパスポート <input type="checkbox" name="sikaku[]" value="2">漢字検定3級以上 <input type="checkbox" name="sikaku[]" value="3">英語検定3級以上 <input type="checkbox" name="sikaku[]" value="4">自動車運転免許 <input type="checkbox" name="sikaku[]" value="5">簿記 <input type="checkbox" name="sikaku[]" value="6">宅建 <input type="checkbox" name="sikaku[]" value="7">TOEIC600点以上 <input type="checkbox" name="sikaku[]" value="8">その他<br><br> <input type="submit" name="OK" value="OK"> </form> ※sample.php <?php //htmlから"sikaku"を取得 $sikaku = $_REQUEST["sikaku"]; //dbに接続・dbに書き込みSQL文 $dbconn = pg_connect ("dbname=****** user=********"); $result = pg_query ($dbconn, urldecode("insert into sample03 values('$sikaku');")); //接続を閉じる pg_close($dbconn); ?> ※PostgreSQL(table : sample03) //テーブル作成 ********=> create table sample03( ********(> 資格 int); CREATE TABLE //権限 ********=> grant select on sample03 to ********; GRANT //テーブルの表示 ********=> select * from sample03; 資格 ------ (0 rows)
ちょっと躓いてしまったのでアドバイスが頂けたらと思います。 user_accountというテーブルと、logというテーブルがあります。 logというテーブルには各ユーザーの書き込み履歴が残されており、日付がtimestamp形式で格納されています。 ユーザー一覧に最終発言内容をくっ付けて表示したいのですがうまくいきません。 SELECT DISTINCT * FROM user_accounts LEFT JOIN (SELECT * FROM log ORDER BY update_date DESC ) aaa ON user_accounts.pkey = aaa.user_accounts_pkey; などと記述してみましたが、思うような結果になりません。 自分の理想とする結果は以下のような出力結果です。 +----+----+----+--+-----------------+----------------+-----------+ |　pkey|　user|　pass|　　　　　　comment|　update_date| +----+----+----+--+-----------------+----------------+-----------+ |　　1　|　test1|　pass01|test03 written by test1|　40813| |　　2　|　test2|　pass02|testestest　　　　　　　　|　40690| どうか、お知恵を貸してください。
現在アンケートサイトを作成しているのですが、チェックボックス型のアンケートサイトから数値データをデータベースに登録し、そのデータをエクセルにインポートしてグラフを利用してデータの統計・分析を行いたいと思っています。 そこで、ODBCを使ってデータをインポートしようと思っているのですが、データベースが大学のサーバーであるため、どのように設定したらよいのかわかりません。 外部サーバーにあるデータベースにODBCを使用することは可能なんでしょうか？
　フルバキュームは、何度かに分けることが出来るのでしょうか？ 　テスト用にデータベースを作っているのですが、テストのしすぎで重くなってしまいました。 　ググるとフルバキュームをかけると良いとのことで、かけてみたところ、丸１日たっても終りません。 　で、ふと疑問に思ったのですが、 フルバキュームをする→途中で止めた場合、途中で止めるまでの部分は有る程度有効なのでしょうか？ 　windowsのデフラグの場合、途中で止めても途中まではデフラグされているので、再開した場合、最初からやった時より少しは早く出来たと記憶しています。 　バキュームの場合も同じようなイメージなのでしょうか？ 　初歩的な質問で恐縮ですが、お詳しいかた、教えていただけると助かります。
PostgreSQLをエクセルに連携し、データベースのデータをエクセルにインポートして、分析を行いたいと思っているのですが、ODBCを使わずにエクセルと連携でないでしょうか？ なぜならば、現在使用しているデータベースは大学のサーバーにあるので、ODBCをインストールできないからです。 以前、TeraTermからSSHを利用して、データをインポート・エクスポートすることができたのですが、これを利用してエクセルと連携できないでしょうか？
こんばんは、いつもお世話になっています。 現在アンケートサイトを作成しており、phpのページからチェックボックスでチェックしたデータを数値データとしてPostgreSQLに登録しております。 そこで、エクセルを使用して、PosegreSQLに登録された数値データから円グラフや棒グラフを使って、データの分析・統計をとりたいと思っています。 PostgreSQLとExcelを連動させることは可能なのでしょうか？
現在アンケートサイトを作成しているのですが、アンケートのデータを利用して円グラフや棒グラフを使って統計などを調べたいと思っています。 そこで、php作成されたアンケートのページからラジオボタンやチェックボックスでチェックされたデータをデータベース（PostgreSQL)に登録する際、valueの値を文字情報でデータベースに登録するほうが良いのか、数字情報で登録したほうが良いか教えてください。 ※数字 <input type="radio" name="sample" value="1">長野県 <input type="radio" name="sample" value="2">東京都 <input type="radio" name="sample" value="3">神奈川県 ※文字 <input type="radio" name="sample" value="長野県">長野県 <input type="radio" name="sample" value="東京都">東京都 <input type="radio" name="sample" value="神奈川県">神奈川県
PostgreSQL でレプリケーションを構築予定（非同期）ですが、 PostgreSQL 9.0 の組み込みレプリケーションか、pgpool-II のレプリケーションかで迷っています。 それぞれを比較した際の長所と短所は何になるのでしょうか？ また、PostgreSQL 9.0 は安定していてエンタープライズ用途でも問題ないのでしょうか？ 本番サーバ１台、待機サーバ１台の２台体制です。 よろしくお願い致します。
SELECT MAX(CASE WHEN fld IS NULL THEN 0 ELSE fld END) FROM tbl ; tblテーブルのfldの最大値を取得するSQLを作りたいのですが、tblテーブルにレコードが登録されていない時に「０」を出力したいと思っています。 上記のSQLだとレコードが０の場合はfldの値がないため、０を出力してくれません。 どのように修正すればレコード０件のときに「０」を出力してくれるでしょうか。 宜しくお願いします。
ERROR: direct correlated subquery unsupported as initplan 上記エラーはどういう意味ですか？
postgresql 8.3のドキュメントを探していますが、どうしても９のところに行ってしまいます。 ダウンロードできるＵＲＬがあれば教えて下さい。
現在、自宅から大学へ接続し、TeraTermからPostgreSQL8.1.23を利用しています。 なので、自宅のプログラムファイルの中にはpgsqlというファイルがありません。 そこで、作成したテーブルを自宅のPCでエクスポートしたいのですができません。 <インポートを実行した場合> a=>\copy example from import.txt; \. と表示され、なぜか違うテーブルのデータが増える。 <エクスポート> a=>\copy example to export.txt; a=> なにも表示されず、デスクトップに用意したexport.txtには、データが書き込まれません。 この場合、import.txt・export.txtのファイルがデスクトップにあるからいけないのでしょうか？
Red Hat Enterprise Linux 6.0 上で postgresql を使用したいと考えていますが、 「postgresqlの各バージョンにおける対応OSのバージョン」の情報が見当たりません。 NPO法人 日本PostgreSQLユーザ会のサイトも見ましたが、それに関する記載は みつかりませんでした。 Red Hat Enterprise Linux 6.0 上で使用可能な postgresql のバージョンを 知りたいのですが、その情報が記載されているサイト等をご存じでしょうか？
PostgreSQLのanalyzeについてですが。 [TABLE]の統計情報を再取得する為に 　analyze TABLE; と実行した場合。 該当のテーブルへの影響というのは全く無いものなのでしょうか。 （同じタイミングでアクセスしたselectが遅延してしまう等）
たとえば以下のようなteamtblテーブルで チームに所属する人物をカンマ区切りでnameに登録してある場合 id | team | name ------------------------------------ 1 | teamA | yamada,kobayasi,hayasi 2 | teamB | kobayasi,takizawa,komori 3 | teamC | takizawa,moriyama 4 | teamD | mori,yamada,kobayasi 「mori」さんが所属するチームのSELECTはどのようにしたらよいでしょうか？ SELECT * FROM teamtbl WHERE name LIKE '%mori%' とした場合、「komori」「moriyama」がいるteamB、CまでSELECTされてしまいます。
こんにちは。 いつもお世話になっております。 SQLにて、配列のフィールドに指定した値が含まれているものを抽出する方法を質問致します。 SQLのテーブル(テーブル名：data)に配列のフィールド(フィールド名：array[])があるとします。 Array[]フィールドの中に、1, 2, 6のいずれかが含まれている場合表示対象となるSQL文を書くには、どのように書けばよいですか。PostgreでSQL文を書くとします。 実現したい動作は以下の通りです。 array[] の値 {1,3,5} 表示対象になる {3,8,9,10} 　表示対象にならない {2,6} 表示対象になる 以上よろしくお願い致します。 ちなみに、array[]フィールドの中に、2（指定した数値が1つだけ）を探すとき、 select * from data where 2=any (array); とすればいいことは確認できました。
ちょっとタイトルとはズレているかもしれませんが、 Postgresのデータを冗長化する上での質問です。 サーバが2台あり、１台を本番機とし、もう1台を待機用とします。 本番機にarchive_commandで待機用のサーバのディレクトリを設定します。 【質問１】 ログファイルが貯まっていくと思いますが、 こちらはログが16MBになるまで掃き出されないのでしょうか？ その場合、本番機が消滅した場合、１６MB分のログがなくなる可能性があるという事でしょうか？ 【質問２】 前提：本番機のログファイルを自作シェルで待機用のサーバへコピーします。この間隔を1分にします。 上記の場合、最悪1分以内のデータまで冗長化されると思います。 1分以内にログが16MB以上貯まるようなシステムでなければ、archive_commandによる冗長化は 必要ないのではないでしょうか？ 必要性があれば、教えてください。 Postgresのバージョンは8.3.x でお願いいたします。
以下のような(1)と(2)のxml型を値を持つレコードがある場合にbの中でcとdが両方1の場合だけ検索（(１)のレコードだけが欲しい）するようにはどのように問い合わせればば良いでしょうか？ (1) <a> 　　　<b><c>1</c><d>1</d></b> 　　</a> (2) <a> 　　　<b><c>1</c><d>0</d></b> 　　　<b><c>0</c><d>1</d></b> 　　</a> 自分で考えた問い合わせだと（１）と(2)の両方のレコードが返ってきてしまいます。 select * from test where 　　'1'=ANY(xpath('/a/b/c/text()',xml)::text[]) 　　AND '1'=ANY(xpath('/a/b/d/text()',xml)::text[])
例えば、名前、出身県、現住所　のような表があります。 出身県と現住所は県名マスターを参照したいのですが、 select (名前、　県名マスター.県名　as 出身県、　県名マスター.県名　as 現住所　from 人名表 p　left join 県名マスター k on p.出身県　=　k.コード) left join 県名マスター on p.現住所　=　k.コード； としたのですが、出身県も現住所も同じになってしまいます。 どのような結合が良いのでしょうか？ 　
質問させてください。 PostgreSQL + pgAdminをインストールしました。 postgresql.confを編集しようとしましたが、「他のプロセスが使用中」というエラーが出て編集できません。 PostgreSQLのサービスは停止させています。 環境はWindows7です。 どなたか対策をご存じないでしょうか。 よろしくお願いします。
postgres9.0.4でEUCでinitした環境があります。 initdb --encoding=EUC_JP そこにUTF8のDBを作成したいのですが、以下のようなエラーがでます。 psql -U postgres postgres=# CREATE DATABASE dbname postgres-# WITH ENCODING='UTF8' postgres-# OWNER=dbowner postgres-# CONNECTION LIMIT=-1; ERROR: encoding UTF8 does not match locale ja_JP.eucJP DETAIL: The chosen LC_CTYPE setting requires encoding EUC_JP. 既に運用が始まっているEUCのDBが稼動している状態です。 EUCで初期化したところに後からUTF8のDBを作成する方法はないのでしょうか？
お世話になります。 現在、重複データを省いて集計する方法を考えているのですが、実現できておりません。 実現できるSQLをご存知の方、いらっしゃいましたら情報を頂けますでしょうか。 # 私の使用しているのは、PostgreSQL8.3となります。 実現したい内容は、以下となります。 　・テーブルAからID単位で人数を集計。　※但しファイル名が同じ場合は、1つとして集計する。 　　group by句でID,ファイルをグループ化してみたのですが、うまくいきません。 　　　【テーブルA】 　　　ID　　ファイル　　人数 　　　0001　aaa.txt　　3 　　　0001　aaa.txt　　3 　　　0001　aaa.txt　　3 　　　0001　bbb.txt　　3 　　　0001　bbb.txt　　3 　　　0001　bbb.txt　　3 　　　0000　ccc.txt　　3 　　　0000　ccc.txt　　3 　　　0000　ccc.txt　　3 欲しい結果は、以下となります。 　　　　ID　　集計 　　　0000 3 　　　0001 6 お手数お掛け致しますが、ご教示のほどよろしくお願い致します。
書籍にLinux（RedHat8.0）、PostgreSQLのユーザ名とデータベース名とを同一にするように記載されていました。このため、"database_6"というもの作成しました。ところが、テーブル作成、テーブル確認には、データベース接続後、所定のコマンドを実行することで問題はありませんでしたが、インポート時には、 ERROR: could not open file "/home/database_6/database_euc_4.csv" for reading: 許可がありませえん とエラーメッセージが表示されます。そこで、アクセス権限を調べると、 -r-xr-xr-x 1 database_6 database_6 113166 6月 5 19:37 database_euc_4.csv これは、Linuxの"database_6"であって、PostgreSQLの"database_6"ではないと考えられます。どのようにすれば、アクセス権限を変更できるでしょうか？ここでは、同一名称にしたことが、仇になっているようです。こうならないようにするために、同一名称にするのかと思っていましたが…。 ちなみに、database_6のOwnerは"postgres"になっています。"postgres"にアクセス権限を与えるのも1つの方法かと思いますが、インポートを実行しようとすると、 -bash: COPY: command not found とエラーメッセージが表示され、パスが通っていないようです。これは、~/.bash_profileが上手く読み込まれていないということでしょうか？
csvデータをインポートするためにデータベース"database_6"を作成し、"create.sql"というファイルをユーザ"database_6"のホームディレクトリ"database_6"に配置した後、"database_6"でログインして、下記コマンドを実行し、テーブル"music"を作成しようとしたところ、 $ psql -e -f create.sql bash: psql: command not found というエラーメッセージが表示されます。なお、PostgreSQLは自動起動設定されています。"database_6"のOwnerは"postgres"で、下記の書籍に記載された方法（別の方法は何も記載されていない）でデータベース"database_6"を作成しました。 $ createdb database_6 で作成しまいた。そこで、同じく下記の書籍に記載された方法（別の方法は何も記載されていない）でユーザ"database_6"を作成しました。 $ createuser -d -A database_6 なお、ユーザ"postgres"を用いた場合には、 FATAL: database "postgres" does not exist というエラーメッセージが表示されます。
RedHat8.0にpostgresql-7.2.3.tar.gzをインストールしています。database_6に接続し、 database_6=# COPY tablename FROM '/var/test/testdata.csv' WITH CSV; を実行すると（tablenameとtestdataとは同一名にしてあります）、 ERROR: parser: parse error at or near "csv" と表示されてしまいます。どこが悪いのでしょうか？
$ /usr/local/pgsql/bin/postmaster -D PGDATA を実行すると、 database system is ready と表示されますが、 # rpm -qa|grep postgres を実行すると、何も表示されません。PostgreSQL7.2.3はインストールされているといえるのでしょうか？
PostgreSQL7.2.3インストール後、 $ /usr/local/pgsql/bin/initdb を実行したところ、 You must identify where the data for this database system will reside. Do this with either a -D invocation option or a PGDATA environment variable. と表示されます。これは、.bashrcで追加した下記内容が読み込まれていないからでしょうか？ POSTGRES_HOME=/usr/local/pgsql export PATH="$PATH":/usr/local/pgsql/bin export PGLIB=$POSTGRES_HOME/lib export PGDATA=$POSTGRES_HOME/data export MANPATH="$MANPATH":$POSTGRES_HOME/man 上記オプションはどちらを選べばよいでしょうか？また、PGDATAの場合、"-"なしでそのままPGDATAでしょうか？
RedHat8.0にPostgreSQL7.2.3をインストールしましたが、下記コマンドで初期化できません。 $ initdb -bash: initdb: command not found なお、PostgreSQL7.2.1をインストールしていましたが、その際は初期化できていました。ただし、テキストエディタでpostgresql.conf、pg_hba.confを編集するため、開こうとしましたが、開けませんでした（ファイルが表示されない）。ファイルを検索すると、/usr/local/pgsql/data/にあることになっていましたが…。アクセス権限の問題と考え、postgresでログインしようとしましたが、パスワードの初期設定が分かりませんでした。今回、Windows上で作成したPHPプログラムの動作を検証するため、テスト環境を構築しようとしています。インストールしたApache1.3.27、PHP4.2.2に合わせて、バージョンを更新しました。アンインストールし、インストール前に $ make check で All 79 tests passed. であることも確認しています。
トリガを実行したときに、処理部分のfunctionで更新されたデータの値を取得したいと考えております。 NEW変数を使い、 NEW.[フィールド名]とすれば取得できるのは知っているのですが、 この[フィールド名]にfunction内で取得した項目名を指定するにはどうしたら良いのでしょうか？ 仮に取得したいフィールド名が「sample_id」だった場合、 functionの中でNEW.sample_idとすれば取得できます。 が、今回考えていたのは以下のような処理の場合です。 記述イメージなので間違っているかもしれませんが、、、 begin for rec in SELECT att.attname 　　　　　　　　FROM pg_attribute as att 　　　　　　　　INNER JOIN pg_class as class ON class.oid = att.attrelid 　　　　　　　　WHERE att.attnum > 0 　　　　　　　　AND class.relname='テーブル名' 　　　　　　　　ORDER BY att.attnum 　loop 　insert into 'テーブル名２' values(NEW.rec.attname); loop end end; ループでテーブル内の項目を取得し、取得した項目の値をテーブル名に入れるという処理です。 rec.attnameには「sample_id」と入っていたので、NEW.rec.sample_idとしたのですが、 実行したときにエラーになり、どうしてもinsertできません。 どうにかして、sample_idの値をinsertしたいのですがわかりません。 ご教授お願い致します。
# rpm -qa | grep postgresql を実行してみると、 postgresql-python-7.2.2-1 postgresql-odbc-7.2.2-1 postgresql-7.2.2-1 postgresql-perl-7.2.2-1 postgresql-server-7.2.2-1 postgresql-devel-7.2.2-1 postgresql-contrib-7.2.2-1 postgresql-libs-7.2.2-1 postgresql-jdbc-7.2.2-1 postgresql-tcl-7.2.2-1 が表示されたため、 # postgres start を実行すると、 "root" execution of the PostgreSQL server is not permitted. The server must be started under an unprivileged user id to prevent more information on how to properly start the server. と表示されます。そこで、本サイトのQ&Aを参考にして、 # /etc/init.d/postgresql start を実行したところ、起動しました。Windows版では、pgAdminIIIのクエリーツールで以下のようにすれば、csvデータ（UTF8）をPostgreSQLの所定のテーブルにインポートできます。 COPY tablename FROM E'C:\\test\\testdata.csv' WITH CSV; Linux版ではどのようにするのでしょうか？
YumでRed Hat 8.0（メモリ256MB、32ビット）にpgdg-redhat-8.0-5.noarch.rpmを下記手順に従ってインストールしようとしましたが、インストールできません。 1.共有メモリの設定確認（shmmaz：33554432、shmall：2097152） 2.Yumリポジトリの設定（http://yum.pgrpms.org/howtoyum.phpに記載された内容と実際の設定ファイルとに相異がありました） 3.installコマンドを指定して実行 3.でcommand not foundと表示されるため、# yum search postgresqlを実行しましたが、command not foundと表示されます。そこで、 # rpm -qa | grep postgresql を実行してみると、 postgresql-python-7.2.2-1 postgresql-odbc-7.2.2-1 postgresql-7.2.2-1 postgresql-perl-7.2.2-1 postgresql-server-7.2.2-1 postgresql-devel-7.2.2-1 postgresql-contrib-7.2.2-1 postgresql-libs-7.2.2-1 postgresql-jdbc-7.2.2-1 postgresql-tcl-7.2.2-1 が表示されます。このため、# yum -y install 'postgresql*'も試してみましたが、command not foundと表示されてしまいます。これは、64ビット版と32ビット版との違いによるものでしょうか？手元にある試料には、ソースコードからのインストール方法も64ビット版のものです。
お世話になります。 現在、最新レコードを抽出し外部結合するSQLを考えているのですが、実現できておりません。 実現できるSQLをご存知の方、いらっしゃいましたら情報を頂けますでしょうか。 # 私の使用しているのは、PostgreSQL8.3となります。 実現したい内容は、以下となります。 　１．テーブルＡから「名前」でグループ化して最新の「更新日付」のレコードを抽出。 　２．１の結果とテーブルＢを「名前」で結合。 　３．テーブルＡの「名前」、「点数」、「更新日付」とテーブルＢの「判定」を抽出。 　　　⇒ただしテーブルＡに情報がある場合は、テーブルＢの判定結果を「０」にして出力。 　　　　　テーブルＡ　　　　　　　　　　　　　　　テーブルＢ ----------------------------　　　----------------------- 　名前｜　点数｜　更新日付　　　　　　　名前　｜　判定　 ----------------------------　　　----------------------- ＡＡＡ　　　９８　　　2011/4/1　　　　　　　　ＡＡＡ　　　０　 ＡＡＡ　　　６０　　　2011/4/3　　　　　　　　ＢＢＢ　　　１　 ＢＢＢ　　　７０　　　2011/4/2　　　　　　　　ＣＣＣ　　　１　 ＢＢＢ　　　３５　　　2011/4/4　　　　　　　　ＤＤＤ　　　１　 ＤＤＤ　　　９８　　　2011/4/1　　　　　　　　ＥＥＥ　　　０　 ＥＥＥ　　　４７　　　2011/4/5　　　　　　　　 ＦＦＦ　　　０　 ＧＧＧ　　　８０　　　2011/4/6　　　　　　　　ＧＧＧ　　　１　 　 【出力結果】 --------------------------------------------- 　名前　｜　点数　　｜　更新日付　｜　判定　 --------------------------------------------- ＡＡＡ　　　　６０　　　　　2011/4/3　　　　 　０　 ＢＢＢ　　　　３５　　　　　2011/4/4　　　　　０（１⇒０に変更）　 ＣＣＣ　　　NULL　　　　　NULL　　　　　　　１　 ＤＤＤ　　　　９８　　　　　2011/4/1　　　　　０（１⇒０に変更）　 ＥＥＥ　　　　４７　　　　　2011/4/5　　　　 　０　 ＦＦＦ　　　　NULL　　　　　NULL　　　　　 　０　 ＧＧＧ　　　　８０　　　　　2011/4/6　　　　　０（１⇒０に変更） お手数お掛け致しますが、ご教示のほどよろしくお願い致します。
また質問させて頂きます。宜しくお願いします。 現在添付画像のテーブルイメージのように情報を取得したいのですが、 方法が思い浮かず投稿させていただいています。 取得したい階層のイメージは、添付画像ツリーイメージのようになる事を求めています。 要望としては、 ・PostgresSQL8.4で動作可能 ・なるべくSQLで解決したい ・SQLのクエリ発行数に関してはなるべく1回が良いですが別に2回以上でも使用可 (ただし、アプリケーション側でループ処理とかは無し。1000回ループとかありえるんで。。。) ・必要ならば一時テーブルの作成もあり お手数ですが、どなたか方法・アドバイス等お教え頂ければ助かります。
毎度お世話になっております。 今回はお客さまがOracleが高価で予算が取れないとの事で、9i+Veritas Cluster Serverで実現していた２台のサーバから共有ディスク上のDBにアクセスする方法を模索しております。 ACT-ACT構成で２台のサーバから共有ディスク上のDB（PostgreSQL）に具体的にアクセスするにはどのようなソフトウェア構成にしたら良いかご教示願います。 よろしくお願いします。
実運用中のテーブルに対し、日次で reindex を実行したところ、時々、デッドロックが発生してしまいます。 どうやら、reindex と update の間でデッドロックが起きているようです。 エラーメッセージを見た感じでは、以下の状態でデッドロックになっているように読めます。 ・update がテーブルのインデックスに対するロックを取得し、テーブルに対する RowExclusiveLock を取得しようとしている ・reindex がテーブルに対するロックを取得し、テーブルのインデックスに対する AccessExclusiveLock を取得しようとしている ※ 参考までに、update は select for update してから update しています。 Postgre のバグではないかと思うのですが、デッドロックを回避する方法はありますでしょうか？ （なるだけ、reindex を実行しているプロセスの方に手を入れることで対応できないかと思っています。例えば、reindexの前に事前にロックを取得する、とか・・・） よろしくお願い致します。
あるtextフィールドに '10010000' のように１と0で構成されたものがあります。 このフィールドにたいして、ソート（order by）を行いたいのですが、 何桁目が1のものを上位に、のようなソートを行いたいと思っています。 任意の桁の値だけ取り出せないかと、 型変換、フォーマットや算術演算を使ってみましたがうまくできませんでした。 たとえば '10010000' から5桁目の値　'1'　のみを取り出す方法です。 ソートで使用するのが目的です。 わかります方いらっしゃいましたら、よろしくお願いいたします。
得意先マスタと製品マスタがあり得意先コードで等価結合した場合 結果Ａのようになると思いますが、結果Ｂのような結果を得たい場合は、 どのようにSQLを書けばいいのでしょうか？ DBはIBM　DB2　V7ですが、postgresql 8.4での書き方も ご存知の方宜しくお願いします。 結果Ａ +----+-------+----+ |列 1　| 列 2 　　| 列 3 | +----+-------+----+ | A社　| A製品1 | A@1 | | A社　| A製品2 | A@2 | | A社　| A製品3 | A@3 | | B社　| B製品1 | B@1 | | B社　| B製品2 | B@2 | | B社　| B製品3 | B@3 | +-----+--------+--+ 結果Ｂ +----+-------+----+ |列 1　| 列 2 　　| 列 3 | +----+-------+----+ | A社　| A製品1 | A@1 | |　　　　| A製品2 | A@2 | |　　　　| A製品3 | A@3 | | B社　| B製品1 | B@1 | |　　　　| B製品2 | B@2 | |　　　　| B製品3 | B@3 | +-----+--------+--+
親,　　親在庫,　　子,　　子在庫,　　員数 ----------------------------------------- 製品A,　1,　　　部品A,　　　2,　　　　1 製品A,　1,　　　部品B,　　　1,　　　　1 部品A,　2,　　　部品a,　　　100,　　　10 部品A,　2,　　　部品b,　　　50,　　　 20 上記のような製品Aの構成部品と在庫を 管理しているテーブルから、各部品の所要量 を計算し、抽出するSQLで悩んでおります。 上記の場合、例えば製品Aを10台製作するための 各部品の所要量として、 親,　　親在庫,　　親所要量, 子,　　子在庫,　　員数,　　子所要量 ------------------------------------------------------------------ 製品A,　1,　　　　　10,　　　　部品A,　　2,　　　　1,　　　　9 製品A,　1,　　　　　10,　　　　部品B,　　1,　　　　1,　　　　9 部品A,　2,　　　　　9,　　　　部品a　　　100　　　　10,　　　70 部品A,　2,　　　　　9,　　　　部品b　　　50　　　　20,　　　140 という結果が抽出できるのが理想です。 子の所要量を計算するために、(親所要量 - 親在庫)を 動的に算出し、それを子の員数と乗算させる。 という処理を繰り返すイメージです。 なお、ここでいう員数とは、「親を1台製作するために必要な数」 という定義です。 相関サブクエリ、自己結合をつかって試しているのですが、 レコード毎に動的に上記の処理をさせることができずに 困っております。 ご教示の程、よろしくお願い致します。
本日から○日以内のレコードをセレクトしたいのですが ○日の部分が可変のためJavaのpreparedstatementを使用します。 例) SELECT timedate FROM testtb WHERE timedate BETWEEN current_timestamp + '-30days' AND current_timestamp; ※timedateはDATE型です のような事をしたいのですが、 「30」の部分を?にすると The column index is out of range: 1, number of columns: 0エラーになります。 intervalの使用も考え色々調べていたのですが、いまいちやり方が分かりません。 何か方法をご存知の方、ご教授お願い致します。
以下のフィールド構成のテーブルがあるのですが 「birthday」フィールドの値を元に、現時点の年齢を計算して 「nenrei」フィールドに入れたいと考えています。 【player_tbl】 id　　　　　ID name　　　名前 birthday　誕生日（19950203のような形式でデータが入っています） nenrei　　計算された年齢を入れる 以下のSQLを実行してもエラーになります。 update player_tbl set nenrei = extract(year from age(current_date, birthday)) ; SQL エラー: ERROR: function age(date, character varying) does not exist HINT: No function matches the given name and argument types. You may need to add explicit type casts. birthdayのところを工夫しないとダメだということは、なんとなくわかるのですが どのように変更すると実現できるのかわかりません。 age関数の中に、フィールド名を入れたい場合は、どのような記述になるのでしょうか？ また、データ数は１０万件くらいですが、一気に更新するのは難しいでしょうか？ DBはPostgreSQLです。 よろしくお願いいたします。
debian（バージョン6.0.0）でpostgresqlを入れたいのですが、 apt-getでインストールすると、バージョンが8.4.xになってました。 希望はpostgresqlのバージョンを8.3.1にしたいのですが、 aptサーバには8.4.x　以降のバージョンしかないみたいで困ってます。 過去のパッケージを拾ってきて　dpkg -i　で一つずつインストールしようと思いましたが、 「○○がインストールされていません」や、「依存関係が、、、」で進まない状態です。 どなたかdebian6.0.0環境で、過去バージョンを入れる方法を教えていただけないでしょうか。
now()の結果を返すだけの以下の２つのPL/pgSQLを試しに作りました。SQL１は正しく結果が返ってきますが、SQL２は結果が何も返ってきません。どなたか説明できる方、いらっしゃいますでしょうか。宜しくお願い致します。 ■SQL１ CREATE OR REPLACE FUNCTION select_now1() RETURNS date AS $$ DECLARE d_currentDATE:= NULL; BEGIN SELECT INTO d_current now(); RETURN d_current; END; $$ LANGUAGE PLpgSQL; ■結果１ select_now1 ------------- 2011-03-19 (1 行) ■SQL２ CREATE OR REPLACE FUNCTION select_now2(OUT d_current date) AS $$ DECLARE d_currentDATE:= NULL; BEGIN SELECT INTO d_current now(); END; $$ LANGUAGE PLpgSQL; ■結果２ select_now2 ------------- (1 行)
現在PostgreSQL(ver 8.4)を使ってちょっとしたシステムの構築を計画していますが、データベースの設計に関して広くアドバイスを頂きたいです。 ユーザーの入力データをDBで効率よく管理したいと考えています。 例えば、次のようなテーブルを作るとします。 userテーブル id | name ---+------------- 1 | 山田太郎 2 | 高橋次郎 .. | ............. .. | ............. emailテーブル id | address ---+------------------------------ 1 | yamada@mail.com 2 | takahashi@mail.com .. | ................................. .. | ................................. この様な複数のテーブルにユーザーの入力を受け、1対1に対応するIDを振って名前やアドレスなどのデータをリアルタイムで挿入していく場合、どのようなテーブルを用意し、プログラムを組むのが適切なのでしょうか？ 具体的には、PerlでCGIをつくり、ブラウザ上などからユーザーの入力したデータを取得してPostgreSQLに次々挿入していく形にしようとしています。 具体的なPerlのコードを書いていただけると助かるのですが、他の言語のコードでも一向に構いません。 今のところ、自分で考えたものとしては、 create table user( id serial, name text); create table email( id serial, address text); とテーブルを用意し、 Perlコードの概要は use DBI; # *実際にはユーザーの入力値から値を得る $input_user = 'name_hogehoge'; $input_email = 'address_hogehoge@mail.com'; # DBとの接続 $dbh = DBI->connect("dbi:Pg:dbname=hogehoge", ......); # プレースホルダの準備 $sth_user = $dbh->prepare("INSERT INTO user (name) VALUES(?)"); $sth_email = $dbh->prepare("INSERT INTO email (address) VALUES(?)"); # SQLの実行 $sth_user->execute("$input_user"); $sth_email->execute("$input_email"); # コミット $dbh->commit; といった感じで考えていました。しかしidの対応が確実に取れるかなど不安な点がありますので、アドバイスいただけたらと思います。 もちろんこの方法に固執する必要はなく、結果的に同じようなテーブルが得られれば問題ないです。 長々と失礼致しました。
PostgreSQL に初めて挑戦していますが、 PostgreSQL 9.0.3 のソースレベルから 32Bit版はできましたが (タスクマネージャーでみると postgres *32) ソースレベルからの64Bit版作成の方法がわかりません。 インストーラならあるのですが 色々な資料を見てみたのですが、回答が見つからず途方にくれています。 どなたか、ご存知の方がいたらご教授ください。 よろしくお願いします。
DBにはpostgresを使用していて、numeric(8,2)の様に定義した項目から VB.netのプログラムでOleDbDataReaderを使用して値を読み取るのですが .GetValueでは123.45 -> 123 という風に整数部分しか読み取れません。 試しに .GetValue(x).Tostringで出力してみたのですが、やはり小数部分が見あたりません。 直接コマンドで見る限り、テーブルには正しく小数以下も格納されています。 現在は、クエリで 100倍して.GetValueで読み込んだ後に100で割っていますが 直接読み込むメソッドがありましたらご教授願います。
以下のようにバックアップ後、リストアし、ODBCを利用し、ACCESSでレコード追加したところ、再度、リストアしようとするとエラーが出て、復元できません。 (1)バックアップ sudo -u test pg_dump -O testdb > /home/test/test-back-1.dmp (2)リストア sudo -u test dropdb testdb sudo -u test createdb -EEUC_JP testdb sudo -u test psql -e testdb < /home/test/test-back-1.dmp (3)ODBCを利用し、ACCESSの追加クエリでtbl_tensuのレコードを追加 (4)再度、リストア sudo -u test dropdb testdb sudo -u test createdb -EEUC_JP testdb sudo -u test psql -e testdb < /home/test/test-back-1.dmp 以下のようなエラーが、レコード追加したテーブルも何もしていないテーブルにも出てしまい、正しく復元できません。 ALTER TABLE ONLY tbl_tensu ADD CONSTRAINT tbl_tensu_primary_key PRIMARY KEY (hospnum, srycd, yukostymd, yukoedymd); ERROR: multiple primary keys for table "tbl_tensu" are not allowed CREATE INDEX idx_tensu_formalname ON tbl_tensu USING btree (formalname); ERROR: relation "idx_tensu_formalname" already exists CREATE INDEX idx_tensu_kananame ON tbl_tensu USING btree (kananame); ERROR: relation "idx_tensu_kananame" already exists CREATE INDEX idx_tensu_kensagrp ON tbl_tensu USING btree (hospnum, srykbn, knsjisgrpkbn); ERROR: relation "idx_tensu_kensagrp" already exists CREATE INDEX idx_tensu_name ON tbl_tensu USING btree (name); ERROR: relation "idx_tensu_name" already exists 何が原因でどうすれば、復元したときにエラーが出なくなるでしょうか？ どなたか、わかる方ご教示ください。 よろしくお願いします。
Autovacuumを"ON"にして運用していますが、最近アクセスが遅くなっているような気がします。 Vacuumも定期的に実施することが望ましいのでしょうか。 Autovacuumを"ON"であれば、違ったことが原因なのでしょうか。
Postgresql8.1とAccess2003にて販売管理システムを構築しております。 データベースサーバーは会社に設置しており 自宅からPgAdmin1.10にて接続し管理などを行っております。 サーバーにはA、Bと同じ構成をしたデータベースが存在しています。 PgAdminからAのテーブルにSQLを実行したところ タイムアウトなのか無限ループに陥ったのか、エラーでSQLの処理が止まってしまい PgAdmin毎落ちました。 仕方なく、再度PgAdminからAのデータベースに接続しようとすると 「could not receive data from server: Software caused connection abort(0x00002745/10053)」 とエラーが表示され、その後一切の接続できなくなりました。 PgAdminの再インストールや、PC・ネットワーク環境を変えたりしましたが どの方法でもA、Bともに接続不可となってしまいました。 そこでサーバー自体の再起動を行いましたところ アプリケーション（Access）からAのデータベースに接続することができ データの読み書きも問題なく出来ました。 また、PgAdminを使った場合も外部から接続するのではなく 同じローカルネットワーク内から接続すると問題なく A、Bのデータベースに接続でき、テーブルの参照やレコードの編集、 VACUUMやバックアップ(pg_dump)も可能でした。 ここでまず一つ目の質問ですが、 このA、Bのデータベースは、破損している状態でしょうか？ もしくはPostgreSQL毎破損している状態でしょうか？ PgAdminから出力できるレポートで該当テーブル全体の統計情報を見ると タプルの挿入や更新などがすべて「0」で表示されます。 （サイズだけは計算されて、恐らく実データ量だと思われるバイト数が表示されていました） 二つ目の質問ですが、 Aのデータベースの状態が”壊れている状態”だとしたら、すぐにでも バックアップを取り、新しくデータベースを作り直してリストアしたいと考えていますが バックアップ前のデータベースとリストア後のデータベースを比較して、 レコードがすべてリストア出来ているかを確認したいのですが どのような方法で確認できますか？ 例えば全テーブルのレコード数一覧などを出力し比較出来る事が望ましいですが 前述のテーブルの統計情報レポートでは、まともに数字が表示されないので 困っております。 （なお、アーカイブ形式のバックアップだと一部テーブルのレコードが一切復元されない という現象が発生した為、プレーン形式でのバックアップを考えています。 プレーン形式で書き出して中身を見たところ、問題のテーブルのレコードも はき出されておりました。（これも、"破損"と考えた要因の一つです）） 現状、アプリケーションからの利用だけで言えば、特段問題がありませんが やはり気持ちが悪く、出来る限り修復（or再構築）を行いたいと考えています。 詳しい方、アドバイスなどあれば是非教えてください。 宜しくお願いいたします。
PostgreSQL内のテーブルをCOPYコマンドを使ってCSVにエクポートしようと思っています。 データのエクスポートは出来るのですが、二重引用符の付加が出来ません。 copy TBL1 to 'd:/TBL1.CSV' with delimiter ',' csv quote '"' 《CSVデータの内容》 001,あいうえお "001","あいうえお" ←　この様に二重引用符を付加したいです。 どうすればいいでしょうか？ ご教授いただきたく思っております。 よろしくお願いします。
PostgreSQL8.2シリーズを利用しています。 事情によりVacuumFullが行えないのですが、ここ最近、レスポンスの低下が顕著になってきました。 そこで現在のDB断片化の状況を知りたいと考えているのですが、何か方法はございますでしょうか？ もしご存知でしたら、ぜひアドバイスを頂ければと思います。
部品, 購入数パターン, 原価 ------------------------- A　　　　100　　　　　　　100 A　　　　200　　　　　　　98 A　　　　300　　　　　　　90 B　　　　100　　　　　　　200 B　　　　200　　　　　　　180 上記の様な部品の購入数パターン毎の原価を管理している テーブルに対し、理想原価を抽出したいのですが、 SQLでどのように実現したらよいか悩んでおります。 使用しているDBはpostgres 8.4です。 具体的な例を挙げますと、 部品Aの購入数が、 (1)100未満の場合、購入数パターン100とみなし原価100円とする (2)200の場合、購入数パターン200とみなし原価98円とする (3)210の場合、購入数パターン300とみなし原価90円とする (4)300超過の場合、購入数パターン300とみなし原価90円とする 以上、ご教授の程よろしくお願い致します。
カテゴリと個別商品の集計SQLについて質問です。 postgresのバージョンは9.0です。 次のテーブルより ------------------------------------------ id　　カテゴリ　　商品名　　　　日付　　　　　　　値 ------------------------------------------ 1　　野菜　　　　ホウレン草　　2010-01-01　　100 2　　野菜　　　　ホウレン草　　2010-01-02　　100 3　　野菜　　　　ホウレン草　　2010-02-02　　100 4　　野菜　　　　キャベツ　　　　2010-01-02　　200 5　　肉　　　　　　牛肉　　　　　　2010-01-01　　500 6　　肉　　　　　　牛肉　　　　　　2010-01-02　　500 -------------------------------------------- 下の結果を得るSQLを考えています。 月毎の値の集計 カテゴリ　　商品名　　　　　1月　　2月　　　　合計　　　カテゴリ合計　　カテゴリ合計と合計との差 ----------------------------------------------------------------------------- 野菜　　　　ホウレン草　　　200　　100　　　　300　　　　500　　　　　　　　200 野菜　　　　キャベツ　　　　 200　　　　0　　　 200　　　　500　　　　　　　　300 肉　　　　　　牛肉　　　　　　1000　　　0　　　　1000　　　1000　　　　　　　　　0 ----------------------------------------------------------------------------- ここでカテゴリの合計とは　上の場合、 ホウレン草(300)＋キャベツ(200)=カテゴリ野菜(500)、です。 クロス集計とサブクエリを使えば出来そうなのですが、カテゴリ合計を出す部分の SQLが思いつきません、よろしくお願い致します。
いつもお世話になっております。 前提として、環境は、VMWareの中に、CentOS5があり、PostgreSQL8.4で、 文字コードはEUC-JPをinitdbしています。 今回、WindowのExcelでCSVを、PostgreSQLのCOPYコマンドでインポートできるかを検証しているのですが、下記のような形で、copyコマンドを実行しますと、 結果、UTF-8ですと、文字化けしていませんが、EUC-JPですと、文字化けしてしまいます。 デフォルトのDBのエンコードのEUC-JPで、SELECTの結果が文字化けしてほしくないのですが、どこか、間違っているところありますでしょうか。 お手数をおかけしますが、なにとぞご教授よろしくお願い申し上げます。 [foo@localhost ~]$ psql test psql (8.4.6) Type "help" for help. test=> \encoding SHIFT-JIS test=> \copy shinamono from /tmp/Book1.csv with csv test=> select * from shinamono; hinmei | nedan ---------------------+------- ・スンゑソス・ス・ス | 100 ・ス・ス・ス・ス・ス・ス | 150 ・ス・ス・ス・ス・ス・ス | 2500 ・ス`・ス・ス・スR・ス・ス・ス[・スg | 100 ・ス・ス・ス・ス・ス・ス,・スネゑソス・スフセ・スb・スg | 5000 ・スワつゑソス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 ・ス`・ス・ス・スR・ス・ス・ス[・スg | 100 ・ス・ス・ス・ス・ス・ス,・スネゑソス・スフセ・スb・スg | 5000 ・スワつゑソス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 ・ス`・ス・ス・スR・ス・ス・ス[・スg | 100 ・ス・ス・ス・ス・ス・ス,・スネゑソス・スフセ・スb・スg | 5000 ・スワつゑソス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 (12 rows) test=> \encoding EUC-JP test=> select * from shinamono; hinmei | nedan ---------------------+------- ・ス゜、・ス・ス・ス | 100 ・ス・ス・ス・ス・ス・ス | 150 ・ス・ス・ス・ス・ス・ス | 2500 ・ス・ス・ス逾ウ・ス・シ・ス・ス | 100 ・ス・ス・ス・ス・ス・ス,・スハ、・ス・スΥ・ス・スa・ス | 5000 ・ズ、ト、・ス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 ・ス・ス・ス逾ウ・ス・シ・ス・ス | 100 ・ス・ス・ス・ス・ス・ス,・スハ、・ス・スΥ・ス・スa・ス | 5000 ・ズ、ト、・ス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 ・ス・ス・ス逾ウ・ス・シ・ス・ス | 100 ・ス・ス・ス・ス・ス・ス,・スハ、・ス・スΥ・ス・スa・ス | 5000 ・ズ、ト、・ス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 (12 rows) test=> \encoding UTF-8 test=> select * from shinamono; hinmei | nedan ---------------------+------- みかん | 100 りんご | 150 メロン | 2500 チョコレート | 100 メロン,なしのセット | 5000 まつたけ すだち | 10000 チョコレート | 100 メロン,なしのセット | 5000 まつたけ すだち | 10000 チョコレート | 100 メロン,なしのセット | 5000 まつたけ すだち | 10000 (12 rows)
以下のOSに PostgreSQL 8.4.5 をインストールしようと考えています。 ----------------------------------------------------------------------------- OS：Red Hat Enterprise Linux ES release 4 (Nahant Update 6) ----------------------------------------------------------------------------- ソースからインストールしようと重い、configureを実行したところ、以下のエラーで 停止してしまいました。 ----------------------------------------------------------------------------- $ ./configure --prefix=/usr/local/pgsql checking build system type... i686-pc-linux-gnu [中略] checking if gcc supports -fwrapv... yes checking whether the C compiler still works... yes checking how to run the C preprocessor... /lib/cpp configure: error: C preprocessor "/lib/cpp" fails sanity check See `config.log' for more details. ----------------------------------------------------------------------------- gccバージョンは以下となります。 ----------------------------------------------------------------------------- gcc バージョン 3.4.6 20060404 (Red Hat 3.4.6-9) ----------------------------------------------------------------------------- いろいろ調べたのですが、原因究明が かなり困難なので、 ソースからのインストールはやめて rpm によるインストールを行なうことを考え始めました。 問題なのは、対象マシンはリモートで操作しており、外部ネットには繋がらない環境に置かれております。 そのため、yum によるインストールができません。 必要なrpmパッケージを対象マシンにアップロードして、rpmコマンドによるインストールを 考えているのですが、どこから必要なファイルをダウンロードすればよいのか わからないので、 どなたかご教示願います。 または、ソースからのインストールのエラー回避の方法を ご存知の方がおられたら、 その方法でもかまいませんので、ご教示願います。
postgresqlバージョン9.0を利用しています。しばらく安定していたのですが、運用から1ヶ月ぐらいしたここ最近、メモリの使用率(バッファ含め)が80%を超えるようになりました。 プロセスを確認すると、autoバキュームが負担になっているようです。 ほぼ autovacuum launcher processというプロセスが物理メモリの80%を占有しています。 このままでは、autovacuumにより逆にパフォーマンスが悪くなりそうです。 そこで、autovacuumが負担にならないようにvacuum_cost_limitの適切な値を設定しようと思索していますが、適切な設定に迷っています。 また　vacuum_cost_limitはコメントアウトのままです。 どなたか適切な設定値の算出や設定や方法をご教授いただけませんでしょうか。 現在の状態はこちらです。 OS：RedhatLinuxEnterprise5.5　64bit メモリ：8GB postgres.confの設定 autovacuum = on autovacuum_naptime = 1min autovacuum_vacuum_threshold = 50 autovacuum_analyze_threshold = 50 autovacuum_vacuum_scale_factor = 0.2 autovacuum_analyze_scale_factor = 0.1 autovacuum_vacuum_cost_delay = 20ms autovacuum_vacuum_cost_limit = -1 #vacuum_cost_limit = 200 # 1-10000 credits どうぞよろしくお願いいたします。
postgresのdump & restoreで全体定義とインデックスを分離したいです。 やりたいことは以下です。 元のデータベースがあります。 ここから、 （１）インデックスを除く全体定義 （２）インデックス を抜き出します。 別の環境に （１）をリストアし、 データをCOPYし、 その後、（２）をリストアします。 全体定義をdumpし、 それをrestoreし、 そこにデータを突っ込むと速度が遅いので、インデックスだけ後で貼りたいのです。 何か良い方法はありませんか？
お世話になります。 バッチファイル中でpsql.exeを実行させて、 select結果を環境変数に格納したいと考えております。 "C:\Program Files\PostgreSQL\8.2\bin\psql.exe" DB名 -c "select count(*) from table" という単純なselect文を実行し、select count(*)した結果を バッチファイル中で使用したいのです。 -o "C:\hoge.txt" などと付けて、このhoge.txtを改めて読み込んでも良いのですが、 それ以外に方法はありますでしょうか？ DB：PostgreSQL 8.2.4 OS：WindowsXP です。
Postgresのtextsearch_jaを設定しました。 そこでMecabを使用しています。 例として以下のテーブルで create table table1 ( id int, col1 text, col2 text, tsv tsvector ); 更新処理時にtsvカラムに解析データが入るようにトリガを設定しました。 col1に「田中00001」をINSERTします。 解析するtsvカラムには「田中」と「00001」が入ります。 ここで、「0000」と検索しても、レコードを取得できませんでした。 投げたSQLは以下のような感じです。 select * from table1 where tsv @@ to_tsquery('japanese', '0000') select * from table1 where tsv @@ to_tsquery('japanese', '0000') とした場合はレコードを取得することができます。 以下も試しましたがレコードは取得できませんでした。 select * from table1 where tsv @@ plainto_tsquery('japanese', '0000') 「0000」にて検索した場合に、全文検索の機能でレコードを取得する方法はありますでしょうか？ postgres8.4.5 Mecab 0.98
ＰｏｓｔｇｒｅＳＱＬを使ったデータベースシステムがあります。 4年前から稼動しています。 最近ＤＢの更新処理の速度が低下したので原因を調べています。 バキュームを実行後、６３０件のレコードを更新するのに約６０秒かかりました。 全データをバックアップし、データベースを新しく設定してリストアし、 同じ処理を行ったところ、約15秒（４分の１）に短縮されました。 処理速度低下の原因として考えられることはどんなことがあるでしょうか？ また、処理速度の低下を防ぐ方法はどのようにすればいいのでしょうか？ よろしくご教授ください。
単一ＳＱＬ文にて抽出可能でしょうか？ Ｖｅｒ８．３系 予めサブクエリーにて任意の条件にて抽出した店データのＩＤの値を基に、 商品データを抽出するのですが、その商品は、お店毎にランダムに１件抽出される。 ＜抽出例＞ 例えば、サブクエリーにて５店舗対象となり、そのお店紐付けられる商品は お店毎にランダムに１商品しか抽出されない。 店ＩＤ、商品ＩＤ 000001、100001 000002、305001 010000、200010 011111、300001 020000、150000 色々試しているのですが、うまくいきません。 お詳しい方、ご教授願えないでしょうか？ よろしくお願いします。
postgreSQL8.4.4のmakecheck失敗 皆様 初めて質問いたします。 どうか宜しくお願いします。 要約としてはインストール中の確認作業であるmakecheckが失敗する理由が分かりません。 私の開発環境は以下になります。 ■カーネル：2.6.18 ■ディストリビューション：Debian(etch) ■postgre8.1.8(debian提供のバイナリからインストール) 上記の環境に以下の手順でインストール作業を行いました。 (1)本家からDLしたpostgre8.4.4のtgzデータをユーザー：postgresで解凍 (2)ユーザーpostgresで./configure (3)ユーザーpostgresでコンパイル(make all) (4)ユーザーpostgresで確認(make check) そうすると以下のエラーメッセージが出力されます。 test stats ... FAILED test tablespace ... ok ============== shutting down postmaster ============== server stopped ======================== 1 of 120 tests failed. ======================== The differences that caused some tests to fail can be viewed in the file "/var/home/postgre/postgresql-8.4.4/src/test/regress/regression.diffs". A copy of the test summary that you see above is saved in the file "/var/home/postgre/postgresql-8.4.4/src/test/regress/regression.out". ------------------------------------------------------------- ここではtest stat(統計情報取得)が失敗しているようです。 ログには以下のようにも記載されています。 SELECT wait_for_stats(); WARNING: pgstat wait timeout CONTEXT: SQL statement "SELECT (st.idx_scan >= pr.idx_scan + 1) FROM pg_stat_user_tables AS st, pg_class AS cl, prevstats AS pr WHERE st.relname='tenk2' AND cl.relname='tenk2'" PL/pgSQL function "wait_for_stats" line 9 at SQL statement このようにpg_statがtimeoutしているため、make checkが失敗しているのだと感じました。 そこで、 Q1. タイムアウトする原因と対策方法 上記をご教授していただけないでしょうか？ 宜しくお願いします。
PostgreSQL、レコード内にある結果(カウントの結果)を入れたい こんばんは、お世話になっております。 タイトル通りの質問です。 以下のテーブルがあったとします。 Aテーブル No.|名称|状態 ---+----+---- 1 |a |作業中 2 |b |作業中 3 |c |作業中 4 |d |作業中 5 |e |作業中 1 |a |準備中 このテーブルを以下のように表示したいです。 No.|名称|状態 |準備数 ---+----+-------+------ 1 |a |作業中 |1 2 |b |作業中 |0 3 |c |作業中 |0 4 |d |作業中 |0 5 |e |作業中 |0 『No』と『名称』が同じものをまとめ、 状態が準備中のものをカウントして数としてレコード内に入れたいです。 postgresのバージョンは8.2、 pgAdminのバージョンは1.6.3 です。 何か方法をご存知の方がいらっしゃいましたら回答いただきたく思います。 不足な点があれば指摘してください。補足させていただきます。 以上です、よろしくお願いします
SQLパズルの欠勤という問題で質問があります。 社員が１年間(閏年じゃない年)で、罰点を４０点以上をためたか チェックをするSQLで、罰点の集計期間１年間の条件が したのようになっているんですが、これだと 集計期間が366日になると思うんですが、これは 本の内容が間違っているということでしょうか？ WHERE absent_date BETWEEN CURRENT_TIMESTAMP - INTERVAL '1' YEAR AND CURRENT_TIMESTAMP
PostgreSQL、テーブル比較で片方のテーブルにないレコードのみ表示する方法 こんばんは、お世話になっております。 タイトル通りの質問です。 以下のテーブルがあったとします。 Aテーブル No.|data1|data2 ---+-----+---- 1 |a |10 2 |b |11 3 |c |12 4 |d |13 5 |e |14 Bテーブル No.|data1|data2 ---+-----+---- 1 |a |10 2 |b |11 3 |c |12 4 |d |13 5 |e |14 1 |f |10 ２つのテーブルがあり、結合後条件の条件で 『＝ｆのような直接的な指定はしないで』 Bテーブルのdataが『f』となっているもののみ表示させたいです。 WHEREの条件に 『Aテーブル.data1 <> Bテーブル.data1』 等を記述をしましたが理想の結果は得られませんでした。 postgresのバージョンは8.2、 pgAdminのバージョンは1.6.3 です。 何か方法をご存知の方がいらっしゃいましたら回答いただきたく思います。 不足な点があれば指摘してください。補足させていただきます。 以上です、よろしくお願いします
SQL における変数の宣言と代入の仕方 PostgreSQL8.1 を使っております。尻に火がつき始めたので、同じような内容の投稿ですがどうかご容赦下さい。 下記のように記述したのですが、各星座の文字列を重複して記述するのを避けたいので、 変数を宣言するなり何なりして何とかしたいのですが、 "SQL assign" やら "SQL variable" といったキーワードで色々検索しても、どうしても有用な情報に行き当たりませんでした。なにかしらのヒントを頂ければ幸いです。 宜しくお願いいたします。 --- CONSTRAINT myZodiac check ( myZodiac in ('Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces') ), CONSTRAINT yrZodiac check (yourZodiac in ('Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces', 'Air', 'Water', 'Fire', 'Earth',) ) ---
PostgresSQL8.4でツリー上に取得したい こんにちわ。 PostgresSQLでツリー上にデータを取得したいのですが、思ったように取得できないのでご教授をお願いします画像の「取得したい順番」。 データはid,name,parentとの構造になっています。 データは親子構造になっており、親の下に子が並ぶようにしたいんです。 子は親のidをparentに持っています。 元のデータは画像の「元データ」になっています。 現状再起SQLでデータを取得しid or parentでソートを掛けているのですが、意図した通りに取得できません画像の「取得出来る順番」。 そもそも再起SQLでできるのか、相関サブクエリを使うのか・・・SQLのみでできるのかすら分からなくなってきました・・・。 何か画像の「取得したい順番」通りに取得する方法はないでしょうか。 ヒントだけでもいいので、ご教授をお願いします。
PostgreSQL、外部ファイルからDBへの振り分け反映の方法 早速ですが質問させて頂きます。 『外部ファイル.txt』内容 ------ここから------ A B C D E F G H I 1 2 3 4 5 6 7 8 9 2 3 4 5 6 7 8 9 1 3 4 5 6 7 8 9 1 2 B C D E F G H I A 4 5 6 7 8 9 1 2 3 5 6 7 8 9 1 2 3 4 ------ここまで------ 上記のようなスペース区切りの文字ファイルがあるとして、このファイルのデータを 英字から始まる行はtable1へ、数字から始まる行はtable2へと振り分けたいです。 現在、１つのテーブルに反映させることは以下のコマンドを使用することにより可能なのですが、 ２つのテーブルに振り分ける方法は全く思い浮かびません。 １つのテーブルに反映させる方法 \COPY table1 from 'C:\\～ファイルパス～\\外部ファイル.txt' delimiters ' ' null '' 下記のようなファイル内容でもかまいません。 ------ここから------ A B C D E F G H I -------------------- 1 2 3 4 5 6 7 8 9 2 3 4 5 6 7 8 9 1 3 4 5 6 7 8 9 1 2 -------------------- B C D E F G H I A -------------------- 4 5 6 7 8 9 1 2 3 5 6 7 8 9 1 2 3 4 ------ここまで------ あるいは ------ここから------ A B C D E F G H I -------------------- 1 2 3 4 5 6 7 8 9 2 3 4 5 6 7 8 9 1 3 4 5 6 7 8 9 1 2 ------ここまで------ わかる方がいらっしゃいましたらご回答いただければと思います。 また、出来ないようであれば何か参考になりそうな情報を教えていただければありがたいです。 PostreSQLのバージョンは8.2？です。 不足している情報がありましたら指摘してください。 以上です、お手数かけますがよろしくお願いいたします。
ポスグレでの幾何学データ配列の使い方について質問です。 create table test_table1 (id serial, test_lseg lseg[]); insert into test_table1(test_lseg) values (ARRAY[lseg'((0,44),(0,88))',lseg'((1,44),(1,88))',lseg'((2,44),(2,88))',lseg'((3,44),(3,88))',lseg'((4,44),(4,88))',lseg'((5,44),(5,88))'] ); という感じのテーブルを作成し、test_lsegカラムのArray内にある線分に特定の座標が含まれているかを調べるような事をしたいのですが、ARRAY内の要素を検索する際の演算子を指定する方法がよく分かりません。とりあえず以下のようなSQL文では検索できないようです。 SELECT * from test_table1 WHERE test_lseg && ARRAY[lseg'((0,80),(0,80))']; SELECT * from test_table1 WHERE lseg'((0,80),(0,80))' && any (test_lseg); test_lsegカラムのArray内にある線分に特定の座標が含まれているかが分かり、出来ればIndexが張れるようなやり方がありましたらご教授ください。
PostgreSQLのパフォーマンスについて質問です。 INSERTを大量に行う処理の速度が遅いので、高速化をはかるため、INSERTを２０個ずつまとめる修正を行いました。 基本的に速度は速くなったのですが、あるデータだけ逆に遅くなってしまいました。 その遅くなったデータはレコード数が膨大なのですが、まとめてINSERTをおこなうSQLを連続で発行したら、処理速度が遅くなることはあるのでしょうか？ なお、INSERTは下記のように行っています。 INSERT INTO テーブル名 （列名群） VALUES (挿入データ群),(挿入データ群),・・・,(挿入データ群); また、すべてのテーブルにインデックスはついておらず、プライマリキーと外部キーが設定されています。 マシンスペックはCore2 Duo 2.53GHz、メモリ2GB、OSはWindows XPです。 よろしくお願いします。
pgpoolというpostgreSQLのレプリケーションツールについて質問です。 現在 WEB2台 DB2台の サーバー構成でWEBシステムを運用中なのですが、 このDB2台の同期を取る為にpgpool-IIというツールを使っています。 所が、このツールを使用していると 2台目のDBサーバーへのノードが勝手にダウンしてしまいます。 原因と考えられることも検討がつかず、 解決方法もわかりません。 どなたか詳しい方がいらっしゃれば、ご教授いただけないでしょうか？ よろしくお願いいたします。
"京"の文字化けで困っています。 postgres 7.2.4 サーバを使用し、サーバ側でECPG(埋込SQL)にて、 S-JISのCSVファイルを読込、EUCに変換し、データベースに登録を行い、 windowsのアプリ（visualBasic作成)でodbc接続にて データを表示させると"京"の漢字が文字化けをおこしてしまいました。 （"東京支店"　->　"東＝支店"と表示されてしまいます。） サーバのデータベースはEUC-JPで構築しております。 EUCの"京"の文字はS-JISの文字コード表にないためなのでしょうが、 ODBCで変換をしてくれていないのでしょうか・・ 勉強不足ですみませんが皆様のお知恵をお借りできればと思います。 よろしくお願いいたしいます。
pgAdmin3でDB作成時のcollationについて。 Linux上で動作するPotGreSQLをwindows7上のpgAdmin3より 操作しています。 DATABASEをクリエートする際、 DBの名前、オーナー、エンコーディング、template、テーブル空間等を 入力しますが、コーレーションと文字型が選べません。リストボックスが 固まったままとなります。値はスペースのままで選べません。 以下の環境で使用しています。 --------- OS :CentOS5.4 PostgreSQL : 8.1.21 Win7pro pgAdmin3: ver1.10.3 --------- 設定漏れではないかと思い調査中です。 原因について、ご存知の方、ご教授いただけませんでしょうか。
Postgresでlocalhost以外の接続がはじかれる Postgresにlocalhost以外から接続を行うと はじかれてしまうようなのですが、 外部からの接続を許可するようにすることは できますか？ 当方レンタルサーバでDBの保守はブラウザ版のphpPgAdmin で行っております。 どうぞ、よろしくお願いいたします。
postgrsqlを別のディレクトリに初期化したい Cent osのデータベースサーバーの選択としてpostgrsqlをインストールしました。 データは /var/lib/pgsql/data にできました。 /varの空きが少なかったので、/var/lib/pgsql/dataを削除し、 ルートに/pgsqlを作成し、そこに初期化しました。 >initdb -E UTF8 -D /pgsql/data すると、/pgsql/dataに初期データが生成されましたが、 いつの間にか/var/lib/pgsql/dataにも出来ています。 [root@linuxpc ~]# ls -pl /pgsql/data 合計 108 -rw------- 1 postgres postgres 4 9月 8 15:54 PG_VERSION drwx------ 5 postgres postgres 4096 9月 8 15:54 base/ drwx------ 2 postgres postgres 4096 9月 8 15:54 global/ drwx------ 2 postgres postgres 4096 9月 8 15:54 pg_clog/ -rw------- 1 postgres postgres 3396 9月 8 15:54 pg_hba.conf -rw------- 1 postgres postgres 1460 9月 8 15:54 pg_ident.conf ・・・略・・・ -rw------- 1 postgres postgres 13793 9月 8 15:54 postgresql.conf [root@linuxpc ~]# ls -pl /var/lib/pgsql/data 合計 132 -rw------- 1 postgres postgres 4 9月 8 15:55 PG_VERSION drwx------ 5 postgres postgres 4096 9月 8 15:55 base/ drwx------ 2 postgres postgres 4096 9月 8 16:02 global/ drwx------ 2 postgres postgres 4096 9月 8 15:55 pg_clog/ -rw------- 1 postgres postgres 3182 9月 8 15:55 pg_hba.conf -rw------- 1 postgres postgres 1460 9月 8 15:55 pg_ident.conf ・・・略・・・ -rw------- 1 postgres postgres 13793 9月 8 15:55 postgresql.conf -rw------- 1 postgres postgres 57 9月 8 16:02 postmaster.opts -rw------- 1 postgres postgres 45 9月 8 16:02 postmaster.pid どちらが有効なのでしょうか？ /var/lib/pgsql/data側は要らないのですが。
こんばんは。 軽いSQL文がかけずに困っております。 どなたかご教示願います。Postgres8.3になります。 テーブル名　num カラムはuserとidとします。 データは最下部にあるように持ちます。 a～eのユーザのうち、idが2200番台のうち、2201と2202だけをもつユーザを抽出するSQL文を望みます。 a：2200と2203が存在するので偽 b:真 c:2202が無いので偽 d:2203が存在するので偽 e:真 このようなSQLを書きました。 1.numより2201を持つuser 2.numより2202を持つuser 3.numより22～で始まる以外のuser それぞれの等しいuserが真と思ったのですが、本来3.では22～始まるidを持たないuser としなければなりませんでした。 ここで詰まってしまい、タイムアップとなってしまいました。 どのようなSQLが望ましいでしょうか。 よろしくお願いいたします。 select * from num as m, (select x.user from (select user from num where id = 2201 group by user_id) as x, (select user from num where id = 2202 group by user_id) as y, (select user from num where id::text not like '22%' group by user) as z where x.id = y.id and x.id = z.id and y.id = z.id) as n where m.id = n.id; num user,id a,1000 a,1100 a,2000 a,2100 a,2200 a,2201 a,2202 a,2203 a,3000 b,1000 b,2100 b,2201 b,2202 b,3000 b,3100 c,1000 c,2201 c,2203 c,3000 c,3100 c,3200 d,1000 d,2100 d,2201 d,2202 d,2203 d,3000 d,3100 d,3200 e,1000 e,2201 e,2202 e,3000 e,3100 e,3200 e,3300
PostgreSqlのテーブル一覧が欲しい pg_class（のrelkind = 'r'の条件）にテーブルの情報が入っています。 これを自作テーブルとシステムが生成したテーブルに別けたいのですが、どの区分を見ればわかりますか？
PostgreSQLのバキュームとリインデックスについて バキュームは領域の再編成と解析 リインデックスは索引情報の再編成 であるという事は理解しています。 データベースを作成し、 テーブルを作成し、 まとまった量の初期データを放り込んだとします。 バキュームはやっておいた方が良さそうですが、 リインデックスもやっといた方が良いですか？ 両方やるとしたら、 どっちが先とか後とかありますか？ それとも同時にやっても良いぐらいですか？
エラーが起こっているレコードの特定 pg_dumpでバックアップを取っていたら以下のメッセージが出力されました。 > pg_dump: サーバのエラーメッセージ: ERROR: 符号化方式"UTF8"文字0xe28093<は"SJIS"と同じではありません おそらくユーザがSJISで表現できない文字を入力したのではないかと思います。 それはなんらかの根本的な対処が必要として、とりあえずバックアップができるように、このレコードの該当する文字列をpgadminを使って手動で修正しようと思っています。ですが、そのレコードを特定する方法がわかりません。 このエラーが出た場合、問題があるレコードを特定するにはどうしたらいいでしょうか。
PostgreSQLの読み方、発音 たいへんつまらない質問で恐縮ですが、 PostgreSQLの読み方は、私が聞いた範囲では、 ・「ポストグレス キュー エル」 ・「ポストグレ エス キュー エル」 の両方聞いたことがあります。 実際には、どれが正しいのでしょうか？
PHPで表示期間の指定がしたい こんにちは、いつもお世話になっております。 数日間、PHPカテゴリでPHPの表示期間指定についてやり取りをさせていただいてました。 http://okwave.jp/qa/q6102388.html 質問の概要は、PostgreSQLのデータベースの情報を表示するPHPを今日以降の1ヶ月間分だけを表示したいというものです。 何度も回答をいただいてPHPを修正していたのですが、エラーが出てしまいます。 PostgreSQLのカテゴリで聞いたほうが良いのではないかと回答者様にアドバイスをいただき、こちらに伺いに参りました。 情報は以下の通りです。 (1)テーブルの構造と入ってるデータ ------------------------------------------------------------ ee　年月日（「20100811」の形式） ti　記事タイトル na　記事内容 ca　カテゴリー ------------------------------------------------------------ (2)回答者様に修正していただいたソース =================================================== $sql = "SELECT ee,ti,na,ca FROM テーブル名 WHERE ca = 'カテゴリー名'"; if($ym != "")$sql .= " and TO_DATE(ee, 'YYYYMMDD') BETWEEN TO_DATE('{$ym}', 'YYYYMMDD') AND TO_DATE('{$ym}', 'YYYYMMDD') + '1 months' + '-1 days'"; $sql .= " ORDER BY ee ASC"; =================================================== (3)2で表示されたエラー =================================================== Warning: pg_exec(): Query failed: ERROR: operator is not unique: date + "unknown" HINT: Could not choose a best candidate operator. You may need to add explicit type casts. in PHPのアドレス on line 102 ------------------------------------------------ ▼101行目の内容 $result = pg_exec($sql); ------------------------------------------------ Warning: pg_numrows(): supplied argument is not a valid PostgreSQL result resource in in PHPのアドレス on line 103 ------------------------------------------------ ▼102行目の内容 $rows = pg_numrows($result); ------------------------------------------------ Warning: pg_freeresult(): supplied argument is not a valid PostgreSQL result resource in in PHPのアドレス on line 147 ------------------------------------------------ ▼146行目の内容 pg_freeresult($result); ------------------------------------------------ この後に、何も情報がなかった場合の規定のメッセージが表示されます=================================================== 以上です。 PHPもデータベースも恥ずかしながら無知のため、お力をお貸しいただけると助かります。 よろしくお願いします。
PostgreSqlシステムカタログを組み合わせて データベース名 スキーマ名 テーブル名 ----------- -------- -------- dtabase1 public table101 dtabase1 schema1 table111 dtabase1 schema1 table112 dtabase2 public table211 dtabase3 schema1 table311 dtabase3 schema2 table321 というようなデータを取ることは出来ますか？
PostgreSqlのシステムスキーマについて教えてください public・・・共有。 pg_catarog・・・カタログ情報。 information_schema・・・オブジェクトについての情報を持つビューの集合。 あと２つ pg_toast pg_temp_1 については良く分かりません。 マニュアルサイト http://www.postgresql.jp/document/8.1/html/index.html は量が多すぎて隅々まで見きれていないかもしれません。 ここに載っているという指摘でも結構です。
PostgreSQLで使えるツール データセンターにPostgreSQLの入ったサーバを置いており、リモートでデータベースの管理や CSVでのデータの挿入や編集等を行いたいのですが、何かよいツールはないでしょうか。 CSEが使えるかと思って試したのですが、データセンターの設定で、ODBC接続ができません。 何卒、よろしくお願いします。
postgresのWindows版でinitdbで初期化するには どうすれば良いですか？ postgresユーザで # initdb --encoding=UTF8 --no-locale を実行するという記事を見つけました。 linuxの場合、 su - postgres の後、実行すればよいのでしょうが、 Windows版ではどうなりますか？ とりあえず、やってみましたが、以下のような状態です。 C:?Program Files?PostgreSQL?8.1?bin>initdb --encoding=UTF8 --no-locale initdb: no data directory specified You must identify the directory where the data for this database system will reside. Do this with either the invocation option -D or the environment variable PGDATA.
PostgreSQL WALファイルの運用について はじめて投稿させていただきます。 PostgresSQLを使用したシステムの構築に初めて携わることになり、 WALの運用についてわからない点があり、質問させていただきます。 WALはpostgresql.conf > checkpoint_timoutパラメータでの指定間隔で 永遠に蓄積されていくのでしょうか。 自動パージ機能などは存在しますでしょうか。 上記機能がない場合、どのような運用が考えられるでしょうか。 お知恵をお借りしたく思います。 サーバディスク領域の圧迫を回避するための運用を模索しておりますが、 解決策が見つかりません。ご教示ください。 パージ用バッチの運用？ WALの他サーバへの書き出し？
DB(Postgre)について、知っている方ご教授願います。 Versionは8.3.Xです。 C/Sのシステムなのですが、クライアントからサーバーの更新系テーブル(更新TBL)に随時書き込んでいます。Postgreの機能を使い、更新TBLと同一のTBL(更新1_TBL)を自動で作成することは可能でしょうか？ [CL]　　　　[SRV] データ　->　更新_TBL ・・・ (1) 　　　　->　更新1_TBL ・・・ (2) (1)を実行すると(2)が自動的に出来る機能ってありますか？ (レプリケーションのテーブル版みたいな機能ってありますか？）
PostgreSQLテーブルを作成するスキーマ PostgreSQLにテーブルを作成するのですが、 すでにある資産は publicスキーマに全部作成しているようです。 これってどうなのでしょうか？ 簡易的に作る時は何も考えずに、既存のpublicスキーマに作ってしまうのは一般的な事なのでしょうか？ それとも、ちゃんと自分でスキーマ作ってから、そこに作るべきなのでしょうか？
postgreSQLで分からないことがあります。 よろしくお願いします。 下にあるtblというテーブルがあったとき。 下のSQLを実行するとデータがうまく取れているんですが、 CURRENT_DATEは日付型でSUBSTRでとりだした日付は文字列 なのに何故正しく比較できているのでしょうか？ 日付型の形式の文字列であれば、RDBMSがかってに日付型にしてくれるのでしょうか？ tblテーブル *sdateとedateはtimestamp型です。 sdate 　　　　　| edate | ----------------------------------------- 2010-5-1　10:00:00 | 2010-5-2 13:00:00| SELECT * FROM tbl WHERE CURRENT_DATE BETWEEN SUBSTR(sdate, 1, 10) AND SUBSTR(edate, 1, 10)
postgresのdatabase名と、そのencodingを取得する方法を教えてください。 postgres8.1です。 システムカタログ http://www.postgresql.jp/document/pg811doc/html/catalogs.html の pg_databaseの項目として持っているだろうと思い、見てみました。 encodingint4 このデータベースの文字符号化方式 これか？と思いましたが、数値IDのみでした。 この数値から、utf8やsjisといった情報にどうやったら繋がりますか？
■一番最初に値が入っている(Nullでない)カラム名を取得するには？ 会社の上司が、上記の条件をSQL文一つで出来るというのですが、 postgres SQLの書き方が思いつかず、大変困っています。 状況を説明します。 主に以下のようなカラムを持つテーブルがあります。 ID, 年, 月, タイプ, price_1d, price_2d, price_3d, ..., price_31d price_?d には null or 数字が入ります。 上記のような状況で、 price_1d ～　price_31d の順で最初に値が入っているカラム名を取得し、 最初に値があるのは何年何月何日と判定したいというわけです。 おまけに、タイプには 0 or 1 が入り、 その値によっては、price_?dではなく、別カラム price2_?d を見ないといけないという条件付きです。 このような条件をSQL一つで抽出することははたして本当に可能なのでしょうか？ 何かしら解決の糸口となるヒントだけでも構いませんので、 何か情報を頂けると大変ありがたいです。 また、そんなの出来ません、 という情報でもいただけると嬉しいです。 宜しくお願い致します。
日付範囲内かつ時刻も範囲内のデータをとるには？ 環境　postgreSQL7.4 date_tbl no | start_date | end_date ----------------------------------------------------- 1 | 2010-06-01 10:00:00 | 2010-06-03 15:00:00 例えば、上のような日付の範囲を設定するテーブルがあります。 現在の時刻が、date_tblで設定した範囲のデータを取得する条件式を記述するには どういう条件式を書けばいいでしょうか？ 例えば、現在の時刻が下の範囲に該当する場合にnoを取得したい場合 2010-06-01の10:00:00～15:00:00 2010-06-02の10:00:00～15:00:00 2010-06-03の10:00:00～15:00:00
PreparedStatementでの複数検索 環境：struts1.3,postgresql8.4,JDK1.6 テキストボックスなどから1つから6つの条件でsqlを検索したいのですが この場合、1つでもnullがある時は検索されません。 Connection con = null; con = ProductDAO.getConnection(); //SQLの実行 String selectStatement = "SELECT * FROM test,test_list WHERE test.id = test_list.id " + "AND prefecture=? " + "AND low_price>=? " + "AND low_age>=? " + "AND sameday_select =? " + "AND terms_select =?" + "AND category=?"; PreparedStatement prepStmt = con.prepareStatement(selectStatement); prepStmt.setString(1, aForm.getPrefecture()); prepStmt.setInt(2, aForm.getLow_price()); prepStmt.setInt(3, aForm.getLow_age()); prepStmt.setString(4, aForm.getSameday_select()); prepStmt.setString(5, aForm.getTerms_select()); prepStmt.setString(6, aForm.getCategory()); ResultSet rs = prepStmt.executeQuery(); (3) SQLの実行結果の処理 while (rs.next()) { 　　処理 } この場合、if文などでaForm.getPrefecture()がnullの場合などで1つ1つ条件を付けないと駄目でしょうか？その場合、if文が膨大な数になってしまうため何か良い方法はありますか。 あるならば、具体的に教えて下さい。
SELECT文のWHERE句についてご教授下さい。 ┏━┳━━━━┳━━━━┳━━━━┳━━━━┓ ┃No┃パターン_┃データＡ__┃データＢ__┃データＣ__┃ ┣━╋━━━━╋━━━━╋━━━━╋━━━━┫ ┃01┃001_________┃P1だけ___┃NULL_____┃共通________┃ ┣━╋━━━━╋━━━━╋━━━━╋━━━━┫ ┃02┃001_________┃P1のみ___┃NULL_____┃共通_______┃ ┣━╋━━━━╋━━━━╋━━━━╋━━━━┫ ┃03┃002_________┃NULL_____┃P2だけ___┃NULL______┃ ┣━╋━━━━╋━━━━╋━━━━╋━━━━┫ ┃04┃002_________┃NULL_____┃P2のみ___┃共通_______┃ ┣━╋━━━━╋━━━━╋━━━━╋━━━━┫ ┃05┃002_________┃NULL_____┃P2のみ___┃NULL______┃ ┣━╋━━━━╋━━━━╋━━━━╋━━━━┫ ┃06┃003_________┃HOGE11_┃NULL______┃共通_______┃ ┗━┻━━━━┻━━━━┻━━━━┻━━━━┛ 上記のようなテーブル構造のデータがあり、 それぞれのカラムに対して検索できるWebの画面があります。 以下の要件を満たすSELECT文はどのように作成すればよいでしょうか？ パターン「001」の場合だけ、データA列を検索条件に加える。 パターン「002」の場合だけ、データB列を検索条件に加える。 全パターン共通して、データC列は検索条件に加える。 【具体例】 　以下の検索条件が指定された場合は、No「01と04と06」がHITする。 　　パターン＝「001、002、003」 　　データA＝「P1だけ」 　　データB＝「P2のみ」 　　データC＝「共通」
Windows XP にPostgeSQL8.4.4をインストールしました。 問題なくインストールできたのでコマンドプロンプトからpsqlコマンドで接続して「\l」を実行したら文字化けして以下のように表示されました。 データベ ース一覧 \x96\xBC\x91O | \x8F\x8A\x97L\x8E | \x83G\x83\x93\x83R\x81[\x83f\x83B\x83\x93\x 83O | \x8Fニ構x87\x8F\x87\x8F\x98 | Ctype(\x95マ浬xB7\x89\x89\x8EZ\x8Eq) | \x83A\x 83N\x83Z\x83X\x8C\xA0 ---------------+-------------------+-------------------------------------------- ----+---------------------------+------------------------------------+---------- -------------------- ちゃんと表示されるようにするにはどうしたらいいのでしょうか。 ご存知の方がいましたらアドバイス、宜しくお願いします。
Linuxでpostgresのテーブルの同期をとりたい Linux上で動いている2つのpostgresのテーブルデータの同期をとりたいと考えています。 具体的には、Aサーバーのテーブルが更新されたら、Bサーバーのテーブルも同様の更新したいのです。 Windowsでは使えそうなツールがあったのですが、Linuxに対応していないみたいなので・・・ postgresのバージョンは、8.3.9です。 何か良い方法がありましたら、ご教授願います。
postgresのlinux版でやっている事と同等の事をwindows版でやりたい！ os:windows xp やりたい事は以下です。 圧縮して出力 $ pg_dump dbname | gzip > filename.gz 解凍のみ $ gunzip -c filename.gz 解凍してリストア $ gunzip -c filename.gz | psql dbname gzipがzipやlhaに変わってもOKです。 --format=c オプションで出力したファイルは解凍のみの方法が分かりませんでした。 圧縮ツールはwindowsの標準か追加モジュールが第一希望 第二希望はフリーソフトです。
postgreSQL、pg_dumpのオプションについて pg_dumpの--format=formatオプションの解説でオプション c は「形式はデフォルトで圧縮されます。」とあります。 「デフォルトで圧縮される」とはどういう事ですか？ 何形式ですか？
Postgresqlのインストーラーについて こんにちは。初めて質問させていただきます、初心者プログラマです。 現在、仕事上でアプリ開発を行い、postgresqlを使っています。 その完成した、アプリをインストールする場合、postgresqlもインストールしなければなりません。 ですが、ユーザーの方にpostgresqlのインストーラーを使用して、セットアップしていただくには、 少々難易度が高いのではと思っています。 そこで、ユーザーの方には簡単にpostgresqlをインストールしていただける手法を模索しております。 どなたか良い方法がございましたら、ご教授お願い致します。 今検討しているのが、postgresqlソースを修正し、それを元にコンパイルして、setup.exeみたいなものができないかなと思っております・・・。 今のバイナリファイルは拡張子がexeなのでmsiみたいにコマンドラインでオプションが使えれば簡単にできそうなのですが・・・。
テーブルの情報を取得したい PHP5とPostgreSQL8.4.3を使っています。 フォームにテーブル名を入力して送信すると、そのテーブルの情報(カラム名、型名など)が表示され、 そのテーブルに対してレコードの追加や削除を行いたいのですが方法が分かりません。 どなたか分かる方いらっしゃいましたらお願いします。
文字列を time 型に変換するには。 お世話になります。 PostgreSQL 8.2 & PgAdmin 1.6.3（WinServer 2003）を使用しています。 varchar 型のカラムに格納されている時刻を表す文字列（'9:15' など）を time 型に変換してビューを作成する必要があるのですが、できずに困っています。 具体的には... 「table1」というテーブルに「時刻」(varchar 型)という名前のカラムを作成し、「9:15」という文字列を格納しておきます。 これをもとにビュー（view1）を作ろうとしているのですが、select 文のところで 、ERROR: syntax error at or near "時刻" SQLステート:42601 というエラー（構文エラー）が出てしまいます。 　select time 時刻 from table1 　結果：ERROR: syntax error at or near "時刻" SQLステート:42601 ちなみに、時刻を文字列で指定してやると、ちゃんと time 型で結果が返ります。 　select time '9:15' 　結果：09：15：00 抜本的に方法が間違っているとはおもうのですが、いくら調べてもこれを解決できるようなサイトが見当たりませんでした。 文字列を time 型に変換するにはどのようにしたらよいのかご教示いただけないでしょうか。 よろしくお願いします。
Passwordを設定したPostgreSQLのバックアップなどができない。 PostgreSQLのバックアップを行おうとしているのですがバックアップSHELLを実行 するとパスワードを聞いてきます。 pg_dump -Udbuser -s DBANME > /DbBkup/dbbackup.out そこで実行ユーザのHOMEディレクトリに.pgpassを置き localhost:*:DBNAME:dbuser:dbpass と登録し、実行しところ、これでもパスワードを聞いてきます。 最終的にはcronで実行したいのですが、解決方法がわかりません。 お願いいたします。
SQLでPostgreSQLサーバーを切断させたいと考えています。なかなかわかりません。 だれか、教えて頂ければ大変助かります。 宜しくお願い致します。
postgresqlの普通のSQLでデータが取得できません。 下記のようなSQLがあります。 SELECT msiten AS kaisyacd,mtokuicd AS tokucd,mchikucd AS chikucd,mchikunm AS chikunm,nmakercd AS makercd,mdealer AS dealercd,mname1 AS name1,mname2 AS name2 FROM msitenmst LEFT JOIN ndealermst ON (mtokuicd = ntokuicd) AND (msitencd = nsiten) WHERE mtokuicd > 100000 （項目名・テーブル名など無理に変更していることをご了承ください。） これをvbaで流すとtokucdの値のみ取得できません。（0になります）他の項目は正しく取得できています。 Accessのクエリで同様のSQLを流しても正しく処理されます。 なぜ、このようなことが有り得るのでしょうか？ 非常に困って居ます。 ヒントでもかまいませんので教えていただけないでしょうか？ お願いいたします。
createdbができません。 PostgreSQLをインストールし、createdbを実行したところ次のようなエラーが出てしまいました。 C:\Program Files\PostgreSQL\8.3\bin>createdb -U postgres test createdb: could not connect to database postgres: FATAL: password authentication failed for user "postgres" 自分で調べてみたところ、-Wでパスワードを打ち込めば良いとあったので 試してみましたが、エラーが createdb: could not connect to database postgres: FATAL: password authentication failed for user "Administrator" となるだけです。どうすればよいのでしょうか。 環境はwindows xpです。 よろしくお願いします。
Access2003+PostgreSQLにて販売管理システムを構築しています。 レコードを見る・更新する時はサーバーのレコードを ワークテーブル（ローカルのmdbファイル内のテーブル）にコピーし 値を変更後、ローカルからサーバーにデータを戻す、といった処理をしたいと考えています。 サーバーからレコードをコピーする際は、ODBC接続＆ADOにて サーバーのレコードを一旦レコードセットに格納し 「CurrentProject.Connection.Execute SQL文」で ワークテーブルにINSERTしています。 ここで質問なのが、ワークテーブルからサーバーにレコードを戻す際は ワークテーブル・サーバーへはそれぞれどの方法で接続すればいいでしょうか。 例えばサーバーへODBC＆ADOで接続した場合、ワークテーブルの取扱方法（接続方法）が分かりません。 サーバー：ADO、ワーク：DAO、みたいな事するのでしょうか。 スマートな方法がお分かりの方は教えて下さい。 宜しくお願い申し上げます。
（Linux、データベース初心者）スクリプトを実行するとPermission deniedが発生します。 Postgresql psqlに関して よろしくお願いします。 UbuntuサーバにインストールしたPostgresqlに対し、スクリプトを実行してcsvファイルをインポートしようと考えています。 その際にPermission deniedが発生しテーブルにデータが入りません。 以下にスクリプトファイルとエラーメッセージを掲載します。 <test.sh> #!/bin/bash #接続文字列 export PGHOST="ホスト名” export PGPORT="ポート番号" export PGDATABASE="データベース名" export PGUSER="ユーザー名" export PGPASSWORD="パスワード" PSQL='COPY bat_test FROM ' '''/test/test.csv''' ' with DELIMITER ' ''',''' echo "$PSQL" | psql echo "commit" | psql <以上、test.sh> <エラーメッセージ> test.sh：/test/test.csv:Permission denide <以上、エラーメッセージ> インポートしたいファイルの権限等は確認しましたがわかりませんでした。 何が悪いのかご指摘いただければ助かります。 どうか、よろしくお願いします。
こんにちは。 windows7にPostgreSQLをインストールできずに困っています。 ウイルスソフトは入っていません。 ファイヤーウォールも無効にしています。 お手数ですがよろしくお願いします。
PostgreSQL8.3系のAutovacuum不備？ 現在、8.3.3を使用しておりますが、最近応答がかなり重くなりまして 手動にてvaccumを実施し対処しました。 インストール時のデフォルトで運用しているのですが ＜値＞ autovacuum | on autovacuum_analyze_scale_factor | 0.1 autovacuum_analyze_threshold | 50 autovacuum_freeze_max_age | 200000000 autovacuum_max_workers | 3 autovacuum_naptime | 1min autovacuum_vacuum_cost_delay | 20ms autovacuum_vacuum_cost_limit | -1 autovacuum_vacuum_scale_factor | 0.2 autovacuum_vacuum_threshold | 50 かなり動作が重くなっても、自動実行されない模様です（閾値が合わない）。 そもそもチューニングすべき物なのでしょうか？ お詳しい方、ご教授頂けないでしょうか？宜しくお願い致します。
RedHatLinux＋PostgreSQLを使ったWebシステムのパフォーマンスチューニングについて。 RedHatLinux＋PostgreSQLを使ったWebシステムをある会社に開発してもらったのですが、 検索のパフォーマンスがとても悪く問題になっています。 まずは、システムのどの部分がボトルネックになっているかを調査したいのですが、どのような ソフト、またはコマンドを使って調査すればよいのでしょうか？ それと、ボトルネックになっている部分をどのように改善するかを教えていただけますでしょうか。 また、開発してもらったソースは公開されておらず、オブジェクトでの提供になっており SQL文が分かりません。 実行されたSQL文を解析する方法はありますでしょうか？ よろしくお願いいたします。
Postgresqlでdateとintの加算 テーブル1の訪問日（date）に、テーブル2の訪問周期日数(int)を加算して、次回訪問予定日を表示するにはどうすればいいでしょうか？ テーブル1=主キー：顧客番号（char）,顧客名（text）,顧客訪問日（date） テーブル2=主キー：顧客番号（char）,訪問周期日数(int) 出力　顧客番号,顧客名,次回訪問予定日 備考 ＊訪問日（date）だけ各営業マンが書き込みを行う。その他は原則システムの開発・管理チームが書き込み。 また、このケースのように、ほとんどのユーザが（date）のみ書き込みをする際、排他制御で何か適した例などご教示いただければ大変助かります。 よろしくお願いします。
別のサーバーにあるDBに対してSELECTした結果が帰ってこない。 質問はタイトル通り、別のサーバーにあるDBに対してSELECTした結果が帰ってきません。 あるwebサイトを新しいサーバーに移行する事になりました。 データベースはwebサイトと同じサーバーに準備していたのですが 新しいサーバーに移行する際に別のサーバーに準備する事になりました。 そして新しい環境で動作検証をしていて特に問題なく進んでいたのですが・・・・ 旧環境では特に問題なくSELECTした結果が帰ってきていましたが 新しい環境ではデータ取得の際に件数が多くなるとSELECTした結果が帰ってきませんでした。 SELECTした結果は約7000件～30000件のデータを取得するようになっております。 （新しい環境で1000件近くのデータを取得しようとしたら約5分かかりました。） これはSQL文が悪いのでしょうか、それともphpの設定が悪いのか、postgresqlの設定が 悪いのか特定出来ずに困り果てております。。。 何でも構いませんのでご助言を頂けたら幸いです。 ■環境について □以前の環境 同じサーバー内にphpとpostgresqlがある Postgresqlのバージョンは8.0.3で、phpのバージョンは5.0.5です。 □現在の環境 別のサーバーにphpとpostgresqlがある Postgresqlのバージョンは8.1.18で、phpのバージョンは5.1.6です。 ■データ取得テーブル □テーブル名 テストテーブル □フィールド数 100 （登録時刻フィールドはタイムスタンプ型です） □SQL文例 Select * From テストテーブル　Where 登録時刻フィールド >= 'yyyy-mm-dd' AND 登録時刻フィールド <= 'yyyy-mm-dd'
postgresql8.3.9のWindows版を使っています。 psql データベース < bak.sql で1GBくらいあるＳＱＬファイルをリストアしたのですが、 INSERT 0 1が大量に表示されて遅いです。 何も表示させない or 高速版っていうものはあるのでしょうか？
VS2005のC#にてWindowsアプリを作成します。 データベースとして、PostgreSQLを使おうと思っているのですが、 ・VS2005から使用するための設定方法 ・ソースコード上に書く必要のあるコマンド（例：MySQLなら『mysql_real_connect』等） について、詳細に解説しているWebサイトのURLをご存知の方おられましたら、 ご教示お願いできませんでしょうか？ 自分でも探してみたのですが、なかなか見つからず困っております。。 どうかよろしくお願い致します。
Windows版インストーラを用いてPostgreSQL 8.4.2版をインストールしているのですが、 設定ファイル（/data/postgresql.conf等）がうまくインストール出来ません。dataフォルダー自体も作られません。 何が原因で、どの様に対応すれば良いのか教えてください。 エラーメッセージ：problem running post-install step. Installation may not complete correctly Error reading file C:/program Files/PostgreSQL/8.4/data/postgresql.conf 初めてのインストールで勝手が解らずに苦労しております。 宜しくお願いします。
ソース上でコネクションを取得しようとすると、 以下のエラーが出てコネクション取得ができません。 org.postgresql.util.PSQLException: The connection attempt failed. 他の方が上記のエラーが発生したときの方法をいくつか試してみましたが、 変化ありませんでした。 Connection con = DriverManager.getConnection ("jdbc:postgresql://127.0.0.1:5432/db_test","postgres","PASS"); (1)上記の「127.0.0.1:5432」の箇所をそれぞれ「localhost:5432」「localhost」に変える (2)接続許可リスト(pg_hba.conf)に「host all all 127.0.0.1 255.255.255.255 trust」を追加する (3)ファイアーウォールをはずす。 あと、tcpipによる接続を許可しなければならないため、postgresql.conf を編集し、 tcpip_socket=false　を tcpip_socket=true に変える という記述がありましたが、 postgresql.conf に tcpip_socket という項目はみつかりませんでした。 postgreSQLのバージョンは8.4を使用しております。 また、プラットフォームはAndroidを使用しております。 AndroidでJDBCが使えるかどうかという疑問は残りますが、 JDBCを追加した際にエラーなどが起こらなかったため、 問題ないという認識でいます。 お門違いな認識・記述が多々あるかと思いますが、よろしくお願いします。
PostgreSQLでのTimestamp列と数値列同士の演算での質問です。 Timestamp型のField:Aと、数値型のField:Bを保持するテーブルにて、 AのB分後を求める時刻の演算方法を教えてください。 単純に Select A + B from hoge だと、1日後になり時刻の部分が失われてしまいます。 下記のテーブルに対して発行すると A　　　　　　　　 B --------------------------------------------------- 2010-01-01 09:00:00+09 1 2010-01-01 10:00:00+09 5 ?column? ------------ 2010-01-02 2010-01-06 が返ってきます。 分かる方がいましたら教えてください。 宜しくお願いいたします。
サーバで7.4.8が動いている状態で、8.4.1をインストールしたいと思っています。 ./configure --prefix=/usr/local/postgres-8.4.10/ make make install といった形でインストールを行ないましたが、 --with-pgport=5433 とポートの指定忘れてしまいポートが被ってしまっているようで、うまく動きません。 そこで、「--with-pgport=5433」のオプションを付け足したいのですが、どのように行なえばよいでしょうか？ （DB、TABLEなどは一切作っていません） もし、後で付け足すことができないのであれば、再インストールを行ないたいのですが、 ./configure --prefix=/usr/local/postgres-8.4.10/ --with-pgport=5433 make make install といったように、行なえば上書きインストールしてくれるのでしょうか？ よろしくお願い致します。
RHEL5.2にPosgresql8.3をインストールしたのですが、 psqlでDB接続時に下のメッセージが表示されます。 WARNING: You are connected to a server with major version 8.3, but your psql client is major version 8.1. Some backslash commands, such as \d, might not work properly. version8.1を入れていないのになぜか表示されてしまいます。 動作的には特に問題なさそうなんですが、気になっています。 対応方法などありましたら、教えてほしいのですが、 どうぞよろしくお願いします。
Postgres 8.3.9を使用しています。 現在使用しているテーブルの中に HTMLソースを格納しているカラムがあります。 テーブル名：contents カラム名：text ※データ例：<a href="http://www.google.co.jp">グーグル</a> HTMLソースが格納されたカラムに対して、キーワードでの検索を行いたいと考えています。 当然ながら以下の様に検索をすると、HTMLソース（例：href）をキーワードとしても検索に引っかかってしまいます。 select * from contents where text Like '%【検索キーワード】%'; なんとか、HTMLソースをキーワードとした場合は検索されずに、 HTMLタグに囲まれた部分（※上記データだと'グーグル'）をキーワードとした場合にだけ、 検索されるようにしたいと考えています。 何か良い手法はないでしょうか。 ご教授をお願い致します。
PostgreSQLの8.1.15を使用しております。 3時間ほどかかるバキューム処理を高速化させたいと考えているのですが、 設定関連でチューニングする事は可能なのでしょうか？ もし可能でしたら、その方法、もしくは関連サイトをご教授頂けませんでしょうか。 よろしくお願いします。 尚、autovacuumは負荷対策として現在停止しており、 日次でanalyzeオプションにてvacuumしております。
すでにあるsqlファイルを使用して、データベースを作成する方法 もらったシステム（html,php,sqlで構成されるシステム）を自分の環境で動かそうとしているのですが、データベースを作成できないため、先に進むことが出来ず困っています。 もらったシステムには、テーブルのsqlファイルや、そのテーブルに入れるデータのsqlファイルがありました。 わかりにくい文章ですいません。 どなたかご存じの方、ご教授お願いいたします。 OS: CentOS5.3 postgresql8.1.18 apache2.2.3 php5.1.6
ＣＳＶファイルのロードについて教えてください。 過去データをロードしたいのですが、 ロード先のテーブルには一部重複したデータが既に存在していて、 重複エラーとなりロードできません。 ロードするデータ量は多く、CSVファイルから重複部分を取り除くのは大変なため、 エラーを無視して、重複していないデータのみをロードするような方法があればと思い 質問させていただきました。 よろしくお願いします。
Windows版のPostgreSQL 8.3でデータベース名だけを変更する方法が知りたいです。 MySQLや他のデータベースも同じ方法で可能なのでしょうか？
RDB（リレーショナルデータベース）とRDBMS（リレーショナルデータベースマネージメントシステム）の違いは何なのでしょうか？ RDBは単体ではデータを関連付けて保存することしかできなくて、そこから条件に合ったデータを抽出したり検索したりするのがRDBMSという事なのでしょうか？ 今まで同じ意味だと思っていましたが、 （例） （PostgreSQLをインストールするだけで、データを関連付けて保存できて、抽出も検索もできる） この認識は間違っているのでしょうか？ 基本的なことで申し訳ございませんが、よろしくお願いいたします。
LinuxのPostgres7.2からWindowsのPostgres8.3に DB移行を使用としています。DBは移行後もEUC_JPです。 【行った手順】 Linux ・pg_dump -F p DB > test.sql　 FTP ・FTPクライアントソフトで、ファイルをWindowsマシンに転送 Win ・createdb -U postgres -h localhost -E EUC_JP DB ・psql -U postgres -h localhost DB ・windb=# \i C:/test.sql LinuxからDumpし、Winのコマンドプロンプトでtest.sqlを実行すると 下記のエラーが発生します。 invaild byte sequence for eoncoding "EUC_JP":0x8de5" 元のファイルも、移行先のDBもEUC_JPなのに、どうしてこのような エラーが発生するのでしょうか？ どなたかお知恵をお貸し下さい。
現在当方、postgresql-8.2.11にてDBサーバを構築しております。 そろそろ、マシン自体も古くなってきたので載せ替えをしようと 試みているのですが、うまく行きません。。。 新しいマシンにはpostgresql-8.4.0をインストールしました。 旧サーバからpg_dumpallにて全データをダンプして新サーバへ リストアしたのですが、serverlogに下記のログが出てきて、 pgadmin3の様な接続ソフトから接続できません。 WARNING: nonstandard use of \\ in a string literal at character 70 HINT: Use the escape string syntax for backslashes, e.g., E'\\'. ERROR: column c.reltriggers does not exist at character 240 STATEMENT: SELECT c.oid, obj_description(c.oid), c.relhasoids as hasoids, n.nspname AS schemaname, c.relname AS tablename, pg_get_userbyid(c.relowner) AS tableowner, t.spcname AS "tablespace", c.relhasindex AS hasindexes, c.relhasrules AS hasrules, (c.reltriggers > 0) AS hastriggers, c.relacl, c.reltuples, ((select count(*) from pg_inherits where inhparent = c.oid) > 0) as inhtable FROM ((pg_class c LEFT JOIN pg_namespace n ON ((n.oid = c.relnamespace))) LEFT JOIN pg_tablespace t ON ((t.oid = c.reltablespace))) WHERE (c.relkind = 'r'::"char") リストア後は正常にデータベースもできていますし、テーブルの内容も 問題なくリストアされているようでした。 ダンプされたファイルも秀丸にて確認してみましたが問題ないようでした。 どなたか何か情報をお持ちであれば教えてください。 よろしくお願いいたします。
Debian 4.0で、 psql dbでdbたちあげるのはわかるのですが このあとどうすればいいのかわかりません（T_T) select * from とか構文はわかるんですが Debian 4.0のデータベースの操作はどうすればいいんでしょう？ 模範的　典型的コマンドをおしえてください 例えば データベースじゃなくて単なるlinuxだったら ls- l,pwd,uname,lsmodなどなどのコマンドみたいなものです。。。
こんにちは。かなり困っています、よろしくお願いします＞＜ PostgreSQL 7.2.8 を使用しています。 一つのユーザーで、二つのデータベースがあります。 それぞれ同じカラムを持つ同じ名前のテーブルがあります。 中のデータは違います。 db1 - tableT db2 - tableT 条件を付けて、db1のtableTのデータを db2のtableTへコピーするにはどのような方法がありますか？ 例えば select * from db1.tableT tbl1, db2.tableT tbl2 where tbl1.title = tbl2.title; のようにしてとりあえずselectで試してみましたがダメでした。 やはりスキーマとデータベースは違うんですね＞＜ ドットが認識されませんでした。 どなたか解決法をご存知の方、よろしくお願いします。
pgadminを最近使い始めました。 pgadmin1.10で、データベースに接続すると 『オートバキュームの権能を付与することを推薦します 』 と表示されます。 データベースには接続出来るのですが、何か不具合があるのか気になります。 お手数ですが、ご存知の方おりましたら、 オートバキュームの意味をお教え頂けませんでしょうか。 宜しくお願いいたします。
全角アルファベット（または数字）１文字を含んでいるものを問い合わせるときには、以下のようにLIKE句で指定しますが、 WHERE KOUJI_MEISYO LIKE '%Ａ%' 検索結果には上記の例の場合、全角アルファベット「Ａ」を含んでいるものがヒットしますが、中には全く含まれていないようなものがヒットする場合がありました。今回実際にあったものを載せておきますが、 （指名競争）大分都市計画道路県庁前古国府線道路測量設計業務委託 という文字列です。文字コードの並びで「Ａ」と認識してしまうような症状に陥っているのかなと思いますが、このようなケースに遭われた方はいますか？きちんと検索できるようにするにはどうすればよろしいでしょうか？ アドバイスやヒントを頂ければ幸いです。
PostgreSQL + PHP による Web アプリケーションを開発しています。 ある日付時点での各商品単価が取得できるSQLを考えていますが良い考えが浮かびません。 たとえば、以下のように2009年11月18日時点での価格一覧が取得できないでしょうか？ 牛丼（小）300円 牛丼（並）350円 牛丼（大）470円 サラダＡ　200円 サラダＢ　205円 サラダ盛合せ　498円 テーブル設計に問題があるのかもしれませんが... テーブル設計は以下のとおりです。 ブラウザによっては崩れて読みにくいかもしれません、ご容赦ください。 ■商品マスタ ┏━━━━┳━━━━━━━┳━━━━━━━┓ ┃商品ID　　┃　商品詳細ID　　┃　　　商品名　　　┃ ┃　　　　　 1┃　　　　　　　　 200┃牛丼（小）　　　　┃ ┃　　　　　 1┃　　　　　　　　 300┃牛丼（並）　　　　┃ ┃　　　　　 1┃　　　　　　　　 500┃牛丼（大）　　　　┃ ┃　　　　　 2┃　　　　　　　　　　 1┃サラダＡ　　　┃ ┃　　　　　 2┃　　　　　　　　　　 2┃サラダＢ　　　┃ ┃　　　　　 2┃　　　　　　　　　　 3┃サラダ盛合せ　　┃ ┗━━━━┻━━━━━━━┻━━━━━━━┛ ■商品価格 ┏━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━┓ ┃商品ID　　┃　商品詳細ID　　┃　　　単価適用日　　　┃　　　単価　　┃ ┃　　　　　 1┃　　　　　　　　 200┃　　　　　　2009-10-01┃　　　　　　 300┃ ┃　　　　　 1┃　　　　　　　　 200┃　　　　　　2009-11-30┃　　　　　　 280┃ ┃　　　　　 1┃　　　　　　　　 200┃　　　　　　2010-02-05┃　　　　　　 320┃ ┃　　　　　 1┃　　　　　　　　 300┃　　　　　　2009-10-01┃　　　　　　 350┃ ┃　　　　　 1┃　　　　　　　　 300┃　　　　　　2009-11-20┃　　　　　　 370┃ ┃　　　　　 1┃　　　　　　　　 300┃　　　　　　2010-03-01┃　　　　　　 380┃ ┃　　　　　 1┃　　　　　　　　 500┃　　　　　　2009-09-30┃　　　　　　 500┃ ┃　　　　　 1┃　　　　　　　　 500┃　　　　　　2009-10-15┃　　　　　　 470┃ ┃　　　　　 2┃　　　　　　　　　　 1┃　　　　　　2009-10-01┃　　　　　　 180┃ ┃　　　　　 2┃　　　　　　　　　　 1┃　　　　　　2009-10-18┃　　　　　　 200┃ ┃　　　　　 2┃　　　　　　　　　　 2┃　　　　　　2009-09-05┃　　　　　　 210┃ ┃　　　　　 2┃　　　　　　　　　　 2┃　　　　　　2009-09-20┃　　　　　　 205┃ ┃　　　　　 2┃　　　　　　　　　　 2┃　　　　　　2010-02-02┃　　　　　　 170┃ ┃　　　　　 2┃　　　　　　　　　　 3┃　　　　　　2009-09-01┃　　　　　　 480┃ ┃　　　　　 2┃　　　　　　　　　　 3┃　　　　　　2009-09-15┃　　　　　　 500┃ ┃　　　　　 2┃　　　　　　　　　　 3┃　　　　　　2009-11-02┃　　　　　　 498┃ ┃　　　　　 2┃　　　　　　　　　　 3┃　　　　　　2010-01-20┃　　　　　　 470┃ ┗━━━━┻━━━━━━━┻━━━━━━━━━┻━━━━━━┛ 長文すみません、よろしくお願いいたします。
以下のようなDB内に顧客id(ユニーク)とhob1,hob2,hob3のようなカラムがありまして、hob1,hob2,hob3には任意で趣味を表す値が入っております。 【hoge_db】 id | hob1 | hob2 | hob3 1 | 1 | 2 | 3 2 | 2 | 3 | NULL 3 | 3 | NULL | NULL 3 | NULL | NULL | NULL ・・・ 【SELECTしたい値】 趣味1:1名 趣味2:2名 趣味3:3名 この各趣味を表す値に対する顧客数を求めたいのですが、3つのカラム全てに対してCOUNTをする方法が分かりません。。 どうかSQLにお強い方、お力を貸して頂けないでしょうか？
例えば bigCategory,midleCategoryテーブルがあり、（今回はmiddleCategoryがbigCategoryときーでつながっている） create table bigCategory ( num integer not null primary key, name varchar(20) not null, ); insert into bigCategory values(0,'category_1'); insert into bigCategory valuers(1,'category_2'); create table middleCategory ( num integer not null primary key, name varchar(20) not null, bigkey integer not null ); insert into middleCategory values(0,'middle_1',0); insert into middleCategory values(1,'middle_2',1); bigCategoryの変更・削除をするときに、 1)middleCategoryがselectされている →　変更不可 2)middleCategoryがselectされていない →変更・削除可能 3)また、middleCategoryはselectされてなくて、 bigCategoryテーブルの変更行が他からselectされていたら、変更・削除不可 といった状況を実現したいのですが、可能なのでしょうか？ 候補として、おもうはGRANTかな、と思ったりはするのですが。 いろいろ考えはするのですが、解決策が思いつかず質問させてもらいました。 宜しくお願いします。
バージョンは、8.1.5 です。 下記のように外部参照された 2つのテーブルがあります。 userテーブル 　-------------------- 　userid　　　|　integer 　passwd　　|　text 　-------------------- user_rel_groupテーブル 　--------------------- 　userid　　|　integer 　gatid　　　|　integer 　--------------------- Foreign-key constraints: "user_rel_group_userid_fkey" FOREIGN KEY (userid) REFERENCES user(userid) そこで、 userテーブルからユーザーを削除した場合、 => DELETE from user where userid = 10030118; ERROR: update or delete on "user" violates foreign key constraint "user_rel_group_userid_fkey" on "user_rel_group" DETAIL: Key (userid)=(10030118) is still referenced from table "user_rel_group". とエラーがでますが、【　MySQL　】ではDELETE文にて、 DELETE member, user_rel_group FROM user LEFT JOIN user.userid = user_rel_group.userid WHERE userid = 10030118; のようにテーブルを結合して、複数のテーブルのレコードを削除できるようですが、 PostgreSQLは、出来ますでしょうか？ また、 テーブル作成時に、 CREATE TABLE user_rel_group ( 　　userid integer, .... 　　constraint group_user_foreignkey 　　foreign key(userid) references user(userid) on delete cascade ); と、制約が必須だったのでしょうか？ どなたかご教授お願い致します。
初心者で、いつもお世話になっております。 今、要件定義からデータベース設計を行ってます。 ORACLEのカラムではnullと''と言う概念は無かったのですが、 Postgres上では、Nullと''は別ものと言う事で、 CREATE　TABLE文でVarcharのものを「''」でデフォルト設定した方が、 今後、開発する上で楽になるのでしょうか？ なにか良い案があれば、参考程度にアドバイスしていただけると幸いです・・・
VC++ 2008からデータベースにアクセスしようとしていますが fe_sendauth : authentication type 5 not supported となってしまいました。 いろいろ探してpg_hba.confファイルの中のクライアント認証 を「md5」->「password」に変更したら 無事クライアント認証を行えるようになれたのですが md5のままで今回は行わなければならなくなってしまいました どなたかmd5のまま認証を行える方法をご存知の方いらっしゃいましたら 教えていただけないでしょうか？
環境：LINUX　Postgres8.4.0 デットロックを回避する為に、自動コミットをやめ、手動コミットに変更したいです。 psqlで\set AUTOCOMMIT offとすると確かに手動コミットになってしまいますが、 毎回設定するのは、手間がかかるのとシステム全体に反映されません。 システム全体を手動コミットに変更するには、どうしたら宜しいのでしょうか？
いつもお世話になっております。 社内にテスト環境を作成しようと、CentOS 5 にpostgres8.4.0をインストールした所、そのサーバ自体からは、dbの作成、tableの作成等sqlの発行は出来るのですが、同じネットワークのwindowsクライアントマシンからpgAdminIIIで接続しようとした所、左下に "データベースに接続...失敗しました"とエラーがでてしまいます。 サーバの設定 "pg_hba.conf"は host all all 192.168.0.0/16 trust を追加（クライアントはこのアドレス内です） "postgresql.conf"は listen_addresses = '*' port = 5432 の行を上記のように変更 CentOSのサーバにはping飛びます。 pgAdminの設定は、 アドレス（サーバIP）、記述（設定名）、ＤＢメンテナンス（DB名）、ユーザー名（postgres)、portはそのまま"5432" で接続しようとしています。 サーバ側のインストール手順は実際に行った手順を書いてましたが、 添付ファイルのような感じです。 どこがいけないか調べるにはどのようにすれば良いでしょうか。 よろしくお願いします。
vb.netにてプログラムを作成して使用しており、DBはpostgresqlをodbc接続にて使用しております。 ある端末で処理が極端に遅く、デバッグにて検証したところ、DB処理で時間がかかっていることがわかりました。 それに伴い同端末で別システムのoracleへのodbc接続も同じ現象となっている状況です。 この端末ではpostgresqlのodbcドライバの入れ替えを行ったことがあり、その頃から遅くなったようです。 また、別の全く同じ環境の端末では特に問題ない処理速度で稼働しております。 odbcドライバの入れ替えは何度か行っておりますが改善されません。 改善方法をご存じの方はおられますでしょうか？
PostgreSQLで別データベースのテーブルを参照することはできますか？ 仮に以下のデータベースが２つあるとします CREATE DATABASE common_db ... CREATE DATABASE app1_db ... app1_db に接続した状態で common_db のテーブルを参照することはできますか？ 仮にcommon_dbに郵便番号テーブル postcodeがあるとします CREATE TABLE postcode ( postcode text, --郵便番号 pref_name text, -- 県名 　・・・ ) このpostcodeテーブルをapp1_dbに接続した状態で参照するには、どのような参照クエリになりますか？ ご教授の程よろしくお願います。 そもそもできないのでしょうか？
RHEL4.6にPostgres8.1.11をインストールしています。 データ領域のファイルシステムはext3です。 データ領域の拡張が必要になった場合は、新しくext3の領域を用意しデータ領域を丸ごと移動しなければいけないでしょうか？ 以上、よろしくお願いします。
PostgreSQL8.2とJavaを使ったWebアプリケーションを構築しています。 pgAdminでサーバー状態＞ロック　で参照してみたところ、AccessShareLockというのが大量に発生していました。 マニュアルを参照してみたところ、 >AccessShareLock を除き，トランザクション内で獲得されたすべての ロックモードは，そのトランザクション実行の間維持されます． とあり、つまりAccessShareLockはトランザクションの間でも維持されないということだと思うのですが、どうも解放されてはいないようです。 これは通常の（つまり、更新しない）select文を発行したときに発生するロックだと思うのですが、いろいろ調べても、どうもこのAccessShareLockというのをどのくらい気にしたらいいのかがわかりません。 このロックが残っていると、どのようなときに困るでしょうか。 また、解放するためには通常のselectのあとでもcommit（またはrollback）をする必要があるということになるでしょうか。その際にはcommitとrollback、どちらがいいということはあるでしょうか。 ご存じのかたがいらっしゃいましたらご教示いただければと思います。よろしくお願いいたします。
PostgreSQLで作ったデータベースを 別のFedoraのPCに入れたいのですが どのファイルを古いPCから新しいPCにコピーしたら いいでしょうか? よろしくお願いします。
失礼します。 実は最近、授業で必要だということでPostgreSQLの8.3.7を インストールしたのですが、1度目は上手く起動したのは いいのですが、2度目から、なぜかパスワードが全く合わず PostgreSQL Database Sever8.3に接続することができなくなりました。 （パスワードは外部に接続しないということなので 忘れないように「password」にするようにとのことだったので パスワードが間違っていることはまずありえません。） どこかのサイトでpg_hbaファイルの最後にあるmd5をtrustに 変えればできるとあり、やってみたのですが、上書き自体不可能 でした。 とりあえず、再インストールしようとして、1度削除し、 インストールしなおそうと思ったら、インストール画面で ユーザー名、パスワードを入れる欄があり、何度やっても、 「パスワード」が間違っています、と表示され、先に進めません。 （何も入力しなくても、passwordと入力しても先に進めません。） 教授やスタッフに聞いてみたのですが、日本語が読めないため 助けられないと結局、放置されています。 ただ、授業でどうしても必要らしくできることならば、 もう1度インストールして使用したいのですが、 何か手があるならば教えて頂きたく、 質問させて頂いたのですが・・・ もし、よろしければ、ご回答お願いします。
いつもお世話になっています。 TO_NUMBER実行時、結果はnumeric型で取得できると思うのですが、 その値をカラムに追加することはできるのでしょうか？ insert into number2 values((select numberStr,TO_NUMBER (numberStr,'000.000') from number),'aaa'); 実行すると、 副問い合わせは1列のみを返さなければなりませんというErrorが生じます。 なのでwhere句を追加しましたが、結果は同じです。 実行したsqlは、 create table number ( count integer not null primary key, numberStr varchar(20) not null ); create table number2 ( no numeric not null primary key, numberS varchar(30) not null); insert into number values(5,'555.55000'); insert into number2 values((select numberStr,TO_NUMBER (numberStr,'000.000') from number where count=5),'aaa'); です。 宜しくお願いします。
Pg.pmをインストールしたいので、以前ダウンロードした下記サイトにアクセスしたのですが、何故かここには無いようです。 http://gborg.postgresql.org/project/pgperl/download/download.php このモジュールはどこで入手できるか、ご存知でしたら教えていただけませんでしょうか。 念のため、環境は、 REDHAT 　　　：RHEL5 PostgresSql　：8.1.11_1 となります。 よろしくお願いします。
postgreSQLで更新後のデータを取得したい。 初めて質問させていただきます。 postgreSQLでupdateした後、更新後のデータをselectで取得したいのですが、 トランザクションが完了するまでにselect文が発行されているみたいで、更新前のデータを取得してしまいます。 それぞれ、違うファイルから投げられているので、同じトランザクションにすることはできません。 何かいい方法があればご教授お願いします。 a.phpで下記のSQLを発行 update test_tbl set test1 = 'aaa' where test2 = 'bbb' a.phpが走っている間に、下記のb.phpが実行される。 select test1 from test_tbl 環境 php5 postgres8.1
ページ名 ｜ ユーザID mypage | 2 other | 2 other | 4 mypage | 2 index | -1 index | -1 mypage | 2 other | 3 other | 2 mypage | 2 index | -1 index | 3 上記のテーブルのように、ページ名とユーザIDが多対多のような関係になっている時に、 各ページにアクセスしてきたユニークユーザ数を取得したいと考えております。 上記の例ですと、求めたい答えは下記となります。 mypage:1　アクセスしたユーザは、2だけなので、ユニーク数は1 index:2　アクセスしたユーザは、-1と3なので、ユニーク数は2 other:3　アクセスしたユーザは、2と3と4なので、ユニーク数は3 group byで分けて集計すれば良いと単純に考えたのですが、 selectの対象は、group by　の対象で無ければならないみたく、 どのように集計すれば良いのか、とても困っております。 大変申し訳ありませんが、ご教授願えませんでしょうか？ 宜しくお願い申し上げます。
OSはWindows Server 2003 for Small Business Serverで、　PosstgreSQL 8.2です。 ブラウザーで動くシステムですが、完成していてずっと動いていたものが、ある日突然起動してパスワードが通るとすぐにエラーメッセージが出て何もできなくなりました。完成してから問題が起きるまで、システムを利用し、データーベース入力をする人はいても、プログラムに手を加えることはありませんでした。なのに、突然エラーが起るようになったらしいのです。 エラーメッセージを下に表示しますが、このようなメッセージの経験のあるかたがいらっしゃったら、どういうことを言っているのか教えていただけませんか？ 壊れてしまったのか、手を加えられた（人為的に）可能性があるのか？ 直せる可能性はあるのか？せめてデーターだけでも救えないのか？ そんなことが少しでもわかることができれば本当に助かります。 エクセルにデーターを取り込もうとしましたが、そもそもODBCに接続ができないようで一たん断念しました。 よろしくお願いします。 エラーメッセージは： Warning: pg_connect() [function.pg-connect]: Unable to connect to PostgreSQL server: could not connect to server: Connection refused (0x0000274D/10061) Is the server running on host "localhost" and accepting TCP/IP connections on port xxxx in 以上です。よろしくお願いします。
シンプルな質問ですが、 データベース一覧を確認する方法を教えてください。 以外にサイトに載っておりません。 宜しくお願いします。
Postgresqlの運用をしています。 定期的にバキュームフルをしようと思うのですが、バキュームフルを実行しているときにDBへの操作(select、insert、update、delete)は可能でしょうか？ リスクを考えて実行しなければいけないようでしたら、参考になるようなサイトを教えていただけないでしょうか。 よろしくお願いします。m(_ _)m
以前こちらで 「重複するキーから一番古い年月日のデータのみ取得したい」 http://oshiete1.goo.ne.jp/qa4857546.html と言う質問をさせて頂きました。 その内容に追加で質問があります。 テストテーブルにはコード、枝番、年月日、優先の4種類のデータがあります。 テストテーブルはコードと枝番を主キーとします。 1つのコードに対して、重複しない枝番が複数登録可能となっています。 取得するデータはコード、枝番、年月日、優先の4種類のデータを取得し、 更に今回は同じコードの中で「優先」が「優先する」のデータで一番古い年月日のデータを優先的に取得する。 同じコードの中で「優先」の「優先する」がなければ(全て「優先しない」の場合)、その中から一番古いデータを優先的に取得したい。 上記の内容のデータを取得したいのですが、今回ばかりは全くSQL文が思い浮かびません・・・・ 自分の力量不足なのは重々承知しております。 ヒントでも何でも構いませんので、ご回答ご教授の程お願い致します。 Postgresのバージョンは8.0.3で試しております。 ■テストテーブルのデータ コード │ 枝番 │ 年月日 │ 優先 ----------------------------- 1 │ 1 │ 2009-01-01 │ 優先しない 1 │ 2 │ 2009-01-03 │ 優先する 2 │ 1 │ 2009-02-15 │ 優先する 2 │ 2 │ 2009-02-10 │ 優先する 2 │ 3 │ 2009-02-20 │ 優先する 3 │ 1 │ 2009-03-15 │ 優先しない 3 │ 2 │ 2009-03-10 │ 優先しない 3 │ 3 │ 2009-03-05 │ 優先しない 3 │ 4 │ 2009-03-01 │ 優先しない ↓↓↓ ■望んでいる取得結果 コード │ 枝番 │ 年月日 │ 優先 ----------------------------- 1 │ 1 │ 2009-01-03 │ 優先する 2 │ 2 │ 2009-02-10 │ 優先する 3 │ 4 │ 2009-03-01 │ 優先しない
データベースの実装で、初めに３つのテーブル（memberInfor,goodsInfor,orderInfor)を作りました。次に、ビュー作成で create view result_list as select memberInfor.membernum, memberInfor.name, goodsInfor.goodsname, orderInfor.orderday, orderInfor.number from memberInfor join goodsInfor join orderInfor on memberInfor.membernum=orderInfor.membernum and goodsInfor.goodsname=orderInfor.goodsname; ERROR: syntax error at or near ";"(文字位置: 277) 1行目：...for.membernum and goodsInfor.goodsname=orderInfor.goodsname; 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　^ このように、実行するとエラーが出てしまいます。この解決方法が分かりません。どなたか教えていただけませんか？
タイトルのままなのですが、 csvファイルのデータを既存のデータと比較して重複なしで登録する方法を教えて下さい。 重複というのは、商品IDみたいなものです。
C♯、PostgresSQL 8.3.7環境です。 クライアント側からDBへの接続が出来なくて困っています。 「Npgsql2.0.5-bin-ms.net」をダウンロードし、VisualStudioより Npgsql.dllの参照を追加しました。 DB接続を行うクラスにて、 using System.Data; using Npgsql; を記述、下記のようにコネクションを開いて閉じるだけのコードを 書いてみました。 //接続のテスト NpgsqlConnection conn = new NpgsqlConnection("Server=xxx.xxx.xx.xx;Port=5432;User Id=xxxx;Password=xxxx;Database=xxxx;"); conn.Open(); conn.Close(); しかし、conn.Openの段階で、添付画像のエラーが出ます。 (IOException) サーバ側の設定はノータッチなのですが、担当者はlisten_addresses = '*' は しているとのことでした。 修正、確認すべき箇所をご教授いただけないでしょうか。 宜しくお願いします。
あるテーブルのある項目（整数値とします）に整数を足すことを1行で表現できる命令文はありますでしょうか。 例えばcharaというテーブルのname「勇者」というレコードのkeikenchiというフィールドに5を足したいとします。 もともと入っている数値を知る必要はありません。 5を足した数がkeikenchiのフィールドにアップデートされればいいのです。 問い合わせとアップデートを一回で済ませようという横着な考えですが、このようなことは可能でしょうか。 通常であれば問い合わせをし、数値を足し、足された値をアップデートするという手順だと思います。 もしありましたらご教授いただければ幸いです。
閲覧ありがとうございます． 現在SQLでデータベースの勉強をしているのですが，existsを用いて商演算を行おうとしてわからない箇所が出てきたので，その点に関しての質問をさせて頂きます． 例として，Ａ，Ｂと名付けた２つのテーブルを最初に用意します． [テーブル１（名前：机１）] | 番号 |氏名|年齢|　好物　| --------------------------- | １２ | あ | １ | りんご | | ２３ | い | １ | すいか | | ２３ | い | １ | りんご | | ４５ | え | ３ | すいか | | ４５ | え | ３ | りんご | [テーブル２（名前：机２）] |　好物　| ---------- | りんご | | すいか | この机１を机２で割ることで，この要素を含む氏名を取り出したいと考えて，以下のようなＳＱＬ文を実行しました． select 氏名 from 机１ A where exists( select * from 机２ B where A.好物 = B.好物); [求めている結果表示] | 番号 |氏名| ------------- | ２３ | い | | ４５ | え | [実際に表示された結果] | 番号 |氏名| ------------- | １２ | あ | | ２３ | い | | ２３ | い | | ４５ | え | | ４５ | え | 実行すると (1)氏名が重複で表示されてしまう (2)「りんご」のみ好物の「あ」も表示されてしまう という問題が発生してしまい，色々と調べて考えたものの，結局分からなかったので，今に至ります． 長文・駄文すみませんでした． まだSQLを学び初めて少ししか経っていないので，全く違うことをしていたらすみません．よろしければ，問題解決へのアドバイスをお願いします．
ID　　項目CD　　評価結果 ------------------------- A　　　1-1-1　　　○ A　　　1-1-1　　　○ B　　　1-1-1　　　× C　　　1-1-1　　　○ A　　　1-2-1　　　○ A　　　1-2-1　　　○　 B　　　1-2-1　　　○ C　　　1-2-1　　　〇 上記のテーブルがあります 評価結果は、○と×があり、項目CDごとに集計を行い、項目CDが同じ場合は、○がいつくあっても1とみなして計算するということをおこないたいです 理想SELECT結果 ID　　合計　 -------------- A　　　2　　　(1-1-1で○が2つあるが、1つとして計算) B　　　1　　　 C　　　2　　　　 SELECT ID,SUM(評価結果)　FROM　TABLE GROUP BY ID でIDと合計までは出せました 現在のSELECT結果 ID　　合計　 -------------- A　　　4　　　(すべての○の合計を出力) B　　　1　　　 C　　　2　　 項目CDが同じ場合"○"を1つとして集計するにはどうすればいいのでしょか？
Postgresqlのポイントインタイムリカバリとアーカイブログについての質問です。 バックアップは夜間に 1.バックアップ開始宣言　select pg_start_backup('bkup01'); 2.tarでベースのバックアップ 3.バックアップ終了宣言　select pg_stop_backup(); を実施後、日中障害が発生した場合は、障害前の時点に復旧しようと考えています。 アーカイブログを$PGDATA/data/postgres.conf内で別パーティションに保存するように設定しています。 上記の方法でポイントインタイムリカバリ実装可能でしょうか？ 現在、設定後しばらく動きを見ているのですがアーカイブログが保存されているディレクトリ内のファイルの更新が日に1回程度なので。アーカイブログの書き出しは1日1回程度なのでしょうか？変更可能なのでしたら教えていただけないでしょうか？ 以上、よろしくお願いします。m(_ _)m
PostgreSQLのデータベースでテーブルから、 "１件のレコードが見つかった時点で、他のレコードを検索するのをやめる" という事はSQLでできるのでしょうか？ 【テーブル名　Fruit　】 |　id　|　option　|　name　| 　1　　　　2　　　　　りんご 　2　　　　1　　　　　みかん 　3　　　　1　　　　　メロン 　4　　　　1　　　　　バナナ 　5　　　　4　　　　　いちご 上記のようなテーブルから、optionが1のレコードを検索する時、 どのレコードでもいいので、1件見つけた時点で他にも該当のレコードがあるかという検索の処理をしない。 という事はできるのでしょうか？ 出来るのであれば、膨大な数のレコードがある場合、検索の時間が減るのでは無いかと思ったのですが・・・ 現在は下記のSQLのように、OFFSETとLIMITを使用して１件のレコードを取得しています。 SELECT 　　　　　* FROM 　　　　　Fruit WHERE 　　　　　option=1 OFFSET　0 LIMIT　1 このやり方であっているのでしょうか？ または他の仕方があるのでしょうか？ 教えていただきたいです。 宜しくお願いします。
OSはCentOS5.2を使用しております。 データベースクラスタの格納先を変更したく PostgreSQLをrpmでインストールした後に #su postgers $vi ~/.bash_profile でPGDATAを編集後、環境変数へ反映。 $/usr/bin/initdb -D /usr/local/pgsql で初期化処理を実施後 /etc/rc.d/init.d/postgresql start と起動したところ、イニシャル処理も実施され デフォルトの/var/lib/pgsql/dataが作成されて しまいこちらの領域を使用して起動します。 どうすれば、ディレクトリを変更できるのでしょうか。 よろしくお願い致します。
社員への備品貸し出しの管理システムを構築しているのですが、 誰に何を貸し出しているかを把握するテーブルはどのように作成すればいいでしょうか？ 貸し出しテーブルと備品テーブルみたいなのがあり、 備品テーブルは備品の個数だけレコードがあるわけではなくて、 1種類につき1レコード、どんな備品なのかを管理するだけのテーブルを考えています。 社員が1種類しか備品を借りないのであれば、 貸し出しテーブル : 社員番号, 備品番号 備品テーブル : 備品番号, 詳細 みたいにすればOKだと思いますが、複数借りた場合だと貸し出しテーブルが1レコードでは管理ができなくなります。 貸し出しテーブルには上記以外にもカラムを複数入れるので、 1レコードで社員番号から借りている備品を抽出したいのですが、 上手くやる方法はないでしょうか？ （上記テーブルを変えたり、別のテーブルを作成するのはOKです。） よろしくご教示願います。
明後日までに人にサイトを見せる必要(面接です；)が急遽できてしまったので 急いで「Ribbon Networ」のレンタルサーバを借りました。 ですが…いままでlocalhostでしか接続したことがないので接続方法がわかりません；ｗ； 設定可能なPostgreSQLの ホスト・データベース名・ユーザ名・接続パスワード を教えてもらい直接JDBCで接続しようとすると 「サーバは閉じられています」とのこと レンタルサーバのサイトでは利用について ・PHP や Perl などの Postgres 用ライブラリなどを用いて操作を行ってください。 ・Ribbon Network 内のサーバからのみデータベースサーバへ接続できます と記載されていました。 （ちなみにPHP・Perlとも扱ったことないです） また、レンタルサーバーの利用可能なバージョンが8.3.1なのに対し、私が利用してるのは8.3.7です。 これも関係してるのでしょうか？ 羅列してしまったので質問内容まとめ 1.レンタルサーバーへの一般的な接続方法 2.PHP・Perlを必ず使わないと接続できないか (できればJAVA経由で接続したいです) 3.バージョンは一致しないと無理か かなり曖昧な質問で申し訳ありませんが なかなか自分で調べても答えを導くことができませんでした どうかお力を貸してください＞人＜！
WindowsにPostgreSQL8.3をインストールしたのですが、デフォルトユーザーpostgresのパスワードを変更する方法がわかりません。 SQLで行うのでしょうか？それとも何かツールがあるのでしょうか？
PostgreSQL8.3を使っています。 インストールしているCドライブの空き容量が少ないので、PostgreSQLのディレクトリ全てをDドライブに持っていき、動作させたいのですが可能でしょうか。 データだけでもDドライブにして、通常どおり動作させたいです。 できればわずかな設定変更で済めば嬉しいです。
PostgreSQL8.3系を使っています。 PostgreSQLのserial型を使って、連番を意識せずINSERTして登録しているのですが、直前に登録した連番(serial)が知りたいことがありまして、 簡単に取得する方法がわかりません。 気になる点ですが書きこんだ後、他から書き込みがあった場合の直前は他のデータになると思うので、書き込んだ直後のserialフィールドのmax値はあてにならないと考えますが、詳しい方教えてください。 書きこんだ直後についでに何か取得できる（書きこんだときのserial値がわかる）方法はあるのでしょうか？
DB初心者です。どなたか教えてください。 PostgreSQL8を利用しwebアプリケーションを開発しようと考えているのですが容量の制限などあるのでしょうか？ 例えば、「テーブル数は○個以下まで」「レコード数は○レコードまで」など
いつもお世話になっております。 WEB画面から入力された項目を対象にPostgresに検索しに行っているのですが、シングルクォート(')が入っていた場合、エラーになってしまいました。 JavaからSQLを生成し、Postgresに接続しているのですが、シングルクォートを検索させるにはどうするのが良いでしょうか。 またSQLに記述できない文字は、シングルクォートのほかに何かありますでしょうか。 よろしくお願いします。
タイトルのような現象が起こってしまっているのですが、対処方法はありますでしょうか？ 行数が増えてもcountの速度が落ちないようにしたいのです。 CREATE INDEX などは設定してあります。 ご教示お願いいたします。
例えば、Webシステムでフリーのデータベースを選択する際、 MySQL でなく PostgreSQL を選ぶにはどのような理由があるのでしょうか？ 両者最新安定版で比較して、MySQL の方が劣っている点とは どのようなものがあるのでしょうか？
val | num ----------- 9984 | 1 1234 | 1 9876 | 1 4567 | 1 9984 | 1 1234 | 1 9984 | 1 以上のようなテーブルで SELECT COUNT(*) FROM table_name WHERE val = 9984 SELECT COUNT(*) FROM table_name WHERE val = 1234 SELECT COUNT(*) FROM table_name WHERE val = 9876 SELECT COUNT(*) FROM table_name WHERE val = 4567 のように４つ実行することなく１度に 9984 => 3 1234 => 2 9876 => 1 4567 => 1 という結果を得たいのですが方法はありますでしょうか？ ご教示お願いいたします。
「column "A" does not exist」というエラーが出て、ビューを作成することができません。 postgreSQL（8.2）＆pgAdmin（1.6.3）で以下のようなビューを作成しようとしたところ、「column "A" does not exist」というエラーが出てしまい、作成することができません。 試しにＭＳ ＡＣＣＥＳＳで全く同じＳＱＬ文を発行してみたのですが、ちゃんとクエリが作成でき、以下の図のように問い合わせ結果を閲覧することもできました。PostgreSQLでも作成できる方法があればご教示いただけないでしょうか。 CREATE VIEW v_test AS SELECT 1 AS A, A + 3 AS B; +----+ | A | B | +----+ | 1 | 4 | +----+ 上図のように1という数値を格納する列「A」と、その列の値に3を足した数値を格納する列「B」で構成されるビューを作成できればいいのですが、どうしてもできません（実際はもっと複雑な内容なのですが、要は、直前に定義した列（A）の値を参照する列（B）を作成することができないのです）。 そもそもPostgreSQLではできないものなのでしょうか。それとも初歩的な何かが抜けているのでしょうか。 該当するような参考文献が見つからないため質問させていただきました。 どうかご教示いただけないでしょうか。
PostgreSQLを使用しています。 あるテーブルに重複したデータが4つ存在します。ユニークなキーは付いていません（全く同じデータです。）。 deleteで削除すると、4つ削除されますが、1つだけを残し、あとの3つだけを削除する方法は有りますか？
下記の事を実現するSQL文がどうしても分からず困り果てています。。。。 ご回答の程お願い致します。 テストテーブルにはコード、枝番、年月日の3種類のデータがあります。 テストテーブルはコードと枝番を主キーとします。 1つのコードに対して、重複しない枝番が複数登録可能となっています。 取得するデータはコード、枝番、年月日の3種類のデータを取得し、同じコードの中で年月日が一番若いデータのみ取得したいです。 同じような質問で http://okwave.jp/qa4089797.html と言うURLの回答を参考に SELECT コード , 枝番 , 年月日 FROM テストテーブル where (コード , 年月日) in (SELECT コード , MIN(年月日) FROM テストテーブル GROUP BY コード ); というSQL文を考えたのですが、 コードは同じで枝番は違うが年月日が同じデータがあると 望んでいない結果にならず、困り果てています・・・・ ■テストテーブルのデータ コード │ 枝番 │ 年月日 ----------------------------- 1 │ 1 │ 2009-01-01 1 │ 2 │ 2009-01-03 2 │ 1 │ 2009-02-15 2 │ 2 │ 2009-02-10 2 │ 3 │ 2009-02-20 3 │ 1 │ 2009-03-15 3 │ 2 │ 2009-03-10 3 │ 3 │ 2009-03-05 3 │ 4 │ 2009-03-01 ↓↓↓ ■望んでいる取得結果 コード │ 枝番 │ 年月日 ----------------------------- 1 │ 1 │ 2009-01-01 2 │ 2 │ 2009-02-10 3 │ 4 │ 2009-03-01
WindowsXP x64にPostgreSQL8.3.7を入れる予定ですが、 ODBCも必要になると思いますが、どこからダウンロードすることができますか？ 他のPCに8.2.4が入っていて、データベースに文字コードがユニコードで保存しているのですが、これをSJISにして、最新の8.3.7のPCに入れることは可能でしょうか？ pg_dump？で引数の方法など知りたいです。
はじめまして。 下記のようにCOPYを関数内で使用したいと考えています。 CREATE FUNCTION test(TEXT) RETURNS void AS $$ BEGIN COPY(SELECT * FROM table1) TO $1 DELIMITER ','; END; $$ LANGUAGE plpgsql; これをpgAdmin3で実行すると$1の部分でsyntax errorとなり関数が作成できません。 $1の代わりに 'C://temp/foo.txt' と書けば通るのですが、何か良い方法はないでしょうか？ やりたいことは、関数に保存先のファイル名を渡してデータをエクスポートするという処理です。 アドバイスお願いいたします。
PostgreSQL の 7 から8 へマイグレーション作業をしている者です。 int型で not null制約のあるカラム「id」 の値から、''(空)であることを判定する時、 version7 では、 $sql = "select * from tbl_name where id <> ''"; のSQL文で動いていたようですが、 version8 では、 型の扱いが厳しくなった訳か、syntax error となります。 この場合version8 では、 $sql = "select * from tbl_name where id <> 0"; が、 ''(空)であることを判定するSQL文と考えてよいでしょうか？ ご教授よろしくお願いします。
「アプリケーションを正しく初期化できませんでした（0xc0150002）。[OK]をクリックしてアプリケーションを終了してください。」が表示されるようになってしまいました。何が悪いのかよくわかりません。DLLが足りないのでしょうか？どなたか、ご教授を宜しくお願いします。 環境 VC6のアプリ、WinXP、Postgreのlibpq.dll ※Postgreはインストール ↓ VC6のアプリ、WinXP、Postgreのlibpq.dll ※Postgreは非インストール
情報学科の学生です。 趣味程度に部活でしている試合記録をデータベースでまとめようと思っています。 この点数で負けた記録、勝った試合、この期間の試合記録などが調べやすくなるかなと思うことと、SQLの勉強に繋がるかなと思ったのが理由です。 こういう内容をSQLでまとめることに適していると考えて大丈夫ですよね？ 皆さんの返信を見て参考書を買いにいこうと思っています。 よろしくお願いします。
ただいま、PostgreSQL、VB6.0を使用して開発中です。 日々レコードが追加される、A_DBにあるAテーブルのデータを バックアップとして、まったく構造の同じ、B_DBにあるBテーブルに差分をINSERTするようにしたいのですが、どのようにコードを記述すればよろしいでしょうか？ イメージ的には下記に近いのですが… http://ziddy.japan.zdnet.com/qa691870.html http://ziddy.japan.zdnet.com/qa1099610.html 初心者なので、不十分なところがあるかも知れませんが、ご回答よろしくお願いします。
こんにちは。 Linux+PostgreSQLでpg_hba.confの設定がよく分からず困っています。 リモートからは使用せず、localhostのみの接続を許可したいのですが、 どのように設定すればいいのでしょうか？ CentOS5+PostgreSQL8.1.9です。
ただいま、postgresを使用して開発中です。 そこで、下記のようなSQL文を書いているのですが、 できれば、多次元配列の「b.code」の記述順で表示したいのですが、 下記のSQL文を実行すると「a.code」の記述順で表示されます。 どのようなSQL文に変更すればよろしいでしょうか？ SQL: select a.name as aname , b.name as bname from atable a, btable b where a.code = any(b.code[1:1]); atable code | neme -------------- 2 | AAA 1 | BBB btable code | name ---------------------- {{1,2},{3,0}} | DDD 『現在の結果』 aname bname --------------- AAA | DDD BBB | DDD 『得たい結果』 aname bname --------------- BBB | DDD AAA | DDD 長くなりましたが、よろしくお願いします。
Ver8.3.3 現行のテーブルの値を、別テーブルへ移行したいのですが、 コーディングのしかたが良く解りません。 ｅｘ） Ａテーブル ＩＤ　 ビット合計１ ビット合計２ Ｂテーブル ＩＤ　 ビット合計データ種別 ビット合計 １レコードの物を、２レコードに変換する具合です。 サンプル等が記載されているサイト等を教えて頂ければ幸いです。 宜しくお願い致します。
現在、CSVファイルからCOPYコマンドを使用し、 データのINSERTを行いたいと思っております。 で試したところ、 COPY test from '/var/lib/pgsql/csv/insert.csv' USING DELIMITERS ','; とコマンドを入力した結果 ERROR: invalid input syntax for type date: "" CONTEXT: COPY test, line 1, column purchase: "" となってしまいます。 これを回避するためには、どうすればよいでしょう。 postgresqlは初心者なので、申し訳ございませんが 教えてください。よろしくお願いいたします。
現在、PostgreSQLを使用し、簡単なテストを しようと思っております。私は素人です。 ただ、下記の問題にぶち当たってます。 createdb --encoding EUC_JP test で「test」というDBを"EUC_JP"で作成 /var/lib/pgsql/data/postgresql.conf の client_encoding = EUC_JP を変更し、 posgre再起動。 INSERT INTO test VALUES (1,'山田太郎'); というINSERT文を投入したところ、下記エラーが発生。 ERROR: invalid byte sequence for encoding "EUC_JP": 0x8be9 HINT: This error can also happen if the byte sequence does not match the encoding expected by the server, which is controlled by "client_encoding". これってどうなんでしょう。 申し訳ないですが素人の私に教えてください！！ よろしくお願いいたします。
表題の件について質問させてください。 環境は PostgreSQL8.2.1 pgpoolにてDB2台で運用しております。 現在、とあるECサイトの運用などに携わっております。 1日平均が２～３千件の注文があり、注文情報を格納してるテーブルが150万件くらいになっています。 元々の作りが全てその注文テーブルに色々な情報を持たせてしまっており、更新頻度も結構高いです。 その状態で、現在は3時間に1回VACUUM ANALYZEをかけているのですが、その影響かはわからないのですが、セッション数(pg_stat_activityの件数)が正常運用時の3倍程度になる事が、ここ最近頻発しており、サイト全体の処理速度に影響しております。 １．VACUUM ANALYZEは、ロックがかからずにSELECT,UPDATE,INSERTなどが出来ると認識しておりますが、実行中に更新がかかっても問題ないという認識はあっておりますでしょうか？ ロックがかかったまま、セッションに残ってしまっているのは別の原因という事であっていますでしょうか？ ２．VACUUM ANALYZEの頻度として、3時間に1回という頻度は多いのでしょうか？ やはり、pg_stat_activityで監視をしていると、VACUUM ANALYZEの処理に時間がかかって、セッション数が多くなり、処理速度にかなり影響をあたえているのでは無いかと言う気がしてなりません。 以上、２点について、何かご教授頂ければ幸いです。 宜しくお願い致します。
主キーが文字列型のカラムhoge_idがあります。 (hoge_idは英数字8文字とします) hoge_idで、他のテーブルに結合します。 また、Webからアクセスする必要があり、URLのパラメータで、 ?hoge_id=A1B2C3D4 の様に、主キーを渡す必要もあります。 文字列を主キーにする方法に慣れていないせいか、気持ち悪く感じます。 主キーを別途serial型のカラムidを作成し、 hoge_idには、ユニークキーで設定をし、 結合や、URLのパラメータは主キーのidを使う方法はあまり意味がないでしょうか。 アドバイスを頂けませんでしょうか。 よろしくお願い致します。
テーブル名が違うだけで同じテーブル構造のテーブルが複数個あります。 仮にテーブル名を、A、B、C、Dの4個だとします。 テーブル名を格納するテーブルがあるので、そこから取得する方法でも構いません。 それらのテーブルから、フィールド名[名前]のデータを重複なしで取得したいのですが、SQL文が思いつきません。 取得するフィールドは[名前]だけです。 私の使用している環境はPostgreSQL8.1.9です。 SQL文を教えてください。よろしくお願いします。
こんにちは。いつもお世話になります。 PostgreSQLのversion7.2.8で、「not null」制約の追加、削除の方法をおたずねします。よろしくお願いします。 ALTER TABLE テーブル名 ALTER COLUMN カラム名 SET NOT NULL; で試したところ、syntaxエラー(構文エラー)で失敗。 ALTER TABLE テーブル名 ALTER COLUMN カラム名 DROP NOT NULL; で試してみても、同じくsyntaxエラーです。 version7.2.8が原因でしょうか？ また、version7.2.8でも「not null」制約の追加、削除が できる他の方法はありますでしょうか？ テーブルを作り直さずに、 既存のテーブルのカラムへの制約の追加、削除をしようとしています。 よろしくお願いします。
limit 1 を使用して検索を行っているのですが、 70万件程のデータを検索する場合には1秒以内にて返ってくるにも関わらず、 8万件程のデータを検索すると全く返って来なくなります。 ちなみにlimit 1000とすると瞬時に返ってきます。 どなたか、このような事象の要因や対処法などをご存知の方がいらっしゃいましたらご教授願えませんでしょうか。
PostgreSQLとmySQL どちらかのデータベースを選びたいのですが 両方使ったことがあるかた それぞれのメリット、デメリットを 教えてください
現在、postgresql8.2が入っているのですが、 postgresql8.3も共存させることはできるのでしょうか。 今まで、バージョン8.2を利用して作成したプログラムがあるので、8.2も残しておきたいのです。 バージョン8.3にすると、今まで8.2で作成したプログラムのSQL文が日付型等の指定が正しくない(?)為、 エラーになってしまう可能性があり、8.3に移行するわけにもいかず、困っています。 バージョン8.2がインストールされている状態で、バージョン8.3をインストールするだけで、問題ないのでしょうか。 現在、pgAdminnIII上には、「PostgreSQL Database Server 8.2」というサーバーがあるのですが、 インストールすると「PostgreSQL Database Server 8.3」等のように追加され、異なるバージョンが動くのでしょうか。 わかりづらい文章で申し訳ありませんが、よろしくお願い致します。
お世話になります。Sql初心者です。 round関数について質問があります。 double型のデータを少数点第一位までのデータを取得したいと思っています。 select round(double型の数値)ではデータが取得できますが、 double型のデータをselect round(double型の数値,1)という形で とするとエラーになってしまいます。 double型のデータをround関数で小数点指定で取得する場合は、どの様に 記述すればよいのでしょうか？ どなたかご教授願えますでしょうか？ 何卒よろしくお願いいたします。
下記のテーブルがあったとします。 【t_tblテーブル】 ――――――――――――― ｜id1　 ｜id2　｜id3 　｜ ――――――――――――― ｜1 　　｜1　　｜10 　　｜ ｜1 　　｜2　　｜12 　　｜ ｜1 　　｜3　　｜9　　　｜ ｜1 　　｜4　　｜8　　　｜ ｜1 　　｜5　　｜14 　　｜ ｜2 　　｜1　　｜14 　　｜ ｜2 　　｜2　　｜8　　　｜ ｜2 　　｜3　　｜9　　　｜ ｜2 　　｜4　　｜12 　　｜ ｜2 　　｜5　　｜10 　　｜ ｜3 　　｜1　　｜4　　　｜ ｜3 　　｜2　　｜2　　　｜ ｜3 　　｜3　　｜3　　　｜ ｜3 　　｜4　　｜5　　　｜ ｜3 　　｜5　　｜6　　　｜ ｜4 　　｜1　　｜6　　　｜ ｜4 　　｜2　　｜5　　　｜ ｜4 　　｜3　　｜3　　　｜ ｜4 　　｜4　　｜2　　　｜ ｜4 　　｜5　　｜4　　　｜ ――――――――――――― このテーブルの特定のレコードを抽出する為に、 2つパラメータを渡すとします。 1. 12 2. 8 そして下記の条件を満たすレコードのid1を抽出したいと思います。 1. 「id3」 = 「12」　かつ　「id3」 = 「8」　を満たすid1 (※この時点で1と2がヒットします) 2. 条件1を満たした上で、「12」のid2 < 「8」のid2 (※この時点で1のみヒットします) 下記のSQLで条件1を満たせる事は確認しましたが、 条件2を満たす方法が分かりませんでしたので、 アドバイスいただける方がいらっしゃいましたら、 ご教示いただきたいと思います。 select id1 from t_tbl group by id1 Having SUM(CASE WHEN id3=12 Then 1 Else 0 End)>0 And SUM(CASE WHEN id3=8 Then 1 Else 0 End)>0 使用バージョンは7.4.19です。 よろしくお願いします。
functionにおいて以下のようなSQLを実行する際に ''内を可変にできないものか悩んでいます。 select current_timestamp + '3 seconds'; select current_timestamp + '4 weeks'; select current_timestamp + '-1 days'; 安易な考えと笑われてしまいそうですが、 ''の部分をvarchar変数にして実行しようとしたら エラーとなってしまいます。 どなたか良いアイデアや、まずい点のご指摘を いただけたらありがたいです。 こんな感じでやってみました。 isec integer; tm1 TIMESTAMP; chr1 varchar(16); ---途中略 select current_timestamp + chr1 into tm1; ・・と書いたところエラーとなります。 isec := 3; select ''''||ltrim(to_char(isec, '99999999') || ' seconds') ||'''' into chr1; とか select ltrim(to_char(isec, '99999999') || ' seconds') into chr1; としてみて 「select current_timestamp + '3 seconds' into chr1」としたつもりです。 以上よろしくお願いします。
id | point ----+------- 1 | 10 2 | 9 3 | 5 .... というテーブルがあるとします. idを指定してpointを得たいのですが、そのidがこのテーブルに存在しない場合は空の結果ではなく0を返したいのです. plpgsqlなどを使いif文で場合分けすればできることはわかっているのですがSQL文だけで（それもできれば１文で）これを実現する方法はあるでしょうか？ よろしくお願い致します。
とあるテーブルのレコード数は、全部で２８レコードあります。 このテーブルにはインデックスを張っておらず、シーケンシャルスキャンでDBよりSELECTしています。 通常にシステムを運用する上では問題ないのですが、負荷試験などで同時接続数を50などにしループでDBにアクセスさせるとき、その他の4000万レコード程度あるテーブルをSELECTしてくるのは0.00xxx秒で行えるのに対し、この28レコードしかないテーブルからSELECTしてくる際は、遅い場合で0.xx秒もかかってしまいます。 この２８レコードしかないテーブルにインデックスを張っても、レコード数が少なすぎてまったく意味がありませんでした。 ちなみにこのレコードへは下記のようなSELECT文を発行しています SELECT xxx,xxx,xxx FROM xxxx where カラム1 = aaaa AND カラム2 IN (bbb,ccc) AND カラム3 = ddd; このレコードのSELECT文を高速化させるには、どのような手段があるでしょうか。 お手数ですがご教示いただけますと幸いでございます。 DBはPostgreSQL、PHPのWebアプリケーションよりDBにアクセスしています。
POSTGRESにはコマンド履歴を参照する機能などはございますでしょうか？ ご存知の方、アドバイスをお願いします。
初めてこちらで質問させていただきます。 PostgreSQLを使い始めました。（Ver. 8.3.5 を使用しています。） 今やろうとしている事は、MS SQL2000 のストアド・プロシージャを PostgreSQL用に書き換える事です。 MS SQL2000 用のストアド・プロシージャに、 select @lockid=rtrim(ltrim(loginname))+'@'+rtrim(ltrim(hostname)) from master dbo.sysprocesses where spid=@@spid というSQL文があり、 どのようにこれ（現在アクセスしているユーザIDを調べる） をPostgreSQL上で実現するかで頭を悩ませています。 問題は、現在のユーザーのプロセスのセッション ID（SQL2000 では @@SPID） をPostgreSQLでどのように調べるかなのですが、マニュアルのシステムカタログ の辺りを目を通してるのですが、なかなか見つけられず困っています。 ここを読め。や、こういうのを使うんだ。など解決への糸口、光を指さして、 情報を教えていただける方はいないでしょうか？どうか宜しくお願いします。
開発によるテストで外部からtcp/ip接続を行いたいので、 tcpip_socket = true という項目をpostgresql.confに追加してみましたが、 postgres起動時に以下のようなエラーにり起動できません。 起動時のコマンド： pg_ctl -D /usr/local/pgsql/data start -w -o "-S -i" エラー： FATAL: unrecognized configuration parameter "tcpip_socket" postmaster (PostgreSQL) 8.1.9 何か原因分かりますでしょうか。
初めてこちらで質問させていただきます。 どうぞよろしくお願いします。 早速ですが、 現在ストアドファンクション（PL/pgSQL）にて以下のような形になっています。 変数d1,d2,d3に値をセットするにあたり テーブルt1を３回スキャンしています。 これを１回のスキャンでセットするような 方法はないのでしょうか？ DECLARE d1 integer; d2 integer; d3 varchar(10); begin select min(c1) into d1 from t1; select min(c2) into d2 from t1; select min(c3) into d3 from t1; 各種処理 return v; end; 気持ち的には以下のようなSQLを書きたいのですが、 syntax error となります。 （NG例） select min(c1) into d1,min(c2) into d2,min(c3) into d3 from t1; 何か良い案がありましたら教えてください。 「それは出来ません」と言う回答でもありがたいです。 ※あきらめがつくので。。 それではよろしくお願いします。
テーブル名：　list no | first_name | last_name | comment ----+------------+-----------+--------- 1 | 太郎 | 山田 | ほげ 2 | 次郎 | 田中 | ふが 3 | 花子 | 山田 | ぴよ 4 | 三郎 | 佐藤 | ぴよ 5 | 太郎 | 山田 | ぴよ 6 | 次郎 | 田中 | ふー 7 | 三郎 | 佐藤 | ふー 8 | 花子 | 山田 | ふー 上記の表から同じ”last_name”を持つ人の”first_name”と”last_name”を重複無しで抽出する(下記のような結果)ＳＱＬ文は作成可能でしょうか。 結果 first_name | last_name ------------+----------- 太郎 | 山田 花子 | 山田 宜しくお願いします。
お世話になっております。商用のサーバーを運営しているものです。 最近私が運営しているサーバーでチャットをやることになっているのですが、できればワイセツなどの禁止用語以外は自由にしたいのですが、そうするとSQLインジェクションの心配があります。それで、ユーザーが入力した文字列を扱う部分を PQexecParams を使ってデータベースに入れようと思っているのですが、これだけで問題は解決できますか？　これでも危険な攻撃を受けるケースがあるならばお教えください。
ウェブページが見れなくなっているのですが、 どなたか情報をお持ちではないですか？ たぶん、サーバがダウンしてるのではないかと予想しているのですけど。 2008-12-12 18:00現在
お世話になります 　大規模商談をまとめた営業のリストを作るSQLを書こうとしています。 　 営業部員テーブル　（test.person） id | name ----+------ 1 | 山田 2 | 高橋 3 | 田中 商談テーブル (test.deal) id | person_id | customer | amount ----+-----------+----------+-------- 1 | 1 | XX商事 | 20000 2 | 3 | BB電機 | 10000 3 | 2 | ZZ不動産 | 2000 4 | 1 | RR証券 | 8000 期待している検索結果 name | amount | customer ------+--------+---------- 山田 | 20000 | XX商事 田中 | 10000 | BB電機 高橋 | 2000 | ZZ不動産 下記のようなSQLを書きました。 select distinct name,amount,customer from test.deal,test.person where person.id=deal.person_id order by amount desc 　しかし、nameをdistinctしているにもかかわらず、結果は下記の通り、「山田」が重複しています。 name | amount | customer ------+--------+---------- 山田 | 20000 | XX商事 田中 | 10000 | BB電機 山田 | 8000 | RR証券 高橋 | 2000 | ZZ不動産 いろいろと調べて、group by を使えばいい、というようなやり方を示している例も多かったのですが、それもうまくいきません。（必要であれば載せます） 期待通りの結果を得るにはどのようなSQLを書けばよろしいでしょうか。 よろしくお願いいたします。
表題の件で質問させて下さい。 以前までは特に問題なく、alter tableなどで列を追加出来ていたのですが、ここ最近、データ量が増えてきたためか、列追加にすごく時間がかかってしまっています。 それが原因なのかはわからないのですが、alter tableで列を追加すると、処理が止まってしまい、プロセスをkillして、とりあえず対処する・・・ と言うような対応が続いています。 調べたところ、alter table はテーブルロックがかかってしまうらしいのですが、これは begin でトランザクションを開始させても特に意味はないのでしょうか？ いろいろと調べてはいるのですが、基本的な事は見つかるのですが、運用する時にどういった注意点があるか等が今いち、調べ切れませんでしたので、どんな運用をしていけばいいのかご教授して頂けると助かります。 宜しくお願いいたします。
　ある製品の部品、その部品を構成する部品、そしてその……というデータをDBに格納しています。 　それぞれの部品にはIDがついていて、ツリーで見るとこんなかんじです。 　 100 +120 　+300 　　+250　 　　+290 　これは、100というIDを持った部品にはIDが120の部品があり、120の部品には300という部品があり、、、、ということを表しています。 　これを以下のようなテーブルに持っています。 items id | child_id | ---------- 100 | 120 | 120 | 300 | 300 | 250 | 300 | 290 | 　ここで、ある部品のIDをキーにして、その部品を構成する部品全て（つまり、子部品、孫部品、ひ孫部品……）のIDを検索するようなSQLを書きたいと思っていますが、巧い方法が思い浮かびません。（今は10階層あったら、10回SQLを発行しています） 　これを1回のSQLで、全てを検索することはできないでしょうか。言うまでもありませんが、10回のSQLよりもパフォーマンスは良くないと困りますが。。。 　周りの人はみんなできないんじゃないかと言っていますが、もしできる、という方法をご存じの方はご教示いただければと思います。 　DBはPostgreSQL8.2ですが、MySQL5を使っているアプリでも同様の問題があるので、そちらでも使えればうれしいです。 　よろしくお願いいたします。
こんばんは。 postgresql8.3を使っています。 autovacuumを使って、無駄な領域を削除しようと考えています。 毎日深夜の２時に定時的にautovacuum,が実行されるようにしたいと考えています。 postgresql.confの設定をあれこれ変えているのですが、うまくいかず、設定方法がいまいち分かりません・・・。 autovacuumを定時起動する方法がないのなら、 ・autovacuumではなく、vacuumdbを深夜２時に実行するようにcronで設定する。 ・autovacuumの起動間隔を24時間(1440min)にして、深夜２時にpostgresqlを起動しなおす。 くらいしかないのかなぁ、と思ってます。 vacuumdbは使いたくないし、深夜２時にpostgresqlを起動しなおすのも面倒です・・・。 autovacuumを定時起動する方法を、ご存知の方がいらっしゃたら、教えていただきたいです。 よろしくおねがいします。
勉強しようと思いLINUX(RHEL4.0）にapache2.2.9、postgresql8.3.5、PHP5.2.6を入れました。 データベースを作成しwebブラウザで見ようと思ったら ○ローカルでは見えた ○他のLINUXマシンからは文字化けしたが見えた ○windowsマシンからは空白のみでデータベースの表示が無い windowsマシンからは何か特別な作業が必要なのでしょうか？ 情報が足りないかとは思うのですがお気づきの点がありましたら教えて頂きたく御願い致します。
ご存知の方教えてください。 現在当方、fedora8にてPostgersql8.2.5を運用しております。 ちょっとマシンを変えたいと思いまして、現在のDB情報を すべて載せ替えたいと思っております。 A → B (Aが旧マシン Bが新マシン) 旧マシンでpg_dumpallしたものをBマシンでリストアする事は可能なのでしょうか？ また、pg_dumpallしたデータはどこへ保存されるのでしょうか？？ ご存知の方教えてください。 ではよろしくお願いいたします。
いつもお世話になっております。 先に質問の内容を言うと、トリガーを使って、別のDBの同一テーブルの登録・更新をすることが可能かどうか？ということです。 現在は、とあるテーブル（以下Ａテーブル）を登録・更新した場合、登録データを履歴ログテーブルに入れ、１日に一回決められた時間に履歴ログテーブルをファイルに出力し、別のDBに送った後にログを元に登録するという流れになっている処理があります。 それを、できる限りリアルタイムで更新できないかという話がでてきまして、その手段として質問の内容が可能かどうかということです。 以下の方法を試みましたが、どちらも問題があり、解決できそうにありませんでした。 ・dblinkを使用 　⇒新たにインストールが必要であり、現状の環境でということなので却下。 ・トリガーから呼ばれる関数に、Cのソースからコンパイルされた動的にロードされるオブジェクトを読み込んで、オブジェクト内からリモートDBに接続に行く 　⇒postgreSQLのCのオブジェクトを読み込む関数を作る際に、DB接続関数「PQconnectdb」が未定義とかで認識してくれない。 上記２つ以外にリモートDBに繋ぎにいく手段をご存知の方がいましたら、ぜひともご教授いただきたいと思いますｍ(_ _)ｍ
PsqlやMysqlのXMLエクスポート機能について調べているのですが 中々そういった資料はありませんでした。そこで PostgreSQLもしくはMysqlのデータを XML形式でエクスポートする機能はあるんでしょうか？ やはりC言語やツールなどを通して 変換するしかないのでしょうか？ こんな質問で申し訳ありませんが 宜しければ教えて下さい<(_ _)>
テーブルの任意フィールド（属性テキスト）にセットされている値の編集をPL/pgSQLを使用して 行いたいのです。PL/pgSQLは、組んだ事がないので解りません。 【例】 文章１\r\n文章２\r\n文章３\r\n\r\n\r\n・・・・・\r\n 文章３以降の改行コードを全てパージしたいのです。 【環境】 OS: CentOS5 DB: Version 8.3.3 現在ネットで検索しているのですが、対処方法を探せ出せていません。 ご教授願えれば幸いです。 宜しくお願い致します。
課題でDBへアクセスできるjavaプログラムを作成したのですが、提出の際、テストデータをもってくるように言われたのですが・・・テストデータの作り方がわかりません。 どなたか教えていただけないでしょうか？よろしくお願いします。
PostgreSQLのあるテーブルで「開始時刻」と「終了時刻」というフィールドがあり、timestamp with timezone（例：2008-07-31 07:00:00+09）でデータを持っています。 例えば、日付に関係なく13:00から15:00までのデータを抽出したい場合、SQLのWHERE句にはどのように記述すればよろしいのでしょうか？
下記のテーブルがあったとして、 field2にグループAに該当する値と、グループBに該当する値が共に1つずつ入っている field1の値を抽出したいと思いました。 下記の場合ですと、その条件を満たす1, 3, 4, 6を抽出したいと思います。 グループA：1, 2, 3 グループB：101, 102, 103 ――――――――― ｜field1｜field2 ――――――――― ｜1　　　｜1　　 ｜1　　　｜10 ｜1　　　｜101 ｜2　　　｜1　　 ｜2　　　｜15 ｜2　　　｜104 ｜3　　　｜2　　 ｜3　　　｜18 ｜3　　　｜101 ｜4　　　｜2　　 ｜4　　　｜17 ｜4　　　｜103 ｜5　　　｜3　　 ｜5　　　｜15 ｜5　　　｜100 ｜6　　　｜3　　 ｜6　　　｜18 ｜6　　　｜103 ――――――――― 使用バージョンは7.4.19です。 よろしくお願いします。
PostgreSQLの最初に設定したパスワードを忘れてしまったのですが設定したパスワードを調べる方法はないでしょうか？ pgAdminIIIではパスワードを入れるとアクセスできるのですが、コマンドプロントからするとなぜかアクセスできません。。。。 同じようにパスワードがわからなくなった方の質問・回答から以下の処理をしてみたのですが・・・ ＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊ pg_hba.confのエントリを編集し直します。 # TYPE DATABASE USER IP-ADDRESS/CIDR-mask METHOD host all all 127.0.0.1/32 password この、passwordと書いているエントリの部分をtrustへ変更します そしてpostgreSQLを再起動し、postgresユーザーで全部いじれるようになります。 使えるようになったらtrustとした部分をpasswordにもどし、ネットワークへつないでください。 ＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊ 上記の方法でやってみたのですがパスワードをtrustの状態にし、「psql postgres」 とうち、データベースへ接続しようとしたら psql: role "Owner" does not exist とエラーが出てしまうのです。何がいけないのでしょうか・・・ ＤＢへの参考書やネットで調べたりしているのですが、ツールを使わずにＤＢ操作を行おうとしたらコマンドプロンプトからＤＢへ接続し、sql文で操作するものだと思うのですが・・・・間違った解釈なのでしょうか・・・・
コマンドプロントにてＤＢへ接続するために「psql postgre」と入れたのですが Password : となるのですが、どのキーをたたいても入力することができません。エンターキーを押すと psql: FATAL: password authentication failed for user "postgre" と出るか paql: fe_sendauth: no password supplied と出てしまい何もできません。パスワードはコマンドプロントで入力できないのでしょうか？
はじめまして。mady1234と申します。 Postgresを利用した社内ツールを作成しています。 Postgresのテーブルからレコード取得は出来ますが、Viewからの取得が出来ません。エラーが発生します。 実行時エラー'-2147467259(8004005)': 環境はサーバーはVine4.2　Postgres8.3　クライアントのOSはXP　Excelは2003です。 色々と検索しましたが、テーブルのレコード取得の方法はあってもビューは見つけれませんでした。 ご教授の程、宜しくお願いいたします。 --------------------------以下、VBAの記述です-------------------　 Dim row1,col1, as integer row1=1 col1=1 Dim adoCON As New ADODB.Connection Dim adoRS As ADODB.Recordset Set adoCON = New ADODB.Connection adoCON.CommandTimeout = 0 adoCON.ConnectionString = "DSN=PostgreSQL30;" & _ "uid=postgres;" & _ "pwd=;" adoCON.Open Set adoRS = New ADODB.Recordset adoRS.Source = " SELECT * from View1;" adoRS.ActiveConnection = adoCON adoRS.CursorType = adOpenKeyset adoRS.LockType = adLockOptimistic adoRS.Open Do Until adoRS.EOF Worksheets("sheet1").Cells(row1, col1).Value = adoRS!usuryou adoRS.MoveNext row1 = row1 + 1 Loop adoRS.Close adoCON.Close Set adoRS = Nothing Set adoCON = Nothing
お世話になります。 PostgreSqlのインストールについて、嵌っています。 以前、PostgreSqlの8.3をインストールしていて、今回、新たに PostgreSqlの8.3をアンインストールして、同一バージョン(8.3)の インストールをしました。 インストールはうまくいくのですが、インストール時に設定した ユーザー名、とパスワードでPgAdminからデータベースにアクセス するとユーザーIDとパスワードが異なっているといった旨のエラー が出力されてしまいます。 アンインストール時の手順は以下の通りです。 (1)コンパネからプログラムの削除→postgresSql8.3を削除 (2)C:\Program Files\PostgreSQLを削除 (3)DOSからコマンドで、net user postgres /deleteを実行 上記の手順で、アンインストールを行い、postgresqlを再度インストール しているのですが、何度やってもうまくいきません。 以前、インストールした際は、問題なく出来たのですが、何が問題なのでしょうか？ どなたか、お助け願えませんでしょうか？
はじめまして、yossy136kgと申します。 下記の件、ご教授をお願いします。 ・TEST1というDBがあったとして、psqlより\dでテーブル一覧を参照すると、「No relations found.」と表示されます。 ・MS AccessからODBC経由でTEST1のDBのリンクテーブルを作成する際、別のDB(TEST2)のテーブルが参照できます。 例）TEST2.HOGE1、TEST2.HOGE2・・・ 【質問】 TEST1のDBからTEST2のDBのテーブルをリンクさせるようなことは可能なのでしょうか？ ちなみにPostgreSQL8.2.3、CentOSです。
あるテーブル（table）の行をランダムに半減させたいと思っています。 このテーブルのキーは、instance_idとuser_idです。 つまり、同一userが複数のinstanceを持ち、同一のinstanceが複数のuserに所持されうるというテーブル構成になっています、 今、行数は２００あるとしますと、 delete from table where insance_id IN (select insance_id from table order by random() limit 100) としますと、tableの行が半減するわけではなく、同一instanceが複数userに所持されますので、もっと行数が減ってしまいます。 そこで、 # delete from table where instance_id AND user_id IN (select instance_id , user_id from table order by random() limit 100); というようなことをしたのですが、 ERROR: subquery has too many columns と出てしまいます。 ２時間ほど、Webで調べて頑張ったのですが、よくわからないので、 これを実現するSQL文をお教えいただけませんか。 どうか、よろしくお願いいたします。
以下のような【TABLE1】と【TABLE2】をID_SUBの列で結合した結果を 【Ａ．結果】のように取得したいのですがうまくいきません。 【TABLE1】 ID ID_SUB 1 A1 2 B1 【TABLE2】 ID ID_SUB ID_SUB_CODE 1 A1 AAA1 2 A1 AAA2 3 B1 BBB1 4 B1 BBB2 【Ａ．結果】 ID_SUB ID_SUB_CODE A1 "AAA1,AAA2" B1 "BBB1,BBB2" いろいろ調べたのですが、MySQLにはGROUP_CONCATの 関数を使うと簡単に出来るみたいですが、PostgreSQLには 似たような関数がなく、ARRAYが使えるかな？と思ってためしてみましたが array_to_string(ARRAY(ID_SUB_CODE, ',')) 等のような感じで試した結果、ID_SUB_CODEが 全て連結されるような使い方しか出来ませんでした。 A1 "AAA1,AAA2,BBB1,BBB2" B1 "AAA1,AAA2,BBB1,BBB2" 何か良い方法はありますでしょうか？
PL/pgSQLについて質問させてください。 以下のような2つのテーブルＡとＢがあります。 テーブルＡ： aid | fall0 | fall1 -----+-------+------- 001 | 0 | 0 002 | 0 | 0 テーブルＢ： bid | aid | fall --------+-----+------ 000001 | 001 | 0 000002 | 001 | 0 000003 | 002 | 0 000004 | 002 | 0 テーブルＡとテーブルＢの関係は1:nの関係です。 以下のような2つのことがやりたいです。 テーブルＡのfall0,fall1,テーブルＢのfallはフラグです。 今、テーブルＢのaid=001であるすべての行のfallを0から1に変えたとき、 それに対応するテーブルＡの行のfall1が0から1にかわる。またテーブルＢのaid=001である少なくとも一つの行のfallを0から1に変えたとき、 それに対応するテーブルＡの行のfall0が0から1にかわるようなプログラムを作りたいのですが、なかなかうまくいきません。今aid=001のときをやりましたが、aidは任意のときを想定しています。もし、ご存知の方がいらっしゃいましたら教えていただけないでしょうか？ よろしくお願いいたします。以下は自分が書いたプログラムです。 drop table b; drop table a; create table A ( aid text primary key, fall0 integer, fall1 integer ); create table B ( bid text primary key, aid text not null references A(aid), fall integer ); insert into A values ('001',0,0); insert into A values ('002',0,0); insert into A values ('003',0,0); insert into B values ('000001','001',0); insert into B values ('000002','001',0); insert into B values ('000003','002',0); insert into B values ('000004','002',0); /* 関数の定義 */ create function tri_test() returns trigger as ' begin declare aid_rec if old.fall=0 and new.fall=1 then update a set fall1=1 where a.aid = select b.aid from b where b.fall = 1); end if; return new; end; ' language 'plpgsql'; /* トリガーの定義 */ create trigger tri_b after update or insert on b for each row execute procedure tri_test(); /* B テーブルへのデータ操作 */ update b set fall=1 where aid='001';
Postgresでテーブルが2つある場合、 その2つに登録されているデータを全て取得したいのです。 例えば Ａテーブル　　　　　　　Ｂテーブル Key1　key2　A 　　　　Key1　key2　B －－－－－－－－－－　－－－－－－－－－ ０１　０１　Ａ１　　　　 ０１　０２　Ａ２　　　０１　０２　Ｂ２ ０１　０３　Ａ３　　　０１　０３　Ｂ３ 　　　　　　　　　　　　０１　０４　Ｂ４ とある場合、 1度のSQLで下のような結果を取得できますか？ Key1　key2　A　　　B －－－－－－－－－－－－ ０１　０１　Ａ１　　　NULL ０１　０２　Ａ２　　　Ｂ２ ０１　０３　Ａ３　　　Ｂ３ ０１　０４　NULL　　Ｂ４ お願いいたします。
PostgreSQL8.3にて、 ｜ID｜担当者｜ 年月 ｜金額｜ ｜ 1｜太　郎｜200807｜ 500｜ ｜ 2｜次　郎｜200807｜1000｜ ｜ 3｜次　郎｜200807｜ 500｜ ｜ 3｜太　郎｜200808｜1000｜ ｜ 4｜次　郎｜200808｜1100｜ ｜ 5｜三　郎｜200808｜ 900｜ ｜ 6｜太　郎｜200809｜1100｜ ｜ 7｜三　郎｜200809｜1200｜ というテーブルから、 ｜ 年月 ｜太郎｜次郎｜三郎｜ ｜200807｜ 500｜1500｜ 0｜ ｜200808｜1000｜1100｜ 900｜ ｜200809｜1100｜ 0｜1200｜ このようにすることは可能なのでしょうか。 どうかよろしくお願いします。
現在、1台のLinuxサーバでPostgreSQL7.xが起動しています。 そこへ、もう一つバージョンの違うPostgreSQL8.3を追加し、同時に2つを起動して使い分けたいと考えていますが、可能でしょうか。 使い分けというのは、同サーバ内に設置しているPerlやPHPのシステムがいくつかあり、例えばAというシステムはpostgreSQL7.xのDBデータ、BというシステムはpostgreSQL8.XのDBデータを利用するようにするということです。 よろしくお願いします。
お世話になります。 無料サーバを借りたのですが postgreSQLのエンコードがSQL_ASCIIです。 日本語は通らないという理解でよいのでしょうか？ なんとかする方法があったらご教授いただければ ありがたいです。 よろしくお願いいたします。
お世話になります。 現在、JAVAを利用した開発をPostgres8.3で行おうと考えております。 そこで以下の状態で、Postgresを運用可能かどうかで悩んでいます。 保持するデータは以下の規模を想定しています。 ・TBLは5～10(各)。カラム数は1TBLあたり、5～10程度 ・データは月次60000件、年間72万件のデータを数年間保持する必要あり。 仕様としては、毎月、20社、各3000件のデータをPostgresに取り込み。 JAVAの画面から帳票(グラフ等)を各社ごとに出力するといった仕様です。 何ヶ月、何年と運用を重ねていくながで数十万、数百万のデータによって、アプリケーションの処理が極端に重くなったりデータ容量の上限に 達するといったことはあるのでしょうか？ また、もしそうならば、どれくらいのデータ容量ならば、ユーザーに とって利用に絶えられるシステム運用が可能なのでしょうか？ 私自身が、DBに詳しくないため判断しかねています。一応インターネット で調べてPostgresの容量が2GBだということはわかったのですが、基準 がわからず困っています。 どなたかご存知の方がいらっしゃったらお答え願えますか？ よろしくお願いいたします。
先に質問をさせていただき、１度は解決したものの再び行き詰ってしまいました。 UPDATEの際うまくいかず困っています。 お知恵を拝借いただけると助かります。 使用バージョンはPostgresV7.3.4です。 tableA a1|a2|b|c -+--+-+- 1 | 1 | 1| 1 (★) 1 | 1 | 0| 1 1 | 2 | 0| 1 2 | 2 | 1| 0 2 | 1 | 0| 1 3 | 2 | 1| 1 (★) 3 | 2 | 0| 1 3 | 1 | 0| 1 b=1 and c=1 で一致する行を★行とする。 ★行のa1列の値とa2列の値(上記の例だと(a1=1,a2=1)と(a1=3,a2=1)）をもつ行に対して 下記の条件◆でUPDATEを行う。 [条件◆] b=0 and c=1 [UPDATEの内容] 条件◆に一致したc列を3に更新する [理想の結果] tableA a1|a2|b|c -+--+-+- 1 | 1 | 1| 1 1 | 1 | 0| 3 ←更新 1 | 2 | 0| 1 2 | 2 | 1| 0 2 | 1 | 0| 1 ←★にあてはまらないので更新されない 3 | 2 | 1| 1 3 | 2 | 0| 3 ←更新 3 | 1 | 0| 1 ←最下行 ========================================== UPDATE tableA set c = 3 WHERE 条件◆ and a1 in (select a1 from tableA where b=1 and c=1) and a2 in (select a1 from tableA where b=1 and c=1) このようなイメージなのですが、この場合、 最下行のc列も更新してしまいました。 (説明しずらいのですが、) a1とa2の条件は独立させるのでは無く、セットとして考えたいのですが、 方法が分りません。 ご協力お願いします。 ==========================================
少し複雑なUPDATEをしているのですが、うまくいかず困っています。 お知恵を拝借いただけると助かります。 使用バージョンはPostgresV7.3.4です。 tableA a |b |c -+-+- 1 | 1 | 1 (★) 1 | 0 | 1 1 | 0 | 2 2 | 1 | 0 2 | 0 | 1 3 | 1 | 1 (★) 3 | 0 | 1 3 | 0 | 2 b=1 and c=1 で一致する行を★行とする。 ★行のa列の値(上記の例だとa=1,a=3)をもつ行に対して 下記の条件◆でUPDATEを行う。 [条件◆] b=0 and c=1 [UPDATEの内容] 条件◆に一致したc列を3に更新する [理想の結果] tableA a |b |c -+-+- 1 | 1 | 1 1 | 0 | 3 ●更新 1 | 0 | 2 2 | 1 | 0 ←★にあてはまらないので更新されない 2 | 0 | 1 3 | 1 | 1 3 | 0 | 3 ●更新 3 | 0 | 2 ========================================== ★の条件を考えない場合は、下記予想します。 UPDATE tableA set c = 3 WHERE 条件◆ ★の条件を考えた時、どのような条件にすればよいかさっぱり分かりません。 ご協力下さい。 ==========================================
PostgreSQLを使用しております。 それぞれ、TABLE1とTABLE1があり、 TABLE1 a-1　　　a-2　　　b-1　　 ￣￣￣￣￣￣￣￣￣￣￣￣￣￣ 　　　１　　　bbb　　　aaa　　　ddd　 　 　　２　　　ggg　　　bbb　　　ccc　　　 　　 　３　　　bbb　　　mmm　　ddd　　 　　　 ４　　　ggg　　　mmm　　ccc　　　 : TABLE2　　 a-1　　　a-2　　　　　　　　c-1　 ￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣ 　　 　１　　　bbb　　　aaa　　　　　　　　eee　　　　 　　　 ２　　　ggg　　　mmm　　　　　　　qqq　　　 : 質問１． TABLE1.a-1=TABLE2.a-1 and TABLE1.a-2=TABLE2.a-2 を条件にして結合 したい場合、どのように結合すればよいのか。 期待結果　a-1　　　a-2　　　b-1　 c-1　 ￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣ 　　　１　　　bbb　　　aaa　　　ddd　 eee 　　　２　　　ggg　　　bbb　　　ccc　　　※ 　　　３　　　bbb　　　mmm　　ddd　　　※ 　　　４　　　ggg　　　aaa　　　ccc　　　qqq ※は空白でもNULLでもよい 質問２． 上記が可能な場合にさらに質問です。 TABLE1およびTABLE2が、SELECT,WHEREによって抽出されたものとした場合、 １つのSQL文で質問１と同様の出力にするにはどのように結合すればよいのか。（はたまた無謀なのか） 知識不足のため悩んでいる状況なので、 どなた様か知識がある方にご教授願いたく思います。
postgreSQL8.2.3(linux)とVB2005 expressを接続しようとしているのですがエラーが表示されうまくデータを取得できず困っております。どのようにVBをプログラムすればよいのか教えていただけるとうれしいです。。。。 現在のVBにいれているプログラムですが Dim strConnect As String Dim adoConnection As Object Dim ans As Object strConnect = "DSN=*****; UID=*****; PWD=*****" adoConnection = CreateObject("ADODB.Connection") adoConnection.Open(strConnect) ans=adoConnection.execute("select name from table;") Do While Not ans.EOF Debug.Print(ans.fields("name")) ans.MoveNext() 実行するとdebug.print実行時にエラー表示され 型 'Field' から型 'String' への変換は無効です。 となります。postgresはpgadminにて接続動作確認できています。 ご回答のほどよろしくお願いします。
皆様、はじめまして。blackcat37と申します。 これから、PostgreSQLにチャレンジしようと思いインストールを行っています。 インストール・アンインストールを何度かやっているうちに インストールができなくなりました。 インストールファイルのコピーまでは進むのですが、ユーザーアカウントの 設定になると、 ＞内部のアカウント検索に失敗しました。 ＞アカウント名とセキュリティIDの間のマッピングは実行されませんでした。 とエラーメッセージが出て、インストールが失敗してしまいます。 再インストールする際には、 net user postgres /delete でアカウント削除を行い、Documento And Settingにある postgresユーザフォルダも削除しています。 PostgreSQLのインストール先フォルダが無い事も確認しています。 あと何か確認しなければならない事があるのでしょうか？ 環境はWinXP+SP2です。 説明不足の点がありましたら、ご指摘ください。 よろしくお願いいたします。
DBを開発環境から、本番環境へ移行する際、pg_dumpではかれたデータを元に、pg_restoreで復元しようとした所、エラーが出て、うまくいかず。pg_dumpをtxt形式で出力させ、それを実行させました。 結論から言うとテーブルは全て作成されましたが、データの移行が出来ていませんでした。エラーは出ていませんが、COPYコマンドがうまくいっていないようでした。 開発環境がPostgres8.xで本番環境がPostgres7.4.3なのが影響している可能性が高いと判断してますが、どなたかわかる人はおりませんでしょうか。
Ｃプログラムでのデータベース接続が出来ない事で質問です。 現在Ｃ言語で書いたプログラムがありまして、今まではwindows上でCSVファイルから読み込んで、 新しいファイルに書き込むというような内容のプログラム作っていました。 それを今は ＯＳをLINUXのRedhat(teratermからアクセス) 読み込むデータファイルをデータベース(Postgresql) にしてやっています。 何とかＤＢをインストールして、ＤＢにCSVファイルをコピーした物を作る所までは出来ました。 その後ＣプログラムでＤＢを利用する時、色んな設定をしてやらなくてはいけないと思うのですが まずlibpq-fe.hというものをincludeして使うとは分かったのですが、これがまず見つかりません。 質問(1) ＯＳの中のファイルを探す時にコマンドで# find ~ -name libpq-fe.hとやったのですが間違っていますか？ ちなみにあるとしたらどこにそのヘッダーファイルはありますか？ 質問(2) インストールした手順としては日本PostgreSQLユーザ会のサイトからソースをダウンロードしてコンパイル、インストールを行いましたが、調べるとrpmと言うものを使ってインストールした人が同じような内容で質問していて、develを入れないとヘッダーファイルが 入らないという記述がありました。 その事は何か関係がありますか？ 質問(3) libpq-fe.hが必要と書きましたが、他にもlibpq.soやlibpq.hと書いてあったりしてそこの所もよく分かりません。 記述が足りなかったらすいません。 ヒントでも良いので宜しくお願いします。
postgres 7.2.4で質問させてください。 以下のような構成のテーブルの抽出をしようとしています。 テーブル名　：t_name カラム名　　：k1、k2、k3 インデックス：t_name_idx　 テーブルt_nameの全体件数は約70万件で、上記のSQLから期待 される抽出結果件数は約1万5千件です。t_nameにはk3のみを対象としたインデックス、t_name_idxが作成してあります。次のようなSQLを実行した際に、シーケンス検索になり応答までに６秒ほどかかってしまいます。 　select k1,k2 from t_name where k3 in ("100","200"); explain analyzeで実行計画を見ると (cost=26.29..15304.62 rows=523 width=104) Total runtime: 6427.32 msec です。シーケンスをSET enable_seqscan TO off;　で使用しないようにして、強制的にt_name_idxを使うと次のような結果になります。 (cost=0.00..42009.05 rows=523 width=104) Total runtime: 423.81 msec 実際にはindexを使用したほうが10倍以上も速いのに、プランナはシーケンス検索のほうがコストが小さいと判断しています。何故このようになってしまうのでしょうか？VACUUM ANALYZEを行っても結果は変わりませんでした。 私のイメージでは、index検索のほうがコストが小さく計算されて、それを使うべき。というイメージなのですが、考え方自体が間違っているのでしょうか？ 原因を調べ始めて１週間経ち、行き詰っています。 どなたかヒントだけでもいいので教えてください。
こんにちは。 PostgreSQL8.1.10を使っています。 複数のテーブルに日付情報が入っています。 この日付のなかで最新のものを検索したいのですが、どうすればよいのでしょうか？ テーブルが１つの場合なら、 select max(date) from table1; でできるのですが。 テーブルは３つ以上（１０くらい）になる予定です。なにはよい方法はないでしょうか。よろしくお願いします。
いつもお世話になっております。 あいまい検索で、英文字の全角・半角も区別しないように結果を出したいんですが、どういった方法でできますでしょうか。 大文字小文字の区別なしの曖昧検索だと、 ILIKEという専用演算子を使えばいいとわかったのですが、 全角と半角の区別がついてしまいます。 英文字の全角でも半角でも検索結果をだしたいです。 どなたかご教授お願いいたします。
普段Oracleを利用しています。 Oracleだとvarchar2のカラムを作成する際に、 バイトか文字(キャラクタ)の指定ができるのですが、 Postgresでは指定できないのでしょうか。 どちらか固定ですか？ 指定できるのでしたら既にあるテーブルのカラムが どちらになっているかわかる方法はないでしょうか。
PostgreSQLについて質問です。 タイトルにもありますが、「データベースクラスタ」について、詳しくご説明頂けたらと思います。 ご回答をお願い致します。
年間データテーブルと年間テーブルから当日だけのViewが ある場合、当日のあるデータの集計等をしたい場合、どちらから検索しても速度は同じなのでしょうか？ Viewから検索した方が早くはならないのでしょうか。 初歩的な質問で申し訳ありませんが回答よろしくお願いします。
全くの初心者で、初めて質問させていただきます。 windowsXPにPostgreSQL(8.3.3)をインストールしようとしています。 「インストールオプション」ダイアログで《国際化言語のサポート》というものが出てきました。 以下の三つから選択するようになっています。 《ローカルなハードディスクドライブにインストールされます》 《全体の機能はローカルなハードディスクドライブにインストールされます》 《全体の機能は選択されません》 これらの意味がよくわかりません。 他のサイトを色々検索してみましたが、設定手順については説明されているのですが、なぜそのオプションを選択するのかまで説明されているものが見つからなかったので、詳しい方、教えてください。
レコード型の使用方法がわからないので、悪戦苦闘しております。。。 【やりたいこと】 ・あるテーブルのある項目でGROUP BYし、別の項目事に集計した結果を 　カラムとして出力 クロス集計と呼ぶのでしょうか？ 上記の結果表を取得出来るFUNCTIONを作成したいのです。 【サンプルデータ】 CREATE TABLE t1 ( col1 integer ,col2 integer ,val integer ); INSERT INTO t1 VALUES( 1, 1, 1, ); INSERT INTO t1 VALUES( 1, 1, 1, ); INSERT INTO t1 VALUES( 2, 1, 1, ); INSERT INTO t1 VALUES( 2, 1, 1, ); INSERT INTO t1 VALUES( 3, 2, 1, ); INSERT INTO t1 VALUES( 3, 2, 1, ); INSERT INTO t1 VALUES( 4, 2, 1, ); INSERT INTO t1 VALUES( 4, 2, 1, ); ※ここでcol1、col2ともどんなデータが入っているか、わからないとします。 なので、まずcol2をDISTINCTしたものを求めました。 SELECT DISTINCT col2 FROM t1; この結果をカーソルを使ってループし、動的にカラムを作成するＳＱＬを 作りました。 DECLARE cu refcursor; rec record; str text := 'SELECT col1 '; str2 text := ' FROM t1 GROUP BY col1 ORDER BY col1'; BEGIN OPEN cu FOR EXECUTE SELECT DISTINCT col2 FROM t1; LOOP FETCH cu INTO rec; IF NOT FOUND THEN EXIT; END IF; str := str || ', SUM( CASE WHEN col2 = rec.col2 THEN val END ) AS col_name' || rec.col2; END LOOP; CLOSE cu; RAISE INFO 'key = %', str || str2; 　動的に生成されたSQLを実行したい ------------------------------------------------------- ※ちなみに動的に生成されたＳＱＬはこんな感じになります。 SELECT col1 ,SUM( CASE WHEN col2 = 1 THEN val END ) AS col_name1 ,SUM( CASE WHEN col2 = 2 THEN val END ) AS col_name2 FROM t1 GROUP BY col1 ORDER BY col1; ------------------------------------------------------- あとがわかりません。。動的なカラムなので、どうやって取得すれば 良いのでしょうか？ レコード型を使うと上手くいくのでしょうか？ 試しにFUNCTION( func1 )の戻り値をRETURNS SETOF record として 内部で rec1 record; : : 　FOR rec1 IN EXECUTE str || str2 LOOP RETURN NEXT rec1; END LOOP; RETURN; SELECT * FROM func1(); とやってみたら、 ERROR: a column definition list is required for functions returning "record" となります。。。 カラムの定義が必要だと言われているんだと思いますが、カラムは 動的になっているので、どうすれば良いのでしょうか？？
会社のテスト用WebサーバのDocumentRoot/ppaディレクトリ下にphpPgAdmin4.2を入れました。 ID・パスワードを入力してログイン後、既存のDB一覧が表示されるのですが、「データベース名」や「アカウント」をクリックしても必ずログイン画面へ戻ってしまいます。 正しいユーザID・パスワードを入力した場合のみログインできる点、データベース一覧が見えてる点などから、config.inc.phpのDB接続設定はうまくできていると考えているのですが… なにか心当たりがあれば教えて頂きたいと思います。 【各バージョン】 OS：CentOS release 4.4 (Final)　※VMware6上で稼働 カーネル：Linux version 2.6.9-42.EL PHP：4.3.9 PostgreSQL：7.4.19 Apache：2.0.52 【pg_hba.confの設定】 local all all md5 host all all 127.0.0.1 255.255.255.255 md5 host all all 0.0.0.0 0.0.0.0 md5 DBとWebサーバは上記同一サーバ上で稼働しております。 以上、よろしくお願い致します。
はじめまして。 ２つ質問があります。 (1) SELECT col1, col2 FROM tblA （データは複数行） の結果表をFUCNTIONとして作成したいのです。 (2) また、そのFUNCTION( func1とします )から得られる結果を利用して 以下のような使い方がしたいのですが、可能でしょうか？ SELECT * FROM tblB b LEFT JOIN ( SELECT * FROM func1() ) a USING( col1 ) (1)で行き詰まっているので(2)を試すことも出来ません。。。 せめて(1)だけでも出来たら助かります。 よろしくお願いします
unique | day_start | day_end --------+----------------------------+---------------------------- 1 | 2006-06-02 12:49:07.094831 | 2007-01-17 02:00:58.643778 2 | 2006-06-08 12:49:07.122762 | 2007-01-17 02:00:58.647793 3 | 2006-06-08 12:49:07.137901 | 2007-01-17 02:00:58.65177 4 | 2006-06-04 12:49:07.15393 | 2007-01-17 02:00:58.655763 5 | 2006-06-08 12:49:07.181952 | 2007-01-17 02:00:58.65976 6 | 2006-06-08 12:49:07.181952 | 7 | 2006-06-08 12:49:07.181952 | 2007-01-17 02:00:58.65976 上記のようなデータがあるとします。 day_startとday_endの間の日数の平均が知りたいです。 ただし、uniqueが7のレコードのように、 day_endがNULLのレコードもあり、その場合は、そのレコードの日数はday_startから現在日までとしたいです。 select avg(to_date(day_start,'yyyy/mm/dd') - to_date(day_end,'yyyy/mm/dd')) from a ※day_endがNULLのレコードもあり、その場合は、そのレコードの日数はday_startから現在日までとしたいです。 ↑この部分の条件式の書き方が分りません。 ご教示いただけないでしょうか。
テキストファイルから読み込んだデータをテーブルに書き込むCプログラムを作りたいのですが PostgreSQL 8.3.1を学び始まったばかりです。 テキストファイル（ユーザ、姓、名）と言う項目を作り、 データを<user>テーブルに書き込むプログラムを作りたいのですが、 「PostgreSQL 8.3.1文書 第 30章libpq - C ライブラリ」を読んでも、 どこからやればいいか、まったくわかりません。 お分かりの方、是非教えてください
現在、ＤＢをバージョンアップすべく検証等をしている最中なのですが。。。 現7.4.7 → 8.3.1へ移行に当たりpg_dumpのリストアにて作業をしているのですが、 pg_dumpパラメータに -c -D を附帯させてダンプした物をリストアするとサーバ用途モデルのマシンは信じられないくらい時間を要します。 附帯無し、所要時間約１分 → 附帯有り 所要時間約１３０分 附帯有りの所要時間は、１０年前のＰＣでさえも６０分で完了するのに その倍以上時間を要しています。 それで、そもそも同じPostgreSQLであるならばバージョンは違えども別のRDBMSではないので パラメータに -d -D は附帯させる必要性は、全く無いのでしょうか？ ご教授願えれば幸いです。宜しくお願い致します。
PostgreSQL8.1.3にて、長いwhere句のあるSELECT文を実行したところ、 「server closed the connection unexpectedly」 のエラーとなってしまいました。 エラーとなったSQL文は317726文字で、 where句のin条件のリスト個数が非常に多くなっています。 試しに、in条件のリスト部分を減らし、 156000文字までSQL文を短く短くしたら、エラーは回避できました。 in条件ではなくor条件に変更すると、エラーとの境目のSQL文長は上記とは異なることから、 SQL文長だけが影響しているとは思えません。 SQL文を改修して、エラーを回避するにしても、ここらへんの限界値がわからないと改修できませんので、 改修の目安（信頼できるSQL文長がどのくらいなのかなど）をご教授お願いします。
素人です。申し訳ありませんが、ご教授お願いします。 pg_dumpコマンドでバックアップを採取する際はpostgresを止める必要があるのでしょうか？
データの文字化けについて質問したいと思います。 ＣＧＩプログラムからデーターベース（PostgreSQL）にアクセスした後に、 保存したデータをTeraTermで確認しようとすると、 保存されたデータは文字化けになっております。 そこで、毎回TeraTermを開く時に、 set client_encoding To \"UTF-8\"; をsetすると、文字は正常に表示されます。 一回だけsetして、ずっと使えるっていう設定はありませんでしょうか。 すごく、困ってます。 ご指導お願いいたします。
AccessからPostgresのデータをいじる時の利点、欠点はなんでしょうか？ ご教授お願い致します。
PostgresへA5SQLとか言うツールを使ってテーブルを２つCreateTableしました。 テストデータも入力しました。 あらためてAccessでPostgresのテーブルをリンクテーブルとして参照しデータを見ることが出来ましたが、Access上でリレーションが未定義でサブフォームを作成することが出来ません。 リレーションを１：多で作成しようと思うのですが、設定フィールドが真っ白でいじれません。 何故でしょうか？ 基本的にCreateTableするときに、なにやらリレーション設定する構文が必要だったのでしょうか？ 今は、CreateTableしか構文は記述されていません。 どなたかご教授ください。 よろしくお願いします。
こんにちは。postgreSQL初心者です。 古いサーバからpostgreSQLのデータを pg_dumpもしくは、pg_dumpallで取り出し、新しいサーバに入れようとしてるのですが、以下のようなエラーが出てデータが入ってくれません。 ERROR: invalid byte sequence for encoding "UTF8": 0x8a HINT: This error can also happen if the byte sequence does not match the encoding expected by the server, which is controlled by "client_encoding". 文字コードの問題だと思うのですが、バージョンの違いや基本的な設定も関係あるのでしょうか？ 環境 旧サーバ：Red hat Linux 9, postgreSQL 8.0 移転先サーバ：Fedora Core 6, postgreSQL 8.1 実行コマンド ダンプ pg_dump -d DB_NAME > FILE_NAME ※ファイルの中身はちゃんと出力されています。 リストア（？というのでしょうか？） 方法1: \i FILE_NAME > DB_NAME 方法2:cat FILE_NAME　 | psql DB_NAME 両方ともエラーがでて、テーブルはできていても一部の中身が入りません。 行き詰まってしまっています。どうか宜しくお願いします。 また、現在設定されている文字コードを調べる方法や、お勧めの参考ホームページがございましたら教えてください。
以下のようなデータがある場合の累計表示方法を教えてください。 ■入退会管理テーブル 　　　日付 |入会数|退会数 　　　2008/05/15| 10| 2 　　2008/05/16| 5| 1 　　2008/05/19| 2| 3 　　　: このデータを利用して日付ごとの会員累計を表示したいです。 ■表示したいSelect文　 日付 |入会数|退会数|会員累計 　　　2008/05/15| 10| 2| 8 　　2008/05/16| 5| 1| 12 　　2008/05/19| 2| 3| 11 : 会員累計の計算式は、 （当日の入会数-当日の退会数）＋（日付でソートした場合の1行前の会員累計数） です。 初歩的な質問ですみませんが、頭が困惑してしまってます。 よろしくお願いします。 　　
AccsessなどでDsum関数が用意されてますが、Postgreにはないようですね。 同じ関数を作りたいのですがわかりません。 どなたか教えていただけませんか。
すみません。 order byで並び変えし最大値の項目のみ一意で抽出したいのですが 、 SELECT * from ta order by no,date1,date2; no | date1 | date2 ----+-------+------- 11 | 2008 | 0501 11 | 2008 | 0502 11 | 2008 | 0502 11 | 2008 | 0503 12 | 2008 | 0501 12 | 2008 | 0502 12 | 2008 | 0503 13 | 2008 | 0501 13 | 2008 | 0502 13 | 2008 | 0503 14 | 2008 | 0501 とあった場合、 no,date1,date2のorder by順番で並び変えし 11 | 2008 | 0503 12 | 2008 | 0503 13 | 2008 | 0503 14 | 2008 | 0501 とno項目に対し一つずつだけ出力したい場合どのようにしたらよいのでしょうか？ LIMITとoffsetだと１項目分しか出力されず困っております。 SELECT * from ta where no in (select no from ta group by no limit 1 offset 0) order by no,date1 desc,date2 desc limit 1; 宜しくお願い致します。
PDFファイルのデータベースをPostgreSQLで構築しています。 データベースの項目には「タイトル」「著者名」「注釈」などとともにラージオブジェクトとしてPDFファイルそのものをデータベースに取り込んでいます。PDFファイルのファイルサイズは10KB～20MB程度です。 最近、書店でPostgreSQLの本を見てもラージオブジェクトに関する解説を書いたものがほとんどなく、ひょっとすると将来的にはラージオブジェクトは廃止になるのではと危惧しています。 よく考えてみれば、データベースを初めに構築するときに、PDFファイルをファイルシステムのディレクトリ内に保存して、そのファイル名をデータベースで管理すれば良かったと今頃後悔しているところです。 ラージオブジェクトを使って、バイナリファイル（ここではPDF）を保管するメリットがあるのか？　ラージオブジェクトはPostgreSQLで今後も対応されるのか？　など、ご意見、感想などありましたらご教示ください。 ラージオブジェクトにメリットが無いなら、近い将来、あまりデータベースが巨大にならないうちに、PDFファイルを取り出すスクリプトなど作らなければと考えております。 よろしくお願いいたします。
VACUUMにてmax_fsm_pagesが不足している旨のメッセージが出ましたので、 不要領域を無くそうと vacuumdb -f を実施しましたが、 その後も同様のメッセージが表示されます。 max_fsm_pagesが不足している旨のメッセージが出た場合は、 一旦max_fsm_pagesの値を変更してVACUUM FULLを実施しなければ意味がないのでしょうか？ ちなみに、2回目のVACUUM FULL時に表示されたメッセージが以下になります。 ----------------------------------------------------------------- hoge=# VACUUM FULL; NOTICE: number of page slots needed (31360) exceeds max_fsm_pages (20000) HINT: Consider increasing the configuration parameter "max_fsm_pages" to a value over 31360. VACUUM -----------------------------------------------------------------
ALTER TABLE distributors ADD CONSTRAINT dist_id_zipcode_key UNIQUE (dist_id, zipcode); CREATE UNIQUE INDEX dist_id_zipcode_key ON distributors (dist_id, zipcode); この二つには違いがあるのでしょうか。
お世話になります。 メインテーブルAと詳細テーブルBがあります。 　テーブルA（ID・名前） 　テーブルB（ID・テーブルAのID・区分・内容） テーブルA:テーブルBは、1:Nの関係です。 またテーブルBがないものもあります。 名前あるいは名前と内容で検索をしたいのですが、 どのようにかけばいいのでしょうか？ テーブルAの形で結果がほしいのですが。 よろしくお願いします。
教えてください。 テーブルにVARCHAR型のデータがあるのですが、 その内容は、数値や文字です。 　2.5 　20 　0未満 などなど。 仮に4以下のデータを抽出する場合、 どのようにかけば「2.5」のデータがHITするのでしょうか？ この場合、「0未満」など文字のあるデータは検索対象から外れてもかまいません。 よろしくお願いします。
こんにちは。 PostgreSQL+PerlでCGIを書いています。 テーブルのtimezonetz型の値の最大値を取り出して加工したいのですが、 うまくいかず悩んでおります。 単に最大値を取り出すだけなら、 SELECT max(lastdate) FROM table; でできました。しかし、この値を $sth->execute(); $last=$sth->fetchrow; として取り出しても、文字列となってしまいます。 perl側で加工するのは、フォーマットが環境によって違ったりする心配がありましたので、サーバー側でできないものかと思い、 SELECT EXTRACT(EPOS FROM TIMESTAMPTZ lastdate) FROM table; としてみましたが、 「"max"またはその近辺で構文エラー」とメッセージが出てしまいます。 こういった場合、いったいどのように書けばよいのでしょうか？ PostgreSQLのバージョンの確認方法がわからず、バージョンは不明なのですが、つい先日インストールしてもらったばかりなので、そう古いものではないと思います。 OSはunix(Solaris)です。よろしくお願いします。
こんにちは。 現在、バッチで伝票を登録するプログラムを組んでいます。 実施したい内容は、伝票番号を採番し、伝票テーブルと伝票明細テーブルにデータを書き込むと言う物です。 具体的には、以下のテーブルです。 1.TRN_DENPYO 　DENPYO_NO 　DENPYO_HIDUKE 2.TRN_DENPYO_MEISAI 　DENPYO_NO 　DENPYO_MAISAI_NO 　DENPYO_SYOHINCD ※TRN_DENPYOのDENPYO_NOはserialです。 そこで、TRN_DENPYO にレコードを追加した後、自動的にカウントアップされるTRN_DENPYOのDENPYO_NOを取得するために LASTVAL()を使用したいのですが、うまく行きません。 以下、実際に記述しているSQL文です。 $sql = 'INSERT INTO "TRN_DENPYO"("DENPYO_HIDUKE")VALUES(' . $denpyo_hiduke . ')'; $db->query($sql); $sql = 'SELECT LASTVAL()'; $result =& $db->query($sql); while($row = $result->fetchRow(DB_FETCHMODE_ASSOC)) { $denpyo_no = $row['LASTVAL()']; } echo $denpyo_no; この時点で、$denpyo_no の値が表示されると思っているのですが、表示されません。 どなたか教えて頂けませんでしょうか？ ちなみに環境は、PostgerSQL8.2 php5を使用しています。
こんにちは、SELECT文での絞り込みでうまく行かないので質問させてください。 現在、以下の2つのテーブルがあります。 これらのテーブルからメールアドレスを取得したいと考えています。 1.MST_USER <KEY--> USER_ID MAILADDRESS -------+----------------- 1|hoge1@example.com 2|hoge2@example.com 3|hoge3@example.com 2.MST_USER_SETTING <KEY------------> USER_ID SELECT_ID OPTION_ID -------+---------+--------- 1|BUNRUI |KYOUSHI // 教師 1|GAKUNEN |2 // 2年生 2|BUNRUI |HOGOSYA // 保護者 2|GAKUNEN |2 // 2年生 3|BUNRUI |GAKUSEI // 学生 3|GAKUNEN |2 // 2年生 やりたい事は、 MST_USER_SETTINNGから2年生の教師のUSER_IDを取得して MST_USERのMAILADDRESSを取得したいという事です。 一応、以下のようにやってみたのですが、 SELECT "MST_USER"."MAILADDRESS" FROM "MST_USER" LEFT JOIN "MST_USER_SETTING" ON "MST_USER_SETTING"."USER_ID" = "MST_USER"."USER_ID" WHERE ("MST_USER_SETTING"."SELECT_ID" = "BUNRUI" AND "MST_USER_SETTING"."OPTION_ID" = "KYOUSHI") AND ("MST_USER_SETTING"."SELECT_ID" = "GAKUNEN" AND "MST_USER_SETTING"."OPTION_ID" = "2") ) WHERE句の指定が悪いせいか、正しく取得できませんでした。 以上、よろしくお願い致します。
こんにちは。 PostgreSQL＋Perl＋DBIでCGIを書いています。 テーブルからデータを取得する場合なのですが、table1にはIDのみが登録されていて、table2には、そのIDに対する文字列が登録されているとします。 このような場合に、tableからIDを取得して、そのIDに対するtable2の文字列を一気に取得することは可能でしょうか？ つまり、 $dbh=DBI->connect(～); $sth=$dbi->prerare("SELECT id FROM table1 WHERE ～;"); $sth->excecute(); $id=$sth->fetchrow; $sth->finish(); $sth=$dbi->prerare("SELECT str FROM table2 WHERE id=$id;"); $sth->excecute(); $str=$sth->fetchrow; $sth->finish(); $dbh->disconnect(); といった処理をこんな感じに一度に行いたいのです。 $dbh=DBI->connect(～); $sth=$dbi->prerare("～～～～～;"); $sth->excecute(); $str=$sth->fetchrow; $sth->finish(); $dbh->disconnect(); 可能かどうかもわからないのですが、なにか良い方法はありますでしょうか？よろしくお願いします。
例えば select * from ((t1 left join t2 on t1.a=t2.a)left join t3 on t1.a=t3.a) where b.t1='y'; という風にカッコがついて記入しにくくなります。 ４つの場合はさらに深刻です。 簡単な記法はないのでしょうか?
WindowsにPostgresSQLをインストールしているのですが、サービス起動オプションの指定の仕方がわかりません。 -iオプションを付けて起動すれば、TCP/IP接続できるようになると知って、やってみようとしていて、試してみている次第です。 サービス起動のショートカットに、以下のようなショートカットがあるのですが、 C:\WINDOWS\system32\net.exe start pgsql-8.3 これに単純に後ろに-iを付けてみても駄目なようです。 どなたか方法をご教示ください。 環境は以下の通りです。 WindowsXP HomeEdition Version2002 PostgreSQL 8.3
select * from table1 a,table2 b where a.field1=b.field1; とできますが select * from table1 as a left join table2 as b on a.field1=b.field1; とできません。 joinの場合にテーブル名の別名を使う方法を教えてください
テーブルにchar(6)でyymmdd形式の日付を格納する領域を作成しております。この格納された日付から1週間以上過ぎたもののみ抽出したいのですが、sqlの構文を上手く作成できず大変こまっております。 有識者様大変お手数ですがご教授を頂けないでしょうか？
いつも参考にしております。ありがとうございます。 さて、WindowsXPにPostgreSQL8.1をインストールしたのですが、起動させ、パスワードを入力すると画面が消えてしまう現象が起きています。 このため、再度入れなおそうとするのですが、「データベースクラスタの初期化」画面で、「データディレクトリが存在します」といったメッセージ（英語）が現れ、パスワードを設定せずに（クラスタを初期化せずに）次に進むようになってしまいます。（クラスタ初期化せずにインストールを完了させても、上記エラーが再発します） 最初のインストールで、そこのパスワードをタイプミスした可能性もありますので、「データベースクラスタの初期化画面」で再度パスワードを設定したいのですが、どのようにしたらよろしいでしょうか？ ちなみに、再インストール前には、 　PostgreSQLの削除 　ユーザーアカウントPostgreの削除 　Document&settingsの下のPostgresフォルダ削除 を行っています。 基本的な質問で、恐縮ですが、どうぞよろしくお願いいたします。
PostgreSQL8.0.8の環境です。知り合いから頼まれての作業なのですが、２～３日前からPHPコネクションエラーが発生し、SSHからpostgres権限で該当DBにログインしようとしたところ、 psql: FATAL: conversion between LATIN1 and EUC_JP is not supported と表示され、PSQLログインが出来ません。PgAdminやCSEでも同じメッセージです。 １．この状態から何とかログインできる方法はあるのか？ ２．バックアップが無いようなので、このDBからテーブルやフィールド項目をGETする方法はあるのか？最悪、これまでのデータを破棄して、新しくDBを作成し、ガラだけでも作りたい。pg_dump をやろうとしても、同じFATALエラーが出ます。 ３．何が原因でこれが起きたのか？変な文字が入り込んだ？ 経験された方、わかる方がいらっしゃればと思います。
をインストールしようとしたのですが インストールの最後のほうで 「initdbの実行に失敗しました」 というエラーが出ました。 そのときのinitdb.logには このアプリケーションのサイド バイ サイド構成が正しくないため、アプリケーションを開始できませんでした。詳細については、アプリケーションのイベント ログを参照してください。 と書いてありました。 この状況をどのように解決したらいいでしょうか？ PostreSQL3.0ではなくてPostgreSQL8.3.0でしたので再質問しました。
データベースの構造とインデックス、検索クエリー 全て同じ条件でテストサーバと実際のサーバで 検索を行っているのですが以下のような結果がでます。 なぜ以下の様に10倍まで差が生まれるのかを 教えていただければと思っております。 違う箇所としては、サーバのスペックですが 実際のサーバのCPU：Xeon 3.2GHz メモリ：2GB テストサーバのCPU：Pentium4 3.2GHz　メモリ：2GB となります。 //テストサーバでの結果 Limit (cost=99427.05..99427.25 rows=4 width=112) (actual time=4022.29..4022.31 rows=4 loops=1) -> Unique (cost=99427.05..99438.37 rows=226 width=112) (actual time=4022.29..4022.30 rows=5 loops=1) -> Sort (cost=99427.05..99432.71 rows=2265 width=112) (actual time=4022.29..4022.29 rows=6 loops=1) Sort Key: s.saorderid, s.saserialid, o.odlastupdate -> Merge Join (cost=96997.70..99300.85 rows=2265 width=112) (actual time=3363.93..4022.11 rows=40 loops=1) Merge Cond: ("outer".odid = "inner".saorderid) -> Sort (cost=8054.50..8059.58 rows=2033 width=68) (actual time=13.52..13.55 rows=38 loops=1) Sort Key: o.odid -> Index Scan using order1_odctmid_index on order1 o (cost=0.00..7942.81 rows=2033 width=68) (actual time=13.13..13.47 rows=38 loops=1) Index Cond: (odctmid = 3403::bigint) -> Sort (cost=88943.20..90075.54 rows=452935 width=44) (actual time=3344.05..3688.13 rows=452002 loops=1) Sort Key: s.saorderid -> Seq Scan on sale s (cost=0.00..12792.35 rows=452935 width=44) (actual time=0.02..756.03 rows=452935 loops=1) Total runtime: 4050.02 msec //実際の本番サーバでの結果 Limit (cost=73933.37..73933.39 rows=1 width=128) (actual time=43102.58..43102.59 rows=4 loops=1) -> Unique (cost=73933.37..73933.39 rows=1 width=128) (actual time=43102.58..43102.59 rows=5 loops=1) -> Sort (cost=73933.37..73933.38 rows=5 width=128) (actual time=43102.57..43102.58 rows=6 loops=1) Sort Key: s.saorderid, s.saserialid, o.odlastupdate -> Nested Loop (cost=0.00..73933.32 rows=5 width=128) (actual time=998.20..43102.38 rows=40 loops=1) Join Filter: ("outer".odid = "inner".saorderid) -> Index Scan using order1_odctmid_index on order1 o (cost=0.00..18.12 rows=4 width=68) (actual time=6.01..6.99 rows=38 loops=1) Index Cond: (odctmid = 3403::bigint) -> Seq Scan on sale s (cost=0.00..12797.54 rows=448254 width=60) (actual time=0.01..756.51 rows=455437 loops=38) Total runtime: 43102.69 msec もしクエリー文もあった方がよければ お知らせ下さい。 すみませんが、どなたか教えて頂ければ と思います。よろしくお願い致します。
PgSQLで関数を作成したいのですが、記述方法がわかりません。 結果がbool trueならint 1 結果がbool falseならint 0 を返すようなものを作りたいのですが、どのように記述すれば良いのでしょうか。 CREATE FUNCTION BOOL2INT(boolean) RETURNS integer このあとの記述が複雑でわかりません
powergresで開発していて、困った点が出たので質問致します。 質問内容 　powergresでalter文でカラムの追加・削除等を行うと、 　追加したカラムに紐づくテーブルのデータが消えてしまったりすることはあるのか？ 　（alter文でカラムを削除した時のデータ以外のデータ） です。 なぜこんな質問をしたかというと 現在webツールからリクエストを送るとカラムの追加・削除ができるという 処理を作成しようとしています。 環境は ・Java1.5 ・powergres5.0 ・Apache + tomcat です 個人的な見解では、データ削除・テーブルごと削除の命令を出さない限り データは消えることなんてないと思っているのですが・・・・ 私の能力ではお客さんに論理的に説明したいのですが、 まだ論理的に説明できない状態です。 ・データが消える・消えない。 ・その詳細な理由がほしいです。 大変申し訳ございませんが、よろしくお願い致します。
psqlコマンドでDBへの接続を行っております。 /usr/local/pgsql/bin/psql -U postgres -h xxx.xxx.xxx.xxx testdb 上記コマンドをコマンドラインから実行するとパスワードが聞かれます。 パスワード設定をmd5にしているためですが、 その設定を変更せずコマンドラインでパスワードを渡すなどしてパスワードの入力を促す処理をスルーしたいのですが全然出来ません。 どのなたかご存知の方、いらっしゃいましたらご教示の程お願い致します。
環境はｘｐ、apache2、php5、Postgresql8.2です。 1台のPCをサーバ＆クライアントにしています。 ただ今PHPとPostgresqlの勉強をしています。 いつも質問に答えてくれてありがとうございます。 bool型のデータを yの場合は「○」 nの場合は「×」 で表示するために以下のようにしました。 －－－－－－－－－－－－－－－－－－－－－－－－－－－ $sql_limit2 = "SELECT m_lecturehistory.lecturecode, CASE WHEN m_lecturehistory.syukketu='y' then '○' else '×' end as syu FROM m_lecturehistory;"; $sql_limit = mb_convert_encoding($sql_limit2,"EUC-JP","eucJP-win"); $rs_limit = pg_query($d_base,$sql_limit) or die("quary faild sql_limit"); －－－－－－－－－－－－－－－－－－－－－－－－－－－ ところが「○」「×」が表示されず 「??」になってしまいます。 文字コードは、 ポスグレとソースは「EUC-JP」 表示は「UTF-8」です。 ご教示して頂けたら幸いです。
time ---------------------------- 2006-12-01 00:00:00.323861 2006-12-01 00:00:00.710523 2006-12-01 00:00:00.963864 2006-12-01 00:00:01.45068 2006-12-01 00:00:01.512551 2006-12-01 00:00:02.17493 2006-12-01 00:00:02.731608 2006-12-01 00:00:02.873651 2006-12-01 00:00:03.398863 2006-12-01 00:00:03.438085 2006-12-01 00:00:03.833481 このようなレコードが格納されているテーブルに対して、例えば1秒ごとにレコードを集計してその集計時間と集計数を表示する　といったことをどのようなSELECT文を作れば良いのでしょうか？ SELECT COUNT (time) FROM table1 where ～ と書いて条件文を一秒ごとに設定した文を何度も繰り返し実行してみたのですが、処理を完了するのにかなり長い時間を要したのでこの方法は断念しました。 短時間でこの処理が行えるような文があったら教えてください。 お願いします。
お世話になっております。 Windows版のPostgreSQL8.1を使用しています。 Windowsのバッチファイルで毎週自動実行で pg_dumpによるバックアップを取得しようと思っています。 バックアップは正常に取得できるのですが、 どうしてもログファイルが出力できません。 手動でバッチを動かすと、プロンプトには表示が出ます。 『pg_dump: テーブル×××の内容をダンプしています』 のように。それをどうやったらファイルに残せるかを知りたいです。 実行しているコマンドは、 pg_dump.exe -f "DBバックアップファイル" -i -v -h ホスト名 -p ポート -U "ユーザ名" -F c "DB名">>"ログファイル名" としています。 以上です。宜しくおねがいします。
現在2つのサーバにて全く同じselect文で 速度検証を行っております。 仮にAサーバ（以降A）　Bサーバ（以降B） とします。 Aのスペックは CPU：Intel(R) Xeon(TM) CPU 3.20GHz メモリ：2GB Bのスペックは CPU：Intel(R) Pentium(R) 4 CPU 2.80GHz メモリ：2GB select文は以下の様な形です select * from t1,t2 where t1id=t2id～ 検索データ量 t1,t2共に40万件ほど ちなみにA側においては既に稼動しており 軽めの何らかのアクセスは常にある状態です。 上記の条件の元select文を動かした場合 Aについては5分以上かかる状態 Bについては5秒ほどで検索できます。 ココまで差がでてしまうのは何が原因と 考えられますでしょうか？ 追記 A側で検索を基本(テーブル結合等)を変更せずに 条件だけを変更した場合数秒で出るようになります。 情報として足りない事がありましたら すみませんが、ご指摘願います。 どなたかヒント(気づき)でも構いませんので お教えお願い致します。
PostgreSQL 8.1.4を使用しています。 仕様の変更によりテーブルへフィールドの追加を行なったのですが、このフィールドの位置を変更する事はできるのでしょうか。 DDL文を整えて作った空のテーブルへデータをリストアしようとしましたがうまくできませんでした。 よろしくお願いします。
下記のようなテーブルがあります。 テーブル名：masta フィールド：hinmei,tani,hiduke,ryou これを 品名　｜　単位　｜1月｜2月｜3月｜ A　　 ｜リットル｜10｜20｜30｜ B　　 ｜グラム　｜12｜13｜14｜ のようにてんかいしたいのです。 現在SQLは SELECT Hinmei ,Tani ,Hiduke ,SUM(ryou) as ryou FROM masuta WHERE hiduke BETWEEN '200801' AND '200812' GROUP BY Hinmei ,Tani ,Hiduke このようにしてますが、横てんかいの方法が分かりません。 どのようなSQLをかけばいいのでしょうか？
例えば、「TEST」テーブルに列 A,B,C が存在する場合、 SELECT A,B,C FROM TEST; で、A,B,C を出力できますが、TEST テーブルに存在しない列 D を固定値「あああ」 で出力する事は可能でしょうか？ 可能でしたら、SQLの記述を教えて頂けないでしょうか？ 有識者の方、よろしくお願いします。
環境はｘｐ、apache2、php5、Postgresql8.2です。 1台のPCをサーバ＆クライアントにしています。 ただ今PHPとPostgresqlの勉強をしています。 いつも質問に答えてくれてありがとうございます。 データベースクラスタが破損したようなので postgresSQLを再インストールしようと思います。 その時、今まで作成したデータベースをバックアップをしたいのですが Windoes版でどのようにしたら 宜しいですか？
http://itpro.nikkeibp.co.jp/members/ITPro/oss/20050722/165140/?P=2 このページにかかれている「Constraint Exclusion」という方式を使用してテーブルのパーティショニングを行ったつもりなのですが、あるデータをSELECT文で検索してみても全てのテーブルに対して検索してしまっているようなのです。 このページに書いてある通りにテーブルを作成したのですが、どこに問題があるのか分かりません・・・。 何か駄目な所があるならば教えてください。お願いします。
皆様、新年明けましておめでとうございます。 早速ですが、date型でのbetweenについて教えてください。 SQL文 SELECT * FROM test WHERE date between date '2007-12-01' and date '2007-12-31' を発行すると、2007-12-31のレコードがあるのに該当しません・・・ 試しにSQL文を SELECT * FROM test WHERE date between date '2007-12-01 00:00:00' and date '2007-12-31 23:59:59' としても2007-12-31のレコードは検索されません・・・ SQL文を SELECT * FROM test WHERE date between date '2007-12-01' and date '2008-01-01' にすると2007-12-31が該当するのですが、 SELECT * FROM test WHERE date between date '2007-12-01' and date '2007-12-31' では2007-12-31のレコードは該当しないものでしょうか？？ select * from test where num between 10 and 100 とした場合では、num が 10 ～ 100 のものが問い合わされますよね？？ date型になるとこうならないのでしょうか？？ よろしくお願いします。
環境はｘｐ、apache2、php5、Postgresql8.2です。 1台のPCをサーバ＆クライアントにしています。 ただ今PHPとPostgresqlの勉強をしています。 いつも質問に答えてくれてありがとうございます。 以下のようなテーブルに insert処理でデータを追加したいと思っています。 －－－－－－－－－－－－－－－－－－－－－－－－－－－ CREATE TABLE m_lecturehistory ( lecturecode text, lecturedate date, ・ ・ ・ －－－－－－－－－－－－－－－－－－－－－－－－－－－ $sql = "insert into m_lecturehistory (lecturecode, lecturedate ) values ('{$line[0]}','2008/1/1');"; このようにしてinsert処理をすれば正常に追加できます。 ただ、以下のようにして 変数からDATE型に追加しようとするとエラーになります。 －－－－－－－－－－－－－－－－－－－－－－－－－－－ $line[1] = "2008/1/1"; $sql = "insert into m_lecturehistory (lecturecode, lecturedate ) values ('{$line[0]}',"{$line[1]}");"; 対処方法をご存じでしたら、 ご教示して頂けたら幸いです。
PostgreSQL 8.1.3をインストール時に以下のエラーが出ます。 ダイアログ１ ---- タイトル＞内部のエラー メッセージ＞Failed to get system metrics for terminal services: 87 ---- ダイアログ２ ---- タイトル＞致命的なエラー メッセージ＞インストーラは、エラーのために途中で終わりました。 ---- どうすればインストールできるようになりますか？
お世話になります。 データベースには、「name1」「name2」と ２つのフィールドに姓名が分かれて入っています。 検索で、「山田太郎」と入力されたとき、 「name1」「name2」を結合した列で抽出したいのですが どのようにSQLを書けばいいのでしょうか？ よろしくお願いします。
以下のようなクエリーを作成して検索を 行っているのですが、どうしても抽出が出来ないくらい 遅くどの部分で遅くしているのかが分からないため、 どなたか教えてもらえないでしょうか？ ※足りない情報があればすみませんが、仰ってください。 なるべくプログラム（PHP等）を使わずクエリのみで 行いたいので、PHP云々の話しは無しでお願い致します。 最初の抽出テーブル(osi)と次の抽出テーブル(osday) をそれぞれ個別で動かすと普通の速度で抽出が旨く行きます が、それらをくっつけた形 select (省略) from osi,osday where osi.id=osday.id; とすると、抽出が行えない又は非常に遅いとなります。 ///////// 実際のクエリー文です ///////// select osday.odid,odctmid,saitemname,startday,endday from ( select odid,saitemname from order1 as o,sale as s where o.odid=s.saorderid and (o.odshipdue >= '2007-12-1 00:00:00' and o.odshipdue <= '2007-12-18 23:59:59') and (o.odcancelflag='0' or o.odcancelflag is null) and o.odclass<'4' and s.saregular='1' and s.saitemcode in (select itcode from item where itcategory='1') and odmakeday is not null ) osi , ( select odid,max(odctmid) as odctmid,to_char(min(o.odshipday), 'YYYY-MM-DD') as startday,to_char(max(o.odshipday), 'YYYY-MM-DD') as endday from order1 as o,sale as s where o.odid=s.saorderid and (o.odshipdue >= '2007-12-1 00:00:00' and o.odshipdue <= '2007-12-18 23:59:59') and (o.odcancelflag='0' or o.odcancelflag is null) and o.odclass<'4' and s.saregular='1' and s.saitemcode in (select itcode from item where itcategory='1') and odmakeday is not null group by o.odid ) osday where osi.odid=osday.odid; ///////////////////////////////////////////
PostgreSQLのpg_dumpを用いたバックアップで困っています。 OSはVineLinux 2.2.17-0vl10です。 あるサーバ(PostgreSQL7.0.2)のデータベースtest_db(EUC_JP)に対して、 pg_dump -D -v -i -f test.dump test.db でダンプファイルを作成しました。 COPYでは不確実な場合があるということでINSERT文で出力しました。 (データの日本語の部分が数字に変換されています) それを別のサーバ(PostgreSQL8.2.5)のデータベースtest2_db(EUC_JP)にリストアしました。 psql test2_db < test.dump すると、"(株)"という文字を含む文字列が化けてしまっていました。 同じレコードの他のカラムは大丈夫です。 このような場合の対策がありましたら教えていただきたいと思います。 宜しくお願いします。
環境はｘｐ、apache2、php5、Postgresql8.2です。 1台のPCをサーバ＆クライアントにしています。 ただ今PHPとPostgresqlの勉強をしています。 pgadmin3で、「object」という列を 「term」という列の後に追加したいと思い 以下のSQLを発行しました。 ALTER TABLE "m_lecture" ADD "object" text NOT NULL AFTER "term"; 以下のようなエラーになります。 ERROR: syntax error at or near ""term"" SQLステート:42601 文字:52 ご教示して頂けたら幸いです。
いつもお世話になっております。 現在、2台のPCにpostgreSQL8.2.5をインストールしpgpool-II-2.0.1を入れてレプリケーション機能を試しているのですが，一旦、セカンダリサーバーを止めて、マスタサーバーで処理をし、セカンダリサーバーを起動させてみて、DBを確認しましたら、両サーバーのDBは不一致でした。実際に障害が発生し、データーに不一致が生じた場合、データを一致させるにはどうすればよろしいのでしょうか。 御指導をお願い致します。
こんばんは。 PostgreSQLについて質問させてください。 CSEを使ってSQLの勉強をしていますが、 データベースを作成した際に、 WARNING: nonstandard use of escape in a string literal at character 42 WARNING: LOCATION is not supported anymore という表示がされ、 その後、テーブル作成などをすると エラーになり実行できません。 例えば、 create table テーブル名( id number(8) primary key, name char(10), birth date ) ; を実行した際に、 SQL実行中に以下のエラーが発生しました。 ERROR: syntax error at or near "(" at character 32 というエラーになります。 この原因は、Encodingの問題だと思っていますが、 どのように解決したらいいか教えてください。 また、Encodingの問題ではない場合は その際の対処法を教えてください。 以上、ご回答のほどお願いいたします。
お世話になります。 postgresql ポート変更を5432から5433に変更し,psql -lを実行したら、 Is the server running locally and accepting conection on Unix domain socket "tmp/.s.5432"? というエラーが発生しました。5432に戻すとエラーは消えるのですが、環境上5433で接続したいのですが、どこが悪いのか全く検討がつきません。 ご指導をお願い致します。
環境はｘｐ、apache2、php5、Postgresql8.2です。 1台のPCをサーバ＆クライアントにしています。 ただ今PHPとPostgresqlの勉強をしています。 先日、 サーバに接続できません・・・ http://oshiete1.goo.ne.jp/qa3523104.html というご質問をさせて頂いた者です。 回答者様のお陰で理解を深めることで出来ました。 「postgresql.conf」のIPアドレスを確認したところ #listen_addresses = 'localhost' と、なっていました。 頭に「#」があるということは その行は実行されていないということですよね？ 「#」を省いた方が宜しいのでしょうか？
環境はｘｐ、apache2、php5、Postgresql8.2です。 ただ今PHPとPostgresqlの勉強をしています。 Pgadmin3で postgresサーバに接続しようとすると 次のようエラーが出て 接続することが出来ません。 「サーバに接続できませんでした サーバはホスト"000.0.0.1"で稼働していますか？ また、ポート5432でTCP/IP接続を受け付けていますか？」 そのため、postgresをアンインストールして インストールし直したところ 接続できるようになったのですが 新しいデータベースを作ろうとしたところ また同じエラーが出て接続できなくなってしまいました。 ご教示して頂けたら幸いです。
環境はｘｐ、apache2、php5、Postgresql8.2です。 ただ今PHPとPostgresqlの勉強をしています。 postgresに接続できなくて困っています。 <?php $d_base = pg_connect("user='postgres' password=xxxx dbname='test'"); //データベースに接続 で、エラーになり その内容は、 Warning: pg_connect() [function.pg-connect]: Unable to connect to PostgreSQL server: could not connect to server: Connection refused (0000000000D/00000) Is the server running on host "???" and accepting TCP/IP connections on port 5432? in です。 ご教示して頂けたら幸いです。
PostgreSQLにて AとBというデータベースがあると仮定し、 AにはA1,A2,A3というテーブルがあるとし BにはB1,B2,B3というテーブルがあるとします。 抽出時Bの中のテーブルであれば結合を行い 一度で抽出が色々行え速度向上を行えるのですが、 データベースがBとAと分かれている時、一度Bで検索 をかけそのデータをAに渡し新たに検索というスタイル を使わなければなりません。 そこで、AのA1というテーブルデータをそのままの形で Bのデータベースへ移動する事は出来ないでしょうか？ もちろんPHP等でプログラムを組んで再構築すれば 出来るのはわかりますが、もっとシンプルに出来れば と思い質問させて頂いております。
　たびたびお世話になります。 　PHPファイルのテキストボックスに入力された文字列でテーブルを検索して結果を取得したいのですが、複数キーワードでのあいまい検索の扱いで困っています。 　例えばtitleというカラムにある「今日はいい天気です」という文を検索したい場合は、PHPからSQL文で「select * from table where title like '%天気%';」とやれば引っかかるのですが、では「今日　天気」でやった場合、また「いい　今日」で検索した場合も引っかかるようにしたいのです。 　PHPで文字列を代入してSQL文を作る形になるとは思うのですが、この場合、SQL文はどのように記述すればいいのでしょうか？
以下のテーブル関連で、以下のロジックで、recipe_id だけの一覧を取得するのは、1本のSQLではどのようにすればよいでしょうか？ ＃あとこのような、クエリーの事をなんと呼べばいいのでしょうか…。 ＃適切質問タイトルが思い浮かばなかったので、提示してもらえるとありがたいです。 recipe recipe_id | name 1 | ズッキーニとオリーブのトマトパスタ 2 | ズッキーニとオリーブのトマトのマリネ 3 | ズッキーニのアリオリ 4 | 野菜のフリッター recipe_ingredients recipe_ingredient_id | recipe_id | master_id 1 | 1 | 1 | ※　ズッキーニとオリーブのトマトパスタ 2 | 1 | 2 | ※　ズッキーニとオリーブのトマトパスタ 3 | 1 | 3 | ※　ズッキーニとオリーブのトマトパスタ 4 | 1 | 4 | ※　ズッキーニとオリーブのトマトパスタ 5 | 2 | 1 | ※　ズッキーニとオリーブのトマトのマリネ 6 | 2 | 2 | ※　ズッキーニとオリーブのトマトのマリネ 7 | 2 | 3 | ※　ズッキーニとオリーブのトマトのマリネ 8 | 3 | 1 | ※　ズッキーニのアリオリ 9 | 3 | 4 | ※　ズッキーニのアリオリ 10 | 4 | 1 | ※　野菜のフリッター ※　はわかりやすくつけただけで、実際のテーブルデータではないです。 vegetables vegetable_id | name 1 | ずっきーに 2 | おりーぶ 3 | とまと 4 | にんにく ロジックはアンド検索で： 検索条件「ズッキーニ、トマト」で検索したら、 　「ズッキーニとオリーブのトマトパスタ」と「ズッキーニとオリーブのトマトのマリネ」 検索条件「にんにく、ズッキーニ」で検索したら、 　「ズッキーニとオリーブのトマトパスタ」と「ズッキーニのアリオリ」 が見つかる。 名前でLike検索はしない。 全く持って想像がつかないので教えてください。 ちょっと考えてみたんですが、↓では、１～４のレシピ全てが見つかってしまうのですよね…。 select recipe_id from recipe inner join recipe_ingredients using ( recipe_id ) inner join vegetables using ( vegetable_id ) where vegetables.name like '%ずっきーに%' or vegetables.name like '%にんにく%' ; もしかして、以下でしょうか？ select recipe_id from recipe inner join recipe_ingredients using ( recipe_id ) inner join vegetables using ( vegetable_id ) where vegetables.name like '%にんにく%' INTERSECT select recipe_id from recipe inner join recipe_ingredients using ( recipe_id ) inner join vegetables using ( vegetable_id ) where vegetables.name like '%ずっきーに%'; なんとなくコストが高そうなので、他に方法はないでしょうか？
現在、testDB1とtestDB2というDBが存在します。 それで、testDB1のtable.idとtestDB2のtable2.idを SELECT文で比較して、同じidの場合はtestDB2のtable2.dataに 1という値を格納したいと思っています。 それで、DBをまたいで更新するときの記述が分からず ネットで検索したのですが、うまくヒットしませんでした。 そもそもDBをまたいで問い合わせや更新等はできないのでしょうか？ できない場合、代替の方法があったら教えて頂けますでしょうか。 よろしくお願い致します。
PostgreSQL8.24を利用しています。 pgADMINIIIでテーブルを作成しました。 【TABLE_A】と【TABLE_B】があります。 【TABLE_A】の【ID】が【TABLE_B】の【ID2】が外部キーとして設定してあります。 CONSTRAINT TABLE_B_fkey FOREIGN KEY (ID2) REFERENCES TABLE_A (ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION 上記のように記述されています。 SQL文のUPDATEを使い、IDが「01」を「05」に更新したいのですが、 以下のように記述するとエラーになります。 どのようなUPDATE文を記述すればよろしいのでしょうか。 UPDATE TABLE_A INNER JOIN TABLE_B on TABLE_A.ID=TABLE_B.ID2 SET TABLE_A.ID = '05',TABLE_B.ID2 = '05' WHERE TABLE_A.ID='01'" よろしくお願いいたします。
Postgresql7.2.4で user:postgresにより CREATE TABLE test (id serial PRIMARY KEY,num INT4) というテーブルを作成し、 GRANT ALL ON test TO PUBLIC と権限を与えました。 そしてPHP4よりuser:nobodyで INSERT INTO test (num) VALUES (1) というクエリを実行しようとすると ERROR: test_id_seq.nextval: you don't have permissions to set sequence wash_h_test_id_seq in test.php とでます。 しかし INSERT INTO test (id,num) VALUES (1,1) とするとちゃんとデータベースに反映されます。 PHPで、このユーザーからserialを使った自動連番で 書き込めるようにするにはどうすればいいのでしょうか。
Red Hat Enterpraise Linux 3 PostgreSQL7.3.10(Linux) 現在2つのテーブルＡ，Ｂにてメールアドレスを管理していますが その2つのテーブルの差分を知りたいのですが、 （Ａを基準と考えＢとの差分：つまりＡには存在しないデータ抽出） プログラム（ＰＨＰ等）を使用せずに 差分を取得するには、どの様なクエリー文を組むと出来るのでしょうか？ よろしくお願いします。
　Linuxの初心者です。PostgreSQLとPHP5でwebアプリをつくりたいのですが、環境が構築できずに困っています。現時点での環境を以下に記します。 OS ; Fedora Core 6 server ; apache 2.2.3 DB ; PostgreSQL 8.1.4 言語 ; PHP 5.1.6 Fedora Core 6 をインストールする時に apache と PostgreSQL と PHP はインストールされていました。そして以下の様に設定ファイルを書き直しました（今回の質問に関わりのなさそうなものは省いていますが、なにぶん初心者のため、なにか足りないものがありましたら教えていただきたいと思います）。 ・apache /etc/httpd/conf/httpd.conf 　　 265 ServerName localhost:80 748 AddDefaultCharset EUC-JP ・PHP /etc/php.ini 777 pgsql.allow_persistent = On 781 pgsql.auto_reset_persistent = 0 784 pgsql.max_persistent = -1 787 pgsql.max_links = -1 791 pgsql.ignore_notice = 0 795 pgsql.log_notice = 0 ・PostgreSQL /var/lib/pgsql/data/postgresql.conf 　　　　　　49 listen_addresses = '*' 52 port = 5432 ・PostgreSQL /var/lib/pgsql/data/pg_hba.conf local all all ident sameuser host all all 127.0.0.1/32 ident sameuser host all all ::1/128 ident sameuser host all 0.0.0.0 0.0.0.0 trust 　スクリプト内で pg_connect() 関数を使って PostgreSQL に接続しようとすると、 　Warning: pg_connect() [function.pg-connect]: Unable to connect to PostgreSQL server: could not connect to server: Permission denied Is the server running on host "localhost" and accepting TCP/IP connections on port 5432? 　Warning: pg_last_error() [function.pg-last-error]: No PostgreSQL link opened yet 　というエラーが出てしまうのです。 　調べてみたら php-pgsql という拡張モジュールがインストールされていたにも関わらずに、phpinfo() の configure に --with-pgsql が見当たらないのです。パッケージでインストールしたためにオプションが付いていなかったのでしょうか。 こちらのサイトで似たような質問があって読んだのですが、どこのディレクトリで configure をやり直したらいいのか、make clean コマンドで一回オプションを全て消さないとだめなのかがわからなくて困っています。 　どなたか詳しい方がいらしたら、教えてください。 　よろしくお願いいたします。
はじめまして。 PostgreSQLビギナーです。 インストール時に下記メッセージがでるのですがどう対処すればいいでしょうか。 アカウント名,アカウントドメインはインストール手順書に書いてある とおりなんですがなにか準備がいるのでしょうか。 ご指導ください。 サービス構成入力後。 サービス名：PostgreSQL Database Server 8.1 アカウント名：postgres アカウントドメイン：TIGRLIS パスワード:AAA Your local 'Administrators' group contans 'Interactive Users' This is a common configuration error causes security issus\es for this reason Postage
PostgreSQLのＳＱＬ文法の簡単な説明を書いてある本またはＷＥＢはないでしょうか、ＩＮＳＥＲＴ、ＵＰＤＥＴＥ、ＤＥＬＥＴＥなどをリモートでやる方法が載っているやつなんですが、ちょっと困ってます。
postgresql8.2.4を使っています。 select to_char(10/3, '99D999'); とすると、 3.000となります。 10/3=3.3333....ではないのでしょうか？ 他のSQL(MySQLやSQLServer,Oracle,DB2)もどう記述するか知りたいです。
基本的な質問で申し訳ありません。1台のLinuxサーバ(CentOS)に、MySQLとPostgresの両方をインストールして、同時に起動し、別のデータベースとして使用することはできるのでしょうか？
たとえば データ(1) Ａ：１１時　Ｂ：１３時 データ(2) Ａ：１８時　Ｂ：０時 データ(3) Ａ：２３時　Ｂ：３時 現在時刻が１２時の場合 データ(1)が抽出 現在時刻が１７時なら データ(2)(3)が抽出 現在時刻が０時なら データ(2)(3)が抽出 のように 現在時刻が期間ＡからＢに該当する場合に データがＨＩＴするような ＳＱＬを作りたいのですが うまくいきません where 'now' between A and B; ではうまくいきませんでした 何か良いＳＱＬはありませんか？ ちなみにTIME型データです それ以外のデータ型でもいいです 希望通りの動きをするなら・・・ よろしくお願いします
PostgreSQL8.2.24を使っています。 インデックスの削除と、インデック名のつけ方についてお聞きしたいです。 まず、削除ですが、create index tbl_fld_key on tbl (fld); としたものは、drop index tbl_fld_key;で削除できますが、 create tbl ( fld integer, unique key (fld) ); としたものは、drop index tbl_fld_keyで削除できません。 インデックス名は\diコマンドで表示されている tbk_fld_keyです。 メッセージは次のとおりです。 db =# drop index tbl_fld_key; ERROR: cannot drop index tbl_fld_key because constraint tbl_fld_key on table tbl requires it HINT: You may drop constraint tbl_fld_key on table tbl instead. あと、PostgreSQLのインデック名の規則について インデックス名を見ただけで判断できるように作られるようですが PRIMARY KEY　テーブル名_フィールド名_pkey UNIQUE　　　 テーブル名_フィールド名_key 重複可　　　 テーブル名_フィールド名_？？？ <<--- この部分が知りたいです。
データベース自体はPostgreSQLを使っています。そして、アクセス2003を使って、テーブルリンクで閲覧しています。 あるフィールドに検索が早くなるようにキーを設けたいのですが、 重複を許すキーの構文がわかりません。 PRIMARY KEY, UNIQUEの設定はわかるのですが、 どのように記述すればよいのでしょうか？ 以下、アクセスのプロパティです。 インデックス ●いいえ デフォルト、無指定 ●はい（重複あり）[***** ここの部分のSQLが知りたい *****] ALTER TABLE テーブル名 ADD ???????? (フィールド); ●はい（重複なし）UNIQUE もしくは値要求混みのPRIMARY KEY ALTER TABLE テーブル名 ADD UNIQUE (フィールド); ALTER TABLE テーブル名 ADD PRIMARY KEY (フィールド);
Windows Vista Business に PostgresSQL はインストール可能でしょうか？ どなたか教えていただけないでしょうか？
WindowsのPostgreSQL8.2.24を使っています。PL/Perlが使いたいのですが、インストール時に、以下のようになります。 データベース・コマンド・エラー: ERROR; could not load library "C:/Program Files/PostgreSQL/8.2/lib/plperl.dll": The specified module could not be found. Windows版でPL/Perlが使いたいのですが可能でしょうか？
お忙しいところ申し訳ありませんが、ご教示お願い致します。 Aサーバ(xxx.xxx.xxx.xxx)のDB（A_DB)を Bサーバ(yyy.yyy.yyy.yyy)のDB（これをB_DBとしたい）に コピーをしたいと考えております。 AサーバのA_DBの情報（レコードも含む）をBサーバにB_DBとしてコピーしたいですが、よくわかりません。。。 ご存知の方いらっしゃいましたらお手数ですがご教示下さいm(_ _)m
PHPとPostgreSQLでファイルを作成しました。 (2)、(3)の場合だと問題なく動作しますが、 (1)の場合だと動作しません。 「あ」が2バイトなのが原因かとおもうのですが、 よくわかりません。他に原因あるのでしょうか。 ********************************************** 環境　PHP5　Apache2.2　PostgreSQL8.24 ********************************************* <?php // 接続設定（サーバ／データベース／ユーザ／パスワード） $sv = "localhost"; $dbname = "test"; $user = "user"; $pass = "pass"; // 文字コード $enc_disp = "EUC-JP"; $enc_db = "EUC-JP"; // データの文字コードを変換する関数 function cnv_enc($string, $to, $from) { // 文字コードを変換する $det_enc = mb_detect_encoding($string, $from . ", " . $to); if ($det_enc and $det_enc != $to) { return mb_convert_encoding($string, $to, $det_enc); } else { return $string; } } // データベースに接続する $conn = pg_connect("host=$sv dbname=$dbname user=$user password=$pass") or die("接続エラー"); (1)$sql = "select * from test WHERE name LIKE N'あ%'"; (2)$sql = "select * from test WHERE tel LIKE N'090%'"; (3)$sql = "select * from test WHERE no LIKE N'a%'"; ?> ********************************************* nameには、名前の文字列（いとう、さとう）が、 telには、電話番号（090…、03…）が、 noには、アルファベット一文字（a、b）が 入力されています。 *********************************************
４桁と５桁の値が入っているフィールドのテーブルがあります。 やりたいことは、下三桁目に「－」を入れたいです。 例） １２３４５ ５６７８ ↓ １２３－４５ ５６－７８ 以下のようなコードを作成しましたが、 LEFTとRIGHT関数がPostgreSQLでは使用できないようです。 WEBで調べてSUBSTRINGを使うのかなと思ったのですが、 どうすればいいかわかりません。 ******作成したコード*********** (LEFT(id,LENGTH(id)-2) || '-' || RIGHT (RTRIM(id), 2)) どうぞ宜しくお願い致します。
phpPgAdminをインストールばかりなのですがログイン方法が分かりません。 いろいろ試したんですが「ログインに失敗」が出て入れません。 どうしたらログインできるでしょうか？ バージョンを記しておきます。 Fedora Core 6 kernel-2.6.20-1.2962.fc6 postgres (PostgreSQL) 8.1.9 phpPgAdmin-4.1.3-2.fc6 php-pgsql-5.1.6-3.6.fc6
accessのレコードデータをpostgreSQLに移行したいと考えています。 accessのデータをcsvファイルにエクスポートしてからposgresSQLで インポートしようと考えていました。 しかしレコードの中にEnter(改行コード)があるので、csvに変換して しまうとレコードの件数以上に行数ができてしまい、postgresSQLで インポートがうまくできませんでした。 accessのレコードにある改行コードを他の文字に変換するしか posgreSQLに移行する方法はございませんでしょうか？ できれば改行コードもそのまま移行したいと考えておりますが 何か良い方法があればご教授頂ければと思います。 よろしくお願いします。
Windows上でPostgreSQL8.0を使用しています。 DBのバックアップを毎日自動で（タスク登録して）とっています。 具体的にはバッチファイルの中で以下のようなpg_dumpコマンドを実行させています。 「pg_dump -U ユーザー名 -f %DATE:~0,4%%DATE:~5,2%%DATE:~8,2%EXPDAT.db DB名 <dmp.txt」（なお、最後のテキストファイル内にはたぶんパスワードと思われる内容が記載されています。） 通常はAdminIIIを使用してバックアップおよびリストアを行っており、上記のバッチ実行にて作成されたダンプファイルからのリストアを行ったことがありません。（拡張子がBackupでないので、AdminIIIからのリストアはできませんでした） ヘルプや書籍を参考に、psqlからのリストアを試みたのですが、そもそもどのようにコマンドを入力してよいかわかりません。 試した内容は以下の通りです。 １．psql.exeを実行 ２．ホスト名、ユーザー名、パスワード、データベース名をそれぞれ入力 ３．データベース名#>　が表示されるので、「psql -U ユーザー名 -d データベース名　-f　"c:\20070822EXPDAT.db"」と入力し実行すると、psqlという文字列に対してsyntaxエラーとなってしまいました。 そもそも、psql画面でのコマンドの入力方法がよくわかっておりません。書籍などをみるとよく「psql -U xxx -d xxx -f xxx」と書いてありますが、実際に入力するのはどこからでしょう？ 担当者が退社してしまい、手探り状態で運用し始めたところです。 大変初歩的な質問で申し訳ありませんがよろしくお願いいたします。
PostgreSqlを利用しております。 テーブルAを作成し、テーブルにはURL、HPの簡単な説明をもっております。 HPデータを5万件程度登録したあたりで、 データベースからデータを取り出し、htmlで表示するまで50～80秒 程度時間がかかってしまいます。 プログラム言語はPerl、DBへのアクセスはPgモジュールを使用して おります。 レンタルサーバであるため、Postgreのバージョン、サーバスペック 等はわかっておりません。 ※他のユーザと共用サーバであることは間違いないのですが。 有識者様にご質問ですが、Postgreは5万件程度の登録で動作 が重くなるのでしょうか？ それとも、サーバの設定の問題でしょうか？
いつもお世話になっております。 早速質問させていただきます。 ＜memberテーブル＞ birthday(生年月日) graduate_cd(学歴コード) prefecture_cd(都道府県コード) があります。 ＜pointテーブル＞ min_age_cd(最小年齢コード) max_age_cd(最大年齢コード) graduate_cd(学歴コード) prefecture_cd(都道府県コード) があります。 memberテーブルのbirthdayは以下の式で年齢を割り出しています。 extract(year from age(now(), birthday)) as age やりたいことは・・・ (1) point.min_age_cd<=member.age and max_age_cd>=point.max_age_cd の場合マッチ。 (2) point.graduate_cd=member.graduate_cd の場合マッチ。 (3) point.prefecture_cd=member.prefecture_cd の場合マッチ。 ただ、point.prefecture_cdには、カンマ区切りで複数の prefecture_cdが格納されていますので、正規表現になるのでしょか？ 正規表現の方法も教えていただきたいです。 (1)～(3)のマッチした数が多い順にソートをしたいと思っています。 皆さま、ご教授お願いいたします。 ＜環境＞ OS：Linux PostgreSQL Version：7.3.18 PHP Version：4.3.2
Oracleのrow_numberのような関数はないのでしょうか？ Order By句を指定してSELECTした結果の行番号を求めたいのですが、 なにか良い方法はないのでしょうか。 例えば次の表なテーブルがあった場合、 Code1 Code2 Code3 01　　02　　02 01　　02　　01 01　　01　　02 ORDER BY Code1,Code2,Code3 で行った場合の結果が No Code1 Code2 Code3 1　　01　　01　　02 2　　01　　02　　01 3　　01　　02　　02 Noを求めたいのですが。
￥DF で、ストアードプロシジャーの定義を調べられると思いますが、その定義内容を見るには、どうすればよいのでしょう？ ググッて見ましたが、いまいち見つかりませんでした。 お分かりの方、教えてください。
where文で条件を指定して検索したいのですが、たとえば、idが１、２、３０、４０以外を検索するにはどうしたらよいでしょうか？ 初歩的な質問で申し訳ありません。 回答よろしくお願いします。
Windowsにpostgresqlバージョン8をインストールしました。 基本がわかっていないのですが、まずユーザを作成することを始めるのでしょうか？ ユーザーの作成方法がわかりません。
pg_connect を、Linuxへインストールしたいのですが、 どうすればいいのでしょうか？ PostgreSQL とPHPを接続させる為です。 あと、PHPのコンパイル方法もご教示願います。
環境はｘｐ、apache2、php5、Postgresql8.2です。 ただ今PHPとPostgresqlの勉強をしています。 pg_queryで変数の値をINSERT処理を行いたいと 以下のようにしてみましたが うまくいきません。 問題は VALUES('$number','$name')" の部分だと思うのですが 変数はどのように書いたらいいのかが分かりません。 numberはint型 nameはtxst型です ご教示して頂けたら幸いです。 ---------- if($_POST['action'] && $_POST['sign'] == 'kaki') { if($_POST['number'] && $_POST['name']) { pg_query($d_base,"INSERT INTO aas(number,name) VALUES('$number','$name')"); print $_POST['name']; } else { print "書き込めませんでした。"; } }
http://okwave.jp/qa2956072.html 上で同じような質問を過去にしましたが、状況がちょっと違うようでしたので再度質問させてください。 列の型をserialで指定しテーブルを作りました。 入力を省略したところPermission Deniedのエラーが出ました。 前回の質問では権限が異なるIDでINSERTしようとしたのでは？と回答をいただきましたが、状況がちょっと違っていたようです。 $sth = $dbh->do("insert into $table (filepath,filename,filesize,confirmdate,upload,filenumber) values ('$list[$count]->[0]','$list[$count]->[1]','$list[$count]->[2]','$today','$today','12')"); と入力すると12という番号でINSERTできます。 $sth = $dbh->do("insert into $table (filepath,filename,filesize,confirmdate,upload) values ('$list[$count]->[0]','$list[$count]->[1]','$list[$count]->[2]','$today','$today')"); しかし上記のように省略するとエラーが出ます。 本にも省略した場合自動的に番号が割り振られるとありますが、具体的にどう省略したらよいのでしょうか？ よろしくお願いします。
環境はｘｐ、apache2、php5、Postgresql8.2です。 ただ今PHPとPostgresqlの勉強をしています。 PHP5で作成したプログラムでPostgresqlへアクセスするのですが，全く応答がありません。 ブラウザで表示後、ソースを見ると Parse error: syntax error, unexpected T_VARIABLE in C:\Program Files\Apache Group\Apache2\htdocs\sample\aa.php on line 10 というエラーが表示されます。 aa.phpの10行目は $d_base = pg_connect("user=postgres password=0000 dbname=test"); と、データベースに接続しています。 どこがおかしいのか ご教示して頂けたら幸いです。
はじめまして、こんにちは 早速なのですが、質問です。 タイトルのとおり勤務時間外勤務の回数を集計したいのですが、 どのように比較すればよいのかがわかりません。 勤務終了時間を入力しているフィールドが有るので、 sum(case when 勤務終了時間　> 勤務時間外勤務開始時間 then '1' else '0' end) と言った形で書こうと思っていたのですが、勤務終了時間をtimestampにしている為、 勤務時間外勤務開始時間を'18:00:00'と言った形で書くと型が合わないと言われてしまいます。 (timestampは日付まで入力されているので確かにそうなのですが) 副参照で集計する人のテーブルを作り、その際に勤務終了時間の形式を'HH:MM:SS'という形して それをさらに集計と言った方法しかないのでしょうか？ 非常に助長な感じがしますし、他の方法がありそうなのですが、 どのようにすればいいのかが判りません。 宜しければ教えていただけないでしょうか？
お世話になっております。 postgreSQL初心者です。 エクスポートの方法をご教授頂きたいです。 COPYコマンドでCSVをエクスポートしたいのですが ・カラム順を指定出来ないでしょうか？ ・またデータでタイムスタンプが登録されている場合、タイムスタンプ部分を削除してエクスポートする方法はないでしょうか？ 　例）タイムスタンプ付き　2006-10-12 16:50:01+09 　　　タイムスタンプ削除　2006-10-12 16:50:01 ちなみに ・pg_dump -D でINSERT文を抜き出す際もタイムスタンプを削除出来ませんでしょうか？ postgreSQLバージョン:8.03 簡単なことなのかもしれませんが、どうぞよろしくお願いいたします。
HTMLのチェックボックスから、データベースにデータ入力する仕組みを検討しております。 HTMLページでチェックされたものは、keywordカラムに入力されるようにしたいと考えております。 1) HTMLページ <? require('../include/init.inc'); $email = $_POST{'email'}; ?> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=EUC-JP" /> <FORM name="myFORM"> <INPUT type="checkbox" name="name[]" onclick="chg()" value="aaa">：aaa <INPUT type="checkbox" name="name[]" onclick="chg()" value="bbb">：bbb <INPUT type="checkbox" name="name[]" onclick="chg()" value="ccc">：ccc <INPUT type="checkbox" name="name[]" onclick="chg()" value="ddd">：ddd <INPUT type="checkbox" name="name[]" onclick="chg()" value="eee">：eee <INPUT type="checkbox" name="name[]" onclick="chg()" value="fff">：fff </body> </FORM> <form action="Test1.php" method="post"> <input type=submit value='選択'> 　→ ここで配列のデータを変数に入れる処置が必要？ 2) Test1.php <? require('../include/init.inc'); $email = $_POST{'email'}; $name = $_POST{'name'}; var_dump($HTTP_POST_VARS); $sql = "BEGIN; update mailing_list_sentaku set keyword = '$name' where mailing_list_name = '$email'; COMMIT;"; pg_query("$sql"); ?> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=EUC-JP" /> </head> <body> ・データベース 　- postgresql 8.1.9 　- PHP 5.2.1 postgres=# \d mailing_list_sentaku 　・mailing_list_name ： character varying(40) 　・keyword ： character varying(200) 現状は、Test1.phpにもデータが渡っておらず、原因がつかめていない状況です。ご協力よろしくお願いいたします。
はじめまして、tanu_2です。 玄箱HGをDebian化し、いろいろと遊んでいます。 PostgreSQLをapt-getでインストールし、Webアプリを動かしていたのですが、昨日より突然、PostgreSQLが動かなくなってしまいました。 原因が分からず、サーバを再起動し、 # /etc/init.d/postgresql start や $ pg_ctl start などを試してみたのですが、動きません。 念のため、初期化（initdb）も試みたのですが、これも失敗してしまいます。 /var/log/postgresql/postgres/logを覗いてみると、 FATAL: could not write lock file "/var/lib/postgres/data/postmaster.pid": No space となっており、上記ディレクトリにpostmaster.pid書き込みできないよ、と言われているっぽかったので、パーミッションを変更したりして みましたが、postgresql startにしろ、pg_ctl startにしろ、それぞれのコマンドで起動すると、強制的にパーミッションが「700」に変更されてしまうようで、結果は同じでした。 どなたか、解決策をご教示願えませんでしょうか？ よろしくお願いします。m(_ _)m
EVENT --+------------+------------+ id | start_date | end_date --+------------+------------+ 0 | 2007-06-01 | 2007-06-03 | --+------------+------------+ 1 | 2007-06-04 | 2007-04-06 | --+------------+------------+ 2 | 2007-06-02 | 2007-06-05 | ↑こんな感じでイベントを管理するテーブルがあります。 イベントの開催期間の重複を出力するSQL文を書きたいのですが、 何かいい案はありませんでしょうか？？？ 結果的には重複し合っているレコードのidを出力させたいです。 よろしくお願いします。
以下のようなテーブルがあります。 hiduke | syuusi | tekiyou | kingaku | bikou 2007-5-8 | 収入 | 給料 | 48000 | バイト代 （以下数十件続く） このテーブルから、次のようにして収入と支出の５月分の合計を求めました。 select syuusi,sum(kingaku) from suitoh_table where hiduke like '2007-5-%' group by syuusi; syuusi | sum 収入 | 61000 支出 | 15080 するとこのように表示されるのですが、ここからさらに「収入－支出」と計算するにはどうすればいいのでしょうか？ 最初のselect文の段階で、収入－支出の計算までさせたいのですが・・・。
CentOS5にpostgreSQL8.3をtarからインストールしようとしているのですが、"./configure --enable-multibyte=EUC_JP"とすると "configure: error: readline library not found"となるので、 readlineを # ./configure # make # make install # ldconfig としたのですが、再び同じエラーとなります。 ld.so.confにも"/usr/local/lib"と加えてあらためてldconfigとしてもダメでした… readlineインストール時に "install: you may need to run ldconfig"と出るのでreadlineはちゃんとインストールできていると思っているのですが、無理やり"./configure --enable-multibyte=EUC_JP --without-readline"として通してもやっぱり納得がいきません・・・ いったいまず何を見たらいいのでしょうか？
ほとんどMySQLしか使った事がなく、PostgreSQLのデータタイプに不明なものが多いです。 参考書も持っているのですが、それらの説明がありません。 PostgreSQLのデータタイプについて説明があるサイトなどありませんでしょうか？ 自分で探してもいいサイトが見つかりません・・・。
社内LAN上で、ODBCを使ってAccess2000でデータの参照、更新を当たり前のようにしていますが、インターネットを経由した遠方のサーバ上にあるpostgreSQLに対しても接続可能なのでしょうか？先ほどリンクを張ろうと試してみたらODBCエラーが表示されました。サーバでpg_hba.confの設定を変更するのでしょうか？ODBCドライバのバージョンは、7.01.00になります。 postgreSQLのバージョンは7.4.2で、OSはRHL9です。 よろしくお願いします。
現在PostgreSQLとPHP5を利用してアプリケーションを開発しております。 PHPにて現在すでに存在するPostgreSQLのテーブルの定義情報を取得するにはどうすればよろしいでしょうか。テーブルの定義情報は下記のようにSQLのCREATE文で取得したいと思っております。 CREATE TABLE favorite ( code serial NOT NULL, reg_date timestamp without time zone NOT NULL DEFAULT now(), update_date timestamp without time zone, title text, url text, u_id character varying(20) NOT NULL, enabled_flag smallint NOT NULL DEFAULT 1, CONSTRAINT web_favorite_pkey PRIMARY KEY (fv_code) ) 何卒よろしくお願いいたします。
ASP＋PostgreSQLで検索画面を作成しています。 テーブルに名前、生年月日しかなく年齢をSQLの中で計算しています。 こんな感じです↓ To_Char(age(current_timestamp, To_date(birthday,'YYYYMMDD')),'yy') As genzai_age 「genzai_age」をwhere句で使用したいのですがas句なので利用できません。 「genzai_age」を検索条件にする何か良い方法はないでしょうか？ ご存知の方がいらっしゃいましたら、ご教授願ください。よろしくお願いします。
PostgreSQLで複数の条件での絞り込み検索をしたいのです。 テーブルには 発売日、商品名、入荷日 があります。 例えば 発売日が2007年5月1日から5月5日で、商品名に「○○」もしくは「××」もしくは「△△」が含まれており、入荷日が一番新しいもの という条件で検索したいのです。 発売日だけの絞込みならBetweenですし、商品名だけならor、入荷日の最新だったらmaxを使えば個別には検索できるのですが、これをまとめて一行でやるにはどうしたらよいのかわかりません。 それぞれでandでつなげてみましたが、orの条件がうまく反映されず、一個目の○○だけが検索に引っかかってる状態です。 ××や△△もひっかかるようにするにはどう記述したらよいのでしょうか。
掲題のコマンドですが、7.2以降では 【VACUUM】 ・データ削除(DELETE済み)領域を再使用可能に。 【VACUUM FULL】 ・削除領域を開放しディスクサイズを小さく。7.1までのVACUUMと同等。 となっていることは理解できたのですが、7.2以降のバージョンでは 例えば毎日VACUUM FULLを行っていると仮定した場合、別途VACUUMを行う必要はありませんよね？ # 7.1以前ではVACUUMしかなかったわけだし…。 ご教授よろしくお願いいたします。
はじめまして。php5とpostgresを使って、ブラウザで都道府県をセレクトで複数選択（prefecture[]）して、postgresに select city from city_table where p_id='prefecture'; としているのですが、結果を出力できません。 print_rで見たところprefectureに複数選択した都道府県のidが配列として入っていることは確認しております。 where句に配列を入れて検索するにはどうすれば良いのでしょうか？ よろしくお願いいたします。
よろしくお願いします PostgreSQL 8.0.8です 現在 code date 1　　　　2007-04-02 12:52:22.239818+09 1　　　　2007-03-02 12:52:50.90313+09 2　　　　2007-04-02 13:08:35.093001+09 2　　　　2007-04-02 13:11:08.532232+09 というデータがあるとし これをcodeでグループ化して、codeが何件あるかを調べたいです ただし、dateが本日から30日以上前の場合は省くという条件をつけたいのですがエラーがでてうまくいきません SELECT code,COUNT(code) AS cnt FROM test GROUP BY code HAVING date(date) >= '30前の日付' どう書いたらうまくいくのでしょうか？ よろしくお願いします。
昨日こちらで自分の間違ったSQL文をご指摘頂き 時間計算の処理は実装する事が出来たのですが その後の計算処理が終わった後、計算結果をDBに格納する処理で 再度躓いてしまったので、再度のご教授お願いします。 $sql = "SELECT SUM(ROUND(労働時間/100, 0)) + ROUND(SUM(MOD(労働時間,100)) / 60, 2) AS total 　　　　FROM 労働時間テーブル WHERE id = 'ログインしている人のID';"; $total_Time = pg_query($con, $sql); $total_Time = pg_fetch_result($total_Time, 0, 'total'); // 確認のため、表示 echo $total_Time; で値はきちんと表示されおります。 しかし、この後UPDATE文で $sql = "UPDATE 労働時間テーブル SET 総労働時間 = '$total_Time' WHERE id = 'ログインしている人のID';"; pg_query($con, $sql); と打ち試しましたが、echoの時に表示された値がDBに格納されません。(>_<) 試しに $sql = "UPDATE 労働時間テーブル SET 総労働時間 = '$total_Time' WHERE id = 'ログインしている人のID';"; の'$total_Time'をSELECT文に変更したりもしましたが、echoの時に 表示されていた値とは違う値がDBに格納されるようになってしまいました。 どのように解決したらよいか、悩んでおります。 そもそもの考え方から間違っているのでしょうか？ ご教授の程、よろしくお願い致します。
こんにちは。 時刻関係の事でお聞きしたいことがあります。 SELECT ROUND(ROUND(SUM(労働時間)/100, 0) + MOD(ROUND(SUM(労働時間)/10, 2), ROUND(SUM(労働時間)/100,0))/ 6, 2) AS total FROM テーブル WHERE id = 対象者のID; とSQLを書き [15=0.25] [30=0.5] [45=0.75] と一つずつであれば、下記のように取得する事が取得する事が出来ました。 しかし労働時間テーブルに 1015 1045 と値がある場合、本来であれば[11.00]で表示されるはずが [23.83]という数字で表示されてしまいました。 解決方法が見出せない為、どうかお力・知恵をお貸し下さい。 よろしくお願いします。
現在、Postgresを使って簡単なシステムを作っていますがどうしても わからないので質問させていただきます。 四つのてーぶるがあります。 　(1)名簿 　　　名前　|　部門 　　　aaa　　　1 　　　bbb　　　1 　　　ccc　　　2 　(2)部門表 　　　部門　|　部門名 　　　　1　　　第１営業 　　　　2　　　第２営業 　(3)商品表 　　　商品id　| 商品名 　　　　1　　　　りんご 　　　　2　　　　ババナ 　(4)売上 　　　No | 名前 | 商品id | 日付 　　　1　　aaa　　　1　　　2007/04/07 　　　2　　ccc　　　1　　　2007/04/07 　　　3　　aaa　　　1　　　2007/04/08 このようなとき以下の表を一度に作れますか。 第１営業でりんごを売ったかどうか、売った場合は最新日付を表示 したいのです。 具体的には 　　名前　| 日付 　　aaa　　　2007/04/08 　　bbb のようにです よろしくお願いいたします
言葉で表現するよりも、サンプルのSQL文で分析してもらう 方が理解しやすいと思いますので、そのやり方で進めさせて もらいます。 実際にやりたいことは、 select * from example1 where (key1, key2) in (select key1, key2 from example2); の値リスト版になります。 もちろん、上記のselect文での副問合せでは正常に結果は得られます。 実際にやってダメだった例は select * from example1 where (key1, key2) in ((値A-1, 値A-2), (値B-1, 値B-2), (値C-1, 値C-1)); のようなパターンになります。 単にカッコで括ったリストにすればいいというものではないと判断できる のですが、複数列の副問い合わせ文の値リストはどう表現すればよいのでしょうか？ プログラムを作る際、key1とkey2の連結されたものの集合で それを実現する必要があるのですが、困り果てて、以下のように key1とkey2を連結してから問い合わせさせるようにして、その場を しのいでおります。連結されたものを再度key1とkey2に分割して 目的の副問い合わせをさせるのが狙いです。 select * from example1 where (key1 || key2) in (値1, 値2, 値3); これでも十分結果は得られるのですが、key1、key2にせっかくインデックス を作っていても連結しての問い合わせはその効果は得られず、結果を得る までの所要時間が相当かかってしまうのが欠点です。できるだけ高速に 検索できるようにしたいのが今回の狙いなのですが、今回の件の記述方法 についてのアドバイスをお願いします。
LinuxにPostgresqlをインストールしたのですが、クラスパスがなかなか設定できません。 実行時に -classpathで渡してやる方法は成功したのですが、bash_profileで前もって登録しておく方法がうまくいきません。 そこで気になったのですが、ppstgresqlのインストール先は、root権限下では いけないのでしょうか。 参考書やネットを調べていますと、『rootにはインストールするな』というのもあれば、『rootでインストールしろ』などとあり、情報が交錯しています。 どちらにすればよいのか、そして、どのようにbash_profile修正するのかを 教えてください。 よろしくお願いいたします。
MovableTypeでブログを作成しようとしています。 レンタルサーバーのデータベースがPostgreSQLなのですが、DBD::Pgのダウンロードの方法だけがどうしてもわかりません。 いろいろ検索してみても、ＤＬページがリンク切れになっていることも多いです・・。 どなたか、ＤＬ方法を教えていただけないでしょうか？ かなり急いでいます。 ウインドウズXP、FFFTPを使ってのアップロードで、サーバーはBROAD SERVERを使用しています。
　お世話になります。 　今まで主キーの発行はシーケンスを使っていましたが、 シーケンスだと飛び番が発生するので、それ以外の方法を探しています。 　データ追加時に(select max(主キー) + 1)で発行した所、複数人数で使用するDBの為 稀にタイミングによっては同じ番号を拾ってきてしまい、「主キーが重複しています」のエラーが出てしまいます。 　 　主キーを安全に発行するのに、みなさん、どのような方法でされているのでしょうか？ 　googleで検索をしてみましたが、意外と見つからないです。 　どなたかご教示いただけると助かります。
SQL ServerのLong型は８バイト？のようですが、PostgreSQLに相当の型は存在しているのでしょうか？3年前からPostgreSQL-->MySQLに以降して、PostgreSQLのことはすっかり忘れてしまいました。 MySQLは現在Ver5ですが、８バイトのような型は無いみたいです。WindowsにインストールしやすかったのでMySQLに移ったのですが、８バイトの型が使いたく、しかもWindowsで簡単にインストールできる状況になったのかも知りたいです。
Linuxサーバーで、PostgreSQLを使用したいのですが、 新しいデータベースを追加する際に、 文字エンコードがデフォルトでは「SQL_ASCII」になっているのを「EUC-JP」に変更したいのですが、どうすればいいのでしょうか？ ちなみに、Pleskコントロールパネルは使えます。
javaで登録処理を行ないますが、以下のようなことは 可能なのでしょうか？ 環境 DB postgress java1.4.2 やりたいこと TBL-A のキーは1から連番の項目Aです。 最大のAを取得し+1した値で登録します。 2人以上が同時に実行した場合二重登録違反が発生する 可能性がありますので二重登録違反が発生すれば再度 最大のAを取得して登録をやり直したい。 この処理がその他のことで長い時間が掛かりますので 排他をかけたくないと思っています。 ご存知であればご教授お願い致します。 （出来るか出来ないかだけでも教えてください）
SQLで商品名と単価が入ってるテーブルで単価が1000円～1200円で商品名が5文字以上のものを取り出したいのですが教えてください
デフォルトのEUCでインストールしていますが、 これをシフトJISで再構築したいと思っています。 configureのオプションで指定して再インストールするのか、 インストール後の設定ファイルを使って再構築するのか、 再構築の際はinitdbを再度する必要があるのか注意点があれば 教えて下さい。 シフトJISでデータベースを管理したいと思っている のですが、アドバイスを頂けると助かります。 お客様の要望でシフトJISで印刷するようなケースがあり、 EUCコードにこだわっているだけでは解決できないので、 困っているところです。よろしくお願いします。 プログラム環境の方ですが、PHPの設定ファイルは調査した ので、大丈夫だと思います。 使っている環境ですが、 RHL9、postgreSQL7.4.2、PHP4.3.8 になります。
PostgreSQL8.1.1（RedHatLinux）にて テーブルのtext列に対してindexを作成しました。 作成した列に対して、LIKE検索を行っております。 しかし、「EXPLAIN」を利用してSQLの実行計画を見たんですが、 「Seq Scan」からしか始まらず、 「Index Scan」という文字が見当たりません。 PostgreSQLにてindexを張った列に対するLIKE検索では、 indexは使用されないのでしょうか？
ファイヤーウォールのログをみていたらルータ側のポート５４３２から自分のPCへアクセスが何回かあり、５４３２について調べてみると PostgreSQLで使用するポートのようですが、簡単にいうと PostgreSQLとは何でしょうか？（インターネットで調べてみましたが今ひとつよくわかりません） サーバとか立ち上げていなくて普通にサイトを閲覧するだけでも関係するものなのでしょうか？ 07/02/192.168.0.1192.168.0.2TCP543249159AF
仕事で必要になりSQLの勉強をしています。 教本にある簡単なリレーショナルDBをSQLの文章で操作して勉強したいのですが、実行環境がなくて困っています。 大学でポスグレに触れたのでポスグレでやりたいのですが… ポスグレの設定がよくわかりません。 ポスグレでなくても良いのでSQL簡単に試して学習する方法があれば教えていただきたいです。
SQL初心者です。 アドバイスよろしくお願いします。 テーブル create table 時間テーブル ( id_cd text, makeday timestamp); 時間テーブルの　makeday　と現在の日付を比較して一週間以内ならば「1」,そうでなければ「0」を返すSQLを書きたいのですがどうすればよいでしょうか・・ 参考になるURLなどなんでもよいのでアドバイスよろしくお願いします。
postgresでvacuumdbを行うと途中でとまってしまいます 何か対応策があればご教授いただけないでしょうか？ 2.6GあるDBをvucuumかけると、途中で止まってしまっているようなのです お返事いただけましたら幸いです
日本PostgreSQLユーザ会で使われているかめ http://www.postgresql.jp/images/topmini.png これのライセンスをご存知の方教えてください。 GPL同様に営利・非営利を問わず許諾なしで使ってもよいのでしょうか？
主キーに自動インクリメント（ nextval ）を使用しているテーブルで、 そこにレコードを登録したときにそのとき使われた主キー を取得する方法はありますでしょうか。 例えば 主キー｜データ １｜ＡＡＡ ２｜ＢＢＢ ３｜ＣＣＣ にＤＤＤと登録したら恐らくは４になるのですが、 主キー｜データ １｜ＡＡＡ ２｜ＢＢＢ ３｜ＣＣＣ ４｜ＤＤＤ ←追加された データを登録したときにその主キーに何が使われたかが知りたいです が知りたいです。 自分で考えてる方法は今の主キーで使ってるシーケンス＋１が割り当てられる（だろう）というやり方なのですが、複数のレコード登録が同時にあった場合に不整合が起きるのでどうしたものかと困ってます。 なにか良い方法をご存知の方いらっしゃいましたらお教えください。
PostgreSQL には、SQL Server のような管理画面はないのでしょうか？
データベース、またはPostgresql本体の CLIENT_ENCODING のデフォルトを設定するにはどうしたらよいでしょうか。 ご存知の方いらっしゃいましたら教えてください。 【現状】 Linux機にインストールしたPostgresqlのCLIENT_ENCODINGをSJISにしたいのですが、DBにconnectする毎に SET CLIENT_ENCODING 'SJIS'; することで対処していますが、出来ればソフト側ではなくDB側の設定で対処したいと考えています。 ■ デフォルト設定のWindowsとLinuxの差異 Windows： 　サーバ：euc 　CLIENT_ENCODING：sjis ※ Linux[centos4]： 　サーバ：euc 　CLIENT_ENCODING：euc ※ Windowsと同じ設定になるようにしたいです。 　 またはCREATEDBのオプションとかでそういうのがあると良いのですが。 PostgreSQLのversion：8.1.5
商品（商品番号、商品名、定価）というリレーションがあるときに、 定価が１０万円以上の商品の全データを求め、定価の安いものから高いもの順に並べよ。という問題で、ORDER BY とWHEREをどう使うのかわからないので教えてください。
PostgreSQL 7.4.8 php4.4.4 で開発をしています。 あるログデータを集計したいのですが、 日付の処理が上手くいかずに困っています。 DB側には 日付 | ID 2007-01-01 10 2007-01-01 10 2007-01-01 10 2007-01-01 10 2007-01-01 20 2007-01-01 20 2007-01-01 20 2007-01-10 10 2007-01-10 10 2007-01-10 15 というログデータを日付毎にIDをカウントして 一月単位で日付毎の件数を取得しようとしています。 日付をtruncする事で一月分のデータは取得出来るのですが、 IDが一件も無い日付も「0」で表示したいのです。 php側で吸収する手段も有ると思うのですが 保守性を考えるとデータの取得はsqlで何とかしたいのです。 ご教授頂ければ幸いです。 よろしくお願い致します。
テーブルを作成するにあたりどこまでインデックスを設定していいのかが解りません…。 たとえばID,DATE,NAME,COMMENT,ADDRESSでテーブルを作成したとしてIDをプリマリーとします。 そして目的としては全ての項目で検索する可能性があるとします。 その場合どれをインデックスに設定するのがベストなのでしょうか？ 全部（IDはプリマリーななので必要なし？）の場合はINDEXを設定する必要もないのでしょうか？ むしろしない方がいいのでしょうか？ また、NAMEだけは検索する事は無いといった場合はどうなるのでしょうか？ その場合も過半数以上設定する場合はかえって遅くなるかもしれないし必要ないとかあるんでしょうか？ また、
今、WindowsXPでPHPとPostgreSQLを連携 させたいのですがなかなか上手く行きません。 どなたか、分かる方がいれば宜しくお願いします。 環境 ＯＳ→Windows　HomeEdition Apache→Apache HTTP Serber2.0.59 PHP→PHP4.4.4 PostgreSQL→PostgreSQL8.1.4 です。 PostgreSQLの中にtest_dbというデータベースをつくり setuzoku.phpから接続できるかどうかのif文を作り確認 していますが、何度やっても接続失敗と出ます。 <?php $con = pg_connect("user='postgres' dbname='test_db' password='grjtf'"); if (! $con) { print "接続失敗"; } else { print "接続成功"; } ?>
postgreSQLやaccessが初心者な私ですが、 既存のデータベース(postgreSQL)をaccess2003でデータベース内を検索させたいと思っています。 accessとposgreSQLを繋げるにはODBCが必要ということでWindowsXP側には入れたのですが、postgreSQL側にODBCが入っていないようでaccess2003と通信することが出来ません。 前からあるデータベースなのでインストールを行った人がpostgreSQLインストール時にODBCをインストールしないようにしたのかもしれません そこで質問なのですが、ODBCが入っていない状態でpostgreSQLにODBCだけを入れることは可能なのでしょうか？できたらその方法や方法が書かれているページを教えて頂けますでしょうか？お願いします。
CREATE INDEX　は使い方によっては早くも遅くもなると書いてあったのですが、一般的にはCREATE INDEXはどういう時に使うのでしょうか？
テーブルがふたつあります。 片方のテーブルA(hoge1)のnameに、もう片方のB(hoge2)のnameをいれたいのです。 テーブルAとBはidでリレーションを張って、それぞれ対応する列にいれたいと思ってます。 tabale A hoge1 id | name | foo ----+-----+---- 1 | 1111 | xxxx 2 | 2222 | yyy 3 | 3333 | zzzz tabale B hoge2 id | name | bar ----+-----+--- 1 | 1.net | 1 2 | 2.net | 0 3 | 3.net | 1 期待する結果 tabale A hoge1 id | name | foo ----+-----+---- 1 | 1.net | xxxx 2 | 2.net | yyy 3 | 3.net | zzzz Bに変更はなし update hoge1 set name = b.name from hoge2 b , hoge1 a where a.id = b.id ; とやるとname列が全て 1.netになってしまい UPDATE hoge1 SET name = (select b.name from hoge2 b , hoge1 a where b.id = a.id ) ; ERROR: More than one tuple returned by a subselect used as an expression. とするとエラーです。（oracleならうまくいくとnetで調べたのですが。。） どなたかご教授いただけますか。
PHP 4.4.2 + PostgreSQL 7.4.8 です。 今、フィールド「DATE」、データ型「timestamp with time zone」に 　2006-12-14 09:00:28.853324+09 　というデータが入っています。 このデータをウェブ上で ○月○日○時○分 という形式で表示させたいのですが、どのようにすればよいでしょうか？ よろしくお願いします。
現在、PostgreSQLを使用してWebアプリケーションを作成しています。 いくつか、テーブルがある中で、一つのテーブルが使用している容量をしるSQLコマンドってあるのでしょうか。 SQLコマンドでなくてもかまいませんので、使用量が分かる方法を教えて頂けないでしょか。 よろしくお願いします。
　初めて、投稿させて頂きます。 postgreSQLのデータバックアップを自動で行おうとクーロンに登録し実行しました。ダンプファイルは出来るのですが、何故か中身が空です。 何か特別な設定等が、他にあるのでしょうか？ O/S : LinuxES4 postgreSQL: 7.4.7 ご教授宜しくお願い致します。
ある人に、こんなSQLを教えてもらいました。 ----------------------------- select id,tid,NULL as "res_no",account_id,name,date from t_game_bbs as a union select id,tid,res_no,account_id,name,date from t_game_res as b where del_flg != 1'; order by date DESC limit 10; -------------------------------- 不思議に思ったのが、”NULL as "res_no"”のところです。 これについて、ググッて見たのですが、明確な説明が見つかりませんでした。 これって、SQLの隠し機能なのですか？
学校で、DBの勉強をしています。自宅でもDBの勉強が出来る環境を用意したいです。 学校では、サーバーを設けて、サーバーにアクセスしてDBを利用する環境ですが、そうでなく、自分のパソコンにpostgreとCSEとデータを置いて、DBを使う環境で利用したいです。 OSはWINDOWS　XPです。使用するDBMSは、postgreSQLで、CSEを利用し、データとして、 ttp://www.c-r.com/から提供されているのを使います。 ネットのページを参照して、postgreSQLのインストールは出来ました。 次に、CSEの設定を行いたいのですが、サーバー名とデータベースの欄に何を入力すればよいのか わかりません。 サーバー名には、IPアドレスを入力すれば良いのでしょうか？ ただ、ネットには無線LANで接続しており、IPアドレスはDHCP機能でその都度割り振られており、固定のIPアドレスはありません。 検索していて、localhostと入力するとあったので、これも試しましたがエラーが出ます。 　データベース接続時にエラーが発生しました。 　DBエラー詳細： 　fe_sendauth:authentication type 5 not supported データベース名には　 ttp://www.c-r.com/＞データ舘＞データベースソフトの一番上にある「仕事力～」のPostgreSQL のデータを使いたいです。そのためには、ダウンロードしたこのデータのファイル名を入力すれば良いのでしょうか。ただ、ファイル名が日本語です。 こちらもエラーが出ます。 　データベース接続時にエラーが発生しました。 　DBエラー詳細： 　connectDB()--socket() failed:errno=0 　NO error 解決する知識をお持ちの方、どうかご教授ください。宜しくお願いします。
質問お願い致します。 RedHatとPostgreを使用していて 現在8GBデータが入っているDBがあるのですが 『VACUUM FULLをするタイミング(しきい値)を教えてください』 とお客様から質問が来たのですが自分なりに調べてみまして ・データが増えすぎたら ・データの削除や更新が頻繁に行われたら と答えたのですが納得していただけず、 メンテナンスをする為に かなり正確な使用する間隔期間を知りたいらしく、 どういった数値を元にして どれくらいの期間ごとにVACUUM FULLを使用すればいいのか 教えていただけないでしょうか。 何卒よろしくお願い致します。
以下３つのSQLを実行した場合に検算が 合わないのですがどのように解釈して いいのでしょうか。 (1)の件数＋(2)の件数 ＝ (3)の件数になると 考えては駄目ですか？ (1) select count(A.*) from tbl_a A,tbl_b B where A.komoku1 = B.komoku1 and A.komoku2 = B.komoku2 and A.komoku3 = B.komoku3 (2) select count(A.*) from tbl_a A,tbl_b B where A.komoku1 = B.komoku1 and A.komoku2 = B.komoku2 and A.komoku3 <> B.komoku3 (3) select count(A.*) from tbl_a A,tbl_b B where A.komoku1 = B.komoku1 and A.komoku2 = B.komoku2
PHP初心者ですみません。PHP、PSQLでDBにアップロードされた画像データ（バイナリデータ）をWEB上で例<img src=image.php>画像表示したいのですが、画像が×表示になってしまいます。格納時にデータが間違っているのか？それとも表示方法が間違っているのかわかりません。どなたか助けてください。 【アップファイル格納時スクリプト】 //fopenして変数に保存 $fp = fopen($_FILES["upfile"]["tmp_name"],"r"); $imagedata = fread($fp,filesize($_FILES["upfile"]["tmp_name"])); fclose($fp); //バイナリデータをエスケープ $imagedata = pg_escape_bytea($imagedata); $filename = $_FILES["upfile"]["name"]; $sql_g = "update img set img_data='$imagedata'"; $conn_g = connect(); $result_g = pg_query($conn_g,$sql_g); pg_close($conn_g); } 【画像表示用ファイルスクリプトimage.php】 $sql_i = "select img_data from img"; $conn_i = connect(); $res_i = pg_query($conn_i,$sql_i); $num_i = pg_num_rows($res_i); $img_data = pg_fetch_result($res_i,0,"img_data"); header('Content-type: image/gif'); header('Content-Disposition: inline; filename=' . $img_data); print"${img_data}"; 【画像表示部分スクリプト】 <img src="http://●●●●/●●/image.php" alt="イメージ" width="500" height="100"> こんな感じなのですが、どこがどう違うのか何度も試してやっとここまできたのですが、答えがでません。お解りの方いらっしゃいましたらご指摘をどうかよろしくお願いいたします。
今、ＳＥＬＥＣＴ文で取得した値をround()を使って四捨五入したいのですが、構文エラーになります。 SELECT ROUND( SELECT 0.2*(SLECT number FROM sample WHERE id =1) ); ROUND()内のSELECT 0.2*(SLECT number FROM sample WHERE id =1) で、値が12,6のように返ってきます。 しかし、round()で四捨五入して１３を取得しようとすると構文エラーになります。 どうしたらいいのでしょうか？ よろしくお願い致します。
PostgreSQLのバックアップについて質問です。 24時間稼動しているPostgreSQLのバックアップを1日1度pg_dumpコマンドでとって、復旧時に使用しておりますが、完全に復元する方法がわかりません。 例えば1日の途中にデータが破損した場合、前日までのデータは pg_dumpで復旧できますが、その後のデータが破損する直前までを WALを使ってどのように復旧させるのでしょうか。 /usr/local/pgsql/data/pg_xlog/の直下に"000000070000006D"という名前のファイルはあるのですが、そのログを使ってRedoするやり方がわかりません。 更にトランザクションログのチェックポイントを1時間に1回と設定したりしてログ日付・時間の名称で保存の後次の日には新しい名称で ログをとりたいのですが、そのようなことはできるのでしょうか。
postgreSQL 8.1.3 を使用しています。 database 内に作成した全テーブルの列数を調査しています。 全テーブルに対して select count(*) を発行する方法でも良いのですが、 テーブル数がいっぱいある際に、とても調査が面倒になってしまいます。 そこで、なんらかのSQLで各テーブルの列数を一気に返す方法はないかと考えていますが、 そんな方法って無いですか？
かなり困っています。REDHAT LINUXでpostgresのテーブルにpsqlからのCOPYコマンドでcsvファイルのデータをインポートしようとしているのですが、文字数オーバーのエラーがでてしまいます。テーブルは２列で１つ目の列はCHAR(10)で２列目はINT4型です。csvファイルの内容はとりあえず１行だけ入れていて「"1234567890","1234"」を入れています。コマンドはpsqlで「COPY テーブル FROM 'ファイルのパス' USING DELIMITER ","」で行いました。エラーはおそらくインポートしたデータがおかしくなって変な桁数になっているのですが、どういうふうにおかしくなっているのかがよくわからないので対策できません。
現在fedoracore5を導入し、postgre8.1の初期設定を行っております。 インターネットの説明にはpostgresql.confに『tcpip_socket = true』の設定を追加すると記載さてれております。 しかし、そのような記載を行わなくても別端末からssh接続で操作することが可能でした。 V8.1からpostgresql.confファイルの編集はしなくてよい事になったのでしょうか？また、fedoracore5の導入時に入っているpostgreSQLのデフォルトバージョンはいくつなのでしょうか？ 今回はFedoraCoreからyum installで導入したのですが、これは最新のモジュールをダウンロードし、インストールしているという認識でよいのでしょうか？ 質問ばかりとなてしまい大変申しわけないですが、どなたかご回答をお願いいたします。
PostgreSQL環境でのSQL文です。 テーブル[A_TABLE]のDate型の項目[mDate]をキーにして、古いものから30件を削除したいのですが、 このようなSQL文は有効でしょうか？ DELETE FROM A_TABLE WHERE RowNum <= 30 ORDER BY mDate 現在手元に試してみる環境が無いため困っています。 よろしくお願いします。
postgresql-8.1.2-1-jaのインストール中で手続き言語の有効化で「データベースの接続に失敗しました。手続き言語ファイルは活動的にされません。」とのメッセージが出て、イントールは完了しましたが、pglqlには接続できません。 ユーザー名のpostgresを削除して、最新のpostgresql-8.1.4-1-jaで再度インストールしましたが、同じ結果です。ウイルスソフトは終了させています。 考えられる原因を教えてください。 環境はwindowsXP SP2 Profetional マカフィインターネットセキュリティです。
初めまして、最近SQLをかじり始めたぺーぺーです。 効率の悪いSELECT文しか書けずに困っています。 下記のテーブルsoftware_tableから、 ・name列「oracle」 ・version値が最大 のレコードに含まれるid(=3)を拾ってきたいのですが、自分の頭では副問い合わせを使う方法か、ソートを使う方法しか思いつきません。 問題は副問い合わせ・ソートを使うと計算コストが大きくなってしまうことで、できることなら副問い合わせ・ソートを使わずに解決したいのですが、何か方法はないものでしょうか？ よろしくお願い致します。 ----------------------------- software_table idnameversion 1oracle1 2oracle2 3oracle3 4postgres1 5postgres2 6postgres3 7postgres4 ----------------------------- ■副問い合わせを使った方法 SELECT id FROM software_table WHERE name = 'oracle' AND version = (SELECT max(version) FROM software_table WHERE name = 'oracle'); ■ソートを使った例 SELECT id FROM software_table WHERE name = 'oracle' ORDER BY version DESC LIMIT 1 OFFSET 0; -----------------------------
PostgreSQLの配列に対して、要素の追加及び削除を行いたいのですが、下記のような動作をさせるには、※1と※2で、どのようなSQLを実行すれば良いでしょうか？ よろしくお願いいたします。 >>> CREATE TABLE test ( id integer, data integer[] ); INSERT INTO test VALUES (1, '{0,1,2,3,4}'); INSERT INTO test VALUES (2, '{5,6,7,8,9}'); SELECT * FROM test; id | data ----+------------- 1 | {0,1,2,3,4} 2 | {5,6,7,8,9} (2 rows) UPDATE test [data配列に10を追加] WHERE id = 1; /* ※1 */ UPDATE test [data配列から6を除去] WHERE id = 2; /* ※2 */ SELECT * FROM test; id | data ----+------------- 1 | {0,1,2,3,4,10} 2 | {5,7,8,9} (2 rows) <<<
CGIとSQLで掲示板を作っているのですが、EUCでデータベースに日本語が入ったのですが表示する際に文字化けしてしまうのですが文字化けしない方法はありますでしょうか？
FedoraCore4にPostgresql7.4.6をソースからコンパイルしてインストールしました。 学習書に、 PHPインストール時に　configureオプション　 --with-config-file-scan-dir-DIR　で指定したディレクトリにpgsql.ini をおく、と書いてあるのですが、私の場合、yumでPHP5.04 をインストールしています。 /usr/local/pgsql/の下に、bin,doc,include,lib,man,shareの各サブディレクトリはあります。 /etc/php.d　ディレクトリはありますが、中は空です。pgsql.ini ファイルを見つけることが出来ません。 １．pgsql.ini　ファイルは何所にあるのでしょうか？ ２．新規に作成する必要があるのでしょうか？ ググリましたが、適当な資料を探し得ませんでした。 pgsql.ini　の編集と置き場について、良い参考資料を教えて頂ければ大変有難いです。
pgpoolでのレプリケーションで質問があります。 現在、pgpool.confで以下の設定をしているのですが、検索でレプリケーションされず、片方しか参照しに行ってくれません。 # Replication mode #replication_mode = false replication_mode = true 機器構成は、 　　　　　　　+---- DB1 pgpool　---+ 　　　　　　　+---- DB2 としています。 それぞれ、独立したサーバーで組んでいます。 どうしても、DB1しか参照して内容に見えます。 pgpoolのバージョンは、 $ pgpool -h pgpool version 3.0.2(kamanu), です。 よろしくお願いします。
いつもお世話になっています。 現在システムを構築中で、テーブル自体は既に出来ています。 これを資料としてまとめるために、Excelでテーブル定義書を作成しよう かと考えております。 ここで質問なのですが、既に構築済みのテーブルから、 自動的にテーブル定義書を作成するツールは有りませんでしょうか？ 下記のＵＲＬを参照したところ http://ml.postgresql.jp/pipermail/pgsql-jp/2002-May/009472.html CSEというソフトが有力なようですが、既に更新がされていないようで 現在のPostgreSQLのバージョンとは合わないようです。 E-R図はvisio等のツールでも作成できますが、テーブル定義書を自動的に 作成してくれるツールは以外に見当たらないようで、ちょっと困っています。 PostgreSQLのバージョンは　7.4.7　もしくは　8.1.3です。 よければご教示頂ければ幸いです。
テーブルが２つありまして、既存テーブルには 担当者コードが入っておらず（フィールドはあります）、その担当者コードフィールドへ既存テーブルの時刻からそれに合った担当者コードを担当者テーブルからを参照し登録する作業を行いたいのですが、１つのSQL文で可能なのでしょうか？ 既存テーブル ID,InDate(時刻),UserCode(担当者コード) 1,2006-09-01 10:20:30,'' 2.2006-09-02 12:10:50,'' 担当者テーブル UserCode,UserName,StartTime,EndTime 111,ABC,2006-09-01 09:00:00,2006-09-01 13:30:00 222,DEF,2006-09-02 09:00:00,2006-09-01 13:30:00 の様なデータが合った場合 既存テーブルのID1のUserCodeへ111 既存テーブルのID2のUserCodeへ222 と入れるようなSQLを作成したいのです。 update 既存テーブル set usercode = (select b.usercode from 既存テーブル as a,担当者テーブル as b where a.InDate > b.starttime and a.InDate < b.endtime); と作成はしてみたものの ERROR: more than one row returned by a subquery used as an expression とエラー表示されます。 複数のレコードがあるからエラー？ってことなのでしょうか。 ver:PostgreSQL 8.1 どのようにすると、可能になるか教えてほしいのですが、どうぞよろしくお願いします。（説明がうまく出来ず申し訳ありません…）
LinuxでPostgreSQLが起動しなくなる、 postmaster.pid　ファイルが作成される原因には、 何がありますか？ いくつもあるのでしょうか？
はじめまして、質問をさせていただきます。 ２週間前からコストダウンのため、Windowsサーバであった 支店ＤＢをLinux+Postgresqlに変更しています。 本社ＤＢ（Windows＋oracle）とほかの支店ＤＢ（Linux+Postgresql） とのデータのやり取りをするのに何か良い方法はありませんか？ 今のところ、ＪＤＢＣを利用する方法を検討しています。 なにぶん初心者なので、ご迷惑をおかけしますがよろしくお願いします。 以上
PostgreSQL8.1.4を利用しています。 1日約2万件のINSERTを行うデータベース の保守を行う予定です。 PostgreSQLの保守にvacuumは欠かせないというのが 通説だとは思うのですが データベースへの操作はINSERTとSELECTだけなため VACUUMは要らないのでは？と思っています。 (少なくとも頻繁には必要ないのでは？） 但し、新しい子テーブルを毎日追加し、古いものをdropするということはやっています。 ご教授の程よろしくお願いいたします。
以下の構成でWebアプリケーションを構築しています。 Webサーバー：WindowsServer2003、IIS6.0 ＤＢサーバー：WindowsServer2003、PostgreSQL8.0 このたび、各サーバーについて二重化を行うことになり、ＤＢサーバーのクラスタリングツールを探しています。PostgreSQL用のツールの場合、Linux対応版はいろいろあるようですが、Windows対応版はあまりないように見受けられます。 Windows対応のツールでよいツールがあれば、アドバイスをお願いいたします。よろしくお願いいたします。
データベースを勉強していて、正規化についての問題についてお聞きしたいです。とりあえず問題をまず書いてその後自分の考えたことを述べます。以下問題です。 いま表R(A,B,C,D)があり、 Aの列の値が(a1,a2,a3,a4,a4) Bの列の値が(b1,b2,b1,b2,b3) Cの列の値が(c1,c2,c1,c3,c4) Dの列の値が(d1,d2,d1,d2,d3) となっている。 1．このとき、表Rで成り立つ関数従属を選べ。 (1)A→CD(2)B→D(3)BC→A(4)AB→CD(5)D→A 2．表Ｒは第一正規形であるか？ 3．表Ｒは第二正規形であるか？ 4．表Ｒは第三正規形ではないが、この表Ｒを第三正規形になるような二つの表に分割せよ。 1．について 考え方がいまいちわからないのですが、自分で考えてみて、正解は(2)のB→Dかなと思ったのですが、どうやら正解は(2)と(4)っぽいのです。 これはどのように考えたらよいのでしょうか？ 社員番号、とか社員名とかいう具体的な値ならまだわかるのですが、a1とかb1とかいう値のときにどのように考えたらいいのかがわかりません。 2．について これは第一正規形でよろしいですよね？ 3．について これはもし1．の正解が(2)のB→Dであった場合、R1(A,B,C),R2(B,D)と分割できるので第二正規形ではないと考えました。答えはわかりません。 4．について 第三正規形と第二正規形の違いがわからないのでぜんぜんわかりません。 以上についてわかる方いらっしゃいましたら教えてください。よろしくお願いします。
サーバを変更することになり、PostgreのＤＢも移行することになりました。 Postgreのバージョンは 現在：7.1.3　新：8.1.4　です。 現在のＤＢのダンプファイルを作成し、 新しいＤＢにリストアしたのですが、 いくつかのテーブルでエラーがでて、 データのコピーができませんでした。 （テーブルは作成できましたが、データなく、空です。） エラーがでたテーブルには、どれも改行のはいったデータがあるので、 これが原因ではないかと思うのですが、 改行の入ったデータは何か問題があるのでしょうか？ また、もし改行が原因であれば 何か解決策はありますでしょうか？ 以上、よろしくお願いいたします。
すごい単純な質問をしているのかもしれません。許してください。 例えば、ある学校の生徒の成績が蓄積されているテーブルがあるとします。そこからクラス毎にそれぞれ平均点がベスト３の生徒を抽出したい場合のＳＱＬはどのようになりますでしょうか？ class name average ------+------+------ A 高橋 651 A 鈴木 711 A 古田 645 A 田中 821 A 前田 630 B 永田 840 B 前川 765 B 春川 811 B 上田 699 【結果】 class name average ------+------+------ A 田中 821 A 鈴木 711 A 高橋 651 B 永田 840 B 春川 811 B 前川 765 unionでくっつけるとか試したのですがあまりスマートなSQL文ができません。 申し訳ありませんがお知恵を貸してください。
ＤＢに例えば、nameフィールドに"SUzuKI"と登録されていたとします。 この場合に、SQLで、"select * from table where name LIKE '%uzuki%';"と検索してもヒットしません。大文字小文字を判別するからです。大文字小文字を判別しない検索方法についてお分かりになる方がいらっしゃいましたら、ご教示をお願いいたします。 よろしくお願いいたします。
Solaris10, PostgreSQL8.1.3 を使用しています。 PostgreSQL を一旦停止（stop）してから起動（start）をすると下記エラー（？）が表示されます。 （約半年ぶりの再起動です） Starting PostgreSQL Postmaster daemon. Sun Microsystems Inc.SunOS 5.10GenericJanuary 2005 waiting for postmaster to start... done postmaster started LOG: could not bind IPv6 socket: 要求されたアドレスを割り当てられません。 HINT: Is another postmaster already running on port 5432? If not, wait a few seconds and retry. LOG: database system was shut down at 2006-07-14 **:**:** JST LOG: checkpoint record is at 0/91AAE98 LOG: redo record is at 0/91AAE98; undo record is at 0/0; shutdown TRUE LOG: next transaction ID: 40351; next OID: 17368 LOG: next MultiXactId: 1; next MultiXactOffset: 0 LOG: database system is ready LOG: transaction ID wrap limit is 2147484146, limited by database "postgres" 5432 ポートは PostgreSQL が常時利用していますが、 他のソフト等が重複利用しているとは考えていません。 起動後は、psqlコマンド や JDBC接続も問題なく使用できていますが、 このエラー表示だけは何とかして表示されないようにしたいと思います。 解決案や確認すべき箇所等、思い当たる点がありましたら教えてください。 よろしくお願いします。
selectの結果（文字列）を結合ってできますか。 例えば以下のテーブルがあって、カラムAとBを結合した結果が欲しいのです。Aカラム-Bカラム　という結果が欲しいのです。 （つなぎ文字はわかりやすければなんでも可） なんとかスマートに一つのSQLでできないでしょうか。 A | B | C ---+-----+--- 1 | aaa | testtest 2 | bbb | hogehoge SQL > select .... 期待する答え ans | C ---+-----+--- 1 -aaa | testtest 2-bbb | hogehoge
よろしくおねがいします。 このようなページを見たのですが、 イマイチ理解が出来ませんでした。 http://oshiete1.goo.ne.jp/kotaeru.php3?q=418316 （特に-の演算子が調べられませんでした） 二つのデータ（カラム同士）を入れ替えるのに、 二つとも一旦違う値にして、 元のデータに戻すというやり方で何とか対応しているのですが、もう少し効率の良い書き方、関数等ご存知の方いらっしゃいませんでしょうか？ 参考ページの解説でも違ったやり方でも結構です。 どうかご教授願います。
freeBSDとturbolinuxの両方でpostgreSQLを使っています。 date default current_timestamp型のカラムを持つデータをselectで見たとき、freeBSDでは秒単位まで表示されますが、linuxのほうでは年月日のみしか表示されません。 linuxのほうでも秒単位までデータを持っているのでしょうか。linuxのほうでも分単位のデータが必要なので気になっています。 よろしくお願いします。
こんにちは。お世話になっております。 現在、右も左も分からないまま、書籍を参考に、DB（MySQL)を触り始めて2ヶ月足らずの初心者ですが、とあるサイトに、PostgreSQLの設定として以下のようなものが紹介されておりました。 sid、uidなどは分かるのですが、最後のフィールド（rdate）はどのような意味を持つものなのでしょうか？ 初めて見る内容のものなので、DBの違いによるものなのか？などなど、DBの設定の意味が分からず躓いております。 お忙しい中恐縮ですが、ご教授頂ければ幸いです。 CREATE TABLE session ( sid varchar(32) primary key, uid varchar(16) not null, password varchar(16), rawdata varchar(512), rdate timestamp default 'now' );
いつもお世話になっています。 基本がわかっていないので、お手数ですがよろしくお願いいたします。 シェルスクリプトでvacuumやcopyを行いたいのですが、どんな感じで シェルスクリプトを作成すれば良いのか分かりません。 参考サイトで構いませんのでお助けお願いいたします。 またシェルで同じテーブルに対し\copy...fromを同時に実行した 場合、問題はないのでしょうか？（キーが重複するデータはありません。）
pgAdminIIIを最近使いはじめました。pgAdminIII だとPostgre7.4以上の対応となっていて、check_function_bodiesというPostgreSQL7.3のバージョンにはない関数を読み込むSET　check_function_bodies = 'false' という1行がバックアップ時に自動で生成され、バックアップファイルをリストアできないのです。 PostgreSQL7.3のバージョンに対応しているpgAdminIIIを教えていただけないでしょうか？ もしかしてpgAdminIIでないとだめでしょうか？ PostgreSQLのバージョンアップは事情によりできないです。 現在pgAdminIII1.2.2を使用しています。 よろしくお願いいたします。
PostgreSQLのホントの初心者です。 今使っているLinuxサーバ（RedHat9）になぜかたま たまPostgreSQL（7.3.2）が入っていて、使っていた のですが、この際8.1.4に上げようと思いたちました。 これは、バージョンアップというより「入れ直し」と 考え、まず7.3.2を削除しようと考えて、 # rpm -e postgresql と入れてみたのですが、関連付けられているためか 削除できません。 それで、7.3.2にDBを全部削除してしまえばよいと 考え、５つのDB（template0,template1,test,test2, db1）を削除する方法を調べたのですが、「psql」で はDBは消せないようですし、どれかのDBに入って SQLを動かすと、「自分(のDB)」はけセません。 それと、最初からあった、template0,template1も 削除できませんでした。 DBを消すのが目的ではなく、7.3.2を削除したいので すが、どのようにやったらよいか教えて下さい。 よろしくお願いします。
こんにちは pgAdmin３を使用しています。 　条件に一致する行を複数取得して、その行に対してアップデートをかけたいです。アップデートの処理がややこしいので一文で書かず、カーソルを使用して一行づつ処理をしていきたいのですが、下記で　カーソル名.列名で値の取得が出来ないようです。 missing FROM-clause entry in subquery for table "car" BEGIN; 　　DECLARE　car CURSOR　IS　～抽出条件 FETCH ALL IN car; 　　UPDATE　・・・　WHERE clm_name = car.clm_name CLOSE car; END; 　postgresqlが不慣れで、ネットで調べては色々変えてやってみているのですが、ここで詰まってしまいました。 　カーソル内のカラムの取得方法についてご教示下さる方が居れば助かります。
こんばんは。 pgAdminIIIを最近使いはじめました。 テーブルＡを作成し、その後、そのテーブルのバックアップをCOMPRESSで作成しました。 そのバックアップファイルをデータを削除したテーブルＡにリストアしようとしたのですが、 SET check_function_bodies = false というコマンドがエラーだと表示され、うまくリストアできませんでした。 何が間違っているのでしょうか？ ご回答よろしくお願い致します。 ちなみにデータの文字コードはUnicodeでPostgreSQL7.3.9を利用しています。
プロジェクトA　月間勤務状況一覧 氏名　１月　２月　３月　合計 山田　２０　１０　１０　４０ 川村　１０　１０　１０　３０ 大沢　２０　２０　２０　６０ 上記のような一覧をつくりたいのですが、 STAFF表（社員情報）とLABOR表（勤務情報）からSQL一発で 情報を取り出すためのSQL作成に四苦八苦しています。 人別に情報を取り出すには、GROUPを使えばよいというところまではわかるのですが、 月ごとの情報を取得するために副問い合わせを用いる際に、 人別に情報を取得しようとすると 副問い合わせ文内で社員を指定する必要が出てきてしまいます。 すると社員を纏めて表示するためのGROUPを使う意味がそもそもなくなってしまいます。 以上のような点から、SQLを作る事ができないでおります。 どのように記述すれば宜しいでしょうか？アドバイス頂ければ大変助かります。
お世話になっております。 Postgresなんですが、Linuxをインストールすると同時にpostgresが インストールされ、Initdbも実行されてしまいました。 標準のPGDATAのpathでInitdbされてしまっていますが、別の領域に PGDATAを作成したいため、initdbを取り消したいのです。 単純に旧のPGDATAを削除してInitdbの再実行でいいのでしょうか？ それとも、単にinitdbの再実行でいいのでしょうか？ それとも他の方法があるのでしょうか？ 調べてみましたけど不明でした。 どなたか。お助けください。 お願いします。
以下の環境でPerlのデバックを行っているのですが、 Windowsで利用できるpgモジュールはないのでしょうか？ ・Windows XP SP2 ・ActivePerl 5.8.8 ・Apach 1.3.34 ・PostgreSQL 8.1 ソース中にuse Pg;と記載したら以下のエラーが発生し大変困っております。 Windows環境では提供されていないのでしょうか？ 有識者様がいらっしゃったらご教授をお願い致します。 補足ですが、上記環境でDBD::Pgは利用できるようにセットアップしております。 エラー内容： Can't locate Pg.pm in @INC (@INC contains: C:/Perl/lib C:/Perl/site/lib .) at C: \Program Files\Apache Group\Apache\htdocs\proto1\ファイル名.pl line 18. BEGIN failed--compilation aborted at C:\Program Files\Apache Group\Apache\htdocs \proto1\ファイル名.pl line 18.
Tableにserial型の項目を追加しようとしています。phpPgAdminを使用して、serial型項目を追加したいのですが、方法がわかりません。 phpPgAdmin上において、Add columnを選択して、Typeのプルダウンを参照したのですが、serial型がありませんでした。 phpPgAdmin上における、serial型の項目を追加できる方法がありましたら、ご教示をお願いできますでしょうか？よろしくお願いいたします。
phpPgAdmin上から、テーブル定義を行っています。 テーブルの中へ、auto_increment型の項目を追加したいと 考えております。 MySQLには、auto_increment型が存在しますが、PostgreSQLの場合 には、同じような型があるのでしょうか？もし、ない場合には、 一般的にどのような対応をしているのでしょうか？（例えば、 Insertする際にＰＧの中でincrementしているのでしょうか？） (1)auto_increment型の追加方法 (2)auto_increment型がない場合の、対処方法 以上の点に関して、お分かりになる方がいらっしゃいましたら、 ご教示をお願いいたします。
